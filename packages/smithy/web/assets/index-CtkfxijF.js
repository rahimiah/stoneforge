var Q1e=Object.defineProperty;var DH=e=>{throw TypeError(e)};var J1e=(e,t,r)=>t in e?Q1e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var _t=(e,t,r)=>J1e(e,typeof t!="symbol"?t+"":t,r),LH=(e,t,r)=>t.has(e)||DH("Cannot "+r);var gv=(e,t,r)=>(LH(e,t,"read from private field"),r?r.call(e):t.get(e)),OH=(e,t,r)=>t.has(e)?DH("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),IH=(e,t,r,n)=>(LH(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);import{d as Z1e,e as X1e,r as w,j as o,u as pt,c as pd,f as gd,g as Ur,R as ce,i as gh,h as ft,k as kt,l as ewe,w as twe,a as rwe,m as WC,L as I6,n as nwe,o as Ma,p as $ae,O as Fae,q as tl,s as awe,t as swe,v as iwe,x as ws,y as owe,z as lwe,Q as cwe,A as uwe,B as dwe}from"./router-vendor-DHlGizSU.js";import{X as yt,C as Yt,a as e0,b as Vn,M as R6,c as Xk,S as e_,d as Ul,P as KC,G as cu,L as Ix,e as Id,U as tn,B as Vr,T as P6,f as gn,F as fwe,W as vh,g as ds,h as RH,A as Rx,i as Px,j as Bn,k as sy,l as Zo,m as hwe,n as mwe,o as Pe,p as Rr,E as wl,q as Wa,r as pwe,s as GC,H as qp,t as us,u as Yn,v as z6,w as Wp,x as Uae,y as xr,z as Rt,D as pr,I as B6,J as dr,K as Uh,N as VC,O as Yr,Q as tu,R as YC,V as Hae,Y as Ri,Z as t0,_ as ru,$ as Vc,a0 as TO,a1 as AO,a2 as Kp,a3 as Bi,a4 as qae,a5 as Wae,a6 as gwe,a7 as Tl,a8 as rn,a9 as vwe,aa as bwe,ab as ywe,ac as Kae,ad as Gae,ae as iy,af as xwe,ag as zx,ah as Vae,ai as Yae,aj as Hh,ak as ni,al as Ps,am as bh,an as oi,ao as QC,ap as wwe,aq as jr,ar as JC,as as ZC,at as XC,au as na,av as nu,aw as Swe,ax as uu,ay as $6,az as ej,aA as kwe,aB as Qae,aC as Gr,aD as _we,aE as DO,aF as Nwe,aG as ei,aH as qh,aI as F6,aJ as Cwe,aK as Jae,aL as Zae,aM as Xae,aN as jwe,aO as Ewe,aP as Mwe,aQ as ese,aR as tse,aS as zs,aT as Twe,aU as Al,aV as Awe,aW as r0,aX as Dwe,aY as rse,aZ as du,a_ as Lwe,a$ as LO,b0 as Bx,b1 as eh,b2 as U6,b3 as t_,b4 as H6,b5 as nse,b6 as Owe,b7 as Iwe,b8 as ase,b9 as sse,ba as Sl,bb as q6,bc as tj,bd as n0,be as _d,bf as vT,bg as OO,bh as $x,bi as ise,bj as rj,bk as oy,bl as Rwe,bm as ose,bn as Pwe,bo as zwe,bp as Bwe,bq as Fx,br as lse,bs as $we,bt as W6,bu as a0,bv as Fwe,bw as Uwe,bx as Hwe,by as qwe,bz as IO,bA as cse,bB as gk,bC as K6,bD as use,bE as Wwe,bF as G6,bG as Kwe,bH as Gwe,bI as Vwe,bJ as ly,bK as Ywe,bL as Qwe,bM as dse,bN as fse,bO as hse,bP as Jwe,bQ as bT,bR as Zwe,bS as Xwe,bT as eSe,bU as tSe,bV as rSe}from"./utils-vendor-B7jOGaxP.js";import{O as nj,P as V6,C as aj,a as Y6,T as sj,D as Q6,b as mse,I as nSe,S as pse,d as gse,e as aSe,f as vse,V as sSe,L as bse,g as yse,h as iSe,i as oSe,j as xse,k as wse,l as Sse,m as kse,n as _se,A as Nse,o as Cse,p as lSe,q as cSe,r as uSe,s as dSe,t as $c,v as jse,w as fSe,x as hSe,y as Ese,z as mSe,B as pSe,E as gSe,F as vSe,R as Mse,G as bSe,H as ySe,J as xSe,K as wSe,M as SSe,N as kSe,Q as _Se,U as NSe,W as Tse,X as Ase,Y as Dse,Z as Lse,_ as _i,$ as vk}from"./ui-vendor-BSco96uv.js";import{e as Gp,l as wi,m as RO,U as CSe}from"./monaco-editor-B4lwqA13.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var yT={exports:{}},vv={},xT={exports:{}},wT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PH;function jSe(){return PH||(PH=1,(function(e){function t(I,B){var F=I.length;I.push(B);e:for(;0<F;){var q=F-1>>>1,Q=I[q];if(0<a(Q,B))I[q]=B,I[F]=Q,F=q;else break e}}function r(I){return I.length===0?null:I[0]}function n(I){if(I.length===0)return null;var B=I[0],F=I.pop();if(F!==B){I[0]=F;e:for(var q=0,Q=I.length,W=Q>>>1;q<W;){var G=2*(q+1)-1,J=I[G],X=G+1,V=I[X];if(0>a(J,F))X<Q&&0>a(V,J)?(I[q]=V,I[X]=F,q=X):(I[q]=J,I[G]=F,q=G);else if(X<Q&&0>a(V,F))I[q]=V,I[X]=F,q=X;else break e}}return B}function a(I,B){var F=I.sortIndex-B.sortIndex;return F!==0?F:I.id-B.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,f=null,m=3,p=!1,v=!1,b=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function k(I){for(var B=r(u);B!==null;){if(B.callback===null)n(u);else if(B.startTime<=I)n(u),B.sortIndex=B.expirationTime,t(c,B);else break;B=r(u)}}function j(I){if(b=!1,k(I),!v)if(r(c)!==null)v=!0,E||(E=!0,L());else{var B=r(u);B!==null&&P(j,B.startTime-I)}}var E=!1,T=-1,O=5,R=-1;function H(){return y?!0:!(e.unstable_now()-R<O)}function $(){if(y=!1,E){var I=e.unstable_now();R=I;var B=!0;try{e:{v=!1,b&&(b=!1,_(T),T=-1),p=!0;var F=m;try{t:{for(k(I),f=r(c);f!==null&&!(f.expirationTime>I&&H());){var q=f.callback;if(typeof q=="function"){f.callback=null,m=f.priorityLevel;var Q=q(f.expirationTime<=I);if(I=e.unstable_now(),typeof Q=="function"){f.callback=Q,k(I),B=!0;break t}f===r(c)&&n(c),k(I)}else n(c);f=r(c)}if(f!==null)B=!0;else{var W=r(u);W!==null&&P(j,W.startTime-I),B=!1}}break e}finally{f=null,m=F,p=!1}B=void 0}}finally{B?L():E=!1}}}var L;if(typeof N=="function")L=function(){N($)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,M=A.port2;A.port1.onmessage=$,L=function(){M.postMessage(null)}}else L=function(){S($,0)};function P(I,B){T=S(function(){I(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(I){switch(m){case 1:case 2:case 3:var B=3;break;default:B=m}var F=m;m=B;try{return I()}finally{m=F}},e.unstable_requestPaint=function(){y=!0},e.unstable_runWithPriority=function(I,B){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var F=m;m=I;try{return B()}finally{m=F}},e.unstable_scheduleCallback=function(I,B,F){var q=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?q+F:q):F=q,I){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=F+Q,I={id:d++,callback:B,priorityLevel:I,startTime:F,expirationTime:Q,sortIndex:-1},F>q?(I.sortIndex=F,t(u,I),r(c)===null&&I===r(u)&&(b?(_(T),T=-1):b=!0,P(j,F-q))):(I.sortIndex=Q,t(c,I),v||p||(v=!0,E||(E=!0,L()))),I},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(I){var B=m;return function(){var F=m;m=B;try{return I.apply(this,arguments)}finally{m=F}}}})(wT)),wT}var zH;function ESe(){return zH||(zH=1,xT.exports=jSe()),xT.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BH;function MSe(){if(BH)return vv;BH=1;var e=ESe(),t=Z1e(),r=X1e();function n(h){var g="https://react.dev/errors/"+h;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)g+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function s(h){var g=h,x=h;if(h.alternate)for(;g.return;)g=g.return;else{h=g;do g=h,(g.flags&4098)!==0&&(x=g.return),h=g.return;while(h)}return g.tag===3?x:null}function i(h){if(h.tag===13){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function l(h){if(h.tag===31){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function c(h){if(s(h)!==h)throw Error(n(188))}function u(h){var g=h.alternate;if(!g){if(g=s(h),g===null)throw Error(n(188));return g!==h?null:h}for(var x=h,C=g;;){var D=x.return;if(D===null)break;var z=D.alternate;if(z===null){if(C=D.return,C!==null){x=C;continue}break}if(D.child===z.child){for(z=D.child;z;){if(z===x)return c(D),h;if(z===C)return c(D),g;z=z.sibling}throw Error(n(188))}if(x.return!==C.return)x=D,C=z;else{for(var Y=!1,ae=D.child;ae;){if(ae===x){Y=!0,x=D,C=z;break}if(ae===C){Y=!0,C=D,x=z;break}ae=ae.sibling}if(!Y){for(ae=z.child;ae;){if(ae===x){Y=!0,x=z,C=D;break}if(ae===C){Y=!0,C=z,x=D;break}ae=ae.sibling}if(!Y)throw Error(n(189))}}if(x.alternate!==C)throw Error(n(190))}if(x.tag!==3)throw Error(n(188));return x.stateNode.current===x?h:g}function d(h){var g=h.tag;if(g===5||g===26||g===27||g===6)return h;for(h=h.child;h!==null;){if(g=d(h),g!==null)return g;h=h.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),N=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function L(h){return h===null||typeof h!="object"?null:(h=$&&h[$]||h["@@iterator"],typeof h=="function"?h:null)}var A=Symbol.for("react.client.reference");function M(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===A?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case b:return"Fragment";case S:return"Profiler";case y:return"StrictMode";case j:return"Suspense";case E:return"SuspenseList";case R:return"Activity"}if(typeof h=="object")switch(h.$$typeof){case v:return"Portal";case N:return h.displayName||"Context";case _:return(h._context.displayName||"Context")+".Consumer";case k:var g=h.render;return h=h.displayName,h||(h=g.displayName||g.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case T:return g=h.displayName||null,g!==null?g:M(h.type)||"Memo";case O:g=h._payload,h=h._init;try{return M(h(g))}catch{}}return null}var P=Array.isArray,I=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},q=[],Q=-1;function W(h){return{current:h}}function G(h){0>Q||(h.current=q[Q],q[Q]=null,Q--)}function J(h,g){Q++,q[Q]=h.current,h.current=g}var X=W(null),V=W(null),se=W(null),de=W(null);function he(h,g){switch(J(se,g),J(V,h),J(X,null),g.nodeType){case 9:case 11:h=(h=g.documentElement)&&(h=h.namespaceURI)?tH(h):0;break;default:if(h=g.tagName,g=g.namespaceURI)g=tH(g),h=rH(g,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}G(X),J(X,h)}function te(){G(X),G(V),G(se)}function le(h){h.memoizedState!==null&&J(de,h);var g=X.current,x=rH(g,h.type);g!==x&&(J(V,h),J(X,x))}function oe(h){V.current===h&&(G(X),G(V)),de.current===h&&(G(de),fv._currentValue=F)}var Z,ve;function U(h){if(Z===void 0)try{throw Error()}catch(x){var g=x.stack.trim().match(/\n( *(at )?)/);Z=g&&g[1]||"",ve=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+h+ve}var ge=!1;function ue(h,g){if(!h||ge)return"";ge=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(g){var He=function(){throw Error()};if(Object.defineProperty(He.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(He,[])}catch(Ie){var Te=Ie}Reflect.construct(h,[],He)}else{try{He.call()}catch(Ie){Te=Ie}h.call(He.prototype)}}else{try{throw Error()}catch(Ie){Te=Ie}(He=h())&&typeof He.catch=="function"&&He.catch(function(){})}}catch(Ie){if(Ie&&Te&&typeof Ie.stack=="string")return[Ie.stack,Te.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=C.DetermineComponentFrameRoot(),Y=z[0],ae=z[1];if(Y&&ae){var ye=Y.split(`
`),Ee=ae.split(`
`);for(D=C=0;C<ye.length&&!ye[C].includes("DetermineComponentFrameRoot");)C++;for(;D<Ee.length&&!Ee[D].includes("DetermineComponentFrameRoot");)D++;if(C===ye.length||D===Ee.length)for(C=ye.length-1,D=Ee.length-1;1<=C&&0<=D&&ye[C]!==Ee[D];)D--;for(;1<=C&&0<=D;C--,D--)if(ye[C]!==Ee[D]){if(C!==1||D!==1)do if(C--,D--,0>D||ye[C]!==Ee[D]){var ze=`
`+ye[C].replace(" at new "," at ");return h.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",h.displayName)),ze}while(1<=C&&0<=D);break}}}finally{ge=!1,Error.prepareStackTrace=x}return(x=h?h.displayName||h.name:"")?U(x):""}function re(h,g){switch(h.tag){case 26:case 27:case 5:return U(h.type);case 16:return U("Lazy");case 13:return h.child!==g&&g!==null?U("Suspense Fallback"):U("Suspense");case 19:return U("SuspenseList");case 0:case 15:return ue(h.type,!1);case 11:return ue(h.type.render,!1);case 1:return ue(h.type,!0);case 31:return U("Activity");default:return""}}function ne(h){try{var g="",x=null;do g+=re(h,x),x=h,h=h.return;while(h);return g}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}var me=Object.prototype.hasOwnProperty,ke=e.unstable_scheduleCallback,we=e.unstable_cancelCallback,pe=e.unstable_shouldYield,Oe=e.unstable_requestPaint,Ae=e.unstable_now,Re=e.unstable_getCurrentPriorityLevel,Ve=e.unstable_ImmediatePriority,gt=e.unstable_UserBlockingPriority,lt=e.unstable_NormalPriority,Pt=e.unstable_LowPriority,fr=e.unstable_IdlePriority,Qe=e.log,Vt=e.unstable_setDisableYieldValue,at=null,Ne=null;function Fe(h){if(typeof Qe=="function"&&Vt(h),Ne&&typeof Ne.setStrictMode=="function")try{Ne.setStrictMode(at,h)}catch{}}var Ke=Math.clz32?Math.clz32:Zt,Tt=Math.log,wt=Math.LN2;function Zt(h){return h>>>=0,h===0?32:31-(Tt(h)/wt|0)|0}var Xe=256,nt=262144,bt=4194304;function Ct(h){var g=h&42;if(g!==0)return g;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return h&261888;case 262144:case 524288:case 1048576:case 2097152:return h&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function fe(h,g,x){var C=h.pendingLanes;if(C===0)return 0;var D=0,z=h.suspendedLanes,Y=h.pingedLanes;h=h.warmLanes;var ae=C&134217727;return ae!==0?(C=ae&~z,C!==0?D=Ct(C):(Y&=ae,Y!==0?D=Ct(Y):x||(x=ae&~h,x!==0&&(D=Ct(x))))):(ae=C&~z,ae!==0?D=Ct(ae):Y!==0?D=Ct(Y):x||(x=C&~h,x!==0&&(D=Ct(x)))),D===0?0:g!==0&&g!==D&&(g&z)===0&&(z=D&-D,x=g&-g,z>=x||z===32&&(x&4194048)!==0)?g:D}function De(h,g){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&g)===0}function Ue(h,g){switch(h){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dt(){var h=bt;return bt<<=1,(bt&62914560)===0&&(bt=4194304),h}function Nt(h){for(var g=[],x=0;31>x;x++)g.push(h);return g}function Mt(h,g){h.pendingLanes|=g,g!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function Je(h,g,x,C,D,z){var Y=h.pendingLanes;h.pendingLanes=x,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=x,h.entangledLanes&=x,h.errorRecoveryDisabledLanes&=x,h.shellSuspendCounter=0;var ae=h.entanglements,ye=h.expirationTimes,Ee=h.hiddenUpdates;for(x=Y&~x;0<x;){var ze=31-Ke(x),He=1<<ze;ae[ze]=0,ye[ze]=-1;var Te=Ee[ze];if(Te!==null)for(Ee[ze]=null,ze=0;ze<Te.length;ze++){var Ie=Te[ze];Ie!==null&&(Ie.lane&=-536870913)}x&=~He}C!==0&&et(h,C,0),z!==0&&D===0&&h.tag!==0&&(h.suspendedLanes|=z&~(Y&~g))}function et(h,g,x){h.pendingLanes|=g,h.suspendedLanes&=~g;var C=31-Ke(g);h.entangledLanes|=g,h.entanglements[C]=h.entanglements[C]|1073741824|x&261930}function it(h,g){var x=h.entangledLanes|=g;for(h=h.entanglements;x;){var C=31-Ke(x),D=1<<C;D&g|h[C]&g&&(h[C]|=g),x&=~D}}function tr(h,g){var x=g&-g;return x=(x&42)!==0?1:ee(x),(x&(h.suspendedLanes|g))!==0?0:x}function ee(h){switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=128;break;case 268435456:h=134217728;break;default:h=0}return h}function Le(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function We(){var h=B.p;return h!==0?h:(h=window.event,h===void 0?32:NH(h.type))}function be(h,g){var x=B.p;try{return B.p=h,g()}finally{B.p=x}}var K=Math.random().toString(36).slice(2),ie="__reactFiber$"+K,xe="__reactProps$"+K,Ce="__reactContainer$"+K,ht="__reactEvents$"+K,ot="__reactListeners$"+K,Dt="__reactHandles$"+K,Ut="__reactResources$"+K,ct="__reactMarker$"+K;function Bt(h){delete h[ie],delete h[xe],delete h[ht],delete h[ot],delete h[Dt]}function ut(h){var g=h[ie];if(g)return g;for(var x=h.parentNode;x;){if(g=x[Ce]||x[ie]){if(x=g.alternate,g.child!==null||x!==null&&x.child!==null)for(h=cH(h);h!==null;){if(x=h[ie])return x;h=cH(h)}return g}h=x,x=h.parentNode}return null}function qt(h){if(h=h[ie]||h[Ce]){var g=h.tag;if(g===5||g===6||g===13||g===31||g===26||g===27||g===3)return h}return null}function nr(h){var g=h.tag;if(g===5||g===26||g===27||g===6)return h.stateNode;throw Error(n(33))}function Dr(h){var g=h[Ut];return g||(g=h[Ut]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function vn(h){h[ct]=!0}var gm=new Set,Gl={};function Mo(h,g){Ye(h,g),Ye(h+"Capture",g)}function Ye(h,g){for(Gl[h]=g,h=0;h<g.length;h++)gm.add(g[h])}var At=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),or={},$r={};function On(h){return me.call($r,h)?!0:me.call(or,h)?!1:At.test(h)?$r[h]=!0:(or[h]=!0,!1)}function Aa(h,g,x){if(On(g))if(x===null)h.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":h.removeAttribute(g);return;case"boolean":var C=g.toLowerCase().slice(0,5);if(C!=="data-"&&C!=="aria-"){h.removeAttribute(g);return}}h.setAttribute(g,""+x)}}function Ns(h,g,x){if(x===null)h.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(g);return}h.setAttribute(g,""+x)}}function hs(h,g,x,C){if(C===null)h.removeAttribute(x);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(x);return}h.setAttributeNS(g,x,""+C)}}function nn(h){switch(typeof h){case"bigint":case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function Cs(h){var g=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function vm(h,g,x){var C=Object.getOwnPropertyDescriptor(h.constructor.prototype,g);if(!h.hasOwnProperty(g)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var D=C.get,z=C.set;return Object.defineProperty(h,g,{configurable:!0,get:function(){return D.call(this)},set:function(Y){x=""+Y,z.call(this,Y)}}),Object.defineProperty(h,g,{enumerable:C.enumerable}),{getValue:function(){return x},setValue:function(Y){x=""+Y},stopTracking:function(){h._valueTracker=null,delete h[g]}}}}function Vl(h){if(!h._valueTracker){var g=Cs(h)?"checked":"value";h._valueTracker=vm(h,g,""+h[g])}}function Qd(h){if(!h)return!1;var g=h._valueTracker;if(!g)return!0;var x=g.getValue(),C="";return h&&(C=Cs(h)?h.checked?"true":"false":h.value),h=C,h!==x?(g.setValue(h),!0):!1}function Yl(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}var C0=/[\n"\\]/g;function ms(h){return h.replace(C0,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Ql(h,g,x,C,D,z,Y,ae){h.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?h.type=Y:h.removeAttribute("type"),g!=null?Y==="number"?(g===0&&h.value===""||h.value!=g)&&(h.value=""+nn(g)):h.value!==""+nn(g)&&(h.value=""+nn(g)):Y!=="submit"&&Y!=="reset"||h.removeAttribute("value"),g!=null?wu(h,Y,nn(g)):x!=null?wu(h,Y,nn(x)):C!=null&&h.removeAttribute("value"),D==null&&z!=null&&(h.defaultChecked=!!z),D!=null&&(h.checked=D&&typeof D!="function"&&typeof D!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?h.name=""+nn(ae):h.removeAttribute("name")}function Jl(h,g,x,C,D,z,Y,ae){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(h.type=z),g!=null||x!=null){if(!(z!=="submit"&&z!=="reset"||g!=null)){Vl(h);return}x=x!=null?""+nn(x):"",g=g!=null?""+nn(g):x,ae||g===h.value||(h.value=g),h.defaultValue=g}C=C??D,C=typeof C!="function"&&typeof C!="symbol"&&!!C,h.checked=ae?h.checked:!!C,h.defaultChecked=!!C,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(h.name=Y),Vl(h)}function wu(h,g,x){g==="number"&&Yl(h.ownerDocument)===h||h.defaultValue===""+x||(h.defaultValue=""+x)}function aa(h,g,x,C){if(h=h.options,g){g={};for(var D=0;D<x.length;D++)g["$"+x[D]]=!0;for(x=0;x<h.length;x++)D=g.hasOwnProperty("$"+h[x].value),h[x].selected!==D&&(h[x].selected=D),D&&C&&(h[x].defaultSelected=!0)}else{for(x=""+nn(x),g=null,D=0;D<h.length;D++){if(h[D].value===x){h[D].selected=!0,C&&(h[D].defaultSelected=!0);return}g!==null||h[D].disabled||(g=h[D])}g!==null&&(g.selected=!0)}}function z1(h,g,x){if(g!=null&&(g=""+nn(g),g!==h.value&&(h.value=g),x==null)){h.defaultValue!==g&&(h.defaultValue=g);return}h.defaultValue=x!=null?""+nn(x):""}function bm(h,g,x,C){if(g==null){if(C!=null){if(x!=null)throw Error(n(92));if(P(C)){if(1<C.length)throw Error(n(93));C=C[0]}x=C}x==null&&(x=""),g=x}x=nn(g),h.defaultValue=x,C=h.textContent,C===x&&C!==""&&C!==null&&(h.value=C),Vl(h)}function Kt(h,g){if(g){var x=h.firstChild;if(x&&x===h.lastChild&&x.nodeType===3){x.nodeValue=g;return}}h.textContent=g}var B1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sa(h,g,x){var C=g.indexOf("--")===0;x==null||typeof x=="boolean"||x===""?C?h.setProperty(g,""):g==="float"?h.cssFloat="":h[g]="":C?h.setProperty(g,x):typeof x!="number"||x===0||B1.has(g)?g==="float"?h.cssFloat=x:h[g]=(""+x).trim():h[g]=x+"px"}function Jr(h,g,x){if(g!=null&&typeof g!="object")throw Error(n(62));if(h=h.style,x!=null){for(var C in x)!x.hasOwnProperty(C)||g!=null&&g.hasOwnProperty(C)||(C.indexOf("--")===0?h.setProperty(C,""):C==="float"?h.cssFloat="":h[C]="");for(var D in g)C=g[D],g.hasOwnProperty(D)&&x[D]!==C&&sa(h,D,C)}else for(var z in g)g.hasOwnProperty(z)&&sa(h,z,g[z])}function Su(h){if(h.indexOf("-")===-1)return!1;switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),j0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ku(h){return j0.test(""+h)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":h}function st(){}var jt=null;function ar(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var wr=null,In=null;function qi(h){var g=qt(h);if(g&&(h=g.stateNode)){var x=h[xe]||null;e:switch(h=g.stateNode,g.type){case"input":if(Ql(h,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name),g=x.name,x.type==="radio"&&g!=null){for(x=h;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll('input[name="'+ms(""+g)+'"][type="radio"]'),g=0;g<x.length;g++){var C=x[g];if(C!==h&&C.form===h.form){var D=C[xe]||null;if(!D)throw Error(n(90));Ql(C,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(g=0;g<x.length;g++)C=x[g],C.form===h.form&&Qd(C)}break e;case"textarea":z1(h,x.value,x.defaultValue);break e;case"select":g=x.value,g!=null&&aa(h,!!x.multiple,g,!1)}}}var E0=!1;function $1(h,g,x){if(E0)return h(g,x);E0=!0;try{var C=h(g);return C}finally{if(E0=!1,(wr!==null||In!==null)&&(jw(),wr&&(g=wr,h=In,In=wr=null,qi(g),h)))for(g=0;g<h.length;g++)qi(h[g])}}function M0(h,g){var x=h.stateNode;if(x===null)return null;var C=x[xe]||null;if(C===null)return null;x=C[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(h=h.type,C=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!C;break e;default:h=!1}if(h)return null;if(x&&typeof x!="function")throw Error(n(231,g,typeof x));return x}var Xl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vE=!1;if(Xl)try{var T0={};Object.defineProperty(T0,"passive",{get:function(){vE=!0}}),window.addEventListener("test",T0,T0),window.removeEventListener("test",T0,T0)}catch{vE=!1}var _u=null,bE=null,F1=null;function r8(){if(F1)return F1;var h,g=bE,x=g.length,C,D="value"in _u?_u.value:_u.textContent,z=D.length;for(h=0;h<x&&g[h]===D[h];h++);var Y=x-h;for(C=1;C<=Y&&g[x-C]===D[z-C];C++);return F1=D.slice(h,1<C?1-C:void 0)}function U1(h){var g=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&g===13&&(h=13)):h=g,h===10&&(h=13),32<=h||h===13?h:0}function H1(){return!0}function n8(){return!1}function Ks(h){function g(x,C,D,z,Y){this._reactName=x,this._targetInst=D,this.type=C,this.nativeEvent=z,this.target=Y,this.currentTarget=null;for(var ae in h)h.hasOwnProperty(ae)&&(x=h[ae],this[ae]=x?x(z):z[ae]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?H1:n8,this.isPropagationStopped=n8,this}return f(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=H1)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=H1)},persist:function(){},isPersistent:H1}),g}var Jd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},q1=Ks(Jd),A0=f({},Jd,{view:0,detail:0}),Vye=Ks(A0),yE,xE,D0,W1=f({},A0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:SE,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==D0&&(D0&&h.type==="mousemove"?(yE=h.screenX-D0.screenX,xE=h.screenY-D0.screenY):xE=yE=0,D0=h),yE)},movementY:function(h){return"movementY"in h?h.movementY:xE}}),a8=Ks(W1),Yye=f({},W1,{dataTransfer:0}),Qye=Ks(Yye),Jye=f({},A0,{relatedTarget:0}),wE=Ks(Jye),Zye=f({},Jd,{animationName:0,elapsedTime:0,pseudoElement:0}),Xye=Ks(Zye),exe=f({},Jd,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),txe=Ks(exe),rxe=f({},Jd,{data:0}),s8=Ks(rxe),nxe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},axe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sxe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ixe(h){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(h):(h=sxe[h])?!!g[h]:!1}function SE(){return ixe}var oxe=f({},A0,{key:function(h){if(h.key){var g=nxe[h.key]||h.key;if(g!=="Unidentified")return g}return h.type==="keypress"?(h=U1(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?axe[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:SE,charCode:function(h){return h.type==="keypress"?U1(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?U1(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),lxe=Ks(oxe),cxe=f({},W1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i8=Ks(cxe),uxe=f({},A0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:SE}),dxe=Ks(uxe),fxe=f({},Jd,{propertyName:0,elapsedTime:0,pseudoElement:0}),hxe=Ks(fxe),mxe=f({},W1,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),pxe=Ks(mxe),gxe=f({},Jd,{newState:0,oldState:0}),vxe=Ks(gxe),bxe=[9,13,27,32],kE=Xl&&"CompositionEvent"in window,L0=null;Xl&&"documentMode"in document&&(L0=document.documentMode);var yxe=Xl&&"TextEvent"in window&&!L0,o8=Xl&&(!kE||L0&&8<L0&&11>=L0),l8=" ",c8=!1;function u8(h,g){switch(h){case"keyup":return bxe.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function d8(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var ym=!1;function xxe(h,g){switch(h){case"compositionend":return d8(g);case"keypress":return g.which!==32?null:(c8=!0,l8);case"textInput":return h=g.data,h===l8&&c8?null:h;default:return null}}function wxe(h,g){if(ym)return h==="compositionend"||!kE&&u8(h,g)?(h=r8(),F1=bE=_u=null,ym=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return o8&&g.locale!=="ko"?null:g.data;default:return null}}var Sxe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function f8(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g==="input"?!!Sxe[h.type]:g==="textarea"}function h8(h,g,x,C){wr?In?In.push(C):In=[C]:wr=C,g=Ow(g,"onChange"),0<g.length&&(x=new q1("onChange","change",null,x,C),h.push({event:x,listeners:g}))}var O0=null,I0=null;function kxe(h){YU(h,0)}function K1(h){var g=nr(h);if(Qd(g))return h}function m8(h,g){if(h==="change")return g}var p8=!1;if(Xl){var _E;if(Xl){var NE="oninput"in document;if(!NE){var g8=document.createElement("div");g8.setAttribute("oninput","return;"),NE=typeof g8.oninput=="function"}_E=NE}else _E=!1;p8=_E&&(!document.documentMode||9<document.documentMode)}function v8(){O0&&(O0.detachEvent("onpropertychange",b8),I0=O0=null)}function b8(h){if(h.propertyName==="value"&&K1(I0)){var g=[];h8(g,I0,h,ar(h)),$1(kxe,g)}}function _xe(h,g,x){h==="focusin"?(v8(),O0=g,I0=x,O0.attachEvent("onpropertychange",b8)):h==="focusout"&&v8()}function Nxe(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return K1(I0)}function Cxe(h,g){if(h==="click")return K1(g)}function jxe(h,g){if(h==="input"||h==="change")return K1(g)}function Exe(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var ci=typeof Object.is=="function"?Object.is:Exe;function R0(h,g){if(ci(h,g))return!0;if(typeof h!="object"||h===null||typeof g!="object"||g===null)return!1;var x=Object.keys(h),C=Object.keys(g);if(x.length!==C.length)return!1;for(C=0;C<x.length;C++){var D=x[C];if(!me.call(g,D)||!ci(h[D],g[D]))return!1}return!0}function y8(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function x8(h,g){var x=y8(h);h=0;for(var C;x;){if(x.nodeType===3){if(C=h+x.textContent.length,h<=g&&C>=g)return{node:x,offset:g-h};h=C}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=y8(x)}}function w8(h,g){return h&&g?h===g?!0:h&&h.nodeType===3?!1:g&&g.nodeType===3?w8(h,g.parentNode):"contains"in h?h.contains(g):h.compareDocumentPosition?!!(h.compareDocumentPosition(g)&16):!1:!1}function S8(h){h=h!=null&&h.ownerDocument!=null&&h.ownerDocument.defaultView!=null?h.ownerDocument.defaultView:window;for(var g=Yl(h.document);g instanceof h.HTMLIFrameElement;){try{var x=typeof g.contentWindow.location.href=="string"}catch{x=!1}if(x)h=g.contentWindow;else break;g=Yl(h.document)}return g}function CE(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g&&(g==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||g==="textarea"||h.contentEditable==="true")}var Mxe=Xl&&"documentMode"in document&&11>=document.documentMode,xm=null,jE=null,P0=null,EE=!1;function k8(h,g,x){var C=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;EE||xm==null||xm!==Yl(C)||(C=xm,"selectionStart"in C&&CE(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),P0&&R0(P0,C)||(P0=C,C=Ow(jE,"onSelect"),0<C.length&&(g=new q1("onSelect","select",null,g,x),h.push({event:g,listeners:C}),g.target=xm)))}function Zd(h,g){var x={};return x[h.toLowerCase()]=g.toLowerCase(),x["Webkit"+h]="webkit"+g,x["Moz"+h]="moz"+g,x}var wm={animationend:Zd("Animation","AnimationEnd"),animationiteration:Zd("Animation","AnimationIteration"),animationstart:Zd("Animation","AnimationStart"),transitionrun:Zd("Transition","TransitionRun"),transitionstart:Zd("Transition","TransitionStart"),transitioncancel:Zd("Transition","TransitionCancel"),transitionend:Zd("Transition","TransitionEnd")},ME={},_8={};Xl&&(_8=document.createElement("div").style,"AnimationEvent"in window||(delete wm.animationend.animation,delete wm.animationiteration.animation,delete wm.animationstart.animation),"TransitionEvent"in window||delete wm.transitionend.transition);function Xd(h){if(ME[h])return ME[h];if(!wm[h])return h;var g=wm[h],x;for(x in g)if(g.hasOwnProperty(x)&&x in _8)return ME[h]=g[x];return h}var N8=Xd("animationend"),C8=Xd("animationiteration"),j8=Xd("animationstart"),Txe=Xd("transitionrun"),Axe=Xd("transitionstart"),Dxe=Xd("transitioncancel"),E8=Xd("transitionend"),M8=new Map,TE="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");TE.push("scrollEnd");function To(h,g){M8.set(h,g),Mo(g,[h])}var G1=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)},Wi=[],Sm=0,AE=0;function V1(){for(var h=Sm,g=AE=Sm=0;g<h;){var x=Wi[g];Wi[g++]=null;var C=Wi[g];Wi[g++]=null;var D=Wi[g];Wi[g++]=null;var z=Wi[g];if(Wi[g++]=null,C!==null&&D!==null){var Y=C.pending;Y===null?D.next=D:(D.next=Y.next,Y.next=D),C.pending=D}z!==0&&T8(x,D,z)}}function Y1(h,g,x,C){Wi[Sm++]=h,Wi[Sm++]=g,Wi[Sm++]=x,Wi[Sm++]=C,AE|=C,h.lanes|=C,h=h.alternate,h!==null&&(h.lanes|=C)}function DE(h,g,x,C){return Y1(h,g,x,C),Q1(h)}function ef(h,g){return Y1(h,null,null,g),Q1(h)}function T8(h,g,x){h.lanes|=x;var C=h.alternate;C!==null&&(C.lanes|=x);for(var D=!1,z=h.return;z!==null;)z.childLanes|=x,C=z.alternate,C!==null&&(C.childLanes|=x),z.tag===22&&(h=z.stateNode,h===null||h._visibility&1||(D=!0)),h=z,z=z.return;return h.tag===3?(z=h.stateNode,D&&g!==null&&(D=31-Ke(x),h=z.hiddenUpdates,C=h[D],C===null?h[D]=[g]:C.push(g),g.lane=x|536870912),z):null}function Q1(h){if(50<sv)throw sv=0,FM=null,Error(n(185));for(var g=h.return;g!==null;)h=g,g=h.return;return h.tag===3?h.stateNode:null}var km={};function Lxe(h,g,x,C){this.tag=h,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(h,g,x,C){return new Lxe(h,g,x,C)}function LE(h){return h=h.prototype,!(!h||!h.isReactComponent)}function ec(h,g){var x=h.alternate;return x===null?(x=ui(h.tag,g,h.key,h.mode),x.elementType=h.elementType,x.type=h.type,x.stateNode=h.stateNode,x.alternate=h,h.alternate=x):(x.pendingProps=g,x.type=h.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=h.flags&65011712,x.childLanes=h.childLanes,x.lanes=h.lanes,x.child=h.child,x.memoizedProps=h.memoizedProps,x.memoizedState=h.memoizedState,x.updateQueue=h.updateQueue,g=h.dependencies,x.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},x.sibling=h.sibling,x.index=h.index,x.ref=h.ref,x.refCleanup=h.refCleanup,x}function A8(h,g){h.flags&=65011714;var x=h.alternate;return x===null?(h.childLanes=0,h.lanes=g,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=x.childLanes,h.lanes=x.lanes,h.child=x.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=x.memoizedProps,h.memoizedState=x.memoizedState,h.updateQueue=x.updateQueue,h.type=x.type,g=x.dependencies,h.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),h}function J1(h,g,x,C,D,z){var Y=0;if(C=h,typeof h=="function")LE(h)&&(Y=1);else if(typeof h=="string")Y=z1e(h,x,X.current)?26:h==="html"||h==="head"||h==="body"?27:5;else e:switch(h){case R:return h=ui(31,x,g,D),h.elementType=R,h.lanes=z,h;case b:return tf(x.children,D,z,g);case y:Y=8,D|=24;break;case S:return h=ui(12,x,g,D|2),h.elementType=S,h.lanes=z,h;case j:return h=ui(13,x,g,D),h.elementType=j,h.lanes=z,h;case E:return h=ui(19,x,g,D),h.elementType=E,h.lanes=z,h;default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case N:Y=10;break e;case _:Y=9;break e;case k:Y=11;break e;case T:Y=14;break e;case O:Y=16,C=null;break e}Y=29,x=Error(n(130,h===null?"null":typeof h,"")),C=null}return g=ui(Y,x,g,D),g.elementType=h,g.type=C,g.lanes=z,g}function tf(h,g,x,C){return h=ui(7,h,C,g),h.lanes=x,h}function OE(h,g,x){return h=ui(6,h,null,g),h.lanes=x,h}function D8(h){var g=ui(18,null,null,0);return g.stateNode=h,g}function IE(h,g,x){return g=ui(4,h.children!==null?h.children:[],h.key,g),g.lanes=x,g.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},g}var L8=new WeakMap;function Ki(h,g){if(typeof h=="object"&&h!==null){var x=L8.get(h);return x!==void 0?x:(g={value:h,source:g,stack:ne(g)},L8.set(h,g),g)}return{value:h,source:g,stack:ne(g)}}var _m=[],Nm=0,Z1=null,z0=0,Gi=[],Vi=0,Nu=null,sl=1,il="";function tc(h,g){_m[Nm++]=z0,_m[Nm++]=Z1,Z1=h,z0=g}function O8(h,g,x){Gi[Vi++]=sl,Gi[Vi++]=il,Gi[Vi++]=Nu,Nu=h;var C=sl;h=il;var D=32-Ke(C)-1;C&=~(1<<D),x+=1;var z=32-Ke(g)+D;if(30<z){var Y=D-D%5;z=(C&(1<<Y)-1).toString(32),C>>=Y,D-=Y,sl=1<<32-Ke(g)+D|x<<D|C,il=z+h}else sl=1<<z|x<<D|C,il=h}function RE(h){h.return!==null&&(tc(h,1),O8(h,1,0))}function PE(h){for(;h===Z1;)Z1=_m[--Nm],_m[Nm]=null,z0=_m[--Nm],_m[Nm]=null;for(;h===Nu;)Nu=Gi[--Vi],Gi[Vi]=null,il=Gi[--Vi],Gi[Vi]=null,sl=Gi[--Vi],Gi[Vi]=null}function I8(h,g){Gi[Vi++]=sl,Gi[Vi++]=il,Gi[Vi++]=Nu,sl=g.id,il=g.overflow,Nu=h}var Ya=null,wn=null,Nr=!1,Cu=null,Yi=!1,zE=Error(n(519));function ju(h){var g=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw B0(Ki(g,h)),zE}function R8(h){var g=h.stateNode,x=h.type,C=h.memoizedProps;switch(g[ie]=h,g[xe]=C,x){case"dialog":br("cancel",g),br("close",g);break;case"iframe":case"object":case"embed":br("load",g);break;case"video":case"audio":for(x=0;x<ov.length;x++)br(ov[x],g);break;case"source":br("error",g);break;case"img":case"image":case"link":br("error",g),br("load",g);break;case"details":br("toggle",g);break;case"input":br("invalid",g),Jl(g,C.value,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name,!0);break;case"select":br("invalid",g);break;case"textarea":br("invalid",g),bm(g,C.value,C.defaultValue,C.children)}x=C.children,typeof x!="string"&&typeof x!="number"&&typeof x!="bigint"||g.textContent===""+x||C.suppressHydrationWarning===!0||XU(g.textContent,x)?(C.popover!=null&&(br("beforetoggle",g),br("toggle",g)),C.onScroll!=null&&br("scroll",g),C.onScrollEnd!=null&&br("scrollend",g),C.onClick!=null&&(g.onclick=st),g=!0):g=!1,g||ju(h,!0)}function P8(h){for(Ya=h.return;Ya;)switch(Ya.tag){case 5:case 31:case 13:Yi=!1;return;case 27:case 3:Yi=!0;return;default:Ya=Ya.return}}function Cm(h){if(h!==Ya)return!1;if(!Nr)return P8(h),Nr=!0,!1;var g=h.tag,x;if((x=g!==3&&g!==27)&&((x=g===5)&&(x=h.type,x=!(x!=="form"&&x!=="button")||rT(h.type,h.memoizedProps)),x=!x),x&&wn&&ju(h),P8(h),g===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(n(317));wn=lH(h)}else if(g===31){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(n(317));wn=lH(h)}else g===27?(g=wn,Fu(h.type)?(h=oT,oT=null,wn=h):wn=g):wn=Ya?Ji(h.stateNode.nextSibling):null;return!0}function rf(){wn=Ya=null,Nr=!1}function BE(){var h=Cu;return h!==null&&(Qs===null?Qs=h:Qs.push.apply(Qs,h),Cu=null),h}function B0(h){Cu===null?Cu=[h]:Cu.push(h)}var $E=W(null),nf=null,rc=null;function Eu(h,g,x){J($E,g._currentValue),g._currentValue=x}function nc(h){h._currentValue=$E.current,G($E)}function FE(h,g,x){for(;h!==null;){var C=h.alternate;if((h.childLanes&g)!==g?(h.childLanes|=g,C!==null&&(C.childLanes|=g)):C!==null&&(C.childLanes&g)!==g&&(C.childLanes|=g),h===x)break;h=h.return}}function UE(h,g,x,C){var D=h.child;for(D!==null&&(D.return=h);D!==null;){var z=D.dependencies;if(z!==null){var Y=D.child;z=z.firstContext;e:for(;z!==null;){var ae=z;z=D;for(var ye=0;ye<g.length;ye++)if(ae.context===g[ye]){z.lanes|=x,ae=z.alternate,ae!==null&&(ae.lanes|=x),FE(z.return,x,h),C||(Y=null);break e}z=ae.next}}else if(D.tag===18){if(Y=D.return,Y===null)throw Error(n(341));Y.lanes|=x,z=Y.alternate,z!==null&&(z.lanes|=x),FE(Y,x,h),Y=null}else Y=D.child;if(Y!==null)Y.return=D;else for(Y=D;Y!==null;){if(Y===h){Y=null;break}if(D=Y.sibling,D!==null){D.return=Y.return,Y=D;break}Y=Y.return}D=Y}}function jm(h,g,x,C){h=null;for(var D=g,z=!1;D!==null;){if(!z){if((D.flags&524288)!==0)z=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var Y=D.alternate;if(Y===null)throw Error(n(387));if(Y=Y.memoizedProps,Y!==null){var ae=D.type;ci(D.pendingProps.value,Y.value)||(h!==null?h.push(ae):h=[ae])}}else if(D===de.current){if(Y=D.alternate,Y===null)throw Error(n(387));Y.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(h!==null?h.push(fv):h=[fv])}D=D.return}h!==null&&UE(g,h,x,C),g.flags|=262144}function X1(h){for(h=h.firstContext;h!==null;){if(!ci(h.context._currentValue,h.memoizedValue))return!0;h=h.next}return!1}function af(h){nf=h,rc=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function Qa(h){return z8(nf,h)}function ew(h,g){return nf===null&&af(h),z8(h,g)}function z8(h,g){var x=g._currentValue;if(g={context:g,memoizedValue:x,next:null},rc===null){if(h===null)throw Error(n(308));rc=g,h.dependencies={lanes:0,firstContext:g},h.flags|=524288}else rc=rc.next=g;return x}var Oxe=typeof AbortController<"u"?AbortController:function(){var h=[],g=this.signal={aborted:!1,addEventListener:function(x,C){h.push(C)}};this.abort=function(){g.aborted=!0,h.forEach(function(x){return x()})}},Ixe=e.unstable_scheduleCallback,Rxe=e.unstable_NormalPriority,ia={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function HE(){return{controller:new Oxe,data:new Map,refCount:0}}function $0(h){h.refCount--,h.refCount===0&&Ixe(Rxe,function(){h.controller.abort()})}var F0=null,qE=0,Em=0,Mm=null;function Pxe(h,g){if(F0===null){var x=F0=[];qE=0,Em=GM(),Mm={status:"pending",value:void 0,then:function(C){x.push(C)}}}return qE++,g.then(B8,B8),g}function B8(){if(--qE===0&&F0!==null){Mm!==null&&(Mm.status="fulfilled");var h=F0;F0=null,Em=0,Mm=null;for(var g=0;g<h.length;g++)(0,h[g])()}}function zxe(h,g){var x=[],C={status:"pending",value:null,reason:null,then:function(D){x.push(D)}};return h.then(function(){C.status="fulfilled",C.value=g;for(var D=0;D<x.length;D++)(0,x[D])(g)},function(D){for(C.status="rejected",C.reason=D,D=0;D<x.length;D++)(0,x[D])(void 0)}),C}var $8=I.S;I.S=function(h,g){kU=Ae(),typeof g=="object"&&g!==null&&typeof g.then=="function"&&Pxe(h,g),$8!==null&&$8(h,g)};var sf=W(null);function WE(){var h=sf.current;return h!==null?h:fn.pooledCache}function tw(h,g){g===null?J(sf,sf.current):J(sf,g.pool)}function F8(){var h=WE();return h===null?null:{parent:ia._currentValue,pool:h}}var Tm=Error(n(460)),KE=Error(n(474)),rw=Error(n(542)),nw={then:function(){}};function U8(h){return h=h.status,h==="fulfilled"||h==="rejected"}function H8(h,g,x){switch(x=h[x],x===void 0?h.push(g):x!==g&&(g.then(st,st),g=x),g.status){case"fulfilled":return g.value;case"rejected":throw h=g.reason,W8(h),h;default:if(typeof g.status=="string")g.then(st,st);else{if(h=fn,h!==null&&100<h.shellSuspendCounter)throw Error(n(482));h=g,h.status="pending",h.then(function(C){if(g.status==="pending"){var D=g;D.status="fulfilled",D.value=C}},function(C){if(g.status==="pending"){var D=g;D.status="rejected",D.reason=C}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw h=g.reason,W8(h),h}throw lf=g,Tm}}function of(h){try{var g=h._init;return g(h._payload)}catch(x){throw x!==null&&typeof x=="object"&&typeof x.then=="function"?(lf=x,Tm):x}}var lf=null;function q8(){if(lf===null)throw Error(n(459));var h=lf;return lf=null,h}function W8(h){if(h===Tm||h===rw)throw Error(n(483))}var Am=null,U0=0;function aw(h){var g=U0;return U0+=1,Am===null&&(Am=[]),H8(Am,h,g)}function H0(h,g){g=g.props.ref,h.ref=g!==void 0?g:null}function sw(h,g){throw g.$$typeof===m?Error(n(525)):(h=Object.prototype.toString.call(g),Error(n(31,h==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":h)))}function K8(h){function g(_e,Se){if(h){var je=_e.deletions;je===null?(_e.deletions=[Se],_e.flags|=16):je.push(Se)}}function x(_e,Se){if(!h)return null;for(;Se!==null;)g(_e,Se),Se=Se.sibling;return null}function C(_e){for(var Se=new Map;_e!==null;)_e.key!==null?Se.set(_e.key,_e):Se.set(_e.index,_e),_e=_e.sibling;return Se}function D(_e,Se){return _e=ec(_e,Se),_e.index=0,_e.sibling=null,_e}function z(_e,Se,je){return _e.index=je,h?(je=_e.alternate,je!==null?(je=je.index,je<Se?(_e.flags|=67108866,Se):je):(_e.flags|=67108866,Se)):(_e.flags|=1048576,Se)}function Y(_e){return h&&_e.alternate===null&&(_e.flags|=67108866),_e}function ae(_e,Se,je,$e){return Se===null||Se.tag!==6?(Se=OE(je,_e.mode,$e),Se.return=_e,Se):(Se=D(Se,je),Se.return=_e,Se)}function ye(_e,Se,je,$e){var $t=je.type;return $t===b?ze(_e,Se,je.props.children,$e,je.key):Se!==null&&(Se.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===O&&of($t)===Se.type)?(Se=D(Se,je.props),H0(Se,je),Se.return=_e,Se):(Se=J1(je.type,je.key,je.props,null,_e.mode,$e),H0(Se,je),Se.return=_e,Se)}function Ee(_e,Se,je,$e){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==je.containerInfo||Se.stateNode.implementation!==je.implementation?(Se=IE(je,_e.mode,$e),Se.return=_e,Se):(Se=D(Se,je.children||[]),Se.return=_e,Se)}function ze(_e,Se,je,$e,$t){return Se===null||Se.tag!==7?(Se=tf(je,_e.mode,$e,$t),Se.return=_e,Se):(Se=D(Se,je),Se.return=_e,Se)}function He(_e,Se,je){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return Se=OE(""+Se,_e.mode,je),Se.return=_e,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case p:return je=J1(Se.type,Se.key,Se.props,null,_e.mode,je),H0(je,Se),je.return=_e,je;case v:return Se=IE(Se,_e.mode,je),Se.return=_e,Se;case O:return Se=of(Se),He(_e,Se,je)}if(P(Se)||L(Se))return Se=tf(Se,_e.mode,je,null),Se.return=_e,Se;if(typeof Se.then=="function")return He(_e,aw(Se),je);if(Se.$$typeof===N)return He(_e,ew(_e,Se),je);sw(_e,Se)}return null}function Te(_e,Se,je,$e){var $t=Se!==null?Se.key:null;if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return $t!==null?null:ae(_e,Se,""+je,$e);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case p:return je.key===$t?ye(_e,Se,je,$e):null;case v:return je.key===$t?Ee(_e,Se,je,$e):null;case O:return je=of(je),Te(_e,Se,je,$e)}if(P(je)||L(je))return $t!==null?null:ze(_e,Se,je,$e,null);if(typeof je.then=="function")return Te(_e,Se,aw(je),$e);if(je.$$typeof===N)return Te(_e,Se,ew(_e,je),$e);sw(_e,je)}return null}function Ie(_e,Se,je,$e,$t){if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return _e=_e.get(je)||null,ae(Se,_e,""+$e,$t);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case p:return _e=_e.get($e.key===null?je:$e.key)||null,ye(Se,_e,$e,$t);case v:return _e=_e.get($e.key===null?je:$e.key)||null,Ee(Se,_e,$e,$t);case O:return $e=of($e),Ie(_e,Se,je,$e,$t)}if(P($e)||L($e))return _e=_e.get(je)||null,ze(Se,_e,$e,$t,null);if(typeof $e.then=="function")return Ie(_e,Se,je,aw($e),$t);if($e.$$typeof===N)return Ie(_e,Se,je,ew(Se,$e),$t);sw(Se,$e)}return null}function St(_e,Se,je,$e){for(var $t=null,Lr=null,Et=Se,lr=Se=0,kr=null;Et!==null&&lr<je.length;lr++){Et.index>lr?(kr=Et,Et=null):kr=Et.sibling;var Or=Te(_e,Et,je[lr],$e);if(Or===null){Et===null&&(Et=kr);break}h&&Et&&Or.alternate===null&&g(_e,Et),Se=z(Or,Se,lr),Lr===null?$t=Or:Lr.sibling=Or,Lr=Or,Et=kr}if(lr===je.length)return x(_e,Et),Nr&&tc(_e,lr),$t;if(Et===null){for(;lr<je.length;lr++)Et=He(_e,je[lr],$e),Et!==null&&(Se=z(Et,Se,lr),Lr===null?$t=Et:Lr.sibling=Et,Lr=Et);return Nr&&tc(_e,lr),$t}for(Et=C(Et);lr<je.length;lr++)kr=Ie(Et,_e,lr,je[lr],$e),kr!==null&&(h&&kr.alternate!==null&&Et.delete(kr.key===null?lr:kr.key),Se=z(kr,Se,lr),Lr===null?$t=kr:Lr.sibling=kr,Lr=kr);return h&&Et.forEach(function(Ku){return g(_e,Ku)}),Nr&&tc(_e,lr),$t}function Wt(_e,Se,je,$e){if(je==null)throw Error(n(151));for(var $t=null,Lr=null,Et=Se,lr=Se=0,kr=null,Or=je.next();Et!==null&&!Or.done;lr++,Or=je.next()){Et.index>lr?(kr=Et,Et=null):kr=Et.sibling;var Ku=Te(_e,Et,Or.value,$e);if(Ku===null){Et===null&&(Et=kr);break}h&&Et&&Ku.alternate===null&&g(_e,Et),Se=z(Ku,Se,lr),Lr===null?$t=Ku:Lr.sibling=Ku,Lr=Ku,Et=kr}if(Or.done)return x(_e,Et),Nr&&tc(_e,lr),$t;if(Et===null){for(;!Or.done;lr++,Or=je.next())Or=He(_e,Or.value,$e),Or!==null&&(Se=z(Or,Se,lr),Lr===null?$t=Or:Lr.sibling=Or,Lr=Or);return Nr&&tc(_e,lr),$t}for(Et=C(Et);!Or.done;lr++,Or=je.next())Or=Ie(Et,_e,lr,Or.value,$e),Or!==null&&(h&&Or.alternate!==null&&Et.delete(Or.key===null?lr:Or.key),Se=z(Or,Se,lr),Lr===null?$t=Or:Lr.sibling=Or,Lr=Or);return h&&Et.forEach(function(Y1e){return g(_e,Y1e)}),Nr&&tc(_e,lr),$t}function on(_e,Se,je,$e){if(typeof je=="object"&&je!==null&&je.type===b&&je.key===null&&(je=je.props.children),typeof je=="object"&&je!==null){switch(je.$$typeof){case p:e:{for(var $t=je.key;Se!==null;){if(Se.key===$t){if($t=je.type,$t===b){if(Se.tag===7){x(_e,Se.sibling),$e=D(Se,je.props.children),$e.return=_e,_e=$e;break e}}else if(Se.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===O&&of($t)===Se.type){x(_e,Se.sibling),$e=D(Se,je.props),H0($e,je),$e.return=_e,_e=$e;break e}x(_e,Se);break}else g(_e,Se);Se=Se.sibling}je.type===b?($e=tf(je.props.children,_e.mode,$e,je.key),$e.return=_e,_e=$e):($e=J1(je.type,je.key,je.props,null,_e.mode,$e),H0($e,je),$e.return=_e,_e=$e)}return Y(_e);case v:e:{for($t=je.key;Se!==null;){if(Se.key===$t)if(Se.tag===4&&Se.stateNode.containerInfo===je.containerInfo&&Se.stateNode.implementation===je.implementation){x(_e,Se.sibling),$e=D(Se,je.children||[]),$e.return=_e,_e=$e;break e}else{x(_e,Se);break}else g(_e,Se);Se=Se.sibling}$e=IE(je,_e.mode,$e),$e.return=_e,_e=$e}return Y(_e);case O:return je=of(je),on(_e,Se,je,$e)}if(P(je))return St(_e,Se,je,$e);if(L(je)){if($t=L(je),typeof $t!="function")throw Error(n(150));return je=$t.call(je),Wt(_e,Se,je,$e)}if(typeof je.then=="function")return on(_e,Se,aw(je),$e);if(je.$$typeof===N)return on(_e,Se,ew(_e,je),$e);sw(_e,je)}return typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint"?(je=""+je,Se!==null&&Se.tag===6?(x(_e,Se.sibling),$e=D(Se,je),$e.return=_e,_e=$e):(x(_e,Se),$e=OE(je,_e.mode,$e),$e.return=_e,_e=$e),Y(_e)):x(_e,Se)}return function(_e,Se,je,$e){try{U0=0;var $t=on(_e,Se,je,$e);return Am=null,$t}catch(Et){if(Et===Tm||Et===rw)throw Et;var Lr=ui(29,Et,null,_e.mode);return Lr.lanes=$e,Lr.return=_e,Lr}finally{}}}var cf=K8(!0),G8=K8(!1),Mu=!1;function GE(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function VE(h,g){h=h.updateQueue,g.updateQueue===h&&(g.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function Tu(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function Au(h,g,x){var C=h.updateQueue;if(C===null)return null;if(C=C.shared,(Fr&2)!==0){var D=C.pending;return D===null?g.next=g:(g.next=D.next,D.next=g),C.pending=g,g=Q1(h),T8(h,null,x),g}return Y1(h,C,g,x),Q1(h)}function q0(h,g,x){if(g=g.updateQueue,g!==null&&(g=g.shared,(x&4194048)!==0)){var C=g.lanes;C&=h.pendingLanes,x|=C,g.lanes=x,it(h,x)}}function YE(h,g){var x=h.updateQueue,C=h.alternate;if(C!==null&&(C=C.updateQueue,x===C)){var D=null,z=null;if(x=x.firstBaseUpdate,x!==null){do{var Y={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};z===null?D=z=Y:z=z.next=Y,x=x.next}while(x!==null);z===null?D=z=g:z=z.next=g}else D=z=g;x={baseState:C.baseState,firstBaseUpdate:D,lastBaseUpdate:z,shared:C.shared,callbacks:C.callbacks},h.updateQueue=x;return}h=x.lastBaseUpdate,h===null?x.firstBaseUpdate=g:h.next=g,x.lastBaseUpdate=g}var QE=!1;function W0(){if(QE){var h=Mm;if(h!==null)throw h}}function K0(h,g,x,C){QE=!1;var D=h.updateQueue;Mu=!1;var z=D.firstBaseUpdate,Y=D.lastBaseUpdate,ae=D.shared.pending;if(ae!==null){D.shared.pending=null;var ye=ae,Ee=ye.next;ye.next=null,Y===null?z=Ee:Y.next=Ee,Y=ye;var ze=h.alternate;ze!==null&&(ze=ze.updateQueue,ae=ze.lastBaseUpdate,ae!==Y&&(ae===null?ze.firstBaseUpdate=Ee:ae.next=Ee,ze.lastBaseUpdate=ye))}if(z!==null){var He=D.baseState;Y=0,ze=Ee=ye=null,ae=z;do{var Te=ae.lane&-536870913,Ie=Te!==ae.lane;if(Ie?(Sr&Te)===Te:(C&Te)===Te){Te!==0&&Te===Em&&(QE=!0),ze!==null&&(ze=ze.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var St=h,Wt=ae;Te=g;var on=x;switch(Wt.tag){case 1:if(St=Wt.payload,typeof St=="function"){He=St.call(on,He,Te);break e}He=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Wt.payload,Te=typeof St=="function"?St.call(on,He,Te):St,Te==null)break e;He=f({},He,Te);break e;case 2:Mu=!0}}Te=ae.callback,Te!==null&&(h.flags|=64,Ie&&(h.flags|=8192),Ie=D.callbacks,Ie===null?D.callbacks=[Te]:Ie.push(Te))}else Ie={lane:Te,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},ze===null?(Ee=ze=Ie,ye=He):ze=ze.next=Ie,Y|=Te;if(ae=ae.next,ae===null){if(ae=D.shared.pending,ae===null)break;Ie=ae,ae=Ie.next,Ie.next=null,D.lastBaseUpdate=Ie,D.shared.pending=null}}while(!0);ze===null&&(ye=He),D.baseState=ye,D.firstBaseUpdate=Ee,D.lastBaseUpdate=ze,z===null&&(D.shared.lanes=0),Ru|=Y,h.lanes=Y,h.memoizedState=He}}function V8(h,g){if(typeof h!="function")throw Error(n(191,h));h.call(g)}function Y8(h,g){var x=h.callbacks;if(x!==null)for(h.callbacks=null,h=0;h<x.length;h++)V8(x[h],g)}var Dm=W(null),iw=W(0);function Q8(h,g){h=fc,J(iw,h),J(Dm,g),fc=h|g.baseLanes}function JE(){J(iw,fc),J(Dm,Dm.current)}function ZE(){fc=iw.current,G(Dm),G(iw)}var di=W(null),Qi=null;function Du(h){var g=h.alternate;J(Xn,Xn.current&1),J(di,h),Qi===null&&(g===null||Dm.current!==null||g.memoizedState!==null)&&(Qi=h)}function XE(h){J(Xn,Xn.current),J(di,h),Qi===null&&(Qi=h)}function J8(h){h.tag===22?(J(Xn,Xn.current),J(di,h),Qi===null&&(Qi=h)):Lu()}function Lu(){J(Xn,Xn.current),J(di,di.current)}function fi(h){G(di),Qi===h&&(Qi=null),G(Xn)}var Xn=W(0);function ow(h){for(var g=h;g!==null;){if(g.tag===13){var x=g.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||sT(x)||iT(x)))return g}else if(g.tag===19&&(g.memoizedProps.revealOrder==="forwards"||g.memoizedProps.revealOrder==="backwards"||g.memoizedProps.revealOrder==="unstable_legacy-backwards"||g.memoizedProps.revealOrder==="together")){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var ac=0,ir=null,an=null,oa=null,lw=!1,Lm=!1,uf=!1,cw=0,G0=0,Om=null,Bxe=0;function Fn(){throw Error(n(321))}function eM(h,g){if(g===null)return!1;for(var x=0;x<g.length&&x<h.length;x++)if(!ci(h[x],g[x]))return!1;return!0}function tM(h,g,x,C,D,z){return ac=z,ir=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,I.H=h===null||h.memoizedState===null?OF:gM,uf=!1,z=x(C,D),uf=!1,Lm&&(z=X8(g,x,C,D)),Z8(h),z}function Z8(h){I.H=Q0;var g=an!==null&&an.next!==null;if(ac=0,oa=an=ir=null,lw=!1,G0=0,Om=null,g)throw Error(n(300));h===null||la||(h=h.dependencies,h!==null&&X1(h)&&(la=!0))}function X8(h,g,x,C){ir=h;var D=0;do{if(Lm&&(Om=null),G0=0,Lm=!1,25<=D)throw Error(n(301));if(D+=1,oa=an=null,h.updateQueue!=null){var z=h.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}I.H=IF,z=g(x,C)}while(Lm);return z}function $xe(){var h=I.H,g=h.useState()[0];return g=typeof g.then=="function"?V0(g):g,h=h.useState()[0],(an!==null?an.memoizedState:null)!==h&&(ir.flags|=1024),g}function rM(){var h=cw!==0;return cw=0,h}function nM(h,g,x){g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~x}function aM(h){if(lw){for(h=h.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}lw=!1}ac=0,oa=an=ir=null,Lm=!1,G0=cw=0,Om=null}function js(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oa===null?ir.memoizedState=oa=h:oa=oa.next=h,oa}function ea(){if(an===null){var h=ir.alternate;h=h!==null?h.memoizedState:null}else h=an.next;var g=oa===null?ir.memoizedState:oa.next;if(g!==null)oa=g,an=h;else{if(h===null)throw ir.alternate===null?Error(n(467)):Error(n(310));an=h,h={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},oa===null?ir.memoizedState=oa=h:oa=oa.next=h}return oa}function uw(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function V0(h){var g=G0;return G0+=1,Om===null&&(Om=[]),h=H8(Om,h,g),g=ir,(oa===null?g.memoizedState:oa.next)===null&&(g=g.alternate,I.H=g===null||g.memoizedState===null?OF:gM),h}function dw(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return V0(h);if(h.$$typeof===N)return Qa(h)}throw Error(n(438,String(h)))}function sM(h){var g=null,x=ir.updateQueue;if(x!==null&&(g=x.memoCache),g==null){var C=ir.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(g={data:C.data.map(function(D){return D.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),x===null&&(x=uw(),ir.updateQueue=x),x.memoCache=g,x=g.data[g.index],x===void 0)for(x=g.data[g.index]=Array(h),C=0;C<h;C++)x[C]=H;return g.index++,x}function sc(h,g){return typeof g=="function"?g(h):g}function fw(h){var g=ea();return iM(g,an,h)}function iM(h,g,x){var C=h.queue;if(C===null)throw Error(n(311));C.lastRenderedReducer=x;var D=h.baseQueue,z=C.pending;if(z!==null){if(D!==null){var Y=D.next;D.next=z.next,z.next=Y}g.baseQueue=D=z,C.pending=null}if(z=h.baseState,D===null)h.memoizedState=z;else{g=D.next;var ae=Y=null,ye=null,Ee=g,ze=!1;do{var He=Ee.lane&-536870913;if(He!==Ee.lane?(Sr&He)===He:(ac&He)===He){var Te=Ee.revertLane;if(Te===0)ye!==null&&(ye=ye.next={lane:0,revertLane:0,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),He===Em&&(ze=!0);else if((ac&Te)===Te){Ee=Ee.next,Te===Em&&(ze=!0);continue}else He={lane:0,revertLane:Ee.revertLane,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},ye===null?(ae=ye=He,Y=z):ye=ye.next=He,ir.lanes|=Te,Ru|=Te;He=Ee.action,uf&&x(z,He),z=Ee.hasEagerState?Ee.eagerState:x(z,He)}else Te={lane:He,revertLane:Ee.revertLane,gesture:Ee.gesture,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},ye===null?(ae=ye=Te,Y=z):ye=ye.next=Te,ir.lanes|=He,Ru|=He;Ee=Ee.next}while(Ee!==null&&Ee!==g);if(ye===null?Y=z:ye.next=ae,!ci(z,h.memoizedState)&&(la=!0,ze&&(x=Mm,x!==null)))throw x;h.memoizedState=z,h.baseState=Y,h.baseQueue=ye,C.lastRenderedState=z}return D===null&&(C.lanes=0),[h.memoizedState,C.dispatch]}function oM(h){var g=ea(),x=g.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=h;var C=x.dispatch,D=x.pending,z=g.memoizedState;if(D!==null){x.pending=null;var Y=D=D.next;do z=h(z,Y.action),Y=Y.next;while(Y!==D);ci(z,g.memoizedState)||(la=!0),g.memoizedState=z,g.baseQueue===null&&(g.baseState=z),x.lastRenderedState=z}return[z,C]}function eF(h,g,x){var C=ir,D=ea(),z=Nr;if(z){if(x===void 0)throw Error(n(407));x=x()}else x=g();var Y=!ci((an||D).memoizedState,x);if(Y&&(D.memoizedState=x,la=!0),D=D.queue,uM(nF.bind(null,C,D,h),[h]),D.getSnapshot!==g||Y||oa!==null&&oa.memoizedState.tag&1){if(C.flags|=2048,Im(9,{destroy:void 0},rF.bind(null,C,D,x,g),null),fn===null)throw Error(n(349));z||(ac&127)!==0||tF(C,g,x)}return x}function tF(h,g,x){h.flags|=16384,h={getSnapshot:g,value:x},g=ir.updateQueue,g===null?(g=uw(),ir.updateQueue=g,g.stores=[h]):(x=g.stores,x===null?g.stores=[h]:x.push(h))}function rF(h,g,x,C){g.value=x,g.getSnapshot=C,aF(g)&&sF(h)}function nF(h,g,x){return x(function(){aF(g)&&sF(h)})}function aF(h){var g=h.getSnapshot;h=h.value;try{var x=g();return!ci(h,x)}catch{return!0}}function sF(h){var g=ef(h,2);g!==null&&Js(g,h,2)}function lM(h){var g=js();if(typeof h=="function"){var x=h;if(h=x(),uf){Fe(!0);try{x()}finally{Fe(!1)}}}return g.memoizedState=g.baseState=h,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:h},g}function iF(h,g,x,C){return h.baseState=x,iM(h,an,typeof C=="function"?C:sc)}function Fxe(h,g,x,C,D){if(pw(h))throw Error(n(485));if(h=g.action,h!==null){var z={payload:D,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){z.listeners.push(Y)}};I.T!==null?x(!0):z.isTransition=!1,C(z),x=g.pending,x===null?(z.next=g.pending=z,oF(g,z)):(z.next=x.next,g.pending=x.next=z)}}function oF(h,g){var x=g.action,C=g.payload,D=h.state;if(g.isTransition){var z=I.T,Y={};I.T=Y;try{var ae=x(D,C),ye=I.S;ye!==null&&ye(Y,ae),lF(h,g,ae)}catch(Ee){cM(h,g,Ee)}finally{z!==null&&Y.types!==null&&(z.types=Y.types),I.T=z}}else try{z=x(D,C),lF(h,g,z)}catch(Ee){cM(h,g,Ee)}}function lF(h,g,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(C){cF(h,g,C)},function(C){return cM(h,g,C)}):cF(h,g,x)}function cF(h,g,x){g.status="fulfilled",g.value=x,uF(g),h.state=x,g=h.pending,g!==null&&(x=g.next,x===g?h.pending=null:(x=x.next,g.next=x,oF(h,x)))}function cM(h,g,x){var C=h.pending;if(h.pending=null,C!==null){C=C.next;do g.status="rejected",g.reason=x,uF(g),g=g.next;while(g!==C)}h.action=null}function uF(h){h=h.listeners;for(var g=0;g<h.length;g++)(0,h[g])()}function dF(h,g){return g}function fF(h,g){if(Nr){var x=fn.formState;if(x!==null){e:{var C=ir;if(Nr){if(wn){t:{for(var D=wn,z=Yi;D.nodeType!==8;){if(!z){D=null;break t}if(D=Ji(D.nextSibling),D===null){D=null;break t}}z=D.data,D=z==="F!"||z==="F"?D:null}if(D){wn=Ji(D.nextSibling),C=D.data==="F!";break e}}ju(C)}C=!1}C&&(g=x[0])}}return x=js(),x.memoizedState=x.baseState=g,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dF,lastRenderedState:g},x.queue=C,x=AF.bind(null,ir,C),C.dispatch=x,C=lM(!1),z=pM.bind(null,ir,!1,C.queue),C=js(),D={state:g,dispatch:null,action:h,pending:null},C.queue=D,x=Fxe.bind(null,ir,D,z,x),D.dispatch=x,C.memoizedState=h,[g,x,!1]}function hF(h){var g=ea();return mF(g,an,h)}function mF(h,g,x){if(g=iM(h,g,dF)[0],h=fw(sc)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var C=V0(g)}catch(Y){throw Y===Tm?rw:Y}else C=g;g=ea();var D=g.queue,z=D.dispatch;return x!==g.memoizedState&&(ir.flags|=2048,Im(9,{destroy:void 0},Uxe.bind(null,D,x),null)),[C,z,h]}function Uxe(h,g){h.action=g}function pF(h){var g=ea(),x=an;if(x!==null)return mF(g,x,h);ea(),g=g.memoizedState,x=ea();var C=x.queue.dispatch;return x.memoizedState=h,[g,C,!1]}function Im(h,g,x,C){return h={tag:h,create:x,deps:C,inst:g,next:null},g=ir.updateQueue,g===null&&(g=uw(),ir.updateQueue=g),x=g.lastEffect,x===null?g.lastEffect=h.next=h:(C=x.next,x.next=h,h.next=C,g.lastEffect=h),h}function gF(){return ea().memoizedState}function hw(h,g,x,C){var D=js();ir.flags|=h,D.memoizedState=Im(1|g,{destroy:void 0},x,C===void 0?null:C)}function mw(h,g,x,C){var D=ea();C=C===void 0?null:C;var z=D.memoizedState.inst;an!==null&&C!==null&&eM(C,an.memoizedState.deps)?D.memoizedState=Im(g,z,x,C):(ir.flags|=h,D.memoizedState=Im(1|g,z,x,C))}function vF(h,g){hw(8390656,8,h,g)}function uM(h,g){mw(2048,8,h,g)}function Hxe(h){ir.flags|=4;var g=ir.updateQueue;if(g===null)g=uw(),ir.updateQueue=g,g.events=[h];else{var x=g.events;x===null?g.events=[h]:x.push(h)}}function bF(h){var g=ea().memoizedState;return Hxe({ref:g,nextImpl:h}),function(){if((Fr&2)!==0)throw Error(n(440));return g.impl.apply(void 0,arguments)}}function yF(h,g){return mw(4,2,h,g)}function xF(h,g){return mw(4,4,h,g)}function wF(h,g){if(typeof g=="function"){h=h();var x=g(h);return function(){typeof x=="function"?x():g(null)}}if(g!=null)return h=h(),g.current=h,function(){g.current=null}}function SF(h,g,x){x=x!=null?x.concat([h]):null,mw(4,4,wF.bind(null,g,h),x)}function dM(){}function kF(h,g){var x=ea();g=g===void 0?null:g;var C=x.memoizedState;return g!==null&&eM(g,C[1])?C[0]:(x.memoizedState=[h,g],h)}function _F(h,g){var x=ea();g=g===void 0?null:g;var C=x.memoizedState;if(g!==null&&eM(g,C[1]))return C[0];if(C=h(),uf){Fe(!0);try{h()}finally{Fe(!1)}}return x.memoizedState=[C,g],C}function fM(h,g,x){return x===void 0||(ac&1073741824)!==0&&(Sr&261930)===0?h.memoizedState=g:(h.memoizedState=x,h=NU(),ir.lanes|=h,Ru|=h,x)}function NF(h,g,x,C){return ci(x,g)?x:Dm.current!==null?(h=fM(h,x,C),ci(h,g)||(la=!0),h):(ac&42)===0||(ac&1073741824)!==0&&(Sr&261930)===0?(la=!0,h.memoizedState=x):(h=NU(),ir.lanes|=h,Ru|=h,g)}function CF(h,g,x,C,D){var z=B.p;B.p=z!==0&&8>z?z:8;var Y=I.T,ae={};I.T=ae,pM(h,!1,g,x);try{var ye=D(),Ee=I.S;if(Ee!==null&&Ee(ae,ye),ye!==null&&typeof ye=="object"&&typeof ye.then=="function"){var ze=zxe(ye,C);Y0(h,g,ze,pi(h))}else Y0(h,g,C,pi(h))}catch(He){Y0(h,g,{then:function(){},status:"rejected",reason:He},pi())}finally{B.p=z,Y!==null&&ae.types!==null&&(Y.types=ae.types),I.T=Y}}function qxe(){}function hM(h,g,x,C){if(h.tag!==5)throw Error(n(476));var D=jF(h).queue;CF(h,D,g,F,x===null?qxe:function(){return EF(h),x(C)})}function jF(h){var g=h.memoizedState;if(g!==null)return g;g={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:F},next:null};var x={};return g.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:x},next:null},h.memoizedState=g,h=h.alternate,h!==null&&(h.memoizedState=g),g}function EF(h){var g=jF(h);g.next===null&&(g=h.alternate.memoizedState),Y0(h,g.next.queue,{},pi())}function mM(){return Qa(fv)}function MF(){return ea().memoizedState}function TF(){return ea().memoizedState}function Wxe(h){for(var g=h.return;g!==null;){switch(g.tag){case 24:case 3:var x=pi();h=Tu(x);var C=Au(g,h,x);C!==null&&(Js(C,g,x),q0(C,g,x)),g={cache:HE()},h.payload=g;return}g=g.return}}function Kxe(h,g,x){var C=pi();x={lane:C,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},pw(h)?DF(g,x):(x=DE(h,g,x,C),x!==null&&(Js(x,h,C),LF(x,g,C)))}function AF(h,g,x){var C=pi();Y0(h,g,x,C)}function Y0(h,g,x,C){var D={lane:C,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null};if(pw(h))DF(g,D);else{var z=h.alternate;if(h.lanes===0&&(z===null||z.lanes===0)&&(z=g.lastRenderedReducer,z!==null))try{var Y=g.lastRenderedState,ae=z(Y,x);if(D.hasEagerState=!0,D.eagerState=ae,ci(ae,Y))return Y1(h,g,D,0),fn===null&&V1(),!1}catch{}finally{}if(x=DE(h,g,D,C),x!==null)return Js(x,h,C),LF(x,g,C),!0}return!1}function pM(h,g,x,C){if(C={lane:2,revertLane:GM(),gesture:null,action:C,hasEagerState:!1,eagerState:null,next:null},pw(h)){if(g)throw Error(n(479))}else g=DE(h,x,C,2),g!==null&&Js(g,h,2)}function pw(h){var g=h.alternate;return h===ir||g!==null&&g===ir}function DF(h,g){Lm=lw=!0;var x=h.pending;x===null?g.next=g:(g.next=x.next,x.next=g),h.pending=g}function LF(h,g,x){if((x&4194048)!==0){var C=g.lanes;C&=h.pendingLanes,x|=C,g.lanes=x,it(h,x)}}var Q0={readContext:Qa,use:dw,useCallback:Fn,useContext:Fn,useEffect:Fn,useImperativeHandle:Fn,useLayoutEffect:Fn,useInsertionEffect:Fn,useMemo:Fn,useReducer:Fn,useRef:Fn,useState:Fn,useDebugValue:Fn,useDeferredValue:Fn,useTransition:Fn,useSyncExternalStore:Fn,useId:Fn,useHostTransitionStatus:Fn,useFormState:Fn,useActionState:Fn,useOptimistic:Fn,useMemoCache:Fn,useCacheRefresh:Fn};Q0.useEffectEvent=Fn;var OF={readContext:Qa,use:dw,useCallback:function(h,g){return js().memoizedState=[h,g===void 0?null:g],h},useContext:Qa,useEffect:vF,useImperativeHandle:function(h,g,x){x=x!=null?x.concat([h]):null,hw(4194308,4,wF.bind(null,g,h),x)},useLayoutEffect:function(h,g){return hw(4194308,4,h,g)},useInsertionEffect:function(h,g){hw(4,2,h,g)},useMemo:function(h,g){var x=js();g=g===void 0?null:g;var C=h();if(uf){Fe(!0);try{h()}finally{Fe(!1)}}return x.memoizedState=[C,g],C},useReducer:function(h,g,x){var C=js();if(x!==void 0){var D=x(g);if(uf){Fe(!0);try{x(g)}finally{Fe(!1)}}}else D=g;return C.memoizedState=C.baseState=D,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:D},C.queue=h,h=h.dispatch=Kxe.bind(null,ir,h),[C.memoizedState,h]},useRef:function(h){var g=js();return h={current:h},g.memoizedState=h},useState:function(h){h=lM(h);var g=h.queue,x=AF.bind(null,ir,g);return g.dispatch=x,[h.memoizedState,x]},useDebugValue:dM,useDeferredValue:function(h,g){var x=js();return fM(x,h,g)},useTransition:function(){var h=lM(!1);return h=CF.bind(null,ir,h.queue,!0,!1),js().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,g,x){var C=ir,D=js();if(Nr){if(x===void 0)throw Error(n(407));x=x()}else{if(x=g(),fn===null)throw Error(n(349));(Sr&127)!==0||tF(C,g,x)}D.memoizedState=x;var z={value:x,getSnapshot:g};return D.queue=z,vF(nF.bind(null,C,z,h),[h]),C.flags|=2048,Im(9,{destroy:void 0},rF.bind(null,C,z,x,g),null),x},useId:function(){var h=js(),g=fn.identifierPrefix;if(Nr){var x=il,C=sl;x=(C&~(1<<32-Ke(C)-1)).toString(32)+x,g="_"+g+"R_"+x,x=cw++,0<x&&(g+="H"+x.toString(32)),g+="_"}else x=Bxe++,g="_"+g+"r_"+x.toString(32)+"_";return h.memoizedState=g},useHostTransitionStatus:mM,useFormState:fF,useActionState:fF,useOptimistic:function(h){var g=js();g.memoizedState=g.baseState=h;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=x,g=pM.bind(null,ir,!0,x),x.dispatch=g,[h,g]},useMemoCache:sM,useCacheRefresh:function(){return js().memoizedState=Wxe.bind(null,ir)},useEffectEvent:function(h){var g=js(),x={impl:h};return g.memoizedState=x,function(){if((Fr&2)!==0)throw Error(n(440));return x.impl.apply(void 0,arguments)}}},gM={readContext:Qa,use:dw,useCallback:kF,useContext:Qa,useEffect:uM,useImperativeHandle:SF,useInsertionEffect:yF,useLayoutEffect:xF,useMemo:_F,useReducer:fw,useRef:gF,useState:function(){return fw(sc)},useDebugValue:dM,useDeferredValue:function(h,g){var x=ea();return NF(x,an.memoizedState,h,g)},useTransition:function(){var h=fw(sc)[0],g=ea().memoizedState;return[typeof h=="boolean"?h:V0(h),g]},useSyncExternalStore:eF,useId:MF,useHostTransitionStatus:mM,useFormState:hF,useActionState:hF,useOptimistic:function(h,g){var x=ea();return iF(x,an,h,g)},useMemoCache:sM,useCacheRefresh:TF};gM.useEffectEvent=bF;var IF={readContext:Qa,use:dw,useCallback:kF,useContext:Qa,useEffect:uM,useImperativeHandle:SF,useInsertionEffect:yF,useLayoutEffect:xF,useMemo:_F,useReducer:oM,useRef:gF,useState:function(){return oM(sc)},useDebugValue:dM,useDeferredValue:function(h,g){var x=ea();return an===null?fM(x,h,g):NF(x,an.memoizedState,h,g)},useTransition:function(){var h=oM(sc)[0],g=ea().memoizedState;return[typeof h=="boolean"?h:V0(h),g]},useSyncExternalStore:eF,useId:MF,useHostTransitionStatus:mM,useFormState:pF,useActionState:pF,useOptimistic:function(h,g){var x=ea();return an!==null?iF(x,an,h,g):(x.baseState=h,[h,x.queue.dispatch])},useMemoCache:sM,useCacheRefresh:TF};IF.useEffectEvent=bF;function vM(h,g,x,C){g=h.memoizedState,x=x(C,g),x=x==null?g:f({},g,x),h.memoizedState=x,h.lanes===0&&(h.updateQueue.baseState=x)}var bM={enqueueSetState:function(h,g,x){h=h._reactInternals;var C=pi(),D=Tu(C);D.payload=g,x!=null&&(D.callback=x),g=Au(h,D,C),g!==null&&(Js(g,h,C),q0(g,h,C))},enqueueReplaceState:function(h,g,x){h=h._reactInternals;var C=pi(),D=Tu(C);D.tag=1,D.payload=g,x!=null&&(D.callback=x),g=Au(h,D,C),g!==null&&(Js(g,h,C),q0(g,h,C))},enqueueForceUpdate:function(h,g){h=h._reactInternals;var x=pi(),C=Tu(x);C.tag=2,g!=null&&(C.callback=g),g=Au(h,C,x),g!==null&&(Js(g,h,x),q0(g,h,x))}};function RF(h,g,x,C,D,z,Y){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(C,z,Y):g.prototype&&g.prototype.isPureReactComponent?!R0(x,C)||!R0(D,z):!0}function PF(h,g,x,C){h=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(x,C),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(x,C),g.state!==h&&bM.enqueueReplaceState(g,g.state,null)}function df(h,g){var x=g;if("ref"in g){x={};for(var C in g)C!=="ref"&&(x[C]=g[C])}if(h=h.defaultProps){x===g&&(x=f({},x));for(var D in h)x[D]===void 0&&(x[D]=h[D])}return x}function zF(h){G1(h)}function BF(h){console.error(h)}function $F(h){G1(h)}function gw(h,g){try{var x=h.onUncaughtError;x(g.value,{componentStack:g.stack})}catch(C){setTimeout(function(){throw C})}}function FF(h,g,x){try{var C=h.onCaughtError;C(x.value,{componentStack:x.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function yM(h,g,x){return x=Tu(x),x.tag=3,x.payload={element:null},x.callback=function(){gw(h,g)},x}function UF(h){return h=Tu(h),h.tag=3,h}function HF(h,g,x,C){var D=x.type.getDerivedStateFromError;if(typeof D=="function"){var z=C.value;h.payload=function(){return D(z)},h.callback=function(){FF(g,x,C)}}var Y=x.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(h.callback=function(){FF(g,x,C),typeof D!="function"&&(Pu===null?Pu=new Set([this]):Pu.add(this));var ae=C.stack;this.componentDidCatch(C.value,{componentStack:ae!==null?ae:""})})}function Gxe(h,g,x,C,D){if(x.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(g=x.alternate,g!==null&&jm(g,x,D,!0),x=di.current,x!==null){switch(x.tag){case 31:case 13:return Qi===null?Ew():x.alternate===null&&Un===0&&(Un=3),x.flags&=-257,x.flags|=65536,x.lanes=D,C===nw?x.flags|=16384:(g=x.updateQueue,g===null?x.updateQueue=new Set([C]):g.add(C),qM(h,C,D)),!1;case 22:return x.flags|=65536,C===nw?x.flags|=16384:(g=x.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([C])},x.updateQueue=g):(x=g.retryQueue,x===null?g.retryQueue=new Set([C]):x.add(C)),qM(h,C,D)),!1}throw Error(n(435,x.tag))}return qM(h,C,D),Ew(),!1}if(Nr)return g=di.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=D,C!==zE&&(h=Error(n(422),{cause:C}),B0(Ki(h,x)))):(C!==zE&&(g=Error(n(423),{cause:C}),B0(Ki(g,x))),h=h.current.alternate,h.flags|=65536,D&=-D,h.lanes|=D,C=Ki(C,x),D=yM(h.stateNode,C,D),YE(h,D),Un!==4&&(Un=2)),!1;var z=Error(n(520),{cause:C});if(z=Ki(z,x),av===null?av=[z]:av.push(z),Un!==4&&(Un=2),g===null)return!0;C=Ki(C,x),x=g;do{switch(x.tag){case 3:return x.flags|=65536,h=D&-D,x.lanes|=h,h=yM(x.stateNode,C,h),YE(x,h),!1;case 1:if(g=x.type,z=x.stateNode,(x.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Pu===null||!Pu.has(z))))return x.flags|=65536,D&=-D,x.lanes|=D,D=UF(D),HF(D,h,x,C),YE(x,D),!1}x=x.return}while(x!==null);return!1}var xM=Error(n(461)),la=!1;function Ja(h,g,x,C){g.child=h===null?G8(g,null,x,C):cf(g,h.child,x,C)}function qF(h,g,x,C,D){x=x.render;var z=g.ref;if("ref"in C){var Y={};for(var ae in C)ae!=="ref"&&(Y[ae]=C[ae])}else Y=C;return af(g),C=tM(h,g,x,Y,z,D),ae=rM(),h!==null&&!la?(nM(h,g,D),ic(h,g,D)):(Nr&&ae&&RE(g),g.flags|=1,Ja(h,g,C,D),g.child)}function WF(h,g,x,C,D){if(h===null){var z=x.type;return typeof z=="function"&&!LE(z)&&z.defaultProps===void 0&&x.compare===null?(g.tag=15,g.type=z,KF(h,g,z,C,D)):(h=J1(x.type,null,C,g,g.mode,D),h.ref=g.ref,h.return=g,g.child=h)}if(z=h.child,!EM(h,D)){var Y=z.memoizedProps;if(x=x.compare,x=x!==null?x:R0,x(Y,C)&&h.ref===g.ref)return ic(h,g,D)}return g.flags|=1,h=ec(z,C),h.ref=g.ref,h.return=g,g.child=h}function KF(h,g,x,C,D){if(h!==null){var z=h.memoizedProps;if(R0(z,C)&&h.ref===g.ref)if(la=!1,g.pendingProps=C=z,EM(h,D))(h.flags&131072)!==0&&(la=!0);else return g.lanes=h.lanes,ic(h,g,D)}return wM(h,g,x,C,D)}function GF(h,g,x,C){var D=C.children,z=h!==null?h.memoizedState:null;if(h===null&&g.stateNode===null&&(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),C.mode==="hidden"){if((g.flags&128)!==0){if(z=z!==null?z.baseLanes|x:x,h!==null){for(C=g.child=h.child,D=0;C!==null;)D=D|C.lanes|C.childLanes,C=C.sibling;C=D&~z}else C=0,g.child=null;return VF(h,g,z,x,C)}if((x&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},h!==null&&tw(g,z!==null?z.cachePool:null),z!==null?Q8(g,z):JE(),J8(g);else return C=g.lanes=536870912,VF(h,g,z!==null?z.baseLanes|x:x,x,C)}else z!==null?(tw(g,z.cachePool),Q8(g,z),Lu(),g.memoizedState=null):(h!==null&&tw(g,null),JE(),Lu());return Ja(h,g,D,x),g.child}function J0(h,g){return h!==null&&h.tag===22||g.stateNode!==null||(g.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.sibling}function VF(h,g,x,C,D){var z=WE();return z=z===null?null:{parent:ia._currentValue,pool:z},g.memoizedState={baseLanes:x,cachePool:z},h!==null&&tw(g,null),JE(),J8(g),h!==null&&jm(h,g,C,!0),g.childLanes=D,null}function vw(h,g){return g=yw({mode:g.mode,children:g.children},h.mode),g.ref=h.ref,h.child=g,g.return=h,g}function YF(h,g,x){return cf(g,h.child,null,x),h=vw(g,g.pendingProps),h.flags|=2,fi(g),g.memoizedState=null,h}function Vxe(h,g,x){var C=g.pendingProps,D=(g.flags&128)!==0;if(g.flags&=-129,h===null){if(Nr){if(C.mode==="hidden")return h=vw(g,C),g.lanes=536870912,J0(null,h);if(XE(g),(h=wn)?(h=oH(h,Yi),h=h!==null&&h.data==="&"?h:null,h!==null&&(g.memoizedState={dehydrated:h,treeContext:Nu!==null?{id:sl,overflow:il}:null,retryLane:536870912,hydrationErrors:null},x=D8(h),x.return=g,g.child=x,Ya=g,wn=null)):h=null,h===null)throw ju(g);return g.lanes=536870912,null}return vw(g,C)}var z=h.memoizedState;if(z!==null){var Y=z.dehydrated;if(XE(g),D)if(g.flags&256)g.flags&=-257,g=YF(h,g,x);else if(g.memoizedState!==null)g.child=h.child,g.flags|=128,g=null;else throw Error(n(558));else if(la||jm(h,g,x,!1),D=(x&h.childLanes)!==0,la||D){if(C=fn,C!==null&&(Y=tr(C,x),Y!==0&&Y!==z.retryLane))throw z.retryLane=Y,ef(h,Y),Js(C,h,Y),xM;Ew(),g=YF(h,g,x)}else h=z.treeContext,wn=Ji(Y.nextSibling),Ya=g,Nr=!0,Cu=null,Yi=!1,h!==null&&I8(g,h),g=vw(g,C),g.flags|=4096;return g}return h=ec(h.child,{mode:C.mode,children:C.children}),h.ref=g.ref,g.child=h,h.return=g,h}function bw(h,g){var x=g.ref;if(x===null)h!==null&&h.ref!==null&&(g.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(n(284));(h===null||h.ref!==x)&&(g.flags|=4194816)}}function wM(h,g,x,C,D){return af(g),x=tM(h,g,x,C,void 0,D),C=rM(),h!==null&&!la?(nM(h,g,D),ic(h,g,D)):(Nr&&C&&RE(g),g.flags|=1,Ja(h,g,x,D),g.child)}function QF(h,g,x,C,D,z){return af(g),g.updateQueue=null,x=X8(g,C,x,D),Z8(h),C=rM(),h!==null&&!la?(nM(h,g,z),ic(h,g,z)):(Nr&&C&&RE(g),g.flags|=1,Ja(h,g,x,z),g.child)}function JF(h,g,x,C,D){if(af(g),g.stateNode===null){var z=km,Y=x.contextType;typeof Y=="object"&&Y!==null&&(z=Qa(Y)),z=new x(C,z),g.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=bM,g.stateNode=z,z._reactInternals=g,z=g.stateNode,z.props=C,z.state=g.memoizedState,z.refs={},GE(g),Y=x.contextType,z.context=typeof Y=="object"&&Y!==null?Qa(Y):km,z.state=g.memoizedState,Y=x.getDerivedStateFromProps,typeof Y=="function"&&(vM(g,x,Y,C),z.state=g.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(Y=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),Y!==z.state&&bM.enqueueReplaceState(z,z.state,null),K0(g,C,z,D),W0(),z.state=g.memoizedState),typeof z.componentDidMount=="function"&&(g.flags|=4194308),C=!0}else if(h===null){z=g.stateNode;var ae=g.memoizedProps,ye=df(x,ae);z.props=ye;var Ee=z.context,ze=x.contextType;Y=km,typeof ze=="object"&&ze!==null&&(Y=Qa(ze));var He=x.getDerivedStateFromProps;ze=typeof He=="function"||typeof z.getSnapshotBeforeUpdate=="function",ae=g.pendingProps!==ae,ze||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ae||Ee!==Y)&&PF(g,z,C,Y),Mu=!1;var Te=g.memoizedState;z.state=Te,K0(g,C,z,D),W0(),Ee=g.memoizedState,ae||Te!==Ee||Mu?(typeof He=="function"&&(vM(g,x,He,C),Ee=g.memoizedState),(ye=Mu||RF(g,x,ye,C,Te,Ee,Y))?(ze||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(g.flags|=4194308)):(typeof z.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=C,g.memoizedState=Ee),z.props=C,z.state=Ee,z.context=Y,C=ye):(typeof z.componentDidMount=="function"&&(g.flags|=4194308),C=!1)}else{z=g.stateNode,VE(h,g),Y=g.memoizedProps,ze=df(x,Y),z.props=ze,He=g.pendingProps,Te=z.context,Ee=x.contextType,ye=km,typeof Ee=="object"&&Ee!==null&&(ye=Qa(Ee)),ae=x.getDerivedStateFromProps,(Ee=typeof ae=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(Y!==He||Te!==ye)&&PF(g,z,C,ye),Mu=!1,Te=g.memoizedState,z.state=Te,K0(g,C,z,D),W0();var Ie=g.memoizedState;Y!==He||Te!==Ie||Mu||h!==null&&h.dependencies!==null&&X1(h.dependencies)?(typeof ae=="function"&&(vM(g,x,ae,C),Ie=g.memoizedState),(ze=Mu||RF(g,x,ze,C,Te,Ie,ye)||h!==null&&h.dependencies!==null&&X1(h.dependencies))?(Ee||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(C,Ie,ye),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(C,Ie,ye)),typeof z.componentDidUpdate=="function"&&(g.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof z.componentDidUpdate!="function"||Y===h.memoizedProps&&Te===h.memoizedState||(g.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||Y===h.memoizedProps&&Te===h.memoizedState||(g.flags|=1024),g.memoizedProps=C,g.memoizedState=Ie),z.props=C,z.state=Ie,z.context=ye,C=ze):(typeof z.componentDidUpdate!="function"||Y===h.memoizedProps&&Te===h.memoizedState||(g.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||Y===h.memoizedProps&&Te===h.memoizedState||(g.flags|=1024),C=!1)}return z=C,bw(h,g),C=(g.flags&128)!==0,z||C?(z=g.stateNode,x=C&&typeof x.getDerivedStateFromError!="function"?null:z.render(),g.flags|=1,h!==null&&C?(g.child=cf(g,h.child,null,D),g.child=cf(g,null,x,D)):Ja(h,g,x,D),g.memoizedState=z.state,h=g.child):h=ic(h,g,D),h}function ZF(h,g,x,C){return rf(),g.flags|=256,Ja(h,g,x,C),g.child}var SM={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kM(h){return{baseLanes:h,cachePool:F8()}}function _M(h,g,x){return h=h!==null?h.childLanes&~x:0,g&&(h|=mi),h}function XF(h,g,x){var C=g.pendingProps,D=!1,z=(g.flags&128)!==0,Y;if((Y=z)||(Y=h!==null&&h.memoizedState===null?!1:(Xn.current&2)!==0),Y&&(D=!0,g.flags&=-129),Y=(g.flags&32)!==0,g.flags&=-33,h===null){if(Nr){if(D?Du(g):Lu(),(h=wn)?(h=oH(h,Yi),h=h!==null&&h.data!=="&"?h:null,h!==null&&(g.memoizedState={dehydrated:h,treeContext:Nu!==null?{id:sl,overflow:il}:null,retryLane:536870912,hydrationErrors:null},x=D8(h),x.return=g,g.child=x,Ya=g,wn=null)):h=null,h===null)throw ju(g);return iT(h)?g.lanes=32:g.lanes=536870912,null}var ae=C.children;return C=C.fallback,D?(Lu(),D=g.mode,ae=yw({mode:"hidden",children:ae},D),C=tf(C,D,x,null),ae.return=g,C.return=g,ae.sibling=C,g.child=ae,C=g.child,C.memoizedState=kM(x),C.childLanes=_M(h,Y,x),g.memoizedState=SM,J0(null,C)):(Du(g),NM(g,ae))}var ye=h.memoizedState;if(ye!==null&&(ae=ye.dehydrated,ae!==null)){if(z)g.flags&256?(Du(g),g.flags&=-257,g=CM(h,g,x)):g.memoizedState!==null?(Lu(),g.child=h.child,g.flags|=128,g=null):(Lu(),ae=C.fallback,D=g.mode,C=yw({mode:"visible",children:C.children},D),ae=tf(ae,D,x,null),ae.flags|=2,C.return=g,ae.return=g,C.sibling=ae,g.child=C,cf(g,h.child,null,x),C=g.child,C.memoizedState=kM(x),C.childLanes=_M(h,Y,x),g.memoizedState=SM,g=J0(null,C));else if(Du(g),iT(ae)){if(Y=ae.nextSibling&&ae.nextSibling.dataset,Y)var Ee=Y.dgst;Y=Ee,C=Error(n(419)),C.stack="",C.digest=Y,B0({value:C,source:null,stack:null}),g=CM(h,g,x)}else if(la||jm(h,g,x,!1),Y=(x&h.childLanes)!==0,la||Y){if(Y=fn,Y!==null&&(C=tr(Y,x),C!==0&&C!==ye.retryLane))throw ye.retryLane=C,ef(h,C),Js(Y,h,C),xM;sT(ae)||Ew(),g=CM(h,g,x)}else sT(ae)?(g.flags|=192,g.child=h.child,g=null):(h=ye.treeContext,wn=Ji(ae.nextSibling),Ya=g,Nr=!0,Cu=null,Yi=!1,h!==null&&I8(g,h),g=NM(g,C.children),g.flags|=4096);return g}return D?(Lu(),ae=C.fallback,D=g.mode,ye=h.child,Ee=ye.sibling,C=ec(ye,{mode:"hidden",children:C.children}),C.subtreeFlags=ye.subtreeFlags&65011712,Ee!==null?ae=ec(Ee,ae):(ae=tf(ae,D,x,null),ae.flags|=2),ae.return=g,C.return=g,C.sibling=ae,g.child=C,J0(null,C),C=g.child,ae=h.child.memoizedState,ae===null?ae=kM(x):(D=ae.cachePool,D!==null?(ye=ia._currentValue,D=D.parent!==ye?{parent:ye,pool:ye}:D):D=F8(),ae={baseLanes:ae.baseLanes|x,cachePool:D}),C.memoizedState=ae,C.childLanes=_M(h,Y,x),g.memoizedState=SM,J0(h.child,C)):(Du(g),x=h.child,h=x.sibling,x=ec(x,{mode:"visible",children:C.children}),x.return=g,x.sibling=null,h!==null&&(Y=g.deletions,Y===null?(g.deletions=[h],g.flags|=16):Y.push(h)),g.child=x,g.memoizedState=null,x)}function NM(h,g){return g=yw({mode:"visible",children:g},h.mode),g.return=h,h.child=g}function yw(h,g){return h=ui(22,h,null,g),h.lanes=0,h}function CM(h,g,x){return cf(g,h.child,null,x),h=NM(g,g.pendingProps.children),h.flags|=2,g.memoizedState=null,h}function eU(h,g,x){h.lanes|=g;var C=h.alternate;C!==null&&(C.lanes|=g),FE(h.return,g,x)}function jM(h,g,x,C,D,z){var Y=h.memoizedState;Y===null?h.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:C,tail:x,tailMode:D,treeForkCount:z}:(Y.isBackwards=g,Y.rendering=null,Y.renderingStartTime=0,Y.last=C,Y.tail=x,Y.tailMode=D,Y.treeForkCount=z)}function tU(h,g,x){var C=g.pendingProps,D=C.revealOrder,z=C.tail;C=C.children;var Y=Xn.current,ae=(Y&2)!==0;if(ae?(Y=Y&1|2,g.flags|=128):Y&=1,J(Xn,Y),Ja(h,g,C,x),C=Nr?z0:0,!ae&&h!==null&&(h.flags&128)!==0)e:for(h=g.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&eU(h,x,g);else if(h.tag===19)eU(h,x,g);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===g)break e;for(;h.sibling===null;){if(h.return===null||h.return===g)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}switch(D){case"forwards":for(x=g.child,D=null;x!==null;)h=x.alternate,h!==null&&ow(h)===null&&(D=x),x=x.sibling;x=D,x===null?(D=g.child,g.child=null):(D=x.sibling,x.sibling=null),jM(g,!1,D,x,z,C);break;case"backwards":case"unstable_legacy-backwards":for(x=null,D=g.child,g.child=null;D!==null;){if(h=D.alternate,h!==null&&ow(h)===null){g.child=D;break}h=D.sibling,D.sibling=x,x=D,D=h}jM(g,!0,x,null,z,C);break;case"together":jM(g,!1,null,null,void 0,C);break;default:g.memoizedState=null}return g.child}function ic(h,g,x){if(h!==null&&(g.dependencies=h.dependencies),Ru|=g.lanes,(x&g.childLanes)===0)if(h!==null){if(jm(h,g,x,!1),(x&g.childLanes)===0)return null}else return null;if(h!==null&&g.child!==h.child)throw Error(n(153));if(g.child!==null){for(h=g.child,x=ec(h,h.pendingProps),g.child=x,x.return=g;h.sibling!==null;)h=h.sibling,x=x.sibling=ec(h,h.pendingProps),x.return=g;x.sibling=null}return g.child}function EM(h,g){return(h.lanes&g)!==0?!0:(h=h.dependencies,!!(h!==null&&X1(h)))}function Yxe(h,g,x){switch(g.tag){case 3:he(g,g.stateNode.containerInfo),Eu(g,ia,h.memoizedState.cache),rf();break;case 27:case 5:le(g);break;case 4:he(g,g.stateNode.containerInfo);break;case 10:Eu(g,g.type,g.memoizedProps.value);break;case 31:if(g.memoizedState!==null)return g.flags|=128,XE(g),null;break;case 13:var C=g.memoizedState;if(C!==null)return C.dehydrated!==null?(Du(g),g.flags|=128,null):(x&g.child.childLanes)!==0?XF(h,g,x):(Du(g),h=ic(h,g,x),h!==null?h.sibling:null);Du(g);break;case 19:var D=(h.flags&128)!==0;if(C=(x&g.childLanes)!==0,C||(jm(h,g,x,!1),C=(x&g.childLanes)!==0),D){if(C)return tU(h,g,x);g.flags|=128}if(D=g.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),J(Xn,Xn.current),C)break;return null;case 22:return g.lanes=0,GF(h,g,x,g.pendingProps);case 24:Eu(g,ia,h.memoizedState.cache)}return ic(h,g,x)}function rU(h,g,x){if(h!==null)if(h.memoizedProps!==g.pendingProps)la=!0;else{if(!EM(h,x)&&(g.flags&128)===0)return la=!1,Yxe(h,g,x);la=(h.flags&131072)!==0}else la=!1,Nr&&(g.flags&1048576)!==0&&O8(g,z0,g.index);switch(g.lanes=0,g.tag){case 16:e:{var C=g.pendingProps;if(h=of(g.elementType),g.type=h,typeof h=="function")LE(h)?(C=df(h,C),g.tag=1,g=JF(null,g,h,C,x)):(g.tag=0,g=wM(null,g,h,C,x));else{if(h!=null){var D=h.$$typeof;if(D===k){g.tag=11,g=qF(null,g,h,C,x);break e}else if(D===T){g.tag=14,g=WF(null,g,h,C,x);break e}}throw g=M(h)||h,Error(n(306,g,""))}}return g;case 0:return wM(h,g,g.type,g.pendingProps,x);case 1:return C=g.type,D=df(C,g.pendingProps),JF(h,g,C,D,x);case 3:e:{if(he(g,g.stateNode.containerInfo),h===null)throw Error(n(387));C=g.pendingProps;var z=g.memoizedState;D=z.element,VE(h,g),K0(g,C,null,x);var Y=g.memoizedState;if(C=Y.cache,Eu(g,ia,C),C!==z.cache&&UE(g,[ia],x,!0),W0(),C=Y.element,z.isDehydrated)if(z={element:C,isDehydrated:!1,cache:Y.cache},g.updateQueue.baseState=z,g.memoizedState=z,g.flags&256){g=ZF(h,g,C,x);break e}else if(C!==D){D=Ki(Error(n(424)),g),B0(D),g=ZF(h,g,C,x);break e}else{switch(h=g.stateNode.containerInfo,h.nodeType){case 9:h=h.body;break;default:h=h.nodeName==="HTML"?h.ownerDocument.body:h}for(wn=Ji(h.firstChild),Ya=g,Nr=!0,Cu=null,Yi=!0,x=G8(g,null,C,x),g.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling}else{if(rf(),C===D){g=ic(h,g,x);break e}Ja(h,g,C,x)}g=g.child}return g;case 26:return bw(h,g),h===null?(x=hH(g.type,null,g.pendingProps,null))?g.memoizedState=x:Nr||(x=g.type,h=g.pendingProps,C=Iw(se.current).createElement(x),C[ie]=g,C[xe]=h,Za(C,x,h),vn(C),g.stateNode=C):g.memoizedState=hH(g.type,h.memoizedProps,g.pendingProps,h.memoizedState),null;case 27:return le(g),h===null&&Nr&&(C=g.stateNode=uH(g.type,g.pendingProps,se.current),Ya=g,Yi=!0,D=wn,Fu(g.type)?(oT=D,wn=Ji(C.firstChild)):wn=D),Ja(h,g,g.pendingProps.children,x),bw(h,g),h===null&&(g.flags|=4194304),g.child;case 5:return h===null&&Nr&&((D=C=wn)&&(C=N1e(C,g.type,g.pendingProps,Yi),C!==null?(g.stateNode=C,Ya=g,wn=Ji(C.firstChild),Yi=!1,D=!0):D=!1),D||ju(g)),le(g),D=g.type,z=g.pendingProps,Y=h!==null?h.memoizedProps:null,C=z.children,rT(D,z)?C=null:Y!==null&&rT(D,Y)&&(g.flags|=32),g.memoizedState!==null&&(D=tM(h,g,$xe,null,null,x),fv._currentValue=D),bw(h,g),Ja(h,g,C,x),g.child;case 6:return h===null&&Nr&&((h=x=wn)&&(x=C1e(x,g.pendingProps,Yi),x!==null?(g.stateNode=x,Ya=g,wn=null,h=!0):h=!1),h||ju(g)),null;case 13:return XF(h,g,x);case 4:return he(g,g.stateNode.containerInfo),C=g.pendingProps,h===null?g.child=cf(g,null,C,x):Ja(h,g,C,x),g.child;case 11:return qF(h,g,g.type,g.pendingProps,x);case 7:return Ja(h,g,g.pendingProps,x),g.child;case 8:return Ja(h,g,g.pendingProps.children,x),g.child;case 12:return Ja(h,g,g.pendingProps.children,x),g.child;case 10:return C=g.pendingProps,Eu(g,g.type,C.value),Ja(h,g,C.children,x),g.child;case 9:return D=g.type._context,C=g.pendingProps.children,af(g),D=Qa(D),C=C(D),g.flags|=1,Ja(h,g,C,x),g.child;case 14:return WF(h,g,g.type,g.pendingProps,x);case 15:return KF(h,g,g.type,g.pendingProps,x);case 19:return tU(h,g,x);case 31:return Vxe(h,g,x);case 22:return GF(h,g,x,g.pendingProps);case 24:return af(g),C=Qa(ia),h===null?(D=WE(),D===null&&(D=fn,z=HE(),D.pooledCache=z,z.refCount++,z!==null&&(D.pooledCacheLanes|=x),D=z),g.memoizedState={parent:C,cache:D},GE(g),Eu(g,ia,D)):((h.lanes&x)!==0&&(VE(h,g),K0(g,null,null,x),W0()),D=h.memoizedState,z=g.memoizedState,D.parent!==C?(D={parent:C,cache:C},g.memoizedState=D,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=D),Eu(g,ia,C)):(C=z.cache,Eu(g,ia,C),C!==D.cache&&UE(g,[ia],x,!0))),Ja(h,g,g.pendingProps.children,x),g.child;case 29:throw g.pendingProps}throw Error(n(156,g.tag))}function oc(h){h.flags|=4}function MM(h,g,x,C,D){if((g=(h.mode&32)!==0)&&(g=!1),g){if(h.flags|=16777216,(D&335544128)===D)if(h.stateNode.complete)h.flags|=8192;else if(MU())h.flags|=8192;else throw lf=nw,KE}else h.flags&=-16777217}function nU(h,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)h.flags&=-16777217;else if(h.flags|=16777216,!bH(g))if(MU())h.flags|=8192;else throw lf=nw,KE}function xw(h,g){g!==null&&(h.flags|=4),h.flags&16384&&(g=h.tag!==22?dt():536870912,h.lanes|=g,Bm|=g)}function Z0(h,g){if(!Nr)switch(h.tailMode){case"hidden":g=h.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?h.tail=null:x.sibling=null;break;case"collapsed":x=h.tail;for(var C=null;x!==null;)x.alternate!==null&&(C=x),x=x.sibling;C===null?g||h.tail===null?h.tail=null:h.tail.sibling=null:C.sibling=null}}function Sn(h){var g=h.alternate!==null&&h.alternate.child===h.child,x=0,C=0;if(g)for(var D=h.child;D!==null;)x|=D.lanes|D.childLanes,C|=D.subtreeFlags&65011712,C|=D.flags&65011712,D.return=h,D=D.sibling;else for(D=h.child;D!==null;)x|=D.lanes|D.childLanes,C|=D.subtreeFlags,C|=D.flags,D.return=h,D=D.sibling;return h.subtreeFlags|=C,h.childLanes=x,g}function Qxe(h,g,x){var C=g.pendingProps;switch(PE(g),g.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sn(g),null;case 1:return Sn(g),null;case 3:return x=g.stateNode,C=null,h!==null&&(C=h.memoizedState.cache),g.memoizedState.cache!==C&&(g.flags|=2048),nc(ia),te(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(h===null||h.child===null)&&(Cm(g)?oc(g):h===null||h.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,BE())),Sn(g),null;case 26:var D=g.type,z=g.memoizedState;return h===null?(oc(g),z!==null?(Sn(g),nU(g,z)):(Sn(g),MM(g,D,null,C,x))):z?z!==h.memoizedState?(oc(g),Sn(g),nU(g,z)):(Sn(g),g.flags&=-16777217):(h=h.memoizedProps,h!==C&&oc(g),Sn(g),MM(g,D,h,C,x)),null;case 27:if(oe(g),x=se.current,D=g.type,h!==null&&g.stateNode!=null)h.memoizedProps!==C&&oc(g);else{if(!C){if(g.stateNode===null)throw Error(n(166));return Sn(g),null}h=X.current,Cm(g)?R8(g):(h=uH(D,C,x),g.stateNode=h,oc(g))}return Sn(g),null;case 5:if(oe(g),D=g.type,h!==null&&g.stateNode!=null)h.memoizedProps!==C&&oc(g);else{if(!C){if(g.stateNode===null)throw Error(n(166));return Sn(g),null}if(z=X.current,Cm(g))R8(g);else{var Y=Iw(se.current);switch(z){case 1:z=Y.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:z=Y.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":z=Y.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":z=Y.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":z=Y.createElement("div"),z.innerHTML="<script><\/script>",z=z.removeChild(z.firstChild);break;case"select":z=typeof C.is=="string"?Y.createElement("select",{is:C.is}):Y.createElement("select"),C.multiple?z.multiple=!0:C.size&&(z.size=C.size);break;default:z=typeof C.is=="string"?Y.createElement(D,{is:C.is}):Y.createElement(D)}}z[ie]=g,z[xe]=C;e:for(Y=g.child;Y!==null;){if(Y.tag===5||Y.tag===6)z.appendChild(Y.stateNode);else if(Y.tag!==4&&Y.tag!==27&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===g)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===g)break e;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}g.stateNode=z;e:switch(Za(z,D,C),D){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break e;case"img":C=!0;break e;default:C=!1}C&&oc(g)}}return Sn(g),MM(g,g.type,h===null?null:h.memoizedProps,g.pendingProps,x),null;case 6:if(h&&g.stateNode!=null)h.memoizedProps!==C&&oc(g);else{if(typeof C!="string"&&g.stateNode===null)throw Error(n(166));if(h=se.current,Cm(g)){if(h=g.stateNode,x=g.memoizedProps,C=null,D=Ya,D!==null)switch(D.tag){case 27:case 5:C=D.memoizedProps}h[ie]=g,h=!!(h.nodeValue===x||C!==null&&C.suppressHydrationWarning===!0||XU(h.nodeValue,x)),h||ju(g,!0)}else h=Iw(h).createTextNode(C),h[ie]=g,g.stateNode=h}return Sn(g),null;case 31:if(x=g.memoizedState,h===null||h.memoizedState!==null){if(C=Cm(g),x!==null){if(h===null){if(!C)throw Error(n(318));if(h=g.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(n(557));h[ie]=g}else rf(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Sn(g),h=!1}else x=BE(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=x),h=!0;if(!h)return g.flags&256?(fi(g),g):(fi(g),null);if((g.flags&128)!==0)throw Error(n(558))}return Sn(g),null;case 13:if(C=g.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(D=Cm(g),C!==null&&C.dehydrated!==null){if(h===null){if(!D)throw Error(n(318));if(D=g.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(n(317));D[ie]=g}else rf(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Sn(g),D=!1}else D=BE(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=D),D=!0;if(!D)return g.flags&256?(fi(g),g):(fi(g),null)}return fi(g),(g.flags&128)!==0?(g.lanes=x,g):(x=C!==null,h=h!==null&&h.memoizedState!==null,x&&(C=g.child,D=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(D=C.alternate.memoizedState.cachePool.pool),z=null,C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(z=C.memoizedState.cachePool.pool),z!==D&&(C.flags|=2048)),x!==h&&x&&(g.child.flags|=8192),xw(g,g.updateQueue),Sn(g),null);case 4:return te(),h===null&&JM(g.stateNode.containerInfo),Sn(g),null;case 10:return nc(g.type),Sn(g),null;case 19:if(G(Xn),C=g.memoizedState,C===null)return Sn(g),null;if(D=(g.flags&128)!==0,z=C.rendering,z===null)if(D)Z0(C,!1);else{if(Un!==0||h!==null&&(h.flags&128)!==0)for(h=g.child;h!==null;){if(z=ow(h),z!==null){for(g.flags|=128,Z0(C,!1),h=z.updateQueue,g.updateQueue=h,xw(g,h),g.subtreeFlags=0,h=x,x=g.child;x!==null;)A8(x,h),x=x.sibling;return J(Xn,Xn.current&1|2),Nr&&tc(g,C.treeForkCount),g.child}h=h.sibling}C.tail!==null&&Ae()>Nw&&(g.flags|=128,D=!0,Z0(C,!1),g.lanes=4194304)}else{if(!D)if(h=ow(z),h!==null){if(g.flags|=128,D=!0,h=h.updateQueue,g.updateQueue=h,xw(g,h),Z0(C,!0),C.tail===null&&C.tailMode==="hidden"&&!z.alternate&&!Nr)return Sn(g),null}else 2*Ae()-C.renderingStartTime>Nw&&x!==536870912&&(g.flags|=128,D=!0,Z0(C,!1),g.lanes=4194304);C.isBackwards?(z.sibling=g.child,g.child=z):(h=C.last,h!==null?h.sibling=z:g.child=z,C.last=z)}return C.tail!==null?(h=C.tail,C.rendering=h,C.tail=h.sibling,C.renderingStartTime=Ae(),h.sibling=null,x=Xn.current,J(Xn,D?x&1|2:x&1),Nr&&tc(g,C.treeForkCount),h):(Sn(g),null);case 22:case 23:return fi(g),ZE(),C=g.memoizedState!==null,h!==null?h.memoizedState!==null!==C&&(g.flags|=8192):C&&(g.flags|=8192),C?(x&536870912)!==0&&(g.flags&128)===0&&(Sn(g),g.subtreeFlags&6&&(g.flags|=8192)):Sn(g),x=g.updateQueue,x!==null&&xw(g,x.retryQueue),x=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==x&&(g.flags|=2048),h!==null&&G(sf),null;case 24:return x=null,h!==null&&(x=h.memoizedState.cache),g.memoizedState.cache!==x&&(g.flags|=2048),nc(ia),Sn(g),null;case 25:return null;case 30:return null}throw Error(n(156,g.tag))}function Jxe(h,g){switch(PE(g),g.tag){case 1:return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 3:return nc(ia),te(),h=g.flags,(h&65536)!==0&&(h&128)===0?(g.flags=h&-65537|128,g):null;case 26:case 27:case 5:return oe(g),null;case 31:if(g.memoizedState!==null){if(fi(g),g.alternate===null)throw Error(n(340));rf()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 13:if(fi(g),h=g.memoizedState,h!==null&&h.dehydrated!==null){if(g.alternate===null)throw Error(n(340));rf()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 19:return G(Xn),null;case 4:return te(),null;case 10:return nc(g.type),null;case 22:case 23:return fi(g),ZE(),h!==null&&G(sf),h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 24:return nc(ia),null;case 25:return null;default:return null}}function aU(h,g){switch(PE(g),g.tag){case 3:nc(ia),te();break;case 26:case 27:case 5:oe(g);break;case 4:te();break;case 31:g.memoizedState!==null&&fi(g);break;case 13:fi(g);break;case 19:G(Xn);break;case 10:nc(g.type);break;case 22:case 23:fi(g),ZE(),h!==null&&G(sf);break;case 24:nc(ia)}}function X0(h,g){try{var x=g.updateQueue,C=x!==null?x.lastEffect:null;if(C!==null){var D=C.next;x=D;do{if((x.tag&h)===h){C=void 0;var z=x.create,Y=x.inst;C=z(),Y.destroy=C}x=x.next}while(x!==D)}}catch(ae){Xr(g,g.return,ae)}}function Ou(h,g,x){try{var C=g.updateQueue,D=C!==null?C.lastEffect:null;if(D!==null){var z=D.next;C=z;do{if((C.tag&h)===h){var Y=C.inst,ae=Y.destroy;if(ae!==void 0){Y.destroy=void 0,D=g;var ye=x,Ee=ae;try{Ee()}catch(ze){Xr(D,ye,ze)}}}C=C.next}while(C!==z)}}catch(ze){Xr(g,g.return,ze)}}function sU(h){var g=h.updateQueue;if(g!==null){var x=h.stateNode;try{Y8(g,x)}catch(C){Xr(h,h.return,C)}}}function iU(h,g,x){x.props=df(h.type,h.memoizedProps),x.state=h.memoizedState;try{x.componentWillUnmount()}catch(C){Xr(h,g,C)}}function ev(h,g){try{var x=h.ref;if(x!==null){switch(h.tag){case 26:case 27:case 5:var C=h.stateNode;break;case 30:C=h.stateNode;break;default:C=h.stateNode}typeof x=="function"?h.refCleanup=x(C):x.current=C}}catch(D){Xr(h,g,D)}}function ol(h,g){var x=h.ref,C=h.refCleanup;if(x!==null)if(typeof C=="function")try{C()}catch(D){Xr(h,g,D)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(D){Xr(h,g,D)}else x.current=null}function oU(h){var g=h.type,x=h.memoizedProps,C=h.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":x.autoFocus&&C.focus();break e;case"img":x.src?C.src=x.src:x.srcSet&&(C.srcset=x.srcSet)}}catch(D){Xr(h,h.return,D)}}function TM(h,g,x){try{var C=h.stateNode;y1e(C,h.type,x,g),C[xe]=g}catch(D){Xr(h,h.return,D)}}function lU(h){return h.tag===5||h.tag===3||h.tag===26||h.tag===27&&Fu(h.type)||h.tag===4}function AM(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||lU(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.tag===27&&Fu(h.type)||h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function DM(h,g,x){var C=h.tag;if(C===5||C===6)h=h.stateNode,g?(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x).insertBefore(h,g):(g=x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,g.appendChild(h),x=x._reactRootContainer,x!=null||g.onclick!==null||(g.onclick=st));else if(C!==4&&(C===27&&Fu(h.type)&&(x=h.stateNode,g=null),h=h.child,h!==null))for(DM(h,g,x),h=h.sibling;h!==null;)DM(h,g,x),h=h.sibling}function ww(h,g,x){var C=h.tag;if(C===5||C===6)h=h.stateNode,g?x.insertBefore(h,g):x.appendChild(h);else if(C!==4&&(C===27&&Fu(h.type)&&(x=h.stateNode),h=h.child,h!==null))for(ww(h,g,x),h=h.sibling;h!==null;)ww(h,g,x),h=h.sibling}function cU(h){var g=h.stateNode,x=h.memoizedProps;try{for(var C=h.type,D=g.attributes;D.length;)g.removeAttributeNode(D[0]);Za(g,C,x),g[ie]=h,g[xe]=x}catch(z){Xr(h,h.return,z)}}var lc=!1,ca=!1,LM=!1,uU=typeof WeakSet=="function"?WeakSet:Set,Da=null;function Zxe(h,g){if(h=h.containerInfo,eT=Uw,h=S8(h),CE(h)){if("selectionStart"in h)var x={start:h.selectionStart,end:h.selectionEnd};else e:{x=(x=h.ownerDocument)&&x.defaultView||window;var C=x.getSelection&&x.getSelection();if(C&&C.rangeCount!==0){x=C.anchorNode;var D=C.anchorOffset,z=C.focusNode;C=C.focusOffset;try{x.nodeType,z.nodeType}catch{x=null;break e}var Y=0,ae=-1,ye=-1,Ee=0,ze=0,He=h,Te=null;t:for(;;){for(var Ie;He!==x||D!==0&&He.nodeType!==3||(ae=Y+D),He!==z||C!==0&&He.nodeType!==3||(ye=Y+C),He.nodeType===3&&(Y+=He.nodeValue.length),(Ie=He.firstChild)!==null;)Te=He,He=Ie;for(;;){if(He===h)break t;if(Te===x&&++Ee===D&&(ae=Y),Te===z&&++ze===C&&(ye=Y),(Ie=He.nextSibling)!==null)break;He=Te,Te=He.parentNode}He=Ie}x=ae===-1||ye===-1?null:{start:ae,end:ye}}else x=null}x=x||{start:0,end:0}}else x=null;for(tT={focusedElem:h,selectionRange:x},Uw=!1,Da=g;Da!==null;)if(g=Da,h=g.child,(g.subtreeFlags&1028)!==0&&h!==null)h.return=g,Da=h;else for(;Da!==null;){switch(g=Da,z=g.alternate,h=g.flags,g.tag){case 0:if((h&4)!==0&&(h=g.updateQueue,h=h!==null?h.events:null,h!==null))for(x=0;x<h.length;x++)D=h[x],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((h&1024)!==0&&z!==null){h=void 0,x=g,D=z.memoizedProps,z=z.memoizedState,C=x.stateNode;try{var St=df(x.type,D);h=C.getSnapshotBeforeUpdate(St,z),C.__reactInternalSnapshotBeforeUpdate=h}catch(Wt){Xr(x,x.return,Wt)}}break;case 3:if((h&1024)!==0){if(h=g.stateNode.containerInfo,x=h.nodeType,x===9)aT(h);else if(x===1)switch(h.nodeName){case"HEAD":case"HTML":case"BODY":aT(h);break;default:h.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(n(163))}if(h=g.sibling,h!==null){h.return=g.return,Da=h;break}Da=g.return}}function dU(h,g,x){var C=x.flags;switch(x.tag){case 0:case 11:case 15:uc(h,x),C&4&&X0(5,x);break;case 1:if(uc(h,x),C&4)if(h=x.stateNode,g===null)try{h.componentDidMount()}catch(Y){Xr(x,x.return,Y)}else{var D=df(x.type,g.memoizedProps);g=g.memoizedState;try{h.componentDidUpdate(D,g,h.__reactInternalSnapshotBeforeUpdate)}catch(Y){Xr(x,x.return,Y)}}C&64&&sU(x),C&512&&ev(x,x.return);break;case 3:if(uc(h,x),C&64&&(h=x.updateQueue,h!==null)){if(g=null,x.child!==null)switch(x.child.tag){case 27:case 5:g=x.child.stateNode;break;case 1:g=x.child.stateNode}try{Y8(h,g)}catch(Y){Xr(x,x.return,Y)}}break;case 27:g===null&&C&4&&cU(x);case 26:case 5:uc(h,x),g===null&&C&4&&oU(x),C&512&&ev(x,x.return);break;case 12:uc(h,x);break;case 31:uc(h,x),C&4&&mU(h,x);break;case 13:uc(h,x),C&4&&pU(h,x),C&64&&(h=x.memoizedState,h!==null&&(h=h.dehydrated,h!==null&&(x=o1e.bind(null,x),j1e(h,x))));break;case 22:if(C=x.memoizedState!==null||lc,!C){g=g!==null&&g.memoizedState!==null||ca,D=lc;var z=ca;lc=C,(ca=g)&&!z?dc(h,x,(x.subtreeFlags&8772)!==0):uc(h,x),lc=D,ca=z}break;case 30:break;default:uc(h,x)}}function fU(h){var g=h.alternate;g!==null&&(h.alternate=null,fU(g)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(g=h.stateNode,g!==null&&Bt(g)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}var jn=null,Gs=!1;function cc(h,g,x){for(x=x.child;x!==null;)hU(h,g,x),x=x.sibling}function hU(h,g,x){if(Ne&&typeof Ne.onCommitFiberUnmount=="function")try{Ne.onCommitFiberUnmount(at,x)}catch{}switch(x.tag){case 26:ca||ol(x,g),cc(h,g,x),x.memoizedState?x.memoizedState.count--:x.stateNode&&(x=x.stateNode,x.parentNode.removeChild(x));break;case 27:ca||ol(x,g);var C=jn,D=Gs;Fu(x.type)&&(jn=x.stateNode,Gs=!1),cc(h,g,x),cv(x.stateNode),jn=C,Gs=D;break;case 5:ca||ol(x,g);case 6:if(C=jn,D=Gs,jn=null,cc(h,g,x),jn=C,Gs=D,jn!==null)if(Gs)try{(jn.nodeType===9?jn.body:jn.nodeName==="HTML"?jn.ownerDocument.body:jn).removeChild(x.stateNode)}catch(z){Xr(x,g,z)}else try{jn.removeChild(x.stateNode)}catch(z){Xr(x,g,z)}break;case 18:jn!==null&&(Gs?(h=jn,sH(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,x.stateNode),Gm(h)):sH(jn,x.stateNode));break;case 4:C=jn,D=Gs,jn=x.stateNode.containerInfo,Gs=!0,cc(h,g,x),jn=C,Gs=D;break;case 0:case 11:case 14:case 15:Ou(2,x,g),ca||Ou(4,x,g),cc(h,g,x);break;case 1:ca||(ol(x,g),C=x.stateNode,typeof C.componentWillUnmount=="function"&&iU(x,g,C)),cc(h,g,x);break;case 21:cc(h,g,x);break;case 22:ca=(C=ca)||x.memoizedState!==null,cc(h,g,x),ca=C;break;default:cc(h,g,x)}}function mU(h,g){if(g.memoizedState===null&&(h=g.alternate,h!==null&&(h=h.memoizedState,h!==null))){h=h.dehydrated;try{Gm(h)}catch(x){Xr(g,g.return,x)}}}function pU(h,g){if(g.memoizedState===null&&(h=g.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{Gm(h)}catch(x){Xr(g,g.return,x)}}function Xxe(h){switch(h.tag){case 31:case 13:case 19:var g=h.stateNode;return g===null&&(g=h.stateNode=new uU),g;case 22:return h=h.stateNode,g=h._retryCache,g===null&&(g=h._retryCache=new uU),g;default:throw Error(n(435,h.tag))}}function Sw(h,g){var x=Xxe(h);g.forEach(function(C){if(!x.has(C)){x.add(C);var D=l1e.bind(null,h,C);C.then(D,D)}})}function Vs(h,g){var x=g.deletions;if(x!==null)for(var C=0;C<x.length;C++){var D=x[C],z=h,Y=g,ae=Y;e:for(;ae!==null;){switch(ae.tag){case 27:if(Fu(ae.type)){jn=ae.stateNode,Gs=!1;break e}break;case 5:jn=ae.stateNode,Gs=!1;break e;case 3:case 4:jn=ae.stateNode.containerInfo,Gs=!0;break e}ae=ae.return}if(jn===null)throw Error(n(160));hU(z,Y,D),jn=null,Gs=!1,z=D.alternate,z!==null&&(z.return=null),D.return=null}if(g.subtreeFlags&13886)for(g=g.child;g!==null;)gU(g,h),g=g.sibling}var Ao=null;function gU(h,g){var x=h.alternate,C=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Vs(g,h),Ys(h),C&4&&(Ou(3,h,h.return),X0(3,h),Ou(5,h,h.return));break;case 1:Vs(g,h),Ys(h),C&512&&(ca||x===null||ol(x,x.return)),C&64&&lc&&(h=h.updateQueue,h!==null&&(C=h.callbacks,C!==null&&(x=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=x===null?C:x.concat(C))));break;case 26:var D=Ao;if(Vs(g,h),Ys(h),C&512&&(ca||x===null||ol(x,x.return)),C&4){var z=x!==null?x.memoizedState:null;if(C=h.memoizedState,x===null)if(C===null)if(h.stateNode===null){e:{C=h.type,x=h.memoizedProps,D=D.ownerDocument||D;t:switch(C){case"title":z=D.getElementsByTagName("title")[0],(!z||z[ct]||z[ie]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=D.createElement(C),D.head.insertBefore(z,D.querySelector("head > title"))),Za(z,C,x),z[ie]=h,vn(z),C=z;break e;case"link":var Y=gH("link","href",D).get(C+(x.href||""));if(Y){for(var ae=0;ae<Y.length;ae++)if(z=Y[ae],z.getAttribute("href")===(x.href==null||x.href===""?null:x.href)&&z.getAttribute("rel")===(x.rel==null?null:x.rel)&&z.getAttribute("title")===(x.title==null?null:x.title)&&z.getAttribute("crossorigin")===(x.crossOrigin==null?null:x.crossOrigin)){Y.splice(ae,1);break t}}z=D.createElement(C),Za(z,C,x),D.head.appendChild(z);break;case"meta":if(Y=gH("meta","content",D).get(C+(x.content||""))){for(ae=0;ae<Y.length;ae++)if(z=Y[ae],z.getAttribute("content")===(x.content==null?null:""+x.content)&&z.getAttribute("name")===(x.name==null?null:x.name)&&z.getAttribute("property")===(x.property==null?null:x.property)&&z.getAttribute("http-equiv")===(x.httpEquiv==null?null:x.httpEquiv)&&z.getAttribute("charset")===(x.charSet==null?null:x.charSet)){Y.splice(ae,1);break t}}z=D.createElement(C),Za(z,C,x),D.head.appendChild(z);break;default:throw Error(n(468,C))}z[ie]=h,vn(z),C=z}h.stateNode=C}else vH(D,h.type,h.stateNode);else h.stateNode=pH(D,C,h.memoizedProps);else z!==C?(z===null?x.stateNode!==null&&(x=x.stateNode,x.parentNode.removeChild(x)):z.count--,C===null?vH(D,h.type,h.stateNode):pH(D,C,h.memoizedProps)):C===null&&h.stateNode!==null&&TM(h,h.memoizedProps,x.memoizedProps)}break;case 27:Vs(g,h),Ys(h),C&512&&(ca||x===null||ol(x,x.return)),x!==null&&C&4&&TM(h,h.memoizedProps,x.memoizedProps);break;case 5:if(Vs(g,h),Ys(h),C&512&&(ca||x===null||ol(x,x.return)),h.flags&32){D=h.stateNode;try{Kt(D,"")}catch(St){Xr(h,h.return,St)}}C&4&&h.stateNode!=null&&(D=h.memoizedProps,TM(h,D,x!==null?x.memoizedProps:D)),C&1024&&(LM=!0);break;case 6:if(Vs(g,h),Ys(h),C&4){if(h.stateNode===null)throw Error(n(162));C=h.memoizedProps,x=h.stateNode;try{x.nodeValue=C}catch(St){Xr(h,h.return,St)}}break;case 3:if(zw=null,D=Ao,Ao=Rw(g.containerInfo),Vs(g,h),Ao=D,Ys(h),C&4&&x!==null&&x.memoizedState.isDehydrated)try{Gm(g.containerInfo)}catch(St){Xr(h,h.return,St)}LM&&(LM=!1,vU(h));break;case 4:C=Ao,Ao=Rw(h.stateNode.containerInfo),Vs(g,h),Ys(h),Ao=C;break;case 12:Vs(g,h),Ys(h);break;case 31:Vs(g,h),Ys(h),C&4&&(C=h.updateQueue,C!==null&&(h.updateQueue=null,Sw(h,C)));break;case 13:Vs(g,h),Ys(h),h.child.flags&8192&&h.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&(_w=Ae()),C&4&&(C=h.updateQueue,C!==null&&(h.updateQueue=null,Sw(h,C)));break;case 22:D=h.memoizedState!==null;var ye=x!==null&&x.memoizedState!==null,Ee=lc,ze=ca;if(lc=Ee||D,ca=ze||ye,Vs(g,h),ca=ze,lc=Ee,Ys(h),C&8192)e:for(g=h.stateNode,g._visibility=D?g._visibility&-2:g._visibility|1,D&&(x===null||ye||lc||ca||ff(h)),x=null,g=h;;){if(g.tag===5||g.tag===26){if(x===null){ye=x=g;try{if(z=ye.stateNode,D)Y=z.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{ae=ye.stateNode;var He=ye.memoizedProps.style,Te=He!=null&&He.hasOwnProperty("display")?He.display:null;ae.style.display=Te==null||typeof Te=="boolean"?"":(""+Te).trim()}}catch(St){Xr(ye,ye.return,St)}}}else if(g.tag===6){if(x===null){ye=g;try{ye.stateNode.nodeValue=D?"":ye.memoizedProps}catch(St){Xr(ye,ye.return,St)}}}else if(g.tag===18){if(x===null){ye=g;try{var Ie=ye.stateNode;D?iH(Ie,!0):iH(ye.stateNode,!1)}catch(St){Xr(ye,ye.return,St)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===h)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break e;for(;g.sibling===null;){if(g.return===null||g.return===h)break e;x===g&&(x=null),g=g.return}x===g&&(x=null),g.sibling.return=g.return,g=g.sibling}C&4&&(C=h.updateQueue,C!==null&&(x=C.retryQueue,x!==null&&(C.retryQueue=null,Sw(h,x))));break;case 19:Vs(g,h),Ys(h),C&4&&(C=h.updateQueue,C!==null&&(h.updateQueue=null,Sw(h,C)));break;case 30:break;case 21:break;default:Vs(g,h),Ys(h)}}function Ys(h){var g=h.flags;if(g&2){try{for(var x,C=h.return;C!==null;){if(lU(C)){x=C;break}C=C.return}if(x==null)throw Error(n(160));switch(x.tag){case 27:var D=x.stateNode,z=AM(h);ww(h,z,D);break;case 5:var Y=x.stateNode;x.flags&32&&(Kt(Y,""),x.flags&=-33);var ae=AM(h);ww(h,ae,Y);break;case 3:case 4:var ye=x.stateNode.containerInfo,Ee=AM(h);DM(h,Ee,ye);break;default:throw Error(n(161))}}catch(ze){Xr(h,h.return,ze)}h.flags&=-3}g&4096&&(h.flags&=-4097)}function vU(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var g=h;vU(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),h=h.sibling}}function uc(h,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)dU(h,g.alternate,g),g=g.sibling}function ff(h){for(h=h.child;h!==null;){var g=h;switch(g.tag){case 0:case 11:case 14:case 15:Ou(4,g,g.return),ff(g);break;case 1:ol(g,g.return);var x=g.stateNode;typeof x.componentWillUnmount=="function"&&iU(g,g.return,x),ff(g);break;case 27:cv(g.stateNode);case 26:case 5:ol(g,g.return),ff(g);break;case 22:g.memoizedState===null&&ff(g);break;case 30:ff(g);break;default:ff(g)}h=h.sibling}}function dc(h,g,x){for(x=x&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var C=g.alternate,D=h,z=g,Y=z.flags;switch(z.tag){case 0:case 11:case 15:dc(D,z,x),X0(4,z);break;case 1:if(dc(D,z,x),C=z,D=C.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(Ee){Xr(C,C.return,Ee)}if(C=z,D=C.updateQueue,D!==null){var ae=C.stateNode;try{var ye=D.shared.hiddenCallbacks;if(ye!==null)for(D.shared.hiddenCallbacks=null,D=0;D<ye.length;D++)V8(ye[D],ae)}catch(Ee){Xr(C,C.return,Ee)}}x&&Y&64&&sU(z),ev(z,z.return);break;case 27:cU(z);case 26:case 5:dc(D,z,x),x&&C===null&&Y&4&&oU(z),ev(z,z.return);break;case 12:dc(D,z,x);break;case 31:dc(D,z,x),x&&Y&4&&mU(D,z);break;case 13:dc(D,z,x),x&&Y&4&&pU(D,z);break;case 22:z.memoizedState===null&&dc(D,z,x),ev(z,z.return);break;case 30:break;default:dc(D,z,x)}g=g.sibling}}function OM(h,g){var x=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),h=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(h=g.memoizedState.cachePool.pool),h!==x&&(h!=null&&h.refCount++,x!=null&&$0(x))}function IM(h,g){h=null,g.alternate!==null&&(h=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==h&&(g.refCount++,h!=null&&$0(h))}function Do(h,g,x,C){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)bU(h,g,x,C),g=g.sibling}function bU(h,g,x,C){var D=g.flags;switch(g.tag){case 0:case 11:case 15:Do(h,g,x,C),D&2048&&X0(9,g);break;case 1:Do(h,g,x,C);break;case 3:Do(h,g,x,C),D&2048&&(h=null,g.alternate!==null&&(h=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==h&&(g.refCount++,h!=null&&$0(h)));break;case 12:if(D&2048){Do(h,g,x,C),h=g.stateNode;try{var z=g.memoizedProps,Y=z.id,ae=z.onPostCommit;typeof ae=="function"&&ae(Y,g.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(ye){Xr(g,g.return,ye)}}else Do(h,g,x,C);break;case 31:Do(h,g,x,C);break;case 13:Do(h,g,x,C);break;case 23:break;case 22:z=g.stateNode,Y=g.alternate,g.memoizedState!==null?z._visibility&2?Do(h,g,x,C):tv(h,g):z._visibility&2?Do(h,g,x,C):(z._visibility|=2,Rm(h,g,x,C,(g.subtreeFlags&10256)!==0||!1)),D&2048&&OM(Y,g);break;case 24:Do(h,g,x,C),D&2048&&IM(g.alternate,g);break;default:Do(h,g,x,C)}}function Rm(h,g,x,C,D){for(D=D&&((g.subtreeFlags&10256)!==0||!1),g=g.child;g!==null;){var z=h,Y=g,ae=x,ye=C,Ee=Y.flags;switch(Y.tag){case 0:case 11:case 15:Rm(z,Y,ae,ye,D),X0(8,Y);break;case 23:break;case 22:var ze=Y.stateNode;Y.memoizedState!==null?ze._visibility&2?Rm(z,Y,ae,ye,D):tv(z,Y):(ze._visibility|=2,Rm(z,Y,ae,ye,D)),D&&Ee&2048&&OM(Y.alternate,Y);break;case 24:Rm(z,Y,ae,ye,D),D&&Ee&2048&&IM(Y.alternate,Y);break;default:Rm(z,Y,ae,ye,D)}g=g.sibling}}function tv(h,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var x=h,C=g,D=C.flags;switch(C.tag){case 22:tv(x,C),D&2048&&OM(C.alternate,C);break;case 24:tv(x,C),D&2048&&IM(C.alternate,C);break;default:tv(x,C)}g=g.sibling}}var rv=8192;function Pm(h,g,x){if(h.subtreeFlags&rv)for(h=h.child;h!==null;)yU(h,g,x),h=h.sibling}function yU(h,g,x){switch(h.tag){case 26:Pm(h,g,x),h.flags&rv&&h.memoizedState!==null&&B1e(x,Ao,h.memoizedState,h.memoizedProps);break;case 5:Pm(h,g,x);break;case 3:case 4:var C=Ao;Ao=Rw(h.stateNode.containerInfo),Pm(h,g,x),Ao=C;break;case 22:h.memoizedState===null&&(C=h.alternate,C!==null&&C.memoizedState!==null?(C=rv,rv=16777216,Pm(h,g,x),rv=C):Pm(h,g,x));break;default:Pm(h,g,x)}}function xU(h){var g=h.alternate;if(g!==null&&(h=g.child,h!==null)){g.child=null;do g=h.sibling,h.sibling=null,h=g;while(h!==null)}}function nv(h){var g=h.deletions;if((h.flags&16)!==0){if(g!==null)for(var x=0;x<g.length;x++){var C=g[x];Da=C,SU(C,h)}xU(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)wU(h),h=h.sibling}function wU(h){switch(h.tag){case 0:case 11:case 15:nv(h),h.flags&2048&&Ou(9,h,h.return);break;case 3:nv(h);break;case 12:nv(h);break;case 22:var g=h.stateNode;h.memoizedState!==null&&g._visibility&2&&(h.return===null||h.return.tag!==13)?(g._visibility&=-3,kw(h)):nv(h);break;default:nv(h)}}function kw(h){var g=h.deletions;if((h.flags&16)!==0){if(g!==null)for(var x=0;x<g.length;x++){var C=g[x];Da=C,SU(C,h)}xU(h)}for(h=h.child;h!==null;){switch(g=h,g.tag){case 0:case 11:case 15:Ou(8,g,g.return),kw(g);break;case 22:x=g.stateNode,x._visibility&2&&(x._visibility&=-3,kw(g));break;default:kw(g)}h=h.sibling}}function SU(h,g){for(;Da!==null;){var x=Da;switch(x.tag){case 0:case 11:case 15:Ou(8,x,g);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var C=x.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:$0(x.memoizedState.cache)}if(C=x.child,C!==null)C.return=x,Da=C;else e:for(x=h;Da!==null;){C=Da;var D=C.sibling,z=C.return;if(fU(C),C===x){Da=null;break e}if(D!==null){D.return=z,Da=D;break e}Da=z}}}var e1e={getCacheForType:function(h){var g=Qa(ia),x=g.data.get(h);return x===void 0&&(x=h(),g.data.set(h,x)),x},cacheSignal:function(){return Qa(ia).controller.signal}},t1e=typeof WeakMap=="function"?WeakMap:Map,Fr=0,fn=null,vr=null,Sr=0,Zr=0,hi=null,Iu=!1,zm=!1,RM=!1,fc=0,Un=0,Ru=0,hf=0,PM=0,mi=0,Bm=0,av=null,Qs=null,zM=!1,_w=0,kU=0,Nw=1/0,Cw=null,Pu=null,xa=0,zu=null,$m=null,hc=0,BM=0,$M=null,_U=null,sv=0,FM=null;function pi(){return(Fr&2)!==0&&Sr!==0?Sr&-Sr:I.T!==null?GM():We()}function NU(){if(mi===0)if((Sr&536870912)===0||Nr){var h=nt;nt<<=1,(nt&3932160)===0&&(nt=262144),mi=h}else mi=536870912;return h=di.current,h!==null&&(h.flags|=32),mi}function Js(h,g,x){(h===fn&&(Zr===2||Zr===9)||h.cancelPendingCommit!==null)&&(Fm(h,0),Bu(h,Sr,mi,!1)),Mt(h,x),((Fr&2)===0||h!==fn)&&(h===fn&&((Fr&2)===0&&(hf|=x),Un===4&&Bu(h,Sr,mi,!1)),ll(h))}function CU(h,g,x){if((Fr&6)!==0)throw Error(n(327));var C=!x&&(g&127)===0&&(g&h.expiredLanes)===0||De(h,g),D=C?a1e(h,g):HM(h,g,!0),z=C;do{if(D===0){zm&&!C&&Bu(h,g,0,!1);break}else{if(x=h.current.alternate,z&&!r1e(x)){D=HM(h,g,!1),z=!1;continue}if(D===2){if(z=g,h.errorRecoveryDisabledLanes&z)var Y=0;else Y=h.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){g=Y;e:{var ae=h;D=av;var ye=ae.current.memoizedState.isDehydrated;if(ye&&(Fm(ae,Y).flags|=256),Y=HM(ae,Y,!1),Y!==2){if(RM&&!ye){ae.errorRecoveryDisabledLanes|=z,hf|=z,D=4;break e}z=Qs,Qs=D,z!==null&&(Qs===null?Qs=z:Qs.push.apply(Qs,z))}D=Y}if(z=!1,D!==2)continue}}if(D===1){Fm(h,0),Bu(h,g,0,!0);break}e:{switch(C=h,z=D,z){case 0:case 1:throw Error(n(345));case 4:if((g&4194048)!==g)break;case 6:Bu(C,g,mi,!Iu);break e;case 2:Qs=null;break;case 3:case 5:break;default:throw Error(n(329))}if((g&62914560)===g&&(D=_w+300-Ae(),10<D)){if(Bu(C,g,mi,!Iu),fe(C,0,!0)!==0)break e;hc=g,C.timeoutHandle=nH(jU.bind(null,C,x,Qs,Cw,zM,g,mi,hf,Bm,Iu,z,"Throttled",-0,0),D);break e}jU(C,x,Qs,Cw,zM,g,mi,hf,Bm,Iu,z,null,-0,0)}}break}while(!0);ll(h)}function jU(h,g,x,C,D,z,Y,ae,ye,Ee,ze,He,Te,Ie){if(h.timeoutHandle=-1,He=g.subtreeFlags,He&8192||(He&16785408)===16785408){He={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:st},yU(g,z,He);var St=(z&62914560)===z?_w-Ae():(z&4194048)===z?kU-Ae():0;if(St=$1e(He,St),St!==null){hc=z,h.cancelPendingCommit=St(IU.bind(null,h,g,z,x,C,D,Y,ae,ye,ze,He,null,Te,Ie)),Bu(h,z,Y,!Ee);return}}IU(h,g,z,x,C,D,Y,ae,ye)}function r1e(h){for(var g=h;;){var x=g.tag;if((x===0||x===11||x===15)&&g.flags&16384&&(x=g.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var C=0;C<x.length;C++){var D=x[C],z=D.getSnapshot;D=D.value;try{if(!ci(z(),D))return!1}catch{return!1}}if(x=g.child,g.subtreeFlags&16384&&x!==null)x.return=g,g=x;else{if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Bu(h,g,x,C){g&=~PM,g&=~hf,h.suspendedLanes|=g,h.pingedLanes&=~g,C&&(h.warmLanes|=g),C=h.expirationTimes;for(var D=g;0<D;){var z=31-Ke(D),Y=1<<z;C[z]=-1,D&=~Y}x!==0&&et(h,x,g)}function jw(){return(Fr&6)===0?(iv(0),!1):!0}function UM(){if(vr!==null){if(Zr===0)var h=vr.return;else h=vr,rc=nf=null,aM(h),Am=null,U0=0,h=vr;for(;h!==null;)aU(h.alternate,h),h=h.return;vr=null}}function Fm(h,g){var x=h.timeoutHandle;x!==-1&&(h.timeoutHandle=-1,S1e(x)),x=h.cancelPendingCommit,x!==null&&(h.cancelPendingCommit=null,x()),hc=0,UM(),fn=h,vr=x=ec(h.current,null),Sr=g,Zr=0,hi=null,Iu=!1,zm=De(h,g),RM=!1,Bm=mi=PM=hf=Ru=Un=0,Qs=av=null,zM=!1,(g&8)!==0&&(g|=g&32);var C=h.entangledLanes;if(C!==0)for(h=h.entanglements,C&=g;0<C;){var D=31-Ke(C),z=1<<D;g|=h[D],C&=~z}return fc=g,V1(),x}function EU(h,g){ir=null,I.H=Q0,g===Tm||g===rw?(g=q8(),Zr=3):g===KE?(g=q8(),Zr=4):Zr=g===xM?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,hi=g,vr===null&&(Un=1,gw(h,Ki(g,h.current)))}function MU(){var h=di.current;return h===null?!0:(Sr&4194048)===Sr?Qi===null:(Sr&62914560)===Sr||(Sr&536870912)!==0?h===Qi:!1}function TU(){var h=I.H;return I.H=Q0,h===null?Q0:h}function AU(){var h=I.A;return I.A=e1e,h}function Ew(){Un=4,Iu||(Sr&4194048)!==Sr&&di.current!==null||(zm=!0),(Ru&134217727)===0&&(hf&134217727)===0||fn===null||Bu(fn,Sr,mi,!1)}function HM(h,g,x){var C=Fr;Fr|=2;var D=TU(),z=AU();(fn!==h||Sr!==g)&&(Cw=null,Fm(h,g)),g=!1;var Y=Un;e:do try{if(Zr!==0&&vr!==null){var ae=vr,ye=hi;switch(Zr){case 8:UM(),Y=6;break e;case 3:case 2:case 9:case 6:di.current===null&&(g=!0);var Ee=Zr;if(Zr=0,hi=null,Um(h,ae,ye,Ee),x&&zm){Y=0;break e}break;default:Ee=Zr,Zr=0,hi=null,Um(h,ae,ye,Ee)}}n1e(),Y=Un;break}catch(ze){EU(h,ze)}while(!0);return g&&h.shellSuspendCounter++,rc=nf=null,Fr=C,I.H=D,I.A=z,vr===null&&(fn=null,Sr=0,V1()),Y}function n1e(){for(;vr!==null;)DU(vr)}function a1e(h,g){var x=Fr;Fr|=2;var C=TU(),D=AU();fn!==h||Sr!==g?(Cw=null,Nw=Ae()+500,Fm(h,g)):zm=De(h,g);e:do try{if(Zr!==0&&vr!==null){g=vr;var z=hi;t:switch(Zr){case 1:Zr=0,hi=null,Um(h,g,z,1);break;case 2:case 9:if(U8(z)){Zr=0,hi=null,LU(g);break}g=function(){Zr!==2&&Zr!==9||fn!==h||(Zr=7),ll(h)},z.then(g,g);break e;case 3:Zr=7;break e;case 4:Zr=5;break e;case 7:U8(z)?(Zr=0,hi=null,LU(g)):(Zr=0,hi=null,Um(h,g,z,7));break;case 5:var Y=null;switch(vr.tag){case 26:Y=vr.memoizedState;case 5:case 27:var ae=vr;if(Y?bH(Y):ae.stateNode.complete){Zr=0,hi=null;var ye=ae.sibling;if(ye!==null)vr=ye;else{var Ee=ae.return;Ee!==null?(vr=Ee,Mw(Ee)):vr=null}break t}}Zr=0,hi=null,Um(h,g,z,5);break;case 6:Zr=0,hi=null,Um(h,g,z,6);break;case 8:UM(),Un=6;break e;default:throw Error(n(462))}}s1e();break}catch(ze){EU(h,ze)}while(!0);return rc=nf=null,I.H=C,I.A=D,Fr=x,vr!==null?0:(fn=null,Sr=0,V1(),Un)}function s1e(){for(;vr!==null&&!pe();)DU(vr)}function DU(h){var g=rU(h.alternate,h,fc);h.memoizedProps=h.pendingProps,g===null?Mw(h):vr=g}function LU(h){var g=h,x=g.alternate;switch(g.tag){case 15:case 0:g=QF(x,g,g.pendingProps,g.type,void 0,Sr);break;case 11:g=QF(x,g,g.pendingProps,g.type.render,g.ref,Sr);break;case 5:aM(g);default:aU(x,g),g=vr=A8(g,fc),g=rU(x,g,fc)}h.memoizedProps=h.pendingProps,g===null?Mw(h):vr=g}function Um(h,g,x,C){rc=nf=null,aM(g),Am=null,U0=0;var D=g.return;try{if(Gxe(h,D,g,x,Sr)){Un=1,gw(h,Ki(x,h.current)),vr=null;return}}catch(z){if(D!==null)throw vr=D,z;Un=1,gw(h,Ki(x,h.current)),vr=null;return}g.flags&32768?(Nr||C===1?h=!0:zm||(Sr&536870912)!==0?h=!1:(Iu=h=!0,(C===2||C===9||C===3||C===6)&&(C=di.current,C!==null&&C.tag===13&&(C.flags|=16384))),OU(g,h)):Mw(g)}function Mw(h){var g=h;do{if((g.flags&32768)!==0){OU(g,Iu);return}h=g.return;var x=Qxe(g.alternate,g,fc);if(x!==null){vr=x;return}if(g=g.sibling,g!==null){vr=g;return}vr=g=h}while(g!==null);Un===0&&(Un=5)}function OU(h,g){do{var x=Jxe(h.alternate,h);if(x!==null){x.flags&=32767,vr=x;return}if(x=h.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!g&&(h=h.sibling,h!==null)){vr=h;return}vr=h=x}while(h!==null);Un=6,vr=null}function IU(h,g,x,C,D,z,Y,ae,ye){h.cancelPendingCommit=null;do Tw();while(xa!==0);if((Fr&6)!==0)throw Error(n(327));if(g!==null){if(g===h.current)throw Error(n(177));if(z=g.lanes|g.childLanes,z|=AE,Je(h,x,z,Y,ae,ye),h===fn&&(vr=fn=null,Sr=0),$m=g,zu=h,hc=x,BM=z,$M=D,_U=C,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(h.callbackNode=null,h.callbackPriority=0,c1e(lt,function(){return $U(),null})):(h.callbackNode=null,h.callbackPriority=0),C=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||C){C=I.T,I.T=null,D=B.p,B.p=2,Y=Fr,Fr|=4;try{Zxe(h,g,x)}finally{Fr=Y,B.p=D,I.T=C}}xa=1,RU(),PU(),zU()}}function RU(){if(xa===1){xa=0;var h=zu,g=$m,x=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||x){x=I.T,I.T=null;var C=B.p;B.p=2;var D=Fr;Fr|=4;try{gU(g,h);var z=tT,Y=S8(h.containerInfo),ae=z.focusedElem,ye=z.selectionRange;if(Y!==ae&&ae&&ae.ownerDocument&&w8(ae.ownerDocument.documentElement,ae)){if(ye!==null&&CE(ae)){var Ee=ye.start,ze=ye.end;if(ze===void 0&&(ze=Ee),"selectionStart"in ae)ae.selectionStart=Ee,ae.selectionEnd=Math.min(ze,ae.value.length);else{var He=ae.ownerDocument||document,Te=He&&He.defaultView||window;if(Te.getSelection){var Ie=Te.getSelection(),St=ae.textContent.length,Wt=Math.min(ye.start,St),on=ye.end===void 0?Wt:Math.min(ye.end,St);!Ie.extend&&Wt>on&&(Y=on,on=Wt,Wt=Y);var _e=x8(ae,Wt),Se=x8(ae,on);if(_e&&Se&&(Ie.rangeCount!==1||Ie.anchorNode!==_e.node||Ie.anchorOffset!==_e.offset||Ie.focusNode!==Se.node||Ie.focusOffset!==Se.offset)){var je=He.createRange();je.setStart(_e.node,_e.offset),Ie.removeAllRanges(),Wt>on?(Ie.addRange(je),Ie.extend(Se.node,Se.offset)):(je.setEnd(Se.node,Se.offset),Ie.addRange(je))}}}}for(He=[],Ie=ae;Ie=Ie.parentNode;)Ie.nodeType===1&&He.push({element:Ie,left:Ie.scrollLeft,top:Ie.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<He.length;ae++){var $e=He[ae];$e.element.scrollLeft=$e.left,$e.element.scrollTop=$e.top}}Uw=!!eT,tT=eT=null}finally{Fr=D,B.p=C,I.T=x}}h.current=g,xa=2}}function PU(){if(xa===2){xa=0;var h=zu,g=$m,x=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||x){x=I.T,I.T=null;var C=B.p;B.p=2;var D=Fr;Fr|=4;try{dU(h,g.alternate,g)}finally{Fr=D,B.p=C,I.T=x}}xa=3}}function zU(){if(xa===4||xa===3){xa=0,Oe();var h=zu,g=$m,x=hc,C=_U;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?xa=5:(xa=0,$m=zu=null,BU(h,h.pendingLanes));var D=h.pendingLanes;if(D===0&&(Pu=null),Le(x),g=g.stateNode,Ne&&typeof Ne.onCommitFiberRoot=="function")try{Ne.onCommitFiberRoot(at,g,void 0,(g.current.flags&128)===128)}catch{}if(C!==null){g=I.T,D=B.p,B.p=2,I.T=null;try{for(var z=h.onRecoverableError,Y=0;Y<C.length;Y++){var ae=C[Y];z(ae.value,{componentStack:ae.stack})}}finally{I.T=g,B.p=D}}(hc&3)!==0&&Tw(),ll(h),D=h.pendingLanes,(x&261930)!==0&&(D&42)!==0?h===FM?sv++:(sv=0,FM=h):sv=0,iv(0)}}function BU(h,g){(h.pooledCacheLanes&=g)===0&&(g=h.pooledCache,g!=null&&(h.pooledCache=null,$0(g)))}function Tw(){return RU(),PU(),zU(),$U()}function $U(){if(xa!==5)return!1;var h=zu,g=BM;BM=0;var x=Le(hc),C=I.T,D=B.p;try{B.p=32>x?32:x,I.T=null,x=$M,$M=null;var z=zu,Y=hc;if(xa=0,$m=zu=null,hc=0,(Fr&6)!==0)throw Error(n(331));var ae=Fr;if(Fr|=4,wU(z.current),bU(z,z.current,Y,x),Fr=ae,iv(0,!1),Ne&&typeof Ne.onPostCommitFiberRoot=="function")try{Ne.onPostCommitFiberRoot(at,z)}catch{}return!0}finally{B.p=D,I.T=C,BU(h,g)}}function FU(h,g,x){g=Ki(x,g),g=yM(h.stateNode,g,2),h=Au(h,g,2),h!==null&&(Mt(h,2),ll(h))}function Xr(h,g,x){if(h.tag===3)FU(h,h,x);else for(;g!==null;){if(g.tag===3){FU(g,h,x);break}else if(g.tag===1){var C=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(Pu===null||!Pu.has(C))){h=Ki(x,h),x=UF(2),C=Au(g,x,2),C!==null&&(HF(x,C,g,h),Mt(C,2),ll(C));break}}g=g.return}}function qM(h,g,x){var C=h.pingCache;if(C===null){C=h.pingCache=new t1e;var D=new Set;C.set(g,D)}else D=C.get(g),D===void 0&&(D=new Set,C.set(g,D));D.has(x)||(RM=!0,D.add(x),h=i1e.bind(null,h,g,x),g.then(h,h))}function i1e(h,g,x){var C=h.pingCache;C!==null&&C.delete(g),h.pingedLanes|=h.suspendedLanes&x,h.warmLanes&=~x,fn===h&&(Sr&x)===x&&(Un===4||Un===3&&(Sr&62914560)===Sr&&300>Ae()-_w?(Fr&2)===0&&Fm(h,0):PM|=x,Bm===Sr&&(Bm=0)),ll(h)}function UU(h,g){g===0&&(g=dt()),h=ef(h,g),h!==null&&(Mt(h,g),ll(h))}function o1e(h){var g=h.memoizedState,x=0;g!==null&&(x=g.retryLane),UU(h,x)}function l1e(h,g){var x=0;switch(h.tag){case 31:case 13:var C=h.stateNode,D=h.memoizedState;D!==null&&(x=D.retryLane);break;case 19:C=h.stateNode;break;case 22:C=h.stateNode._retryCache;break;default:throw Error(n(314))}C!==null&&C.delete(g),UU(h,x)}function c1e(h,g){return ke(h,g)}var Aw=null,Hm=null,WM=!1,Dw=!1,KM=!1,$u=0;function ll(h){h!==Hm&&h.next===null&&(Hm===null?Aw=Hm=h:Hm=Hm.next=h),Dw=!0,WM||(WM=!0,d1e())}function iv(h,g){if(!KM&&Dw){KM=!0;do for(var x=!1,C=Aw;C!==null;){if(h!==0){var D=C.pendingLanes;if(D===0)var z=0;else{var Y=C.suspendedLanes,ae=C.pingedLanes;z=(1<<31-Ke(42|h)+1)-1,z&=D&~(Y&~ae),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(x=!0,KU(C,z))}else z=Sr,z=fe(C,C===fn?z:0,C.cancelPendingCommit!==null||C.timeoutHandle!==-1),(z&3)===0||De(C,z)||(x=!0,KU(C,z));C=C.next}while(x);KM=!1}}function u1e(){HU()}function HU(){Dw=WM=!1;var h=0;$u!==0&&w1e()&&(h=$u);for(var g=Ae(),x=null,C=Aw;C!==null;){var D=C.next,z=qU(C,g);z===0?(C.next=null,x===null?Aw=D:x.next=D,D===null&&(Hm=x)):(x=C,(h!==0||(z&3)!==0)&&(Dw=!0)),C=D}xa!==0&&xa!==5||iv(h),$u!==0&&($u=0)}function qU(h,g){for(var x=h.suspendedLanes,C=h.pingedLanes,D=h.expirationTimes,z=h.pendingLanes&-62914561;0<z;){var Y=31-Ke(z),ae=1<<Y,ye=D[Y];ye===-1?((ae&x)===0||(ae&C)!==0)&&(D[Y]=Ue(ae,g)):ye<=g&&(h.expiredLanes|=ae),z&=~ae}if(g=fn,x=Sr,x=fe(h,h===g?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),C=h.callbackNode,x===0||h===g&&(Zr===2||Zr===9)||h.cancelPendingCommit!==null)return C!==null&&C!==null&&we(C),h.callbackNode=null,h.callbackPriority=0;if((x&3)===0||De(h,x)){if(g=x&-x,g===h.callbackPriority)return g;switch(C!==null&&we(C),Le(x)){case 2:case 8:x=gt;break;case 32:x=lt;break;case 268435456:x=fr;break;default:x=lt}return C=WU.bind(null,h),x=ke(x,C),h.callbackPriority=g,h.callbackNode=x,g}return C!==null&&C!==null&&we(C),h.callbackPriority=2,h.callbackNode=null,2}function WU(h,g){if(xa!==0&&xa!==5)return h.callbackNode=null,h.callbackPriority=0,null;var x=h.callbackNode;if(Tw()&&h.callbackNode!==x)return null;var C=Sr;return C=fe(h,h===fn?C:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),C===0?null:(CU(h,C,g),qU(h,Ae()),h.callbackNode!=null&&h.callbackNode===x?WU.bind(null,h):null)}function KU(h,g){if(Tw())return null;CU(h,g,!0)}function d1e(){k1e(function(){(Fr&6)!==0?ke(Ve,u1e):HU()})}function GM(){if($u===0){var h=Em;h===0&&(h=Xe,Xe<<=1,(Xe&261888)===0&&(Xe=256)),$u=h}return $u}function GU(h){return h==null||typeof h=="symbol"||typeof h=="boolean"?null:typeof h=="function"?h:ku(""+h)}function VU(h,g){var x=g.ownerDocument.createElement("input");return x.name=g.name,x.value=g.value,h.id&&x.setAttribute("form",h.id),g.parentNode.insertBefore(x,g),h=new FormData(h),x.parentNode.removeChild(x),h}function f1e(h,g,x,C,D){if(g==="submit"&&x&&x.stateNode===D){var z=GU((D[xe]||null).action),Y=C.submitter;Y&&(g=(g=Y[xe]||null)?GU(g.formAction):Y.getAttribute("formAction"),g!==null&&(z=g,Y=null));var ae=new q1("action","action",null,C,D);h.push({event:ae,listeners:[{instance:null,listener:function(){if(C.defaultPrevented){if($u!==0){var ye=Y?VU(D,Y):new FormData(D);hM(x,{pending:!0,data:ye,method:D.method,action:z},null,ye)}}else typeof z=="function"&&(ae.preventDefault(),ye=Y?VU(D,Y):new FormData(D),hM(x,{pending:!0,data:ye,method:D.method,action:z},z,ye))},currentTarget:D}]})}}for(var VM=0;VM<TE.length;VM++){var YM=TE[VM],h1e=YM.toLowerCase(),m1e=YM[0].toUpperCase()+YM.slice(1);To(h1e,"on"+m1e)}To(N8,"onAnimationEnd"),To(C8,"onAnimationIteration"),To(j8,"onAnimationStart"),To("dblclick","onDoubleClick"),To("focusin","onFocus"),To("focusout","onBlur"),To(Txe,"onTransitionRun"),To(Axe,"onTransitionStart"),To(Dxe,"onTransitionCancel"),To(E8,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),Mo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ov="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p1e=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ov));function YU(h,g){g=(g&4)!==0;for(var x=0;x<h.length;x++){var C=h[x],D=C.event;C=C.listeners;e:{var z=void 0;if(g)for(var Y=C.length-1;0<=Y;Y--){var ae=C[Y],ye=ae.instance,Ee=ae.currentTarget;if(ae=ae.listener,ye!==z&&D.isPropagationStopped())break e;z=ae,D.currentTarget=Ee;try{z(D)}catch(ze){G1(ze)}D.currentTarget=null,z=ye}else for(Y=0;Y<C.length;Y++){if(ae=C[Y],ye=ae.instance,Ee=ae.currentTarget,ae=ae.listener,ye!==z&&D.isPropagationStopped())break e;z=ae,D.currentTarget=Ee;try{z(D)}catch(ze){G1(ze)}D.currentTarget=null,z=ye}}}}function br(h,g){var x=g[ht];x===void 0&&(x=g[ht]=new Set);var C=h+"__bubble";x.has(C)||(QU(g,h,2,!1),x.add(C))}function QM(h,g,x){var C=0;g&&(C|=4),QU(x,h,C,g)}var Lw="_reactListening"+Math.random().toString(36).slice(2);function JM(h){if(!h[Lw]){h[Lw]=!0,gm.forEach(function(x){x!=="selectionchange"&&(p1e.has(x)||QM(x,!1,h),QM(x,!0,h))});var g=h.nodeType===9?h:h.ownerDocument;g===null||g[Lw]||(g[Lw]=!0,QM("selectionchange",!1,g))}}function QU(h,g,x,C){switch(NH(g)){case 2:var D=H1e;break;case 8:D=q1e;break;default:D=fT}x=D.bind(null,g,x,h),D=void 0,!vE||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(D=!0),C?D!==void 0?h.addEventListener(g,x,{capture:!0,passive:D}):h.addEventListener(g,x,!0):D!==void 0?h.addEventListener(g,x,{passive:D}):h.addEventListener(g,x,!1)}function ZM(h,g,x,C,D){var z=C;if((g&1)===0&&(g&2)===0&&C!==null)e:for(;;){if(C===null)return;var Y=C.tag;if(Y===3||Y===4){var ae=C.stateNode.containerInfo;if(ae===D)break;if(Y===4)for(Y=C.return;Y!==null;){var ye=Y.tag;if((ye===3||ye===4)&&Y.stateNode.containerInfo===D)return;Y=Y.return}for(;ae!==null;){if(Y=ut(ae),Y===null)return;if(ye=Y.tag,ye===5||ye===6||ye===26||ye===27){C=z=Y;continue e}ae=ae.parentNode}}C=C.return}$1(function(){var Ee=z,ze=ar(x),He=[];e:{var Te=M8.get(h);if(Te!==void 0){var Ie=q1,St=h;switch(h){case"keypress":if(U1(x)===0)break e;case"keydown":case"keyup":Ie=lxe;break;case"focusin":St="focus",Ie=wE;break;case"focusout":St="blur",Ie=wE;break;case"beforeblur":case"afterblur":Ie=wE;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=a8;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=Qye;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=dxe;break;case N8:case C8:case j8:Ie=Xye;break;case E8:Ie=hxe;break;case"scroll":case"scrollend":Ie=Vye;break;case"wheel":Ie=pxe;break;case"copy":case"cut":case"paste":Ie=txe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=i8;break;case"toggle":case"beforetoggle":Ie=vxe}var Wt=(g&4)!==0,on=!Wt&&(h==="scroll"||h==="scrollend"),_e=Wt?Te!==null?Te+"Capture":null:Te;Wt=[];for(var Se=Ee,je;Se!==null;){var $e=Se;if(je=$e.stateNode,$e=$e.tag,$e!==5&&$e!==26&&$e!==27||je===null||_e===null||($e=M0(Se,_e),$e!=null&&Wt.push(lv(Se,$e,je))),on)break;Se=Se.return}0<Wt.length&&(Te=new Ie(Te,St,null,x,ze),He.push({event:Te,listeners:Wt}))}}if((g&7)===0){e:{if(Te=h==="mouseover"||h==="pointerover",Ie=h==="mouseout"||h==="pointerout",Te&&x!==jt&&(St=x.relatedTarget||x.fromElement)&&(ut(St)||St[Ce]))break e;if((Ie||Te)&&(Te=ze.window===ze?ze:(Te=ze.ownerDocument)?Te.defaultView||Te.parentWindow:window,Ie?(St=x.relatedTarget||x.toElement,Ie=Ee,St=St?ut(St):null,St!==null&&(on=s(St),Wt=St.tag,St!==on||Wt!==5&&Wt!==27&&Wt!==6)&&(St=null)):(Ie=null,St=Ee),Ie!==St)){if(Wt=a8,$e="onMouseLeave",_e="onMouseEnter",Se="mouse",(h==="pointerout"||h==="pointerover")&&(Wt=i8,$e="onPointerLeave",_e="onPointerEnter",Se="pointer"),on=Ie==null?Te:nr(Ie),je=St==null?Te:nr(St),Te=new Wt($e,Se+"leave",Ie,x,ze),Te.target=on,Te.relatedTarget=je,$e=null,ut(ze)===Ee&&(Wt=new Wt(_e,Se+"enter",St,x,ze),Wt.target=je,Wt.relatedTarget=on,$e=Wt),on=$e,Ie&&St)t:{for(Wt=g1e,_e=Ie,Se=St,je=0,$e=_e;$e;$e=Wt($e))je++;$e=0;for(var $t=Se;$t;$t=Wt($t))$e++;for(;0<je-$e;)_e=Wt(_e),je--;for(;0<$e-je;)Se=Wt(Se),$e--;for(;je--;){if(_e===Se||Se!==null&&_e===Se.alternate){Wt=_e;break t}_e=Wt(_e),Se=Wt(Se)}Wt=null}else Wt=null;Ie!==null&&JU(He,Te,Ie,Wt,!1),St!==null&&on!==null&&JU(He,on,St,Wt,!0)}}e:{if(Te=Ee?nr(Ee):window,Ie=Te.nodeName&&Te.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&Te.type==="file")var Lr=m8;else if(f8(Te))if(p8)Lr=jxe;else{Lr=Nxe;var Et=_xe}else Ie=Te.nodeName,!Ie||Ie.toLowerCase()!=="input"||Te.type!=="checkbox"&&Te.type!=="radio"?Ee&&Su(Ee.elementType)&&(Lr=m8):Lr=Cxe;if(Lr&&(Lr=Lr(h,Ee))){h8(He,Lr,x,ze);break e}Et&&Et(h,Te,Ee),h==="focusout"&&Ee&&Te.type==="number"&&Ee.memoizedProps.value!=null&&wu(Te,"number",Te.value)}switch(Et=Ee?nr(Ee):window,h){case"focusin":(f8(Et)||Et.contentEditable==="true")&&(xm=Et,jE=Ee,P0=null);break;case"focusout":P0=jE=xm=null;break;case"mousedown":EE=!0;break;case"contextmenu":case"mouseup":case"dragend":EE=!1,k8(He,x,ze);break;case"selectionchange":if(Mxe)break;case"keydown":case"keyup":k8(He,x,ze)}var lr;if(kE)e:{switch(h){case"compositionstart":var kr="onCompositionStart";break e;case"compositionend":kr="onCompositionEnd";break e;case"compositionupdate":kr="onCompositionUpdate";break e}kr=void 0}else ym?u8(h,x)&&(kr="onCompositionEnd"):h==="keydown"&&x.keyCode===229&&(kr="onCompositionStart");kr&&(o8&&x.locale!=="ko"&&(ym||kr!=="onCompositionStart"?kr==="onCompositionEnd"&&ym&&(lr=r8()):(_u=ze,bE="value"in _u?_u.value:_u.textContent,ym=!0)),Et=Ow(Ee,kr),0<Et.length&&(kr=new s8(kr,h,null,x,ze),He.push({event:kr,listeners:Et}),lr?kr.data=lr:(lr=d8(x),lr!==null&&(kr.data=lr)))),(lr=yxe?xxe(h,x):wxe(h,x))&&(kr=Ow(Ee,"onBeforeInput"),0<kr.length&&(Et=new s8("onBeforeInput","beforeinput",null,x,ze),He.push({event:Et,listeners:kr}),Et.data=lr)),f1e(He,h,Ee,x,ze)}YU(He,g)})}function lv(h,g,x){return{instance:h,listener:g,currentTarget:x}}function Ow(h,g){for(var x=g+"Capture",C=[];h!==null;){var D=h,z=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||z===null||(D=M0(h,x),D!=null&&C.unshift(lv(h,D,z)),D=M0(h,g),D!=null&&C.push(lv(h,D,z))),h.tag===3)return C;h=h.return}return[]}function g1e(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5&&h.tag!==27);return h||null}function JU(h,g,x,C,D){for(var z=g._reactName,Y=[];x!==null&&x!==C;){var ae=x,ye=ae.alternate,Ee=ae.stateNode;if(ae=ae.tag,ye!==null&&ye===C)break;ae!==5&&ae!==26&&ae!==27||Ee===null||(ye=Ee,D?(Ee=M0(x,z),Ee!=null&&Y.unshift(lv(x,Ee,ye))):D||(Ee=M0(x,z),Ee!=null&&Y.push(lv(x,Ee,ye)))),x=x.return}Y.length!==0&&h.push({event:g,listeners:Y})}var v1e=/\r\n?/g,b1e=/\u0000|\uFFFD/g;function ZU(h){return(typeof h=="string"?h:""+h).replace(v1e,`
`).replace(b1e,"")}function XU(h,g){return g=ZU(g),ZU(h)===g}function sn(h,g,x,C,D,z){switch(x){case"children":typeof C=="string"?g==="body"||g==="textarea"&&C===""||Kt(h,C):(typeof C=="number"||typeof C=="bigint")&&g!=="body"&&Kt(h,""+C);break;case"className":Ns(h,"class",C);break;case"tabIndex":Ns(h,"tabindex",C);break;case"dir":case"role":case"viewBox":case"width":case"height":Ns(h,x,C);break;case"style":Jr(h,C,z);break;case"data":if(g!=="object"){Ns(h,"data",C);break}case"src":case"href":if(C===""&&(g!=="a"||x!=="href")){h.removeAttribute(x);break}if(C==null||typeof C=="function"||typeof C=="symbol"||typeof C=="boolean"){h.removeAttribute(x);break}C=ku(""+C),h.setAttribute(x,C);break;case"action":case"formAction":if(typeof C=="function"){h.setAttribute(x,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(x==="formAction"?(g!=="input"&&sn(h,g,"name",D.name,D,null),sn(h,g,"formEncType",D.formEncType,D,null),sn(h,g,"formMethod",D.formMethod,D,null),sn(h,g,"formTarget",D.formTarget,D,null)):(sn(h,g,"encType",D.encType,D,null),sn(h,g,"method",D.method,D,null),sn(h,g,"target",D.target,D,null)));if(C==null||typeof C=="symbol"||typeof C=="boolean"){h.removeAttribute(x);break}C=ku(""+C),h.setAttribute(x,C);break;case"onClick":C!=null&&(h.onclick=st);break;case"onScroll":C!=null&&br("scroll",h);break;case"onScrollEnd":C!=null&&br("scrollend",h);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(n(61));if(x=C.__html,x!=null){if(D.children!=null)throw Error(n(60));h.innerHTML=x}}break;case"multiple":h.multiple=C&&typeof C!="function"&&typeof C!="symbol";break;case"muted":h.muted=C&&typeof C!="function"&&typeof C!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(C==null||typeof C=="function"||typeof C=="boolean"||typeof C=="symbol"){h.removeAttribute("xlink:href");break}x=ku(""+C),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",x);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":C!=null&&typeof C!="function"&&typeof C!="symbol"?h.setAttribute(x,""+C):h.removeAttribute(x);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":C&&typeof C!="function"&&typeof C!="symbol"?h.setAttribute(x,""):h.removeAttribute(x);break;case"capture":case"download":C===!0?h.setAttribute(x,""):C!==!1&&C!=null&&typeof C!="function"&&typeof C!="symbol"?h.setAttribute(x,C):h.removeAttribute(x);break;case"cols":case"rows":case"size":case"span":C!=null&&typeof C!="function"&&typeof C!="symbol"&&!isNaN(C)&&1<=C?h.setAttribute(x,C):h.removeAttribute(x);break;case"rowSpan":case"start":C==null||typeof C=="function"||typeof C=="symbol"||isNaN(C)?h.removeAttribute(x):h.setAttribute(x,C);break;case"popover":br("beforetoggle",h),br("toggle",h),Aa(h,"popover",C);break;case"xlinkActuate":hs(h,"http://www.w3.org/1999/xlink","xlink:actuate",C);break;case"xlinkArcrole":hs(h,"http://www.w3.org/1999/xlink","xlink:arcrole",C);break;case"xlinkRole":hs(h,"http://www.w3.org/1999/xlink","xlink:role",C);break;case"xlinkShow":hs(h,"http://www.w3.org/1999/xlink","xlink:show",C);break;case"xlinkTitle":hs(h,"http://www.w3.org/1999/xlink","xlink:title",C);break;case"xlinkType":hs(h,"http://www.w3.org/1999/xlink","xlink:type",C);break;case"xmlBase":hs(h,"http://www.w3.org/XML/1998/namespace","xml:base",C);break;case"xmlLang":hs(h,"http://www.w3.org/XML/1998/namespace","xml:lang",C);break;case"xmlSpace":hs(h,"http://www.w3.org/XML/1998/namespace","xml:space",C);break;case"is":Aa(h,"is",C);break;case"innerText":case"textContent":break;default:(!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(x=Zl.get(x)||x,Aa(h,x,C))}}function XM(h,g,x,C,D,z){switch(x){case"style":Jr(h,C,z);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(n(61));if(x=C.__html,x!=null){if(D.children!=null)throw Error(n(60));h.innerHTML=x}}break;case"children":typeof C=="string"?Kt(h,C):(typeof C=="number"||typeof C=="bigint")&&Kt(h,""+C);break;case"onScroll":C!=null&&br("scroll",h);break;case"onScrollEnd":C!=null&&br("scrollend",h);break;case"onClick":C!=null&&(h.onclick=st);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gl.hasOwnProperty(x))e:{if(x[0]==="o"&&x[1]==="n"&&(D=x.endsWith("Capture"),g=x.slice(2,D?x.length-7:void 0),z=h[xe]||null,z=z!=null?z[x]:null,typeof z=="function"&&h.removeEventListener(g,z,D),typeof C=="function")){typeof z!="function"&&z!==null&&(x in h?h[x]=null:h.hasAttribute(x)&&h.removeAttribute(x)),h.addEventListener(g,C,D);break e}x in h?h[x]=C:C===!0?h.setAttribute(x,""):Aa(h,x,C)}}}function Za(h,g,x){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":br("error",h),br("load",h);var C=!1,D=!1,z;for(z in x)if(x.hasOwnProperty(z)){var Y=x[z];if(Y!=null)switch(z){case"src":C=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,g));default:sn(h,g,z,Y,x,null)}}D&&sn(h,g,"srcSet",x.srcSet,x,null),C&&sn(h,g,"src",x.src,x,null);return;case"input":br("invalid",h);var ae=z=Y=D=null,ye=null,Ee=null;for(C in x)if(x.hasOwnProperty(C)){var ze=x[C];if(ze!=null)switch(C){case"name":D=ze;break;case"type":Y=ze;break;case"checked":ye=ze;break;case"defaultChecked":Ee=ze;break;case"value":z=ze;break;case"defaultValue":ae=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(n(137,g));break;default:sn(h,g,C,ze,x,null)}}Jl(h,z,ae,ye,Ee,Y,D,!1);return;case"select":br("invalid",h),C=Y=z=null;for(D in x)if(x.hasOwnProperty(D)&&(ae=x[D],ae!=null))switch(D){case"value":z=ae;break;case"defaultValue":Y=ae;break;case"multiple":C=ae;default:sn(h,g,D,ae,x,null)}g=z,x=Y,h.multiple=!!C,g!=null?aa(h,!!C,g,!1):x!=null&&aa(h,!!C,x,!0);return;case"textarea":br("invalid",h),z=D=C=null;for(Y in x)if(x.hasOwnProperty(Y)&&(ae=x[Y],ae!=null))switch(Y){case"value":C=ae;break;case"defaultValue":D=ae;break;case"children":z=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(n(91));break;default:sn(h,g,Y,ae,x,null)}bm(h,C,D,z);return;case"option":for(ye in x)if(x.hasOwnProperty(ye)&&(C=x[ye],C!=null))switch(ye){case"selected":h.selected=C&&typeof C!="function"&&typeof C!="symbol";break;default:sn(h,g,ye,C,x,null)}return;case"dialog":br("beforetoggle",h),br("toggle",h),br("cancel",h),br("close",h);break;case"iframe":case"object":br("load",h);break;case"video":case"audio":for(C=0;C<ov.length;C++)br(ov[C],h);break;case"image":br("error",h),br("load",h);break;case"details":br("toggle",h);break;case"embed":case"source":case"link":br("error",h),br("load",h);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in x)if(x.hasOwnProperty(Ee)&&(C=x[Ee],C!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,g));default:sn(h,g,Ee,C,x,null)}return;default:if(Su(g)){for(ze in x)x.hasOwnProperty(ze)&&(C=x[ze],C!==void 0&&XM(h,g,ze,C,x,void 0));return}}for(ae in x)x.hasOwnProperty(ae)&&(C=x[ae],C!=null&&sn(h,g,ae,C,x,null))}function y1e(h,g,x,C){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,z=null,Y=null,ae=null,ye=null,Ee=null,ze=null;for(Ie in x){var He=x[Ie];if(x.hasOwnProperty(Ie)&&He!=null)switch(Ie){case"checked":break;case"value":break;case"defaultValue":ye=He;default:C.hasOwnProperty(Ie)||sn(h,g,Ie,null,C,He)}}for(var Te in C){var Ie=C[Te];if(He=x[Te],C.hasOwnProperty(Te)&&(Ie!=null||He!=null))switch(Te){case"type":z=Ie;break;case"name":D=Ie;break;case"checked":Ee=Ie;break;case"defaultChecked":ze=Ie;break;case"value":Y=Ie;break;case"defaultValue":ae=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,g));break;default:Ie!==He&&sn(h,g,Te,Ie,C,He)}}Ql(h,Y,ae,ye,Ee,ze,z,D);return;case"select":Ie=Y=ae=Te=null;for(z in x)if(ye=x[z],x.hasOwnProperty(z)&&ye!=null)switch(z){case"value":break;case"multiple":Ie=ye;default:C.hasOwnProperty(z)||sn(h,g,z,null,C,ye)}for(D in C)if(z=C[D],ye=x[D],C.hasOwnProperty(D)&&(z!=null||ye!=null))switch(D){case"value":Te=z;break;case"defaultValue":ae=z;break;case"multiple":Y=z;default:z!==ye&&sn(h,g,D,z,C,ye)}g=ae,x=Y,C=Ie,Te!=null?aa(h,!!x,Te,!1):!!C!=!!x&&(g!=null?aa(h,!!x,g,!0):aa(h,!!x,x?[]:"",!1));return;case"textarea":Ie=Te=null;for(ae in x)if(D=x[ae],x.hasOwnProperty(ae)&&D!=null&&!C.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:sn(h,g,ae,null,C,D)}for(Y in C)if(D=C[Y],z=x[Y],C.hasOwnProperty(Y)&&(D!=null||z!=null))switch(Y){case"value":Te=D;break;case"defaultValue":Ie=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:D!==z&&sn(h,g,Y,D,C,z)}z1(h,Te,Ie);return;case"option":for(var St in x)if(Te=x[St],x.hasOwnProperty(St)&&Te!=null&&!C.hasOwnProperty(St))switch(St){case"selected":h.selected=!1;break;default:sn(h,g,St,null,C,Te)}for(ye in C)if(Te=C[ye],Ie=x[ye],C.hasOwnProperty(ye)&&Te!==Ie&&(Te!=null||Ie!=null))switch(ye){case"selected":h.selected=Te&&typeof Te!="function"&&typeof Te!="symbol";break;default:sn(h,g,ye,Te,C,Ie)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wt in x)Te=x[Wt],x.hasOwnProperty(Wt)&&Te!=null&&!C.hasOwnProperty(Wt)&&sn(h,g,Wt,null,C,Te);for(Ee in C)if(Te=C[Ee],Ie=x[Ee],C.hasOwnProperty(Ee)&&Te!==Ie&&(Te!=null||Ie!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,g));break;default:sn(h,g,Ee,Te,C,Ie)}return;default:if(Su(g)){for(var on in x)Te=x[on],x.hasOwnProperty(on)&&Te!==void 0&&!C.hasOwnProperty(on)&&XM(h,g,on,void 0,C,Te);for(ze in C)Te=C[ze],Ie=x[ze],!C.hasOwnProperty(ze)||Te===Ie||Te===void 0&&Ie===void 0||XM(h,g,ze,Te,C,Ie);return}}for(var _e in x)Te=x[_e],x.hasOwnProperty(_e)&&Te!=null&&!C.hasOwnProperty(_e)&&sn(h,g,_e,null,C,Te);for(He in C)Te=C[He],Ie=x[He],!C.hasOwnProperty(He)||Te===Ie||Te==null&&Ie==null||sn(h,g,He,Te,C,Ie)}function eH(h){switch(h){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function x1e(){if(typeof performance.getEntriesByType=="function"){for(var h=0,g=0,x=performance.getEntriesByType("resource"),C=0;C<x.length;C++){var D=x[C],z=D.transferSize,Y=D.initiatorType,ae=D.duration;if(z&&ae&&eH(Y)){for(Y=0,ae=D.responseEnd,C+=1;C<x.length;C++){var ye=x[C],Ee=ye.startTime;if(Ee>ae)break;var ze=ye.transferSize,He=ye.initiatorType;ze&&eH(He)&&(ye=ye.responseEnd,Y+=ze*(ye<ae?1:(ae-Ee)/(ye-Ee)))}if(--C,g+=8*(z+Y)/(D.duration/1e3),h++,10<h)break}}if(0<h)return g/h/1e6}return navigator.connection&&(h=navigator.connection.downlink,typeof h=="number")?h:5}var eT=null,tT=null;function Iw(h){return h.nodeType===9?h:h.ownerDocument}function tH(h){switch(h){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rH(h,g){if(h===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return h===1&&g==="foreignObject"?0:h}function rT(h,g){return h==="textarea"||h==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var nT=null;function w1e(){var h=window.event;return h&&h.type==="popstate"?h===nT?!1:(nT=h,!0):(nT=null,!1)}var nH=typeof setTimeout=="function"?setTimeout:void 0,S1e=typeof clearTimeout=="function"?clearTimeout:void 0,aH=typeof Promise=="function"?Promise:void 0,k1e=typeof queueMicrotask=="function"?queueMicrotask:typeof aH<"u"?function(h){return aH.resolve(null).then(h).catch(_1e)}:nH;function _1e(h){setTimeout(function(){throw h})}function Fu(h){return h==="head"}function sH(h,g){var x=g,C=0;do{var D=x.nextSibling;if(h.removeChild(x),D&&D.nodeType===8)if(x=D.data,x==="/$"||x==="/&"){if(C===0){h.removeChild(D),Gm(g);return}C--}else if(x==="$"||x==="$?"||x==="$~"||x==="$!"||x==="&")C++;else if(x==="html")cv(h.ownerDocument.documentElement);else if(x==="head"){x=h.ownerDocument.head,cv(x);for(var z=x.firstChild;z;){var Y=z.nextSibling,ae=z.nodeName;z[ct]||ae==="SCRIPT"||ae==="STYLE"||ae==="LINK"&&z.rel.toLowerCase()==="stylesheet"||x.removeChild(z),z=Y}}else x==="body"&&cv(h.ownerDocument.body);x=D}while(x);Gm(g)}function iH(h,g){var x=h;h=0;do{var C=x.nextSibling;if(x.nodeType===1?g?(x._stashedDisplay=x.style.display,x.style.display="none"):(x.style.display=x._stashedDisplay||"",x.getAttribute("style")===""&&x.removeAttribute("style")):x.nodeType===3&&(g?(x._stashedText=x.nodeValue,x.nodeValue=""):x.nodeValue=x._stashedText||""),C&&C.nodeType===8)if(x=C.data,x==="/$"){if(h===0)break;h--}else x!=="$"&&x!=="$?"&&x!=="$~"&&x!=="$!"||h++;x=C}while(x)}function aT(h){var g=h.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var x=g;switch(g=g.nextSibling,x.nodeName){case"HTML":case"HEAD":case"BODY":aT(x),Bt(x);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(x.rel.toLowerCase()==="stylesheet")continue}h.removeChild(x)}}function N1e(h,g,x,C){for(;h.nodeType===1;){var D=x;if(h.nodeName.toLowerCase()!==g.toLowerCase()){if(!C&&(h.nodeName!=="INPUT"||h.type!=="hidden"))break}else if(C){if(!h[ct])switch(g){case"meta":if(!h.hasAttribute("itemprop"))break;return h;case"link":if(z=h.getAttribute("rel"),z==="stylesheet"&&h.hasAttribute("data-precedence"))break;if(z!==D.rel||h.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||h.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||h.getAttribute("title")!==(D.title==null?null:D.title))break;return h;case"style":if(h.hasAttribute("data-precedence"))break;return h;case"script":if(z=h.getAttribute("src"),(z!==(D.src==null?null:D.src)||h.getAttribute("type")!==(D.type==null?null:D.type)||h.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&z&&h.hasAttribute("async")&&!h.hasAttribute("itemprop"))break;return h;default:return h}}else if(g==="input"&&h.type==="hidden"){var z=D.name==null?null:""+D.name;if(D.type==="hidden"&&h.getAttribute("name")===z)return h}else return h;if(h=Ji(h.nextSibling),h===null)break}return null}function C1e(h,g,x){if(g==="")return null;for(;h.nodeType!==3;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!x||(h=Ji(h.nextSibling),h===null))return null;return h}function oH(h,g){for(;h.nodeType!==8;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!g||(h=Ji(h.nextSibling),h===null))return null;return h}function sT(h){return h.data==="$?"||h.data==="$~"}function iT(h){return h.data==="$!"||h.data==="$?"&&h.ownerDocument.readyState!=="loading"}function j1e(h,g){var x=h.ownerDocument;if(h.data==="$~")h._reactRetry=g;else if(h.data!=="$?"||x.readyState!=="loading")g();else{var C=function(){g(),x.removeEventListener("DOMContentLoaded",C)};x.addEventListener("DOMContentLoaded",C),h._reactRetry=C}}function Ji(h){for(;h!=null;h=h.nextSibling){var g=h.nodeType;if(g===1||g===3)break;if(g===8){if(g=h.data,g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"||g==="F!"||g==="F")break;if(g==="/$"||g==="/&")return null}}return h}var oT=null;function lH(h){h=h.nextSibling;for(var g=0;h;){if(h.nodeType===8){var x=h.data;if(x==="/$"||x==="/&"){if(g===0)return Ji(h.nextSibling);g--}else x!=="$"&&x!=="$!"&&x!=="$?"&&x!=="$~"&&x!=="&"||g++}h=h.nextSibling}return null}function cH(h){h=h.previousSibling;for(var g=0;h;){if(h.nodeType===8){var x=h.data;if(x==="$"||x==="$!"||x==="$?"||x==="$~"||x==="&"){if(g===0)return h;g--}else x!=="/$"&&x!=="/&"||g++}h=h.previousSibling}return null}function uH(h,g,x){switch(g=Iw(x),h){case"html":if(h=g.documentElement,!h)throw Error(n(452));return h;case"head":if(h=g.head,!h)throw Error(n(453));return h;case"body":if(h=g.body,!h)throw Error(n(454));return h;default:throw Error(n(451))}}function cv(h){for(var g=h.attributes;g.length;)h.removeAttributeNode(g[0]);Bt(h)}var Zi=new Map,dH=new Set;function Rw(h){return typeof h.getRootNode=="function"?h.getRootNode():h.nodeType===9?h:h.ownerDocument}var mc=B.d;B.d={f:E1e,r:M1e,D:T1e,C:A1e,L:D1e,m:L1e,X:I1e,S:O1e,M:R1e};function E1e(){var h=mc.f(),g=jw();return h||g}function M1e(h){var g=qt(h);g!==null&&g.tag===5&&g.type==="form"?EF(g):mc.r(h)}var qm=typeof document>"u"?null:document;function fH(h,g,x){var C=qm;if(C&&typeof g=="string"&&g){var D=ms(g);D='link[rel="'+h+'"][href="'+D+'"]',typeof x=="string"&&(D+='[crossorigin="'+x+'"]'),dH.has(D)||(dH.add(D),h={rel:h,crossOrigin:x,href:g},C.querySelector(D)===null&&(g=C.createElement("link"),Za(g,"link",h),vn(g),C.head.appendChild(g)))}}function T1e(h){mc.D(h),fH("dns-prefetch",h,null)}function A1e(h,g){mc.C(h,g),fH("preconnect",h,g)}function D1e(h,g,x){mc.L(h,g,x);var C=qm;if(C&&h&&g){var D='link[rel="preload"][as="'+ms(g)+'"]';g==="image"&&x&&x.imageSrcSet?(D+='[imagesrcset="'+ms(x.imageSrcSet)+'"]',typeof x.imageSizes=="string"&&(D+='[imagesizes="'+ms(x.imageSizes)+'"]')):D+='[href="'+ms(h)+'"]';var z=D;switch(g){case"style":z=Wm(h);break;case"script":z=Km(h)}Zi.has(z)||(h=f({rel:"preload",href:g==="image"&&x&&x.imageSrcSet?void 0:h,as:g},x),Zi.set(z,h),C.querySelector(D)!==null||g==="style"&&C.querySelector(uv(z))||g==="script"&&C.querySelector(dv(z))||(g=C.createElement("link"),Za(g,"link",h),vn(g),C.head.appendChild(g)))}}function L1e(h,g){mc.m(h,g);var x=qm;if(x&&h){var C=g&&typeof g.as=="string"?g.as:"script",D='link[rel="modulepreload"][as="'+ms(C)+'"][href="'+ms(h)+'"]',z=D;switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=Km(h)}if(!Zi.has(z)&&(h=f({rel:"modulepreload",href:h},g),Zi.set(z,h),x.querySelector(D)===null)){switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(x.querySelector(dv(z)))return}C=x.createElement("link"),Za(C,"link",h),vn(C),x.head.appendChild(C)}}}function O1e(h,g,x){mc.S(h,g,x);var C=qm;if(C&&h){var D=Dr(C).hoistableStyles,z=Wm(h);g=g||"default";var Y=D.get(z);if(!Y){var ae={loading:0,preload:null};if(Y=C.querySelector(uv(z)))ae.loading=5;else{h=f({rel:"stylesheet",href:h,"data-precedence":g},x),(x=Zi.get(z))&&lT(h,x);var ye=Y=C.createElement("link");vn(ye),Za(ye,"link",h),ye._p=new Promise(function(Ee,ze){ye.onload=Ee,ye.onerror=ze}),ye.addEventListener("load",function(){ae.loading|=1}),ye.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,Pw(Y,g,C)}Y={type:"stylesheet",instance:Y,count:1,state:ae},D.set(z,Y)}}}function I1e(h,g){mc.X(h,g);var x=qm;if(x&&h){var C=Dr(x).hoistableScripts,D=Km(h),z=C.get(D);z||(z=x.querySelector(dv(D)),z||(h=f({src:h,async:!0},g),(g=Zi.get(D))&&cT(h,g),z=x.createElement("script"),vn(z),Za(z,"link",h),x.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},C.set(D,z))}}function R1e(h,g){mc.M(h,g);var x=qm;if(x&&h){var C=Dr(x).hoistableScripts,D=Km(h),z=C.get(D);z||(z=x.querySelector(dv(D)),z||(h=f({src:h,async:!0,type:"module"},g),(g=Zi.get(D))&&cT(h,g),z=x.createElement("script"),vn(z),Za(z,"link",h),x.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},C.set(D,z))}}function hH(h,g,x,C){var D=(D=se.current)?Rw(D):null;if(!D)throw Error(n(446));switch(h){case"meta":case"title":return null;case"style":return typeof x.precedence=="string"&&typeof x.href=="string"?(g=Wm(x.href),x=Dr(D).hoistableStyles,C=x.get(g),C||(C={type:"style",instance:null,count:0,state:null},x.set(g,C)),C):{type:"void",instance:null,count:0,state:null};case"link":if(x.rel==="stylesheet"&&typeof x.href=="string"&&typeof x.precedence=="string"){h=Wm(x.href);var z=Dr(D).hoistableStyles,Y=z.get(h);if(Y||(D=D.ownerDocument||D,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(h,Y),(z=D.querySelector(uv(h)))&&!z._p&&(Y.instance=z,Y.state.loading=5),Zi.has(h)||(x={rel:"preload",as:"style",href:x.href,crossOrigin:x.crossOrigin,integrity:x.integrity,media:x.media,hrefLang:x.hrefLang,referrerPolicy:x.referrerPolicy},Zi.set(h,x),z||P1e(D,h,x,Y.state))),g&&C===null)throw Error(n(528,""));return Y}if(g&&C!==null)throw Error(n(529,""));return null;case"script":return g=x.async,x=x.src,typeof x=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Km(x),x=Dr(D).hoistableScripts,C=x.get(g),C||(C={type:"script",instance:null,count:0,state:null},x.set(g,C)),C):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,h))}}function Wm(h){return'href="'+ms(h)+'"'}function uv(h){return'link[rel="stylesheet"]['+h+"]"}function mH(h){return f({},h,{"data-precedence":h.precedence,precedence:null})}function P1e(h,g,x,C){h.querySelector('link[rel="preload"][as="style"]['+g+"]")?C.loading=1:(g=h.createElement("link"),C.preload=g,g.addEventListener("load",function(){return C.loading|=1}),g.addEventListener("error",function(){return C.loading|=2}),Za(g,"link",x),vn(g),h.head.appendChild(g))}function Km(h){return'[src="'+ms(h)+'"]'}function dv(h){return"script[async]"+h}function pH(h,g,x){if(g.count++,g.instance===null)switch(g.type){case"style":var C=h.querySelector('style[data-href~="'+ms(x.href)+'"]');if(C)return g.instance=C,vn(C),C;var D=f({},x,{"data-href":x.href,"data-precedence":x.precedence,href:null,precedence:null});return C=(h.ownerDocument||h).createElement("style"),vn(C),Za(C,"style",D),Pw(C,x.precedence,h),g.instance=C;case"stylesheet":D=Wm(x.href);var z=h.querySelector(uv(D));if(z)return g.state.loading|=4,g.instance=z,vn(z),z;C=mH(x),(D=Zi.get(D))&&lT(C,D),z=(h.ownerDocument||h).createElement("link"),vn(z);var Y=z;return Y._p=new Promise(function(ae,ye){Y.onload=ae,Y.onerror=ye}),Za(z,"link",C),g.state.loading|=4,Pw(z,x.precedence,h),g.instance=z;case"script":return z=Km(x.src),(D=h.querySelector(dv(z)))?(g.instance=D,vn(D),D):(C=x,(D=Zi.get(z))&&(C=f({},x),cT(C,D)),h=h.ownerDocument||h,D=h.createElement("script"),vn(D),Za(D,"link",C),h.head.appendChild(D),g.instance=D);case"void":return null;default:throw Error(n(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(C=g.instance,g.state.loading|=4,Pw(C,x.precedence,h));return g.instance}function Pw(h,g,x){for(var C=x.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=C.length?C[C.length-1]:null,z=D,Y=0;Y<C.length;Y++){var ae=C[Y];if(ae.dataset.precedence===g)z=ae;else if(z!==D)break}z?z.parentNode.insertBefore(h,z.nextSibling):(g=x.nodeType===9?x.head:x,g.insertBefore(h,g.firstChild))}function lT(h,g){h.crossOrigin==null&&(h.crossOrigin=g.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=g.referrerPolicy),h.title==null&&(h.title=g.title)}function cT(h,g){h.crossOrigin==null&&(h.crossOrigin=g.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=g.referrerPolicy),h.integrity==null&&(h.integrity=g.integrity)}var zw=null;function gH(h,g,x){if(zw===null){var C=new Map,D=zw=new Map;D.set(x,C)}else D=zw,C=D.get(x),C||(C=new Map,D.set(x,C));if(C.has(h))return C;for(C.set(h,null),x=x.getElementsByTagName(h),D=0;D<x.length;D++){var z=x[D];if(!(z[ct]||z[ie]||h==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=z.getAttribute(g)||"";Y=h+Y;var ae=C.get(Y);ae?ae.push(z):C.set(Y,[z])}}return C}function vH(h,g,x){h=h.ownerDocument||h,h.head.insertBefore(x,g==="title"?h.querySelector("head > title"):null)}function z1e(h,g,x){if(x===1||g.itemProp!=null)return!1;switch(h){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return h=g.disabled,typeof g.precedence=="string"&&h==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function bH(h){return!(h.type==="stylesheet"&&(h.state.loading&3)===0)}function B1e(h,g,x,C){if(x.type==="stylesheet"&&(typeof C.media!="string"||matchMedia(C.media).matches!==!1)&&(x.state.loading&4)===0){if(x.instance===null){var D=Wm(C.href),z=g.querySelector(uv(D));if(z){g=z._p,g!==null&&typeof g=="object"&&typeof g.then=="function"&&(h.count++,h=Bw.bind(h),g.then(h,h)),x.state.loading|=4,x.instance=z,vn(z);return}z=g.ownerDocument||g,C=mH(C),(D=Zi.get(D))&&lT(C,D),z=z.createElement("link"),vn(z);var Y=z;Y._p=new Promise(function(ae,ye){Y.onload=ae,Y.onerror=ye}),Za(z,"link",C),x.instance=z}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(x,g),(g=x.state.preload)&&(x.state.loading&3)===0&&(h.count++,x=Bw.bind(h),g.addEventListener("load",x),g.addEventListener("error",x))}}var uT=0;function $1e(h,g){return h.stylesheets&&h.count===0&&Fw(h,h.stylesheets),0<h.count||0<h.imgCount?function(x){var C=setTimeout(function(){if(h.stylesheets&&Fw(h,h.stylesheets),h.unsuspend){var z=h.unsuspend;h.unsuspend=null,z()}},6e4+g);0<h.imgBytes&&uT===0&&(uT=62500*x1e());var D=setTimeout(function(){if(h.waitingForImages=!1,h.count===0&&(h.stylesheets&&Fw(h,h.stylesheets),h.unsuspend)){var z=h.unsuspend;h.unsuspend=null,z()}},(h.imgBytes>uT?50:800)+g);return h.unsuspend=x,function(){h.unsuspend=null,clearTimeout(C),clearTimeout(D)}}:null}function Bw(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fw(this,this.stylesheets);else if(this.unsuspend){var h=this.unsuspend;this.unsuspend=null,h()}}}var $w=null;function Fw(h,g){h.stylesheets=null,h.unsuspend!==null&&(h.count++,$w=new Map,g.forEach(F1e,h),$w=null,Bw.call(h))}function F1e(h,g){if(!(g.state.loading&4)){var x=$w.get(h);if(x)var C=x.get(null);else{x=new Map,$w.set(h,x);for(var D=h.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<D.length;z++){var Y=D[z];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(x.set(Y.dataset.precedence,Y),C=Y)}C&&x.set(null,C)}D=g.instance,Y=D.getAttribute("data-precedence"),z=x.get(Y)||C,z===C&&x.set(null,D),x.set(Y,D),this.count++,C=Bw.bind(this),D.addEventListener("load",C),D.addEventListener("error",C),z?z.parentNode.insertBefore(D,z.nextSibling):(h=h.nodeType===9?h.head:h,h.insertBefore(D,h.firstChild)),g.state.loading|=4}}var fv={$$typeof:N,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function U1e(h,g,x,C,D,z,Y,ae,ye){this.tag=1,this.containerInfo=h,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nt(0),this.hiddenUpdates=Nt(null),this.identifierPrefix=C,this.onUncaughtError=D,this.onCaughtError=z,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ye,this.incompleteTransitions=new Map}function yH(h,g,x,C,D,z,Y,ae,ye,Ee,ze,He){return h=new U1e(h,g,x,Y,ye,Ee,ze,He,ae),g=1,z===!0&&(g|=24),z=ui(3,null,null,g),h.current=z,z.stateNode=h,g=HE(),g.refCount++,h.pooledCache=g,g.refCount++,z.memoizedState={element:C,isDehydrated:x,cache:g},GE(z),h}function xH(h){return h?(h=km,h):km}function wH(h,g,x,C,D,z){D=xH(D),C.context===null?C.context=D:C.pendingContext=D,C=Tu(g),C.payload={element:x},z=z===void 0?null:z,z!==null&&(C.callback=z),x=Au(h,C,g),x!==null&&(Js(x,h,g),q0(x,h,g))}function SH(h,g){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var x=h.retryLane;h.retryLane=x!==0&&x<g?x:g}}function dT(h,g){SH(h,g),(h=h.alternate)&&SH(h,g)}function kH(h){if(h.tag===13||h.tag===31){var g=ef(h,67108864);g!==null&&Js(g,h,67108864),dT(h,67108864)}}function _H(h){if(h.tag===13||h.tag===31){var g=pi();g=ee(g);var x=ef(h,g);x!==null&&Js(x,h,g),dT(h,g)}}var Uw=!0;function H1e(h,g,x,C){var D=I.T;I.T=null;var z=B.p;try{B.p=2,fT(h,g,x,C)}finally{B.p=z,I.T=D}}function q1e(h,g,x,C){var D=I.T;I.T=null;var z=B.p;try{B.p=8,fT(h,g,x,C)}finally{B.p=z,I.T=D}}function fT(h,g,x,C){if(Uw){var D=hT(C);if(D===null)ZM(h,g,C,Hw,x),CH(h,C);else if(K1e(D,h,g,x,C))C.stopPropagation();else if(CH(h,C),g&4&&-1<W1e.indexOf(h)){for(;D!==null;){var z=qt(D);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var Y=Ct(z.pendingLanes);if(Y!==0){var ae=z;for(ae.pendingLanes|=2,ae.entangledLanes|=2;Y;){var ye=1<<31-Ke(Y);ae.entanglements[1]|=ye,Y&=~ye}ll(z),(Fr&6)===0&&(Nw=Ae()+500,iv(0))}}break;case 31:case 13:ae=ef(z,2),ae!==null&&Js(ae,z,2),jw(),dT(z,2)}if(z=hT(C),z===null&&ZM(h,g,C,Hw,x),z===D)break;D=z}D!==null&&C.stopPropagation()}else ZM(h,g,C,null,x)}}function hT(h){return h=ar(h),mT(h)}var Hw=null;function mT(h){if(Hw=null,h=ut(h),h!==null){var g=s(h);if(g===null)h=null;else{var x=g.tag;if(x===13){if(h=i(g),h!==null)return h;h=null}else if(x===31){if(h=l(g),h!==null)return h;h=null}else if(x===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;h=null}else g!==h&&(h=null)}}return Hw=h,null}function NH(h){switch(h){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Re()){case Ve:return 2;case gt:return 8;case lt:case Pt:return 32;case fr:return 268435456;default:return 32}default:return 32}}var pT=!1,Uu=null,Hu=null,qu=null,hv=new Map,mv=new Map,Wu=[],W1e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function CH(h,g){switch(h){case"focusin":case"focusout":Uu=null;break;case"dragenter":case"dragleave":Hu=null;break;case"mouseover":case"mouseout":qu=null;break;case"pointerover":case"pointerout":hv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":mv.delete(g.pointerId)}}function pv(h,g,x,C,D,z){return h===null||h.nativeEvent!==z?(h={blockedOn:g,domEventName:x,eventSystemFlags:C,nativeEvent:z,targetContainers:[D]},g!==null&&(g=qt(g),g!==null&&kH(g)),h):(h.eventSystemFlags|=C,g=h.targetContainers,D!==null&&g.indexOf(D)===-1&&g.push(D),h)}function K1e(h,g,x,C,D){switch(g){case"focusin":return Uu=pv(Uu,h,g,x,C,D),!0;case"dragenter":return Hu=pv(Hu,h,g,x,C,D),!0;case"mouseover":return qu=pv(qu,h,g,x,C,D),!0;case"pointerover":var z=D.pointerId;return hv.set(z,pv(hv.get(z)||null,h,g,x,C,D)),!0;case"gotpointercapture":return z=D.pointerId,mv.set(z,pv(mv.get(z)||null,h,g,x,C,D)),!0}return!1}function jH(h){var g=ut(h.target);if(g!==null){var x=s(g);if(x!==null){if(g=x.tag,g===13){if(g=i(x),g!==null){h.blockedOn=g,be(h.priority,function(){_H(x)});return}}else if(g===31){if(g=l(x),g!==null){h.blockedOn=g,be(h.priority,function(){_H(x)});return}}else if(g===3&&x.stateNode.current.memoizedState.isDehydrated){h.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}h.blockedOn=null}function qw(h){if(h.blockedOn!==null)return!1;for(var g=h.targetContainers;0<g.length;){var x=hT(h.nativeEvent);if(x===null){x=h.nativeEvent;var C=new x.constructor(x.type,x);jt=C,x.target.dispatchEvent(C),jt=null}else return g=qt(x),g!==null&&kH(g),h.blockedOn=x,!1;g.shift()}return!0}function EH(h,g,x){qw(h)&&x.delete(g)}function G1e(){pT=!1,Uu!==null&&qw(Uu)&&(Uu=null),Hu!==null&&qw(Hu)&&(Hu=null),qu!==null&&qw(qu)&&(qu=null),hv.forEach(EH),mv.forEach(EH)}function Ww(h,g){h.blockedOn===g&&(h.blockedOn=null,pT||(pT=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,G1e)))}var Kw=null;function MH(h){Kw!==h&&(Kw=h,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Kw===h&&(Kw=null);for(var g=0;g<h.length;g+=3){var x=h[g],C=h[g+1],D=h[g+2];if(typeof C!="function"){if(mT(C||x)===null)continue;break}var z=qt(x);z!==null&&(h.splice(g,3),g-=3,hM(z,{pending:!0,data:D,method:x.method,action:C},C,D))}}))}function Gm(h){function g(ye){return Ww(ye,h)}Uu!==null&&Ww(Uu,h),Hu!==null&&Ww(Hu,h),qu!==null&&Ww(qu,h),hv.forEach(g),mv.forEach(g);for(var x=0;x<Wu.length;x++){var C=Wu[x];C.blockedOn===h&&(C.blockedOn=null)}for(;0<Wu.length&&(x=Wu[0],x.blockedOn===null);)jH(x),x.blockedOn===null&&Wu.shift();if(x=(h.ownerDocument||h).$$reactFormReplay,x!=null)for(C=0;C<x.length;C+=3){var D=x[C],z=x[C+1],Y=D[xe]||null;if(typeof z=="function")Y||MH(x);else if(Y){var ae=null;if(z&&z.hasAttribute("formAction")){if(D=z,Y=z[xe]||null)ae=Y.formAction;else if(mT(D)!==null)continue}else ae=Y.action;typeof ae=="function"?x[C+1]=ae:(x.splice(C,3),C-=3),MH(x)}}}function TH(){function h(z){z.canIntercept&&z.info==="react-transition"&&z.intercept({handler:function(){return new Promise(function(Y){return D=Y})},focusReset:"manual",scroll:"manual"})}function g(){D!==null&&(D(),D=null),C||setTimeout(x,20)}function x(){if(!C&&!navigation.transition){var z=navigation.currentEntry;z&&z.url!=null&&navigation.navigate(z.url,{state:z.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var C=!1,D=null;return navigation.addEventListener("navigate",h),navigation.addEventListener("navigatesuccess",g),navigation.addEventListener("navigateerror",g),setTimeout(x,100),function(){C=!0,navigation.removeEventListener("navigate",h),navigation.removeEventListener("navigatesuccess",g),navigation.removeEventListener("navigateerror",g),D!==null&&(D(),D=null)}}}function gT(h){this._internalRoot=h}Gw.prototype.render=gT.prototype.render=function(h){var g=this._internalRoot;if(g===null)throw Error(n(409));var x=g.current,C=pi();wH(x,C,h,g,null,null)},Gw.prototype.unmount=gT.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var g=h.containerInfo;wH(h.current,2,null,h,null,null),jw(),g[Ce]=null}};function Gw(h){this._internalRoot=h}Gw.prototype.unstable_scheduleHydration=function(h){if(h){var g=We();h={blockedOn:null,target:h,priority:g};for(var x=0;x<Wu.length&&g!==0&&g<Wu[x].priority;x++);Wu.splice(x,0,h),x===0&&jH(h)}};var AH=t.version;if(AH!=="19.2.4")throw Error(n(527,AH,"19.2.4"));B.findDOMNode=function(h){var g=h._reactInternals;if(g===void 0)throw typeof h.render=="function"?Error(n(188)):(h=Object.keys(h).join(","),Error(n(268,h)));return h=u(g),h=h!==null?d(h):null,h=h===null?null:h.stateNode,h};var V1e={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vw.isDisabled&&Vw.supportsFiber)try{at=Vw.inject(V1e),Ne=Vw}catch{}}return vv.createRoot=function(h,g){if(!a(h))throw Error(n(299));var x=!1,C="",D=zF,z=BF,Y=$F;return g!=null&&(g.unstable_strictMode===!0&&(x=!0),g.identifierPrefix!==void 0&&(C=g.identifierPrefix),g.onUncaughtError!==void 0&&(D=g.onUncaughtError),g.onCaughtError!==void 0&&(z=g.onCaughtError),g.onRecoverableError!==void 0&&(Y=g.onRecoverableError)),g=yH(h,1,!1,null,null,x,C,null,D,z,Y,TH),h[Ce]=g.current,JM(h),new gT(g)},vv.hydrateRoot=function(h,g,x){if(!a(h))throw Error(n(299));var C=!1,D="",z=zF,Y=BF,ae=$F,ye=null;return x!=null&&(x.unstable_strictMode===!0&&(C=!0),x.identifierPrefix!==void 0&&(D=x.identifierPrefix),x.onUncaughtError!==void 0&&(z=x.onUncaughtError),x.onCaughtError!==void 0&&(Y=x.onCaughtError),x.onRecoverableError!==void 0&&(ae=x.onRecoverableError),x.formState!==void 0&&(ye=x.formState)),g=yH(h,1,!0,g,x??null,C,D,ye,z,Y,ae,TH),g.context=xH(null),x=g.current,C=pi(),C=ee(C),D=Tu(C),D.callback=null,Au(x,D,C),x=C,g.current.lanes=x,Mt(g,x),ll(g),h[Ce]=g.current,JM(h),new Gw(g)},vv.version="19.2.4",vv}var $H;function TSe(){if($H)return yT.exports;$H=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),yT.exports=MSe(),yT.exports}var ASe=TSe();const DSe={primary:["bg-[var(--color-primary)] text-white","hover:bg-[var(--color-primary-hover)]","active:bg-[var(--color-primary-active)]","focus-visible:ring-2 focus-visible:ring-[var(--color-primary-200)] focus-visible:ring-offset-2","dark:focus-visible:ring-[var(--color-primary-800)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),secondary:["bg-[var(--color-neutral-100)] text-[var(--color-text)]","hover:bg-[var(--color-neutral-200)]","active:bg-[var(--color-neutral-300)]","focus-visible:ring-2 focus-visible:ring-[var(--color-neutral-400)] focus-visible:ring-offset-2","dark:bg-[var(--color-surface)] dark:text-[var(--color-text)]","dark:hover:bg-[var(--color-surface-hover)]","dark:active:bg-[var(--color-surface-active)]","dark:focus-visible:ring-[var(--color-neutral-600)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),ghost:["bg-transparent text-[var(--color-text-secondary)]","hover:bg-[var(--color-neutral-100)] hover:text-[var(--color-text)]","active:bg-[var(--color-neutral-200)]","focus-visible:ring-2 focus-visible:ring-[var(--color-neutral-400)] focus-visible:ring-offset-2","dark:text-[var(--color-text-secondary)]","dark:hover:bg-[var(--color-surface-hover)] dark:hover:text-[var(--color-text)]","dark:active:bg-[var(--color-surface-active)]","dark:focus-visible:ring-[var(--color-neutral-600)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),danger:["bg-[var(--color-danger)] text-white","hover:bg-[var(--color-danger-hover)]","active:bg-[var(--color-error-700)]","focus-visible:ring-2 focus-visible:ring-[var(--color-error-200)] focus-visible:ring-offset-2","dark:focus-visible:ring-[var(--color-error-900)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" "),outline:["bg-transparent border border-[var(--color-border)] text-[var(--color-text)]","hover:bg-[var(--color-surface-hover)] hover:border-[var(--color-neutral-400)]","active:bg-[var(--color-surface-active)]","focus-visible:ring-2 focus-visible:ring-[var(--color-primary-200)] focus-visible:ring-offset-2","dark:border-[var(--color-border)] dark:text-[var(--color-text)]","dark:hover:bg-[var(--color-surface-hover)] dark:hover:border-[var(--color-neutral-600)]","dark:active:bg-[var(--color-surface-active)]","dark:focus-visible:ring-[var(--color-primary-800)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"].join(" ")},LSe={xs:"h-6 px-2 text-xs gap-1 rounded",sm:"h-7 px-2.5 text-sm gap-1.5 rounded-md",md:"h-9 px-4 text-sm gap-2 rounded-md",lg:"h-11 px-6 text-base gap-2 rounded-lg"},OSe={xs:"h-6 w-6 p-0",sm:"h-7 w-7 p-0",md:"h-9 w-9 p-0",lg:"h-11 w-11 p-0"};function ISe({className:e=""}){return o.jsxs("svg",{className:`animate-spin ${e}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}const RSe=w.forwardRef(({className:e="",variant:t="primary",size:r="md",isLoading:n=!1,leftIcon:a,rightIcon:s,fullWidth:i=!1,disabled:l,children:c,...u},d)=>{const m=["inline-flex items-center justify-center","font-medium","transition-all duration-[var(--duration-fast)]","active:scale-[0.98]",i?"w-full":"",!c&&(a||s)&&!(a&&s)?OSe[r]:LSe[r],DSe[t],e].filter(Boolean).join(" "),p=r==="xs"||r==="sm"?"w-3 h-3":"w-4 h-4";return o.jsx("button",{ref:d,className:m,disabled:l||n,...u,children:n?o.jsxs(o.Fragment,{children:[o.jsx(ISe,{className:p}),c&&o.jsx("span",{className:"opacity-0",children:c})]}):o.jsxs(o.Fragment,{children:[a&&o.jsx("span",{className:"flex-shrink-0",children:a}),c,s&&o.jsx("span",{className:"flex-shrink-0",children:s})]})})});RSe.displayName="Button";const PSe={sm:"h-7 px-2.5 text-sm",md:"h-9 px-3 text-sm",lg:"h-11 px-4 text-base"},zSe={sm:"px-2",md:"px-3",lg:"px-4"},BSe=w.forwardRef(({className:e="",size:t="md",error:r,leftAddon:n,rightAddon:a,fullWidth:s=!1,wrapperClassName:i="",disabled:l,...c},u)=>{const d=!!r,f=["bg-[var(--color-input-bg)]","text-[var(--color-text)]","placeholder:text-[var(--color-text-tertiary)]",d?"border border-[var(--color-error-500)] focus:border-[var(--color-error-500)]":"border border-[var(--color-input-border)] focus:border-[var(--color-border-focus)]","focus:outline-none",d?"focus:ring-2 focus:ring-[var(--color-error-200)] dark:focus:ring-[var(--color-error-900)]":"focus:ring-2 focus:ring-[var(--color-input-focus-ring)]",n?"rounded-r-md":a?"rounded-l-md":"rounded-md",PSe[t],s||n||a?"w-full":"","transition-colors duration-[var(--duration-fast)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-[var(--color-bg-secondary)]",e].filter(Boolean).join(" "),m=["flex items-center","bg-[var(--color-bg-secondary)] dark:bg-[var(--color-surface)]","text-[var(--color-text-secondary)]","border border-[var(--color-input-border)]",zSe[t]].join(" ");return n||a?o.jsxs("div",{className:`${s?"w-full":""} ${i}`,children:[o.jsxs("div",{className:"flex",children:[n&&o.jsx("span",{className:`${m} rounded-l-md border-r-0`,children:n}),o.jsx("input",{ref:u,className:f,disabled:l,"aria-invalid":d,"aria-describedby":r?`${c.id}-error`:void 0,...c}),a&&o.jsx("span",{className:`${m} rounded-r-md border-l-0`,children:a})]}),r&&o.jsx("p",{id:`${c.id}-error`,className:"mt-1.5 text-xs text-[var(--color-error-500)] dark:text-[var(--color-error-400)]",children:r})]}):o.jsxs("div",{className:`${s?"w-full":""} ${i}`,children:[o.jsx("input",{ref:u,className:f,disabled:l,"aria-invalid":d,"aria-describedby":r?`${c.id}-error`:void 0,...c}),r&&o.jsx("p",{id:`${c.id}-error`,className:"mt-1.5 text-xs text-[var(--color-error-500)] dark:text-[var(--color-error-400)]",children:r})]})});BSe.displayName="Input";const $Se={sm:"px-2.5 py-1.5 text-sm",md:"px-3 py-2 text-sm",lg:"px-4 py-3 text-base"},FSe=w.forwardRef(({className:e="",size:t="md",error:r,fullWidth:n=!1,wrapperClassName:a="",disabled:s,...i},l)=>{const c=!!r,u=["bg-[var(--color-input-bg)]","text-[var(--color-text)]","placeholder:text-[var(--color-text-tertiary)]",c?"border border-[var(--color-error-500)] focus:border-[var(--color-error-500)]":"border border-[var(--color-input-border)] focus:border-[var(--color-border-focus)]","focus:outline-none",c?"focus:ring-2 focus:ring-[var(--color-error-200)] dark:focus:ring-[var(--color-error-900)]":"focus:ring-2 focus:ring-[var(--color-input-focus-ring)]","rounded-md",$Se[t],n?"w-full":"","resize-y min-h-[80px]","transition-colors duration-[var(--duration-fast)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-[var(--color-bg-secondary)]",e].filter(Boolean).join(" ");return o.jsxs("div",{className:`${n?"w-full":""} ${a}`,children:[o.jsx("textarea",{ref:l,className:u,disabled:s,"aria-invalid":c,"aria-describedby":r?`${i.id}-error`:void 0,...i}),r&&o.jsx("p",{id:`${i.id}-error`,className:"mt-1.5 text-xs text-[var(--color-error-500)] dark:text-[var(--color-error-400)]",children:r})]})});FSe.displayName="Textarea";const USe=w.forwardRef(({className:e="",required:t,children:r,...n},a)=>o.jsxs("label",{ref:a,className:`block text-sm font-medium text-[var(--color-text)] mb-1.5 ${e}`,...n,children:[r,t&&o.jsx("span",{className:"text-[var(--color-error-500)] ml-0.5",children:"*"})]}));USe.displayName="Label";const HSe=V6,Ose=w.forwardRef(({className:e="",...t},r)=>o.jsx(nj,{ref:r,className:["fixed inset-0","bg-black/50 dark:bg-black/70","backdrop-blur-sm","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","z-[var(--z-index-modal-backdrop)]",e].join(" "),...t}));Ose.displayName=nj.displayName;const qSe={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"max-w-[calc(100vw-2rem)] max-h-[calc(100vh-2rem)]"},WSe=w.forwardRef(({className:e="",children:t,size:r="md",hideClose:n=!1,...a},s)=>o.jsxs(HSe,{children:[o.jsx(Ose,{}),o.jsxs(aj,{ref:s,className:["fixed left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%]","w-full",qSe[r],"bg-[var(--color-bg-elevated)] dark:bg-[var(--color-card-bg)]","border border-[var(--color-border)] dark:border-[var(--color-card-border)]","rounded-xl","shadow-2xl dark:shadow-2xl","overflow-hidden","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]","data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]","duration-200","z-[var(--z-index-modal)]","focus:outline-none",e].join(" "),...a,children:[t,!n&&o.jsx(Y6,{className:["absolute right-3 top-3","p-1.5 rounded-md","text-[var(--color-text-tertiary)]","hover:text-[var(--color-text-secondary)]","hover:bg-[var(--color-surface-hover)]","focus:outline-none focus:ring-2 focus:ring-[var(--color-border-focus)]","transition-colors duration-[var(--duration-fast)]","disabled:pointer-events-none"].join(" "),"aria-label":"Close",children:o.jsx(yt,{className:"h-4 w-4"})})]})]}));WSe.displayName=aj.displayName;const KSe=w.forwardRef(({className:e="",...t},r)=>o.jsx(sj,{ref:r,className:["text-lg font-semibold","text-[var(--color-text)]","leading-tight",e].join(" "),...t}));KSe.displayName=sj.displayName;const GSe=w.forwardRef(({className:e="",...t},r)=>o.jsx(Q6,{ref:r,className:["mt-1.5 text-sm","text-[var(--color-text-secondary)]",e].join(" "),...t}));GSe.displayName=Q6.displayName;const VSe={sm:"h-7 px-2.5 text-sm",md:"h-9 px-3 text-sm",lg:"h-11 px-4 text-base"},YSe=w.forwardRef(({className:e="",children:t,size:r="md",error:n=!1,fullWidth:a=!1,...s},i)=>o.jsxs(mse,{ref:i,className:["inline-flex items-center justify-between gap-2","bg-[var(--color-input-bg)]","text-[var(--color-text)]",n?"border border-[var(--color-error-500)]":"border border-[var(--color-input-border)]","rounded-md",VSe[r],a?"w-full":"","data-[placeholder]:text-[var(--color-text-tertiary)]","focus:outline-none",n?"focus:ring-2 focus:ring-[var(--color-error-200)] dark:focus:ring-[var(--color-error-900)]":"focus:ring-2 focus:ring-[var(--color-input-focus-ring)] focus:border-[var(--color-border-focus)]","hover:border-[var(--color-neutral-400)] dark:hover:border-[var(--color-neutral-600)]","transition-colors duration-[var(--duration-fast)]","disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-[var(--color-bg-secondary)]",e].join(" "),...s,children:[o.jsx("span",{className:"truncate",children:t}),o.jsx(nSe,{asChild:!0,children:o.jsx(Yt,{className:"h-4 w-4 flex-shrink-0 text-[var(--color-text-tertiary)]"})})]}));YSe.displayName=mse.displayName;const Ise=w.forwardRef(({className:e="",...t},r)=>o.jsx(pse,{ref:r,className:["flex items-center justify-center h-6","cursor-default","text-[var(--color-text-tertiary)]",e].join(" "),...t,children:o.jsx(e0,{className:"h-4 w-4"})}));Ise.displayName=pse.displayName;const Rse=w.forwardRef(({className:e="",...t},r)=>o.jsx(gse,{ref:r,className:["flex items-center justify-center h-6","cursor-default","text-[var(--color-text-tertiary)]",e].join(" "),...t,children:o.jsx(Yt,{className:"h-4 w-4"})}));Rse.displayName=gse.displayName;const QSe=w.forwardRef(({className:e="",children:t,position:r="popper",...n},a)=>o.jsx(aSe,{children:o.jsxs(vse,{ref:a,className:["z-[var(--z-index-dropdown)]","relative","bg-[var(--color-bg-elevated)] dark:bg-[var(--color-card-bg)]","border border-[var(--color-border)] dark:border-[var(--color-card-border)]","shadow-lg dark:shadow-lg","rounded-lg","overflow-hidden","p-1","min-w-[8rem]",r==="popper"&&"max-h-[var(--radix-select-content-available-height)]","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=top]:slide-in-from-bottom-2",e].filter(Boolean).join(" "),position:r,...n,children:[o.jsx(Ise,{}),o.jsx(sSe,{className:r==="popper"?"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]":"",children:t}),o.jsx(Rse,{})]})}));QSe.displayName=vse.displayName;const JSe=w.forwardRef(({className:e="",...t},r)=>o.jsx(bse,{ref:r,className:["px-2 py-1.5","text-xs font-semibold","text-[var(--color-text-tertiary)]","uppercase tracking-wide",e].join(" "),...t}));JSe.displayName=bse.displayName;const ZSe=w.forwardRef(({className:e="",children:t,...r},n)=>o.jsxs(yse,{ref:n,className:["relative flex items-center","w-full","pl-8 pr-2 py-2","text-sm","text-[var(--color-text)]","rounded-md","cursor-pointer select-none outline-none","hover:bg-[var(--color-surface-hover)]","focus:bg-[var(--color-surface-hover)]","data-[highlighted]:bg-[var(--color-surface-hover)]","data-[disabled]:opacity-50 data-[disabled]:pointer-events-none",e].join(" "),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-4 w-4 items-center justify-center",children:o.jsx(iSe,{children:o.jsx(Vn,{className:"h-4 w-4 text-[var(--color-primary)]"})})}),o.jsx(oSe,{children:t})]}));ZSe.displayName=yse.displayName;const XSe=w.forwardRef(({className:e="",...t},r)=>o.jsx(xse,{ref:r,className:["-mx-1 my-1 h-px","bg-[var(--color-border)] dark:bg-[var(--color-card-border)]",e].join(" "),...t}));XSe.displayName=xse.displayName;const eke={default:["bg-[var(--color-neutral-100)] text-[var(--color-text-secondary)]","dark:bg-[var(--color-surface)] dark:text-[var(--color-text-secondary)]"].join(" "),primary:["bg-[var(--color-primary-muted)] text-[var(--color-primary-text)]","dark:bg-[var(--color-primary-muted)] dark:text-[var(--color-primary)]"].join(" "),success:["bg-[var(--color-success-bg)] text-[var(--color-success-700)]","dark:bg-[var(--color-success-bg)] dark:text-[var(--color-success-text)]"].join(" "),warning:["bg-[var(--color-warning-bg)] text-[var(--color-warning-700)]","dark:bg-[var(--color-warning-bg)] dark:text-[var(--color-warning-text)]"].join(" "),error:["bg-[var(--color-danger-bg)] text-[var(--color-error-700)]","dark:bg-[var(--color-danger-bg)] dark:text-[var(--color-danger-text)]"].join(" "),outline:["bg-transparent border border-[var(--color-border)] text-[var(--color-text-secondary)]","dark:border-[var(--color-border)] dark:text-[var(--color-text-secondary)]"].join(" ")},tke={sm:"px-1.5 py-0.5 text-[10px]",md:"px-2 py-0.5 text-xs"},Dl=w.forwardRef(({className:e="",variant:t="default",size:r="md",...n},a)=>o.jsx("span",{ref:a,className:["inline-flex items-center","font-medium","rounded-md","whitespace-nowrap",eke[t],tke[r],e].join(" "),...n}));Dl.displayName="Badge";const rke={default:["bg-[var(--color-card-bg)]","border border-[var(--color-card-border)]"].join(" "),elevated:["bg-[var(--color-card-bg)]","border border-[var(--color-card-border)]","shadow-md dark:shadow-md"].join(" "),outlined:["bg-transparent","border border-[var(--color-border)]"].join(" ")},s0=w.forwardRef(({className:e="",variant:t="default",hoverable:r=!1,clickable:n=!1,noPadding:a=!1,...s},i)=>o.jsx("div",{ref:i,className:["rounded-lg",a?"":"p-4",rke[t],r?"hover:bg-[var(--color-card-hover)] transition-colors duration-[var(--duration-fast)]":"",n?["cursor-pointer","hover:bg-[var(--color-card-hover)]","focus:outline-none focus:ring-2 focus:ring-[var(--color-border-focus)] focus:ring-offset-2","transition-colors duration-[var(--duration-fast)]"].join(" "):"",e].filter(Boolean).join(" "),tabIndex:n?0:void 0,role:n?"button":void 0,...s}));s0.displayName="Card";const nke=w.forwardRef(({className:e="",...t},r)=>o.jsx("div",{ref:r,className:["flex flex-col space-y-1.5",e].join(" "),...t}));nke.displayName="CardHeader";const ake=w.forwardRef(({className:e="",...t},r)=>o.jsx("h3",{ref:r,className:["text-base font-semibold","text-[var(--color-text)]","leading-tight",e].join(" "),...t}));ake.displayName="CardTitle";const ske=w.forwardRef(({className:e="",...t},r)=>o.jsx("p",{ref:r,className:["text-sm","text-[var(--color-text-secondary)]",e].join(" "),...t}));ske.displayName="CardDescription";const ike=w.forwardRef(({className:e="",...t},r)=>o.jsx("div",{ref:r,className:e,...t}));ike.displayName="CardContent";const oke=w.forwardRef(({className:e="",...t},r)=>o.jsx("div",{ref:r,className:["flex items-center pt-4",e].join(" "),...t}));oke.displayName="CardFooter";function Cn({children:e,content:t,shortcut:r,side:n="top",align:a="center",delayDuration:s=200}){return o.jsxs(wse,{delayDuration:s,children:[o.jsx(Sse,{asChild:!0,children:e}),o.jsx(kse,{children:o.jsxs(_se,{side:n,align:a,sideOffset:4,className:`z-50 px-2.5 py-1.5 text-xs rounded-md bg-gray-900 text-white shadow-lg
                     animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out
                     data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95
                     data-[side=top]:slide-in-from-bottom-2
                     data-[side=bottom]:slide-in-from-top-2
                     data-[side=left]:slide-in-from-right-2
                     data-[side=right]:slide-in-from-left-2`,"data-testid":"tooltip-content",children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{children:t}),r&&o.jsx("kbd",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded bg-gray-700 text-gray-200 font-mono text-[10px]",children:r})]}),o.jsx(Nse,{className:"fill-gray-900"})]})})]})}function lke({children:e}){return o.jsx(Cse,{children:e})}function ij({tags:e,onChange:t,placeholder:r="Type and press comma to add tags",className:n="","data-testid":a}){const[s,i]=w.useState(""),l=m=>{const p=m.trim().toLowerCase();p&&!e.includes(p)&&t([...e,p]),i("")},c=m=>{t(e.filter(p=>p!==m))},u=m=>{m.key===","||m.key==="Enter"?(m.preventDefault(),l(s)):m.key==="Backspace"&&!s&&e.length>0&&c(e[e.length-1])},d=m=>{const p=m.target.value;if(p.includes(",")){const v=p.split(",");v.slice(0,-1).forEach(b=>l(b)),i(v[v.length-1])}else i(p)},f=()=>{s.trim()&&l(s)};return o.jsxs("div",{className:`flex flex-wrap items-center gap-1.5 p-2 border border-[var(--color-border)] rounded-md focus-within:ring-2 focus-within:ring-[var(--color-primary)] focus-within:border-transparent bg-[var(--color-input-bg)] min-h-[42px] ${n}`,"data-testid":a,children:[e.map(m=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-sm bg-[var(--color-surface-elevated)] text-[var(--color-text)] rounded","data-testid":`tag-${m}`,children:[m,o.jsx("button",{type:"button",onClick:()=>c(m),className:"p-0.5 hover:bg-[var(--color-surface-hover)] rounded text-[var(--color-text-tertiary)] hover:text-[var(--color-text)]","aria-label":`Remove tag ${m}`,"data-testid":`tag-remove-${m}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},m)),o.jsx("input",{type:"text",value:s,onChange:d,onKeyDown:u,onBlur:f,placeholder:e.length===0?r:"",className:"flex-1 min-w-[100px] outline-none text-sm bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)]","data-testid":`${a}-input`})]})}const Pse="settings.theme",zse="settings.highContrastBase";function cke(){if(typeof window>"u")return"system";const e=localStorage.getItem(Pse);return e==="light"||e==="dark"||e==="system"||e==="high-contrast"?e:"system"}function uke(e){typeof window>"u"||localStorage.setItem(Pse,e)}function PO(){return typeof window>"u"?"light":localStorage.getItem(zse)==="dark"?"dark":"light"}function dke(e){typeof window>"u"||localStorage.setItem(zse,e)}function zO(){return typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Yw(e){if(typeof window>"u")return;const t=document.documentElement;if(t.classList.remove("dark","theme-dark","theme-light","high-contrast"),e==="high-contrast"){const r=PO();t.classList.add("high-contrast"),r==="dark"?t.classList.add("dark","theme-dark"):t.classList.add("theme-light")}else(e==="system"?zO():e)==="dark"?t.classList.add("dark","theme-dark"):t.classList.add("theme-light")}function fke(){const[e,t]=w.useState("system"),[r,n]=w.useState("light"),[a,s]=w.useState("light"),i=w.useCallback(f=>f==="high-contrast"?PO():f==="system"?zO():f,[]);w.useEffect(()=>{const f=cke();t(f),Yw(f),n(i(f)),s(PO())},[i]),w.useEffect(()=>{if(e!=="system")return;const f=window.matchMedia("(prefers-color-scheme: dark)"),m=()=>{Yw("system"),n(zO())};return f.addEventListener("change",m),()=>f.removeEventListener("change",m)},[e]);const l=w.useCallback(f=>{t(f),uke(f),Yw(f),n(i(f))},[i]),c=w.useCallback(f=>{dke(f),s(f),e==="high-contrast"&&(Yw("high-contrast"),n(f))},[e]),u=w.useCallback(()=>{l(e==="light"?"dark":e==="dark"?"high-contrast":e==="high-contrast"?"system":"light")},[e,l]),d=w.useCallback(()=>{l(r==="dark"?"light":"dark")},[r,l]);return{theme:e,resolvedTheme:r,isDark:r==="dark",isHighContrast:e==="high-contrast",highContrastBase:a,setTheme:l,setHighContrastThemeBase:c,toggleTheme:u,toggleDarkMode:d}}function hke({showCycle:e=!1,className:t=""}){const{theme:r,resolvedTheme:n,toggleTheme:a,toggleDarkMode:s}=fke();return e?o.jsx("button",{onClick:a,className:`
          p-2 rounded-lg transition-colors
          text-gray-500 dark:text-gray-400
          hover:bg-gray-100 dark:hover:bg-[var(--color-sidebar-item-hover)]
          hover:text-gray-700 dark:hover:text-gray-200
          ${t}
        `,"aria-label":`Current theme: ${r}. Click to change.`,title:`Theme: ${r==="system"?`System (${n})`:r}`,"data-testid":"theme-toggle",children:r==="system"?o.jsx(R6,{className:"w-5 h-5"}):r==="dark"?o.jsx(Xk,{className:"w-5 h-5"}):o.jsx(e_,{className:"w-5 h-5"})}):o.jsx("button",{onClick:s,className:`
        p-2 rounded-lg transition-colors
        text-gray-500 dark:text-gray-400
        hover:bg-gray-100 dark:hover:bg-[var(--color-sidebar-item-hover)]
        hover:text-gray-700 dark:hover:text-gray-200
        ${t}
      `,"aria-label":n==="dark"?"Switch to light mode":"Switch to dark mode",title:n==="dark"?"Switch to light mode":"Switch to dark mode","data-testid":"theme-toggle",children:n==="dark"?o.jsx(e_,{className:"w-5 h-5"}):o.jsx(Xk,{className:"w-5 h-5"})})}const mke=w.forwardRef(({width:e="100%",height:t="1rem",radius:r="0.25rem",animate:n=!0,variant:a,className:s="",style:i,...l},c)=>{let u=e,d=t,f=r;switch(a){case"text":d="1rem",f="0.25rem";break;case"circular":f="50%";break;case"rectangular":f="0";break;case"rounded":f="0.5rem";break}const m="bg-gray-200 dark:bg-gray-700",p=n?"animate-pulse":"";return o.jsx("div",{ref:c,className:`${m} ${p} ${s}`,style:{width:typeof u=="number"?`${u}px`:u,height:typeof d=="number"?`${d}px`:d,borderRadius:typeof f=="number"?`${f}px`:f,...i},"data-testid":"skeleton",...l})});mke.displayName="Skeleton";const BO={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};function pke(e){const[t,r]=w.useState(!1);return w.useEffect(()=>{const n=()=>{r(window.innerWidth<BO[e])};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[e]),t}function jo(){return pke("md")}function gke(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=()=>{const n=window.innerWidth;t(n>=BO.md&&n<BO.lg)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),e}function vke({open:e,onClose:t,children:r,width:n=280,maxWidth:a="85vw","data-testid":s="mobile-drawer",contentClassName:i="",showCloseButton:l=!0,closeButtonContent:c,swipeThreshold:u=50,backdropBlur:d=!0,backdropClassName:f=""}){const m=w.useRef(null),p=w.useRef(null);w.useEffect(()=>{if(e){const _=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=_}}},[e]),w.useEffect(()=>{if(!e)return;const _=N=>{N.key==="Escape"&&t()};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[e,t]);const v=_=>{p.current=_.touches[0].clientX},b=_=>{if(p.current===null)return;const N=_.touches[0].clientX;p.current-N>u&&(t(),p.current=null)},y=()=>{p.current=null};if(w.useEffect(()=>{if(!e||!m.current)return;const _=m.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),N=_[0],k=_[_.length-1];N?.focus();const j=E=>{E.key==="Tab"&&(E.shiftKey?document.activeElement===N&&(k?.focus(),E.preventDefault()):document.activeElement===k&&(N?.focus(),E.preventDefault()))};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[e]),!e)return null;const S=typeof n=="number"?`${n}px`:n;return o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":s,role:"dialog","aria-modal":"true","aria-label":"Navigation menu",children:[o.jsx("div",{className:`absolute inset-0 bg-black/50 transition-opacity duration-200 ${d?"backdrop-blur-sm":""} ${f}`,onClick:t,"data-testid":`${s}-backdrop`,"aria-hidden":"true"}),o.jsxs("div",{ref:m,className:`absolute left-0 top-0 bottom-0 bg-[var(--color-sidebar-bg)] shadow-2xl transform transition-transform duration-200 ease-out flex flex-col ${i}`,style:{width:S,maxWidth:a,transform:e?"translateX(0)":"translateX(-100%)"},onTouchStart:v,onTouchMove:b,onTouchEnd:y,"data-testid":`${s}-content`,children:[l&&o.jsx("button",{onClick:t,className:"absolute top-3 right-3 p-2 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-sidebar-item-hover)] transition-colors duration-150 z-10","aria-label":"Close navigation menu","data-testid":`${s}-close`,children:c??o.jsx(yt,{className:"w-5 h-5"})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:r})]})]})}const bke={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"};function Ux({open:e,onClose:t,children:r,title:n,icon:a,size:s="md",className:i="","data-testid":l="responsive-modal",footer:c,hideClose:u=!1}){const d=jo(),f=w.useRef(null),m=w.useRef(null),p=w.useRef(0);w.useEffect(()=>{if(e){const S=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=S}}},[e]),w.useEffect(()=>{if(!e)return;const S=_=>{_.key==="Escape"&&t()};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[e,t]),w.useEffect(()=>{if(!e||!d)return;window.history.pushState({responsiveModal:!0},"");const S=_=>{_.state?.responsiveModal===void 0&&t()};return window.addEventListener("popstate",S),()=>{window.removeEventListener("popstate",S),window.history.state?.responsiveModal&&window.history.back()}},[e,d,t]);const v=S=>{d&&(m.current=S.touches[0].clientY,p.current=0)},b=S=>{!d||m.current===null||(p.current=S.touches[0].clientY-m.current,p.current<0&&(p.current=0),f.current&&p.current>0&&(f.current.style.transform=`translateY(${p.current}px)`))},y=()=>{!d||m.current===null||(p.current>100?t():f.current&&(f.current.style.transform="translateY(0)"),m.current=null,p.current=0)};return w.useEffect(()=>{e&&f.current&&f.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},[e]),e?d?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":l,role:"dialog","aria-modal":"true","aria-labelledby":`${l}-title`,children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-200",onClick:t,"data-testid":`${l}-backdrop`,"aria-hidden":"true"}),o.jsxs("div",{ref:f,className:"absolute inset-x-0 bottom-0 top-0 bg-[var(--color-bg)] shadow-2xl flex flex-col transform transition-transform duration-200 ease-out",style:{transform:e?"translateY(0)":"translateY(100%)"},"data-testid":`${l}-content`,children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",onTouchStart:v,onTouchMove:b,onTouchEnd:y,children:[o.jsx("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 w-10 h-1 bg-[var(--color-border)] rounded-full"}),!u&&o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Close","data-testid":`${l}-close`,children:o.jsx(Ul,{className:"w-5 h-5"})}),a&&o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:a}),o.jsx("h2",{id:`${l}-title`,className:"flex-1 text-lg font-semibold text-[var(--color-text)] truncate",children:n})]}),o.jsx("div",{className:`flex-1 overflow-y-auto ${i}`,children:r}),c&&o.jsx("div",{className:"sticky bottom-0 px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:c})]})]}):o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":l,role:"dialog","aria-modal":"true","aria-labelledby":`${l}-title`,children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t,"data-testid":`${l}-backdrop`,"aria-hidden":"true"}),o.jsx("div",{ref:f,className:`absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full ${bke[s]} max-h-[90vh] overflow-y-auto mx-4`,"data-testid":`${l}-content`,children:o.jsxs("div",{className:"bg-white dark:bg-[var(--color-surface)] rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a&&o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:a}),o.jsx("h2",{id:`${l}-title`,className:"text-lg font-semibold text-gray-900 dark:text-white",children:n})]}),!u&&o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded","aria-label":"Close","data-testid":`${l}-close`,children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:i,children:r}),c&&o.jsx("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-[var(--color-surface-secondary)]",children:c})]})})]}):null}const FH={1:{label:"Critical",variant:"error"},2:{label:"High",variant:"warning"},3:{label:"Medium",variant:"primary"},4:{label:"Low",variant:"default"},5:{label:"Trivial",variant:"outline"}};function Bse(e){return FH[e]||FH[3]}function yke(e){return Bse(e).label}function xke(e){switch(e){case 1:return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case 2:return"text-orange-600 bg-orange-100 dark:text-orange-400 dark:bg-orange-900/30";case 3:return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case 4:return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50";case 5:return"text-gray-500 bg-gray-50 dark:text-gray-500 dark:bg-gray-800/30";default:return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30"}}function wke(e){switch(e){case"open":return"Open";case"todo":return"To Do";case"in_progress":return"In Progress";case"blocked":return"Blocked";case"review":return"Review";case"closed":return"Closed";case"cancelled":return"Cancelled";case"deferred":return"Deferred";case"backlog":return"Backlog";default:return e}}function Ske(e){switch(e){case"open":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case"todo":return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50";case"in_progress":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case"blocked":return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case"review":return"text-purple-600 bg-purple-100 dark:text-purple-400 dark:bg-purple-900/30";case"closed":return"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900/30";case"cancelled":return"text-gray-500 bg-gray-50 dark:text-gray-500 dark:bg-gray-800/30";case"deferred":return"text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/30";case"backlog":return"text-gray-700 bg-gray-200 dark:text-gray-300 dark:bg-gray-700";default:return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50"}}function kke(e){switch(e){case"bug":return"Bug";case"feature":return"Feature";case"task":return"Task";case"chore":return"Chore";default:return e}}function _ke(e){switch(e){case"bug":return"text-red-700 bg-red-50 dark:text-red-300 dark:bg-red-900/20";case"feature":return"text-purple-700 bg-purple-50 dark:text-purple-300 dark:bg-purple-900/20";case"task":return"text-blue-700 bg-blue-50 dark:text-blue-300 dark:bg-blue-900/20";case"chore":return"text-gray-700 bg-gray-50 dark:text-gray-300 dark:bg-gray-800/50";default:return"text-gray-700 bg-gray-50 dark:text-gray-300 dark:bg-gray-800/50"}}function Nke(e){switch(e){case"pending":return"Pending Merge";case"testing":return"Testing";case"merging":return"Merging";case"merged":return"Merged";case"conflict":return"Conflict";case"test_failed":return"Tests Failed";case"failed":return"Merge Failed";case"not_applicable":return"No Merge Needed";default:return e}}function Cke(e){switch(e){case"pending":return"text-purple-600 bg-purple-100 dark:text-purple-400 dark:bg-purple-900/30";case"testing":return"text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/30";case"merging":return"text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/30";case"merged":return"text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900/30";case"conflict":return"text-orange-600 bg-orange-100 dark:text-orange-400 dark:bg-orange-900/30";case"test_failed":return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case"failed":return"text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/30";case"not_applicable":return"text-gray-500 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50";default:return"text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-800/50"}}const UH={bug:"border-l-4 border-l-[var(--color-error-400)]",feature:"border-l-4 border-l-[var(--color-accent-400)]",task:"border-l-4 border-l-[var(--color-primary-400)]",chore:"border-l-4 border-l-[var(--color-neutral-400)]"};function jke(e){return UH[e]||UH.task}const HH={agent:{bgColor:"bg-[var(--color-primary-muted)]",textColor:"text-[var(--color-primary-text)]",variant:"primary"},human:{bgColor:"bg-[var(--color-success-bg)]",textColor:"text-[var(--color-success-text)]",variant:"success"},system:{bgColor:"bg-[var(--color-warning-bg)]",textColor:"text-[var(--color-warning-text)]",variant:"warning"}};function Eke(e){return HH[e]||HH.system}function Mke(e,t){if(!e)return{truncated:"",isTruncated:!1};const n=e.split(`
`).slice(0,t).join(`
`),a=e.split(`
`).length>t||n.length<e.length;return n.length>150?{truncated:n.slice(0,147)+"...",isTruncated:!0}:{truncated:n,isTruncated:a}}const Tke=w.forwardRef(({task:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!0,showTimestamp:s=!1,showDescription:i=!0,showCounts:l=!0},c)=>{const u=Bse(e.priority),d=jke(e.taskType),{truncated:f,isTruncated:m}=Mke(e.description,2),p=!!e.description&&e.description.trim().length>0,v=e._attachmentCount||0,b=e._blocksCount||0,y=e._blockedByCount||0,S=v>0||b>0||y>0,_=()=>{if(!i||!p)return null;const N=o.jsx("p",{className:"mt-2 text-xs text-[var(--color-text-secondary)] line-clamp-2 leading-relaxed","data-testid":"task-description-preview",children:f});return m&&e.description?o.jsx(Cse,{delayDuration:400,children:o.jsxs(wse,{children:[o.jsx(Sse,{asChild:!0,children:N}),o.jsx(kse,{children:o.jsxs(_se,{className:"max-w-sm p-3 text-xs text-[var(--color-text)] bg-[var(--color-surface-elevated)] border border-[var(--color-border)] rounded-lg shadow-lg z-50",sideOffset:5,"data-testid":"task-description-tooltip",children:[o.jsxs("p",{className:"whitespace-pre-wrap",children:[e.description.slice(0,500),e.description.length>500?"...":""]}),o.jsx(Nse,{className:"fill-[var(--color-surface-elevated)]"})]})})]})}):N};return o.jsxs(s0,{ref:c,variant:"default",clickable:!!r,onClick:r,className:[d,t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)]":"","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`task-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-medium text-[var(--color-text)] truncate leading-tight",children:e.title}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] mt-1 font-mono truncate",children:e.id})]}),o.jsx(Dl,{variant:u.variant,size:"sm",children:u.label})]}),_(),o.jsxs("div",{className:"mt-3 flex items-center gap-2 flex-wrap",children:[o.jsx(Dl,{variant:"outline",size:"sm",className:"capitalize",children:e.taskType}),e.assignee&&o.jsxs("span",{className:"text-xs text-[var(--color-text-secondary)]",children:["Assigned: ",o.jsx("span",{className:"text-[var(--color-text)]",children:e.assignee})]})]}),l&&S&&o.jsxs("div",{className:"mt-2 flex items-center gap-3 flex-wrap","data-testid":"task-counts",children:[v>0&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-[var(--color-text-secondary)]","data-testid":"task-attachment-count",children:[o.jsx(KC,{className:"w-3 h-3"}),v]}),b>0&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-[var(--color-warning-text)]","data-testid":"task-blocks-count",title:`Blocks ${b} task${b>1?"s":""}`,children:[o.jsx(cu,{className:"w-3 h-3"}),"Blocks ",b]}),y>0&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-[var(--color-danger-text)]","data-testid":"task-blocked-by-count",title:`Blocked by ${y} task${y>1?"s":""}`,children:[o.jsx(Ix,{className:"w-3 h-3"}),"Blocked by ",y]})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(N=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:N},N)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]}),s&&o.jsxs("div",{className:"mt-3 text-[11px] text-[var(--color-text-tertiary)]",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]})});Tke.displayName="TaskCard";function Ake(e){switch(e){case"agent":return Vr;case"human":return tn;case"system":return Id;default:return Id}}const Dke=w.forwardRef(({entity:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!0,showTimestamp:s=!0},i)=>{const l=Eke(e.entityType),c=Ake(e.entityType),u=e.active!==!1;return o.jsxs(s0,{ref:i,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)]":"",u?"":"opacity-60","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`entity-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${l.bgColor} flex-shrink-0`,"data-testid":`entity-avatar-${e.id}`,children:o.jsx(c,{className:`w-5 h-5 ${l.textColor}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-medium text-[var(--color-text)] truncate",children:e.name}),!u&&o.jsx(Dl,{variant:"outline",size:"sm",children:"Inactive"})]}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate",children:e.id})]}),o.jsx(Dl,{variant:l.variant,size:"sm",className:"capitalize flex-shrink-0","data-testid":`entity-type-badge-${e.id}`,children:e.entityType})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(d=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:d},d)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]}),s&&o.jsxs("div",{className:"mt-3 text-[11px] text-[var(--color-text-tertiary)]",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]})});Dke.displayName="EntityCard";const qH={draft:{label:"Draft",variant:"default"},active:{label:"Active",variant:"primary"},completed:{label:"Completed",variant:"success"},cancelled:{label:"Cancelled",variant:"error"}};function Lke(e){return qH[e]||qH.draft}const Oke=w.forwardRef(({plan:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!1,progress:s,children:i},l)=>{const c=Lke(e.status);return o.jsxs(s0,{ref:l,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)] bg-[var(--color-surface-selected)]":"","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`plan-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-[var(--color-primary-muted)] flex items-center justify-center flex-shrink-0",children:o.jsx(P6,{className:"w-4 h-4 text-[var(--color-primary)]"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h3",{"data-testid":"plan-card-title",className:"font-medium text-[var(--color-text)] truncate",children:e.title}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate mt-0.5",children:e.id})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx(Dl,{variant:c.variant,size:"sm",children:c.label}),o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]})]}),typeof s=="number"&&o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)]",children:"Progress"}),o.jsxs("span",{className:"text-xs font-medium text-[var(--color-text)]",children:[s,"%"]})]}),o.jsx("div",{className:"w-full h-1.5 bg-[var(--color-surface-active)] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-[var(--color-primary)] rounded-full transition-all duration-300",style:{width:`${s}%`}})})]}),i,e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(u=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:u},u)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]})]})});Oke.displayName="PlanCard";const WH={created:{label:"Created",variant:"default"},active:{label:"Active",variant:"primary"},completed:{label:"Completed",variant:"success"},failed:{label:"Failed",variant:"error"},cancelled:{label:"Cancelled",variant:"warning"}};function Ike(e){return WH[e]||WH.created}function Rke(e){return e==="failed"?"bg-[var(--color-error)]":e==="completed"?"bg-[var(--color-success)]":"bg-[var(--color-primary)]"}const Pke=w.forwardRef(({workflow:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!1,progress:s,children:i},l)=>{const c=Ike(e.status),u=e.ephemeral===!0;return o.jsxs(s0,{ref:l,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)] bg-[var(--color-surface-selected)]":"",u?"border-dashed":"","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`workflow-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[o.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${u?"bg-[var(--color-warning-bg)]":"bg-[var(--color-accent-100)] dark:bg-[var(--color-accent-900)]"}`,children:u?o.jsx(fwe,{className:"w-4 h-4 text-[var(--color-warning)]"}):o.jsx(vh,{className:"w-4 h-4 text-[var(--color-accent-600)] dark:text-[var(--color-accent-400)]"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h3",{"data-testid":"workflow-card-title",className:"font-medium text-[var(--color-text)] truncate",children:e.title}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate mt-0.5",children:e.id})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[u&&o.jsx(Dl,{variant:"warning",size:"sm",children:"Ephemeral"}),o.jsx(Dl,{variant:c.variant,size:"sm",children:c.label}),o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]})]}),typeof s=="number"&&o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)]",children:"Progress"}),o.jsxs("span",{className:"text-xs font-medium text-[var(--color-text)]",children:[s,"%"]})]}),o.jsx("div",{className:"w-full h-1.5 bg-[var(--color-surface-active)] rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${Rke(e.status)}`,style:{width:`${s}%`}})})]}),e.playbookId&&o.jsxs("div",{className:"mt-2 text-xs text-[var(--color-text-secondary)]",children:["From playbook:"," ",o.jsx("span",{className:"font-mono text-[var(--color-text-tertiary)]",children:e.playbookId})]}),i,e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(d=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:d},d)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]})]})});Pke.displayName="WorkflowCard";const zke=w.forwardRef(({team:e,isSelected:t=!1,onClick:r,className:n="",showId:a=!0,showTimestamp:s=!0,memberAvatarStack:i},l)=>{const c=e.status!=="tombstone",u=e.members?.length||0;return o.jsxs(s0,{ref:l,variant:"default",clickable:!!r,onClick:r,className:[t?"ring-2 ring-[var(--color-primary)] border-[var(--color-primary)]":"",c?"":"opacity-60","transition-all duration-[var(--duration-fast)]",n].filter(Boolean).join(" "),"data-testid":`team-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-[var(--color-accent-100)] dark:bg-[var(--color-accent-900)] flex items-center justify-center flex-shrink-0","data-testid":`team-avatar-${e.id}`,children:o.jsx(ds,{className:"w-5 h-5 text-[var(--color-accent-600)] dark:text-[var(--color-accent-400)]"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-medium text-[var(--color-text)] truncate",children:e.name}),!c&&o.jsx(Dl,{variant:"outline",size:"sm",children:"Deleted"})]}),a&&o.jsx("p",{className:"text-[11px] text-[var(--color-text-tertiary)] font-mono truncate",children:e.id})]}),o.jsxs(Dl,{variant:"primary",size:"sm",className:"flex-shrink-0","data-testid":`team-member-count-${e.id}`,children:[u," ",u===1?"member":"members"]})]}),u>0&&i&&o.jsx("div",{className:"mt-3",children:i}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(d=>o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-[var(--color-surface-active)] text-[var(--color-text-secondary)] rounded",children:d},d)),e.tags.length>3&&o.jsxs("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]}),s&&o.jsxs("div",{className:"mt-3 text-[11px] text-[var(--color-text-tertiary)]",children:["Created ",new Date(e.createdAt).toLocaleDateString()]})]})});zke.displayName="TeamCard";function Vp({status:e,className:t=""}){return o.jsx("span",{className:`inline-flex items-center whitespace-nowrap px-2 py-0.5 text-xs font-medium rounded-full ${Ske(e)} ${t}`,"data-testid":"task-status-badge",children:wke(e)})}Vp.displayName="TaskStatusBadge";function Bke(e){switch(e){case 1:return Bn;case 2:return Px;case 3:return RH;case 4:return Rx;case 5:return Yt;default:return RH}}function Yp({priority:e,showIcon:t=!0,className:r=""}){const n=Bke(e);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full ${xke(e)} ${r}`,"data-testid":"task-priority-badge",children:[t&&o.jsx(n,{className:"w-3 h-3"}),yke(e)]})}Yp.displayName="TaskPriorityBadge";function $ke(e){switch(e){case"bug":return mwe;case"feature":return hwe;case"task":return sy;case"chore":return Zo;default:return sy}}function J6({taskType:e,className:t=""}){const r=$ke(e);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded ${_ke(e)} ${t}`,"data-testid":"task-type-badge",children:[o.jsx(r,{className:"w-3 h-3"}),kke(e)]})}J6.displayName="TaskTypeBadge";function Qp({status:e,className:t=""}){return o.jsx("span",{className:`inline-flex items-center whitespace-nowrap px-2 py-0.5 text-xs font-medium rounded-full ${Cke(e)} ${t}`,"data-testid":"merge-status-badge",children:Nke(e)})}Qp.displayName="MergeStatusBadge";var ST,oj="HoverCard",[$se]=vSe(oj,[Ese]),lj=Ese(),[Fke,cj]=$se(oj),Fse=e=>{const{__scopeHoverCard:t,children:r,open:n,defaultOpen:a,onOpenChange:s,openDelay:i=700,closeDelay:l=300}=e,c=lj(t),u=w.useRef(0),d=w.useRef(0),f=w.useRef(!1),m=w.useRef(!1),[p,v]=lSe({prop:n,defaultProp:a??!1,onChange:s,caller:oj}),b=w.useCallback(()=>{clearTimeout(d.current),u.current=window.setTimeout(()=>v(!0),i)},[i,v]),y=w.useCallback(()=>{clearTimeout(u.current),!f.current&&!m.current&&(d.current=window.setTimeout(()=>v(!1),l))},[l,v]),S=w.useCallback(()=>v(!1),[v]);return w.useEffect(()=>()=>{clearTimeout(u.current),clearTimeout(d.current)},[]),o.jsx(Fke,{scope:t,open:p,onOpenChange:v,onOpen:b,onClose:y,onDismiss:S,hasSelectionRef:f,isPointerDownOnContentRef:m,children:o.jsx(cSe,{...c,children:r})})};Fse.displayName=oj;var Use="HoverCardTrigger",Hse=w.forwardRef((e,t)=>{const{__scopeHoverCard:r,...n}=e,a=cj(Use,r),s=lj(r);return o.jsx(uSe,{asChild:!0,...s,children:o.jsx(dSe.a,{"data-state":a.open?"open":"closed",...n,ref:t,onPointerEnter:$c(e.onPointerEnter,n_(a.onOpen)),onPointerLeave:$c(e.onPointerLeave,n_(a.onClose)),onFocus:$c(e.onFocus,a.onOpen),onBlur:$c(e.onBlur,a.onClose),onTouchStart:$c(e.onTouchStart,i=>i.preventDefault())})})});Hse.displayName=Use;var Z6="HoverCardPortal",[Uke,Hke]=$se(Z6,{forceMount:void 0}),qse=e=>{const{__scopeHoverCard:t,forceMount:r,children:n,container:a}=e,s=cj(Z6,t);return o.jsx(Uke,{scope:t,forceMount:r,children:o.jsx(jse,{present:r||s.open,children:o.jsx(fSe,{asChild:!0,container:a,children:n})})})};qse.displayName=Z6;var r_="HoverCardContent",Wse=w.forwardRef((e,t)=>{const r=Hke(r_,e.__scopeHoverCard),{forceMount:n=r.forceMount,...a}=e,s=cj(r_,e.__scopeHoverCard);return o.jsx(jse,{present:n||s.open,children:o.jsx(qke,{"data-state":s.open?"open":"closed",...a,onPointerEnter:$c(e.onPointerEnter,n_(s.onOpen)),onPointerLeave:$c(e.onPointerLeave,n_(s.onClose)),ref:t})})});Wse.displayName=r_;var qke=w.forwardRef((e,t)=>{const{__scopeHoverCard:r,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:i,...l}=e,c=cj(r_,r),u=lj(r),d=w.useRef(null),f=mSe(t,d),[m,p]=w.useState(!1);return w.useEffect(()=>{if(m){const v=document.body;return ST=v.style.userSelect||v.style.webkitUserSelect,v.style.userSelect="none",v.style.webkitUserSelect="none",()=>{v.style.userSelect=ST,v.style.webkitUserSelect=ST}}},[m]),w.useEffect(()=>{if(d.current){const v=()=>{p(!1),c.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(c.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",v),()=>{document.removeEventListener("pointerup",v),c.hasSelectionRef.current=!1,c.isPointerDownOnContentRef.current=!1}}},[c.isPointerDownOnContentRef,c.hasSelectionRef]),w.useEffect(()=>{d.current&&Kke(d.current).forEach(b=>b.setAttribute("tabindex","-1"))}),o.jsx(pSe,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:i,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:$c(s,v=>{v.preventDefault()}),onDismiss:c.onDismiss,children:o.jsx(gSe,{...u,...l,onPointerDown:$c(l.onPointerDown,v=>{v.currentTarget.contains(v.target)&&p(!0),c.hasSelectionRef.current=!1,c.isPointerDownOnContentRef.current=!0}),ref:f,style:{...l.style,userSelect:m?"text":void 0,WebkitUserSelect:m?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),Wke="HoverCardArrow",Kse=w.forwardRef((e,t)=>{const{__scopeHoverCard:r,...n}=e,a=lj(r);return o.jsx(hSe,{...a,...n,ref:t})});Kse.displayName=Wke;function n_(e){return t=>t.pointerType==="touch"?void 0:e()}function Kke(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;r.nextNode();)t.push(r.currentNode);return t}var Gke=Fse,Vke=Hse,Yke=qse,Qke=Wse,Jke=Kse;const KH={agent:{icon:Vr,bg:"bg-purple-100",text:"text-purple-700",darkBg:"dark:bg-purple-900/30",darkText:"dark:text-purple-300"},human:{icon:tn,bg:"bg-blue-100",text:"text-blue-700",darkBg:"dark:bg-blue-900/30",darkText:"dark:text-blue-300"},system:{icon:Id,bg:"bg-gray-100",text:"text-gray-700",darkBg:"dark:bg-gray-800/50",darkText:"dark:text-gray-300"}};function Gse(e){return KH[e??"system"]||KH.system}function Zke(e){const t=e?.startsWith("el-");return pt({queryKey:["entities","byRef",e],queryFn:async()=>{if(!e)return null;if(t){const r=await fetch(`/api/entities/${e}`);if(!r.ok){if(r.status===404)return null;throw new Error("Failed to fetch entity")}return r.json()}else{const r=await fetch(`/api/entities?search=${encodeURIComponent(e)}&limit=100`);if(!r.ok)throw new Error("Failed to fetch entity");return(await r.json()).items.find(s=>s.name.toLowerCase()===e.toLowerCase())??null}},enabled:!!e,staleTime:3e4})}function Xke(e){return pt({queryKey:["entities",e,"stats"],queryFn:async()=>{const t=await fetch(`/api/entities/${e}/stats`);if(!t.ok)throw new Error("Failed to fetch entity stats");return t.json()},enabled:!!e,staleTime:3e4})}function Vse({entityRef:e,children:t,className:r="",showHoverCard:n=!1,showStats:a=!0,showIcon:s=!1,navigable:i=!1,onNavigate:l,renderProfileLink:c,"data-testid":u}){const{data:d,isLoading:f}=Zke(e),{data:m,isLoading:p}=Xke(n&&a?d?.id??null:null),v=t??d?.name??e,b=Gse(d?.entityType),y=b.icon,S=i?N=>{N.preventDefault(),N.stopPropagation(),l?.(d??null,e)}:void 0;if(!i&&!n&&f)return o.jsxs("span",{className:`inline-flex items-center gap-1 text-gray-400 ${r}`,children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),e]});const _=i?o.jsxs("button",{onClick:S,className:`inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 hover:underline cursor-pointer font-medium ${r}`,"data-testid":u||`entity-link-${e}`,children:[s&&o.jsx(y,{className:`w-3.5 h-3.5 ${b.text} ${b.darkText}`}),v]}):o.jsxs("span",{className:`inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 font-medium ${r}`,"data-testid":u||`entity-link-${e}`,title:d?`${d.name} (${d.entityType})`:e,children:[s&&o.jsx(y,{className:`w-3.5 h-3.5 ${b.text} ${b.darkText}`}),v]});return n?o.jsxs(Gke,{openDelay:400,closeDelay:200,children:[o.jsx(Vke,{asChild:!0,children:_}),o.jsx(Yke,{children:o.jsxs(Qke,{className:`w-72 p-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50
                     animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out
                     data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95
                     data-[side=top]:slide-in-from-bottom-2
                     data-[side=bottom]:slide-in-from-top-2`,sideOffset:5,"data-testid":`entity-preview-${e}`,children:[f?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx(Pe,{className:"w-5 h-5 animate-spin text-gray-400"})}):d?o.jsx(e_e,{entity:d,stats:a?m:void 0,statsLoading:a?p:!1,onNavigate:l,renderProfileLink:c}):o.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Entity not found: ",e]}),o.jsx(Jke,{className:"fill-white dark:fill-gray-900"})]})})]}):_}function e_e({entity:e,stats:t,statsLoading:r,onNavigate:n,renderProfileLink:a}){const s=Gse(e.entityType),i=s.icon;return o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${s.bg} ${s.darkBg}`,children:o.jsx(i,{className:`w-5 h-5 ${s.text} ${s.darkText}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:e.name}),o.jsx("div",{className:`text-xs ${s.text} ${s.darkText} capitalize`,children:e.entityType})]})]}),r?o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),"Loading stats..."]}):t?o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[o.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.openTasks}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Open"})]}),o.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.completedTasks}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Done"})]}),o.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.totalTasks}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total"})]})]}):null,t?.currentTask&&o.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/30 rounded border border-blue-100 dark:border-blue-800",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-blue-600 dark:text-blue-400 mb-1",children:[o.jsx(Rr,{className:"w-3 h-3"}),"Currently working on"]}),o.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:t.currentTask.title})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(l=>o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 rounded",children:l},l)),e.tags.length>3&&o.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",e.tags.length-3," more"]})]}),a?a(e):n?o.jsxs("button",{onClick:()=>n(e,e.id),className:"flex items-center gap-1 text-xs text-blue-600 dark:text-blue-400 hover:underline cursor-pointer","data-testid":`entity-preview-link-${e.id}`,children:["View full profile",o.jsx(wl,{className:"w-3 h-3"})]}):null]})}function Vm(e,t,r){let n=r.initialDeps??[],a,s=!0;function i(){var l,c,u;let d;r.key&&((l=r.debug)!=null&&l.call(r))&&(d=Date.now());const f=e();if(!(f.length!==n.length||f.some((v,b)=>n[b]!==v)))return a;n=f;let p;if(r.key&&((c=r.debug)!=null&&c.call(r))&&(p=Date.now()),a=t(...f),r.key&&((u=r.debug)!=null&&u.call(r))){const v=Math.round((Date.now()-d)*100)/100,b=Math.round((Date.now()-p)*100)/100,y=b/16,S=(_,N)=>{for(_=String(_);_.length<N;)_=" "+_;return _};console.info(`%c ${S(b,5)} /${S(v,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,r?.key)}return r?.onChange&&!(s&&r.skipInitialOnChange)&&r.onChange(a),s=!1,a}return i.updateDeps=l=>{n=l},i}function GH(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const t_e=(e,t)=>Math.abs(e-t)<1.01,r_e=(e,t,r)=>{let n;return function(...a){e.clearTimeout(n),n=e.setTimeout(()=>t.apply(this,a),r)}},VH=e=>{const{offsetWidth:t,offsetHeight:r}=e;return{width:t,height:r}},n_e=e=>e,a_e=e=>{const t=Math.max(e.startIndex-e.overscan,0),r=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let a=t;a<=r;a++)n.push(a);return n},s_e=(e,t)=>{const r=e.scrollElement;if(!r)return;const n=e.targetWindow;if(!n)return;const a=i=>{const{width:l,height:c}=i;t({width:Math.round(l),height:Math.round(c)})};if(a(VH(r)),!n.ResizeObserver)return()=>{};const s=new n.ResizeObserver(i=>{const l=()=>{const c=i[0];if(c?.borderBoxSize){const u=c.borderBoxSize[0];if(u){a({width:u.inlineSize,height:u.blockSize});return}}a(VH(r))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return s.observe(r,{box:"border-box"}),()=>{s.unobserve(r)}},YH={passive:!0},QH=typeof window>"u"?!0:"onscrollend"in window,i_e=(e,t)=>{const r=e.scrollElement;if(!r)return;const n=e.targetWindow;if(!n)return;let a=0;const s=e.options.useScrollendEvent&&QH?()=>{}:r_e(n,()=>{t(a,!1)},e.options.isScrollingResetDelay),i=d=>()=>{const{horizontal:f,isRtl:m}=e.options;a=f?r.scrollLeft*(m&&-1||1):r.scrollTop,s(),t(a,d)},l=i(!0),c=i(!1);r.addEventListener("scroll",l,YH);const u=e.options.useScrollendEvent&&QH;return u&&r.addEventListener("scrollend",c,YH),()=>{r.removeEventListener("scroll",l),u&&r.removeEventListener("scrollend",c)}},o_e=(e,t,r)=>{if(t?.borderBoxSize){const n=t.borderBoxSize[0];if(n)return Math.round(n[r.options.horizontal?"inlineSize":"blockSize"])}return e[r.options.horizontal?"offsetWidth":"offsetHeight"]},l_e=(e,{adjustments:t=0,behavior:r},n)=>{var a,s;const i=e+t;(s=(a=n.scrollElement)==null?void 0:a.scrollTo)==null||s.call(a,{[n.options.horizontal?"left":"top"]:i,behavior:r})};class c_e{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.currentScrollToIndex=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let r=null;const n=()=>r||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:r=new this.targetWindow.ResizeObserver(a=>{a.forEach(s=>{const i=()=>{this._measureElement(s.target,s)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(i):i()})}));return{disconnect:()=>{var a;(a=n())==null||a.disconnect(),r=null},observe:a=>{var s;return(s=n())==null?void 0:s.observe(a,{box:"border-box"})},unobserve:a=>{var s;return(s=n())==null?void 0:s.unobserve(a)}}})(),this.range=null,this.setOptions=r=>{Object.entries(r).forEach(([n,a])=>{typeof a>"u"&&delete r[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:n_e,rangeExtractor:a_e,onChange:()=>{},measureElement:o_e,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...r}},this.notify=r=>{var n,a;(a=(n=this.options).onChange)==null||a.call(n,this,r)},this.maybeNotify=Vm(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),r=>{this.notify(r)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(r=>r()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var r;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((r=this.scrollElement)==null?void 0:r.window)??null,this.elementsCache.forEach(a=>{this.observer.observe(a)}),this.unsubs.push(this.options.observeElementRect(this,a=>{this.scrollRect=a,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(a,s)=>{this.scrollAdjustments=0,this.scrollDirection=s?this.getScrollOffset()<a?"forward":"backward":null,this.scrollOffset=a,this.isScrolling=s,this.maybeNotify()})),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0})}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(r,n)=>{const a=new Map,s=new Map;for(let i=n-1;i>=0;i--){const l=r[i];if(a.has(l.lane))continue;const c=s.get(l.lane);if(c==null||l.end>c.end?s.set(l.lane,l):l.end<c.end&&a.set(l.lane,!0),a.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((i,l)=>i.end===l.end?i.index-l.index:i.end-l.end)[0]:void 0},this.getMeasurementOptions=Vm(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(r,n,a,s,i,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:r,paddingStart:n,scrollMargin:a,getItemKey:s,enabled:i,lanes:l}),{key:!1}),this.getMeasurements=Vm(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:r,paddingStart:n,scrollMargin:a,getItemKey:s,enabled:i,lanes:l},c)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>r)for(const m of this.laneAssignments.keys())m>=r&&this.laneAssignments.delete(m);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&!this.lanesSettling&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(m=>{this.itemSizeCache.set(m.key,m.size)}));const u=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===r&&(this.lanesSettling=!1);const d=this.measurementsCache.slice(0,u),f=new Array(l).fill(void 0);for(let m=0;m<u;m++){const p=d[m];p&&(f[p.lane]=m)}for(let m=u;m<r;m++){const p=s(m),v=this.laneAssignments.get(m);let b,y;if(v!==void 0&&this.options.lanes>1){b=v;const k=f[b],j=k!==void 0?d[k]:void 0;y=j?j.end+this.options.gap:n+a}else{const k=this.options.lanes===1?d[m-1]:this.getFurthestMeasurement(d,m);y=k?k.end+this.options.gap:n+a,b=k?k.lane:m%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(m,b)}const S=c.get(p),_=typeof S=="number"?S:this.options.estimateSize(m),N=y+_;d[m]={index:m,start:y,size:_,end:N,key:p,lane:b},f[b]=m}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Vm(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(r,n,a,s)=>this.range=r.length>0&&n>0?u_e({measurements:r,outerSize:n,scrollOffset:a,lanes:s}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Vm(()=>{let r=null,n=null;const a=this.calculateRange();return a&&(r=a.startIndex,n=a.endIndex),this.maybeNotify.updateDeps([this.isScrolling,r,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,r,n]},(r,n,a,s,i)=>s===null||i===null?[]:r({startIndex:s,endIndex:i,overscan:n,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=r=>{const n=this.options.indexAttribute,a=r.getAttribute(n);return a?parseInt(a,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(r,n)=>{const a=this.indexFromElement(r),s=this.measurementsCache[a];if(!s)return;const i=s.key,l=this.elementsCache.get(i);l!==r&&(l&&this.observer.unobserve(l),this.observer.observe(r),this.elementsCache.set(i,r)),r.isConnected&&this.resizeItem(a,this.options.measureElement(r,n,this))},this.resizeItem=(r,n)=>{const a=this.measurementsCache[r];if(!a)return;const s=this.itemSizeCache.get(a.key)??a.size,i=n-s;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(a,i,this):a.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(a.index),this.itemSizeCache=new Map(this.itemSizeCache.set(a.key,n)),this.notify(!1))},this.measureElement=r=>{if(!r){this.elementsCache.forEach((n,a)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(a))});return}this._measureElement(r,void 0)},this.getVirtualItems=Vm(()=>[this.getVirtualIndexes(),this.getMeasurements()],(r,n)=>{const a=[];for(let s=0,i=r.length;s<i;s++){const l=r[s],c=n[l];a.push(c)}return a},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=r=>{const n=this.getMeasurements();if(n.length!==0)return GH(n[Yse(0,n.length-1,a=>GH(n[a]).start,r)])},this.getMaxScrollOffset=()=>{if(!this.scrollElement)return 0;if("scrollHeight"in this.scrollElement)return this.options.horizontal?this.scrollElement.scrollWidth-this.scrollElement.clientWidth:this.scrollElement.scrollHeight-this.scrollElement.clientHeight;{const r=this.scrollElement.document.documentElement;return this.options.horizontal?r.scrollWidth-this.scrollElement.innerWidth:r.scrollHeight-this.scrollElement.innerHeight}},this.getOffsetForAlignment=(r,n,a=0)=>{if(!this.scrollElement)return 0;const s=this.getSize(),i=this.getScrollOffset();n==="auto"&&(n=r>=i+s?"end":"start"),n==="center"?r+=(a-s)/2:n==="end"&&(r-=s);const l=this.getMaxScrollOffset();return Math.max(Math.min(l,r),0)},this.getOffsetForIndex=(r,n="auto")=>{r=Math.max(0,Math.min(r,this.options.count-1));const a=this.measurementsCache[r];if(!a)return;const s=this.getSize(),i=this.getScrollOffset();if(n==="auto")if(a.end>=i+s-this.options.scrollPaddingEnd)n="end";else if(a.start<=i+this.options.scrollPaddingStart)n="start";else return[i,n];if(n==="end"&&r===this.options.count-1)return[this.getMaxScrollOffset(),n];const l=n==="end"?a.end+this.options.scrollPaddingEnd:a.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,n,a.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(r,{align:n="start",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(r,n),{adjustments:void 0,behavior:a})},this.scrollToIndex=(r,{align:n="auto",behavior:a}={})=>{a==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),r=Math.max(0,Math.min(r,this.options.count-1)),this.currentScrollToIndex=r;let s=0;const i=10,l=u=>{if(!this.targetWindow)return;const d=this.getOffsetForIndex(r,u);if(!d){console.warn("Failed to get offset for index:",r);return}const[f,m]=d;this._scrollToOffset(f,{adjustments:void 0,behavior:a}),this.targetWindow.requestAnimationFrame(()=>{const p=()=>{if(this.currentScrollToIndex!==r)return;const v=this.getScrollOffset(),b=this.getOffsetForIndex(r,m);if(!b){console.warn("Failed to get offset for index:",r);return}t_e(b[0],v)||c(m)};this.isDynamicMode()?this.targetWindow.requestAnimationFrame(p):p()})},c=u=>{this.targetWindow&&this.currentScrollToIndex===r&&(s++,s<i?this.targetWindow.requestAnimationFrame(()=>l(u)):console.warn(`Failed to scroll to index ${r} after ${i} attempts.`))};l(n)},this.scrollBy=(r,{behavior:n}={})=>{n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+r,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var r;const n=this.getMeasurements();let a;if(n.length===0)a=this.options.paddingStart;else if(this.options.lanes===1)a=((r=n[n.length-1])==null?void 0:r.end)??0;else{const s=Array(this.options.lanes).fill(null);let i=n.length-1;for(;i>=0&&s.some(l=>l===null);){const l=n[i];s[l.lane]===null&&(s[l.lane]=l.end),i--}a=Math.max(...s.filter(l=>l!==null))}return Math.max(a-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(r,{adjustments:n,behavior:a})=>{this.options.scrollToFn(r,{behavior:a,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const Yse=(e,t,r,n)=>{for(;e<=t;){const a=(e+t)/2|0,s=r(a);if(s<n)e=a+1;else if(s>n)t=a-1;else return a}return e>0?e-1:0};function u_e({measurements:e,outerSize:t,scrollOffset:r,lanes:n}){const a=e.length-1,s=c=>e[c].start;if(e.length<=n)return{startIndex:0,endIndex:a};let i=Yse(0,a,s,r),l=i;if(n===1)for(;l<a&&e[l].end<r+t;)l++;else if(n>1){const c=Array(n).fill(0);for(;l<a&&c.some(d=>d<r+t);){const d=e[l];c[d.lane]=d.end,l++}const u=Array(n).fill(r+t);for(;i>=0&&u.some(d=>d>=r);){const d=e[i];u[d.lane]=d.start,i--}i=Math.max(0,i-i%n),l=Math.min(a,l+(n-1-l%n))}return{startIndex:i,endIndex:l}}const JH=typeof document<"u"?w.useLayoutEffect:w.useEffect;function d_e({useFlushSync:e=!0,...t}){const r=w.useReducer(()=>({}),{})[1],n={...t,onChange:(s,i)=>{var l;e&&i?pd.flushSync(r):r(),(l=t.onChange)==null||l.call(t,s,i)}},[a]=w.useState(()=>new c_e(n));return a.setOptions(n),JH(()=>a._didMount(),[]),JH(()=>a._willUpdate()),a}function uj(e){return d_e({observeElementRect:s_e,observeElementOffset:i_e,scrollToFn:l_e,...e})}const kT="stoneforge-current-user-id",Qse=w.createContext(void 0);function f_e({children:e,useHumanEntities:t}){const{data:r=[],isLoading:n}=t(),[a,s]=w.useState(()=>typeof window<"u"?localStorage.getItem(kT):null),i=c=>{s(c),typeof window<"u"&&(c?localStorage.setItem(kT,c):localStorage.removeItem(kT))};w.useEffect(()=>{!n&&r.length>0&&!a&&i(r[0].id),!n&&r.length>0&&a&&(r.some(u=>u.id===a)||i(r[0].id))},[r,n,a]);const l=r.find(c=>c.id===a)??null;return o.jsx(Qse.Provider,{value:{currentUser:l,setCurrentUserId:i,humanEntities:r,isLoading:n},children:e})}function rl(){const e=w.useContext(Qse);if(e===void 0)throw new Error("useCurrentUser must be used within a CurrentUserProvider");return e}const $O=36,Jse=8,h_e=$O*Jse+8;function m_e(){const{currentUser:e,setCurrentUserId:t,humanEntities:r,isLoading:n}=rl(),[a,s]=w.useState(!1),[i,l]=w.useState(-1),c=w.useRef(null),u=w.useRef(null),d=w.useRef(null),f=uj({count:r.length,getScrollElement:()=>d.current,estimateSize:()=>$O,overscan:3}),[m,p]=w.useState({}),v=w.useCallback(()=>{if(c.current){const N=c.current.getBoundingClientRect();p({position:"fixed",top:N.bottom+4,left:N.left,width:N.width*2,zIndex:9999})}},[]);w.useEffect(()=>{if(a){v();const N=r.findIndex(k=>k.id===e?.id);l(N>=0?N:0)}},[a,v,r,e?.id]),w.useEffect(()=>{if(!a)return;const N=j=>{c.current&&!c.current.contains(j.target)&&u.current&&!u.current.contains(j.target)&&s(!1)},k=j=>{j.key==="Escape"&&(s(!1),c.current?.focus())};return document.addEventListener("mousedown",N),document.addEventListener("keydown",k),()=>{document.removeEventListener("mousedown",N),document.removeEventListener("keydown",k)}},[a]);const b=w.useCallback(N=>{if(!a){(N.key==="ArrowDown"||N.key==="ArrowUp"||N.key==="Enter"||N.key===" ")&&(N.preventDefault(),s(!0));return}switch(N.key){case"ArrowDown":N.preventDefault(),l(k=>{const j=k<r.length-1?k+1:k;return f.scrollToIndex(j,{align:"auto"}),j});break;case"ArrowUp":N.preventDefault(),l(k=>{const j=k>0?k-1:k;return f.scrollToIndex(j,{align:"auto"}),j});break;case"Enter":case" ":N.preventDefault(),i>=0&&i<r.length&&(t(r[i].id),s(!1),c.current?.focus());break;case"Home":N.preventDefault(),l(0),f.scrollToIndex(0,{align:"start"});break;case"End":N.preventDefault(),l(r.length-1),f.scrollToIndex(r.length-1,{align:"end"});break}},[a,i,r,t,f]),y=w.useCallback(N=>{t(N),s(!1),c.current?.focus()},[t]);if(n)return o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(tn,{className:"w-4 h-4"}),o.jsx("span",{children:"Loading..."})]});if(r.length===0)return o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(tn,{className:"w-4 h-4"}),o.jsx("span",{children:"No users"})]});const S=f.getVirtualItems(),_=r.length>Jse;return o.jsxs(o.Fragment,{children:[o.jsxs("button",{ref:c,type:"button",onClick:()=>s(!a),onKeyDown:b,className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)]","data-testid":"user-selector-trigger","aria-haspopup":"listbox","aria-expanded":a,children:[o.jsx(tn,{className:"w-4 h-4"}),o.jsx("span",{className:"truncate max-w-[120px]",children:e?.name??"Select user"}),o.jsx(Yt,{className:`w-3.5 h-3.5 transition-transform ${a?"rotate-180":""}`})]}),a&&pd.createPortal(o.jsxs("div",{ref:u,style:m,className:"bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 overflow-hidden",role:"listbox","data-testid":"user-selector-dropdown",children:[o.jsx("div",{ref:d,className:"overflow-auto p-1",style:{maxHeight:h_e},onKeyDown:b,children:o.jsx("div",{style:{height:f.getTotalSize(),width:"100%",position:"relative"},children:S.map(N=>{const k=r[N.index],j=k.id===e?.id,E=N.index===i;return o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:$O,transform:`translateY(${N.start}px)`},children:o.jsxs("button",{type:"button",onClick:()=>y(k.id),onMouseEnter:()=>l(N.index),className:["w-full text-left px-3 py-1.5 text-sm","flex items-center justify-between","transition-colors",j?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]",E?"bg-[var(--color-surface-hover)]":"hover:bg-[var(--color-surface-hover)]"].join(" "),role:"option","aria-selected":j,"data-testid":`user-selector-option-${k.id}`,children:[o.jsx("span",{className:"truncate",children:k.name}),j&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]})},k.id)})})}),_&&o.jsxs("div",{className:"px-2 py-1 text-xs text-center text-[var(--color-text-tertiary)] border-t border-[var(--color-border)]",children:[r.length," users"]})]}),document.body)]})}function Zse({channel:e,className:t="w-5 h-5"}){return e.channelType==="direct"?o.jsx(ds,{className:`text-gray-400 ${t}`}):e.permissions?.visibility==="private"?o.jsx(GC,{className:`text-gray-400 ${t}`}):o.jsx(qp,{className:`text-gray-400 ${t}`})}function p_e({channel:e,isMobile:t=!1,onBack:r,onOpenMembers:n,renderIcon:a,renderActions:s,showMemberCount:i=!1,membersButtonLabel:l,useSettingsIcon:c=!1}){const u=e.members?.length||0,d=m=>`${m} ${m===1?"member":"members"}`,f=c?Wa:pwe;return o.jsx("div",{"data-testid":"channel-header",className:`border-b border-[var(--color-border)] bg-[var(--color-bg)] ${t?"px-2 py-2":"px-4 py-3"}`,children:o.jsxs("div",{className:`flex items-center ${t?"gap-2":"gap-2 sm:gap-3"}`,children:[t&&r&&o.jsx("button",{onClick:r,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"channel-back-button","aria-label":"Back to channels",children:o.jsx(Ul,{className:"w-5 h-5"})}),a?a(e):o.jsx(Zse,{channel:e,className:t?"w-4 h-4":"w-5 h-5"}),o.jsx("h3",{"data-testid":"channel-name",className:`font-medium text-[var(--color-text)] truncate ${t?"text-base":i?"text-lg font-semibold":""}`,children:e.name}),n&&!t&&o.jsxs("button",{onClick:n,className:"flex items-center gap-1 text-sm text-gray-500 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 px-2 py-1 rounded transition-colors","data-testid":"channel-members-button",children:[o.jsx(f,{className:"w-4 h-4"}),(l||d)(u)]}),o.jsx("div",{className:"flex-1"}),s?.({channel:e,isMobile:t}),n&&t&&o.jsx("button",{onClick:n,className:"p-2 rounded-md text-gray-500 dark:text-gray-400 hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"channel-members-button","aria-label":"View members",children:c?o.jsx(Wa,{className:"w-5 h-5"}):o.jsx(ds,{className:"w-5 h-5"})})]})})}function g_e(e={}){const{onResultSelect:t,enableKeyboardShortcut:r=!0}=e,[n,a]=w.useState(""),[s,i]=w.useState(!1),l=w.useRef(null),c=w.useCallback(d=>{a(""),i(!1),t?.(d)},[t]),u=w.useCallback(()=>{a(""),i(!1)},[]);return w.useEffect(()=>{if(!r)return;const d=f=>{(f.metaKey||f.ctrlKey)&&f.key==="f"&&(f.preventDefault(),l.current?.focus(),i(!0))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[r]),{searchQuery:n,setSearchQuery:a,isSearchOpen:s,setIsSearchOpen:i,searchInputRef:l,handleResultSelect:c,clearSearch:u}}function Xse(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Xse(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ur(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Xse(e))&&(n&&(n+=" "),n+=t);return n}var _T,ZH;function li(){if(ZH)return _T;ZH=1;var e=Array.isArray;return _T=e,_T}var NT,XH;function eie(){if(XH)return NT;XH=1;var e=typeof gd=="object"&&gd&&gd.Object===Object&&gd;return NT=e,NT}var CT,eq;function Hl(){if(eq)return CT;eq=1;var e=eie(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return CT=r,CT}var jT,tq;function Hx(){if(tq)return jT;tq=1;var e=Hl(),t=e.Symbol;return jT=t,jT}var ET,rq;function v_e(){if(rq)return ET;rq=1;var e=Hx(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function s(i){var l=r.call(i,a),c=i[a];try{i[a]=void 0;var u=!0}catch{}var d=n.call(i);return u&&(l?i[a]=c:delete i[a]),d}return ET=s,ET}var MT,nq;function b_e(){if(nq)return MT;nq=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return MT=r,MT}var TT,aq;function fu(){if(aq)return TT;aq=1;var e=Hx(),t=v_e(),r=b_e(),n="[object Null]",a="[object Undefined]",s=e?e.toStringTag:void 0;function i(l){return l==null?l===void 0?a:n:s&&s in Object(l)?t(l):r(l)}return TT=i,TT}var AT,sq;function hu(){if(sq)return AT;sq=1;function e(t){return t!=null&&typeof t=="object"}return AT=e,AT}var DT,iq;function i0(){if(iq)return DT;iq=1;var e=fu(),t=hu(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return DT=n,DT}var LT,oq;function X6(){if(oq)return LT;oq=1;var e=li(),t=i0(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,i){if(e(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||t(s)?!0:n.test(s)||!r.test(s)||i!=null&&s in Object(i)}return LT=a,LT}var OT,lq;function $d(){if(lq)return OT;lq=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return OT=e,OT}var IT,cq;function ez(){if(cq)return IT;cq=1;var e=fu(),t=$d(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function i(l){if(!t(l))return!1;var c=e(l);return c==n||c==a||c==r||c==s}return IT=i,IT}var RT,uq;function y_e(){if(uq)return RT;uq=1;var e=Hl(),t=e["__core-js_shared__"];return RT=t,RT}var PT,dq;function x_e(){if(dq)return PT;dq=1;var e=y_e(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return PT=r,PT}var zT,fq;function tie(){if(fq)return zT;fq=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return zT=r,zT}var BT,hq;function w_e(){if(hq)return BT;hq=1;var e=ez(),t=x_e(),r=$d(),n=tie(),a=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,i=Function.prototype,l=Object.prototype,c=i.toString,u=l.hasOwnProperty,d=RegExp("^"+c.call(u).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(m){if(!r(m)||t(m))return!1;var p=e(m)?d:s;return p.test(n(m))}return BT=f,BT}var $T,mq;function S_e(){if(mq)return $T;mq=1;function e(t,r){return t?.[r]}return $T=e,$T}var FT,pq;function Wh(){if(pq)return FT;pq=1;var e=w_e(),t=S_e();function r(n,a){var s=t(n,a);return e(s)?s:void 0}return FT=r,FT}var UT,gq;function dj(){if(gq)return UT;gq=1;var e=Wh(),t=e(Object,"create");return UT=t,UT}var HT,vq;function k_e(){if(vq)return HT;vq=1;var e=dj();function t(){this.__data__=e?e(null):{},this.size=0}return HT=t,HT}var qT,bq;function __e(){if(bq)return qT;bq=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return qT=e,qT}var WT,yq;function N_e(){if(yq)return WT;yq=1;var e=dj(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(s){var i=this.__data__;if(e){var l=i[s];return l===t?void 0:l}return n.call(i,s)?i[s]:void 0}return WT=a,WT}var KT,xq;function C_e(){if(xq)return KT;xq=1;var e=dj(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var s=this.__data__;return e?s[a]!==void 0:r.call(s,a)}return KT=n,KT}var GT,wq;function j_e(){if(wq)return GT;wq=1;var e=dj(),t="__lodash_hash_undefined__";function r(n,a){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=e&&a===void 0?t:a,this}return GT=r,GT}var VT,Sq;function E_e(){if(Sq)return VT;Sq=1;var e=k_e(),t=__e(),r=N_e(),n=C_e(),a=j_e();function s(i){var l=-1,c=i==null?0:i.length;for(this.clear();++l<c;){var u=i[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,VT=s,VT}var YT,kq;function M_e(){if(kq)return YT;kq=1;function e(){this.__data__=[],this.size=0}return YT=e,YT}var QT,_q;function tz(){if(_q)return QT;_q=1;function e(t,r){return t===r||t!==t&&r!==r}return QT=e,QT}var JT,Nq;function fj(){if(Nq)return JT;Nq=1;var e=tz();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return JT=t,JT}var ZT,Cq;function T_e(){if(Cq)return ZT;Cq=1;var e=fj(),t=Array.prototype,r=t.splice;function n(a){var s=this.__data__,i=e(s,a);if(i<0)return!1;var l=s.length-1;return i==l?s.pop():r.call(s,i,1),--this.size,!0}return ZT=n,ZT}var XT,jq;function A_e(){if(jq)return XT;jq=1;var e=fj();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return XT=t,XT}var e4,Eq;function D_e(){if(Eq)return e4;Eq=1;var e=fj();function t(r){return e(this.__data__,r)>-1}return e4=t,e4}var t4,Mq;function L_e(){if(Mq)return t4;Mq=1;var e=fj();function t(r,n){var a=this.__data__,s=e(a,r);return s<0?(++this.size,a.push([r,n])):a[s][1]=n,this}return t4=t,t4}var r4,Tq;function hj(){if(Tq)return r4;Tq=1;var e=M_e(),t=T_e(),r=A_e(),n=D_e(),a=L_e();function s(i){var l=-1,c=i==null?0:i.length;for(this.clear();++l<c;){var u=i[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,r4=s,r4}var n4,Aq;function rz(){if(Aq)return n4;Aq=1;var e=Wh(),t=Hl(),r=e(t,"Map");return n4=r,n4}var a4,Dq;function O_e(){if(Dq)return a4;Dq=1;var e=E_e(),t=hj(),r=rz();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return a4=n,a4}var s4,Lq;function I_e(){if(Lq)return s4;Lq=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return s4=e,s4}var i4,Oq;function mj(){if(Oq)return i4;Oq=1;var e=I_e();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return i4=t,i4}var o4,Iq;function R_e(){if(Iq)return o4;Iq=1;var e=mj();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return o4=t,o4}var l4,Rq;function P_e(){if(Rq)return l4;Rq=1;var e=mj();function t(r){return e(this,r).get(r)}return l4=t,l4}var c4,Pq;function z_e(){if(Pq)return c4;Pq=1;var e=mj();function t(r){return e(this,r).has(r)}return c4=t,c4}var u4,zq;function B_e(){if(zq)return u4;zq=1;var e=mj();function t(r,n){var a=e(this,r),s=a.size;return a.set(r,n),this.size+=a.size==s?0:1,this}return u4=t,u4}var d4,Bq;function nz(){if(Bq)return d4;Bq=1;var e=O_e(),t=R_e(),r=P_e(),n=z_e(),a=B_e();function s(i){var l=-1,c=i==null?0:i.length;for(this.clear();++l<c;){var u=i[l];this.set(u[0],u[1])}}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=r,s.prototype.has=n,s.prototype.set=a,d4=s,d4}var f4,$q;function rie(){if($q)return f4;$q=1;var e=nz(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var s=function(){var i=arguments,l=a?a.apply(this,i):i[0],c=s.cache;if(c.has(l))return c.get(l);var u=n.apply(this,i);return s.cache=c.set(l,u)||c,u};return s.cache=new(r.Cache||e),s}return r.Cache=e,f4=r,f4}var h4,Fq;function $_e(){if(Fq)return h4;Fq=1;var e=rie(),t=500;function r(n){var a=e(n,function(i){return s.size===t&&s.clear(),i}),s=a.cache;return a}return h4=r,h4}var m4,Uq;function F_e(){if(Uq)return m4;Uq=1;var e=$_e(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(t,function(i,l,c,u){s.push(c?u.replace(r,"$1"):l||i)}),s});return m4=n,m4}var p4,Hq;function az(){if(Hq)return p4;Hq=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,s=Array(a);++n<a;)s[n]=r(t[n],n,t);return s}return p4=e,p4}var g4,qq;function U_e(){if(qq)return g4;qq=1;var e=Hx(),t=az(),r=li(),n=i0(),a=e?e.prototype:void 0,s=a?a.toString:void 0;function i(l){if(typeof l=="string")return l;if(r(l))return t(l,i)+"";if(n(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return g4=i,g4}var v4,Wq;function nie(){if(Wq)return v4;Wq=1;var e=U_e();function t(r){return r==null?"":e(r)}return v4=t,v4}var b4,Kq;function aie(){if(Kq)return b4;Kq=1;var e=li(),t=X6(),r=F_e(),n=nie();function a(s,i){return e(s)?s:t(s,i)?[s]:r(n(s))}return b4=a,b4}var y4,Gq;function pj(){if(Gq)return y4;Gq=1;var e=i0();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return y4=t,y4}var x4,Vq;function sz(){if(Vq)return x4;Vq=1;var e=aie(),t=pj();function r(n,a){a=e(a,n);for(var s=0,i=a.length;n!=null&&s<i;)n=n[t(a[s++])];return s&&s==i?n:void 0}return x4=r,x4}var w4,Yq;function sie(){if(Yq)return w4;Yq=1;var e=sz();function t(r,n,a){var s=r==null?void 0:e(r,n);return s===void 0?a:s}return w4=t,w4}var H_e=sie();const Di=Ur(H_e);var S4,Qq;function q_e(){if(Qq)return S4;Qq=1;function e(t){return t==null}return S4=e,S4}var W_e=q_e();const rr=Ur(W_e);var k4,Jq;function K_e(){if(Jq)return k4;Jq=1;var e=fu(),t=li(),r=hu(),n="[object String]";function a(s){return typeof s=="string"||!t(s)&&r(s)&&e(s)==n}return k4=a,k4}var G_e=K_e();const yh=Ur(G_e);var V_e=ez();const er=Ur(V_e);var Y_e=$d();const o0=Ur(Y_e);var _4={exports:{}},qr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zq;function Q_e(){if(Zq)return qr;Zq=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),i=Symbol.for("react.context"),l=Symbol.for("react.server_context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),v;v=Symbol.for("react.module.reference");function b(y){if(typeof y=="object"&&y!==null){var S=y.$$typeof;switch(S){case e:switch(y=y.type,y){case r:case a:case n:case u:case d:return y;default:switch(y=y&&y.$$typeof,y){case l:case i:case c:case m:case f:case s:return y;default:return S}}case t:return S}}}return qr.ContextConsumer=i,qr.ContextProvider=s,qr.Element=e,qr.ForwardRef=c,qr.Fragment=r,qr.Lazy=m,qr.Memo=f,qr.Portal=t,qr.Profiler=a,qr.StrictMode=n,qr.Suspense=u,qr.SuspenseList=d,qr.isAsyncMode=function(){return!1},qr.isConcurrentMode=function(){return!1},qr.isContextConsumer=function(y){return b(y)===i},qr.isContextProvider=function(y){return b(y)===s},qr.isElement=function(y){return typeof y=="object"&&y!==null&&y.$$typeof===e},qr.isForwardRef=function(y){return b(y)===c},qr.isFragment=function(y){return b(y)===r},qr.isLazy=function(y){return b(y)===m},qr.isMemo=function(y){return b(y)===f},qr.isPortal=function(y){return b(y)===t},qr.isProfiler=function(y){return b(y)===a},qr.isStrictMode=function(y){return b(y)===n},qr.isSuspense=function(y){return b(y)===u},qr.isSuspenseList=function(y){return b(y)===d},qr.isValidElementType=function(y){return typeof y=="string"||typeof y=="function"||y===r||y===a||y===n||y===u||y===d||y===p||typeof y=="object"&&y!==null&&(y.$$typeof===m||y.$$typeof===f||y.$$typeof===s||y.$$typeof===i||y.$$typeof===c||y.$$typeof===v||y.getModuleId!==void 0)},qr.typeOf=b,qr}var Xq;function J_e(){return Xq||(Xq=1,_4.exports=Q_e()),_4.exports}var Z_e=J_e(),N4,e7;function iie(){if(e7)return N4;e7=1;var e=fu(),t=hu(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return N4=n,N4}var C4,t7;function X_e(){if(t7)return C4;t7=1;var e=iie();function t(r){return e(r)&&r!=+r}return C4=t,C4}var eNe=X_e();const qx=Ur(eNe);var tNe=iie();const rNe=Ur(tNe);var Ls=function(t){return t===0?0:t>0?1:-1},Wf=function(t){return yh(t)&&t.indexOf("%")===t.length-1},tt=function(t){return rNe(t)&&!qx(t)},nNe=function(t){return rr(t)},ja=function(t){return tt(t)||yh(t)},aNe=0,l0=function(t){var r=++aNe;return"".concat(t||"").concat(r)},Os=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!tt(t)&&!yh(t))return n;var s;if(Wf(t)){var i=t.indexOf("%");s=r*parseFloat(t.slice(0,i))/100}else s=+t;return qx(s)&&(s=n),a&&s>r&&(s=r),s},ud=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},sNe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},ji=function(t,r){return tt(t)&&tt(r)?function(n){return t+n*(r-t)}:function(){return r}};function a_(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Di(n,t))===r})}var iNe=function(t,r){return tt(t)&&tt(r)?t-r:yh(t)&&yh(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Op(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function FO(e){"@babel/helpers - typeof";return FO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FO(e)}var oNe=["viewBox","children"],lNe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],r7=["points","pathLength"],j4={svg:oNe,polygon:r7,polyline:r7},iz=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],s_=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),!o0(n))return null;var a={};return Object.keys(n).forEach(function(s){iz.includes(s)&&(a[s]=r||function(i){return n[s](n,i)})}),a},cNe=function(t,r,n){return function(a){return t(r,n,a),null}},xh=function(t,r,n){if(!o0(t)||FO(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(s){var i=t[s];iz.includes(s)&&typeof i=="function"&&(a||(a={}),a[s]=cNe(i,r,n))}),a},uNe=["children"],dNe=["children"];function n7(e,t){if(e==null)return{};var r=fNe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function fNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function UO(e){"@babel/helpers - typeof";return UO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UO(e)}var a7={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Yc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},s7=null,E4=null,oz=function e(t){if(t===s7&&Array.isArray(E4))return E4;var r=[];return w.Children.forEach(t,function(n){rr(n)||(Z_e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),E4=r,s7=t,r};function Li(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return Yc(a)}):n=[Yc(t)],oz(e).forEach(function(a){var s=Di(a,"type.displayName")||Di(a,"type.name");n.indexOf(s)!==-1&&r.push(a)}),r}function Ni(e,t){var r=Li(e,t);return r&&r[0]}var i7=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!tt(n)||n<=0||!tt(a)||a<=0)},hNe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],mNe=function(t){return t&&t.type&&yh(t.type)&&hNe.indexOf(t.type)>=0},pNe=function(t){return t&&UO(t)==="object"&&"clipDot"in t},gNe=function(t,r,n,a){var s,i=(s=j4?.[a])!==null&&s!==void 0?s:[];return r.startsWith("data-")||!er(t)&&(a&&i.includes(r)||lNe.includes(r))||n&&iz.includes(r)},Ht=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(w.isValidElement(t)&&(a=t.props),!o0(a))return null;var s={};return Object.keys(a).forEach(function(i){var l;gNe((l=a)===null||l===void 0?void 0:l[i],i,r,n)&&(s[i]=a[i])}),s},HO=function e(t,r){if(t===r)return!0;var n=w.Children.count(t);if(n!==w.Children.count(r))return!1;if(n===0)return!0;if(n===1)return o7(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var s=t[a],i=r[a];if(Array.isArray(s)||Array.isArray(i)){if(!e(s,i))return!1}else if(!o7(s,i))return!1}return!0},o7=function(t,r){if(rr(t)&&rr(r))return!0;if(!rr(t)&&!rr(r)){var n=t.props||{},a=n.children,s=n7(n,uNe),i=r.props||{},l=i.children,c=n7(i,dNe);return a&&l?Op(s,c)&&HO(a,l):!a&&!l?Op(s,c):!1}return!1},l7=function(t,r){var n=[],a={};return oz(t).forEach(function(s,i){if(mNe(s))n.push(s);else if(s){var l=Yc(s.type),c=r[l]||{},u=c.handler,d=c.once;if(u&&(!d||!a[l])){var f=u(s,l,i);n.push(f),a[l]=!0}}}),n},vNe=function(t){var r=t&&t.type;return r&&a7[r]?a7[r]:null},bNe=function(t,r){return oz(r).indexOf(t)},yNe=["children","width","height","viewBox","className","style","title","desc"];function qO(){return qO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qO.apply(this,arguments)}function xNe(e,t){if(e==null)return{};var r=wNe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function WO(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,s=e.className,i=e.style,l=e.title,c=e.desc,u=xNe(e,yNe),d=a||{width:r,height:n,x:0,y:0},f=ur("recharts-surface",s);return ce.createElement("svg",qO({},Ht(u,!0,"svg"),{className:f,width:r,height:n,style:i,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),ce.createElement("title",null,l),ce.createElement("desc",null,c),t)}var SNe=["children","className"];function KO(){return KO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KO.apply(this,arguments)}function kNe(e,t){if(e==null)return{};var r=_Ne(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Ne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Ir=ce.forwardRef(function(e,t){var r=e.children,n=e.className,a=kNe(e,SNe),s=ur("recharts-layer",n);return ce.createElement("g",KO({className:s},Ht(a,!0),{ref:t}),r)}),Qo=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s]},M4,c7;function NNe(){if(c7)return M4;c7=1;function e(t,r,n){var a=-1,s=t.length;r<0&&(r=-r>s?0:s+r),n=n>s?s:n,n<0&&(n+=s),s=r>n?0:n-r>>>0,r>>>=0;for(var i=Array(s);++a<s;)i[a]=t[a+r];return i}return M4=e,M4}var T4,u7;function CNe(){if(u7)return T4;u7=1;var e=NNe();function t(r,n,a){var s=r.length;return a=a===void 0?s:a,!n&&a>=s?r:e(r,n,a)}return T4=t,T4}var A4,d7;function oie(){if(d7)return A4;d7=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,s="\\ufe0e\\ufe0f",i="\\u200d",l=RegExp("["+i+e+a+s+"]");function c(u){return l.test(u)}return A4=c,A4}var D4,f7;function jNe(){if(f7)return D4;f7=1;function e(t){return t.split("")}return D4=e,D4}var L4,h7;function ENe(){if(h7)return L4;h7=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,s="\\ufe0e\\ufe0f",i="["+e+"]",l="["+a+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+l+"|"+c+")",d="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",p="\\u200d",v=u+"?",b="["+s+"]?",y="(?:"+p+"(?:"+[d,f,m].join("|")+")"+b+v+")*",S=b+v+y,_="(?:"+[d+l+"?",l,f,m,i].join("|")+")",N=RegExp(c+"(?="+c+")|"+_+S,"g");function k(j){return j.match(N)||[]}return L4=k,L4}var O4,m7;function MNe(){if(m7)return O4;m7=1;var e=jNe(),t=oie(),r=ENe();function n(a){return t(a)?r(a):e(a)}return O4=n,O4}var I4,p7;function TNe(){if(p7)return I4;p7=1;var e=CNe(),t=oie(),r=MNe(),n=nie();function a(s){return function(i){i=n(i);var l=t(i)?r(i):void 0,c=l?l[0]:i.charAt(0),u=l?e(l,1).join(""):i.slice(1);return c[s]()+u}}return I4=a,I4}var R4,g7;function ANe(){if(g7)return R4;g7=1;var e=TNe(),t=e("toUpperCase");return R4=t,R4}var DNe=ANe();const gj=Ur(DNe);function yn(e){return function(){return e}}const lie=Math.cos,i_=Math.sin,nl=Math.sqrt,o_=Math.PI,vj=2*o_,GO=Math.PI,VO=2*GO,Rf=1e-6,LNe=VO-Rf;function cie(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function ONe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return cie;const r=10**t;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class INe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?cie:ONe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,s,i){this._append`C${+t},${+r},${+n},${+a},${this._x1=+s},${this._y1=+i}`}arcTo(t,r,n,a,s){if(t=+t,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let i=this._x1,l=this._y1,c=n-t,u=a-r,d=i-t,f=l-r,m=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>Rf)if(!(Math.abs(f*c-u*d)>Rf)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-i,v=a-l,b=c*c+u*u,y=p*p+v*v,S=Math.sqrt(b),_=Math.sqrt(m),N=s*Math.tan((GO-Math.acos((b+m-y)/(2*S*_)))/2),k=N/_,j=N/S;Math.abs(k-1)>Rf&&this._append`L${t+k*d},${r+k*f}`,this._append`A${s},${s},0,0,${+(f*p>d*v)},${this._x1=t+j*c},${this._y1=r+j*u}`}}arc(t,r,n,a,s,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=t+l,d=r+c,f=1^i,m=i?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Rf||Math.abs(this._y1-d)>Rf)&&this._append`L${u},${d}`,n&&(m<0&&(m=m%VO+VO),m>LNe?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:m>Rf&&this._append`A${n},${n},0,${+(m>=GO)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function lz(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new INe(t)}function cz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function uie(e){this._context=e}uie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function bj(e){return new uie(e)}function die(e){return e[0]}function fie(e){return e[1]}function hie(e,t){var r=yn(!0),n=null,a=bj,s=null,i=lz(l);e=typeof e=="function"?e:e===void 0?die:yn(e),t=typeof t=="function"?t:t===void 0?fie:yn(t);function l(c){var u,d=(c=cz(c)).length,f,m=!1,p;for(n==null&&(s=a(p=i())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(f,u,c),+t(f,u,c));if(p)return s=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:yn(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:yn(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:yn(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function Qw(e,t,r){var n=null,a=yn(!0),s=null,i=bj,l=null,c=lz(u);e=typeof e=="function"?e:e===void 0?die:yn(+e),t=typeof t=="function"?t:yn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?fie:yn(+r);function u(f){var m,p,v,b=(f=cz(f)).length,y,S=!1,_,N=new Array(b),k=new Array(b);for(s==null&&(l=i(_=c())),m=0;m<=b;++m){if(!(m<b&&a(y=f[m],m,f))===S)if(S=!S)p=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=m-1;v>=p;--v)l.point(N[v],k[v]);l.lineEnd(),l.areaEnd()}S&&(N[m]=+e(y,m,f),k[m]=+t(y,m,f),l.point(n?+n(y,m,f):N[m],r?+r(y,m,f):k[m]))}if(_)return l=null,_+""||null}function d(){return hie().defined(a).curve(i).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:yn(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:yn(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:yn(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:yn(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:yn(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:yn(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:yn(!!f),u):a},u.curve=function(f){return arguments.length?(i=f,s!=null&&(l=i(s)),u):i},u.context=function(f){return arguments.length?(f==null?s=l=null:l=i(s=f),u):s},u}class mie{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function RNe(e){return new mie(e,!0)}function PNe(e){return new mie(e,!1)}const uz={draw(e,t){const r=nl(t/o_);e.moveTo(r,0),e.arc(0,0,r,0,vj)}},zNe={draw(e,t){const r=nl(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},pie=nl(1/3),BNe=pie*2,$Ne={draw(e,t){const r=nl(t/BNe),n=r*pie;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},FNe={draw(e,t){const r=nl(t),n=-r/2;e.rect(n,n,r,r)}},UNe=.8908130915292852,gie=i_(o_/10)/i_(7*o_/10),HNe=i_(vj/10)*gie,qNe=-lie(vj/10)*gie,WNe={draw(e,t){const r=nl(t*UNe),n=HNe*r,a=qNe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let s=1;s<5;++s){const i=vj*s/5,l=lie(i),c=i_(i);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},P4=nl(3),KNe={draw(e,t){const r=-nl(t/(P4*3));e.moveTo(0,r*2),e.lineTo(-P4*r,-r),e.lineTo(P4*r,-r),e.closePath()}},Xi=-.5,eo=nl(3)/2,YO=1/nl(12),GNe=(YO/2+1)*3,VNe={draw(e,t){const r=nl(t/GNe),n=r/2,a=r*YO,s=n,i=r*YO+r,l=-s,c=i;e.moveTo(n,a),e.lineTo(s,i),e.lineTo(l,c),e.lineTo(Xi*n-eo*a,eo*n+Xi*a),e.lineTo(Xi*s-eo*i,eo*s+Xi*i),e.lineTo(Xi*l-eo*c,eo*l+Xi*c),e.lineTo(Xi*n+eo*a,Xi*a-eo*n),e.lineTo(Xi*s+eo*i,Xi*i-eo*s),e.lineTo(Xi*l+eo*c,Xi*c-eo*l),e.closePath()}};function YNe(e,t){let r=null,n=lz(a);e=typeof e=="function"?e:yn(e||uz),t=typeof t=="function"?t:yn(t===void 0?64:+t);function a(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(e=typeof s=="function"?s:yn(s),a):e},a.size=function(s){return arguments.length?(t=typeof s=="function"?s:yn(+s),a):t},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function l_(){}function c_(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function vie(e){this._context=e}vie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:c_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:c_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function QNe(e){return new vie(e)}function bie(e){this._context=e}bie.prototype={areaStart:l_,areaEnd:l_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:c_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JNe(e){return new bie(e)}function yie(e){this._context=e}yie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:c_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZNe(e){return new yie(e)}function xie(e){this._context=e}xie.prototype={areaStart:l_,areaEnd:l_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function XNe(e){return new xie(e)}function v7(e){return e<0?-1:1}function b7(e,t,r){var n=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(n||a<0&&-0),i=(r-e._y1)/(a||n<0&&-0),l=(s*a+i*n)/(n+a);return(v7(s)+v7(i))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs(l))||0}function y7(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function z4(e,t,r){var n=e._x0,a=e._y0,s=e._x1,i=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,a+l*t,s-l,i-l*r,s,i)}function u_(e){this._context=e}u_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:z4(this,this._t0,y7(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,z4(this,y7(this,r=b7(this,e,t)),r);break;default:z4(this,this._t0,r=b7(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function wie(e){this._context=new Sie(e)}(wie.prototype=Object.create(u_.prototype)).point=function(e,t){u_.prototype.point.call(this,t,e)};function Sie(e){this._context=e}Sie.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,s){this._context.bezierCurveTo(t,e,n,r,s,a)}};function eCe(e){return new u_(e)}function tCe(e){return new wie(e)}function kie(e){this._context=e}kie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=x7(e),a=x7(t),s=0,i=1;i<r;++s,++i)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function x7(e){var t,r=e.length-1,n,a=new Array(r),s=new Array(r),i=new Array(r);for(a[0]=0,s[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,s[t]=4,i[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,s[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/s[t-1],s[t]-=n,i[t]-=n*i[t-1];for(a[r-1]=i[r-1]/s[r-1],t=r-2;t>=0;--t)a[t]=(i[t]-a[t+1])/s[t];for(s[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function rCe(e){return new kie(e)}function yj(e,t){this._context=e,this._t=t}yj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function nCe(e){return new yj(e,.5)}function aCe(e){return new yj(e,0)}function sCe(e){return new yj(e,1)}function Jp(e,t){if((i=e.length)>1)for(var r=1,n,a,s=e[t[0]],i,l=s.length;r<i;++r)for(a=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function QO(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function iCe(e,t){return e[t]}function oCe(e){const t=[];return t.key=e,t}function lCe(){var e=yn([]),t=QO,r=Jp,n=iCe;function a(s){var i=Array.from(e.apply(this,arguments),oCe),l,c=i.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(i[l][u]=[0,+n(f,i[l].key,u,s)]).data=f;for(l=0,d=cz(t(i));l<c;++l)i[d[l]].index=l;return r(i,d),i}return a.keys=function(s){return arguments.length?(e=typeof s=="function"?s:yn(Array.from(s)),a):e},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:yn(+s),a):n},a.order=function(s){return arguments.length?(t=s==null?QO:typeof s=="function"?s:yn(Array.from(s)),a):t},a.offset=function(s){return arguments.length?(r=s??Jp,a):r},a}function cCe(e,t){if((n=e.length)>0){for(var r,n,a=0,s=e[0].length,i;a<s;++a){for(i=r=0;r<n;++r)i+=e[r][a][1]||0;if(i)for(r=0;r<n;++r)e[r][a][1]/=i}Jp(e,t)}}function uCe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,s=n.length;r<s;++r){for(var i=0,l=0;i<a;++i)l+=e[i][r][1]||0;n[r][1]+=n[r][0]=-l/2}Jp(e,t)}}function dCe(e,t){if(!(!((i=e.length)>0)||!((s=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,s,i;n<s;++n){for(var l=0,c=0,u=0;l<i;++l){for(var d=e[t[l]],f=d[n][1]||0,m=d[n-1][1]||0,p=(f-m)/2,v=0;v<l;++v){var b=e[t[v]],y=b[n][1]||0,S=b[n-1][1]||0;p+=y-S}c+=f,u+=p*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Jp(e,t)}}function cy(e){"@babel/helpers - typeof";return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cy(e)}var fCe=["type","size","sizeType"];function JO(){return JO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JO.apply(this,arguments)}function w7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function S7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w7(Object(r),!0).forEach(function(n){hCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hCe(e,t,r){return t=mCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mCe(e){var t=pCe(e,"string");return cy(t)=="symbol"?t:t+""}function pCe(e,t){if(cy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gCe(e,t){if(e==null)return{};var r=vCe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var _ie={symbolCircle:uz,symbolCross:zNe,symbolDiamond:$Ne,symbolSquare:FNe,symbolStar:WNe,symbolTriangle:KNe,symbolWye:VNe},bCe=Math.PI/180,yCe=function(t){var r="symbol".concat(gj(t));return _ie[r]||uz},xCe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*bCe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},wCe=function(t,r){_ie["symbol".concat(gj(t))]=r},dz=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,s=a===void 0?64:a,i=t.sizeType,l=i===void 0?"area":i,c=gCe(t,fCe),u=S7(S7({},c),{},{type:n,size:s,sizeType:l}),d=function(){var y=yCe(n),S=YNe().type(y).size(xCe(s,l,n));return S()},f=u.className,m=u.cx,p=u.cy,v=Ht(u,!0);return m===+m&&p===+p&&s===+s?ce.createElement("path",JO({},v,{className:ur("recharts-symbols",f),transform:"translate(".concat(m,", ").concat(p,")"),d:d()})):null};dz.registerSymbol=wCe;function Zp(e){"@babel/helpers - typeof";return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zp(e)}function ZO(){return ZO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ZO.apply(this,arguments)}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function SCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){uy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cie(n.key),n)}}function NCe(e,t,r){return t&&_Ce(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function CCe(e,t,r){return t=d_(t),jCe(e,Nie()?Reflect.construct(t,r||[],d_(e).constructor):t.apply(e,r))}function jCe(e,t){if(t&&(Zp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ECe(e)}function ECe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nie=function(){return!!e})()}function d_(e){return d_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d_(e)}function MCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XO(e,t)}function XO(e,t){return XO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},XO(e,t)}function uy(e,t,r){return t=Cie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cie(e){var t=TCe(e,"string");return Zp(t)=="symbol"?t:t+""}function TCe(e,t){if(Zp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var to=32,fz=(function(e){function t(){return kCe(this,t),CCe(this,t,arguments)}return MCe(t,e),NCe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,s=to/2,i=to/6,l=to/3,c=n.inactive?a:n.color;if(n.type==="plainline")return ce.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:s,x2:to,y2:s,className:"recharts-legend-icon"});if(n.type==="line")return ce.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(s,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(s,`
            H`).concat(to,"M").concat(2*l,",").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(s),className:"recharts-legend-icon"});if(n.type==="rect")return ce.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(to/8,"h").concat(to,"v").concat(to*3/4,"h").concat(-to,"z"),className:"recharts-legend-icon"});if(ce.isValidElement(n.legendIcon)){var u=SCe({},n);return delete u.legendIcon,ce.cloneElement(n.legendIcon,u)}return ce.createElement(dz,{fill:c,cx:s,cy:s,size:to,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,s=a.payload,i=a.iconSize,l=a.layout,c=a.formatter,u=a.inactiveColor,d={x:0,y:0,width:to,height:to},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},m={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(p,v){var b=p.formatter||c,y=ur(uy(uy({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",p.inactive));if(p.type==="none")return null;var S=er(p.value)?null:p.value;Qo(!er(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var _=p.inactive?u:p.color;return ce.createElement("li",ZO({className:y,style:f,key:"legend-item-".concat(v)},xh(n.props,p,v)),ce.createElement(WO,{width:i,height:i,viewBox:d,style:m},n.renderIcon(p)),ce.createElement("span",{className:"recharts-legend-item-text",style:{color:_}},b?b(S,p,v):S))})}},{key:"render",value:function(){var n=this.props,a=n.payload,s=n.layout,i=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:s==="horizontal"?i:"left"};return ce.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])})(w.PureComponent);uy(fz,"displayName","Legend");uy(fz,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var B4,_7;function ACe(){if(_7)return B4;_7=1;var e=hj();function t(){this.__data__=new e,this.size=0}return B4=t,B4}var $4,N7;function DCe(){if(N7)return $4;N7=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return $4=e,$4}var F4,C7;function LCe(){if(C7)return F4;C7=1;function e(t){return this.__data__.get(t)}return F4=e,F4}var U4,j7;function OCe(){if(j7)return U4;j7=1;function e(t){return this.__data__.has(t)}return U4=e,U4}var H4,E7;function ICe(){if(E7)return H4;E7=1;var e=hj(),t=rz(),r=nz(),n=200;function a(s,i){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([s,i]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(s,i),this.size=l.size,this}return H4=a,H4}var q4,M7;function jie(){if(M7)return q4;M7=1;var e=hj(),t=ACe(),r=DCe(),n=LCe(),a=OCe(),s=ICe();function i(l){var c=this.__data__=new e(l);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=r,i.prototype.get=n,i.prototype.has=a,i.prototype.set=s,q4=i,q4}var W4,T7;function RCe(){if(T7)return W4;T7=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return W4=t,W4}var K4,A7;function PCe(){if(A7)return K4;A7=1;function e(t){return this.__data__.has(t)}return K4=e,K4}var G4,D7;function Eie(){if(D7)return G4;D7=1;var e=nz(),t=RCe(),r=PCe();function n(a){var s=-1,i=a==null?0:a.length;for(this.__data__=new e;++s<i;)this.add(a[s])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,G4=n,G4}var V4,L7;function Mie(){if(L7)return V4;L7=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return V4=e,V4}var Y4,O7;function Tie(){if(O7)return Y4;O7=1;function e(t,r){return t.has(r)}return Y4=e,Y4}var Q4,I7;function Aie(){if(I7)return Q4;I7=1;var e=Eie(),t=Mie(),r=Tie(),n=1,a=2;function s(i,l,c,u,d,f){var m=c&n,p=i.length,v=l.length;if(p!=v&&!(m&&v>p))return!1;var b=f.get(i),y=f.get(l);if(b&&y)return b==l&&y==i;var S=-1,_=!0,N=c&a?new e:void 0;for(f.set(i,l),f.set(l,i);++S<p;){var k=i[S],j=l[S];if(u)var E=m?u(j,k,S,l,i,f):u(k,j,S,i,l,f);if(E!==void 0){if(E)continue;_=!1;break}if(N){if(!t(l,function(T,O){if(!r(N,O)&&(k===T||d(k,T,c,u,f)))return N.push(O)})){_=!1;break}}else if(!(k===j||d(k,j,c,u,f))){_=!1;break}}return f.delete(i),f.delete(l),_}return Q4=s,Q4}var J4,R7;function zCe(){if(R7)return J4;R7=1;var e=Hl(),t=e.Uint8Array;return J4=t,J4}var Z4,P7;function BCe(){if(P7)return Z4;P7=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,s){n[++r]=[s,a]}),n}return Z4=e,Z4}var X4,z7;function hz(){if(z7)return X4;z7=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return X4=e,X4}var e3,B7;function $Ce(){if(B7)return e3;B7=1;var e=Hx(),t=zCe(),r=tz(),n=Aie(),a=BCe(),s=hz(),i=1,l=2,c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Map]",m="[object Number]",p="[object RegExp]",v="[object Set]",b="[object String]",y="[object Symbol]",S="[object ArrayBuffer]",_="[object DataView]",N=e?e.prototype:void 0,k=N?N.valueOf:void 0;function j(E,T,O,R,H,$,L){switch(O){case _:if(E.byteLength!=T.byteLength||E.byteOffset!=T.byteOffset)return!1;E=E.buffer,T=T.buffer;case S:return!(E.byteLength!=T.byteLength||!$(new t(E),new t(T)));case c:case u:case m:return r(+E,+T);case d:return E.name==T.name&&E.message==T.message;case p:case b:return E==T+"";case f:var A=a;case v:var M=R&i;if(A||(A=s),E.size!=T.size&&!M)return!1;var P=L.get(E);if(P)return P==T;R|=l,L.set(E,T);var I=n(A(E),A(T),R,H,$,L);return L.delete(E),I;case y:if(k)return k.call(E)==k.call(T)}return!1}return e3=j,e3}var t3,$7;function Die(){if($7)return t3;$7=1;function e(t,r){for(var n=-1,a=r.length,s=t.length;++n<a;)t[s+n]=r[n];return t}return t3=e,t3}var r3,F7;function FCe(){if(F7)return r3;F7=1;var e=Die(),t=li();function r(n,a,s){var i=a(n);return t(n)?i:e(i,s(n))}return r3=r,r3}var n3,U7;function UCe(){if(U7)return n3;U7=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,s=0,i=[];++n<a;){var l=t[n];r(l,n,t)&&(i[s++]=l)}return i}return n3=e,n3}var a3,H7;function HCe(){if(H7)return a3;H7=1;function e(){return[]}return a3=e,a3}var s3,q7;function qCe(){if(q7)return s3;q7=1;var e=UCe(),t=HCe(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(i){return i==null?[]:(i=Object(i),e(a(i),function(l){return n.call(i,l)}))}:t;return s3=s,s3}var i3,W7;function WCe(){if(W7)return i3;W7=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return i3=e,i3}var o3,K7;function KCe(){if(K7)return o3;K7=1;var e=fu(),t=hu(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return o3=n,o3}var l3,G7;function mz(){if(G7)return l3;G7=1;var e=KCe(),t=hu(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,s=e((function(){return arguments})())?e:function(i){return t(i)&&n.call(i,"callee")&&!a.call(i,"callee")};return l3=s,l3}var cb={exports:{}},c3,V7;function GCe(){if(V7)return c3;V7=1;function e(){return!1}return c3=e,c3}cb.exports;var Y7;function Lie(){return Y7||(Y7=1,(function(e,t){var r=Hl(),n=GCe(),a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,l=i?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u})(cb,cb.exports)),cb.exports}var u3,Q7;function pz(){if(Q7)return u3;Q7=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var s=typeof n;return a=a??e,!!a&&(s=="number"||s!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return u3=r,u3}var d3,J7;function gz(){if(J7)return d3;J7=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return d3=t,d3}var f3,Z7;function VCe(){if(Z7)return f3;Z7=1;var e=fu(),t=gz(),r=hu(),n="[object Arguments]",a="[object Array]",s="[object Boolean]",i="[object Date]",l="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",f="[object Object]",m="[object RegExp]",p="[object Set]",v="[object String]",b="[object WeakMap]",y="[object ArrayBuffer]",S="[object DataView]",_="[object Float32Array]",N="[object Float64Array]",k="[object Int8Array]",j="[object Int16Array]",E="[object Int32Array]",T="[object Uint8Array]",O="[object Uint8ClampedArray]",R="[object Uint16Array]",H="[object Uint32Array]",$={};$[_]=$[N]=$[k]=$[j]=$[E]=$[T]=$[O]=$[R]=$[H]=!0,$[n]=$[a]=$[y]=$[s]=$[S]=$[i]=$[l]=$[c]=$[u]=$[d]=$[f]=$[m]=$[p]=$[v]=$[b]=!1;function L(A){return r(A)&&t(A.length)&&!!$[e(A)]}return f3=L,f3}var h3,X7;function Oie(){if(X7)return h3;X7=1;function e(t){return function(r){return t(r)}}return h3=e,h3}var ub={exports:{}};ub.exports;var eW;function YCe(){return eW||(eW=1,(function(e,t){var r=eie(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,i=s&&r.process,l=(function(){try{var c=a&&a.require&&a.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}})();e.exports=l})(ub,ub.exports)),ub.exports}var m3,tW;function Iie(){if(tW)return m3;tW=1;var e=VCe(),t=Oie(),r=YCe(),n=r&&r.isTypedArray,a=n?t(n):e;return m3=a,m3}var p3,rW;function QCe(){if(rW)return p3;rW=1;var e=WCe(),t=mz(),r=li(),n=Lie(),a=pz(),s=Iie(),i=Object.prototype,l=i.hasOwnProperty;function c(u,d){var f=r(u),m=!f&&t(u),p=!f&&!m&&n(u),v=!f&&!m&&!p&&s(u),b=f||m||p||v,y=b?e(u.length,String):[],S=y.length;for(var _ in u)(d||l.call(u,_))&&!(b&&(_=="length"||p&&(_=="offset"||_=="parent")||v&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||a(_,S)))&&y.push(_);return y}return p3=c,p3}var g3,nW;function JCe(){if(nW)return g3;nW=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return g3=t,g3}var v3,aW;function Rie(){if(aW)return v3;aW=1;function e(t,r){return function(n){return t(r(n))}}return v3=e,v3}var b3,sW;function ZCe(){if(sW)return b3;sW=1;var e=Rie(),t=e(Object.keys,Object);return b3=t,b3}var y3,iW;function XCe(){if(iW)return y3;iW=1;var e=JCe(),t=ZCe(),r=Object.prototype,n=r.hasOwnProperty;function a(s){if(!e(s))return t(s);var i=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&i.push(l);return i}return y3=a,y3}var x3,oW;function Wx(){if(oW)return x3;oW=1;var e=ez(),t=gz();function r(n){return n!=null&&t(n.length)&&!e(n)}return x3=r,x3}var w3,lW;function xj(){if(lW)return w3;lW=1;var e=QCe(),t=XCe(),r=Wx();function n(a){return r(a)?e(a):t(a)}return w3=n,w3}var S3,cW;function eje(){if(cW)return S3;cW=1;var e=FCe(),t=qCe(),r=xj();function n(a){return e(a,r,t)}return S3=n,S3}var k3,uW;function tje(){if(uW)return k3;uW=1;var e=eje(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(s,i,l,c,u,d){var f=l&t,m=e(s),p=m.length,v=e(i),b=v.length;if(p!=b&&!f)return!1;for(var y=p;y--;){var S=m[y];if(!(f?S in i:n.call(i,S)))return!1}var _=d.get(s),N=d.get(i);if(_&&N)return _==i&&N==s;var k=!0;d.set(s,i),d.set(i,s);for(var j=f;++y<p;){S=m[y];var E=s[S],T=i[S];if(c)var O=f?c(T,E,S,i,s,d):c(E,T,S,s,i,d);if(!(O===void 0?E===T||u(E,T,l,c,d):O)){k=!1;break}j||(j=S=="constructor")}if(k&&!j){var R=s.constructor,H=i.constructor;R!=H&&"constructor"in s&&"constructor"in i&&!(typeof R=="function"&&R instanceof R&&typeof H=="function"&&H instanceof H)&&(k=!1)}return d.delete(s),d.delete(i),k}return k3=a,k3}var _3,dW;function rje(){if(dW)return _3;dW=1;var e=Wh(),t=Hl(),r=e(t,"DataView");return _3=r,_3}var N3,fW;function nje(){if(fW)return N3;fW=1;var e=Wh(),t=Hl(),r=e(t,"Promise");return N3=r,N3}var C3,hW;function Pie(){if(hW)return C3;hW=1;var e=Wh(),t=Hl(),r=e(t,"Set");return C3=r,C3}var j3,mW;function aje(){if(mW)return j3;mW=1;var e=Wh(),t=Hl(),r=e(t,"WeakMap");return j3=r,j3}var E3,pW;function sje(){if(pW)return E3;pW=1;var e=rje(),t=rz(),r=nje(),n=Pie(),a=aje(),s=fu(),i=tie(),l="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",f="[object WeakMap]",m="[object DataView]",p=i(e),v=i(t),b=i(r),y=i(n),S=i(a),_=s;return(e&&_(new e(new ArrayBuffer(1)))!=m||t&&_(new t)!=l||r&&_(r.resolve())!=u||n&&_(new n)!=d||a&&_(new a)!=f)&&(_=function(N){var k=s(N),j=k==c?N.constructor:void 0,E=j?i(j):"";if(E)switch(E){case p:return m;case v:return l;case b:return u;case y:return d;case S:return f}return k}),E3=_,E3}var M3,gW;function ije(){if(gW)return M3;gW=1;var e=jie(),t=Aie(),r=$Ce(),n=tje(),a=sje(),s=li(),i=Lie(),l=Iie(),c=1,u="[object Arguments]",d="[object Array]",f="[object Object]",m=Object.prototype,p=m.hasOwnProperty;function v(b,y,S,_,N,k){var j=s(b),E=s(y),T=j?d:a(b),O=E?d:a(y);T=T==u?f:T,O=O==u?f:O;var R=T==f,H=O==f,$=T==O;if($&&i(b)){if(!i(y))return!1;j=!0,R=!1}if($&&!R)return k||(k=new e),j||l(b)?t(b,y,S,_,N,k):r(b,y,T,S,_,N,k);if(!(S&c)){var L=R&&p.call(b,"__wrapped__"),A=H&&p.call(y,"__wrapped__");if(L||A){var M=L?b.value():b,P=A?y.value():y;return k||(k=new e),N(M,P,S,_,k)}}return $?(k||(k=new e),n(b,y,S,_,N,k)):!1}return M3=v,M3}var T3,vW;function vz(){if(vW)return T3;vW=1;var e=ije(),t=hu();function r(n,a,s,i,l){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,s,i,r,l)}return T3=r,T3}var A3,bW;function oje(){if(bW)return A3;bW=1;var e=jie(),t=vz(),r=1,n=2;function a(s,i,l,c){var u=l.length,d=u,f=!c;if(s==null)return!d;for(s=Object(s);u--;){var m=l[u];if(f&&m[2]?m[1]!==s[m[0]]:!(m[0]in s))return!1}for(;++u<d;){m=l[u];var p=m[0],v=s[p],b=m[1];if(f&&m[2]){if(v===void 0&&!(p in s))return!1}else{var y=new e;if(c)var S=c(v,b,p,s,i,y);if(!(S===void 0?t(b,v,r|n,c,y):S))return!1}}return!0}return A3=a,A3}var D3,yW;function zie(){if(yW)return D3;yW=1;var e=$d();function t(r){return r===r&&!e(r)}return D3=t,D3}var L3,xW;function lje(){if(xW)return L3;xW=1;var e=zie(),t=xj();function r(n){for(var a=t(n),s=a.length;s--;){var i=a[s],l=n[i];a[s]=[i,l,e(l)]}return a}return L3=r,L3}var O3,wW;function Bie(){if(wW)return O3;wW=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return O3=e,O3}var I3,SW;function cje(){if(SW)return I3;SW=1;var e=oje(),t=lje(),r=Bie();function n(a){var s=t(a);return s.length==1&&s[0][2]?r(s[0][0],s[0][1]):function(i){return i===a||e(i,a,s)}}return I3=n,I3}var R3,kW;function uje(){if(kW)return R3;kW=1;function e(t,r){return t!=null&&r in Object(t)}return R3=e,R3}var P3,_W;function dje(){if(_W)return P3;_W=1;var e=aie(),t=mz(),r=li(),n=pz(),a=gz(),s=pj();function i(l,c,u){c=e(c,l);for(var d=-1,f=c.length,m=!1;++d<f;){var p=s(c[d]);if(!(m=l!=null&&u(l,p)))break;l=l[p]}return m||++d!=f?m:(f=l==null?0:l.length,!!f&&a(f)&&n(p,f)&&(r(l)||t(l)))}return P3=i,P3}var z3,NW;function fje(){if(NW)return z3;NW=1;var e=uje(),t=dje();function r(n,a){return n!=null&&t(n,a,e)}return z3=r,z3}var B3,CW;function hje(){if(CW)return B3;CW=1;var e=vz(),t=sie(),r=fje(),n=X6(),a=zie(),s=Bie(),i=pj(),l=1,c=2;function u(d,f){return n(d)&&a(f)?s(i(d),f):function(m){var p=t(m,d);return p===void 0&&p===f?r(m,d):e(f,p,l|c)}}return B3=u,B3}var $3,jW;function c0(){if(jW)return $3;jW=1;function e(t){return t}return $3=e,$3}var F3,EW;function mje(){if(EW)return F3;EW=1;function e(t){return function(r){return r?.[t]}}return F3=e,F3}var U3,MW;function pje(){if(MW)return U3;MW=1;var e=sz();function t(r){return function(n){return e(n,r)}}return U3=t,U3}var H3,TW;function gje(){if(TW)return H3;TW=1;var e=mje(),t=pje(),r=X6(),n=pj();function a(s){return r(s)?e(n(s)):t(s)}return H3=a,H3}var q3,AW;function ql(){if(AW)return q3;AW=1;var e=cje(),t=hje(),r=c0(),n=li(),a=gje();function s(i){return typeof i=="function"?i:i==null?r:typeof i=="object"?n(i)?t(i[0],i[1]):e(i):a(i)}return q3=s,q3}var W3,DW;function $ie(){if(DW)return W3;DW=1;function e(t,r,n,a){for(var s=t.length,i=n+(a?1:-1);a?i--:++i<s;)if(r(t[i],i,t))return i;return-1}return W3=e,W3}var K3,LW;function vje(){if(LW)return K3;LW=1;function e(t){return t!==t}return K3=e,K3}var G3,OW;function bje(){if(OW)return G3;OW=1;function e(t,r,n){for(var a=n-1,s=t.length;++a<s;)if(t[a]===r)return a;return-1}return G3=e,G3}var V3,IW;function yje(){if(IW)return V3;IW=1;var e=$ie(),t=vje(),r=bje();function n(a,s,i){return s===s?r(a,s,i):e(a,t,i)}return V3=n,V3}var Y3,RW;function xje(){if(RW)return Y3;RW=1;var e=yje();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return Y3=t,Y3}var Q3,PW;function wje(){if(PW)return Q3;PW=1;function e(t,r,n){for(var a=-1,s=t==null?0:t.length;++a<s;)if(n(r,t[a]))return!0;return!1}return Q3=e,Q3}var J3,zW;function Sje(){if(zW)return J3;zW=1;function e(){}return J3=e,J3}var Z3,BW;function kje(){if(BW)return Z3;BW=1;var e=Pie(),t=Sje(),r=hz(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(s){return new e(s)}:t;return Z3=a,Z3}var X3,$W;function _je(){if($W)return X3;$W=1;var e=Eie(),t=xje(),r=wje(),n=Tie(),a=kje(),s=hz(),i=200;function l(c,u,d){var f=-1,m=t,p=c.length,v=!0,b=[],y=b;if(d)v=!1,m=r;else if(p>=i){var S=u?null:a(c);if(S)return s(S);v=!1,m=n,y=new e}else y=u?[]:b;e:for(;++f<p;){var _=c[f],N=u?u(_):_;if(_=d||_!==0?_:0,v&&N===N){for(var k=y.length;k--;)if(y[k]===N)continue e;u&&y.push(N),b.push(_)}else m(y,N,d)||(y!==b&&y.push(N),b.push(_))}return b}return X3=l,X3}var eA,FW;function Nje(){if(FW)return eA;FW=1;var e=ql(),t=_je();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return eA=r,eA}var Cje=Nje();const UW=Ur(Cje);function Fie(e,t,r){return t===!0?UW(e,r):er(t)?UW(e,t):e}function Xp(e){"@babel/helpers - typeof";return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(e)}var jje=["ref"];function HW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HW(Object(r),!0).forEach(function(n){wj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hie(n.key),n)}}function Mje(e,t,r){return t&&qW(e.prototype,t),r&&qW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tje(e,t,r){return t=f_(t),Aje(e,Uie()?Reflect.construct(t,r||[],f_(e).constructor):t.apply(e,r))}function Aje(e,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dje(e)}function Dje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Uie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uie=function(){return!!e})()}function f_(e){return f_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},f_(e)}function Lje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eI(e,t)}function eI(e,t){return eI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},eI(e,t)}function wj(e,t,r){return t=Hie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hie(e){var t=Oje(e,"string");return Xp(t)=="symbol"?t:t+""}function Oje(e,t){if(Xp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Ije(e,t){if(e==null)return{};var r=Rje(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Rje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Pje(e){return e.value}function zje(e,t){if(ce.isValidElement(e))return ce.cloneElement(e,t);if(typeof e=="function")return ce.createElement(e,t);t.ref;var r=Ije(t,jje);return ce.createElement(fz,r)}var WW=1,Ip=(function(e){function t(){var r;Eje(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Tje(this,t,[].concat(a)),wj(r,"lastBoundingBox",{width:-1,height:-1}),r}return Lje(t,e),Mje(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>WW||Math.abs(a.height-this.lastBoundingBox.height)>WW)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?pc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,s=a.layout,i=a.align,l=a.verticalAlign,c=a.margin,u=a.chartWidth,d=a.chartHeight,f,m;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(i==="center"&&s==="vertical"){var p=this.getBBoxSnapshot();f={left:((u||0)-p.width)/2}}else f=i==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();m={top:((d||0)-v.height)/2}}else m=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return pc(pc({},f),m)}},{key:"render",value:function(){var n=this,a=this.props,s=a.content,i=a.width,l=a.height,c=a.wrapperStyle,u=a.payloadUniqBy,d=a.payload,f=pc(pc({position:"absolute",width:i||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return ce.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(p){n.wrapperNode=p}},zje(s,pc(pc({},this.props),{},{payload:Fie(d,u,Pje)})))}}],[{key:"getWithHeight",value:function(n,a){var s=pc(pc({},this.defaultProps),n.props),i=s.layout;return i==="vertical"&&tt(n.props.height)?{height:n.props.height}:i==="horizontal"?{width:n.props.width||a}:null}}])})(w.PureComponent);wj(Ip,"displayName","Legend");wj(Ip,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var tA,KW;function Bje(){if(KW)return tA;KW=1;var e=Hx(),t=mz(),r=li(),n=e?e.isConcatSpreadable:void 0;function a(s){return r(s)||t(s)||!!(n&&s&&s[n])}return tA=a,tA}var rA,GW;function qie(){if(GW)return rA;GW=1;var e=Die(),t=Bje();function r(n,a,s,i,l){var c=-1,u=n.length;for(s||(s=t),l||(l=[]);++c<u;){var d=n[c];a>0&&s(d)?a>1?r(d,a-1,s,i,l):e(l,d):i||(l[l.length]=d)}return l}return rA=r,rA}var nA,VW;function $je(){if(VW)return nA;VW=1;function e(t){return function(r,n,a){for(var s=-1,i=Object(r),l=a(r),c=l.length;c--;){var u=l[t?c:++s];if(n(i[u],u,i)===!1)break}return r}}return nA=e,nA}var aA,YW;function Fje(){if(YW)return aA;YW=1;var e=$je(),t=e();return aA=t,aA}var sA,QW;function Wie(){if(QW)return sA;QW=1;var e=Fje(),t=xj();function r(n,a){return n&&e(n,a,t)}return sA=r,sA}var iA,JW;function Uje(){if(JW)return iA;JW=1;var e=Wx();function t(r,n){return function(a,s){if(a==null)return a;if(!e(a))return r(a,s);for(var i=a.length,l=n?i:-1,c=Object(a);(n?l--:++l<i)&&s(c[l],l,c)!==!1;);return a}}return iA=t,iA}var oA,ZW;function bz(){if(ZW)return oA;ZW=1;var e=Wie(),t=Uje(),r=t(e);return oA=r,oA}var lA,XW;function Kie(){if(XW)return lA;XW=1;var e=bz(),t=Wx();function r(n,a){var s=-1,i=t(n)?Array(n.length):[];return e(n,function(l,c,u){i[++s]=a(l,c,u)}),i}return lA=r,lA}var cA,eK;function Hje(){if(eK)return cA;eK=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return cA=e,cA}var uA,tK;function qje(){if(tK)return uA;tK=1;var e=i0();function t(r,n){if(r!==n){var a=r!==void 0,s=r===null,i=r===r,l=e(r),c=n!==void 0,u=n===null,d=n===n,f=e(n);if(!u&&!f&&!l&&r>n||l&&c&&d&&!u&&!f||s&&c&&d||!a&&d||!i)return 1;if(!s&&!l&&!f&&r<n||f&&a&&i&&!s&&!l||u&&a&&i||!c&&i||!d)return-1}return 0}return uA=t,uA}var dA,rK;function Wje(){if(rK)return dA;rK=1;var e=qje();function t(r,n,a){for(var s=-1,i=r.criteria,l=n.criteria,c=i.length,u=a.length;++s<c;){var d=e(i[s],l[s]);if(d){if(s>=u)return d;var f=a[s];return d*(f=="desc"?-1:1)}}return r.index-n.index}return dA=t,dA}var fA,nK;function Kje(){if(nK)return fA;nK=1;var e=az(),t=sz(),r=ql(),n=Kie(),a=Hje(),s=Oie(),i=Wje(),l=c0(),c=li();function u(d,f,m){f.length?f=e(f,function(b){return c(b)?function(y){return t(y,b.length===1?b[0]:b)}:b}):f=[l];var p=-1;f=e(f,s(r));var v=n(d,function(b,y,S){var _=e(f,function(N){return N(b)});return{criteria:_,index:++p,value:b}});return a(v,function(b,y){return i(b,y,m)})}return fA=u,fA}var hA,aK;function Gje(){if(aK)return hA;aK=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return hA=e,hA}var mA,sK;function Vje(){if(sK)return mA;sK=1;var e=Gje(),t=Math.max;function r(n,a,s){return a=t(a===void 0?n.length-1:a,0),function(){for(var i=arguments,l=-1,c=t(i.length-a,0),u=Array(c);++l<c;)u[l]=i[a+l];l=-1;for(var d=Array(a+1);++l<a;)d[l]=i[l];return d[a]=s(u),e(n,this,d)}}return mA=r,mA}var pA,iK;function Yje(){if(iK)return pA;iK=1;function e(t){return function(){return t}}return pA=e,pA}var gA,oK;function Gie(){if(oK)return gA;oK=1;var e=Wh(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return gA=t,gA}var vA,lK;function Qje(){if(lK)return vA;lK=1;var e=Yje(),t=Gie(),r=c0(),n=t?function(a,s){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(s),writable:!0})}:r;return vA=n,vA}var bA,cK;function Jje(){if(cK)return bA;cK=1;var e=800,t=16,r=Date.now;function n(a){var s=0,i=0;return function(){var l=r(),c=t-(l-i);if(i=l,c>0){if(++s>=e)return arguments[0]}else s=0;return a.apply(void 0,arguments)}}return bA=n,bA}var yA,uK;function Zje(){if(uK)return yA;uK=1;var e=Qje(),t=Jje(),r=t(e);return yA=r,yA}var xA,dK;function Xje(){if(dK)return xA;dK=1;var e=c0(),t=Vje(),r=Zje();function n(a,s){return r(t(a,s,e),a+"")}return xA=n,xA}var wA,fK;function Sj(){if(fK)return wA;fK=1;var e=tz(),t=Wx(),r=pz(),n=$d();function a(s,i,l){if(!n(l))return!1;var c=typeof i;return(c=="number"?t(l)&&r(i,l.length):c=="string"&&i in l)?e(l[i],s):!1}return wA=a,wA}var SA,hK;function e2e(){if(hK)return SA;hK=1;var e=qie(),t=Kje(),r=Xje(),n=Sj(),a=r(function(s,i){if(s==null)return[];var l=i.length;return l>1&&n(s,i[0],i[1])?i=[]:l>2&&n(i[0],i[1],i[2])&&(i=[i[0]]),t(s,e(i,1),[])});return SA=a,SA}var t2e=e2e();const yz=Ur(t2e);function dy(e){"@babel/helpers - typeof";return dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dy(e)}function tI(){return tI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tI.apply(this,arguments)}function r2e(e,t){return i2e(e)||s2e(e,t)||a2e(e,t)||n2e()}function n2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a2e(e,t){if(e){if(typeof e=="string")return mK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mK(e,t)}}function mK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function i2e(e){if(Array.isArray(e))return e}function pK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pK(Object(r),!0).forEach(function(n){o2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o2e(e,t,r){return t=l2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l2e(e){var t=c2e(e,"string");return dy(t)=="symbol"?t:t+""}function c2e(e,t){if(dy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(dy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u2e(e){return Array.isArray(e)&&ja(e[0])&&ja(e[1])?e.join(" ~ "):e}var d2e=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,s=a===void 0?{}:a,i=t.itemStyle,l=i===void 0?{}:i,c=t.labelStyle,u=c===void 0?{}:c,d=t.payload,f=t.formatter,m=t.itemSorter,p=t.wrapperClassName,v=t.labelClassName,b=t.label,y=t.labelFormatter,S=t.accessibilityLayer,_=S===void 0?!1:S,N=function(){if(d&&d.length){var L={padding:0,margin:0},A=(m?yz(d,m):d).map(function(M,P){if(M.type==="none")return null;var I=kA({display:"block",paddingTop:4,paddingBottom:4,color:M.color||"#000"},l),B=M.formatter||f||u2e,F=M.value,q=M.name,Q=F,W=q;if(B&&Q!=null&&W!=null){var G=B(F,q,M,P,d);if(Array.isArray(G)){var J=r2e(G,2);Q=J[0],W=J[1]}else Q=G}return ce.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(P),style:I},ja(W)?ce.createElement("span",{className:"recharts-tooltip-item-name"},W):null,ja(W)?ce.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,ce.createElement("span",{className:"recharts-tooltip-item-value"},Q),ce.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return ce.createElement("ul",{className:"recharts-tooltip-item-list",style:L},A)}return null},k=kA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),j=kA({margin:0},u),E=!rr(b),T=E?b:"",O=ur("recharts-default-tooltip",p),R=ur("recharts-tooltip-label",v);E&&y&&d!==void 0&&d!==null&&(T=y(b,d));var H=_?{role:"status","aria-live":"assertive"}:{};return ce.createElement("div",tI({className:O,style:k},H),ce.createElement("p",{className:R,style:j},ce.isValidElement(T)?T:"".concat(T)),N())};function fy(e){"@babel/helpers - typeof";return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fy(e)}function Jw(e,t,r){return t=f2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f2e(e){var t=h2e(e,"string");return fy(t)=="symbol"?t:t+""}function h2e(e,t){if(fy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bv="recharts-tooltip-wrapper",m2e={visibility:"hidden"};function p2e(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ur(bv,Jw(Jw(Jw(Jw({},"".concat(bv,"-right"),tt(r)&&t&&tt(t.x)&&r>=t.x),"".concat(bv,"-left"),tt(r)&&t&&tt(t.x)&&r<t.x),"".concat(bv,"-bottom"),tt(n)&&t&&tt(t.y)&&n>=t.y),"".concat(bv,"-top"),tt(n)&&t&&tt(t.y)&&n<t.y))}function gK(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,s=e.position,i=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(s&&tt(s[n]))return s[n];var d=r[n]-l-a,f=r[n]+a;if(t[n])return i[n]?d:f;if(i[n]){var m=d,p=c[n];return m<p?Math.max(f,c[n]):Math.max(d,c[n])}var v=f+l,b=c[n]+u;return v>b?Math.max(d,c[n]):Math.max(f,c[n])}function g2e(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function v2e(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,s=e.reverseDirection,i=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,u,d,f;return i.height>0&&i.width>0&&r?(d=gK({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=gK({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:s,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),u=g2e({translateX:d,translateY:f,useTranslate3d:l})):u=m2e,{cssProperties:u,cssClasses:p2e({translateX:d,translateY:f,coordinate:r})}}function eg(e){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(e)}function vK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vK(Object(r),!0).forEach(function(n){nI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yie(n.key),n)}}function x2e(e,t,r){return t&&y2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function w2e(e,t,r){return t=h_(t),S2e(e,Vie()?Reflect.construct(t,r||[],h_(e).constructor):t.apply(e,r))}function S2e(e,t){if(t&&(eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k2e(e)}function k2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vie=function(){return!!e})()}function h_(e){return h_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},h_(e)}function _2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rI(e,t)}function rI(e,t){return rI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rI(e,t)}function nI(e,t,r){return t=Yie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yie(e){var t=N2e(e,"string");return eg(t)=="symbol"?t:t+""}function N2e(e,t){if(eg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(eg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yK=1,C2e=(function(e){function t(){var r;b2e(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=w2e(this,t,[].concat(a)),nI(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),nI(r,"handleKeyDown",function(i){if(i.key==="Escape"){var l,c,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return _2e(t,e),x2e(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>yK||Math.abs(n.height-this.state.lastBoundingBox.height)>yK)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,s=a.active,i=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.children,d=a.coordinate,f=a.hasPayload,m=a.isAnimationActive,p=a.offset,v=a.position,b=a.reverseDirection,y=a.useTranslate3d,S=a.viewBox,_=a.wrapperStyle,N=v2e({allowEscapeViewBox:i,coordinate:d,offsetTopLeft:p,position:v,reverseDirection:b,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:S}),k=N.cssClasses,j=N.cssProperties,E=bK(bK({transition:m&&s?"transform ".concat(l,"ms ").concat(c):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&f?"visible":"hidden",position:"absolute",top:0,left:0},_);return ce.createElement("div",{tabIndex:-1,className:k,style:E,ref:function(O){n.wrapperNode=O}},u)}}])})(w.PureComponent),j2e=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Kh={isSsr:j2e()};function tg(e){"@babel/helpers - typeof";return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tg(e)}function xK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xK(Object(r),!0).forEach(function(n){xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function E2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jie(n.key),n)}}function T2e(e,t,r){return t&&M2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function A2e(e,t,r){return t=m_(t),D2e(e,Qie()?Reflect.construct(t,r||[],m_(e).constructor):t.apply(e,r))}function D2e(e,t){if(t&&(tg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L2e(e)}function L2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qie(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Qie=function(){return!!e})()}function m_(e){return m_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m_(e)}function O2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aI(e,t)}function aI(e,t){return aI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},aI(e,t)}function xz(e,t,r){return t=Jie(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jie(e){var t=I2e(e,"string");return tg(t)=="symbol"?t:t+""}function I2e(e,t){if(tg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function R2e(e){return e.dataKey}function P2e(e,t){return ce.isValidElement(e)?ce.cloneElement(e,t):typeof e=="function"?ce.createElement(e,t):ce.createElement(d2e,t)}var Ci=(function(e){function t(){return E2e(this,t),A2e(this,t,arguments)}return O2e(t,e),T2e(t,[{key:"render",value:function(){var n=this,a=this.props,s=a.active,i=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,u=a.content,d=a.coordinate,f=a.filterNull,m=a.isAnimationActive,p=a.offset,v=a.payload,b=a.payloadUniqBy,y=a.position,S=a.reverseDirection,_=a.useTranslate3d,N=a.viewBox,k=a.wrapperStyle,j=v??[];f&&j.length&&(j=Fie(v.filter(function(T){return T.value!=null&&(T.hide!==!0||n.props.includeHidden)}),b,R2e));var E=j.length>0;return ce.createElement(C2e,{allowEscapeViewBox:i,animationDuration:l,animationEasing:c,isAnimationActive:m,active:s,coordinate:d,hasPayload:E,offset:p,position:y,reverseDirection:S,useTranslate3d:_,viewBox:N,wrapperStyle:k},P2e(u,wK(wK({},this.props),{},{payload:j})))}}])})(w.PureComponent);xz(Ci,"displayName","Tooltip");xz(Ci,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Kh.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var _A,SK;function z2e(){if(SK)return _A;SK=1;var e=Hl(),t=function(){return e.Date.now()};return _A=t,_A}var NA,kK;function B2e(){if(kK)return NA;kK=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return NA=t,NA}var CA,_K;function $2e(){if(_K)return CA;_K=1;var e=B2e(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return CA=r,CA}var jA,NK;function Zie(){if(NK)return jA;NK=1;var e=$2e(),t=$d(),r=i0(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,i=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var f=s.test(u);return f||i.test(u)?l(u.slice(2),f?2:8):a.test(u)?n:+u}return jA=c,jA}var EA,CK;function F2e(){if(CK)return EA;CK=1;var e=$d(),t=z2e(),r=Zie(),n="Expected a function",a=Math.max,s=Math.min;function i(l,c,u){var d,f,m,p,v,b,y=0,S=!1,_=!1,N=!0;if(typeof l!="function")throw new TypeError(n);c=r(c)||0,e(u)&&(S=!!u.leading,_="maxWait"in u,m=_?a(r(u.maxWait)||0,c):m,N="trailing"in u?!!u.trailing:N);function k(A){var M=d,P=f;return d=f=void 0,y=A,p=l.apply(P,M),p}function j(A){return y=A,v=setTimeout(O,c),S?k(A):p}function E(A){var M=A-b,P=A-y,I=c-M;return _?s(I,m-P):I}function T(A){var M=A-b,P=A-y;return b===void 0||M>=c||M<0||_&&P>=m}function O(){var A=t();if(T(A))return R(A);v=setTimeout(O,E(A))}function R(A){return v=void 0,N&&d?k(A):(d=f=void 0,p)}function H(){v!==void 0&&clearTimeout(v),y=0,d=b=f=v=void 0}function $(){return v===void 0?p:R(t())}function L(){var A=t(),M=T(A);if(d=arguments,f=this,b=A,M){if(v===void 0)return j(b);if(_)return clearTimeout(v),v=setTimeout(O,c),k(b)}return v===void 0&&(v=setTimeout(O,c)),p}return L.cancel=H,L.flush=$,L}return EA=i,EA}var MA,jK;function U2e(){if(jK)return MA;jK=1;var e=F2e(),t=$d(),r="Expected a function";function n(a,s,i){var l=!0,c=!0;if(typeof a!="function")throw new TypeError(r);return t(i)&&(l="leading"in i?!!i.leading:l,c="trailing"in i?!!i.trailing:c),e(a,s,{leading:l,maxWait:s,trailing:c})}return MA=n,MA}var H2e=U2e();const Xie=Ur(H2e);function hy(e){"@babel/helpers - typeof";return hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(e)}function EK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EK(Object(r),!0).forEach(function(n){q2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q2e(e,t,r){return t=W2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W2e(e){var t=K2e(e,"string");return hy(t)=="symbol"?t:t+""}function K2e(e,t){if(hy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function G2e(e,t){return J2e(e)||Q2e(e,t)||Y2e(e,t)||V2e()}function V2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y2e(e,t){if(e){if(typeof e=="string")return MK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MK(e,t)}}function MK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q2e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function J2e(e){if(Array.isArray(e))return e}var kj=w.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,s=e.width,i=s===void 0?"100%":s,l=e.height,c=l===void 0?"100%":l,u=e.minWidth,d=u===void 0?0:u,f=e.minHeight,m=e.maxHeight,p=e.children,v=e.debounce,b=v===void 0?0:v,y=e.id,S=e.className,_=e.onResize,N=e.style,k=N===void 0?{}:N,j=w.useRef(null),E=w.useRef();E.current=_,w.useImperativeHandle(t,function(){return Object.defineProperty(j.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),j.current},configurable:!0})});var T=w.useState({containerWidth:a.width,containerHeight:a.height}),O=G2e(T,2),R=O[0],H=O[1],$=w.useCallback(function(A,M){H(function(P){var I=Math.round(A),B=Math.round(M);return P.containerWidth===I&&P.containerHeight===B?P:{containerWidth:I,containerHeight:B}})},[]);w.useEffect(function(){var A=function(q){var Q,W=q[0].contentRect,G=W.width,J=W.height;$(G,J),(Q=E.current)===null||Q===void 0||Q.call(E,G,J)};b>0&&(A=Xie(A,b,{trailing:!0,leading:!1}));var M=new ResizeObserver(A),P=j.current.getBoundingClientRect(),I=P.width,B=P.height;return $(I,B),M.observe(j.current),function(){M.disconnect()}},[$,b]);var L=w.useMemo(function(){var A=R.containerWidth,M=R.containerHeight;if(A<0||M<0)return null;Qo(Wf(i)||Wf(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),Qo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var P=Wf(i)?A:i,I=Wf(c)?M:c;r&&r>0&&(P?I=P/r:I&&(P=I*r),m&&I>m&&(I=m)),Qo(P>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,P,I,i,c,d,f,r);var B=!Array.isArray(p)&&Yc(p.type).endsWith("Chart");return ce.Children.map(p,function(F){return ce.isValidElement(F)?w.cloneElement(F,Zw({width:P,height:I},B?{style:Zw({height:"100%",width:"100%",maxHeight:I,maxWidth:P},F.props.style)}:{})):F})},[r,p,c,m,f,d,R,i]);return ce.createElement("div",{id:y?"".concat(y):void 0,className:ur("recharts-responsive-container",S),style:Zw(Zw({},k),{},{width:i,height:c,minWidth:d,minHeight:f,maxHeight:m}),ref:j},L)}),Kx=function(t){return null};Kx.displayName="Cell";function my(e){"@babel/helpers - typeof";return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(e)}function TK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TK(Object(r),!0).forEach(function(n){Z2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z2e(e,t,r){return t=X2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X2e(e){var t=eEe(e,"string");return my(t)=="symbol"?t:t+""}function eEe(e,t){if(my(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(my(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ym={widthCache:{},cacheCount:0},tEe=2e3,rEe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},AK="recharts_measurement_span";function nEe(e){var t=sI({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var jb=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Kh.isSsr)return{width:0,height:0};var n=nEe(r),a=JSON.stringify({text:t,copyStyle:n});if(Ym.widthCache[a])return Ym.widthCache[a];try{var s=document.getElementById(AK);s||(s=document.createElement("span"),s.setAttribute("id",AK),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var i=sI(sI({},rEe),n);Object.assign(s.style,i),s.textContent="".concat(t);var l=s.getBoundingClientRect(),c={width:l.width,height:l.height};return Ym.widthCache[a]=c,++Ym.cacheCount>tEe&&(Ym.cacheCount=0,Ym.widthCache={}),c}catch{return{width:0,height:0}}},aEe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function py(e){"@babel/helpers - typeof";return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function p_(e,t){return lEe(e)||oEe(e,t)||iEe(e,t)||sEe()}function sEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iEe(e,t){if(e){if(typeof e=="string")return DK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DK(e,t)}}function DK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function lEe(e){if(Array.isArray(e))return e}function cEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dEe(n.key),n)}}function uEe(e,t,r){return t&&LK(e.prototype,t),r&&LK(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dEe(e){var t=fEe(e,"string");return py(t)=="symbol"?t:t+""}function fEe(e,t){if(py(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(py(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var OK=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,IK=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,hEe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,mEe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,eoe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},pEe=Object.keys(eoe),kp="NaN";function gEe(e,t){return e*eoe[t]}var Xw=(function(){function e(t,r){cEe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!hEe.test(r)&&(this.num=NaN,this.unit=""),pEe.includes(r)&&(this.num=gEe(t,r),this.unit="px")}return uEe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=mEe.exec(r))!==null&&n!==void 0?n:[],s=p_(a,3),i=s[1],l=s[2];return new e(parseFloat(i),l??"")}}])})();function toe(e){if(e.includes(kp))return kp;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=OK.exec(t))!==null&&r!==void 0?r:[],a=p_(n,4),s=a[1],i=a[2],l=a[3],c=Xw.parse(s??""),u=Xw.parse(l??""),d=i==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return kp;t=t.replace(OK,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,m=(f=IK.exec(t))!==null&&f!==void 0?f:[],p=p_(m,4),v=p[1],b=p[2],y=p[3],S=Xw.parse(v??""),_=Xw.parse(y??""),N=b==="+"?S.add(_):S.subtract(_);if(N.isNaN())return kp;t=t.replace(IK,N.toString())}return t}var RK=/\(([^()]*)\)/;function vEe(e){for(var t=e;t.includes("(");){var r=RK.exec(t),n=p_(r,2),a=n[1];t=t.replace(RK,toe(a))}return t}function bEe(e){var t=e.replace(/\s+/g,"");return t=vEe(t),t=toe(t),t}function yEe(e){try{return bEe(e)}catch{return kp}}function TA(e){var t=yEe(e.slice(5,-1));return t===kp?"":t}var xEe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],wEe=["dx","dy","angle","className","breakAll"];function iI(){return iI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iI.apply(this,arguments)}function PK(e,t){if(e==null)return{};var r=SEe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zK(e,t){return CEe(e)||NEe(e,t)||_Ee(e,t)||kEe()}function kEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ee(e,t){if(e){if(typeof e=="string")return BK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BK(e,t)}}function BK(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function CEe(e){if(Array.isArray(e))return e}var roe=/[ \f\n\r\t\v\u2028\u2029]+/,noe=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var s=[];rr(r)||(n?s=r.toString().split(""):s=r.toString().split(roe));var i=s.map(function(c){return{word:c,width:jb(c,a).width}}),l=n?0:jb("",a).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},jEe=function(t,r,n,a,s){var i=t.maxLines,l=t.children,c=t.style,u=t.breakAll,d=tt(i),f=l,m=function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return P.reduce(function(I,B){var F=B.word,q=B.width,Q=I[I.length-1];if(Q&&(a==null||s||Q.width+q+n<Number(a)))Q.words.push(F),Q.width+=q+n;else{var W={words:[F],width:q};I.push(W)}return I},[])},p=m(r),v=function(P){return P.reduce(function(I,B){return I.width>B.width?I:B})};if(!d)return p;for(var b="",y=function(P){var I=f.slice(0,P),B=noe({breakAll:u,style:c,children:I+b}).wordsWithComputedWidth,F=m(B),q=F.length>i||v(F).width>Number(a);return[q,F]},S=0,_=f.length-1,N=0,k;S<=_&&N<=f.length-1;){var j=Math.floor((S+_)/2),E=j-1,T=y(E),O=zK(T,2),R=O[0],H=O[1],$=y(j),L=zK($,1),A=L[0];if(!R&&!A&&(S=j+1),R&&A&&(_=j-1),!R&&A){k=H;break}N++}return k||p},$K=function(t){var r=rr(t)?[]:t.toString().split(roe);return[{words:r}]},EEe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,s=t.style,i=t.breakAll,l=t.maxLines;if((r||n)&&!Kh.isSsr){var c,u,d=noe({breakAll:i,children:a,style:s});if(d){var f=d.wordsWithComputedWidth,m=d.spaceWidth;c=f,u=m}else return $K(a);return jEe({breakAll:i,children:a,maxLines:l,style:s},c,u,r,n)}return $K(a)},FK="#808080",wh=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,s=a===void 0?0:a,i=t.lineHeight,l=i===void 0?"1em":i,c=t.capHeight,u=c===void 0?"0.71em":c,d=t.scaleToFit,f=d===void 0?!1:d,m=t.textAnchor,p=m===void 0?"start":m,v=t.verticalAnchor,b=v===void 0?"end":v,y=t.fill,S=y===void 0?FK:y,_=PK(t,xEe),N=w.useMemo(function(){return EEe({breakAll:_.breakAll,children:_.children,maxLines:_.maxLines,scaleToFit:f,style:_.style,width:_.width})},[_.breakAll,_.children,_.maxLines,f,_.style,_.width]),k=_.dx,j=_.dy,E=_.angle,T=_.className,O=_.breakAll,R=PK(_,wEe);if(!ja(n)||!ja(s))return null;var H=n+(tt(k)?k:0),$=s+(tt(j)?j:0),L;switch(b){case"start":L=TA("calc(".concat(u,")"));break;case"middle":L=TA("calc(".concat((N.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:L=TA("calc(".concat(N.length-1," * -").concat(l,")"));break}var A=[];if(f){var M=N[0].width,P=_.width;A.push("scale(".concat((tt(P)?P/M:1)/M,")"))}return E&&A.push("rotate(".concat(E,", ").concat(H,", ").concat($,")")),A.length&&(R.transform=A.join(" ")),ce.createElement("text",iI({},Ht(R,!0),{x:H,y:$,className:ur("recharts-text",T),textAnchor:p,fill:S.includes("url")?FK:S}),N.map(function(I,B){var F=I.words.join(O?"":" ");return ce.createElement("tspan",{x:H,dy:B===0?L:l,key:"".concat(F,"-").concat(B)},F)}))};function Nd(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function MEe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wz(e){let t,r,n;e.length!==2?(t=Nd,r=(l,c)=>Nd(e(l),c),n=(l,c)=>e(l)-c):(t=e===Nd||e===MEe?e:TEe,r=e,n=e);function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function i(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:i,right:s}}function TEe(){return 0}function aoe(e){return e===null?NaN:+e}function*AEe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const DEe=wz(Nd),Gx=DEe.right;wz(aoe).center;class UK extends Map{constructor(t,r=IEe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(HK(this,t))}has(t){return super.has(HK(this,t))}set(t,r){return super.set(LEe(this,t),r)}delete(t){return super.delete(OEe(this,t))}}function HK({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function LEe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function OEe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function IEe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function REe(e=Nd){if(e===Nd)return soe;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function soe(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const PEe=Math.sqrt(50),zEe=Math.sqrt(10),BEe=Math.sqrt(2);function g_(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),i=s>=PEe?10:s>=zEe?5:s>=BEe?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/i,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*i,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?g_(e,t,r*2):[l,c,u]}function oI(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,s,i]=n?g_(t,e,r):g_(e,t,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(i<0)for(let u=0;u<l;++u)c[u]=(s-u)/-i;else for(let u=0;u<l;++u)c[u]=(s-u)*i;else if(i<0)for(let u=0;u<l;++u)c[u]=(a+u)/-i;else for(let u=0;u<l;++u)c[u]=(a+u)*i;return c}function lI(e,t,r){return t=+t,e=+e,r=+r,g_(e,t,r)[2]}function cI(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?lI(t,e,r):lI(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function qK(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function WK(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function ioe(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?soe:REe(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+m)),v=Math.min(n,Math.floor(t+(c-u)*f/c+m));ioe(e,t,p,v,a)}const s=e[t];let i=r,l=n;for(yv(e,r,t),a(e[n],s)>0&&yv(e,r,n);i<l;){for(yv(e,i,l),++i,--l;a(e[i],s)<0;)++i;for(;a(e[l],s)>0;)--l}a(e[r],s)===0?yv(e,r,l):(++l,yv(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function yv(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function $Ee(e,t,r){if(e=Float64Array.from(AEe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return WK(e);if(t>=1)return qK(e);var n,a=(n-1)*t,s=Math.floor(a),i=qK(ioe(e,s).subarray(0,s+1)),l=WK(e.subarray(s+1));return i+(l-i)*(a-s)}}function FEe(e,t,r=aoe){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,s=Math.floor(a),i=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return i+(l-i)*(a-s)}}function UEe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(a);++n<a;)s[n]=e+n*r;return s}function Eo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function mu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const uI=Symbol("implicit");function Sz(){var e=new UK,t=[],r=[],n=uI;function a(s){let i=e.get(s);if(i===void 0){if(n!==uI)return n;e.set(s,i=t.push(s)-1)}return r[i%r.length]}return a.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new UK;for(const i of s)e.has(i)||e.set(i,t.push(i)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return Sz(t,r).unknown(n)},Eo.apply(a,arguments),a}function gy(){var e=Sz().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,s,i,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var m=t().length,p=a<n,v=p?a:n,b=p?n:a;s=(b-v)/Math.max(1,m-c+u*2),l&&(s=Math.floor(s)),v+=(b-v-s*(m-c))*d,i=s*(1-c),l&&(v=Math.round(v),i=Math.round(i));var y=UEe(m).map(function(S){return v+s*S});return r(p?y.reverse():y)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return i},e.step=function(){return s},e.round=function(m){return arguments.length?(l=!!m,f()):l},e.padding=function(m){return arguments.length?(c=Math.min(1,u=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(u=+m,f()):u},e.align=function(m){return arguments.length?(d=Math.max(0,Math.min(1,m)),f()):d},e.copy=function(){return gy(t(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Eo.apply(f(),arguments)}function ooe(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return ooe(t())},e}function Eb(){return ooe(gy.apply(null,arguments).paddingInner(1))}function kz(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function loe(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Vx(){}var vy=.7,v_=1/vy,Rp="\\s*([+-]?\\d+)\\s*",by="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",kl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",HEe=/^#([0-9a-f]{3,8})$/,qEe=new RegExp(`^rgb\\(${Rp},${Rp},${Rp}\\)$`),WEe=new RegExp(`^rgb\\(${kl},${kl},${kl}\\)$`),KEe=new RegExp(`^rgba\\(${Rp},${Rp},${Rp},${by}\\)$`),GEe=new RegExp(`^rgba\\(${kl},${kl},${kl},${by}\\)$`),VEe=new RegExp(`^hsl\\(${by},${kl},${kl}\\)$`),YEe=new RegExp(`^hsla\\(${by},${kl},${kl},${by}\\)$`),KK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kz(Vx,Sh,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:GK,formatHex:GK,formatHex8:QEe,formatHsl:JEe,formatRgb:VK,toString:VK});function GK(){return this.rgb().formatHex()}function QEe(){return this.rgb().formatHex8()}function JEe(){return coe(this).formatHsl()}function VK(){return this.rgb().formatRgb()}function Sh(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=HEe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?YK(t):r===3?new ti(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?eS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?eS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qEe.exec(e))?new ti(t[1],t[2],t[3],1):(t=WEe.exec(e))?new ti(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=KEe.exec(e))?eS(t[1],t[2],t[3],t[4]):(t=GEe.exec(e))?eS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=VEe.exec(e))?ZK(t[1],t[2]/100,t[3]/100,1):(t=YEe.exec(e))?ZK(t[1],t[2]/100,t[3]/100,t[4]):KK.hasOwnProperty(e)?YK(KK[e]):e==="transparent"?new ti(NaN,NaN,NaN,0):null}function YK(e){return new ti(e>>16&255,e>>8&255,e&255,1)}function eS(e,t,r,n){return n<=0&&(e=t=r=NaN),new ti(e,t,r,n)}function ZEe(e){return e instanceof Vx||(e=Sh(e)),e?(e=e.rgb(),new ti(e.r,e.g,e.b,e.opacity)):new ti}function dI(e,t,r,n){return arguments.length===1?ZEe(e):new ti(e,t,r,n??1)}function ti(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}kz(ti,dI,loe(Vx,{brighter(e){return e=e==null?v_:Math.pow(v_,e),new ti(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?vy:Math.pow(vy,e),new ti(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ti(th(this.r),th(this.g),th(this.b),b_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:QK,formatHex:QK,formatHex8:XEe,formatRgb:JK,toString:JK}));function QK(){return`#${Kf(this.r)}${Kf(this.g)}${Kf(this.b)}`}function XEe(){return`#${Kf(this.r)}${Kf(this.g)}${Kf(this.b)}${Kf((isNaN(this.opacity)?1:this.opacity)*255)}`}function JK(){const e=b_(this.opacity);return`${e===1?"rgb(":"rgba("}${th(this.r)}, ${th(this.g)}, ${th(this.b)}${e===1?")":`, ${e})`}`}function b_(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function th(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Kf(e){return e=th(e),(e<16?"0":"")+e.toString(16)}function ZK(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ho(e,t,r,n)}function coe(e){if(e instanceof Ho)return new Ho(e.h,e.s,e.l,e.opacity);if(e instanceof Vx||(e=Sh(e)),!e)return new Ho;if(e instanceof Ho)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),s=Math.max(t,r,n),i=NaN,l=s-a,c=(s+a)/2;return l?(t===s?i=(r-n)/l+(r<n)*6:r===s?i=(n-t)/l+2:i=(t-r)/l+4,l/=c<.5?s+a:2-s-a,i*=60):l=c>0&&c<1?0:i,new Ho(i,l,c,e.opacity)}function eMe(e,t,r,n){return arguments.length===1?coe(e):new Ho(e,t,r,n??1)}function Ho(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}kz(Ho,eMe,loe(Vx,{brighter(e){return e=e==null?v_:Math.pow(v_,e),new Ho(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vy:Math.pow(vy,e),new Ho(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ti(AA(e>=240?e-240:e+120,a,n),AA(e,a,n),AA(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ho(XK(this.h),tS(this.s),tS(this.l),b_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=b_(this.opacity);return`${e===1?"hsl(":"hsla("}${XK(this.h)}, ${tS(this.s)*100}%, ${tS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function XK(e){return e=(e||0)%360,e<0?e+360:e}function tS(e){return Math.max(0,Math.min(1,e||0))}function AA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const _z=e=>()=>e;function tMe(e,t){return function(r){return e+r*t}}function rMe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function nMe(e){return(e=+e)==1?uoe:function(t,r){return r-t?rMe(t,r,e):_z(isNaN(t)?r:t)}}function uoe(e,t){var r=t-e;return r?tMe(e,r):_z(isNaN(e)?t:e)}const y_=(function e(t){var r=nMe(t);function n(a,s){var i=r((a=dI(a)).r,(s=dI(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),u=uoe(a.opacity,s.opacity);return function(d){return a.r=i(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n})(1);function aMe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=e[a]*(1-s)+t[a]*s;return n}}function sMe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function iMe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),s=new Array(r),i;for(i=0;i<n;++i)a[i]=Qc(e[i],t[i]);for(;i<r;++i)s[i]=t[i];return function(l){for(i=0;i<n;++i)s[i]=a[i](l);return s}}function oMe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Bo(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function lMe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Qc(e[a],t[a]):n[a]=t[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var fI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,DA=new RegExp(fI.source,"g");function cMe(e){return function(){return e}}function uMe(e){return function(t){return e(t)+""}}function doe(e,t){var r=fI.lastIndex=DA.lastIndex=0,n,a,s,i=-1,l=[],c=[];for(e=e+"",t=t+"";(n=fI.exec(e))&&(a=DA.exec(t));)(s=a.index)>r&&(s=t.slice(r,s),l[i]?l[i]+=s:l[++i]=s),(n=n[0])===(a=a[0])?l[i]?l[i]+=a:l[++i]=a:(l[++i]=null,c.push({i,x:Bo(n,a)})),r=DA.lastIndex;return r<t.length&&(s=t.slice(r),l[i]?l[i]+=s:l[++i]=s),l.length<2?c[0]?uMe(c[0].x):cMe(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function Qc(e,t){var r=typeof t,n;return t==null||r==="boolean"?_z(t):(r==="number"?Bo:r==="string"?(n=Sh(t))?(t=n,y_):doe:t instanceof Sh?y_:t instanceof Date?oMe:sMe(t)?aMe:Array.isArray(t)?iMe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?lMe:Bo)(e,t)}function Nz(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var eG=180/Math.PI,hI={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function foe(e,t,r,n,a,s){var i,l,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),e*n<t*r&&(e=-e,t=-t,c=-c,i=-i),{translateX:a,translateY:s,rotate:Math.atan2(t,e)*eG,skewX:Math.atan(c)*eG,scaleX:i,scaleY:l}}var rS;function dMe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?hI:foe(t.a,t.b,t.c,t.d,t.e,t.f)}function fMe(e){return e==null||(rS||(rS=document.createElementNS("http://www.w3.org/2000/svg","g")),rS.setAttribute("transform",e),!(e=rS.transform.baseVal.consolidate()))?hI:(e=e.matrix,foe(e.a,e.b,e.c,e.d,e.e,e.f))}function hoe(e,t,r,n){function a(u){return u.length?u.pop()+" ":""}function s(u,d,f,m,p,v){if(u!==f||d!==m){var b=p.push("translate(",null,t,null,r);v.push({i:b-4,x:Bo(u,f)},{i:b-2,x:Bo(d,m)})}else(f||m)&&p.push("translate("+f+t+m+r)}function i(u,d,f,m){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),m.push({i:f.push(a(f)+"rotate(",null,n)-2,x:Bo(u,d)})):d&&f.push(a(f)+"rotate("+d+n)}function l(u,d,f,m){u!==d?m.push({i:f.push(a(f)+"skewX(",null,n)-2,x:Bo(u,d)}):d&&f.push(a(f)+"skewX("+d+n)}function c(u,d,f,m,p,v){if(u!==f||d!==m){var b=p.push(a(p)+"scale(",null,",",null,")");v.push({i:b-4,x:Bo(u,f)},{i:b-2,x:Bo(d,m)})}else(f!==1||m!==1)&&p.push(a(p)+"scale("+f+","+m+")")}return function(u,d){var f=[],m=[];return u=e(u),d=e(d),s(u.translateX,u.translateY,d.translateX,d.translateY,f,m),i(u.rotate,d.rotate,f,m),l(u.skewX,d.skewX,f,m),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,m),u=d=null,function(p){for(var v=-1,b=m.length,y;++v<b;)f[(y=m[v]).i]=y.x(p);return f.join("")}}}var hMe=hoe(dMe,"px, ","px)","deg)"),mMe=hoe(fMe,", ",")",")"),pMe=1e-12;function tG(e){return((e=Math.exp(e))+1/e)/2}function gMe(e){return((e=Math.exp(e))-1/e)/2}function vMe(e){return((e=Math.exp(2*e))-1)/(e+1)}const bk=(function e(t,r,n){function a(s,i){var l=s[0],c=s[1],u=s[2],d=i[0],f=i[1],m=i[2],p=d-l,v=f-c,b=p*p+v*v,y,S;if(b<pMe)S=Math.log(m/u)/t,y=function(T){return[l+T*p,c+T*v,u*Math.exp(t*T*S)]};else{var _=Math.sqrt(b),N=(m*m-u*u+n*b)/(2*u*r*_),k=(m*m-u*u-n*b)/(2*m*r*_),j=Math.log(Math.sqrt(N*N+1)-N),E=Math.log(Math.sqrt(k*k+1)-k);S=(E-j)/t,y=function(T){var O=T*S,R=tG(j),H=u/(r*_)*(R*vMe(t*O+j)-gMe(j));return[l+H*p,c+H*v,u*R/tG(t*O+j)]}}return y.duration=S*1e3*t/Math.SQRT2,y}return a.rho=function(s){var i=Math.max(.001,+s),l=i*i,c=l*l;return e(i,l,c)},a})(Math.SQRT2,2,4);function bMe(e,t){t===void 0&&(t=e,e=Qc);for(var r=0,n=t.length-1,a=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(a,a=t[++r]);return function(i){var l=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return s[l](i-l)}}function yMe(e){return function(){return e}}function x_(e){return+e}var rG=[0,1];function Is(e){return e}function mI(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:yMe(isNaN(t)?NaN:.5)}function xMe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function wMe(e,t,r){var n=e[0],a=e[1],s=t[0],i=t[1];return a<n?(n=mI(a,n),s=r(i,s)):(n=mI(n,a),s=r(s,i)),function(l){return s(n(l))}}function SMe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),s=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)a[i]=mI(e[i],e[i+1]),s[i]=r(t[i],t[i+1]);return function(l){var c=Gx(e,l,1,n)-1;return s[c](a[c](l))}}function Yx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function _j(){var e=rG,t=rG,r=Qc,n,a,s,i=Is,l,c,u;function d(){var m=Math.min(e.length,t.length);return i!==Is&&(i=xMe(e[0],e[m-1])),l=m>2?SMe:wMe,c=u=null,f}function f(m){return m==null||isNaN(m=+m)?s:(c||(c=l(e.map(n),t,r)))(n(i(m)))}return f.invert=function(m){return i(a((u||(u=l(t,e.map(n),Bo)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,x_),d()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),d()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=Nz,d()},f.clamp=function(m){return arguments.length?(i=m?!0:Is,d()):i!==Is},f.interpolate=function(m){return arguments.length?(r=m,d()):r},f.unknown=function(m){return arguments.length?(s=m,f):s},function(m,p){return n=m,a=p,d()}}function Cz(){return _j()(Is,Is)}function kMe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function w_(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function rg(e){return e=w_(Math.abs(e)),e?e[1]:NaN}function _Me(e,t){return function(r,n){for(var a=r.length,s=[],i=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[i=(i+1)%e.length];return s.reverse().join(t)}}function NMe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var CMe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function yy(e){if(!(t=CMe.exec(e)))throw new Error("invalid format: "+e);var t;return new jz({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}yy.prototype=jz.prototype;function jz(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}jz.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function jMe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var S_;function EMe(e,t){var r=w_(e,t);if(!r)return S_=void 0,e.toPrecision(t);var n=r[0],a=r[1],s=a-(S_=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=n.length;return s===i?n:s>i?n+new Array(s-i+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+w_(e,Math.max(0,t+s-1))[0]}function nG(e,t){var r=w_(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const aG={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:kMe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>nG(e*100,t),r:nG,s:EMe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function sG(e){return e}var iG=Array.prototype.map,oG=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function MMe(e){var t=e.grouping===void 0||e.thousands===void 0?sG:_Me(iG.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?sG:NMe(iG.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,m){f=yy(f);var p=f.fill,v=f.align,b=f.sign,y=f.symbol,S=f.zero,_=f.width,N=f.comma,k=f.precision,j=f.trim,E=f.type;E==="n"?(N=!0,E="g"):aG[E]||(k===void 0&&(k=12),j=!0,E="g"),(S||p==="0"&&v==="=")&&(S=!0,p="0",v="=");var T=(m&&m.prefix!==void 0?m.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():""),O=(y==="$"?n:/[%p]/.test(E)?i:"")+(m&&m.suffix!==void 0?m.suffix:""),R=aG[E],H=/[defgprs%]/.test(E);k=k===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function $(L){var A=T,M=O,P,I,B;if(E==="c")M=R(L)+M,L="";else{L=+L;var F=L<0||1/L<0;if(L=isNaN(L)?c:R(Math.abs(L),k),j&&(L=jMe(L)),F&&+L==0&&b!=="+"&&(F=!1),A=(F?b==="("?b:l:b==="-"||b==="("?"":b)+A,M=(E==="s"&&!isNaN(L)&&S_!==void 0?oG[8+S_/3]:"")+M+(F&&b==="("?")":""),H){for(P=-1,I=L.length;++P<I;)if(B=L.charCodeAt(P),48>B||B>57){M=(B===46?a+L.slice(P+1):L.slice(P))+M,L=L.slice(0,P);break}}}N&&!S&&(L=t(L,1/0));var q=A.length+L.length+M.length,Q=q<_?new Array(_-q+1).join(p):"";switch(N&&S&&(L=t(Q+L,Q.length?_-M.length:1/0),Q=""),v){case"<":L=A+L+M+Q;break;case"=":L=A+Q+L+M;break;case"^":L=Q.slice(0,q=Q.length>>1)+A+L+M+Q.slice(q);break;default:L=Q+A+L+M;break}return s(L)}return $.toString=function(){return f+""},$}function d(f,m){var p=Math.max(-8,Math.min(8,Math.floor(rg(m)/3)))*3,v=Math.pow(10,-p),b=u((f=yy(f),f.type="f",f),{suffix:oG[8+p/3]});return function(y){return b(v*y)}}return{format:u,formatPrefix:d}}var nS,Ez,moe;TMe({thousands:",",grouping:[3],currency:["$",""]});function TMe(e){return nS=MMe(e),Ez=nS.format,moe=nS.formatPrefix,nS}function AMe(e){return Math.max(0,-rg(Math.abs(e)))}function DMe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rg(t)/3)))*3-rg(Math.abs(e)))}function LMe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,rg(t)-rg(e))+1}function poe(e,t,r,n){var a=cI(e,t,r),s;switch(n=yy(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=DMe(a,i))&&(n.precision=s),moe(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=LMe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=AMe(a))&&(n.precision=s-(n.type==="%")*2);break}}return Ez(n)}function Fd(e){var t=e.domain;return e.ticks=function(r){var n=t();return oI(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return poe(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,s=n.length-1,i=n[a],l=n[s],c,u,d=10;for(l<i&&(u=i,i=l,l=u,u=a,a=s,s=u);d-- >0;){if(u=lI(i,l,r),u===c)return n[a]=i,n[s]=l,t(n);if(u>0)i=Math.floor(i/u)*u,l=Math.ceil(l/u)*u;else if(u<0)i=Math.ceil(i*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function k_(){var e=Cz();return e.copy=function(){return Yx(e,k_())},Eo.apply(e,arguments),Fd(e)}function goe(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,x_),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return goe(e).unknown(t)},e=arguments.length?Array.from(e,x_):[0,1],Fd(r)}function voe(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],s=e[n],i;return s<a&&(i=r,r=n,n=i,i=a,a=s,s=i),e[r]=t.floor(a),e[n]=t.ceil(s),e}function lG(e){return Math.log(e)}function cG(e){return Math.exp(e)}function OMe(e){return-Math.log(-e)}function IMe(e){return-Math.exp(-e)}function RMe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function PMe(e){return e===10?RMe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function zMe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function uG(e){return(t,r)=>-e(-t,r)}function Mz(e){const t=e(lG,cG),r=t.domain;let n=10,a,s;function i(){return a=zMe(n),s=PMe(n),r()[0]<0?(a=uG(a),s=uG(s),e(OMe,IMe)):e(lG,cG),t}return t.base=function(l){return arguments.length?(n=+l,i()):n},t.domain=function(l){return arguments.length?(r(l),i()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let m=a(u),p=a(d),v,b;const y=l==null?10:+l;let S=[];if(!(n%1)&&p-m<y){if(m=Math.floor(m),p=Math.ceil(p),u>0){for(;m<=p;++m)for(v=1;v<n;++v)if(b=m<0?v/s(-m):v*s(m),!(b<u)){if(b>d)break;S.push(b)}}else for(;m<=p;++m)for(v=n-1;v>=1;--v)if(b=m>0?v/s(-m):v*s(m),!(b<u)){if(b>d)break;S.push(b)}S.length*2<y&&(S=oI(u,d,y))}else S=oI(m,p,Math.min(p-m,y)).map(s);return f?S.reverse():S},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=yy(c)).precision==null&&(c.trim=!0),c=Ez(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(voe(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),t}function boe(){const e=Mz(_j()).domain([1,10]);return e.copy=()=>Yx(e,boe()).base(e.base()),Eo.apply(e,arguments),e}function dG(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function fG(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Tz(e){var t=1,r=e(dG(t),fG(t));return r.constant=function(n){return arguments.length?e(dG(t=+n),fG(t)):t},Fd(r)}function yoe(){var e=Tz(_j());return e.copy=function(){return Yx(e,yoe()).constant(e.constant())},Eo.apply(e,arguments)}function hG(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function BMe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function $Me(e){return e<0?-e*e:e*e}function Az(e){var t=e(Is,Is),r=1;function n(){return r===1?e(Is,Is):r===.5?e(BMe,$Me):e(hG(r),hG(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Fd(t)}function Dz(){var e=Az(_j());return e.copy=function(){return Yx(e,Dz()).exponent(e.exponent())},Eo.apply(e,arguments),e}function FMe(){return Dz.apply(null,arguments).exponent(.5)}function mG(e){return Math.sign(e)*e*e}function UMe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function xoe(){var e=Cz(),t=[0,1],r=!1,n;function a(s){var i=UMe(e(s));return isNaN(i)?n:r?Math.round(i):i}return a.invert=function(s){return e.invert(mG(s))},a.domain=function(s){return arguments.length?(e.domain(s),a):e.domain()},a.range=function(s){return arguments.length?(e.range((t=Array.from(s,x_)).map(mG)),a):t.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(e.clamp(s),a):e.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return xoe(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Eo.apply(a,arguments),Fd(a)}function woe(){var e=[],t=[],r=[],n;function a(){var i=0,l=Math.max(1,t.length);for(r=new Array(l-1);++i<l;)r[i-1]=FEe(e,i/l);return s}function s(i){return i==null||isNaN(i=+i)?n:t[Gx(r,i)]}return s.invertExtent=function(i){var l=t.indexOf(i);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let l of i)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Nd),a()},s.range=function(i){return arguments.length?(t=Array.from(i),a()):t.slice()},s.unknown=function(i){return arguments.length?(n=i,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return woe().domain(e).range(t).unknown(n)},Eo.apply(s,arguments)}function Soe(){var e=0,t=1,r=1,n=[.5],a=[0,1],s;function i(c){return c!=null&&c<=c?a[Gx(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},i.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},i.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},i.unknown=function(c){return arguments.length&&(s=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return Soe().domain([e,t]).range(a).unknown(s)},Eo.apply(Fd(i),arguments)}function koe(){var e=[.5],t=[0,1],r,n=1;function a(s){return s!=null&&s<=s?t[Gx(e,s,0,n)]:r}return a.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(s){var i=t.indexOf(s);return[e[i-1],e[i]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return koe().domain(e).range(t).unknown(r)},Eo.apply(a,arguments)}const LA=new Date,OA=new Date;function Ta(e,t,r,n){function a(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(e(s=new Date(+s)),s),a.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),a.round=s=>{const i=a(s),l=a.ceil(s);return s-i<l-s?i:l},a.offset=(s,i)=>(t(s=new Date(+s),i==null?1:Math.floor(i)),s),a.range=(s,i,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<i)||!(l>0))return c;let u;do c.push(u=new Date(+s)),t(s,l),e(s);while(u<s&&s<i);return c},a.filter=s=>Ta(i=>{if(i>=i)for(;e(i),!s(i);)i.setTime(i-1)},(i,l)=>{if(i>=i)if(l<0)for(;++l<=0;)for(;t(i,-1),!s(i););else for(;--l>=0;)for(;t(i,1),!s(i););}),r&&(a.count=(s,i)=>(LA.setTime(+s),OA.setTime(+i),e(LA),e(OA),Math.floor(r(LA,OA))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?i=>n(i)%s===0:i=>a.count(0,i)%s===0):a)),a}const __=Ta(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);__.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ta(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):__);__.range;const Fc=1e3,bo=Fc*60,Uc=bo*60,au=Uc*24,Lz=au*7,pG=au*30,IA=au*365,Gf=Ta(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Fc)},(e,t)=>(t-e)/Fc,e=>e.getUTCSeconds());Gf.range;const Oz=Ta(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fc)},(e,t)=>{e.setTime(+e+t*bo)},(e,t)=>(t-e)/bo,e=>e.getMinutes());Oz.range;const Iz=Ta(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*bo)},(e,t)=>(t-e)/bo,e=>e.getUTCMinutes());Iz.range;const Rz=Ta(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Fc-e.getMinutes()*bo)},(e,t)=>{e.setTime(+e+t*Uc)},(e,t)=>(t-e)/Uc,e=>e.getHours());Rz.range;const Pz=Ta(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Uc)},(e,t)=>(t-e)/Uc,e=>e.getUTCHours());Pz.range;const Qx=Ta(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*bo)/au,e=>e.getDate()-1);Qx.range;const Nj=Ta(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/au,e=>e.getUTCDate()-1);Nj.range;const _oe=Ta(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/au,e=>Math.floor(e/au));_oe.range;function Gh(e){return Ta(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*bo)/Lz)}const Cj=Gh(0),N_=Gh(1),HMe=Gh(2),qMe=Gh(3),ng=Gh(4),WMe=Gh(5),KMe=Gh(6);Cj.range;N_.range;HMe.range;qMe.range;ng.range;WMe.range;KMe.range;function Vh(e){return Ta(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Lz)}const jj=Vh(0),C_=Vh(1),GMe=Vh(2),VMe=Vh(3),ag=Vh(4),YMe=Vh(5),QMe=Vh(6);jj.range;C_.range;GMe.range;VMe.range;ag.range;YMe.range;QMe.range;const zz=Ta(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());zz.range;const Bz=Ta(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Bz.range;const su=Ta(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());su.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ta(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});su.range;const iu=Ta(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());iu.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ta(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});iu.range;function Noe(e,t,r,n,a,s){const i=[[Gf,1,Fc],[Gf,5,5*Fc],[Gf,15,15*Fc],[Gf,30,30*Fc],[s,1,bo],[s,5,5*bo],[s,15,15*bo],[s,30,30*bo],[a,1,Uc],[a,3,3*Uc],[a,6,6*Uc],[a,12,12*Uc],[n,1,au],[n,2,2*au],[r,1,Lz],[t,1,pG],[t,3,3*pG],[e,1,IA]];function l(u,d,f){const m=d<u;m&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),v=p?p.range(u,+d+1):[];return m?v.reverse():v}function c(u,d,f){const m=Math.abs(d-u)/f,p=wz(([,,y])=>y).right(i,m);if(p===i.length)return e.every(cI(u/IA,d/IA,f));if(p===0)return __.every(Math.max(cI(u,d,f),1));const[v,b]=i[m/i[p-1][2]<i[p][2]/m?p-1:p];return v.every(b)}return[l,c]}const[JMe,ZMe]=Noe(iu,Bz,jj,_oe,Pz,Iz),[XMe,eTe]=Noe(su,zz,Cj,Qx,Rz,Oz);function RA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function PA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function xv(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function tTe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,s=e.days,i=e.shortDays,l=e.months,c=e.shortMonths,u=wv(a),d=Sv(a),f=wv(s),m=Sv(s),p=wv(i),v=Sv(i),b=wv(l),y=Sv(l),S=wv(c),_=Sv(c),N={a:B,A:F,b:q,B:Q,c:null,d:wG,e:wG,f:_Te,g:OTe,G:RTe,H:wTe,I:STe,j:kTe,L:Coe,m:NTe,M:CTe,p:W,q:G,Q:_G,s:NG,S:jTe,u:ETe,U:MTe,V:TTe,w:ATe,W:DTe,x:null,X:null,y:LTe,Y:ITe,Z:PTe,"%":kG},k={a:J,A:X,b:V,B:se,c:null,d:SG,e:SG,f:FTe,g:JTe,G:XTe,H:zTe,I:BTe,j:$Te,L:Eoe,m:UTe,M:HTe,p:de,q:he,Q:_G,s:NG,S:qTe,u:WTe,U:KTe,V:GTe,w:VTe,W:YTe,x:null,X:null,y:QTe,Y:ZTe,Z:e4e,"%":kG},j={a:H,A:$,b:L,B:A,c:M,d:yG,e:yG,f:vTe,g:bG,G:vG,H:xG,I:xG,j:hTe,L:gTe,m:fTe,M:mTe,p:R,q:dTe,Q:yTe,s:xTe,S:pTe,u:iTe,U:oTe,V:lTe,w:sTe,W:cTe,x:P,X:I,y:bG,Y:vG,Z:uTe,"%":bTe};N.x=E(r,N),N.X=E(n,N),N.c=E(t,N),k.x=E(r,k),k.X=E(n,k),k.c=E(t,k);function E(te,le){return function(oe){var Z=[],ve=-1,U=0,ge=te.length,ue,re,ne;for(oe instanceof Date||(oe=new Date(+oe));++ve<ge;)te.charCodeAt(ve)===37&&(Z.push(te.slice(U,ve)),(re=gG[ue=te.charAt(++ve)])!=null?ue=te.charAt(++ve):re=ue==="e"?" ":"0",(ne=le[ue])&&(ue=ne(oe,re)),Z.push(ue),U=ve+1);return Z.push(te.slice(U,ve)),Z.join("")}}function T(te,le){return function(oe){var Z=xv(1900,void 0,1),ve=O(Z,te,oe+="",0),U,ge;if(ve!=oe.length)return null;if("Q"in Z)return new Date(Z.Q);if("s"in Z)return new Date(Z.s*1e3+("L"in Z?Z.L:0));if(le&&!("Z"in Z)&&(Z.Z=0),"p"in Z&&(Z.H=Z.H%12+Z.p*12),Z.m===void 0&&(Z.m="q"in Z?Z.q:0),"V"in Z){if(Z.V<1||Z.V>53)return null;"w"in Z||(Z.w=1),"Z"in Z?(U=PA(xv(Z.y,0,1)),ge=U.getUTCDay(),U=ge>4||ge===0?C_.ceil(U):C_(U),U=Nj.offset(U,(Z.V-1)*7),Z.y=U.getUTCFullYear(),Z.m=U.getUTCMonth(),Z.d=U.getUTCDate()+(Z.w+6)%7):(U=RA(xv(Z.y,0,1)),ge=U.getDay(),U=ge>4||ge===0?N_.ceil(U):N_(U),U=Qx.offset(U,(Z.V-1)*7),Z.y=U.getFullYear(),Z.m=U.getMonth(),Z.d=U.getDate()+(Z.w+6)%7)}else("W"in Z||"U"in Z)&&("w"in Z||(Z.w="u"in Z?Z.u%7:"W"in Z?1:0),ge="Z"in Z?PA(xv(Z.y,0,1)).getUTCDay():RA(xv(Z.y,0,1)).getDay(),Z.m=0,Z.d="W"in Z?(Z.w+6)%7+Z.W*7-(ge+5)%7:Z.w+Z.U*7-(ge+6)%7);return"Z"in Z?(Z.H+=Z.Z/100|0,Z.M+=Z.Z%100,PA(Z)):RA(Z)}}function O(te,le,oe,Z){for(var ve=0,U=le.length,ge=oe.length,ue,re;ve<U;){if(Z>=ge)return-1;if(ue=le.charCodeAt(ve++),ue===37){if(ue=le.charAt(ve++),re=j[ue in gG?le.charAt(ve++):ue],!re||(Z=re(te,oe,Z))<0)return-1}else if(ue!=oe.charCodeAt(Z++))return-1}return Z}function R(te,le,oe){var Z=u.exec(le.slice(oe));return Z?(te.p=d.get(Z[0].toLowerCase()),oe+Z[0].length):-1}function H(te,le,oe){var Z=p.exec(le.slice(oe));return Z?(te.w=v.get(Z[0].toLowerCase()),oe+Z[0].length):-1}function $(te,le,oe){var Z=f.exec(le.slice(oe));return Z?(te.w=m.get(Z[0].toLowerCase()),oe+Z[0].length):-1}function L(te,le,oe){var Z=S.exec(le.slice(oe));return Z?(te.m=_.get(Z[0].toLowerCase()),oe+Z[0].length):-1}function A(te,le,oe){var Z=b.exec(le.slice(oe));return Z?(te.m=y.get(Z[0].toLowerCase()),oe+Z[0].length):-1}function M(te,le,oe){return O(te,t,le,oe)}function P(te,le,oe){return O(te,r,le,oe)}function I(te,le,oe){return O(te,n,le,oe)}function B(te){return i[te.getDay()]}function F(te){return s[te.getDay()]}function q(te){return c[te.getMonth()]}function Q(te){return l[te.getMonth()]}function W(te){return a[+(te.getHours()>=12)]}function G(te){return 1+~~(te.getMonth()/3)}function J(te){return i[te.getUTCDay()]}function X(te){return s[te.getUTCDay()]}function V(te){return c[te.getUTCMonth()]}function se(te){return l[te.getUTCMonth()]}function de(te){return a[+(te.getUTCHours()>=12)]}function he(te){return 1+~~(te.getUTCMonth()/3)}return{format:function(te){var le=E(te+="",N);return le.toString=function(){return te},le},parse:function(te){var le=T(te+="",!1);return le.toString=function(){return te},le},utcFormat:function(te){var le=E(te+="",k);return le.toString=function(){return te},le},utcParse:function(te){var le=T(te+="",!0);return le.toString=function(){return te},le}}}var gG={"-":"",_:" ",0:"0"},Ka=/^\s*\d+/,rTe=/^%/,nTe=/[\\^$*+?|[\]().{}]/g;function Pr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(t)+a:a)}function aTe(e){return e.replace(nTe,"\\$&")}function wv(e){return new RegExp("^(?:"+e.map(aTe).join("|")+")","i")}function Sv(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function sTe(e,t,r){var n=Ka.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function iTe(e,t,r){var n=Ka.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function oTe(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function lTe(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function cTe(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function vG(e,t,r){var n=Ka.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function bG(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function uTe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function dTe(e,t,r){var n=Ka.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function fTe(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function yG(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function hTe(e,t,r){var n=Ka.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function xG(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function mTe(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function pTe(e,t,r){var n=Ka.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function gTe(e,t,r){var n=Ka.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function vTe(e,t,r){var n=Ka.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function bTe(e,t,r){var n=rTe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function yTe(e,t,r){var n=Ka.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function xTe(e,t,r){var n=Ka.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function wG(e,t){return Pr(e.getDate(),t,2)}function wTe(e,t){return Pr(e.getHours(),t,2)}function STe(e,t){return Pr(e.getHours()%12||12,t,2)}function kTe(e,t){return Pr(1+Qx.count(su(e),e),t,3)}function Coe(e,t){return Pr(e.getMilliseconds(),t,3)}function _Te(e,t){return Coe(e,t)+"000"}function NTe(e,t){return Pr(e.getMonth()+1,t,2)}function CTe(e,t){return Pr(e.getMinutes(),t,2)}function jTe(e,t){return Pr(e.getSeconds(),t,2)}function ETe(e){var t=e.getDay();return t===0?7:t}function MTe(e,t){return Pr(Cj.count(su(e)-1,e),t,2)}function joe(e){var t=e.getDay();return t>=4||t===0?ng(e):ng.ceil(e)}function TTe(e,t){return e=joe(e),Pr(ng.count(su(e),e)+(su(e).getDay()===4),t,2)}function ATe(e){return e.getDay()}function DTe(e,t){return Pr(N_.count(su(e)-1,e),t,2)}function LTe(e,t){return Pr(e.getFullYear()%100,t,2)}function OTe(e,t){return e=joe(e),Pr(e.getFullYear()%100,t,2)}function ITe(e,t){return Pr(e.getFullYear()%1e4,t,4)}function RTe(e,t){var r=e.getDay();return e=r>=4||r===0?ng(e):ng.ceil(e),Pr(e.getFullYear()%1e4,t,4)}function PTe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pr(t/60|0,"0",2)+Pr(t%60,"0",2)}function SG(e,t){return Pr(e.getUTCDate(),t,2)}function zTe(e,t){return Pr(e.getUTCHours(),t,2)}function BTe(e,t){return Pr(e.getUTCHours()%12||12,t,2)}function $Te(e,t){return Pr(1+Nj.count(iu(e),e),t,3)}function Eoe(e,t){return Pr(e.getUTCMilliseconds(),t,3)}function FTe(e,t){return Eoe(e,t)+"000"}function UTe(e,t){return Pr(e.getUTCMonth()+1,t,2)}function HTe(e,t){return Pr(e.getUTCMinutes(),t,2)}function qTe(e,t){return Pr(e.getUTCSeconds(),t,2)}function WTe(e){var t=e.getUTCDay();return t===0?7:t}function KTe(e,t){return Pr(jj.count(iu(e)-1,e),t,2)}function Moe(e){var t=e.getUTCDay();return t>=4||t===0?ag(e):ag.ceil(e)}function GTe(e,t){return e=Moe(e),Pr(ag.count(iu(e),e)+(iu(e).getUTCDay()===4),t,2)}function VTe(e){return e.getUTCDay()}function YTe(e,t){return Pr(C_.count(iu(e)-1,e),t,2)}function QTe(e,t){return Pr(e.getUTCFullYear()%100,t,2)}function JTe(e,t){return e=Moe(e),Pr(e.getUTCFullYear()%100,t,2)}function ZTe(e,t){return Pr(e.getUTCFullYear()%1e4,t,4)}function XTe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ag(e):ag.ceil(e),Pr(e.getUTCFullYear()%1e4,t,4)}function e4e(){return"+0000"}function kG(){return"%"}function _G(e){return+e}function NG(e){return Math.floor(+e/1e3)}var Qm,Toe,Aoe;t4e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function t4e(e){return Qm=tTe(e),Toe=Qm.format,Qm.parse,Aoe=Qm.utcFormat,Qm.utcParse,Qm}function r4e(e){return new Date(e)}function n4e(e){return e instanceof Date?+e:+new Date(+e)}function $z(e,t,r,n,a,s,i,l,c,u){var d=Cz(),f=d.invert,m=d.domain,p=u(".%L"),v=u(":%S"),b=u("%I:%M"),y=u("%I %p"),S=u("%a %d"),_=u("%b %d"),N=u("%B"),k=u("%Y");function j(E){return(c(E)<E?p:l(E)<E?v:i(E)<E?b:s(E)<E?y:n(E)<E?a(E)<E?S:_:r(E)<E?N:k)(E)}return d.invert=function(E){return new Date(f(E))},d.domain=function(E){return arguments.length?m(Array.from(E,n4e)):m().map(r4e)},d.ticks=function(E){var T=m();return e(T[0],T[T.length-1],E??10)},d.tickFormat=function(E,T){return T==null?j:u(T)},d.nice=function(E){var T=m();return(!E||typeof E.range!="function")&&(E=t(T[0],T[T.length-1],E??10)),E?m(voe(T,E)):d},d.copy=function(){return Yx(d,$z(e,t,r,n,a,s,i,l,c,u))},d}function a4e(){return Eo.apply($z(XMe,eTe,su,zz,Cj,Qx,Rz,Oz,Gf,Toe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function s4e(){return Eo.apply($z(JMe,ZMe,iu,Bz,jj,Nj,Pz,Iz,Gf,Aoe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ej(){var e=0,t=1,r,n,a,s,i=Is,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:i(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(i=f,u):i};function d(f){return function(m){var p,v;return arguments.length?([p,v]=m,i=f(p,v),u):[i(0),i(1)]}}return u.range=d(Qc),u.rangeRound=d(Nz),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function Ud(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Doe(){var e=Fd(Ej()(Is));return e.copy=function(){return Ud(e,Doe())},mu.apply(e,arguments)}function Loe(){var e=Mz(Ej()).domain([1,10]);return e.copy=function(){return Ud(e,Loe()).base(e.base())},mu.apply(e,arguments)}function Ooe(){var e=Tz(Ej());return e.copy=function(){return Ud(e,Ooe()).constant(e.constant())},mu.apply(e,arguments)}function Fz(){var e=Az(Ej());return e.copy=function(){return Ud(e,Fz()).exponent(e.exponent())},mu.apply(e,arguments)}function i4e(){return Fz.apply(null,arguments).exponent(.5)}function Ioe(){var e=[],t=Is;function r(n){if(n!=null&&!isNaN(n=+n))return t((Gx(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Nd),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>$Ee(e,s/n))},r.copy=function(){return Ioe(t).domain(e)},mu.apply(r,arguments)}function Mj(){var e=0,t=.5,r=1,n=1,a,s,i,l,c,u=Is,d,f=!1,m;function p(b){return isNaN(b=+b)?m:(b=.5+((b=+d(b))-s)*(n*b<n*s?l:c),u(f?Math.max(0,Math.min(1,b)):b))}p.domain=function(b){return arguments.length?([e,t,r]=b,a=d(e=+e),s=d(t=+t),i=d(r=+r),l=a===s?0:.5/(s-a),c=s===i?0:.5/(i-s),n=s<a?-1:1,p):[e,t,r]},p.clamp=function(b){return arguments.length?(f=!!b,p):f},p.interpolator=function(b){return arguments.length?(u=b,p):u};function v(b){return function(y){var S,_,N;return arguments.length?([S,_,N]=y,u=bMe(b,[S,_,N]),p):[u(0),u(.5),u(1)]}}return p.range=v(Qc),p.rangeRound=v(Nz),p.unknown=function(b){return arguments.length?(m=b,p):m},function(b){return d=b,a=b(e),s=b(t),i=b(r),l=a===s?0:.5/(s-a),c=s===i?0:.5/(i-s),n=s<a?-1:1,p}}function Roe(){var e=Fd(Mj()(Is));return e.copy=function(){return Ud(e,Roe())},mu.apply(e,arguments)}function Poe(){var e=Mz(Mj()).domain([.1,1,10]);return e.copy=function(){return Ud(e,Poe()).base(e.base())},mu.apply(e,arguments)}function zoe(){var e=Tz(Mj());return e.copy=function(){return Ud(e,zoe()).constant(e.constant())},mu.apply(e,arguments)}function Uz(){var e=Az(Mj());return e.copy=function(){return Ud(e,Uz()).exponent(e.exponent())},mu.apply(e,arguments)}function o4e(){return Uz.apply(null,arguments).exponent(.5)}const CG=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:gy,scaleDiverging:Roe,scaleDivergingLog:Poe,scaleDivergingPow:Uz,scaleDivergingSqrt:o4e,scaleDivergingSymlog:zoe,scaleIdentity:goe,scaleImplicit:uI,scaleLinear:k_,scaleLog:boe,scaleOrdinal:Sz,scalePoint:Eb,scalePow:Dz,scaleQuantile:woe,scaleQuantize:Soe,scaleRadial:xoe,scaleSequential:Doe,scaleSequentialLog:Loe,scaleSequentialPow:Fz,scaleSequentialQuantile:Ioe,scaleSequentialSqrt:i4e,scaleSequentialSymlog:Ooe,scaleSqrt:FMe,scaleSymlog:yoe,scaleThreshold:koe,scaleTime:a4e,scaleUtc:s4e,tickFormat:poe},Symbol.toStringTag,{value:"Module"}));var zA,jG;function Tj(){if(jG)return zA;jG=1;var e=i0();function t(r,n,a){for(var s=-1,i=r.length;++s<i;){var l=r[s],c=n(l);if(c!=null&&(u===void 0?c===c&&!e(c):a(c,u)))var u=c,d=l}return d}return zA=t,zA}var BA,EG;function Boe(){if(EG)return BA;EG=1;function e(t,r){return t>r}return BA=e,BA}var $A,MG;function l4e(){if(MG)return $A;MG=1;var e=Tj(),t=Boe(),r=c0();function n(a){return a&&a.length?e(a,r,t):void 0}return $A=n,$A}var c4e=l4e();const Aj=Ur(c4e);var FA,TG;function $oe(){if(TG)return FA;TG=1;function e(t,r){return t<r}return FA=e,FA}var UA,AG;function u4e(){if(AG)return UA;AG=1;var e=Tj(),t=$oe(),r=c0();function n(a){return a&&a.length?e(a,r,t):void 0}return UA=n,UA}var d4e=u4e();const Dj=Ur(d4e);var HA,DG;function f4e(){if(DG)return HA;DG=1;var e=az(),t=ql(),r=Kie(),n=li();function a(s,i){var l=n(s)?e:r;return l(s,t(i,3))}return HA=a,HA}var qA,LG;function h4e(){if(LG)return qA;LG=1;var e=qie(),t=f4e();function r(n,a){return e(t(n,a),1)}return qA=r,qA}var m4e=h4e();const p4e=Ur(m4e);var WA,OG;function g4e(){if(OG)return WA;OG=1;var e=vz();function t(r,n){return e(r,n)}return WA=t,WA}var v4e=g4e();const Jx=Ur(v4e);var u0=1e9,b4e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},qz,En=!0,ko="[DecimalError] ",rh=ko+"Invalid argument: ",Hz=ko+"Exponent out of range: ",d0=Math.floor,Pf=Math.pow,y4e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ei,Ia=1e7,Nn=7,Foe=9007199254740991,j_=d0(Foe/Nn),xt={};xt.absoluteValue=xt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};xt.comparedTo=xt.cmp=function(e){var t,r,n,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};xt.decimalPlaces=xt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Nn;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};xt.dividedBy=xt.div=function(e){return Jc(this,new this.constructor(e))};xt.dividedToIntegerBy=xt.idiv=function(e){var t=this,r=t.constructor;return mn(Jc(t,new r(e),0,1),r.precision)};xt.equals=xt.eq=function(e){return!this.cmp(e)};xt.exponent=function(){return va(this)};xt.greaterThan=xt.gt=function(e){return this.cmp(e)>0};xt.greaterThanOrEqualTo=xt.gte=function(e){return this.cmp(e)>=0};xt.isInteger=xt.isint=function(){return this.e>this.d.length-2};xt.isNegative=xt.isneg=function(){return this.s<0};xt.isPositive=xt.ispos=function(){return this.s>0};xt.isZero=function(){return this.s===0};xt.lessThan=xt.lt=function(e){return this.cmp(e)<0};xt.lessThanOrEqualTo=xt.lte=function(e){return this.cmp(e)<1};xt.logarithm=xt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,s=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ei))throw Error(ko+"NaN");if(r.s<1)throw Error(ko+(r.s?"NaN":"-Infinity"));return r.eq(Ei)?new n(0):(En=!1,t=Jc(xy(r,s),xy(e,s),s),En=!0,mn(t,a))};xt.minus=xt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?qoe(t,e):Uoe(t,(e.s=-e.s,e))};xt.modulo=xt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(ko+"NaN");return r.s?(En=!1,t=Jc(r,e,0,1).times(e),En=!0,r.minus(t)):mn(new n(r),a)};xt.naturalExponential=xt.exp=function(){return Hoe(this)};xt.naturalLogarithm=xt.ln=function(){return xy(this)};xt.negated=xt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};xt.plus=xt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Uoe(t,e):qoe(t,(e.s=-e.s,e))};xt.precision=xt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(rh+e);if(t=va(a)+1,n=a.d.length-1,r=n*Nn+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};xt.squareRoot=xt.sqrt=function(){var e,t,r,n,a,s,i,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ko+"NaN")}for(e=va(l),En=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=yl(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=d0((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=i=r+3;;)if(s=n,n=s.plus(Jc(l,s,i+2)).times(.5),yl(s.d).slice(0,i)===(t=yl(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),a==i&&t=="4999"){if(mn(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;i+=4}return En=!0,mn(n,r)};xt.times=xt.mul=function(e){var t,r,n,a,s,i,l,c,u,d=this,f=d.constructor,m=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=m.length,u=p.length,c<u&&(s=m,m=p,p=s,i=c,c=u,u=i),s=[],i=c+u,n=i;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)l=s[a]+p[n]*m[a-n-1]+t,s[a--]=l%Ia|0,t=l/Ia|0;s[a]=(s[a]+t)%Ia|0}for(;!s[--i];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,En?mn(e,f.precision):e};xt.toDecimalPlaces=xt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ll(e,0,u0),t===void 0?t=n.rounding:Ll(t,0,8),mn(r,e+va(r)+1,t))};xt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=kh(n,!0):(Ll(e,0,u0),t===void 0?t=a.rounding:Ll(t,0,8),n=mn(new a(n),e+1,t),r=kh(n,!0,e+1)),r};xt.toFixed=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?kh(a):(Ll(e,0,u0),t===void 0?t=s.rounding:Ll(t,0,8),n=mn(new s(a),e+va(a)+1,t),r=kh(n.abs(),!1,e+va(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};xt.toInteger=xt.toint=function(){var e=this,t=e.constructor;return mn(new t(e),va(e)+1,t.rounding)};xt.toNumber=function(){return+this};xt.toPower=xt.pow=function(e){var t,r,n,a,s,i,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Ei);if(l=new c(l),!l.s){if(e.s<1)throw Error(ko+"Infinity");return l}if(l.eq(Ei))return l;if(n=c.precision,e.eq(Ei))return mn(l,n);if(t=e.e,r=e.d.length-1,i=t>=r,s=l.s,i){if((r=d<0?-d:d)<=Foe){for(a=new c(Ei),t=Math.ceil(n/Nn+4),En=!1;r%2&&(a=a.times(l),RG(a.d,t)),r=d0(r/2),r!==0;)l=l.times(l),RG(l.d,t);return En=!0,e.s<0?new c(Ei).div(a):mn(a,n)}}else if(s<0)throw Error(ko+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,En=!1,a=e.times(xy(l,n+u)),En=!0,a=Hoe(a),a.s=s,a};xt.toPrecision=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?(r=va(a),n=kh(a,r<=s.toExpNeg||r>=s.toExpPos)):(Ll(e,1,u0),t===void 0?t=s.rounding:Ll(t,0,8),a=mn(new s(a),e,t),r=va(a),n=kh(a,e<=r||r<=s.toExpNeg,e)),n};xt.toSignificantDigits=xt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ll(e,1,u0),t===void 0?t=n.rounding:Ll(t,0,8)),mn(new n(r),e,t)};xt.toString=xt.valueOf=xt.val=xt.toJSON=xt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=va(e),r=e.constructor;return kh(e,t<=r.toExpNeg||t>=r.toExpPos)};function Uoe(e,t){var r,n,a,s,i,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),En?mn(t,f):t;if(c=e.d,u=t.d,i=e.e,a=t.e,c=c.slice(),s=i-a,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,a=i,l=c.length),i=Math.ceil(f/Nn),l=i>l?i+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Ia|0,c[s]%=Ia;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,En?mn(t,f):t}function Ll(e,t,r){if(e!==~~e||e<t||e>r)throw Error(rh+e)}function yl(e){var t,r,n,a=e.length-1,s="",i=e[0];if(a>0){for(s+=i,t=1;t<a;t++)n=e[t]+"",r=Nn-n.length,r&&(s+=ad(r)),s+=n;i=e[t],n=i+"",r=Nn-n.length,r&&(s+=ad(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return s+i}var Jc=(function(){function e(n,a){var s,i=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+i,n[l]=s%Ia|0,i=s/Ia|0;return i&&n.unshift(i),n}function t(n,a,s,i){var l,c;if(s!=i)c=s>i?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var i=0;s--;)n[s]-=i,i=n[s]<a[s]?1:0,n[s]=i*Ia+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,i){var l,c,u,d,f,m,p,v,b,y,S,_,N,k,j,E,T,O,R=n.constructor,H=n.s==a.s?1:-1,$=n.d,L=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(ko+"Division by zero");for(c=n.e-a.e,T=L.length,j=$.length,p=new R(H),v=p.d=[],u=0;L[u]==($[u]||0);)++u;if(L[u]>($[u]||0)&&--c,s==null?_=s=R.precision:i?_=s+(va(n)-va(a))+1:_=s,_<0)return new R(0);if(_=_/Nn+2|0,u=0,T==1)for(d=0,L=L[0],_++;(u<j||d)&&_--;u++)N=d*Ia+($[u]||0),v[u]=N/L|0,d=N%L|0;else{for(d=Ia/(L[0]+1)|0,d>1&&(L=e(L,d),$=e($,d),T=L.length,j=$.length),k=T,b=$.slice(0,T),y=b.length;y<T;)b[y++]=0;O=L.slice(),O.unshift(0),E=L[0],L[1]>=Ia/2&&++E;do d=0,l=t(L,b,T,y),l<0?(S=b[0],T!=y&&(S=S*Ia+(b[1]||0)),d=S/E|0,d>1?(d>=Ia&&(d=Ia-1),f=e(L,d),m=f.length,y=b.length,l=t(f,b,m,y),l==1&&(d--,r(f,T<m?O:L,m))):(d==0&&(l=d=1),f=L.slice()),m=f.length,m<y&&f.unshift(0),r(b,f,y),l==-1&&(y=b.length,l=t(L,b,T,y),l<1&&(d++,r(b,T<y?O:L,y))),y=b.length):l===0&&(d++,b=[0]),v[u++]=d,l&&b[0]?b[y++]=$[k]||0:(b=[$[k]],y=1);while((k++<j||b[0]!==void 0)&&_--)}return v[0]||v.shift(),p.e=c,mn(p,i?s+va(p)+1:s)}})();function Hoe(e,t){var r,n,a,s,i,l,c=0,u=0,d=e.constructor,f=d.precision;if(va(e)>16)throw Error(Hz+va(e));if(!e.s)return new d(Ei);for(En=!1,l=f,i=new d(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(n=Math.log(Pf(2,u))/Math.LN10*2+5|0,l+=n,r=a=s=new d(Ei),d.precision=l;;){if(a=mn(a.times(e),l),r=r.times(++c),i=s.plus(Jc(a,r,l)),yl(i.d).slice(0,l)===yl(s.d).slice(0,l)){for(;u--;)s=mn(s.times(s),l);return d.precision=f,t==null?(En=!0,mn(s,f)):s}s=i}}function va(e){for(var t=e.e*Nn,r=e.d[0];r>=10;r/=10)t++;return t}function KA(e,t,r){if(t>e.LN10.sd())throw En=!0,r&&(e.precision=r),Error(ko+"LN10 precision limit exceeded");return mn(new e(e.LN10),t)}function ad(e){for(var t="";e--;)t+="0";return t}function xy(e,t){var r,n,a,s,i,l,c,u,d,f=1,m=10,p=e,v=p.d,b=p.constructor,y=b.precision;if(p.s<1)throw Error(ko+(p.s?"NaN":"-Infinity"));if(p.eq(Ei))return new b(0);if(t==null?(En=!1,u=y):u=t,p.eq(10))return t==null&&(En=!0),KA(b,u);if(u+=m,b.precision=u,r=yl(v),n=r.charAt(0),s=va(p),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=yl(p.d),n=r.charAt(0),f++;s=va(p),n>1?(p=new b("0."+r),s++):p=new b(n+"."+r.slice(1))}else return c=KA(b,u+2,y).times(s+""),p=xy(new b(n+"."+r.slice(1)),u-m).plus(c),b.precision=y,t==null?(En=!0,mn(p,y)):p;for(l=i=p=Jc(p.minus(Ei),p.plus(Ei),u),d=mn(p.times(p),u),a=3;;){if(i=mn(i.times(d),u),c=l.plus(Jc(i,new b(a),u)),yl(c.d).slice(0,u)===yl(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(KA(b,u+2,y).times(s+""))),l=Jc(l,new b(f),u),b.precision=y,t==null?(En=!0,mn(l,y)):l;l=c,a+=2}}function IG(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=d0(r/Nn),e.d=[],n=(r+1)%Nn,r<0&&(n+=Nn),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Nn;n<a;)e.d.push(+t.slice(n,n+=Nn));t=t.slice(n),n=Nn-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),En&&(e.e>j_||e.e<-j_))throw Error(Hz+r)}else e.s=0,e.e=0,e.d=[0];return e}function mn(e,t,r){var n,a,s,i,l,c,u,d,f=e.d;for(i=1,s=f[0];s>=10;s/=10)i++;if(n=t-i,n<0)n+=Nn,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/Nn),s=f.length,d>=s)return e;for(u=s=f[d],i=1;s>=10;s/=10)i++;n%=Nn,a=n-Nn+i}if(r!==void 0&&(s=Pf(10,i-a-1),l=u/s%10|0,c=t<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/Pf(10,i-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=va(e),f.length=1,t=t-s-1,f[0]=Pf(10,(Nn-t%Nn)%Nn),e.e=d0(-t/Nn)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=Pf(10,Nn-n),f[d]=a>0?(u/Pf(10,i-a)%Pf(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Ia&&(f[0]=1,++e.e);break}else{if(f[d]+=s,f[d]!=Ia)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(En&&(e.e>j_||e.e<-j_))throw Error(Hz+va(e));return e}function qoe(e,t){var r,n,a,s,i,l,c,u,d,f,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),En?mn(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),i=u-n,i){for(d=i<0,d?(r=c,i=-i,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(p/Nn),l)+2,i>a&&(i=a,r.length=1),r.reverse(),a=i;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}i=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>i;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Ia-1;--c[s],c[a]+=Ia}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,En?mn(t,p):t):new m(0)}function kh(e,t,r){var n,a=va(e),s=yl(e.d),i=s.length;return t?(r&&(n=r-i)>0?s=s.charAt(0)+"."+s.slice(1)+ad(n):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+ad(-a-1)+s,r&&(n=r-i)>0&&(s+=ad(n))):a>=i?(s+=ad(a+1-i),r&&(n=r-a-1)>0&&(s=s+"."+ad(n))):((n=a+1)<i&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-i)>0&&(a+1===i&&(s+="."),s+=ad(n))),e.s<0?"-"+s:s}function RG(e,t){if(e.length>t)return e.length=t,!0}function Woe(e){var t,r,n;function a(s){var i=this;if(!(i instanceof a))return new a(s);if(i.constructor=a,s instanceof a){i.s=s.s,i.e=s.e,i.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(rh+s);if(s>0)i.s=1;else if(s<0)s=-s,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(s===~~s&&s<1e7){i.e=0,i.d=[s];return}return IG(i,s.toString())}else if(typeof s!="string")throw Error(rh+s);if(s.charCodeAt(0)===45?(s=s.slice(1),i.s=-1):i.s=1,y4e.test(s))IG(i,s);else throw Error(rh+s)}if(a.prototype=xt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Woe,a.config=a.set=x4e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function x4e(e){if(!e||typeof e!="object")throw Error(ko+"Object expected");var t,r,n,a=["precision",1,u0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(d0(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(rh+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(rh+r+": "+n);return this}var qz=Woe(b4e);Ei=new qz(1);const dn=qz;function w4e(e){return N4e(e)||_4e(e)||k4e(e)||S4e()}function S4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k4e(e,t){if(e){if(typeof e=="string")return pI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pI(e,t)}}function _4e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function N4e(e){if(Array.isArray(e))return pI(e)}function pI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C4e=function(t){return t},Koe={},Goe=function(t){return t===Koe},PG=function(t){return function r(){return arguments.length===0||arguments.length===1&&Goe(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},j4e=function e(t,r){return t===1?r:PG(function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];var i=a.filter(function(l){return l!==Koe}).length;return i>=t?r.apply(void 0,a):e(t-i,PG(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=a.map(function(f){return Goe(f)?c.shift():f});return r.apply(void 0,w4e(d).concat(c))}))})},Lj=function(t){return j4e(t.length,t)},gI=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},E4e=Lj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),M4e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return C4e;var a=r.reverse(),s=a[0],i=a.slice(1);return function(){return i.reduce(function(l,c){return c(l)},s.apply(void 0,arguments))}},vI=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Voe=function(t){var r=null,n=null;return function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return r&&s.every(function(l,c){return l===r[c]})||(r=s,n=t.apply(void 0,s)),n}};function T4e(e){var t;return e===0?t=1:t=Math.floor(new dn(e).abs().log(10).toNumber())+1,t}function A4e(e,t,r){for(var n=new dn(e),a=0,s=[];n.lt(t)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var D4e=Lj(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),L4e=Lj(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),O4e=Lj(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Oj={rangeStep:A4e,getDigitCount:T4e,interpolateNumber:D4e,uninterpolateNumber:L4e,uninterpolateTruncation:O4e};function bI(e){return P4e(e)||R4e(e)||Yoe(e)||I4e()}function I4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R4e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function P4e(e){if(Array.isArray(e))return yI(e)}function wy(e,t){return $4e(e)||B4e(e,t)||Yoe(e,t)||z4e()}function z4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yoe(e,t){if(e){if(typeof e=="string")return yI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yI(e,t)}}function yI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B4e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,s=void 0;try{for(var i=e[Symbol.iterator](),l;!(n=(l=i.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,s=c}finally{try{!n&&i.return!=null&&i.return()}finally{if(a)throw s}}return r}}function $4e(e){if(Array.isArray(e))return e}function Qoe(e){var t=wy(e,2),r=t[0],n=t[1],a=r,s=n;return r>n&&(a=n,s=r),[a,s]}function Joe(e,t,r){if(e.lte(0))return new dn(0);var n=Oj.getDigitCount(e.toNumber()),a=new dn(10).pow(n),s=e.div(a),i=n!==1?.05:.1,l=new dn(Math.ceil(s.div(i).toNumber())).add(r).mul(i),c=l.mul(a);return t?c:new dn(Math.ceil(c))}function F4e(e,t,r){var n=1,a=new dn(e);if(!a.isint()&&r){var s=Math.abs(e);s<1?(n=new dn(10).pow(Oj.getDigitCount(e)-1),a=new dn(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new dn(Math.floor(e)))}else e===0?a=new dn(Math.floor((t-1)/2)):r||(a=new dn(Math.floor(e)));var i=Math.floor((t-1)/2),l=M4e(E4e(function(c){return a.add(new dn(c-i).mul(n)).toNumber()}),gI);return l(0,t)}function Zoe(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new dn(0),tickMin:new dn(0),tickMax:new dn(0)};var s=Joe(new dn(t).sub(e).div(r-1),n,a),i;e<=0&&t>=0?i=new dn(0):(i=new dn(e).add(t).div(2),i=i.sub(new dn(i).mod(s)));var l=Math.ceil(i.sub(e).div(s).toNumber()),c=Math.ceil(new dn(t).sub(i).div(s).toNumber()),u=l+c+1;return u>r?Zoe(e,t,r,n,a+1):(u<r&&(c=t>0?c+(r-u):c,l=t>0?l:l+(r-u)),{step:s,tickMin:i.sub(new dn(l).mul(s)),tickMax:i.add(new dn(c).mul(s))})}function U4e(e){var t=wy(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(a,2),l=Qoe([r,n]),c=wy(l,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(bI(gI(0,a-1).map(function(){return 1/0}))):[].concat(bI(gI(0,a-1).map(function(){return-1/0})),[d]);return r>n?vI(f):f}if(u===d)return F4e(u,a,s);var m=Zoe(u,d,i,s),p=m.step,v=m.tickMin,b=m.tickMax,y=Oj.rangeStep(v,b.add(new dn(.1).mul(p)),p);return r>n?vI(y):y}function H4e(e,t){var r=wy(e,2),n=r[0],a=r[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Qoe([n,a]),l=wy(i,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[n,a];if(c===u)return[c];var d=Math.max(t,2),f=Joe(new dn(u).sub(c).div(d-1),s,0),m=[].concat(bI(Oj.rangeStep(new dn(c),new dn(u).sub(new dn(.99).mul(f)),f)),[u]);return n>a?vI(m):m}var q4e=Voe(U4e),W4e=Voe(H4e),K4e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function sg(e){"@babel/helpers - typeof";return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sg(e)}function E_(){return E_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E_.apply(this,arguments)}function G4e(e,t){return J4e(e)||Q4e(e,t)||Y4e(e,t)||V4e()}function V4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y4e(e,t){if(e){if(typeof e=="string")return zG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zG(e,t)}}function zG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function J4e(e){if(Array.isArray(e))return e}function Z4e(e,t){if(e==null)return{};var r=X4e(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function X4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function e3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tle(n.key),n)}}function r3e(e,t,r){return t&&t3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function n3e(e,t,r){return t=M_(t),a3e(e,Xoe()?Reflect.construct(t,r||[],M_(e).constructor):t.apply(e,r))}function a3e(e,t){if(t&&(sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s3e(e)}function s3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xoe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xoe=function(){return!!e})()}function M_(e){return M_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},M_(e)}function i3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xI(e,t)}function xI(e,t){return xI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},xI(e,t)}function ele(e,t,r){return t=tle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tle(e){var t=o3e(e,"string");return sg(t)=="symbol"?t:t+""}function o3e(e,t){if(sg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Zx=(function(e){function t(){return e3e(this,t),n3e(this,t,arguments)}return i3e(t,e),r3e(t,[{key:"render",value:function(){var n=this.props,a=n.offset,s=n.layout,i=n.width,l=n.dataKey,c=n.data,u=n.dataPointFormatter,d=n.xAxis,f=n.yAxis,m=Z4e(n,K4e),p=Ht(m,!1);this.props.direction==="x"&&d.type!=="number"&&gh(!1);var v=c.map(function(b){var y=u(b,l),S=y.x,_=y.y,N=y.value,k=y.errorVal;if(!k)return null;var j=[],E,T;if(Array.isArray(k)){var O=G4e(k,2);E=O[0],T=O[1]}else E=T=k;if(s==="vertical"){var R=d.scale,H=_+a,$=H+i,L=H-i,A=R(N-E),M=R(N+T);j.push({x1:M,y1:$,x2:M,y2:L}),j.push({x1:A,y1:H,x2:M,y2:H}),j.push({x1:A,y1:$,x2:A,y2:L})}else if(s==="horizontal"){var P=f.scale,I=S+a,B=I-i,F=I+i,q=P(N-E),Q=P(N+T);j.push({x1:B,y1:Q,x2:F,y2:Q}),j.push({x1:I,y1:q,x2:I,y2:Q}),j.push({x1:B,y1:q,x2:F,y2:q})}return ce.createElement(Ir,E_({className:"recharts-errorBar",key:"bar-".concat(j.map(function(W){return"".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2)}))},p),j.map(function(W){return ce.createElement("line",E_({},W,{key:"line-".concat(W.x1,"-").concat(W.x2,"-").concat(W.y1,"-").concat(W.y2)}))}))});return ce.createElement(Ir,{className:"recharts-errorBars"},v)}}])})(ce.Component);ele(Zx,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});ele(Zx,"displayName","ErrorBar");function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function BG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BG(Object(r),!0).forEach(function(n){l3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l3e(e,t,r){return t=c3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c3e(e){var t=u3e(e,"string");return Sy(t)=="symbol"?t:t+""}function u3e(e,t){if(Sy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rle=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,s=t.legendContent,i=Ni(r,Ip);if(!i)return null;var l=Ip.defaultProps,c=l!==void 0?mf(mf({},l),i.props):{},u;return i.props&&i.props.payload?u=i.props&&i.props.payload:s==="children"?u=(n||[]).reduce(function(d,f){var m=f.item,p=f.props,v=p.sectors||p.data||[];return d.concat(v.map(function(b){return{type:i.props.iconType||m.props.legendType,value:b.name,color:b.fill,payload:b}}))},[]):u=(n||[]).map(function(d){var f=d.item,m=f.type.defaultProps,p=m!==void 0?mf(mf({},m),f.props):{},v=p.dataKey,b=p.name,y=p.legendType,S=p.hide;return{inactive:S,dataKey:v,type:c.iconType||y||"square",color:Wz(f),value:b||v,payload:p}}),mf(mf(mf({},c),Ip.getWithHeight(i,a)),{},{payload:u,item:i})};function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function $G(e){return m3e(e)||h3e(e)||f3e(e)||d3e()}function d3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f3e(e,t){if(e){if(typeof e=="string")return wI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wI(e,t)}}function h3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function m3e(e){if(Array.isArray(e))return wI(e)}function wI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FG(Object(r),!0).forEach(function(n){Pp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pp(e,t,r){return t=p3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p3e(e){var t=g3e(e,"string");return ky(t)=="symbol"?t:t+""}function g3e(e,t){if(ky(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ky(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ca(e,t,r){return rr(e)||rr(t)?r:ja(t)?Di(e,t,r):er(t)?t(e):r}function Mb(e,t,r,n){var a=p4e(e,function(l){return Ca(l,t)});if(r==="number"){var s=a.filter(function(l){return tt(l)||parseFloat(l)});return s.length?[Dj(s),Aj(s)]:[1/0,-1/0]}var i=n?a.filter(function(l){return!rr(l)}):a;return i.map(function(l){return ja(l)||l instanceof Date?l:""})}var v3e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,i=-1,l=(r=n?.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var c=s.range,u=0;u<l;u++){var d=u>0?a[u-1].coordinate:a[l-1].coordinate,f=a[u].coordinate,m=u>=l-1?a[0].coordinate:a[u+1].coordinate,p=void 0;if(Ls(f-d)!==Ls(m-f)){var v=[];if(Ls(m-f)===Ls(c[1]-c[0])){p=m;var b=f+c[1]-c[0];v[0]=Math.min(b,(b+d)/2),v[1]=Math.max(b,(b+d)/2)}else{p=d;var y=m+c[1]-c[0];v[0]=Math.min(f,(y+f)/2),v[1]=Math.max(f,(y+f)/2)}var S=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(t>S[0]&&t<=S[1]||t>=v[0]&&t<=v[1]){i=a[u].index;break}}else{var _=Math.min(d,m),N=Math.max(d,m);if(t>(_+f)/2&&t<=(N+f)/2){i=a[u].index;break}}}else for(var k=0;k<l;k++)if(k===0&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k>0&&k<l-1&&t>(n[k].coordinate+n[k-1].coordinate)/2&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k===l-1&&t>(n[k].coordinate+n[k-1].coordinate)/2){i=n[k].index;break}return i},Wz=function(t){var r,n=t,a=n.type.displayName,s=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Kn(Kn({},t.type.defaultProps),t.props):t.props,i=s.stroke,l=s.fill,c;switch(a){case"Line":c=i;break;case"Area":case"Radar":c=i&&i!=="none"?i:l;break;default:c=l;break}return c},b3e=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,s=a===void 0?{}:a;if(!s)return{};for(var i={},l=Object.keys(s),c=0,u=l.length;c<u;c++)for(var d=s[l[c]].stackGroups,f=Object.keys(d),m=0,p=f.length;m<p;m++){var v=d[f[m]],b=v.items,y=v.cateAxisId,S=b.filter(function(T){return Yc(T.type).indexOf("Bar")>=0});if(S&&S.length){var _=S[0].type.defaultProps,N=_!==void 0?Kn(Kn({},_),S[0].props):S[0].props,k=N.barSize,j=N[y];i[j]||(i[j]=[]);var E=rr(k)?r:k;i[j].push({item:S[0],stackList:S.slice(1),barSize:rr(E)?void 0:Os(E,n,0)})}}return i},y3e=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,s=t.sizeList,i=s===void 0?[]:s,l=t.maxBarSize,c=i.length;if(c<1)return null;var u=Os(r,a,0,!0),d,f=[];if(i[0].barSize===+i[0].barSize){var m=!1,p=a/c,v=i.reduce(function(k,j){return k+j.barSize||0},0);v+=(c-1)*u,v>=a&&(v-=(c-1)*u,u=0),v>=a&&p>0&&(m=!0,p*=.9,v=c*p);var b=(a-v)/2>>0,y={offset:b-u,size:0};d=i.reduce(function(k,j){var E={item:j.item,position:{offset:y.offset+y.size+u,size:m?p:j.barSize}},T=[].concat($G(k),[E]);return y=T[T.length-1].position,j.stackList&&j.stackList.length&&j.stackList.forEach(function(O){T.push({item:O,position:y})}),T},f)}else{var S=Os(n,a,0,!0);a-2*S-(c-1)*u<=0&&(u=0);var _=(a-2*S-(c-1)*u)/c;_>1&&(_>>=0);var N=l===+l?Math.min(_,l):_;d=i.reduce(function(k,j,E){var T=[].concat($G(k),[{item:j.item,position:{offset:S+(_+u)*E+(_-N)/2,size:N}}]);return j.stackList&&j.stackList.length&&j.stackList.forEach(function(O){T.push({item:O,position:T[T.length-1].position})}),T},f)}return d},x3e=function(t,r,n,a){var s=n.children,i=n.width,l=n.margin,c=i-(l.left||0)-(l.right||0),u=rle({children:s,legendWidth:c});if(u){var d=a||{},f=d.width,m=d.height,p=u.align,v=u.verticalAlign,b=u.layout;if((b==="vertical"||b==="horizontal"&&v==="middle")&&p!=="center"&&tt(t[p]))return Kn(Kn({},t),{},Pp({},p,t[p]+(f||0)));if((b==="horizontal"||b==="vertical"&&p==="center")&&v!=="middle"&&tt(t[v]))return Kn(Kn({},t),{},Pp({},v,t[v]+(m||0)))}return t},w3e=function(t,r,n){return rr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},nle=function(t,r,n,a,s){var i=r.props.children,l=Li(i,Zx).filter(function(u){return w3e(a,s,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var f=Ca(d,n);if(rr(f))return u;var m=Array.isArray(f)?[Dj(f),Aj(f)]:[f,f],p=c.reduce(function(v,b){var y=Ca(d,b,0),S=m[0]-Math.abs(Array.isArray(y)?y[0]:y),_=m[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(S,v[0]),Math.max(_,v[1])]},[1/0,-1/0]);return[Math.min(p[0],u[0]),Math.max(p[1],u[1])]},[1/0,-1/0])}return null},S3e=function(t,r,n,a,s){var i=r.map(function(l){return nle(t,l,n,s,a)}).filter(function(l){return!rr(l)});return i&&i.length?i.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},ale=function(t,r,n,a,s){var i=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&nle(t,c,u,a)||Mb(t,u,n,s)});if(n==="number")return i.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return i.reduce(function(c,u){for(var d=0,f=u.length;d<f;d++)l[u[d]]||(l[u[d]]=!0,c.push(u[d]));return c},[])},sle=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},ile=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var s,i,l=t.map(function(c){return c.coordinate===r&&(s=!0),c.coordinate===n&&(i=!0),c.coordinate});return s||l.push(r),i||l.push(n),l},Hc=function(t,r,n){if(!t)return null;var a=t.scale,s=t.duplicateDomain,i=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&i==="category"&&a.bandwidth?a.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&l?.length>=2?Ls(l[0]-l[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(f){var m=s?s.indexOf(f):f;return{coordinate:a(m)+u,value:f,offset:u}});return d.filter(function(f){return!qx(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,m){return{coordinate:a(f)+u,value:f,index:m,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+u,value:f,offset:u}}):a.domain().map(function(f,m){return{coordinate:a(f)+u,value:s?s[f]:f,index:m,offset:u}})},GA=new WeakMap,aS=function(t,r){if(typeof r!="function")return t;GA.has(t)||GA.set(t,new WeakMap);var n=GA.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},ole=function(t,r,n){var a=t.scale,s=t.type,i=t.layout,l=t.axisType;if(a==="auto")return i==="radial"&&l==="radiusAxis"?{scale:gy(),realScaleType:"band"}:i==="radial"&&l==="angleAxis"?{scale:k_(),realScaleType:"linear"}:s==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Eb(),realScaleType:"point"}:s==="category"?{scale:gy(),realScaleType:"band"}:{scale:k_(),realScaleType:"linear"};if(yh(a)){var c="scale".concat(gj(a));return{scale:(CG[c]||Eb)(),realScaleType:CG[c]?c:"point"}}return er(a)?{scale:a}:{scale:Eb(),realScaleType:"point"}},UG=1e-4,lle=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),s=Math.min(a[0],a[1])-UG,i=Math.max(a[0],a[1])+UG,l=t(r[0]),c=t(r[n-1]);(l<s||l>i||c<s||c>i)&&t.domain([r[0],r[n-1]])}},k3e=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},_3e=function(t,r){if(!r||r.length!==2||!tt(r[0])||!tt(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),s=[t[0],t[1]];return(!tt(t[0])||t[0]<n)&&(s[0]=n),(!tt(t[1])||t[1]>a)&&(s[1]=a),s[0]>a&&(s[0]=a),s[1]<n&&(s[1]=n),s},N3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var s=0,i=0,l=0;l<r;++l){var c=qx(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=s,t[l][n][1]=s+c,s=t[l][n][1]):(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1])}},C3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var s=0,i=0;i<r;++i){var l=qx(t[i][n][1])?t[i][n][0]:t[i][n][1];l>=0?(t[i][n][0]=s,t[i][n][1]=s+l,s=t[i][n][1]):(t[i][n][0]=0,t[i][n][1]=0)}},j3e={sign:N3e,expand:cCe,none:Jp,silhouette:uCe,wiggle:dCe,positive:C3e},E3e=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),s=j3e[n],i=lCe().keys(a).value(function(l,c){return+Ca(l,c,0)}).order(QO).offset(s);return i(t)},M3e=function(t,r,n,a,s,i){if(!t)return null;var l=i?r.reverse():r,c={},u=l.reduce(function(f,m){var p,v=(p=m.type)!==null&&p!==void 0&&p.defaultProps?Kn(Kn({},m.type.defaultProps),m.props):m.props,b=v.stackId,y=v.hide;if(y)return f;var S=v[n],_=f[S]||{hasStack:!1,stackGroups:{}};if(ja(b)){var N=_.stackGroups[b]||{numericAxisId:n,cateAxisId:a,items:[]};N.items.push(m),_.hasStack=!0,_.stackGroups[b]=N}else _.stackGroups[l0("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[m]};return Kn(Kn({},f),{},Pp({},S,_))},c),d={};return Object.keys(u).reduce(function(f,m){var p=u[m];if(p.hasStack){var v={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(b,y){var S=p.stackGroups[y];return Kn(Kn({},b),{},Pp({},y,{numericAxisId:n,cateAxisId:a,items:S.items,stackedData:E3e(t,S.items,s)}))},v)}return Kn(Kn({},f),{},Pp({},m,p))},d)},cle=function(t,r){var n=r.realScaleType,a=r.type,s=r.tickCount,i=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(s&&a==="number"&&i&&(i[0]==="auto"||i[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=q4e(u,s,l);return t.domain([Dj(d),Aj(d)]),{niceTicks:d}}if(s&&a==="number"){var f=t.domain(),m=W4e(f,s,l);return{niceTicks:m}}return null};function HG(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,s=e.index,i=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!rr(a[t.dataKey])){var l=a_(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[s]?r[s].coordinate+n/2:null}var c=Ca(a,rr(i)?t.dataKey:i);return rr(c)?null:t.scale(c)}var qG=function(t){var r=t.axis,n=t.ticks,a=t.offset,s=t.bandSize,i=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=Ca(i,r.dataKey,r.domain[l]);return rr(c)?null:r.scale(c)-s/2+a},T3e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]);return a<=0&&s>=0?0:s<0?s:a}return n[0]},A3e=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Kn(Kn({},t.type.defaultProps),t.props):t.props,s=a.stackId;if(ja(s)){var i=r[s];if(i){var l=i.items.indexOf(t);return l>=0?i.stackedData[l]:null}}return null},D3e=function(t){return t.reduce(function(r,n){return[Dj(n.concat([r[0]]).filter(tt)),Aj(n.concat([r[1]]).filter(tt))]},[1/0,-1/0])},ule=function(t,r,n){return Object.keys(t).reduce(function(a,s){var i=t[s],l=i.stackedData,c=l.reduce(function(u,d){var f=D3e(d.slice(r,n+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},WG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,KG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,SI=function(t,r,n){if(er(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(tt(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(WG.test(t[0])){var s=+WG.exec(t[0])[1];a[0]=r[0]-s}else er(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(tt(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(KG.test(t[1])){var i=+KG.exec(t[1])[1];a[1]=r[1]+i}else er(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},T_=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var s=yz(r,function(f){return f.coordinate}),i=1/0,l=1,c=s.length;l<c;l++){var u=s[l],d=s[l-1];i=Math.min((u.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0},GG=function(t,r,n){return!t||!t.length||Jx(t,Di(n,"type.defaultProps.domain"))?r:t},dle=function(t,r){var n=t.type.defaultProps?Kn(Kn({},t.type.defaultProps),t.props):t.props,a=n.dataKey,s=n.name,i=n.unit,l=n.formatter,c=n.tooltipType,u=n.chartType,d=n.hide;return Kn(Kn({},Ht(t,!1)),{},{dataKey:a,unit:i,formatter:l,name:s||a,color:Wz(t),value:Ca(r,a),type:c,payload:r,chartType:u,hide:d})};function _y(e){"@babel/helpers - typeof";return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_y(e)}function VG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VG(Object(r),!0).forEach(function(n){fle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fle(e,t,r){return t=L3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L3e(e){var t=O3e(e,"string");return _y(t)=="symbol"?t:t+""}function O3e(e,t){if(_y(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I3e(e,t){return B3e(e)||z3e(e,t)||P3e(e,t)||R3e()}function R3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P3e(e,t){if(e){if(typeof e=="string")return YG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YG(e,t)}}function YG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function z3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function B3e(e){if(Array.isArray(e))return e}var A_=Math.PI/180,$3e=function(t){return t*180/Math.PI},xn=function(t,r,n,a){return{x:t+Math.cos(-A_*a)*n,y:r+Math.sin(-A_*a)*n}},hle=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},F3e=function(t,r,n,a,s){var i=t.width,l=t.height,c=t.startAngle,u=t.endAngle,d=Os(t.cx,i,i/2),f=Os(t.cy,l,l/2),m=hle(i,l,n),p=Os(t.innerRadius,m,0),v=Os(t.outerRadius,m,m*.8),b=Object.keys(r);return b.reduce(function(y,S){var _=r[S],N=_.domain,k=_.reversed,j;if(rr(_.range))a==="angleAxis"?j=[c,u]:a==="radiusAxis"&&(j=[p,v]),k&&(j=[j[1],j[0]]);else{j=_.range;var E=j,T=I3e(E,2);c=T[0],u=T[1]}var O=ole(_,s),R=O.realScaleType,H=O.scale;H.domain(N).range(j),lle(H);var $=cle(H,Rc(Rc({},_),{},{realScaleType:R})),L=Rc(Rc(Rc({},_),$),{},{range:j,radius:v,realScaleType:R,scale:H,cx:d,cy:f,innerRadius:p,outerRadius:v,startAngle:c,endAngle:u});return Rc(Rc({},y),{},fle({},S,L))},{})},U3e=function(t,r){var n=t.x,a=t.y,s=r.x,i=r.y;return Math.sqrt(Math.pow(n-s,2)+Math.pow(a-i,2))},H3e=function(t,r){var n=t.x,a=t.y,s=r.cx,i=r.cy,l=U3e({x:n,y:a},{x:s,y:i});if(l<=0)return{radius:l};var c=(n-s)/l,u=Math.acos(c);return a>i&&(u=2*Math.PI-u),{radius:l,angle:$3e(u),angleInRadian:u}},q3e=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),s=Math.floor(n/360),i=Math.min(a,s);return{startAngle:r-i*360,endAngle:n-i*360}},W3e=function(t,r){var n=r.startAngle,a=r.endAngle,s=Math.floor(n/360),i=Math.floor(a/360),l=Math.min(s,i);return t+l*360},QG=function(t,r){var n=t.x,a=t.y,s=H3e({x:n,y:a},r),i=s.radius,l=s.angle,c=r.innerRadius,u=r.outerRadius;if(i<c||i>u)return!1;if(i===0)return!0;var d=q3e(r),f=d.startAngle,m=d.endAngle,p=l,v;if(f<=m){for(;p>m;)p-=360;for(;p<f;)p+=360;v=p>=f&&p<=m}else{for(;p>f;)p-=360;for(;p<m;)p+=360;v=p>=m&&p<=f}return v?Rc(Rc({},r),{},{radius:i,angle:W3e(p,r)}):null},mle=function(t){return!w.isValidElement(t)&&!er(t)&&typeof t!="boolean"?t.className:""};function Ny(e){"@babel/helpers - typeof";return Ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ny(e)}var K3e=["offset"];function G3e(e){return J3e(e)||Q3e(e)||Y3e(e)||V3e()}function V3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y3e(e,t){if(e){if(typeof e=="string")return kI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kI(e,t)}}function Q3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function J3e(e){if(Array.isArray(e))return kI(e)}function kI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z3e(e,t){if(e==null)return{};var r=X3e(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function X3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function JG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JG(Object(r),!0).forEach(function(n){eAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eAe(e,t,r){return t=tAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tAe(e){var t=rAe(e,"string");return Ny(t)=="symbol"?t:t+""}function rAe(e,t){if(Ny(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ny(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cy(){return Cy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cy.apply(this,arguments)}var nAe=function(t){var r=t.value,n=t.formatter,a=rr(t.children)?r:t.children;return er(n)?n(a):a},aAe=function(t,r){var n=Ls(r-t),a=Math.min(Math.abs(r-t),360);return n*a},sAe=function(t,r,n){var a=t.position,s=t.viewBox,i=t.offset,l=t.className,c=s,u=c.cx,d=c.cy,f=c.innerRadius,m=c.outerRadius,p=c.startAngle,v=c.endAngle,b=c.clockWise,y=(f+m)/2,S=aAe(p,v),_=S>=0?1:-1,N,k;a==="insideStart"?(N=p+_*i,k=b):a==="insideEnd"?(N=v-_*i,k=!b):a==="end"&&(N=v+_*i,k=b),k=S<=0?k:!k;var j=xn(u,d,y,N),E=xn(u,d,y,N+(k?1:-1)*359),T="M".concat(j.x,",").concat(j.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(k?0:1,`,
    `).concat(E.x,",").concat(E.y),O=rr(t.id)?l0("recharts-radial-line-"):t.id;return ce.createElement("text",Cy({},n,{dominantBaseline:"central",className:ur("recharts-radial-bar-label",l)}),ce.createElement("defs",null,ce.createElement("path",{id:O,d:T})),ce.createElement("textPath",{xlinkHref:"#".concat(O)},r))},iAe=function(t){var r=t.viewBox,n=t.offset,a=t.position,s=r,i=s.cx,l=s.cy,c=s.innerRadius,u=s.outerRadius,d=s.startAngle,f=s.endAngle,m=(d+f)/2;if(a==="outside"){var p=xn(i,l,u+n,m),v=p.x,b=p.y;return{x:v,y:b,textAnchor:v>=i?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+u)/2,S=xn(i,l,y,m),_=S.x,N=S.y;return{x:_,y:N,textAnchor:"middle",verticalAnchor:"middle"}},oAe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,s=t.position,i=r,l=i.x,c=i.y,u=i.width,d=i.height,f=d>=0?1:-1,m=f*a,p=f>0?"end":"start",v=f>0?"start":"end",b=u>=0?1:-1,y=b*a,S=b>0?"end":"start",_=b>0?"start":"end";if(s==="top"){var N={x:l+u/2,y:c-f*a,textAnchor:"middle",verticalAnchor:p};return _a(_a({},N),n?{height:Math.max(c-n.y,0),width:u}:{})}if(s==="bottom"){var k={x:l+u/2,y:c+d+m,textAnchor:"middle",verticalAnchor:v};return _a(_a({},k),n?{height:Math.max(n.y+n.height-(c+d),0),width:u}:{})}if(s==="left"){var j={x:l-y,y:c+d/2,textAnchor:S,verticalAnchor:"middle"};return _a(_a({},j),n?{width:Math.max(j.x-n.x,0),height:d}:{})}if(s==="right"){var E={x:l+u+y,y:c+d/2,textAnchor:_,verticalAnchor:"middle"};return _a(_a({},E),n?{width:Math.max(n.x+n.width-E.x,0),height:d}:{})}var T=n?{width:u,height:d}:{};return s==="insideLeft"?_a({x:l+y,y:c+d/2,textAnchor:_,verticalAnchor:"middle"},T):s==="insideRight"?_a({x:l+u-y,y:c+d/2,textAnchor:S,verticalAnchor:"middle"},T):s==="insideTop"?_a({x:l+u/2,y:c+m,textAnchor:"middle",verticalAnchor:v},T):s==="insideBottom"?_a({x:l+u/2,y:c+d-m,textAnchor:"middle",verticalAnchor:p},T):s==="insideTopLeft"?_a({x:l+y,y:c+m,textAnchor:_,verticalAnchor:v},T):s==="insideTopRight"?_a({x:l+u-y,y:c+m,textAnchor:S,verticalAnchor:v},T):s==="insideBottomLeft"?_a({x:l+y,y:c+d-m,textAnchor:_,verticalAnchor:p},T):s==="insideBottomRight"?_a({x:l+u-y,y:c+d-m,textAnchor:S,verticalAnchor:p},T):o0(s)&&(tt(s.x)||Wf(s.x))&&(tt(s.y)||Wf(s.y))?_a({x:l+Os(s.x,u),y:c+Os(s.y,d),textAnchor:"end",verticalAnchor:"end"},T):_a({x:l+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},T)},lAe=function(t){return"cx"in t&&tt(t.cx)};function $a(e){var t=e.offset,r=t===void 0?5:t,n=Z3e(e,K3e),a=_a({offset:r},n),s=a.viewBox,i=a.position,l=a.value,c=a.children,u=a.content,d=a.className,f=d===void 0?"":d,m=a.textBreakAll;if(!s||rr(l)&&rr(c)&&!w.isValidElement(u)&&!er(u))return null;if(w.isValidElement(u))return w.cloneElement(u,a);var p;if(er(u)){if(p=w.createElement(u,a),w.isValidElement(p))return p}else p=nAe(a);var v=lAe(s),b=Ht(a,!0);if(v&&(i==="insideStart"||i==="insideEnd"||i==="end"))return sAe(a,p,b);var y=v?iAe(a):oAe(a);return ce.createElement(wh,Cy({className:ur("recharts-label",f)},b,y,{breakAll:m}),p)}$a.displayName="Label";var ple=function(t){var r=t.cx,n=t.cy,a=t.angle,s=t.startAngle,i=t.endAngle,l=t.r,c=t.radius,u=t.innerRadius,d=t.outerRadius,f=t.x,m=t.y,p=t.top,v=t.left,b=t.width,y=t.height,S=t.clockWise,_=t.labelViewBox;if(_)return _;if(tt(b)&&tt(y)){if(tt(f)&&tt(m))return{x:f,y:m,width:b,height:y};if(tt(p)&&tt(v))return{x:p,y:v,width:b,height:y}}return tt(f)&&tt(m)?{x:f,y:m,width:0,height:0}:tt(r)&&tt(n)?{cx:r,cy:n,startAngle:s||a||0,endAngle:i||a||0,innerRadius:u||0,outerRadius:d||c||l||0,clockWise:S}:t.viewBox?t.viewBox:{}},cAe=function(t,r){return t?t===!0?ce.createElement($a,{key:"label-implicit",viewBox:r}):ja(t)?ce.createElement($a,{key:"label-implicit",viewBox:r,value:t}):w.isValidElement(t)?t.type===$a?w.cloneElement(t,{key:"label-implicit",viewBox:r}):ce.createElement($a,{key:"label-implicit",content:t,viewBox:r}):er(t)?ce.createElement($a,{key:"label-implicit",content:t,viewBox:r}):o0(t)?ce.createElement($a,Cy({viewBox:r},t,{key:"label-implicit"})):null:null},uAe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,s=ple(t),i=Li(a,$a).map(function(c,u){return w.cloneElement(c,{viewBox:r||s,key:"label-".concat(u)})});if(!n)return i;var l=cAe(t.label,r||s);return[l].concat(G3e(i))};$a.parseViewBox=ple;$a.renderCallByParent=uAe;var VA,ZG;function dAe(){if(ZG)return VA;ZG=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return VA=e,VA}var fAe=dAe();const hAe=Ur(fAe);function jy(e){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jy(e)}var mAe=["valueAccessor"],pAe=["data","dataKey","clockWise","id","textBreakAll"];function gAe(e){return xAe(e)||yAe(e)||bAe(e)||vAe()}function vAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bAe(e,t){if(e){if(typeof e=="string")return _I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _I(e,t)}}function yAe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xAe(e){if(Array.isArray(e))return _I(e)}function _I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D_(){return D_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D_.apply(this,arguments)}function XG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XG(Object(r),!0).forEach(function(n){wAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wAe(e,t,r){return t=SAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SAe(e){var t=kAe(e,"string");return jy(t)=="symbol"?t:t+""}function kAe(e,t){if(jy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tV(e,t){if(e==null)return{};var r=_Ae(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Ae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var NAe=function(t){return Array.isArray(t.value)?hAe(t.value):t.value};function Zc(e){var t=e.valueAccessor,r=t===void 0?NAe:t,n=tV(e,mAe),a=n.data,s=n.dataKey,i=n.clockWise,l=n.id,c=n.textBreakAll,u=tV(n,pAe);return!a||!a.length?null:ce.createElement(Ir,{className:"recharts-label-list"},a.map(function(d,f){var m=rr(s)?r(d,f):Ca(d&&d.payload,s),p=rr(l)?{}:{id:"".concat(l,"-").concat(f)};return ce.createElement($a,D_({},Ht(d,!0),u,p,{parentViewBox:d.parentViewBox,value:m,textBreakAll:c,viewBox:$a.parseViewBox(rr(i)?d:eV(eV({},d),{},{clockWise:i})),key:"label-".concat(f),index:f}))}))}Zc.displayName="LabelList";function CAe(e,t){return e?e===!0?ce.createElement(Zc,{key:"labelList-implicit",data:t}):ce.isValidElement(e)||er(e)?ce.createElement(Zc,{key:"labelList-implicit",data:t,content:e}):o0(e)?ce.createElement(Zc,D_({data:t},e,{key:"labelList-implicit"})):null:null}function jAe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Li(n,Zc).map(function(i,l){return w.cloneElement(i,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var s=CAe(e.label,t);return[s].concat(gAe(a))}Zc.renderCallByParent=jAe;function Ey(e){"@babel/helpers - typeof";return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ey(e)}function NI(){return NI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NI.apply(this,arguments)}function rV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rV(Object(r),!0).forEach(function(n){EAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EAe(e,t,r){return t=MAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MAe(e){var t=TAe(e,"string");return Ey(t)=="symbol"?t:t+""}function TAe(e,t){if(Ey(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ey(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AAe=function(t,r){var n=Ls(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},sS=function(t){var r=t.cx,n=t.cy,a=t.radius,s=t.angle,i=t.sign,l=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,d=c*(l?1:-1)+a,f=Math.asin(c/d)/A_,m=u?s:s+i*f,p=xn(r,n,d,m),v=xn(r,n,a,m),b=u?s-i*f:s,y=xn(r,n,d*Math.cos(f*A_),b);return{center:p,circleTangency:v,lineTangency:y,theta:f}},gle=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,s=t.outerRadius,i=t.startAngle,l=t.endAngle,c=AAe(i,l),u=i+c,d=xn(r,n,s,i),f=xn(r,n,s,u),m="M ".concat(d.x,",").concat(d.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(i>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var p=xn(r,n,a,i),v=xn(r,n,a,u);m+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(i<=u),`,
            `).concat(p.x,",").concat(p.y," Z")}else m+="L ".concat(r,",").concat(n," Z");return m},DAe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,s=t.outerRadius,i=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,f=Ls(d-u),m=sS({cx:r,cy:n,radius:s,angle:u,sign:f,cornerRadius:i,cornerIsExternal:c}),p=m.circleTangency,v=m.lineTangency,b=m.theta,y=sS({cx:r,cy:n,radius:s,angle:d,sign:-f,cornerRadius:i,cornerIsExternal:c}),S=y.circleTangency,_=y.lineTangency,N=y.theta,k=c?Math.abs(u-d):Math.abs(u-d)-b-N;if(k<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):gle({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d});var j="M ".concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(k>180),",").concat(+(f<0),",").concat(S.x,",").concat(S.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(_.x,",").concat(_.y,`
  `);if(a>0){var E=sS({cx:r,cy:n,radius:a,angle:u,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),T=E.circleTangency,O=E.lineTangency,R=E.theta,H=sS({cx:r,cy:n,radius:a,angle:d,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),$=H.circleTangency,L=H.lineTangency,A=H.theta,M=c?Math.abs(u-d):Math.abs(u-d)-R-A;if(M<0&&i===0)return"".concat(j,"L").concat(r,",").concat(n,"Z");j+="L".concat(L.x,",").concat(L.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat($.x,",").concat($.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(M>180),",").concat(+(f>0),",").concat(T.x,",").concat(T.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(O.x,",").concat(O.y,"Z")}else j+="L".concat(r,",").concat(n,"Z");return j},LAe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},vle=function(t){var r=nV(nV({},LAe),t),n=r.cx,a=r.cy,s=r.innerRadius,i=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,f=r.endAngle,m=r.className;if(i<s||d===f)return null;var p=ur("recharts-sector",m),v=i-s,b=Os(l,v,0,!0),y;return b>0&&Math.abs(d-f)<360?y=DAe({cx:n,cy:a,innerRadius:s,outerRadius:i,cornerRadius:Math.min(b,v/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:f}):y=gle({cx:n,cy:a,innerRadius:s,outerRadius:i,startAngle:d,endAngle:f}),ce.createElement("path",NI({},Ht(r,!0),{className:p,d:y,role:"img"}))};function My(e){"@babel/helpers - typeof";return My=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},My(e)}function CI(){return CI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CI.apply(this,arguments)}function aV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aV(Object(r),!0).forEach(function(n){OAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OAe(e,t,r){return t=IAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IAe(e){var t=RAe(e,"string");return My(t)=="symbol"?t:t+""}function RAe(e,t){if(My(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(My(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iV={curveBasisClosed:JNe,curveBasisOpen:ZNe,curveBasis:QNe,curveBumpX:RNe,curveBumpY:PNe,curveLinearClosed:XNe,curveLinear:bj,curveMonotoneX:eCe,curveMonotoneY:tCe,curveNatural:rCe,curveStep:nCe,curveStepAfter:sCe,curveStepBefore:aCe},iS=function(t){return t.x===+t.x&&t.y===+t.y},kv=function(t){return t.x},_v=function(t){return t.y},PAe=function(t,r){if(er(t))return t;var n="curve".concat(gj(t));return(n==="curveMonotone"||n==="curveBump")&&r?iV["".concat(n).concat(r==="vertical"?"Y":"X")]:iV[n]||bj},zAe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,s=a===void 0?[]:a,i=t.baseLine,l=t.layout,c=t.connectNulls,u=c===void 0?!1:c,d=PAe(n,l),f=u?s.filter(function(b){return iS(b)}):s,m;if(Array.isArray(i)){var p=u?i.filter(function(b){return iS(b)}):i,v=f.map(function(b,y){return sV(sV({},b),{},{base:p[y]})});return l==="vertical"?m=Qw().y(_v).x1(kv).x0(function(b){return b.base.x}):m=Qw().x(kv).y1(_v).y0(function(b){return b.base.y}),m.defined(iS).curve(d),m(v)}return l==="vertical"&&tt(i)?m=Qw().y(_v).x1(kv).x0(i):tt(i)?m=Qw().x(kv).y1(_v).y0(i):m=hie().x(kv).y(_v),m.defined(iS).curve(d),m(f)},L_=function(t){var r=t.className,n=t.points,a=t.path,s=t.pathRef;if((!n||!n.length)&&!a)return null;var i=n&&n.length?zAe(t):a;return w.createElement("path",CI({},Ht(t,!1),s_(t),{className:ur("recharts-curve",r),d:i,ref:s}))},YA={exports:{}},QA,oV;function BAe(){if(oV)return QA;oV=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return QA=e,QA}var JA,lV;function $Ae(){if(lV)return JA;lV=1;var e=BAe();function t(){}function r(){}return r.resetWarningCache=t,JA=function(){function n(i,l,c,u,d,f){if(f!==e){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function a(){return n}var s={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:t};return s.PropTypes=s,s},JA}var cV;function FAe(){return cV||(cV=1,YA.exports=$Ae()()),YA.exports}var UAe=FAe();const Wr=Ur(UAe),{getOwnPropertyNames:HAe,getOwnPropertySymbols:qAe}=Object,{hasOwnProperty:WAe}=Object.prototype;function ZA(e,t){return function(n,a,s){return e(n,a,s)&&t(n,a,s)}}function oS(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);const{cache:s}=a,i=s.get(r),l=s.get(n);if(i&&l)return i===n&&l===r;s.set(r,n),s.set(n,r);const c=e(r,n,a);return s.delete(r),s.delete(n),c}}function KAe(e){return e?.[Symbol.toStringTag]}function uV(e){return HAe(e).concat(qAe(e))}const GAe=Object.hasOwn||((e,t)=>WAe.call(e,t));function Yh(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const VAe="__v",YAe="__o",QAe="_owner",{getOwnPropertyDescriptor:dV,keys:fV}=Object;function JAe(e,t){return e.byteLength===t.byteLength&&O_(new Uint8Array(e),new Uint8Array(t))}function ZAe(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function XAe(e,t){return e.byteLength===t.byteLength&&O_(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function eDe(e,t){return Yh(e.getTime(),t.getTime())}function tDe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function rDe(e,t){return e===t}function hV(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),s=e.entries();let i,l,c=0;for(;(i=s.next())&&!i.done;){const u=t.entries();let d=!1,f=0;for(;(l=u.next())&&!l.done;){if(a[f]){f++;continue}const m=i.value,p=l.value;if(r.equals(m[0],p[0],c,f,e,t,r)&&r.equals(m[1],p[1],m[0],p[0],e,t,r)){d=a[f]=!0;break}f++}if(!d)return!1;c++}return!0}const nDe=Yh;function aDe(e,t,r){const n=fV(e);let a=n.length;if(fV(t).length!==a)return!1;for(;a-- >0;)if(!ble(e,t,r,n[a]))return!1;return!0}function Nv(e,t,r){const n=uV(e);let a=n.length;if(uV(t).length!==a)return!1;let s,i,l;for(;a-- >0;)if(s=n[a],!ble(e,t,r,s)||(i=dV(e,s),l=dV(t,s),(i||l)&&(!i||!l||i.configurable!==l.configurable||i.enumerable!==l.enumerable||i.writable!==l.writable)))return!1;return!0}function sDe(e,t){return Yh(e.valueOf(),t.valueOf())}function iDe(e,t){return e.source===t.source&&e.flags===t.flags}function mV(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),s=e.values();let i,l;for(;(i=s.next())&&!i.done;){const c=t.values();let u=!1,d=0;for(;(l=c.next())&&!l.done;){if(!a[d]&&r.equals(i.value,l.value,i.value,l.value,e,t,r)){u=a[d]=!0;break}d++}if(!u)return!1}return!0}function O_(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function oDe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function ble(e,t,r,n){return(n===QAe||n===YAe||n===VAe)&&(e.$$typeof||t.$$typeof)?!0:GAe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const lDe="[object ArrayBuffer]",cDe="[object Arguments]",uDe="[object Boolean]",dDe="[object DataView]",fDe="[object Date]",hDe="[object Error]",mDe="[object Map]",pDe="[object Number]",gDe="[object Object]",vDe="[object RegExp]",bDe="[object Set]",yDe="[object String]",xDe={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},wDe="[object URL]",SDe=Object.prototype.toString;function kDe({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:s,areMapsEqual:i,areNumbersEqual:l,areObjectsEqual:c,arePrimitiveWrappersEqual:u,areRegExpsEqual:d,areSetsEqual:f,areTypedArraysEqual:m,areUrlsEqual:p,unknownTagComparators:v}){return function(y,S,_){if(y===S)return!0;if(y==null||S==null)return!1;const N=typeof y;if(N!==typeof S)return!1;if(N!=="object")return N==="number"?l(y,S,_):N==="function"?s(y,S,_):!1;const k=y.constructor;if(k!==S.constructor)return!1;if(k===Object)return c(y,S,_);if(Array.isArray(y))return t(y,S,_);if(k===Date)return n(y,S,_);if(k===RegExp)return d(y,S,_);if(k===Map)return i(y,S,_);if(k===Set)return f(y,S,_);const j=SDe.call(y);if(j===fDe)return n(y,S,_);if(j===vDe)return d(y,S,_);if(j===mDe)return i(y,S,_);if(j===bDe)return f(y,S,_);if(j===gDe)return typeof y.then!="function"&&typeof S.then!="function"&&c(y,S,_);if(j===wDe)return p(y,S,_);if(j===hDe)return a(y,S,_);if(j===cDe)return c(y,S,_);if(xDe[j])return m(y,S,_);if(j===lDe)return e(y,S,_);if(j===dDe)return r(y,S,_);if(j===uDe||j===pDe||j===yDe)return u(y,S,_);if(v){let E=v[j];if(!E){const T=KAe(y);T&&(E=v[T])}if(E)return E(y,S,_)}return!1}}function _De({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:JAe,areArraysEqual:r?Nv:ZAe,areDataViewsEqual:XAe,areDatesEqual:eDe,areErrorsEqual:tDe,areFunctionsEqual:rDe,areMapsEqual:r?ZA(hV,Nv):hV,areNumbersEqual:nDe,areObjectsEqual:r?Nv:aDe,arePrimitiveWrappersEqual:sDe,areRegExpsEqual:iDe,areSetsEqual:r?ZA(mV,Nv):mV,areTypedArraysEqual:r?ZA(O_,Nv):O_,areUrlsEqual:oDe,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const a=oS(n.areArraysEqual),s=oS(n.areMapsEqual),i=oS(n.areObjectsEqual),l=oS(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:s,areObjectsEqual:i,areSetsEqual:l})}return n}function NDe(e){return function(t,r,n,a,s,i,l){return e(t,r,l)}}function CDe({circular:e,comparator:t,createState:r,equals:n,strict:a}){if(r)return function(l,c){const{cache:u=e?new WeakMap:void 0,meta:d}=r();return t(l,c,{cache:u,equals:n,meta:d,strict:a})};if(e)return function(l,c){return t(l,c,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const s={cache:void 0,equals:n,meta:void 0,strict:a};return function(l,c){return t(l,c,s)}}const yle=Hd();Hd({strict:!0});Hd({circular:!0});Hd({circular:!0,strict:!0});Hd({createInternalComparator:()=>Yh});Hd({strict:!0,createInternalComparator:()=>Yh});Hd({circular:!0,createInternalComparator:()=>Yh});Hd({circular:!0,createInternalComparator:()=>Yh,strict:!0});function Hd(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:a=!1}=e,s=_De(e),i=kDe(s),l=r?r(i):NDe(i);return CDe({circular:t,comparator:i,createState:n,equals:l,strict:a})}function jDe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function pV(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(s){r<0&&(r=s),s-r>t?(e(s),r=-1):jDe(a)};requestAnimationFrame(n)}function jI(e){"@babel/helpers - typeof";return jI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jI(e)}function EDe(e){return DDe(e)||ADe(e)||TDe(e)||MDe()}function MDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TDe(e,t){if(e){if(typeof e=="string")return gV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gV(e,t)}}function gV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ADe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function DDe(e){if(Array.isArray(e))return e}function LDe(){var e={},t=function(){return null},r=!1,n=function a(s){if(!r){if(Array.isArray(s)){if(!s.length)return;var i=s,l=EDe(i),c=l[0],u=l.slice(1);if(typeof c=="number"){pV(a.bind(null,u),c);return}a(c),pV(a.bind(null,u));return}jI(s)==="object"&&(e=s,t(e)),typeof s=="function"&&s()}};return{stop:function(){r=!0},start:function(s){r=!1,n(s)},subscribe:function(s){return t=s,function(){t=function(){return null}}}}}function Ty(e){"@babel/helpers - typeof";return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function vV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vV(Object(r),!0).forEach(function(n){xle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xle(e,t,r){return t=ODe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ODe(e){var t=IDe(e,"string");return Ty(t)==="symbol"?t:String(t)}function IDe(e,t){if(Ty(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ty(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RDe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(s){return a.includes(s)})})},PDe=function(t){return t},zDe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Tb=function(t,r){return Object.keys(r).reduce(function(n,a){return bV(bV({},n),{},xle({},a,t(a,r[a])))},{})},yV=function(t,r,n){return t.map(function(a){return"".concat(zDe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function BDe(e,t){return UDe(e)||FDe(e,t)||wle(e,t)||$De()}function $De(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function UDe(e){if(Array.isArray(e))return e}function HDe(e){return KDe(e)||WDe(e)||wle(e)||qDe()}function qDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wle(e,t){if(e){if(typeof e=="string")return EI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EI(e,t)}}function WDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KDe(e){if(Array.isArray(e))return EI(e)}function EI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I_=1e-4,Sle=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},kle=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},xV=function(t,r){return function(n){var a=Sle(t,r);return kle(a,n)}},GDe=function(t,r){return function(n){var a=Sle(t,r),s=[].concat(HDe(a.map(function(i,l){return i*l}).slice(1)),[0]);return kle(s,n)}},wV=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],s=r[1],i=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,s=0,i=1,l=1;break;case"ease":a=.25,s=.1,i=.25,l=1;break;case"ease-in":a=.42,s=0,i=1,l=1;break;case"ease-out":a=.42,s=0,i=.58,l=1;break;case"ease-in-out":a=0,s=0,i=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),d=BDe(u,4);a=d[0],s=d[1],i=d[2],l=d[3]}}}var f=xV(a,i),m=xV(s,l),p=GDe(a,i),v=function(S){return S>1?1:S<0?0:S},b=function(S){for(var _=S>1?1:S,N=_,k=0;k<8;++k){var j=f(N)-_,E=p(N);if(Math.abs(j-_)<I_||E<I_)return m(N);N=v(N-j/E)}return m(N)};return b.isStepper=!1,b},VDe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,s=a===void 0?8:a,i=t.dt,l=i===void 0?17:i,c=function(d,f,m){var p=-(d-f)*n,v=m*s,b=m+(p-v)*l/1e3,y=m*l/1e3+d;return Math.abs(y-f)<I_&&Math.abs(b)<I_?[f,0]:[y,b]};return c.isStepper=!0,c.dt=l,c},YDe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return wV(a);case"spring":return VDe();default:if(a.split("(")[0]==="cubic-bezier")return wV(a)}return typeof a=="function"?a:null};function Ay(e){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function SV(e){return ZDe(e)||JDe(e)||_le(e)||QDe()}function QDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ZDe(e){if(Array.isArray(e))return TI(e)}function kV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kV(Object(r),!0).forEach(function(n){MI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MI(e,t,r){return t=XDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XDe(e){var t=eLe(e,"string");return Ay(t)==="symbol"?t:String(t)}function eLe(e,t){if(Ay(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ay(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tLe(e,t){return aLe(e)||nLe(e,t)||_le(e,t)||rLe()}function rLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _le(e,t){if(e){if(typeof e=="string")return TI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TI(e,t)}}function TI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function aLe(e){if(Array.isArray(e))return e}var R_=function(t,r,n){return t+(r-t)*n},AI=function(t){var r=t.from,n=t.to;return r!==n},sLe=function e(t,r,n){var a=Tb(function(s,i){if(AI(i)){var l=t(i.from,i.to,i.velocity),c=tLe(l,2),u=c[0],d=c[1];return rs(rs({},i),{},{from:u,velocity:d})}return i},r);return n<1?Tb(function(s,i){return AI(i)?rs(rs({},i),{},{velocity:R_(i.velocity,a[s].velocity,n),from:R_(i.from,a[s].from,n)}):i},r):e(t,a,n-1)};const iLe=(function(e,t,r,n,a){var s=RDe(e,t),i=s.reduce(function(y,S){return rs(rs({},y),{},MI({},S,[e[S],t[S]]))},{}),l=s.reduce(function(y,S){return rs(rs({},y),{},MI({},S,{from:e[S],velocity:0,to:t[S]}))},{}),c=-1,u,d,f=function(){return null},m=function(){return Tb(function(S,_){return _.from},l)},p=function(){return!Object.values(l).filter(AI).length},v=function(S){u||(u=S);var _=S-u,N=_/r.dt;l=sLe(r,l,N),a(rs(rs(rs({},e),t),m())),u=S,p()||(c=requestAnimationFrame(f))},b=function(S){d||(d=S);var _=(S-d)/n,N=Tb(function(j,E){return R_.apply(void 0,SV(E).concat([r(_)]))},i);if(a(rs(rs(rs({},e),t),N)),_<1)c=requestAnimationFrame(f);else{var k=Tb(function(j,E){return R_.apply(void 0,SV(E).concat([r(1)]))},i);a(rs(rs(rs({},e),t),k))}};return f=r.isStepper?v:b,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}});function ig(e){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}var oLe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function lLe(e,t){if(e==null)return{};var r=cLe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cLe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function XA(e){return hLe(e)||fLe(e)||dLe(e)||uLe()}function uLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dLe(e,t){if(e){if(typeof e=="string")return DI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DI(e,t)}}function fLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hLe(e){if(Array.isArray(e))return DI(e)}function DI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_V(Object(r),!0).forEach(function(n){db(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_V(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function db(e,t,r){return t=Nle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nle(n.key),n)}}function gLe(e,t,r){return t&&pLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nle(e){var t=vLe(e,"string");return ig(t)==="symbol"?t:String(t)}function vLe(e,t){if(ig(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ig(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LI(e,t)}function LI(e,t){return LI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},LI(e,t)}function yLe(e){var t=xLe();return function(){var n=P_(e),a;if(t){var s=P_(this).constructor;a=Reflect.construct(n,arguments,s)}else a=n.apply(this,arguments);return OI(this,a)}}function OI(e,t){if(t&&(ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return II(e)}function II(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P_(e){return P_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},P_(e)}var Ol=(function(e){bLe(r,e);var t=yLe(r);function r(n,a){var s;mLe(this,r),s=t.call(this,n,a);var i=s.props,l=i.isActive,c=i.attributeName,u=i.from,d=i.to,f=i.steps,m=i.children,p=i.duration;if(s.handleStyleChange=s.handleStyleChange.bind(II(s)),s.changeStyle=s.changeStyle.bind(II(s)),!l||p<=0)return s.state={style:{}},typeof m=="function"&&(s.state={style:d}),OI(s);if(f&&f.length)s.state={style:f[0].style};else if(u){if(typeof m=="function")return s.state={style:u},OI(s);s.state={style:c?db({},c,u):u}}else s.state={style:{}};return s}return gLe(r,[{key:"componentDidMount",value:function(){var a=this.props,s=a.isActive,i=a.canBegin;this.mounted=!0,!(!s||!i)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var s=this.props,i=s.isActive,l=s.canBegin,c=s.attributeName,u=s.shouldReAnimate,d=s.to,f=s.from,m=this.state.style;if(l){if(!i){var p={style:c?db({},c,d):d};this.state&&m&&(c&&m[c]!==d||!c&&m!==d)&&this.setState(p);return}if(!(yle(a.to,d)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var b=v||u?f:a.to;if(this.state&&m){var y={style:c?db({},c,b):b};(c&&m[c]!==b||!c&&m!==b)&&this.setState(y)}this.runAnimation(Lo(Lo({},this.props),{},{from:b,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var s=this,i=a.from,l=a.to,c=a.duration,u=a.easing,d=a.begin,f=a.onAnimationEnd,m=a.onAnimationStart,p=iLe(i,l,YDe(u),c,this.changeStyle),v=function(){s.stopJSAnimation=p()};this.manager.start([m,d,v,c,f])}},{key:"runStepAnimation",value:function(a){var s=this,i=a.steps,l=a.begin,c=a.onAnimationStart,u=i[0],d=u.style,f=u.duration,m=f===void 0?0:f,p=function(b,y,S){if(S===0)return b;var _=y.duration,N=y.easing,k=N===void 0?"ease":N,j=y.style,E=y.properties,T=y.onAnimationEnd,O=S>0?i[S-1]:y,R=E||Object.keys(j);if(typeof k=="function"||k==="spring")return[].concat(XA(b),[s.runJSAnimation.bind(s,{from:O.style,to:j,duration:_,easing:k}),_]);var H=yV(R,_,k),$=Lo(Lo(Lo({},O.style),j),{},{transition:H});return[].concat(XA(b),[$,_,T]).filter(PDe)};return this.manager.start([c].concat(XA(i.reduce(p,[d,Math.max(m,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=LDe());var s=a.begin,i=a.duration,l=a.attributeName,c=a.to,u=a.easing,d=a.onAnimationStart,f=a.onAnimationEnd,m=a.steps,p=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof u=="function"||typeof p=="function"||u==="spring"){this.runJSAnimation(a);return}if(m.length>1){this.runStepAnimation(a);return}var b=l?db({},l,c):c,y=yV(Object.keys(b),i,u);v.start([d,s,Lo(Lo({},b),{},{transition:y}),i,f])}},{key:"render",value:function(){var a=this.props,s=a.children;a.begin;var i=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=lLe(a,oLe),u=w.Children.count(s),d=this.state.style;if(typeof s=="function")return s(d);if(!l||u===0||i<=0)return s;var f=function(p){var v=p.props,b=v.style,y=b===void 0?{}:b,S=v.className,_=w.cloneElement(p,Lo(Lo({},c),{},{style:Lo(Lo({},y),d),className:S}));return _};return u===1?f(w.Children.only(s)):ce.createElement("div",null,w.Children.map(s,function(m){return f(m)}))}}]),r})(w.PureComponent);Ol.displayName="Animate";Ol.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ol.propTypes={from:Wr.oneOfType([Wr.object,Wr.string]),to:Wr.oneOfType([Wr.object,Wr.string]),attributeName:Wr.string,duration:Wr.number,begin:Wr.number,easing:Wr.oneOfType([Wr.string,Wr.func]),steps:Wr.arrayOf(Wr.shape({duration:Wr.number.isRequired,style:Wr.object.isRequired,easing:Wr.oneOfType([Wr.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Wr.func]),properties:Wr.arrayOf("string"),onAnimationEnd:Wr.func})),children:Wr.oneOfType([Wr.node,Wr.func]),isActive:Wr.bool,canBegin:Wr.bool,onAnimationEnd:Wr.func,shouldReAnimate:Wr.bool,onAnimationStart:Wr.func,onAnimationReStart:Wr.func};function RI(){return RI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RI.apply(null,arguments)}function PI(e,t){return PI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},PI(e,t)}function wLe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,PI(e,t)}function NV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dy(e){"@babel/helpers - typeof";return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dy(e)}function z_(){return z_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z_.apply(this,arguments)}function SLe(e,t){return CLe(e)||NLe(e,t)||_Le(e,t)||kLe()}function kLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Le(e,t){if(e){if(typeof e=="string")return CV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CV(e,t)}}function CV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function CLe(e){if(Array.isArray(e))return e}function jV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jV(Object(r),!0).forEach(function(n){jLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jLe(e,t,r){return t=ELe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ELe(e){var t=MLe(e,"string");return Dy(t)=="symbol"?t:t+""}function MLe(e,t){if(Dy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MV=function(t,r,n,a,s){var i=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,d;if(i>0&&s instanceof Array){for(var f=[0,0,0,0],m=0,p=4;m<p;m++)f[m]=s[m]>i?i:s[m];d="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(t+c*f[0],",").concat(r)),d+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+l*f[1])),d+="L ".concat(t+n,",").concat(r+a-l*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(t+n-c*f[2],",").concat(r+a)),d+="L ".concat(t+c*f[3],",").concat(r+a),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-l*f[3])),d+="Z"}else if(i>0&&s===+s&&s>0){var v=Math.min(i,s);d="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+a-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n-c*v,",").concat(r+a,`
            L `).concat(t+c*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t,",").concat(r+a-l*v," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return d},TLe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,s=r.x,i=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(s,s+l),d=Math.max(s,s+l),f=Math.min(i,i+c),m=Math.max(i,i+c);return n>=u&&n<=d&&a>=f&&a<=m}return!1},ALe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Kz=function(t){var r=EV(EV({},ALe),t),n=w.useRef(),a=w.useState(-1),s=SLe(a,2),i=s[0],l=s[1];w.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var k=n.current.getTotalLength();k&&l(k)}catch{}},[]);var c=r.x,u=r.y,d=r.width,f=r.height,m=r.radius,p=r.className,v=r.animationEasing,b=r.animationDuration,y=r.animationBegin,S=r.isAnimationActive,_=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var N=ur("recharts-rectangle",p);return _?ce.createElement(Ol,{canBegin:i>0,from:{width:d,height:f,x:c,y:u},to:{width:d,height:f,x:c,y:u},duration:b,animationEasing:v,isActive:_},function(k){var j=k.width,E=k.height,T=k.x,O=k.y;return ce.createElement(Ol,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:b,isActive:S,easing:v},ce.createElement("path",z_({},Ht(r,!0),{className:N,d:MV(T,O,j,E,m),ref:n})))}):ce.createElement("path",z_({},Ht(r,!0),{className:N,d:MV(c,u,d,f,m)}))},DLe=["points","className","baseLinePoints","connectNulls"];function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_p.apply(this,arguments)}function LLe(e,t){if(e==null)return{};var r=OLe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function OLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function TV(e){return zLe(e)||PLe(e)||RLe(e)||ILe()}function ILe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RLe(e,t){if(e){if(typeof e=="string")return zI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zI(e,t)}}function PLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zLe(e){if(Array.isArray(e))return zI(e)}function zI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var AV=function(t){return t&&t.x===+t.x&&t.y===+t.y},BLe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){AV(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),AV(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Ab=function(t,r){var n=BLe(t);r&&(n=[n.reduce(function(s,i){return[].concat(TV(s),TV(i))},[])]);var a=n.map(function(s){return s.reduce(function(i,l,c){return"".concat(i).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},$Le=function(t,r,n){var a=Ab(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Ab(r.reverse(),n).slice(1))},FLe=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,s=t.connectNulls,i=LLe(t,DLe);if(!r||!r.length)return null;var l=ur("recharts-polygon",n);if(a&&a.length){var c=i.stroke&&i.stroke!=="none",u=$Le(r,a,s);return ce.createElement("g",{className:l},ce.createElement("path",_p({},Ht(i,!0),{fill:u.slice(-1)==="Z"?i.fill:"none",stroke:"none",d:u})),c?ce.createElement("path",_p({},Ht(i,!0),{fill:"none",d:Ab(r,s)})):null,c?ce.createElement("path",_p({},Ht(i,!0),{fill:"none",d:Ab(a,s)})):null)}var d=Ab(r,s);return ce.createElement("path",_p({},Ht(i,!0),{fill:d.slice(-1)==="Z"?i.fill:"none",className:l,d}))};function BI(){return BI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BI.apply(this,arguments)}var Ij=function(t){var r=t.cx,n=t.cy,a=t.r,s=t.className,i=ur("recharts-dot",s);return r===+r&&n===+n&&a===+a?w.createElement("circle",BI({},Ht(t,!1),s_(t),{className:i,cx:r,cy:n,r:a})):null};function Ly(e){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ly(e)}var ULe=["x","y","top","left","width","height","className"];function $I(){return $I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$I.apply(this,arguments)}function DV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function HLe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DV(Object(r),!0).forEach(function(n){qLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qLe(e,t,r){return t=WLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WLe(e){var t=KLe(e,"string");return Ly(t)=="symbol"?t:t+""}function KLe(e,t){if(Ly(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ly(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GLe(e,t){if(e==null)return{};var r=VLe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var YLe=function(t,r,n,a,s,i){return"M".concat(t,",").concat(s,"v").concat(a,"M").concat(i,",").concat(r,"h").concat(n)},QLe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,s=a===void 0?0:a,i=t.top,l=i===void 0?0:i,c=t.left,u=c===void 0?0:c,d=t.width,f=d===void 0?0:d,m=t.height,p=m===void 0?0:m,v=t.className,b=GLe(t,ULe),y=HLe({x:n,y:s,top:l,left:u,width:f,height:p},b);return!tt(n)||!tt(s)||!tt(f)||!tt(p)||!tt(l)||!tt(u)?null:ce.createElement("path",$I({},Ht(y,!0),{className:ur("recharts-cross",v),d:YLe(n,s,f,p,l,u)}))},eD,LV;function JLe(){if(LV)return eD;LV=1;var e=Tj(),t=Boe(),r=ql();function n(a,s){return a&&a.length?e(a,r(s,2),t):void 0}return eD=n,eD}var ZLe=JLe();const XLe=Ur(ZLe);var tD,OV;function eOe(){if(OV)return tD;OV=1;var e=Tj(),t=ql(),r=$oe();function n(a,s){return a&&a.length?e(a,t(s,2),r):void 0}return tD=n,tD}var tOe=eOe();const rOe=Ur(tOe);var nOe=["cx","cy","angle","ticks","axisLine"],aOe=["ticks","tick","angle","tickFormatter","stroke"];function og(e){"@babel/helpers - typeof";return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(e)}function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Db.apply(this,arguments)}function IV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IV(Object(r),!0).forEach(function(n){Rj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RV(e,t){if(e==null)return{};var r=sOe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function sOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function iOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jle(n.key),n)}}function oOe(e,t,r){return t&&PV(e.prototype,t),r&&PV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lOe(e,t,r){return t=B_(t),cOe(e,Cle()?Reflect.construct(t,r||[],B_(e).constructor):t.apply(e,r))}function cOe(e,t){if(t&&(og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uOe(e)}function uOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Cle=function(){return!!e})()}function B_(e){return B_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},B_(e)}function dOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FI(e,t)}function FI(e,t){return FI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},FI(e,t)}function Rj(e,t,r){return t=jle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jle(e){var t=fOe(e,"string");return og(t)=="symbol"?t:t+""}function fOe(e,t){if(og(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(og(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pj=(function(e){function t(){return iOe(this,t),lOe(this,t,arguments)}return dOe(t,e),oOe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,s=this.props,i=s.angle,l=s.cx,c=s.cy;return xn(l,c,a,i)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,s=n.cy,i=n.angle,l=n.ticks,c=XLe(l,function(d){return d.coordinate||0}),u=rOe(l,function(d){return d.coordinate||0});return{cx:a,cy:s,startAngle:i,endAngle:i,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,s=n.cy,i=n.angle,l=n.ticks,c=n.axisLine,u=RV(n,nOe),d=l.reduce(function(v,b){return[Math.min(v[0],b.coordinate),Math.max(v[1],b.coordinate)]},[1/0,-1/0]),f=xn(a,s,d[0],i),m=xn(a,s,d[1],i),p=pf(pf(pf({},Ht(u,!1)),{},{fill:"none"},Ht(c,!1)),{},{x1:f.x,y1:f.y,x2:m.x,y2:m.y});return ce.createElement("line",Db({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var n=this,a=this.props,s=a.ticks,i=a.tick,l=a.angle,c=a.tickFormatter,u=a.stroke,d=RV(a,aOe),f=this.getTickTextAnchor(),m=Ht(d,!1),p=Ht(i,!1),v=s.map(function(b,y){var S=n.getTickValueCoord(b),_=pf(pf(pf(pf({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(S.x,", ").concat(S.y,")")},m),{},{stroke:"none",fill:u},p),{},{index:y},S),{},{payload:b});return ce.createElement(Ir,Db({className:ur("recharts-polar-radius-axis-tick",mle(i)),key:"tick-".concat(b.coordinate)},xh(n.props,b,y)),t.renderTickItem(i,_,c?c(b.value,y):b.value))});return ce.createElement(Ir,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,a=n.ticks,s=n.axisLine,i=n.tick;return!a||!a.length?null:ce.createElement(Ir,{className:ur("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),i&&this.renderTicks(),$a.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,s){var i;return ce.isValidElement(n)?i=ce.cloneElement(n,a):er(n)?i=n(a):i=ce.createElement(wh,Db({},a,{className:"recharts-polar-radius-axis-tick-value"}),s),i}}])})(w.PureComponent);Rj(Pj,"displayName","PolarRadiusAxis");Rj(Pj,"axisType","radiusAxis");Rj(Pj,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function lg(e){"@babel/helpers - typeof";return lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lg(e)}function Uf(){return Uf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uf.apply(this,arguments)}function zV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zV(Object(r),!0).forEach(function(n){zj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mle(n.key),n)}}function mOe(e,t,r){return t&&BV(e.prototype,t),r&&BV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pOe(e,t,r){return t=$_(t),gOe(e,Ele()?Reflect.construct(t,r||[],$_(e).constructor):t.apply(e,r))}function gOe(e,t){if(t&&(lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vOe(e)}function vOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ele(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ele=function(){return!!e})()}function $_(e){return $_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$_(e)}function bOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UI(e,t)}function UI(e,t){return UI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},UI(e,t)}function zj(e,t,r){return t=Mle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mle(e){var t=yOe(e,"string");return lg(t)=="symbol"?t:t+""}function yOe(e,t){if(lg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(lg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xOe=Math.PI/180,$V=1e-5,Bj=(function(e){function t(){return hOe(this,t),pOe(this,t,arguments)}return bOe(t,e),mOe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,s=a.cx,i=a.cy,l=a.radius,c=a.orientation,u=a.tickSize,d=u||8,f=xn(s,i,l,n.coordinate),m=xn(s,i,l+(c==="inner"?-1:1)*d,n.coordinate);return{x1:f.x,y1:f.y,x2:m.x,y2:m.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,s=Math.cos(-n.coordinate*xOe),i;return s>$V?i=a==="outer"?"start":"end":s<-$V?i=a==="outer"?"end":"start":i="middle",i}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,s=n.cy,i=n.radius,l=n.axisLine,c=n.axisLineType,u=gf(gf({},Ht(this.props,!1)),{},{fill:"none"},Ht(l,!1));if(c==="circle")return ce.createElement(Ij,Uf({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:s,r:i}));var d=this.props.ticks,f=d.map(function(m){return xn(a,s,i,m.coordinate)});return ce.createElement(FLe,Uf({className:"recharts-polar-angle-axis-line"},u,{points:f}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,s=a.ticks,i=a.tick,l=a.tickLine,c=a.tickFormatter,u=a.stroke,d=Ht(this.props,!1),f=Ht(i,!1),m=gf(gf({},d),{},{fill:"none"},Ht(l,!1)),p=s.map(function(v,b){var y=n.getTickLineCoord(v),S=n.getTickTextAnchor(v),_=gf(gf(gf({textAnchor:S},d),{},{stroke:"none",fill:u},f),{},{index:b,payload:v,x:y.x2,y:y.y2});return ce.createElement(Ir,Uf({className:ur("recharts-polar-angle-axis-tick",mle(i)),key:"tick-".concat(v.coordinate)},xh(n.props,v,b)),l&&ce.createElement("line",Uf({className:"recharts-polar-angle-axis-tick-line"},m,y)),i&&t.renderTickItem(i,_,c?c(v.value,b):v.value))});return ce.createElement(Ir,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var n=this.props,a=n.ticks,s=n.radius,i=n.axisLine;return s<=0||!a||!a.length?null:ce.createElement(Ir,{className:ur("recharts-polar-angle-axis",this.props.className)},i&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,s){var i;return ce.isValidElement(n)?i=ce.cloneElement(n,a):er(n)?i=n(a):i=ce.createElement(wh,Uf({},a,{className:"recharts-polar-angle-axis-tick-value"}),s),i}}])})(w.PureComponent);zj(Bj,"displayName","PolarAngleAxis");zj(Bj,"axisType","angleAxis");zj(Bj,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var rD,FV;function wOe(){if(FV)return rD;FV=1;var e=Rie(),t=e(Object.getPrototypeOf,Object);return rD=t,rD}var nD,UV;function SOe(){if(UV)return nD;UV=1;var e=fu(),t=wOe(),r=hu(),n="[object Object]",a=Function.prototype,s=Object.prototype,i=a.toString,l=s.hasOwnProperty,c=i.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var f=t(d);if(f===null)return!0;var m=l.call(f,"constructor")&&f.constructor;return typeof m=="function"&&m instanceof m&&i.call(m)==c}return nD=u,nD}var kOe=SOe();const _Oe=Ur(kOe);var aD,HV;function NOe(){if(HV)return aD;HV=1;var e=fu(),t=hu(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return aD=n,aD}var COe=NOe();const jOe=Ur(COe);function Oy(e){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(e)}function F_(){return F_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F_.apply(this,arguments)}function EOe(e,t){return DOe(e)||AOe(e,t)||TOe(e,t)||MOe()}function MOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TOe(e,t){if(e){if(typeof e=="string")return qV(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qV(e,t)}}function qV(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AOe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function DOe(e){if(Array.isArray(e))return e}function WV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WV(Object(r),!0).forEach(function(n){LOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LOe(e,t,r){return t=OOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OOe(e){var t=IOe(e,"string");return Oy(t)=="symbol"?t:t+""}function IOe(e,t){if(Oy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Oy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GV=function(t,r,n,a,s){var i=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-i/2,",").concat(r+s),l+="L ".concat(t+n-i/2-a,",").concat(r+s),l+="L ".concat(t,",").concat(r," Z"),l},ROe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},POe=function(t){var r=KV(KV({},ROe),t),n=w.useRef(),a=w.useState(-1),s=EOe(a,2),i=s[0],l=s[1];w.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var N=n.current.getTotalLength();N&&l(N)}catch{}},[]);var c=r.x,u=r.y,d=r.upperWidth,f=r.lowerWidth,m=r.height,p=r.className,v=r.animationEasing,b=r.animationDuration,y=r.animationBegin,S=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||m!==+m||d===0&&f===0||m===0)return null;var _=ur("recharts-trapezoid",p);return S?ce.createElement(Ol,{canBegin:i>0,from:{upperWidth:0,lowerWidth:0,height:m,x:c,y:u},to:{upperWidth:d,lowerWidth:f,height:m,x:c,y:u},duration:b,animationEasing:v,isActive:S},function(N){var k=N.upperWidth,j=N.lowerWidth,E=N.height,T=N.x,O=N.y;return ce.createElement(Ol,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:b,easing:v},ce.createElement("path",F_({},Ht(r,!0),{className:_,d:GV(T,O,k,j,E),ref:n})))}):ce.createElement("g",null,ce.createElement("path",F_({},Ht(r,!0),{className:_,d:GV(c,u,d,f,m)})))},zOe=["option","shapeType","propTransformer","activeClassName","isActive"];function Iy(e){"@babel/helpers - typeof";return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}function BOe(e,t){if(e==null)return{};var r=$Oe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Oe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function VV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VV(Object(r),!0).forEach(function(n){FOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FOe(e,t,r){return t=UOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UOe(e){var t=HOe(e,"string");return Iy(t)=="symbol"?t:t+""}function HOe(e,t){if(Iy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Iy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qOe(e,t){return U_(U_({},t),e)}function WOe(e,t){return e==="symbols"}function YV(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return ce.createElement(Kz,r);case"trapezoid":return ce.createElement(POe,r);case"sector":return ce.createElement(vle,r);case"symbols":if(WOe(t))return ce.createElement(dz,r);break;default:return null}}function KOe(e){return w.isValidElement(e)?e.props:e}function Tle(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?qOe:n,s=e.activeClassName,i=s===void 0?"recharts-active-shape":s,l=e.isActive,c=BOe(e,zOe),u;if(w.isValidElement(t))u=w.cloneElement(t,U_(U_({},c),KOe(t)));else if(er(t))u=t(c);else if(_Oe(t)&&!jOe(t)){var d=a(t,c);u=ce.createElement(YV,{shapeType:r,elementProps:d})}else{var f=c;u=ce.createElement(YV,{shapeType:r,elementProps:f})}return l?ce.createElement(Ir,{className:i},u):u}function $j(e,t){return t!=null&&"trapezoids"in e.props}function Fj(e,t){return t!=null&&"sectors"in e.props}function Ry(e,t){return t!=null&&"points"in e.props}function GOe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,s=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&s}function VOe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function YOe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function QOe(e,t){var r;return $j(e,t)?r=GOe:Fj(e,t)?r=VOe:Ry(e,t)&&(r=YOe),r}function JOe(e,t){var r;return $j(e,t)?r="trapezoids":Fj(e,t)?r="sectors":Ry(e,t)&&(r="points"),r}function ZOe(e,t){if($j(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Fj(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Ry(e,t)?t.payload:{}}function XOe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=JOe(r,t),s=ZOe(r,t),i=n.filter(function(c,u){var d=Jx(s,c),f=r.props[a].filter(function(v){var b=QOe(r,t);return b(v,t)}),m=r.props[a].indexOf(f[f.length-1]),p=u===m;return d&&p}),l=n.indexOf(i[i.length-1]);return l}var yk;function cg(e){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cg(e)}function Np(){return Np=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Np.apply(this,arguments)}function QV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QV(Object(r),!0).forEach(function(n){go(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QV(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dle(n.key),n)}}function tIe(e,t,r){return t&&JV(e.prototype,t),r&&JV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rIe(e,t,r){return t=H_(t),nIe(e,Ale()?Reflect.construct(t,r||[],H_(e).constructor):t.apply(e,r))}function nIe(e,t){if(t&&(cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aIe(e)}function aIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ale(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ale=function(){return!!e})()}function H_(e){return H_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},H_(e)}function sIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},HI(e,t)}function go(e,t,r){return t=Dle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dle(e){var t=iIe(e,"string");return cg(t)=="symbol"?t:t+""}function iIe(e,t){if(cg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pu=(function(e){function t(r){var n;return eIe(this,t),n=rIe(this,t,[r]),go(n,"pieRef",null),go(n,"sectorRefs",[]),go(n,"id",l0("recharts-pie-")),go(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),er(a)&&a()}),go(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),er(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return sIe(t,e),tIe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var s=this.props,i=s.label,l=s.labelLine,c=s.dataKey,u=s.valueKey,d=Ht(this.props,!1),f=Ht(i,!1),m=Ht(l,!1),p=i&&i.offsetRadius||20,v=n.map(function(b,y){var S=(b.startAngle+b.endAngle)/2,_=xn(b.cx,b.cy,b.outerRadius+p,S),N=bn(bn(bn(bn({},d),b),{},{stroke:"none"},f),{},{index:y,textAnchor:t.getTextAnchor(_.x,b.cx)},_),k=bn(bn(bn(bn({},d),b),{},{fill:"none",stroke:b.fill},m),{},{index:y,points:[xn(b.cx,b.cy,b.outerRadius,S),_]}),j=c;return rr(c)&&rr(u)?j="value":rr(c)&&(j=u),ce.createElement(Ir,{key:"label-".concat(b.startAngle,"-").concat(b.endAngle,"-").concat(b.midAngle,"-").concat(y)},l&&t.renderLabelLineItem(l,k,"line"),t.renderLabelItem(i,N,Ca(b,j)))});return ce.createElement(Ir,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var a=this,s=this.props,i=s.activeShape,l=s.blendStroke,c=s.inactiveShape;return n.map(function(u,d){if(u?.startAngle===0&&u?.endAngle===0&&n.length!==1)return null;var f=a.isActiveIndex(d),m=c&&a.hasActiveIndex()?c:null,p=f?i:m,v=bn(bn({},u),{},{stroke:l?u.fill:u.stroke,tabIndex:-1});return ce.createElement(Ir,Np({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},xh(a.props,u,d),{key:"sector-".concat(u?.startAngle,"-").concat(u?.endAngle,"-").concat(u.midAngle,"-").concat(d)}),ce.createElement(Tle,Np({option:p,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,s=a.sectors,i=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,u=a.animationEasing,d=a.animationId,f=this.state,m=f.prevSectors,p=f.prevIsAnimationActive;return ce.createElement(Ol,{begin:l,duration:c,isActive:i,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var b=v.t,y=[],S=s&&s[0],_=S.startAngle;return s.forEach(function(N,k){var j=m&&m[k],E=k>0?Di(N,"paddingAngle",0):0;if(j){var T=ji(j.endAngle-j.startAngle,N.endAngle-N.startAngle),O=bn(bn({},N),{},{startAngle:_+E,endAngle:_+T(b)+E});y.push(O),_=O.endAngle}else{var R=N.endAngle,H=N.startAngle,$=ji(0,R-H),L=$(b),A=bn(bn({},N),{},{startAngle:_+E,endAngle:_+L+E});y.push(A),_=A.endAngle}}),ce.createElement(Ir,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var i=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"ArrowRight":{var l=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[l].focus(),a.setState({sectorToFocus:l});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,s=n.isAnimationActive,i=this.state.prevSectors;return s&&a&&a.length&&(!i||!Jx(i,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,s=a.hide,i=a.sectors,l=a.className,c=a.label,u=a.cx,d=a.cy,f=a.innerRadius,m=a.outerRadius,p=a.isAnimationActive,v=this.state.isAnimationFinished;if(s||!i||!i.length||!tt(u)||!tt(d)||!tt(f)||!tt(m))return null;var b=ur("recharts-pie",l);return ce.createElement(Ir,{tabIndex:this.props.rootTabIndex,className:b,ref:function(S){n.pieRef=S}},this.renderSectors(),c&&this.renderLabels(i),$a.renderCallByParent(this.props,null,!1),(!p||v)&&Zc.renderCallByParent(this.props,i,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,s){if(ce.isValidElement(n))return ce.cloneElement(n,a);if(er(n))return n(a);var i=ur("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return ce.createElement(L_,Np({},a,{key:s,type:"linear",className:i}))}},{key:"renderLabelItem",value:function(n,a,s){if(ce.isValidElement(n))return ce.cloneElement(n,a);var i=s;if(er(n)&&(i=n(a),ce.isValidElement(i)))return i;var l=ur("recharts-pie-label-text",typeof n!="boolean"&&!er(n)?n.className:"");return ce.createElement(wh,Np({},a,{alignmentBaseline:"middle",className:l}),i)}}])})(w.PureComponent);yk=pu;go(pu,"displayName","Pie");go(pu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Kh.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});go(pu,"parseDeltaAngle",function(e,t){var r=Ls(t-e),n=Math.min(Math.abs(t-e),360);return r*n});go(pu,"getRealPieData",function(e){var t=e.data,r=e.children,n=Ht(e,!1),a=Li(r,Kx);return t&&t.length?t.map(function(s,i){return bn(bn(bn({payload:s},n),s),a&&a[i]&&a[i].props)}):a&&a.length?a.map(function(s){return bn(bn({},n),s.props)}):[]});go(pu,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,s=t.height,i=hle(a,s),l=n+Os(e.cx,a,a/2),c=r+Os(e.cy,s,s/2),u=Os(e.innerRadius,i,0),d=Os(e.outerRadius,i,i*.8),f=e.maxRadius||Math.sqrt(a*a+s*s)/2;return{cx:l,cy:c,innerRadius:u,outerRadius:d,maxRadius:f}});go(pu,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?bn(bn({},t.type.defaultProps),t.props):t.props,a=yk.getRealPieData(n);if(!a||!a.length)return null;var s=n.cornerRadius,i=n.startAngle,l=n.endAngle,c=n.paddingAngle,u=n.dataKey,d=n.nameKey,f=n.valueKey,m=n.tooltipType,p=Math.abs(n.minAngle),v=yk.parseCoordinateOfPie(n,r),b=yk.parseDeltaAngle(i,l),y=Math.abs(b),S=u;rr(u)&&rr(f)?(Qo(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),S="value"):rr(u)&&(Qo(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),S=f);var _=a.filter(function(O){return Ca(O,S,0)!==0}).length,N=(y>=360?_:_-1)*c,k=y-_*p-N,j=a.reduce(function(O,R){var H=Ca(R,S,0);return O+(tt(H)?H:0)},0),E;if(j>0){var T;E=a.map(function(O,R){var H=Ca(O,S,0),$=Ca(O,d,R),L=(tt(H)?H:0)/j,A;R?A=T.endAngle+Ls(b)*c*(H!==0?1:0):A=i;var M=A+Ls(b)*((H!==0?p:0)+L*k),P=(A+M)/2,I=(v.innerRadius+v.outerRadius)/2,B=[{name:$,value:H,payload:O,dataKey:S,type:m}],F=xn(v.cx,v.cy,I,P);return T=bn(bn(bn({percent:L,cornerRadius:s,name:$,tooltipPayload:B,midAngle:P,middleRadius:I,tooltipPosition:F},O),v),{},{value:Ca(O,S),startAngle:A,endAngle:M,payload:O,paddingAngle:Ls(b)*c}),T})}return bn(bn({},v),{},{sectors:E,data:a})});var sD,ZV;function oIe(){if(ZV)return sD;ZV=1;var e=Math.ceil,t=Math.max;function r(n,a,s,i){for(var l=-1,c=t(e((a-n)/(s||1)),0),u=Array(c);c--;)u[i?c:++l]=n,n+=s;return u}return sD=r,sD}var iD,XV;function Lle(){if(XV)return iD;XV=1;var e=Zie(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-t){var s=a<0?-1:1;return s*r}return a===a?a:0}return iD=n,iD}var oD,eY;function lIe(){if(eY)return oD;eY=1;var e=oIe(),t=Sj(),r=Lle();function n(a){return function(s,i,l){return l&&typeof l!="number"&&t(s,i,l)&&(i=l=void 0),s=r(s),i===void 0?(i=s,s=0):i=r(i),l=l===void 0?s<i?1:-1:r(l),e(s,i,l,a)}}return oD=n,oD}var lD,tY;function cIe(){if(tY)return lD;tY=1;var e=lIe(),t=e();return lD=t,lD}var uIe=cIe();const q_=Ur(uIe);function Py(e){"@babel/helpers - typeof";return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Py(e)}function rY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rY(Object(r),!0).forEach(function(n){Ole(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ole(e,t,r){return t=dIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dIe(e){var t=fIe(e,"string");return Py(t)=="symbol"?t:t+""}function fIe(e,t){if(Py(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Py(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hIe=["Webkit","Moz","O","ms"],mIe=function(t,r){var n=t.replace(/(\w)/,function(s){return s.toUpperCase()}),a=hIe.reduce(function(s,i){return nY(nY({},s),{},Ole({},i+n,r))},{});return a[t]=r,a};function ug(e){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}function W_(){return W_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W_.apply(this,arguments)}function aY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aY(Object(r),!0).forEach(function(n){Si(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rle(n.key),n)}}function gIe(e,t,r){return t&&sY(e.prototype,t),r&&sY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vIe(e,t,r){return t=K_(t),bIe(e,Ile()?Reflect.construct(t,r||[],K_(e).constructor):t.apply(e,r))}function bIe(e,t){if(t&&(ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yIe(e)}function yIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ile(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ile=function(){return!!e})()}function K_(e){return K_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},K_(e)}function xIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qI(e,t)}function qI(e,t){return qI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qI(e,t)}function Si(e,t,r){return t=Rle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rle(e){var t=wIe(e,"string");return ug(t)=="symbol"?t:t+""}function wIe(e,t){if(ug(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ug(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var SIe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,s=t.x,i=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=Eb().domain(q_(0,c)).range([s,s+i-l]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:d}},iY=function(t){return t.changedTouches&&!!t.changedTouches.length},dg=(function(e){function t(r){var n;return pIe(this,t),n=vIe(this,t,[r]),Si(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Si(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Si(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,s=a.endIndex,i=a.onDragEnd,l=a.startIndex;i?.({endIndex:s,startIndex:l})}),n.detachDragEndListener()}),Si(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Si(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Si(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Si(n,"handleSlideDragStart",function(a){var s=iY(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return xIe(t,e),gIe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,s=n.endX,i=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,d=u.length-1,f=Math.min(a,s),m=Math.max(a,s),p=t.getIndexInRange(i,f),v=t.getIndexInRange(i,m);return{startIndex:p-p%c,endIndex:v===d?d:v-v%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,s=a.data,i=a.tickFormatter,l=a.dataKey,c=Ca(s[n],l,n);return er(i)?i(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,s=a.slideMoveStartX,i=a.startX,l=a.endX,c=this.props,u=c.x,d=c.width,f=c.travellerWidth,m=c.startIndex,p=c.endIndex,v=c.onChange,b=n.pageX-s;b>0?b=Math.min(b,u+d-f-l,u+d-f-i):b<0&&(b=Math.max(b,u-i,u-l));var y=this.getIndex({startX:i+b,endX:l+b});(y.startIndex!==m||y.endIndex!==p)&&v&&v(y),this.setState({startX:i+b,endX:l+b,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var s=iY(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,s=a.brushMoveStartX,i=a.movingTravellerId,l=a.endX,c=a.startX,u=this.state[i],d=this.props,f=d.x,m=d.width,p=d.travellerWidth,v=d.onChange,b=d.gap,y=d.data,S={startX:this.state.startX,endX:this.state.endX},_=n.pageX-s;_>0?_=Math.min(_,f+m-p-u):_<0&&(_=Math.max(_,f-u)),S[i]=u+_;var N=this.getIndex(S),k=N.startIndex,j=N.endIndex,E=function(){var O=y.length-1;return i==="startX"&&(l>c?k%b===0:j%b===0)||l<c&&j===O||i==="endX"&&(l>c?j%b===0:k%b===0)||l>c&&j===O};this.setState(Si(Si({},i,u+_),"brushMoveStartX",n.pageX),function(){v&&E()&&v(N)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var s=this,i=this.state,l=i.scaleValues,c=i.startX,u=i.endX,d=this.state[a],f=l.indexOf(d);if(f!==-1){var m=f+n;if(!(m===-1||m>=l.length)){var p=l[m];a==="startX"&&p>=u||a==="endX"&&p<=c||this.setState(Si({},a,p),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,s=n.y,i=n.width,l=n.height,c=n.fill,u=n.stroke;return ce.createElement("rect",{stroke:u,fill:c,x:a,y:s,width:i,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,s=n.y,i=n.width,l=n.height,c=n.data,u=n.children,d=n.padding,f=w.Children.only(u);return f?ce.cloneElement(f,{x:a,y:s,width:i,height:l,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var s,i,l=this,c=this.props,u=c.y,d=c.travellerWidth,f=c.height,m=c.traveller,p=c.ariaLabel,v=c.data,b=c.startIndex,y=c.endIndex,S=Math.max(n,this.props.x),_=cD(cD({},Ht(this.props,!1)),{},{x:S,y:u,width:d,height:f}),N=p||"Min value: ".concat((s=v[b])===null||s===void 0?void 0:s.name,", Max value: ").concat((i=v[y])===null||i===void 0?void 0:i.name);return ce.createElement(Ir,{tabIndex:0,role:"slider","aria-label":N,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(j){["ArrowLeft","ArrowRight"].includes(j.key)&&(j.preventDefault(),j.stopPropagation(),l.handleTravellerMoveKeyboard(j.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(m,_))}},{key:"renderSlide",value:function(n,a){var s=this.props,i=s.y,l=s.height,c=s.stroke,u=s.travellerWidth,d=Math.min(n,a)+u,f=Math.max(Math.abs(a-n)-u,0);return ce.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:i,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,s=n.endIndex,i=n.y,l=n.height,c=n.travellerWidth,u=n.stroke,d=this.state,f=d.startX,m=d.endX,p=5,v={pointerEvents:"none",fill:u};return ce.createElement(Ir,{className:"recharts-brush-texts"},ce.createElement(wh,W_({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,m)-p,y:i+l/2},v),this.getTextOfTick(a)),ce.createElement(wh,W_({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,m)+c+p,y:i+l/2},v),this.getTextOfTick(s)))}},{key:"render",value:function(){var n=this.props,a=n.data,s=n.className,i=n.children,l=n.x,c=n.y,u=n.width,d=n.height,f=n.alwaysShowText,m=this.state,p=m.startX,v=m.endX,b=m.isTextActive,y=m.isSlideMoving,S=m.isTravellerMoving,_=m.isTravellerFocused;if(!a||!a.length||!tt(l)||!tt(c)||!tt(u)||!tt(d)||u<=0||d<=0)return null;var N=ur("recharts-brush",s),k=ce.Children.count(i)===1,j=mIe("userSelect","none");return ce.createElement(Ir,{className:N,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:j},this.renderBackground(),k&&this.renderPanorama(),this.renderSlide(p,v),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(v,"endX"),(b||y||S||_||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,s=n.y,i=n.width,l=n.height,c=n.stroke,u=Math.floor(s+l/2)-1;return ce.createElement(ce.Fragment,null,ce.createElement("rect",{x:a,y:s,width:i,height:l,fill:c,stroke:"none"}),ce.createElement("line",{x1:a+1,y1:u,x2:a+i-1,y2:u,fill:"none",stroke:"#fff"}),ce.createElement("line",{x1:a+1,y1:u+2,x2:a+i-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var s;return ce.isValidElement(n)?s=ce.cloneElement(n,a):er(n)?s=n(a):s=t.renderDefaultTraveller(a),s}},{key:"getDerivedStateFromProps",value:function(n,a){var s=n.data,i=n.width,l=n.x,c=n.travellerWidth,u=n.updateId,d=n.startIndex,f=n.endIndex;if(s!==a.prevData||u!==a.prevUpdateId)return cD({prevData:s,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:i},s&&s.length?SIe({data:s,width:i,x:l,travellerWidth:c,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(i!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+i-c]);var m=a.scale.domain().map(function(p){return a.scale(p)});return{prevData:s,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:i,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:m}}return null}},{key:"getIndexInRange",value:function(n,a){for(var s=n.length,i=0,l=s-1;l-i>1;){var c=Math.floor((i+l)/2);n[c]>a?l=c:i=c}return a>=n[l]?l:i}}])})(w.PureComponent);Si(dg,"displayName","Brush");Si(dg,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var uD,oY;function kIe(){if(oY)return uD;oY=1;var e=bz();function t(r,n){var a;return e(r,function(s,i,l){return a=n(s,i,l),!a}),!!a}return uD=t,uD}var dD,lY;function _Ie(){if(lY)return dD;lY=1;var e=Mie(),t=ql(),r=kIe(),n=li(),a=Sj();function s(i,l,c){var u=n(i)?e:r;return c&&a(i,l,c)&&(l=void 0),u(i,t(l,3))}return dD=s,dD}var NIe=_Ie();const CIe=Ur(NIe);var _l=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},fD,cY;function jIe(){if(cY)return fD;cY=1;var e=Gie();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return fD=t,fD}var hD,uY;function EIe(){if(uY)return hD;uY=1;var e=jIe(),t=Wie(),r=ql();function n(a,s){var i={};return s=r(s,3),t(a,function(l,c,u){e(i,c,s(l,c,u))}),i}return hD=n,hD}var MIe=EIe();const TIe=Ur(MIe);var mD,dY;function AIe(){if(dY)return mD;dY=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return mD=e,mD}var pD,fY;function DIe(){if(fY)return pD;fY=1;var e=bz();function t(r,n){var a=!0;return e(r,function(s,i,l){return a=!!n(s,i,l),a}),a}return pD=t,pD}var gD,hY;function LIe(){if(hY)return gD;hY=1;var e=AIe(),t=DIe(),r=ql(),n=li(),a=Sj();function s(i,l,c){var u=n(i)?e:t;return c&&a(i,l,c)&&(l=void 0),u(i,r(l,3))}return gD=s,gD}var OIe=LIe();const Ple=Ur(OIe);var IIe=["x","y"];function zy(e){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zy(e)}function WI(){return WI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WI.apply(this,arguments)}function mY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mY(Object(r),!0).forEach(function(n){RIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RIe(e,t,r){return t=PIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PIe(e){var t=zIe(e,"string");return zy(t)=="symbol"?t:t+""}function zIe(e,t){if(zy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BIe(e,t){if(e==null)return{};var r=$Ie(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function $Ie(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function FIe(e,t){var r=e.x,n=e.y,a=BIe(e,IIe),s="".concat(r),i=parseInt(s,10),l="".concat(n),c=parseInt(l,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),m=parseInt(f,10);return Cv(Cv(Cv(Cv(Cv({},t),a),i?{x:i}:{}),c?{y:c}:{}),{},{height:d,width:m,name:t.name,radius:t.radius})}function pY(e){return ce.createElement(Tle,WI({shapeType:"rectangle",propTransformer:FIe,activeClassName:"recharts-active-bar"},e))}var UIe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var s=tt(n)||nNe(n);return s?t(n,a):(s||gh(!1),r)}},HIe=["value","background"],zle;function fg(e){"@babel/helpers - typeof";return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fg(e)}function qIe(e,t){if(e==null)return{};var r=WIe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function G_(){return G_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G_.apply(this,arguments)}function gY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gY(Object(r),!0).forEach(function(n){vd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$le(n.key),n)}}function GIe(e,t,r){return t&&vY(e.prototype,t),r&&vY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VIe(e,t,r){return t=V_(t),YIe(e,Ble()?Reflect.construct(t,r||[],V_(e).constructor):t.apply(e,r))}function YIe(e,t){if(t&&(fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QIe(e)}function QIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ble(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ble=function(){return!!e})()}function V_(e){return V_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},V_(e)}function JIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KI(e,t)}function KI(e,t){return KI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},KI(e,t)}function vd(e,t,r){return t=$le(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $le(e){var t=ZIe(e,"string");return fg(t)=="symbol"?t:t+""}function ZIe(e,t){if(fg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var qd=(function(e){function t(){var r;KIe(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=VIe(this,t,[].concat(a)),vd(r,"state",{isAnimationFinished:!1}),vd(r,"id",l0("recharts-bar-")),vd(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),i&&i()}),vd(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),i&&i()}),r}return JIe(t,e),GIe(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,s=this.props,i=s.shape,l=s.dataKey,c=s.activeIndex,u=s.activeBar,d=Ht(this.props,!1);return n&&n.map(function(f,m){var p=m===c,v=p?u:i,b=da(da(da({},d),f),{},{isActive:p,option:v,index:m,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return ce.createElement(Ir,G_({className:"recharts-bar-rectangle"},xh(a.props,f,m),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(m)}),ce.createElement(pY,b))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,s=a.data,i=a.layout,l=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,d=a.animationEasing,f=a.animationId,m=this.state.prevData;return ce.createElement(Ol,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var v=p.t,b=s.map(function(y,S){var _=m&&m[S];if(_){var N=ji(_.x,y.x),k=ji(_.y,y.y),j=ji(_.width,y.width),E=ji(_.height,y.height);return da(da({},y),{},{x:N(v),y:k(v),width:j(v),height:E(v)})}if(i==="horizontal"){var T=ji(0,y.height),O=T(v);return da(da({},y),{},{y:y.y+y.height-O,height:O})}var R=ji(0,y.width),H=R(v);return da(da({},y),{},{width:H})});return ce.createElement(Ir,null,n.renderRectanglesStatically(b))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,s=n.isAnimationActive,i=this.state.prevData;return s&&a&&a.length&&(!i||!Jx(i,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,s=a.data,i=a.dataKey,l=a.activeIndex,c=Ht(this.props.background,!1);return s.map(function(u,d){u.value;var f=u.background,m=qIe(u,HIe);if(!f)return null;var p=da(da(da(da(da({},m),{},{fill:"#eee"},f),c),xh(n.props,u,d)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:i,index:d,className:"recharts-bar-background-rectangle"});return ce.createElement(pY,G_({key:"background-bar-".concat(d),option:n.props.background,isActive:d===l},p))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,i=s.data,l=s.xAxis,c=s.yAxis,u=s.layout,d=s.children,f=Li(d,Zx);if(!f)return null;var m=u==="vertical"?i[0].height/2:i[0].width/2,p=function(y,S){var _=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:_,errorVal:Ca(y,S)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return ce.createElement(Ir,v,f.map(function(b){return ce.cloneElement(b,{key:"error-bar-".concat(a,"-").concat(b.props.dataKey),data:i,xAxis:l,yAxis:c,layout:u,offset:m,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,s=n.data,i=n.className,l=n.xAxis,c=n.yAxis,u=n.left,d=n.top,f=n.width,m=n.height,p=n.isAnimationActive,v=n.background,b=n.id;if(a||!s||!s.length)return null;var y=this.state.isAnimationFinished,S=ur("recharts-bar",i),_=l&&l.allowDataOverflow,N=c&&c.allowDataOverflow,k=_||N,j=rr(b)?this.id:b;return ce.createElement(Ir,{className:S},_||N?ce.createElement("defs",null,ce.createElement("clipPath",{id:"clipPath-".concat(j)},ce.createElement("rect",{x:_?u:u-f/2,y:N?d:d-m/2,width:_?f:f*2,height:N?m:m*2}))):null,ce.createElement(Ir,{className:"recharts-bar-rectangles",clipPath:k?"url(#clipPath-".concat(j,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(k,j),(!p||y)&&Zc.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])})(w.PureComponent);zle=qd;vd(qd,"displayName","Bar");vd(qd,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Kh.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});vd(qd,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,s=e.xAxis,i=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,f=e.displayedData,m=e.offset,p=k3e(n,r);if(!p)return null;var v=t.layout,b=r.type.defaultProps,y=b!==void 0?da(da({},b),r.props):r.props,S=y.dataKey,_=y.children,N=y.minPointSize,k=v==="horizontal"?i:s,j=u?k.scale.domain():null,E=T3e({numericAxis:k}),T=Li(_,Kx),O=f.map(function(R,H){var $,L,A,M,P,I;u?$=_3e(u[d+H],j):($=Ca(R,S),Array.isArray($)||($=[E,$]));var B=UIe(N,zle.defaultProps.minPointSize)($[1],H);if(v==="horizontal"){var F,q=[i.scale($[0]),i.scale($[1])],Q=q[0],W=q[1];L=qG({axis:s,ticks:l,bandSize:a,offset:p.offset,entry:R,index:H}),A=(F=W??Q)!==null&&F!==void 0?F:void 0,M=p.size;var G=Q-W;if(P=Number.isNaN(G)?0:G,I={x:L,y:i.y,width:M,height:i.height},Math.abs(B)>0&&Math.abs(P)<Math.abs(B)){var J=Ls(P||B)*(Math.abs(B)-Math.abs(P));A-=J,P+=J}}else{var X=[s.scale($[0]),s.scale($[1])],V=X[0],se=X[1];if(L=V,A=qG({axis:i,ticks:c,bandSize:a,offset:p.offset,entry:R,index:H}),M=se-V,P=p.size,I={x:s.x,y:A,width:s.width,height:P},Math.abs(B)>0&&Math.abs(M)<Math.abs(B)){var de=Ls(M||B)*(Math.abs(B)-Math.abs(M));M+=de}}return da(da(da({},R),{},{x:L,y:A,width:M,height:P,value:u?$:$[1],payload:R,background:I},T&&T[H]&&T[H].props),{},{tooltipPayload:[dle(r,R)],tooltipPosition:{x:L+M/2,y:A+P/2}})});return da({data:O,layout:v},m)});function By(e){"@babel/helpers - typeof";return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},By(e)}function XIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fle(n.key),n)}}function eRe(e,t,r){return t&&bY(e.prototype,t),r&&bY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ro(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yY(Object(r),!0).forEach(function(n){Uj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uj(e,t,r){return t=Fle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fle(e){var t=tRe(e,"string");return By(t)=="symbol"?t:t+""}function tRe(e,t){if(By(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(By(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ule=function(t,r,n,a,s){var i=t.width,l=t.height,c=t.layout,u=t.children,d=Object.keys(r),f={left:n.left,leftMirror:n.left,right:i-n.right,rightMirror:i-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},m=!!Ni(u,qd);return d.reduce(function(p,v){var b=r[v],y=b.orientation,S=b.domain,_=b.padding,N=_===void 0?{}:_,k=b.mirror,j=b.reversed,E="".concat(y).concat(k?"Mirror":""),T,O,R,H,$;if(b.type==="number"&&(b.padding==="gap"||b.padding==="no-gap")){var L=S[1]-S[0],A=1/0,M=b.categoricalDomain.sort(iNe);if(M.forEach(function(X,V){V>0&&(A=Math.min((X||0)-(M[V-1]||0),A))}),Number.isFinite(A)){var P=A/L,I=b.layout==="vertical"?n.height:n.width;if(b.padding==="gap"&&(T=P*I/2),b.padding==="no-gap"){var B=Os(t.barCategoryGap,P*I),F=P*I/2;T=F-B-(F-B)/I*B}}}a==="xAxis"?O=[n.left+(N.left||0)+(T||0),n.left+n.width-(N.right||0)-(T||0)]:a==="yAxis"?O=c==="horizontal"?[n.top+n.height-(N.bottom||0),n.top+(N.top||0)]:[n.top+(N.top||0)+(T||0),n.top+n.height-(N.bottom||0)-(T||0)]:O=b.range,j&&(O=[O[1],O[0]]);var q=ole(b,s,m),Q=q.scale,W=q.realScaleType;Q.domain(S).range(O),lle(Q);var G=cle(Q,Ro(Ro({},b),{},{realScaleType:W}));a==="xAxis"?($=y==="top"&&!k||y==="bottom"&&k,R=n.left,H=f[E]-$*b.height):a==="yAxis"&&($=y==="left"&&!k||y==="right"&&k,R=f[E]-$*b.width,H=n.top);var J=Ro(Ro(Ro({},b),G),{},{realScaleType:W,x:R,y:H,scale:Q,width:a==="xAxis"?n.width:b.width,height:a==="yAxis"?n.height:b.height});return J.bandSize=T_(J,G),!b.hide&&a==="xAxis"?f[E]+=($?-1:1)*J.height:b.hide||(f[E]+=($?-1:1)*J.width),Ro(Ro({},p),{},Uj({},v,J))},{})},Hle=function(t,r){var n=t.x,a=t.y,s=r.x,i=r.y;return{x:Math.min(n,s),y:Math.min(a,i),width:Math.abs(s-n),height:Math.abs(i-a)}},rRe=function(t){var r=t.x1,n=t.y1,a=t.x2,s=t.y2;return Hle({x:r,y:n},{x:a,y:s})},qle=(function(){function e(t){XIe(this,e),this.scale=t}return eRe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,s=n.position;if(r!==void 0){if(s)switch(s){case"start":return this.scale(r);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+i}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],s=n[n.length-1];return a<=s?r>=a&&r<=s:r>=s&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])})();Uj(qle,"EPS",1e-4);var Gz=function(t){var r=Object.keys(t).reduce(function(n,a){return Ro(Ro({},n),{},Uj({},a,qle.create(t[a])))},{});return Ro(Ro({},r),{},{apply:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=s.bandAware,l=s.position;return TIe(a,function(c,u){return r[u].apply(c,{bandAware:i,position:l})})},isInRange:function(a){return Ple(a,function(s,i){return r[i].isInRange(s)})}})};function nRe(e){return(e%180+180)%180}var aRe=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=nRe(a),i=s*Math.PI/180,l=Math.atan(n/r),c=i>l&&i<Math.PI-l?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},vD,xY;function sRe(){if(xY)return vD;xY=1;var e=ql(),t=Wx(),r=xj();function n(a){return function(s,i,l){var c=Object(s);if(!t(s)){var u=e(i,3);s=r(s),i=function(f){return u(c[f],f,c)}}var d=a(s,i,l);return d>-1?c[u?s[d]:d]:void 0}}return vD=n,vD}var bD,wY;function iRe(){if(wY)return bD;wY=1;var e=Lle();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return bD=t,bD}var yD,SY;function oRe(){if(SY)return yD;SY=1;var e=$ie(),t=ql(),r=iRe(),n=Math.max;function a(s,i,l){var c=s==null?0:s.length;if(!c)return-1;var u=l==null?0:r(l);return u<0&&(u=n(c+u,0)),e(s,t(i,3),u)}return yD=a,yD}var xD,kY;function lRe(){if(kY)return xD;kY=1;var e=sRe(),t=oRe(),r=e(t);return xD=r,xD}var cRe=lRe();const uRe=Ur(cRe);var dRe=rie();const fRe=Ur(dRe);var hRe=fRe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),Vz=w.createContext(void 0),Yz=w.createContext(void 0),Wle=w.createContext(void 0),Kle=w.createContext({}),Gle=w.createContext(void 0),Vle=w.createContext(0),Yle=w.createContext(0),_Y=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,s=r.offset,i=t.clipPathId,l=t.children,c=t.width,u=t.height,d=hRe(s);return ce.createElement(Vz.Provider,{value:n},ce.createElement(Yz.Provider,{value:a},ce.createElement(Kle.Provider,{value:s},ce.createElement(Wle.Provider,{value:d},ce.createElement(Gle.Provider,{value:i},ce.createElement(Vle.Provider,{value:u},ce.createElement(Yle.Provider,{value:c},l)))))))},mRe=function(){return w.useContext(Gle)},Qle=function(t){var r=w.useContext(Vz);r==null&&gh(!1);var n=r[t];return n==null&&gh(!1),n},pRe=function(){var t=w.useContext(Vz);return ud(t)},gRe=function(){var t=w.useContext(Yz),r=uRe(t,function(n){return Ple(n.domain,Number.isFinite)});return r||ud(t)},Jle=function(t){var r=w.useContext(Yz);r==null&&gh(!1);var n=r[t];return n==null&&gh(!1),n},vRe=function(){var t=w.useContext(Wle);return t},bRe=function(){return w.useContext(Kle)},Qz=function(){return w.useContext(Yle)},Jz=function(){return w.useContext(Vle)};function hg(e){"@babel/helpers - typeof";return hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hg(e)}function yRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xle(n.key),n)}}function wRe(e,t,r){return t&&xRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function SRe(e,t,r){return t=Y_(t),kRe(e,Zle()?Reflect.construct(t,r||[],Y_(e).constructor):t.apply(e,r))}function kRe(e,t){if(t&&(hg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Re(e)}function _Re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zle(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zle=function(){return!!e})()}function Y_(e){return Y_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Y_(e)}function NRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GI(e,t)}function GI(e,t){return GI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},GI(e,t)}function NY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function CY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NY(Object(r),!0).forEach(function(n){Zz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zz(e,t,r){return t=Xle(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xle(e){var t=CRe(e,"string");return hg(t)=="symbol"?t:t+""}function CRe(e,t){if(hg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function jRe(e,t){return ARe(e)||TRe(e,t)||MRe(e,t)||ERe()}function ERe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MRe(e,t){if(e){if(typeof e=="string")return jY(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jY(e,t)}}function jY(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function ARe(e){if(Array.isArray(e))return e}function VI(){return VI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VI.apply(this,arguments)}var DRe=function(t,r){var n;return ce.isValidElement(t)?n=ce.cloneElement(t,r):er(t)?n=t(r):n=ce.createElement("line",VI({},r,{className:"recharts-reference-line-line"})),n},LRe=function(t,r,n,a,s,i,l,c,u){var d=s.x,f=s.y,m=s.width,p=s.height;if(n){var v=u.y,b=t.y.apply(v,{position:i});if(_l(u,"discard")&&!t.y.isInRange(b))return null;var y=[{x:d+m,y:b},{x:d,y:b}];return c==="left"?y.reverse():y}if(r){var S=u.x,_=t.x.apply(S,{position:i});if(_l(u,"discard")&&!t.x.isInRange(_))return null;var N=[{x:_,y:f+p},{x:_,y:f}];return l==="top"?N.reverse():N}if(a){var k=u.segment,j=k.map(function(E){return t.apply(E,{position:i})});return _l(u,"discard")&&CIe(j,function(E){return!t.isInRange(E)})?null:j}return null};function ORe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,s=e.yAxisId,i=e.shape,l=e.className,c=e.alwaysShow,u=mRe(),d=Qle(a),f=Jle(s),m=vRe();if(!u||!m)return null;Qo(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=Gz({x:d.scale,y:f.scale}),v=ja(t),b=ja(r),y=n&&n.length===2,S=LRe(p,v,b,y,m,e.position,d.orientation,f.orientation,e);if(!S)return null;var _=jRe(S,2),N=_[0],k=N.x,j=N.y,E=_[1],T=E.x,O=E.y,R=_l(e,"hidden")?"url(#".concat(u,")"):void 0,H=CY(CY({clipPath:R},Ht(e,!0)),{},{x1:k,y1:j,x2:T,y2:O});return ce.createElement(Ir,{className:ur("recharts-reference-line",l)},DRe(i,H),$a.renderCallByParent(e,rRe({x1:k,y1:j,x2:T,y2:O})))}var Xz=(function(e){function t(){return yRe(this,t),SRe(this,t,arguments)}return NRe(t,e),wRe(t,[{key:"render",value:function(){return ce.createElement(ORe,this.props)}}])})(ce.Component);Zz(Xz,"displayName","ReferenceLine");Zz(Xz,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function YI(){return YI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YI.apply(this,arguments)}function mg(e){"@babel/helpers - typeof";return mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mg(e)}function EY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function MY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EY(Object(r),!0).forEach(function(n){Hj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tce(n.key),n)}}function PRe(e,t,r){return t&&RRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zRe(e,t,r){return t=Q_(t),BRe(e,ece()?Reflect.construct(t,r||[],Q_(e).constructor):t.apply(e,r))}function BRe(e,t){if(t&&(mg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Re(e)}function $Re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ece(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ece=function(){return!!e})()}function Q_(e){return Q_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Q_(e)}function FRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},QI(e,t)}function Hj(e,t,r){return t=tce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tce(e){var t=URe(e,"string");return mg(t)=="symbol"?t:t+""}function URe(e,t){if(mg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var HRe=function(t){var r=t.x,n=t.y,a=t.xAxis,s=t.yAxis,i=Gz({x:a.scale,y:s.scale}),l=i.apply({x:r,y:n},{bandAware:!0});return _l(t,"discard")&&!i.isInRange(l)?null:l},qj=(function(e){function t(){return IRe(this,t),zRe(this,t,arguments)}return FRe(t,e),PRe(t,[{key:"render",value:function(){var n=this.props,a=n.x,s=n.y,i=n.r,l=n.alwaysShow,c=n.clipPathId,u=ja(a),d=ja(s);if(Qo(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=HRe(this.props);if(!f)return null;var m=f.x,p=f.y,v=this.props,b=v.shape,y=v.className,S=_l(this.props,"hidden")?"url(#".concat(c,")"):void 0,_=MY(MY({clipPath:S},Ht(this.props,!0)),{},{cx:m,cy:p});return ce.createElement(Ir,{className:ur("recharts-reference-dot",y)},t.renderDot(b,_),$a.renderCallByParent(this.props,{x:m-i,y:p-i,width:2*i,height:2*i}))}}])})(ce.Component);Hj(qj,"displayName","ReferenceDot");Hj(qj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Hj(qj,"renderDot",function(e,t){var r;return ce.isValidElement(e)?r=ce.cloneElement(e,t):er(e)?r=e(t):r=ce.createElement(Ij,YI({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function JI(){return JI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JI.apply(this,arguments)}function pg(e){"@babel/helpers - typeof";return pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pg(e)}function TY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TY(Object(r),!0).forEach(function(n){Wj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WRe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nce(n.key),n)}}function KRe(e,t,r){return t&&WRe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GRe(e,t,r){return t=J_(t),VRe(e,rce()?Reflect.construct(t,r||[],J_(e).constructor):t.apply(e,r))}function VRe(e,t){if(t&&(pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YRe(e)}function YRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rce=function(){return!!e})()}function J_(e){return J_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},J_(e)}function QRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZI(e,t)}function ZI(e,t){return ZI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZI(e,t)}function Wj(e,t,r){return t=nce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nce(e){var t=JRe(e,"string");return pg(t)=="symbol"?t:t+""}function JRe(e,t){if(pg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ZRe=function(t,r,n,a,s){var i=s.x1,l=s.x2,c=s.y1,u=s.y2,d=s.xAxis,f=s.yAxis;if(!d||!f)return null;var m=Gz({x:d.scale,y:f.scale}),p={x:t?m.x.apply(i,{position:"start"}):m.x.rangeMin,y:n?m.y.apply(c,{position:"start"}):m.y.rangeMin},v={x:r?m.x.apply(l,{position:"end"}):m.x.rangeMax,y:a?m.y.apply(u,{position:"end"}):m.y.rangeMax};return _l(s,"discard")&&(!m.isInRange(p)||!m.isInRange(v))?null:Hle(p,v)},Kj=(function(e){function t(){return qRe(this,t),GRe(this,t,arguments)}return QRe(t,e),KRe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,s=n.x2,i=n.y1,l=n.y2,c=n.className,u=n.alwaysShow,d=n.clipPathId;Qo(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=ja(a),m=ja(s),p=ja(i),v=ja(l),b=this.props.shape;if(!f&&!m&&!p&&!v&&!b)return null;var y=ZRe(f,m,p,v,this.props);if(!y&&!b)return null;var S=_l(this.props,"hidden")?"url(#".concat(d,")"):void 0;return ce.createElement(Ir,{className:ur("recharts-reference-area",c)},t.renderRect(b,AY(AY({clipPath:S},Ht(this.props,!0)),y)),$a.renderCallByParent(this.props,y))}}])})(ce.Component);Wj(Kj,"displayName","ReferenceArea");Wj(Kj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Wj(Kj,"renderRect",function(e,t){var r;return ce.isValidElement(e)?r=ce.cloneElement(e,t):er(e)?r=e(t):r=ce.createElement(Kz,JI({},t,{className:"recharts-reference-area-rect"})),r});function ace(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function XRe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return aRe(n,r)}function ePe(e,t,r){var n=r==="width",a=e.x,s=e.y,i=e.width,l=e.height;return t===1?{start:n?a:s,end:n?a+i:s+l}:{start:n?a+i:s+l,end:n?a:s}}function Z_(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-a)<=0}function tPe(e,t){return ace(e,t+1)}function rPe(e,t,r,n,a){for(var s=(n||[]).slice(),i=t.start,l=t.end,c=0,u=1,d=i,f=function(){var v=n?.[c];if(v===void 0)return{v:ace(n,u)};var b=c,y,S=function(){return y===void 0&&(y=r(v,b)),y},_=v.coordinate,N=c===0||Z_(e,_,S,d,l);N||(c=0,d=i,u+=1),N&&(d=_+e*(S()/2+a),c+=u)},m;u<=s.length;)if(m=f(),m)return m.v;return[]}function $y(e){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(e)}function DY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DY(Object(r),!0).forEach(function(n){nPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nPe(e,t,r){return t=aPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aPe(e){var t=sPe(e,"string");return $y(t)=="symbol"?t:t+""}function sPe(e,t){if($y(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iPe(e,t,r,n,a){for(var s=(n||[]).slice(),i=s.length,l=t.start,c=t.end,u=function(m){var p=s[m],v,b=function(){return v===void 0&&(v=r(p,m)),v};if(m===i-1){var y=e*(p.coordinate+e*b()/2-c);s[m]=p=bs(bs({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else s[m]=p=bs(bs({},p),{},{tickCoord:p.coordinate});var S=Z_(e,p.tickCoord,b,l,c);S&&(c=p.tickCoord-e*(b()/2+a),s[m]=bs(bs({},p),{},{isShow:!0}))},d=i-1;d>=0;d--)u(d);return s}function oPe(e,t,r,n,a,s){var i=(n||[]).slice(),l=i.length,c=t.start,u=t.end;if(s){var d=n[l-1],f=r(d,l-1),m=e*(d.coordinate+e*f/2-u);i[l-1]=d=bs(bs({},d),{},{tickCoord:m>0?d.coordinate-m*e:d.coordinate});var p=Z_(e,d.tickCoord,function(){return f},c,u);p&&(u=d.tickCoord-e*(f/2+a),i[l-1]=bs(bs({},d),{},{isShow:!0}))}for(var v=s?l-1:l,b=function(_){var N=i[_],k,j=function(){return k===void 0&&(k=r(N,_)),k};if(_===0){var E=e*(N.coordinate-e*j()/2-c);i[_]=N=bs(bs({},N),{},{tickCoord:E<0?N.coordinate-E*e:N.coordinate})}else i[_]=N=bs(bs({},N),{},{tickCoord:N.coordinate});var T=Z_(e,N.tickCoord,j,c,u);T&&(c=N.tickCoord+e*(j()/2+a),i[_]=bs(bs({},N),{},{isShow:!0}))},y=0;y<v;y++)b(y);return i}function e9(e,t,r){var n=e.tick,a=e.ticks,s=e.viewBox,i=e.minTickGap,l=e.orientation,c=e.interval,u=e.tickFormatter,d=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(tt(c)||Kh.isSsr)return tPe(a,typeof c=="number"&&tt(c)?c:0);var m=[],p=l==="top"||l==="bottom"?"width":"height",v=d&&p==="width"?jb(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=function(N,k){var j=er(u)?u(N.value,k):N.value;return p==="width"?XRe(jb(j,{fontSize:t,letterSpacing:r}),v,f):jb(j,{fontSize:t,letterSpacing:r})[p]},y=a.length>=2?Ls(a[1].coordinate-a[0].coordinate):1,S=ePe(s,y,p);return c==="equidistantPreserveStart"?rPe(y,S,b,a,i):(c==="preserveStart"||c==="preserveStartEnd"?m=oPe(y,S,b,a,i,c==="preserveStartEnd"):m=iPe(y,S,b,a,i),m.filter(function(_){return _.isShow}))}var lPe=["viewBox"],cPe=["viewBox"],uPe=["ticks"];function gg(e){"@babel/helpers - typeof";return gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gg(e)}function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(this,arguments)}function LY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LY(Object(r),!0).forEach(function(n){t9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wD(e,t){if(e==null)return{};var r=dPe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dPe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ice(n.key),n)}}function hPe(e,t,r){return t&&OY(e.prototype,t),r&&OY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mPe(e,t,r){return t=X_(t),pPe(e,sce()?Reflect.construct(t,r||[],X_(e).constructor):t.apply(e,r))}function pPe(e,t){if(t&&(gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gPe(e)}function gPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sce=function(){return!!e})()}function X_(e){return X_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},X_(e)}function vPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XI(e,t)}function XI(e,t){return XI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},XI(e,t)}function t9(e,t,r){return t=ice(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ice(e){var t=bPe(e,"string");return gg(t)=="symbol"?t:t+""}function bPe(e,t){if(gg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var f0=(function(e){function t(r){var n;return fPe(this,t),n=mPe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return vPe(t,e),hPe(t,[{key:"shouldComponentUpdate",value:function(n,a){var s=n.viewBox,i=wD(n,lPe),l=this.props,c=l.viewBox,u=wD(l,cPe);return!Op(s,c)||!Op(i,u)||!Op(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,s=a.x,i=a.y,l=a.width,c=a.height,u=a.orientation,d=a.tickSize,f=a.mirror,m=a.tickMargin,p,v,b,y,S,_,N=f?-1:1,k=n.tickSize||d,j=tt(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":p=v=n.coordinate,y=i+ +!f*c,b=y-N*k,_=b-N*m,S=j;break;case"left":b=y=n.coordinate,v=s+ +!f*l,p=v-N*k,S=p-N*m,_=j;break;case"right":b=y=n.coordinate,v=s+ +f*l,p=v+N*k,S=p+N*m,_=j;break;default:p=v=n.coordinate,y=i+ +f*c,b=y+N*k,_=b+N*m,S=j;break}return{line:{x1:p,y1:b,x2:v,y2:y},tick:{x:S,y:_}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,s=n.mirror,i;switch(a){case"left":i=s?"start":"end";break;case"right":i=s?"end":"start";break;default:i="middle";break}return i}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,s=n.mirror,i="end";switch(a){case"left":case"right":i="middle";break;case"top":i=s?"start":"end";break;default:i=s?"end":"start";break}return i}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,s=n.y,i=n.width,l=n.height,c=n.orientation,u=n.mirror,d=n.axisLine,f=wa(wa(wa({},Ht(this.props,!1)),Ht(d,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var m=+(c==="top"&&!u||c==="bottom"&&u);f=wa(wa({},f),{},{x1:a,y1:s+m*l,x2:a+i,y2:s+m*l})}else{var p=+(c==="left"&&!u||c==="right"&&u);f=wa(wa({},f),{},{x1:a+p*i,y1:s,x2:a+p*i,y2:s+l})}return ce.createElement("line",Cp({},f,{className:ur("recharts-cartesian-axis-line",Di(d,"className"))}))}},{key:"renderTicks",value:function(n,a,s){var i=this,l=this.props,c=l.tickLine,u=l.stroke,d=l.tick,f=l.tickFormatter,m=l.unit,p=e9(wa(wa({},this.props),{},{ticks:n}),a,s),v=this.getTickTextAnchor(),b=this.getTickVerticalAnchor(),y=Ht(this.props,!1),S=Ht(d,!1),_=wa(wa({},y),{},{fill:"none"},Ht(c,!1)),N=p.map(function(k,j){var E=i.getTickLineCoord(k),T=E.line,O=E.tick,R=wa(wa(wa(wa({textAnchor:v,verticalAnchor:b},y),{},{stroke:"none",fill:u},S),O),{},{index:j,payload:k,visibleTicksCount:p.length,tickFormatter:f});return ce.createElement(Ir,Cp({className:"recharts-cartesian-axis-tick",key:"tick-".concat(k.value,"-").concat(k.coordinate,"-").concat(k.tickCoord)},xh(i.props,k,j)),c&&ce.createElement("line",Cp({},_,T,{className:ur("recharts-cartesian-axis-tick-line",Di(c,"className"))})),d&&t.renderTickItem(d,R,"".concat(er(f)?f(k.value,j):k.value).concat(m||"")))});return ce.createElement("g",{className:"recharts-cartesian-axis-ticks"},N)}},{key:"render",value:function(){var n=this,a=this.props,s=a.axisLine,i=a.width,l=a.height,c=a.ticksGenerator,u=a.className,d=a.hide;if(d)return null;var f=this.props,m=f.ticks,p=wD(f,uPe),v=m;return er(c)&&(v=m&&m.length>0?c(this.props):c(p)),i<=0||l<=0||!v||!v.length?null:ce.createElement(Ir,{className:ur("recharts-cartesian-axis",u),ref:function(y){n.layerReference=y}},s&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),$a.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,s){var i,l=ur(a.className,"recharts-cartesian-axis-tick-value");return ce.isValidElement(n)?i=ce.cloneElement(n,wa(wa({},a),{},{className:l})):er(n)?i=n(wa(wa({},a),{},{className:l})):i=ce.createElement(wh,Cp({},a,{className:"recharts-cartesian-axis-tick-value"}),s),i}}])})(w.Component);t9(f0,"displayName","CartesianAxis");t9(f0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var yPe=["x1","y1","x2","y2","key"],xPe=["offset"];function _h(e){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(e)}function IY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IY(Object(r),!0).forEach(function(n){wPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wPe(e,t,r){return t=SPe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SPe(e){var t=kPe(e,"string");return _h(t)=="symbol"?t:t+""}function kPe(e,t){if(_h(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_h(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vf(){return Vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vf.apply(this,arguments)}function RY(e,t){if(e==null)return{};var r=_Pe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Pe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var NPe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,s=t.y,i=t.width,l=t.height,c=t.ry;return ce.createElement("rect",{x:a,y:s,ry:c,width:i,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function oce(e,t){var r;if(ce.isValidElement(e))r=ce.cloneElement(e,t);else if(er(e))r=e(t);else{var n=t.x1,a=t.y1,s=t.x2,i=t.y2,l=t.key,c=RY(t,yPe),u=Ht(c,!1);u.offset;var d=RY(u,xPe);r=ce.createElement("line",Vf({},d,{x1:n,y1:a,x2:s,y2:i,fill:"none",key:l}))}return r}function CPe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,s=e.horizontalPoints;if(!a||!s||!s.length)return null;var i=s.map(function(l,c){var u=xs(xs({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return oce(a,u)});return ce.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function jPe(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,s=e.verticalPoints;if(!a||!s||!s.length)return null;var i=s.map(function(l,c){var u=xs(xs({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return oce(a,u)});return ce.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function EPe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,s=e.width,i=e.height,l=e.horizontalPoints,c=e.horizontal,u=c===void 0?!0:c;if(!u||!t||!t.length)return null;var d=l.map(function(m){return Math.round(m+a-a)}).sort(function(m,p){return m-p});a!==d[0]&&d.unshift(0);var f=d.map(function(m,p){var v=!d[p+1],b=v?a+i-m:d[p+1]-m;if(b<=0)return null;var y=p%t.length;return ce.createElement("rect",{key:"react-".concat(p),y:m,x:n,height:b,width:s,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ce.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function MPe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,s=e.x,i=e.y,l=e.width,c=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var d=u.map(function(m){return Math.round(m+s-s)}).sort(function(m,p){return m-p});s!==d[0]&&d.unshift(0);var f=d.map(function(m,p){var v=!d[p+1],b=v?s+l-m:d[p+1]-m;if(b<=0)return null;var y=p%n.length;return ce.createElement("rect",{key:"react-".concat(p),x:m,y:i,width:b,height:c,stroke:"none",fill:n[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return ce.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var TPe=function(t,r){var n=t.xAxis,a=t.width,s=t.height,i=t.offset;return ile(e9(xs(xs(xs({},f0.defaultProps),n),{},{ticks:Hc(n,!0),viewBox:{x:0,y:0,width:a,height:s}})),i.left,i.left+i.width,r)},APe=function(t,r){var n=t.yAxis,a=t.width,s=t.height,i=t.offset;return ile(e9(xs(xs(xs({},f0.defaultProps),n),{},{ticks:Hc(n,!0),viewBox:{x:0,y:0,width:a,height:s}})),i.top,i.top+i.height,r)},Jm={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function r9(e){var t,r,n,a,s,i,l=Qz(),c=Jz(),u=bRe(),d=xs(xs({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Jm.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Jm.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Jm.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Jm.horizontalFill,vertical:(s=e.vertical)!==null&&s!==void 0?s:Jm.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:Jm.verticalFill,x:tt(e.x)?e.x:u.left,y:tt(e.y)?e.y:u.top,width:tt(e.width)?e.width:u.width,height:tt(e.height)?e.height:u.height}),f=d.x,m=d.y,p=d.width,v=d.height,b=d.syncWithTicks,y=d.horizontalValues,S=d.verticalValues,_=pRe(),N=gRe();if(!tt(p)||p<=0||!tt(v)||v<=0||!tt(f)||f!==+f||!tt(m)||m!==+m)return null;var k=d.verticalCoordinatesGenerator||TPe,j=d.horizontalCoordinatesGenerator||APe,E=d.horizontalPoints,T=d.verticalPoints;if((!E||!E.length)&&er(j)){var O=y&&y.length,R=j({yAxis:N?xs(xs({},N),{},{ticks:O?y:N.ticks}):void 0,width:l,height:c,offset:u},O?!0:b);Qo(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(_h(R),"]")),Array.isArray(R)&&(E=R)}if((!T||!T.length)&&er(k)){var H=S&&S.length,$=k({xAxis:_?xs(xs({},_),{},{ticks:H?S:_.ticks}):void 0,width:l,height:c,offset:u},H?!0:b);Qo(Array.isArray($),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(_h($),"]")),Array.isArray($)&&(T=$)}return ce.createElement("g",{className:"recharts-cartesian-grid"},ce.createElement(NPe,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),ce.createElement(CPe,Vf({},d,{offset:u,horizontalPoints:E,xAxis:_,yAxis:N})),ce.createElement(jPe,Vf({},d,{offset:u,verticalPoints:T,xAxis:_,yAxis:N})),ce.createElement(EPe,Vf({},d,{horizontalPoints:E})),ce.createElement(MPe,Vf({},d,{verticalPoints:T})))}r9.displayName="CartesianGrid";var DPe=["type","layout","connectNulls","ref"],LPe=["key"];function vg(e){"@babel/helpers - typeof";return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(e)}function PY(e,t){if(e==null)return{};var r=OPe(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function OPe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Lb(){return Lb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lb.apply(this,arguments)}function zY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zY(Object(r),!0).forEach(function(n){Po(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zm(e){return zPe(e)||PPe(e)||RPe(e)||IPe()}function IPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RPe(e,t){if(e){if(typeof e=="string")return eR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eR(e,t)}}function PPe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zPe(e){if(Array.isArray(e))return eR(e)}function eR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cce(n.key),n)}}function $Pe(e,t,r){return t&&BY(e.prototype,t),r&&BY(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FPe(e,t,r){return t=eN(t),UPe(e,lce()?Reflect.construct(t,r||[],eN(e).constructor):t.apply(e,r))}function UPe(e,t){if(t&&(vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HPe(e)}function HPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lce=function(){return!!e})()}function eN(e){return eN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eN(e)}function qPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tR(e,t)}function tR(e,t){return tR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},tR(e,t)}function Po(e,t,r){return t=cce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cce(e){var t=WPe(e,"string");return vg(t)=="symbol"?t:t+""}function WPe(e,t){if(vg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Xx=(function(e){function t(){var r;BPe(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=FPe(this,t,[].concat(a)),Po(r,"state",{isAnimationFinished:!0,totalLength:0}),Po(r,"generateSimpleStrokeDasharray",function(i,l){return"".concat(l,"px ").concat(i-l,"px")}),Po(r,"getStrokeDasharray",function(i,l,c){var u=c.reduce(function(S,_){return S+_});if(!u)return r.generateSimpleStrokeDasharray(l,i);for(var d=Math.floor(i/u),f=i%u,m=l-i,p=[],v=0,b=0;v<c.length;b+=c[v],++v)if(b+c[v]>f){p=[].concat(Zm(c.slice(0,v)),[f-b]);break}var y=p.length%2===0?[0,m]:[m];return[].concat(Zm(t.repeat(c,d)),Zm(p),y).map(function(S){return"".concat(S,"px")}).join(", ")}),Po(r,"id",l0("recharts-line-")),Po(r,"pathRef",function(i){r.mainCurve=i}),Po(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Po(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return qPe(t,e),$Pe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,i=s.points,l=s.xAxis,c=s.yAxis,u=s.layout,d=s.children,f=Li(d,Zx);if(!f)return null;var m=function(b,y){return{x:b.x,y:b.y,value:b.value,errorVal:Ca(b.payload,y)}},p={clipPath:n?"url(#clipPath-".concat(a,")"):null};return ce.createElement(Ir,p,f.map(function(v){return ce.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:i,xAxis:l,yAxis:c,layout:u,dataPointFormatter:m})}))}},{key:"renderDots",value:function(n,a,s){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,u=l.points,d=l.dataKey,f=Ht(this.props,!1),m=Ht(c,!0),p=u.map(function(b,y){var S=yi(yi(yi({key:"dot-".concat(y),r:3},f),m),{},{index:y,cx:b.x,cy:b.y,value:b.value,dataKey:d,payload:b.payload,points:u});return t.renderDotItem(c,S)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(s,")"):null};return ce.createElement(Ir,Lb({className:"recharts-line-dots",key:"dots"},v),p)}},{key:"renderCurveStatically",value:function(n,a,s,i){var l=this.props,c=l.type,u=l.layout,d=l.connectNulls;l.ref;var f=PY(l,DPe),m=yi(yi(yi({},Ht(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(s,")"):null,points:n},i),{},{type:c,layout:u,connectNulls:d});return ce.createElement(L_,Lb({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var s=this,i=this.props,l=i.points,c=i.strokeDasharray,u=i.isAnimationActive,d=i.animationBegin,f=i.animationDuration,m=i.animationEasing,p=i.animationId,v=i.animateNewValues,b=i.width,y=i.height,S=this.state,_=S.prevPoints,N=S.totalLength;return ce.createElement(Ol,{begin:d,duration:f,isActive:u,easing:m,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(k){var j=k.t;if(_){var E=_.length/l.length,T=l.map(function(L,A){var M=Math.floor(A*E);if(_[M]){var P=_[M],I=ji(P.x,L.x),B=ji(P.y,L.y);return yi(yi({},L),{},{x:I(j),y:B(j)})}if(v){var F=ji(b*2,L.x),q=ji(y/2,L.y);return yi(yi({},L),{},{x:F(j),y:q(j)})}return yi(yi({},L),{},{x:L.x,y:L.y})});return s.renderCurveStatically(T,n,a)}var O=ji(0,N),R=O(j),H;if(c){var $="".concat(c).split(/[,\s]+/gim).map(function(L){return parseFloat(L)});H=s.getStrokeDasharray(R,N,$)}else H=s.generateSimpleStrokeDasharray(N,R);return s.renderCurveStatically(l,n,a,{strokeDasharray:H})})}},{key:"renderCurve",value:function(n,a){var s=this.props,i=s.points,l=s.isAnimationActive,c=this.state,u=c.prevPoints,d=c.totalLength;return l&&i&&i.length&&(!u&&d>0||!Jx(u,i))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(i,n,a)}},{key:"render",value:function(){var n,a=this.props,s=a.hide,i=a.dot,l=a.points,c=a.className,u=a.xAxis,d=a.yAxis,f=a.top,m=a.left,p=a.width,v=a.height,b=a.isAnimationActive,y=a.id;if(s||!l||!l.length)return null;var S=this.state.isAnimationFinished,_=l.length===1,N=ur("recharts-line",c),k=u&&u.allowDataOverflow,j=d&&d.allowDataOverflow,E=k||j,T=rr(y)?this.id:y,O=(n=Ht(i,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},R=O.r,H=R===void 0?3:R,$=O.strokeWidth,L=$===void 0?2:$,A=pNe(i)?i:{},M=A.clipDot,P=M===void 0?!0:M,I=H*2+L;return ce.createElement(Ir,{className:N},k||j?ce.createElement("defs",null,ce.createElement("clipPath",{id:"clipPath-".concat(T)},ce.createElement("rect",{x:k?m:m-p/2,y:j?f:f-v/2,width:k?p:p*2,height:j?v:v*2})),!P&&ce.createElement("clipPath",{id:"clipPath-dots-".concat(T)},ce.createElement("rect",{x:m-I/2,y:f-I/2,width:p+I,height:v+I}))):null,!_&&this.renderCurve(E,T),this.renderErrorBar(E,T),(_||i)&&this.renderDots(E,P,T),(!b||S)&&Zc.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var s=n.length%2!==0?[].concat(Zm(n),[0]):n,i=[],l=0;l<a;++l)i=[].concat(Zm(i),Zm(s));return i}},{key:"renderDotItem",value:function(n,a){var s;if(ce.isValidElement(n))s=ce.cloneElement(n,a);else if(er(n))s=n(a);else{var i=a.key,l=PY(a,LPe),c=ur("recharts-line-dot",typeof n!="boolean"?n.className:"");s=ce.createElement(Ij,Lb({key:i},l,{className:c}))}return s}}])})(w.PureComponent);Po(Xx,"displayName","Line");Po(Xx,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Kh.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Po(Xx,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,s=e.yAxisTicks,i=e.dataKey,l=e.bandSize,c=e.displayedData,u=e.offset,d=t.layout,f=c.map(function(m,p){var v=Ca(m,i);return d==="horizontal"?{x:HG({axis:r,ticks:a,bandSize:l,entry:m,index:p}),y:rr(v)?null:n.scale(v),value:v,payload:m}:{x:rr(v)?null:r.scale(v),y:HG({axis:n,ticks:s,bandSize:l,entry:m,index:p}),value:v,payload:m}});return yi({points:f,layout:d},u)});function bg(e){"@babel/helpers - typeof";return bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bg(e)}function KPe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GPe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fce(n.key),n)}}function VPe(e,t,r){return t&&GPe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function YPe(e,t,r){return t=tN(t),QPe(e,uce()?Reflect.construct(t,r||[],tN(e).constructor):t.apply(e,r))}function QPe(e,t){if(t&&(bg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JPe(e)}function JPe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uce=function(){return!!e})()}function tN(e){return tN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tN(e)}function ZPe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rR(e,t)}function rR(e,t){return rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rR(e,t)}function dce(e,t,r){return t=fce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fce(e){var t=XPe(e,"string");return bg(t)=="symbol"?t:t+""}function XPe(e,t){if(bg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nR(){return nR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nR.apply(this,arguments)}function e5e(e){var t=e.xAxisId,r=Qz(),n=Jz(),a=Qle(t);return a==null?null:w.createElement(f0,nR({},a,{className:ur("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(i){return Hc(i,!0)}}))}var Qh=(function(e){function t(){return KPe(this,t),YPe(this,t,arguments)}return ZPe(t,e),VPe(t,[{key:"render",value:function(){return w.createElement(e5e,this.props)}}])})(w.Component);dce(Qh,"displayName","XAxis");dce(Qh,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function yg(e){"@babel/helpers - typeof";return yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yg(e)}function t5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r5e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pce(n.key),n)}}function n5e(e,t,r){return t&&r5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function a5e(e,t,r){return t=rN(t),s5e(e,hce()?Reflect.construct(t,r||[],rN(e).constructor):t.apply(e,r))}function s5e(e,t){if(t&&(yg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return i5e(e)}function i5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hce=function(){return!!e})()}function rN(e){return rN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rN(e)}function o5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aR(e,t)}function aR(e,t){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},aR(e,t)}function mce(e,t,r){return t=pce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pce(e){var t=l5e(e,"string");return yg(t)=="symbol"?t:t+""}function l5e(e,t){if(yg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function sR(){return sR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sR.apply(this,arguments)}var c5e=function(t){var r=t.yAxisId,n=Qz(),a=Jz(),s=Jle(r);return s==null?null:w.createElement(f0,sR({},s,{className:ur("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return Hc(l,!0)}}))},Jh=(function(e){function t(){return t5e(this,t),a5e(this,t,arguments)}return o5e(t,e),n5e(t,[{key:"render",value:function(){return w.createElement(c5e,this.props)}}])})(w.Component);mce(Jh,"displayName","YAxis");mce(Jh,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function $Y(e){return h5e(e)||f5e(e)||d5e(e)||u5e()}function u5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d5e(e,t){if(e){if(typeof e=="string")return iR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iR(e,t)}}function f5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function h5e(e){if(Array.isArray(e))return iR(e)}function iR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var oR=function(t,r,n,a,s){var i=Li(t,Xz),l=Li(t,qj),c=[].concat($Y(i),$Y(l)),u=Li(t,Kj),d="".concat(a,"Id"),f=a[0],m=r;if(c.length&&(m=c.reduce(function(b,y){if(y.props[d]===n&&_l(y.props,"extendDomain")&&tt(y.props[f])){var S=y.props[f];return[Math.min(b[0],S),Math.max(b[1],S)]}return b},m)),u.length){var p="".concat(f,"1"),v="".concat(f,"2");m=u.reduce(function(b,y){if(y.props[d]===n&&_l(y.props,"extendDomain")&&tt(y.props[p])&&tt(y.props[v])){var S=y.props[p],_=y.props[v];return[Math.min(b[0],S,_),Math.max(b[1],S,_)]}return b},m)}return s&&s.length&&(m=s.reduce(function(b,y){return tt(y)?[Math.min(b[0],y),Math.max(b[1],y)]:b},m)),m},SD={exports:{}},FY;function m5e(){return FY||(FY=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new a(d,f||c,m),v=r?r+u:u;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],p]:c._events[v].push(p):(c._events[v]=p,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,p=f.length,v=new Array(p);m<p;m++)v[m]=f[m].fn;return v},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,m,p,v){var b=r?r+u:u;if(!this._events[b])return!1;var y=this._events[b],S=arguments.length,_,N;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),S){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,m),!0;case 5:return y.fn.call(y.context,d,f,m,p),!0;case 6:return y.fn.call(y.context,d,f,m,p,v),!0}for(N=1,_=new Array(S-1);N<S;N++)_[N-1]=arguments[N];y.fn.apply(y.context,_)}else{var k=y.length,j;for(N=0;N<k;N++)switch(y[N].once&&this.removeListener(u,y[N].fn,void 0,!0),S){case 1:y[N].fn.call(y[N].context);break;case 2:y[N].fn.call(y[N].context,d);break;case 3:y[N].fn.call(y[N].context,d,f);break;case 4:y[N].fn.call(y[N].context,d,f,m);break;default:if(!_)for(j=1,_=new Array(S-1);j<S;j++)_[j-1]=arguments[j];y[N].fn.apply(y[N].context,_)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,m){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return i(this,p),this;var v=this._events[p];if(v.fn)v.fn===d&&(!m||v.once)&&(!f||v.context===f)&&i(this,p);else{for(var b=0,y=[],S=v.length;b<S;b++)(v[b].fn!==d||m&&!v[b].once||f&&v[b].context!==f)&&y.push(v[b]);y.length?this._events[p]=y.length===1?y[0]:y:i(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&i(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(SD)),SD.exports}var p5e=m5e();const g5e=Ur(p5e);var kD=new g5e,_D="recharts.syncMouseEvents";function Fy(e){"@babel/helpers - typeof";return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fy(e)}function v5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b5e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gce(n.key),n)}}function y5e(e,t,r){return t&&b5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ND(e,t,r){return t=gce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gce(e){var t=x5e(e,"string");return Fy(t)=="symbol"?t:t+""}function x5e(e,t){if(Fy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var w5e=(function(){function e(){v5e(this,e),ND(this,"activeIndex",0),ND(this,"coordinateList",[]),ND(this,"layout","horizontal")}return y5e(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,s=a===void 0?null:a,i=r.container,l=i===void 0?null:i,c=r.layout,u=c===void 0?null:c,d=r.offset,f=d===void 0?null:d,m=r.mouseHandlerCallback,p=m===void 0?null:m;this.coordinateList=(n=s??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),s=a.x,i=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=s+c+u,m=i+this.offset.top+l/2+d;this.mouseHandlerCallback({pageX:f,pageY:m})}}}])})();function S5e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],a=e?.[1];if(n&&a&&tt(n)&&tt(a))return!0}return!1}function k5e(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function vce(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,s=e.endAngle,i=xn(t,r,n,a),l=xn(t,r,n,s);return{points:[i,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:s}}function _5e(e,t,r){var n,a,s,i;if(e==="horizontal")n=t.x,s=n,a=r.top,i=r.top+r.height;else if(e==="vertical")a=t.y,i=a,n=r.left,s=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,u=t.innerRadius,d=t.outerRadius,f=t.angle,m=xn(l,c,u,f),p=xn(l,c,d,f);n=m.x,a=m.y,s=p.x,i=p.y}else return vce(t);return[{x:n,y:a},{x:s,y:i}]}function Uy(e){"@babel/helpers - typeof";return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uy(e)}function UY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UY(Object(r),!0).forEach(function(n){N5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N5e(e,t,r){return t=C5e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C5e(e){var t=j5e(e,"string");return Uy(t)=="symbol"?t:t+""}function j5e(e,t){if(Uy(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Uy(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E5e(e){var t,r,n=e.element,a=e.tooltipEventType,s=e.isActive,i=e.activeCoordinate,l=e.activePayload,c=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,f=e.layout,m=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!s||!i||m!=="ScatterChart"&&a!=="axis")return null;var v,b=L_;if(m==="ScatterChart")v=i,b=QLe;else if(m==="BarChart")v=k5e(f,i,c,d),b=Kz;else if(f==="radial"){var y=vce(i),S=y.cx,_=y.cy,N=y.radius,k=y.startAngle,j=y.endAngle;v={cx:S,cy:_,startAngle:k,endAngle:j,innerRadius:N,outerRadius:N},b=vle}else v={points:_5e(f,i,c)},b=L_;var E=lS(lS(lS(lS({stroke:"#ccc",pointerEvents:"none"},c),v),Ht(p,!1)),{},{payload:l,payloadIndex:u,className:ur("recharts-tooltip-cursor",p.className)});return w.isValidElement(p)?w.cloneElement(p,E):w.createElement(b,E)}var M5e=["item"],T5e=["children","className","width","height","style","compact","title","desc"];function xg(e){"@babel/helpers - typeof";return xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xg(e)}function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jp.apply(this,arguments)}function HY(e,t){return L5e(e)||D5e(e,t)||yce(e,t)||A5e()}function A5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D5e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}function L5e(e){if(Array.isArray(e))return e}function qY(e,t){if(e==null)return{};var r=O5e(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function O5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function I5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R5e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xce(n.key),n)}}function P5e(e,t,r){return t&&R5e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function z5e(e,t,r){return t=nN(t),B5e(e,bce()?Reflect.construct(t,r||[],nN(e).constructor):t.apply(e,r))}function B5e(e,t){if(t&&(xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $5e(e)}function $5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bce=function(){return!!e})()}function nN(e){return nN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nN(e)}function F5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lR(e,t)}function lR(e,t){return lR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},lR(e,t)}function wg(e){return q5e(e)||H5e(e)||yce(e)||U5e()}function U5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yce(e,t){if(e){if(typeof e=="string")return cR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cR(e,t)}}function H5e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q5e(e){if(Array.isArray(e))return cR(e)}function cR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Be(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WY(Object(r),!0).forEach(function(n){Gt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WY(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gt(e,t,r){return t=xce(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xce(e){var t=W5e(e,"string");return xg(t)=="symbol"?t:t+""}function W5e(e,t){if(xg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K5e={xAxis:["bottom","top"],yAxis:["left","right"]},G5e={width:"100%",height:"100%"},wce={x:0,y:0};function cS(e){return e}var V5e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Y5e=function(t,r,n,a){var s=r.find(function(d){return d&&d.index===n});if(s){if(t==="horizontal")return{x:s.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:s.coordinate};if(t==="centric"){var i=s.coordinate,l=a.radius;return Be(Be(Be({},a),xn(a.cx,a.cy,l,i)),{},{angle:i,radius:l})}var c=s.coordinate,u=a.angle;return Be(Be(Be({},a),xn(a.cx,a.cy,c,u)),{},{angle:u,radius:c})}return wce},Gj=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,s=r.dataEndIndex,i=(n??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(wg(l),wg(u)):l},[]);return i.length>0?i:t&&t.length&&tt(a)&&tt(s)?t.slice(a,s+1):[]};function Sce(e){return e==="number"?[0,"auto"]:void 0}var uR=function(t,r,n,a){var s=t.graphicalItems,i=t.tooltipAxis,l=Gj(r,t);return n<0||!s||!s.length||n>=l.length?null:s.reduce(function(c,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var m;if(i.dataKey&&!i.allowDuplicatedCategory){var p=f===void 0?l:f;m=a_(p,i.dataKey,a)}else m=f&&f[n]||l[n];return m?[].concat(wg(c),[dle(u,m)]):c},[])},KY=function(t,r,n,a){var s=a||{x:t.chartX,y:t.chartY},i=V5e(s,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,d=v3e(i,l,u,c);if(d>=0&&u){var f=u[d]&&u[d].value,m=uR(t,r,d,f),p=Y5e(n,l,d,s);return{activeTooltipIndex:d,activeLabel:f,activePayload:m,activeCoordinate:p}}return null},Q5e=function(t,r){var n=r.axes,a=r.graphicalItems,s=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,m=t.stackOffset,p=sle(d,s);return n.reduce(function(v,b){var y,S=b.type.defaultProps!==void 0?Be(Be({},b.type.defaultProps),b.props):b.props,_=S.type,N=S.dataKey,k=S.allowDataOverflow,j=S.allowDuplicatedCategory,E=S.scale,T=S.ticks,O=S.includeHidden,R=S[i];if(v[R])return v;var H=Gj(t.data,{graphicalItems:a.filter(function(G){var J,X=i in G.props?G.props[i]:(J=G.type.defaultProps)===null||J===void 0?void 0:J[i];return X===R}),dataStartIndex:c,dataEndIndex:u}),$=H.length,L,A,M;S5e(S.domain,k,_)&&(L=SI(S.domain,null,k),p&&(_==="number"||E!=="auto")&&(M=Mb(H,N,"category")));var P=Sce(_);if(!L||L.length===0){var I,B=(I=S.domain)!==null&&I!==void 0?I:P;if(N){if(L=Mb(H,N,_),_==="category"&&p){var F=sNe(L);j&&F?(A=L,L=q_(0,$)):j||(L=GG(B,L,b).reduce(function(G,J){return G.indexOf(J)>=0?G:[].concat(wg(G),[J])},[]))}else if(_==="category")j?L=L.filter(function(G){return G!==""&&!rr(G)}):L=GG(B,L,b).reduce(function(G,J){return G.indexOf(J)>=0||J===""||rr(J)?G:[].concat(wg(G),[J])},[]);else if(_==="number"){var q=S3e(H,a.filter(function(G){var J,X,V=i in G.props?G.props[i]:(J=G.type.defaultProps)===null||J===void 0?void 0:J[i],se="hide"in G.props?G.props.hide:(X=G.type.defaultProps)===null||X===void 0?void 0:X.hide;return V===R&&(O||!se)}),N,s,d);q&&(L=q)}p&&(_==="number"||E!=="auto")&&(M=Mb(H,N,"category"))}else p?L=q_(0,$):l&&l[R]&&l[R].hasStack&&_==="number"?L=m==="expand"?[0,1]:ule(l[R].stackGroups,c,u):L=ale(H,a.filter(function(G){var J=i in G.props?G.props[i]:G.type.defaultProps[i],X="hide"in G.props?G.props.hide:G.type.defaultProps.hide;return J===R&&(O||!X)}),_,d,!0);if(_==="number")L=oR(f,L,R,s,T),B&&(L=SI(B,L,k));else if(_==="category"&&B){var Q=B,W=L.every(function(G){return Q.indexOf(G)>=0});W&&(L=Q)}}return Be(Be({},v),{},Gt({},R,Be(Be({},S),{},{axisType:s,domain:L,categoricalDomain:M,duplicateDomain:A,originalDomain:(y=S.domain)!==null&&y!==void 0?y:P,isCategorical:p,layout:d})))},{})},J5e=function(t,r){var n=r.graphicalItems,a=r.Axis,s=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,m=Gj(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),p=m.length,v=sle(d,s),b=-1;return n.reduce(function(y,S){var _=S.type.defaultProps!==void 0?Be(Be({},S.type.defaultProps),S.props):S.props,N=_[i],k=Sce("number");if(!y[N]){b++;var j;return v?j=q_(0,p):l&&l[N]&&l[N].hasStack?(j=ule(l[N].stackGroups,c,u),j=oR(f,j,N,s)):(j=SI(k,ale(m,n.filter(function(E){var T,O,R=i in E.props?E.props[i]:(T=E.type.defaultProps)===null||T===void 0?void 0:T[i],H="hide"in E.props?E.props.hide:(O=E.type.defaultProps)===null||O===void 0?void 0:O.hide;return R===N&&!H}),"number",d),a.defaultProps.allowDataOverflow),j=oR(f,j,N,s)),Be(Be({},y),{},Gt({},N,Be(Be({axisType:s},a.defaultProps),{},{hide:!0,orientation:Di(K5e,"".concat(s,".").concat(b%2),null),domain:j,originalDomain:k,isCategorical:v,layout:d})))}return y},{})},Z5e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,s=r.AxisComp,i=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.children,f="".concat(a,"Id"),m=Li(d,s),p={};return m&&m.length?p=Q5e(t,{axes:m,graphicalItems:i,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):i&&i.length&&(p=J5e(t,{Axis:s,graphicalItems:i,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),p},X5e=function(t){var r=ud(t),n=Hc(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:yz(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:T_(r,n)}},GY=function(t){var r=t.children,n=t.defaultShowTooltip,a=Ni(r,dg),s=0,i=0;return t.data&&t.data.length!==0&&(i=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(s=a.props.startIndex),a.props.endIndex>=0&&(i=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:i,activeTooltipIndex:-1,isTooltipActive:!!n}},e6e=function(t){return!t||!t.length?!1:t.some(function(r){var n=Yc(r&&r.type);return n&&n.indexOf("Bar")>=0})},VY=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},t6e=function(t,r){var n=t.props,a=t.graphicalItems,s=t.xAxisMap,i=s===void 0?{}:s,l=t.yAxisMap,c=l===void 0?{}:l,u=n.width,d=n.height,f=n.children,m=n.margin||{},p=Ni(f,dg),v=Ni(f,Ip),b=Object.keys(c).reduce(function(j,E){var T=c[E],O=T.orientation;return!T.mirror&&!T.hide?Be(Be({},j),{},Gt({},O,j[O]+T.width)):j},{left:m.left||0,right:m.right||0}),y=Object.keys(i).reduce(function(j,E){var T=i[E],O=T.orientation;return!T.mirror&&!T.hide?Be(Be({},j),{},Gt({},O,Di(j,"".concat(O))+T.height)):j},{top:m.top||0,bottom:m.bottom||0}),S=Be(Be({},y),b),_=S.bottom;p&&(S.bottom+=p.props.height||dg.defaultProps.height),v&&r&&(S=x3e(S,a,n,r));var N=u-S.left-S.right,k=d-S.top-S.bottom;return Be(Be({brushBottom:_},S),{},{width:Math.max(N,0),height:Math.max(k,0)})},r6e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},n9=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,s=a===void 0?"axis":a,i=t.validateTooltipEventTypes,l=i===void 0?["axis"]:i,c=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,f=t.defaultProps,m=function(S,_){var N=_.graphicalItems,k=_.stackGroups,j=_.offset,E=_.updateId,T=_.dataStartIndex,O=_.dataEndIndex,R=S.barSize,H=S.layout,$=S.barGap,L=S.barCategoryGap,A=S.maxBarSize,M=VY(H),P=M.numericAxisName,I=M.cateAxisName,B=e6e(N),F=[];return N.forEach(function(q,Q){var W=Gj(S.data,{graphicalItems:[q],dataStartIndex:T,dataEndIndex:O}),G=q.type.defaultProps!==void 0?Be(Be({},q.type.defaultProps),q.props):q.props,J=G.dataKey,X=G.maxBarSize,V=G["".concat(P,"Id")],se=G["".concat(I,"Id")],de={},he=c.reduce(function(we,pe){var Oe=_["".concat(pe.axisType,"Map")],Ae=G["".concat(pe.axisType,"Id")];Oe&&Oe[Ae]||pe.axisType==="zAxis"||gh(!1);var Re=Oe[Ae];return Be(Be({},we),{},Gt(Gt({},pe.axisType,Re),"".concat(pe.axisType,"Ticks"),Hc(Re)))},de),te=he[I],le=he["".concat(I,"Ticks")],oe=k&&k[V]&&k[V].hasStack&&A3e(q,k[V].stackGroups),Z=Yc(q.type).indexOf("Bar")>=0,ve=T_(te,le),U=[],ge=B&&b3e({barSize:R,stackGroups:k,totalSize:r6e(he,I)});if(Z){var ue,re,ne=rr(X)?A:X,me=(ue=(re=T_(te,le,!0))!==null&&re!==void 0?re:ne)!==null&&ue!==void 0?ue:0;U=y3e({barGap:$,barCategoryGap:L,bandSize:me!==ve?me:ve,sizeList:ge[se],maxBarSize:ne}),me!==ve&&(U=U.map(function(we){return Be(Be({},we),{},{position:Be(Be({},we.position),{},{offset:we.position.offset-me/2})})}))}var ke=q&&q.type&&q.type.getComposedData;ke&&F.push({props:Be(Be({},ke(Be(Be({},he),{},{displayedData:W,props:S,dataKey:J,item:q,bandSize:ve,barPosition:U,offset:j,stackedData:oe,layout:H,dataStartIndex:T,dataEndIndex:O}))),{},Gt(Gt(Gt({key:q.key||"item-".concat(Q)},P,he[P]),I,he[I]),"animationId",E)),childIndex:bNe(q,S.children),item:q})}),F},p=function(S,_){var N=S.props,k=S.dataStartIndex,j=S.dataEndIndex,E=S.updateId;if(!i7({props:N}))return null;var T=N.children,O=N.layout,R=N.stackOffset,H=N.data,$=N.reverseStackOrder,L=VY(O),A=L.numericAxisName,M=L.cateAxisName,P=Li(T,n),I=M3e(H,P,"".concat(A,"Id"),"".concat(M,"Id"),R,$),B=c.reduce(function(G,J){var X="".concat(J.axisType,"Map");return Be(Be({},G),{},Gt({},X,Z5e(N,Be(Be({},J),{},{graphicalItems:P,stackGroups:J.axisType===A&&I,dataStartIndex:k,dataEndIndex:j}))))},{}),F=t6e(Be(Be({},B),{},{props:N,graphicalItems:P}),_?.legendBBox);Object.keys(B).forEach(function(G){B[G]=d(N,B[G],F,G.replace("Map",""),r)});var q=B["".concat(M,"Map")],Q=X5e(q),W=m(N,Be(Be({},B),{},{dataStartIndex:k,dataEndIndex:j,updateId:E,graphicalItems:P,stackGroups:I,offset:F}));return Be(Be({formattedGraphicalItems:W,graphicalItems:P,offset:F,stackGroups:I},Q),B)},v=(function(y){function S(_){var N,k,j;return I5e(this,S),j=z5e(this,S,[_]),Gt(j,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Gt(j,"accessibilityManager",new w5e),Gt(j,"handleLegendBBoxUpdate",function(E){if(E){var T=j.state,O=T.dataStartIndex,R=T.dataEndIndex,H=T.updateId;j.setState(Be({legendBBox:E},p({props:j.props,dataStartIndex:O,dataEndIndex:R,updateId:H},Be(Be({},j.state),{},{legendBBox:E}))))}}),Gt(j,"handleReceiveSyncEvent",function(E,T,O){if(j.props.syncId===E){if(O===j.eventEmitterSymbol&&typeof j.props.syncMethod!="function")return;j.applySyncEvent(T)}}),Gt(j,"handleBrushChange",function(E){var T=E.startIndex,O=E.endIndex;if(T!==j.state.dataStartIndex||O!==j.state.dataEndIndex){var R=j.state.updateId;j.setState(function(){return Be({dataStartIndex:T,dataEndIndex:O},p({props:j.props,dataStartIndex:T,dataEndIndex:O,updateId:R},j.state))}),j.triggerSyncEvent({dataStartIndex:T,dataEndIndex:O})}}),Gt(j,"handleMouseEnter",function(E){var T=j.getMouseInfo(E);if(T){var O=Be(Be({},T),{},{isTooltipActive:!0});j.setState(O),j.triggerSyncEvent(O);var R=j.props.onMouseEnter;er(R)&&R(O,E)}}),Gt(j,"triggeredAfterMouseMove",function(E){var T=j.getMouseInfo(E),O=T?Be(Be({},T),{},{isTooltipActive:!0}):{isTooltipActive:!1};j.setState(O),j.triggerSyncEvent(O);var R=j.props.onMouseMove;er(R)&&R(O,E)}),Gt(j,"handleItemMouseEnter",function(E){j.setState(function(){return{isTooltipActive:!0,activeItem:E,activePayload:E.tooltipPayload,activeCoordinate:E.tooltipPosition||{x:E.cx,y:E.cy}}})}),Gt(j,"handleItemMouseLeave",function(){j.setState(function(){return{isTooltipActive:!1}})}),Gt(j,"handleMouseMove",function(E){E.persist(),j.throttleTriggeredAfterMouseMove(E)}),Gt(j,"handleMouseLeave",function(E){j.throttleTriggeredAfterMouseMove.cancel();var T={isTooltipActive:!1};j.setState(T),j.triggerSyncEvent(T);var O=j.props.onMouseLeave;er(O)&&O(T,E)}),Gt(j,"handleOuterEvent",function(E){var T=vNe(E),O=Di(j.props,"".concat(T));if(T&&er(O)){var R,H;/.*touch.*/i.test(T)?H=j.getMouseInfo(E.changedTouches[0]):H=j.getMouseInfo(E),O((R=H)!==null&&R!==void 0?R:{},E)}}),Gt(j,"handleClick",function(E){var T=j.getMouseInfo(E);if(T){var O=Be(Be({},T),{},{isTooltipActive:!0});j.setState(O),j.triggerSyncEvent(O);var R=j.props.onClick;er(R)&&R(O,E)}}),Gt(j,"handleMouseDown",function(E){var T=j.props.onMouseDown;if(er(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"handleMouseUp",function(E){var T=j.props.onMouseUp;if(er(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"handleTouchMove",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&j.throttleTriggeredAfterMouseMove(E.changedTouches[0])}),Gt(j,"handleTouchStart",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&j.handleMouseDown(E.changedTouches[0])}),Gt(j,"handleTouchEnd",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&j.handleMouseUp(E.changedTouches[0])}),Gt(j,"handleDoubleClick",function(E){var T=j.props.onDoubleClick;if(er(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"handleContextMenu",function(E){var T=j.props.onContextMenu;if(er(T)){var O=j.getMouseInfo(E);T(O,E)}}),Gt(j,"triggerSyncEvent",function(E){j.props.syncId!==void 0&&kD.emit(_D,j.props.syncId,E,j.eventEmitterSymbol)}),Gt(j,"applySyncEvent",function(E){var T=j.props,O=T.layout,R=T.syncMethod,H=j.state.updateId,$=E.dataStartIndex,L=E.dataEndIndex;if(E.dataStartIndex!==void 0||E.dataEndIndex!==void 0)j.setState(Be({dataStartIndex:$,dataEndIndex:L},p({props:j.props,dataStartIndex:$,dataEndIndex:L,updateId:H},j.state)));else if(E.activeTooltipIndex!==void 0){var A=E.chartX,M=E.chartY,P=E.activeTooltipIndex,I=j.state,B=I.offset,F=I.tooltipTicks;if(!B)return;if(typeof R=="function")P=R(F,E);else if(R==="value"){P=-1;for(var q=0;q<F.length;q++)if(F[q].value===E.activeLabel){P=q;break}}var Q=Be(Be({},B),{},{x:B.left,y:B.top}),W=Math.min(A,Q.x+Q.width),G=Math.min(M,Q.y+Q.height),J=F[P]&&F[P].value,X=uR(j.state,j.props.data,P),V=F[P]?{x:O==="horizontal"?F[P].coordinate:W,y:O==="horizontal"?G:F[P].coordinate}:wce;j.setState(Be(Be({},E),{},{activeLabel:J,activeCoordinate:V,activePayload:X,activeTooltipIndex:P}))}else j.setState(E)}),Gt(j,"renderCursor",function(E){var T,O=j.state,R=O.isTooltipActive,H=O.activeCoordinate,$=O.activePayload,L=O.offset,A=O.activeTooltipIndex,M=O.tooltipAxisBandSize,P=j.getTooltipEventType(),I=(T=E.props.active)!==null&&T!==void 0?T:R,B=j.props.layout,F=E.key||"_recharts-cursor";return ce.createElement(E5e,{key:F,activeCoordinate:H,activePayload:$,activeTooltipIndex:A,chartName:r,element:E,isActive:I,layout:B,offset:L,tooltipAxisBandSize:M,tooltipEventType:P})}),Gt(j,"renderPolarAxis",function(E,T,O){var R=Di(E,"type.axisType"),H=Di(j.state,"".concat(R,"Map")),$=E.type.defaultProps,L=$!==void 0?Be(Be({},$),E.props):E.props,A=H&&H[L["".concat(R,"Id")]];return w.cloneElement(E,Be(Be({},A),{},{className:ur(R,A.className),key:E.key||"".concat(T,"-").concat(O),ticks:Hc(A,!0)}))}),Gt(j,"renderPolarGrid",function(E){var T=E.props,O=T.radialLines,R=T.polarAngles,H=T.polarRadius,$=j.state,L=$.radiusAxisMap,A=$.angleAxisMap,M=ud(L),P=ud(A),I=P.cx,B=P.cy,F=P.innerRadius,q=P.outerRadius;return w.cloneElement(E,{polarAngles:Array.isArray(R)?R:Hc(P,!0).map(function(Q){return Q.coordinate}),polarRadius:Array.isArray(H)?H:Hc(M,!0).map(function(Q){return Q.coordinate}),cx:I,cy:B,innerRadius:F,outerRadius:q,key:E.key||"polar-grid",radialLines:O})}),Gt(j,"renderLegend",function(){var E=j.state.formattedGraphicalItems,T=j.props,O=T.children,R=T.width,H=T.height,$=j.props.margin||{},L=R-($.left||0)-($.right||0),A=rle({children:O,formattedGraphicalItems:E,legendWidth:L,legendContent:u});if(!A)return null;var M=A.item,P=qY(A,M5e);return w.cloneElement(M,Be(Be({},P),{},{chartWidth:R,chartHeight:H,margin:$,onBBoxUpdate:j.handleLegendBBoxUpdate}))}),Gt(j,"renderTooltip",function(){var E,T=j.props,O=T.children,R=T.accessibilityLayer,H=Ni(O,Ci);if(!H)return null;var $=j.state,L=$.isTooltipActive,A=$.activeCoordinate,M=$.activePayload,P=$.activeLabel,I=$.offset,B=(E=H.props.active)!==null&&E!==void 0?E:L;return w.cloneElement(H,{viewBox:Be(Be({},I),{},{x:I.left,y:I.top}),active:B,label:P,payload:B?M:[],coordinate:A,accessibilityLayer:R})}),Gt(j,"renderBrush",function(E){var T=j.props,O=T.margin,R=T.data,H=j.state,$=H.offset,L=H.dataStartIndex,A=H.dataEndIndex,M=H.updateId;return w.cloneElement(E,{key:E.key||"_recharts-brush",onChange:aS(j.handleBrushChange,E.props.onChange),data:R,x:tt(E.props.x)?E.props.x:$.left,y:tt(E.props.y)?E.props.y:$.top+$.height+$.brushBottom-(O.bottom||0),width:tt(E.props.width)?E.props.width:$.width,startIndex:L,endIndex:A,updateId:"brush-".concat(M)})}),Gt(j,"renderReferenceElement",function(E,T,O){if(!E)return null;var R=j,H=R.clipPathId,$=j.state,L=$.xAxisMap,A=$.yAxisMap,M=$.offset,P=E.type.defaultProps||{},I=E.props,B=I.xAxisId,F=B===void 0?P.xAxisId:B,q=I.yAxisId,Q=q===void 0?P.yAxisId:q;return w.cloneElement(E,{key:E.key||"".concat(T,"-").concat(O),xAxis:L[F],yAxis:A[Q],viewBox:{x:M.left,y:M.top,width:M.width,height:M.height},clipPathId:H})}),Gt(j,"renderActivePoints",function(E){var T=E.item,O=E.activePoint,R=E.basePoint,H=E.childIndex,$=E.isRange,L=[],A=T.props.key,M=T.item.type.defaultProps!==void 0?Be(Be({},T.item.type.defaultProps),T.item.props):T.item.props,P=M.activeDot,I=M.dataKey,B=Be(Be({index:H,dataKey:I,cx:O.x,cy:O.y,r:4,fill:Wz(T.item),strokeWidth:2,stroke:"#fff",payload:O.payload,value:O.value},Ht(P,!1)),s_(P));return L.push(S.renderActiveDot(P,B,"".concat(A,"-activePoint-").concat(H))),R?L.push(S.renderActiveDot(P,Be(Be({},B),{},{cx:R.x,cy:R.y}),"".concat(A,"-basePoint-").concat(H))):$&&L.push(null),L}),Gt(j,"renderGraphicChild",function(E,T,O){var R=j.filterFormatItem(E,T,O);if(!R)return null;var H=j.getTooltipEventType(),$=j.state,L=$.isTooltipActive,A=$.tooltipAxis,M=$.activeTooltipIndex,P=$.activeLabel,I=j.props.children,B=Ni(I,Ci),F=R.props,q=F.points,Q=F.isRange,W=F.baseLine,G=R.item.type.defaultProps!==void 0?Be(Be({},R.item.type.defaultProps),R.item.props):R.item.props,J=G.activeDot,X=G.hide,V=G.activeBar,se=G.activeShape,de=!!(!X&&L&&B&&(J||V||se)),he={};H!=="axis"&&B&&B.props.trigger==="click"?he={onClick:aS(j.handleItemMouseEnter,E.props.onClick)}:H!=="axis"&&(he={onMouseLeave:aS(j.handleItemMouseLeave,E.props.onMouseLeave),onMouseEnter:aS(j.handleItemMouseEnter,E.props.onMouseEnter)});var te=w.cloneElement(E,Be(Be({},R.props),he));function le(pe){return typeof A.dataKey=="function"?A.dataKey(pe.payload):null}if(de)if(M>=0){var oe,Z;if(A.dataKey&&!A.allowDuplicatedCategory){var ve=typeof A.dataKey=="function"?le:"payload.".concat(A.dataKey.toString());oe=a_(q,ve,P),Z=Q&&W&&a_(W,ve,P)}else oe=q?.[M],Z=Q&&W&&W[M];if(se||V){var U=E.props.activeIndex!==void 0?E.props.activeIndex:M;return[w.cloneElement(E,Be(Be(Be({},R.props),he),{},{activeIndex:U})),null,null]}if(!rr(oe))return[te].concat(wg(j.renderActivePoints({item:R,activePoint:oe,basePoint:Z,childIndex:M,isRange:Q})))}else{var ge,ue=(ge=j.getItemByXY(j.state.activeCoordinate))!==null&&ge!==void 0?ge:{graphicalItem:te},re=ue.graphicalItem,ne=re.item,me=ne===void 0?E:ne,ke=re.childIndex,we=Be(Be(Be({},R.props),he),{},{activeIndex:ke});return[w.cloneElement(me,we),null,null]}return Q?[te,null,null]:[te,null]}),Gt(j,"renderCustomized",function(E,T,O){return w.cloneElement(E,Be(Be({key:"recharts-customized-".concat(O)},j.props),j.state))}),Gt(j,"renderMap",{CartesianGrid:{handler:cS,once:!0},ReferenceArea:{handler:j.renderReferenceElement},ReferenceLine:{handler:cS},ReferenceDot:{handler:j.renderReferenceElement},XAxis:{handler:cS},YAxis:{handler:cS},Brush:{handler:j.renderBrush,once:!0},Bar:{handler:j.renderGraphicChild},Line:{handler:j.renderGraphicChild},Area:{handler:j.renderGraphicChild},Radar:{handler:j.renderGraphicChild},RadialBar:{handler:j.renderGraphicChild},Scatter:{handler:j.renderGraphicChild},Pie:{handler:j.renderGraphicChild},Funnel:{handler:j.renderGraphicChild},Tooltip:{handler:j.renderCursor,once:!0},PolarGrid:{handler:j.renderPolarGrid,once:!0},PolarAngleAxis:{handler:j.renderPolarAxis},PolarRadiusAxis:{handler:j.renderPolarAxis},Customized:{handler:j.renderCustomized}}),j.clipPathId="".concat((N=_.id)!==null&&N!==void 0?N:l0("recharts"),"-clip"),j.throttleTriggeredAfterMouseMove=Xie(j.triggeredAfterMouseMove,(k=_.throttleDelay)!==null&&k!==void 0?k:1e3/60),j.state={},j}return F5e(S,y),P5e(S,[{key:"componentDidMount",value:function(){var N,k;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(N=this.props.margin.left)!==null&&N!==void 0?N:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var N=this.props,k=N.children,j=N.data,E=N.height,T=N.layout,O=Ni(k,Ci);if(O){var R=O.props.defaultIndex;if(!(typeof R!="number"||R<0||R>this.state.tooltipTicks.length-1)){var H=this.state.tooltipTicks[R]&&this.state.tooltipTicks[R].value,$=uR(this.state,j,R,H),L=this.state.tooltipTicks[R].coordinate,A=(this.state.offset.top+E)/2,M=T==="horizontal",P=M?{x:L,y:A}:{y:L,x:A},I=this.state.formattedGraphicalItems.find(function(F){var q=F.item;return q.type.name==="Scatter"});I&&(P=Be(Be({},P),I.props.points[R].tooltipPosition),$=I.props.points[R].tooltipPayload);var B={activeTooltipIndex:R,isTooltipActive:!0,activeLabel:H,activePayload:$,activeCoordinate:P};this.setState(B),this.renderCursor(O),this.accessibilityManager.setIndex(R)}}}},{key:"getSnapshotBeforeUpdate",value:function(N,k){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==k.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==N.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==N.margin){var j,E;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(E=this.props.margin.top)!==null&&E!==void 0?E:0}})}return null}},{key:"componentDidUpdate",value:function(N){HO([Ni(N.children,Ci)],[Ni(this.props.children,Ci)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var N=Ni(this.props.children,Ci);if(N&&typeof N.props.shared=="boolean"){var k=N.props.shared?"axis":"item";return l.indexOf(k)>=0?k:s}return s}},{key:"getMouseInfo",value:function(N){if(!this.container)return null;var k=this.container,j=k.getBoundingClientRect(),E=aEe(j),T={chartX:Math.round(N.pageX-E.left),chartY:Math.round(N.pageY-E.top)},O=j.width/k.offsetWidth||1,R=this.inRange(T.chartX,T.chartY,O);if(!R)return null;var H=this.state,$=H.xAxisMap,L=H.yAxisMap,A=this.getTooltipEventType(),M=KY(this.state,this.props.data,this.props.layout,R);if(A!=="axis"&&$&&L){var P=ud($).scale,I=ud(L).scale,B=P&&P.invert?P.invert(T.chartX):null,F=I&&I.invert?I.invert(T.chartY):null;return Be(Be({},T),{},{xValue:B,yValue:F},M)}return M?Be(Be({},T),M):null}},{key:"inRange",value:function(N,k){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,E=this.props.layout,T=N/j,O=k/j;if(E==="horizontal"||E==="vertical"){var R=this.state.offset,H=T>=R.left&&T<=R.left+R.width&&O>=R.top&&O<=R.top+R.height;return H?{x:T,y:O}:null}var $=this.state,L=$.angleAxisMap,A=$.radiusAxisMap;if(L&&A){var M=ud(L);return QG({x:T,y:O},M)}return null}},{key:"parseEventsOfWrapper",value:function(){var N=this.props.children,k=this.getTooltipEventType(),j=Ni(N,Ci),E={};j&&k==="axis"&&(j.props.trigger==="click"?E={onClick:this.handleClick}:E={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var T=s_(this.props,this.handleOuterEvent);return Be(Be({},T),E)}},{key:"addListener",value:function(){kD.on(_D,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){kD.removeListener(_D,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(N,k,j){for(var E=this.state.formattedGraphicalItems,T=0,O=E.length;T<O;T++){var R=E[T];if(R.item===N||R.props.key===N.key||k===Yc(R.item.type)&&j===R.childIndex)return R}return null}},{key:"renderClipPath",value:function(){var N=this.clipPathId,k=this.state.offset,j=k.left,E=k.top,T=k.height,O=k.width;return ce.createElement("defs",null,ce.createElement("clipPath",{id:N},ce.createElement("rect",{x:j,y:E,height:T,width:O})))}},{key:"getXScales",value:function(){var N=this.state.xAxisMap;return N?Object.entries(N).reduce(function(k,j){var E=HY(j,2),T=E[0],O=E[1];return Be(Be({},k),{},Gt({},T,O.scale))},{}):null}},{key:"getYScales",value:function(){var N=this.state.yAxisMap;return N?Object.entries(N).reduce(function(k,j){var E=HY(j,2),T=E[0],O=E[1];return Be(Be({},k),{},Gt({},T,O.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(N){var k;return(k=this.state.xAxisMap)===null||k===void 0||(k=k[N])===null||k===void 0?void 0:k.scale}},{key:"getYScaleByAxisId",value:function(N){var k;return(k=this.state.yAxisMap)===null||k===void 0||(k=k[N])===null||k===void 0?void 0:k.scale}},{key:"getItemByXY",value:function(N){var k=this.state,j=k.formattedGraphicalItems,E=k.activeItem;if(j&&j.length)for(var T=0,O=j.length;T<O;T++){var R=j[T],H=R.props,$=R.item,L=$.type.defaultProps!==void 0?Be(Be({},$.type.defaultProps),$.props):$.props,A=Yc($.type);if(A==="Bar"){var M=(H.data||[]).find(function(F){return TLe(N,F)});if(M)return{graphicalItem:R,payload:M}}else if(A==="RadialBar"){var P=(H.data||[]).find(function(F){return QG(N,F)});if(P)return{graphicalItem:R,payload:P}}else if($j(R,E)||Fj(R,E)||Ry(R,E)){var I=XOe({graphicalItem:R,activeTooltipItem:E,itemData:L.data}),B=L.activeIndex===void 0?I:L.activeIndex;return{graphicalItem:Be(Be({},R),{},{childIndex:B}),payload:Ry(R,E)?L.data[I]:R.props.data[I]}}}return null}},{key:"render",value:function(){var N=this;if(!i7(this))return null;var k=this.props,j=k.children,E=k.className,T=k.width,O=k.height,R=k.style,H=k.compact,$=k.title,L=k.desc,A=qY(k,T5e),M=Ht(A,!1);if(H)return ce.createElement(_Y,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ce.createElement(WO,jp({},M,{width:T,height:O,title:$,desc:L}),this.renderClipPath(),l7(j,this.renderMap)));if(this.props.accessibilityLayer){var P,I;M.tabIndex=(P=this.props.tabIndex)!==null&&P!==void 0?P:0,M.role=(I=this.props.role)!==null&&I!==void 0?I:"application",M.onKeyDown=function(F){N.accessibilityManager.keyboardEvent(F)},M.onFocus=function(){N.accessibilityManager.focus()}}var B=this.parseEventsOfWrapper();return ce.createElement(_Y,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ce.createElement("div",jp({className:ur("recharts-wrapper",E),style:Be({position:"relative",cursor:"default",width:T,height:O},R)},B,{ref:function(q){N.container=q}}),ce.createElement(WO,jp({},M,{width:T,height:O,title:$,desc:L,style:G5e}),this.renderClipPath(),l7(j,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(w.Component);Gt(v,"displayName",r),Gt(v,"defaultProps",Be({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Gt(v,"getDerivedStateFromProps",function(y,S){var _=y.dataKey,N=y.data,k=y.children,j=y.width,E=y.height,T=y.layout,O=y.stackOffset,R=y.margin,H=S.dataStartIndex,$=S.dataEndIndex;if(S.updateId===void 0){var L=GY(y);return Be(Be(Be({},L),{},{updateId:0},p(Be(Be({props:y},L),{},{updateId:0}),S)),{},{prevDataKey:_,prevData:N,prevWidth:j,prevHeight:E,prevLayout:T,prevStackOffset:O,prevMargin:R,prevChildren:k})}if(_!==S.prevDataKey||N!==S.prevData||j!==S.prevWidth||E!==S.prevHeight||T!==S.prevLayout||O!==S.prevStackOffset||!Op(R,S.prevMargin)){var A=GY(y),M={chartX:S.chartX,chartY:S.chartY,isTooltipActive:S.isTooltipActive},P=Be(Be({},KY(S,N,T)),{},{updateId:S.updateId+1}),I=Be(Be(Be({},A),M),P);return Be(Be(Be({},I),p(Be({props:y},I),S)),{},{prevDataKey:_,prevData:N,prevWidth:j,prevHeight:E,prevLayout:T,prevStackOffset:O,prevMargin:R,prevChildren:k})}if(!HO(k,S.prevChildren)){var B,F,q,Q,W=Ni(k,dg),G=W&&(B=(F=W.props)===null||F===void 0?void 0:F.startIndex)!==null&&B!==void 0?B:H,J=W&&(q=(Q=W.props)===null||Q===void 0?void 0:Q.endIndex)!==null&&q!==void 0?q:$,X=G!==H||J!==$,V=!rr(N),se=V&&!X?S.updateId:S.updateId+1;return Be(Be({updateId:se},p(Be(Be({props:y},S),{},{updateId:se,dataStartIndex:G,dataEndIndex:J}),S)),{},{prevChildren:k,dataStartIndex:G,dataEndIndex:J})}return null}),Gt(v,"renderActiveDot",function(y,S,_){var N;return w.isValidElement(y)?N=w.cloneElement(y,S):er(y)?N=y(S):N=ce.createElement(Ij,S),ce.createElement(Ir,{className:"recharts-active-dot",key:_},N)});var b=w.forwardRef(function(S,_){return ce.createElement(v,jp({},S,{ref:_}))});return b.displayName=v.displayName,b},n6e=n9({chartName:"LineChart",GraphicalChild:Xx,axisComponents:[{axisType:"xAxis",AxisComp:Qh},{axisType:"yAxis",AxisComp:Jh}],formatAxisMap:Ule}),kce=n9({chartName:"BarChart",GraphicalChild:qd,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Qh},{axisType:"yAxis",AxisComp:Jh}],formatAxisMap:Ule}),a6e=n9({chartName:"PieChart",GraphicalChild:pu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Bj},{axisType:"radiusAxis",AxisComp:Pj}],formatAxisMap:F3e,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const s6e=["#3b82f6","#eab308","#ef4444","#22c55e","#8b5cf6","#06b6d4"];function i6e({active:e,payload:t}){if(!e||!t?.length)return null;const r=t[0].payload;return o.jsxs("div",{className:"bg-card p-2 rounded-lg shadow-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.value," items"]})]})}function YY(e,t,r){if(e.color)return e.color;if(r?.colorMap){const a=e.key||e.name.toLowerCase().replace(/\s+/g,"_");if(r.colorMap[a])return r.colorMap[a]}const n=r?.defaultColors||s6e;return n[t%n.length]}function CD({data:e,colors:t,title:r,testId:n="status-pie-chart",isLoading:a=!1,isError:s=!1,errorMessage:i="Failed to load chart data",emptyMessage:l="No data to display",height:c=192,innerRadius:u,outerRadius:d,showLabels:f=!0,isMobile:m=!1,isTouchDevice:p=!1,onLegendClick:v,className:b=""}){const[y,S]=w.useState(null),_=w.useCallback((O,R)=>{p&&S(y===R?null:R)},[p,y]),N=w.useCallback(O=>{if(v){const R=O.key||O.name.toLowerCase().replace(/\s+/g,"_");v(R)}},[v]),k=u??(m?30:35),j=d??(m?50:60);if(a)return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{className:"flex items-center justify-center",style:{height:c},children:o.jsx("div",{className:"animate-pulse text-muted-foreground text-sm",children:"Loading chart..."})})]});if(s)return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{className:"flex items-center justify-center",style:{height:c},children:o.jsx("div",{className:"text-error text-sm",children:i})})]});if(e.reduce((O,R)=>O+R.value,0)===0||e.length===0)return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{className:"flex items-center justify-center",style:{height:c},children:o.jsx("div",{className:"text-muted-foreground text-sm",children:l})})]});const T=f&&!m;return o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${b}`,"data-testid":n,children:[r&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:r}),o.jsx("div",{style:{height:c},children:o.jsx(kj,{width:"100%",height:"100%",children:o.jsxs(a6e,{children:[o.jsx(pu,{data:e,cx:"50%",cy:"50%",innerRadius:k,outerRadius:j,dataKey:"value",labelLine:!1,label:T?({name:O,percent:R})=>`${O} ${((R??0)*100).toFixed(0)}%`:void 0,onClick:_,className:p?"cursor-pointer":"",children:e.map((O,R)=>o.jsx(Kx,{fill:YY(O,R,t),"data-testid":`chart-segment-${O.key||O.name.toLowerCase().replace(/\s+/g,"-")}`,stroke:y===R?"var(--color-foreground)":void 0,strokeWidth:y===R?2:0},`cell-${R}`))}),o.jsx(Ci,{content:o.jsx(i6e,{}),trigger:p?"click":"hover",wrapperStyle:{zIndex:1e3}})]})})}),m&&y!==null&&e[y]&&o.jsxs("div",{className:"mt-2 text-center text-sm text-foreground","data-testid":"mobile-tooltip",children:[o.jsx("span",{className:"font-medium",children:e[y].name}),o.jsxs("span",{className:"text-muted-foreground ml-2",children:[e[y].value," items"]})]}),o.jsx("div",{className:"mt-3 sm:mt-4 flex justify-center gap-2 sm:gap-4 flex-wrap","data-testid":"chart-legend",children:e.map((O,R)=>o.jsxs("button",{onClick:()=>N(O),className:`flex items-center gap-1 sm:gap-1.5 text-[10px] sm:text-xs text-muted-foreground hover:text-foreground transition-colors min-h-[28px] px-1 ${y===R?"text-foreground font-medium":""} ${v?"cursor-pointer":"cursor-default"}`,"data-testid":`legend-${O.key||O.name.toLowerCase().replace(/\s+/g,"-")}`,onTouchStart:()=>p&&S(R),disabled:!v,children:[o.jsx("span",{className:"w-2 h-2 sm:w-2.5 sm:h-2.5 rounded-full shrink-0",style:{backgroundColor:YY(O,R,t)}}),o.jsxs("span",{className:"truncate",children:[O.name,": ",O.value]})]},O.key||O.name))})]})}const o6e="var(--color-success, #22c55e)";function l6e({active:e,payload:t,label:r}){return!e||!t?.length?null:o.jsxs("div",{className:"bg-card p-2 rounded-lg shadow-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:r}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[t[0].value," completed"]})]})}function c6e({data:e,title:t,lineColor:r=o6e,showGrid:n=!0,showDots:a=!0,total:s,testId:i="trend-line-chart",isLoading:l=!1,isError:c=!1,errorMessage:u="Failed to load chart data",emptyMessage:d="No data to display",height:f=192,isMobile:m=!1,isTouchDevice:p=!1,className:v=""}){return l?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":i,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:f},children:o.jsx("div",{className:"animate-pulse text-muted-foreground text-sm",children:"Loading chart..."})})]}):c?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":i,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:f},children:o.jsx("div",{className:"text-error text-sm",children:u})})]}):e.length===0?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":i,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:f},children:o.jsx("div",{className:"text-muted-foreground text-sm",children:d})})]}):o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${v}`,"data-testid":i,children:[t&&o.jsxs("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:[o.jsx("span",{className:"hidden sm:inline",children:t}),o.jsx("span",{className:"sm:hidden",children:t.length>20?`${t.slice(0,20)}...`:t}),s!==void 0&&s>0&&o.jsxs("span",{className:"ml-1 sm:ml-2 text-[10px] sm:text-xs font-normal text-muted-foreground",children:["Total: ",s]})]}),o.jsx("div",{style:{height:f},children:o.jsx(kj,{width:"100%",height:"100%",children:o.jsxs(n6e,{data:e,children:[n&&o.jsx(r9,{strokeDasharray:"3 3",stroke:"var(--color-border, #e5e7eb)"}),o.jsx(Qh,{dataKey:"label",tick:{fontSize:m?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"},interval:m?1:0}),o.jsx(Jh,{allowDecimals:!1,tick:{fontSize:m?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"},width:m?25:30}),o.jsx(Ci,{content:o.jsx(l6e,{}),trigger:p?"click":"hover",wrapperStyle:{zIndex:1e3}}),o.jsx(Xx,{type:"monotone",dataKey:"value",stroke:r,strokeWidth:2,dot:a?{fill:r,strokeWidth:0,r:m?4:3}:!1,activeDot:{r:m?6:5,fill:r}})]})})})]})}const u6e="var(--color-primary, #3b82f6)";function d6e({active:e,payload:t}){if(!e||!t?.length)return null;const r=t[0].payload;return o.jsxs("div",{className:"bg-card p-2 rounded-lg shadow-lg border border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.value," item",r.value!==1?"s":"",r.percentage!==void 0&&` (${r.percentage}%)`]}),r.id&&o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Click to view details"})]})}function QY({data:e,title:t,barColor:r=u6e,onBarClick:n,maxBars:a=10,testId:s="horizontal-bar-chart",isLoading:i=!1,isError:l=!1,errorMessage:c="Failed to load chart data",emptyMessage:u="No data to display",height:d=192,isMobile:f=!1,isTouchDevice:m=!1,className:p=""}){const[v,b]=w.useState(null),y=e.slice(0,a).map(_=>({..._,displayName:f&&_.name.length>8?`${_.name.slice(0,8)}...`:_.name})),S=w.useCallback((_,N)=>{m?v===N?n?.(_):b(N):n?.(_)},[n,m,v]);return i?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":s,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:d},children:o.jsx("div",{className:"animate-pulse text-muted-foreground text-sm",children:"Loading chart..."})})]}):l?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":s,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:d},children:o.jsx("div",{className:"text-error text-sm",children:c})})]}):e.length===0?o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":s,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{className:"flex items-center justify-center",style:{height:d},children:o.jsx("div",{className:"text-muted-foreground text-sm",children:u})})]}):o.jsxs("div",{className:`bg-card rounded-lg shadow-sm p-4 sm:p-6 border border-border ${p}`,"data-testid":s,children:[t&&o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-foreground mb-3 sm:mb-4",children:t}),o.jsx("div",{style:{height:d},children:o.jsx(kj,{width:"100%",height:"100%",children:o.jsxs(kce,{data:y,layout:"vertical",children:[o.jsx(r9,{strokeDasharray:"3 3",stroke:"var(--color-border, #e5e7eb)"}),o.jsx(Qh,{type:"number",allowDecimals:!1,tick:{fontSize:f?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"}}),o.jsx(Jh,{type:"category",dataKey:"displayName",tick:{fontSize:f?9:10,fill:"var(--color-muted-foreground, #6b7280)"},axisLine:{stroke:"var(--color-border, #e5e7eb)"},tickLine:{stroke:"var(--color-border, #e5e7eb)"},width:f?55:70}),o.jsx(Ci,{content:o.jsx(d6e,{}),trigger:m?"click":"hover",wrapperStyle:{zIndex:1e3}}),o.jsx(qd,{dataKey:"value",fill:r,radius:[0,4,4,0],className:n?"cursor-pointer":"",onClick:(_,N)=>S(_,N)})]})})}),f&&v!==null&&e[v]&&o.jsxs("div",{className:"mt-2 text-center text-sm","data-testid":"mobile-tooltip-bar",children:[o.jsx("span",{className:"font-medium text-foreground",children:e[v].name}),o.jsxs("span",{className:"text-muted-foreground ml-2",children:[e[v].value," items"]}),n&&o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Tap again to view details"})]})]})}class f6e{constructor(t){_t(this,"socket",null);_t(this,"url");_t(this,"channels",new Set);_t(this,"eventListeners",new Set);_t(this,"stateListeners",new Set);_t(this,"state","disconnected");_t(this,"reconnectDelay");_t(this,"maxReconnectDelay");_t(this,"currentReconnectDelay");_t(this,"reconnectTimer",null);_t(this,"pingInterval");_t(this,"pingTimer",null);_t(this,"debug");if(this.url=t.url,this.reconnectDelay=t.reconnectDelay??1e3,this.maxReconnectDelay=t.maxReconnectDelay??3e4,this.currentReconnectDelay=this.reconnectDelay,this.pingInterval=t.pingInterval??3e4,this.debug=t.debug??!1,t.channels)for(const r of t.channels)this.channels.add(r)}log(...t){this.debug&&console.log("[ws]",...t)}get connectionState(){return this.state}get isConnected(){return this.state==="connected"}get subscribedChannels(){return[...this.channels]}connect(){if(!(this.socket&&(this.socket.readyState===WebSocket.OPEN||this.socket.readyState===WebSocket.CONNECTING))){this.setState("connecting");try{this.socket=new WebSocket(this.url),this.socket.onopen=()=>{this.log("Connected to server"),this.setState("connected"),this.currentReconnectDelay=this.reconnectDelay,this.channels.size>0&&this.sendSubscribe([...this.channels]),this.startPingTimer()},this.socket.onmessage=t=>{this.handleMessage(t.data)},this.socket.onclose=t=>{this.log(`Connection closed: ${t.code} ${t.reason}`),this.handleDisconnect()},this.socket.onerror=t=>{console.error("[ws] Connection error:",t)}}catch(t){console.error("[ws] Failed to create WebSocket:",t),this.handleDisconnect()}}}disconnect(){this.stopPingTimer(),this.cancelReconnect(),this.socket&&(this.socket.close(1e3,"Client disconnect"),this.socket=null),this.setState("disconnected")}subscribe(t){const r=Array.isArray(t)?t:[t];for(const n of r)this.channels.add(n);this.isConnected&&this.sendSubscribe(r)}unsubscribe(t){const r=Array.isArray(t)?t:[t];for(const n of r)this.channels.delete(n);this.isConnected&&this.send({type:"unsubscribe",channels:r})}addEventListener(t){return this.eventListeners.add(t),()=>this.eventListeners.delete(t)}addStateListener(t){return this.stateListeners.add(t),t(this.state),()=>this.stateListeners.delete(t)}sendMessage(t){return this.send(t)}send(t){return this.socket&&this.socket.readyState===WebSocket.OPEN?(this.socket.send(JSON.stringify(t)),!0):!1}sendSubscribe(t){this.send({type:"subscribe",channels:t})}handleMessage(t){try{const r=JSON.parse(t);switch(r.type){case"event":this.dispatchEvent(r.event);break;case"pong":break;case"subscribed":this.log("Subscribed to:",r.channels.join(", "));break;case"unsubscribed":this.log("Unsubscribed from:",r.channels.join(", "));break;case"error":console.error("[ws] Server error:",r.code,r.message);break}}catch(r){console.error("[ws] Failed to parse message:",r)}}dispatchEvent(t){for(const r of this.eventListeners)try{r(t)}catch(n){console.error("[ws] Error in event listener:",n)}}setState(t){if(this.state!==t){this.state=t;for(const r of this.stateListeners)try{r(t)}catch(n){console.error("[ws] Error in state listener:",n)}}}handleDisconnect(){this.stopPingTimer(),this.socket=null,this.setState("reconnecting"),this.scheduleReconnect()}scheduleReconnect(){this.reconnectTimer||(this.log(`Reconnecting in ${this.currentReconnectDelay}ms...`),this.reconnectTimer=setTimeout(()=>{this.reconnectTimer=null,this.connect(),this.currentReconnectDelay=Math.min(this.currentReconnectDelay*2,this.maxReconnectDelay)},this.currentReconnectDelay))}cancelReconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)}startPingTimer(){this.stopPingTimer(),this.pingTimer=setInterval(()=>{this.send({type:"ping"})},this.pingInterval)}stopPingTimer(){this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null)}}function h6e(e){const{url:t,channels:r,onEvent:n,onStateChange:a,autoConnect:s=!0,...i}=e,[l,c]=w.useState("disconnected"),[u,d]=w.useState(null),f=w.useRef(null);w.useEffect(()=>{const _=new f6e({url:t,channels:r,...i});f.current=_;const N=_.addStateListener(j=>{c(j),a?.(j)}),k=_.addEventListener(j=>{d(j),n?.(j)});return s&&_.connect(),()=>{N(),k(),_.disconnect(),f.current=null}},[t]),w.useEffect(()=>{const _=f.current;return _?_.addEventListener(k=>{d(k),n?.(k)}):void 0},[n]),w.useEffect(()=>{const _=f.current;return _?_.addStateListener(k=>{c(k),a?.(k)}):void 0},[a]);const m=w.useCallback(()=>{f.current?.connect()},[]),p=w.useCallback(()=>{f.current?.disconnect()},[]),v=w.useCallback(_=>{f.current?.subscribe(_)},[]),b=w.useCallback(_=>{f.current?.unsubscribe(_)},[]),y=w.useCallback(_=>f.current?.sendMessage(_)??!1,[]),S=f.current?.subscribedChannels??[];return{connectionState:l,isConnected:l==="connected",lastEvent:u,connect:m,disconnect:p,subscribe:v,unsubscribe:b,sendMessage:y,subscribedChannels:S}}function _ce(e){const t=[],{elementType:r,elementId:n,newValue:a}=e;switch(r){case"task":t.push(["tasks"]),t.push(["tasks",n]),t.push(["tasks","ready"]),t.push(["tasks","blocked"]),t.push(["tasks","completed"]),t.push(["stats"]);break;case"plan":t.push(["plans"]),t.push(["plans",n]),t.push(["stats"]);break;case"workflow":t.push(["workflows"]),t.push(["workflows",n]),t.push(["stats"]);break;case"entity":t.push(["entities"]),t.push(["entities",n]),t.push(["agents"]),t.push(["stats"]);break;case"document":t.push(["documents"]),t.push(["documents",n]),t.push(["stats"]);break;case"channel":t.push(["channels"]),t.push(["channels",n]),t.push(["stats"]);break;case"message":t.push(["messages"]),t.push(["messages",n]),a?.channelId&&t.push(["channels",String(a.channelId),"messages"]),a?.channel&&t.push(["channels",String(a.channel),"messages"]),a?.threadId&&t.push(["messages",String(a.threadId),"replies"]);break;case"team":t.push(["teams"]),t.push(["teams",n]),t.push(["stats"]);break;case"inbox-item":if(a?.recipientId){const s=String(a.recipientId);t.push(["inbox",s,"unread"]),t.push(["inbox",s,"all"]),t.push(["inbox",s,"archived"]),t.push(["inbox",s,"count"]),t.push(["inbox",s]),t.push(["entities",s,"inbox"]),t.push(["entities",s,"inbox","count"]),t.push(["agent-inbox",s,"unread"]),t.push(["agent-inbox",s,"all"]),t.push(["agent-inbox",s,"archived"]),t.push(["agent-inbox",s]),t.push(["agent-inbox-count",s])}t.push(["inbox"]);break;case"session":t.push(["sessions"]),t.push(["sessions",n]),a?.agentId&&t.push(["agents",String(a.agentId),"sessions"]);break;case"worktree":t.push(["worktrees"]),t.push(["worktrees",n]);break;default:t.push(["stats"])}return t}function m6e(e){const{queryClient:t,getQueryKeysForEvent:r=_ce,onEvent:n,onStateChange:a,autoInvalidate:s=!0,...i}=e,[l,c]=w.useState(null),u=w.useCallback(m=>{if(c(m),s&&t){const p=r(m);for(const v of p)t.invalidateQueries({queryKey:v})}n?.(m)},[s,t,r,n]),{connectionState:d,isConnected:f}=h6e({...i,onEvent:u,onStateChange:a});return{connectionState:d,isConnected:f,lastEvent:l}}const a9="settings.customShortcuts",dR="stoneforge:shortcuts-changed";function JY(e){if(e.includes("+")){const r=e.toLowerCase().split("+");return{type:"modifier",key:r[r.length-1],meta:r.includes("cmd")||r.includes("meta"),ctrl:r.includes("ctrl"),alt:r.includes("alt"),shift:r.includes("shift")}}return{type:"sequential",sequence:e.toLowerCase().split(" ").filter(Boolean)}}class p6e{constructor(){_t(this,"shortcuts",new Map);_t(this,"sequentialShortcuts",new Map);_t(this,"modifierShortcuts",new Map);_t(this,"pendingKeys",[]);_t(this,"sequenceTimeout",null);_t(this,"SEQUENCE_TIMEOUT",1e3);_t(this,"enabled",!0);_t(this,"started",!1);this.handleKeyDown=this.handleKeyDown.bind(this)}register(t,r,n){const a={keys:t,handler:r,description:n};this.shortcuts.set(t,a);const s=JY(t);if(s.type==="modifier"){const i=this.buildModifierKey(s);this.modifierShortcuts.set(i,a)}else if(s.sequence){const i=s.sequence.join(" ");this.sequentialShortcuts.set(i,a)}}unregister(t){if(!this.shortcuts.get(t))return;this.shortcuts.delete(t);const n=JY(t);if(n.type==="modifier"){const a=this.buildModifierKey(n);this.modifierShortcuts.delete(a)}else if(n.sequence){const a=n.sequence.join(" ");this.sequentialShortcuts.delete(a)}}buildModifierKey(t){const r=[];return t.meta&&r.push("meta"),t.ctrl&&r.push("ctrl"),t.alt&&r.push("alt"),t.shift&&r.push("shift"),r.push(t.key||""),r.join("+")}setEnabled(t){this.enabled=t,t||this.resetSequence()}isEnabled(){return this.enabled}isStarted(){return this.started}resetSequence(){this.pendingKeys=[],this.sequenceTimeout&&(clearTimeout(this.sequenceTimeout),this.sequenceTimeout=null)}handleKeyDown(t){if(!this.enabled)return;const r=t.target,n=r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable;if(t.metaKey||t.ctrlKey){const c=this.buildModifierKey({type:"modifier",key:t.key.toLowerCase(),meta:t.metaKey,ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey}),u=this.modifierShortcuts.get(c);if(u){t.preventDefault(),u.handler();return}}if(n){this.resetSequence();return}const a=t.key.toLowerCase();if(["meta","control","alt","shift"].includes(a))return;this.sequenceTimeout&&clearTimeout(this.sequenceTimeout),this.pendingKeys.push(a);const s=this.pendingKeys.join(" "),i=this.sequentialShortcuts.get(s);if(i){t.preventDefault(),this.resetSequence(),i.handler();return}Array.from(this.sequentialShortcuts.keys()).some(c=>c.startsWith(s+" "))?(t.preventDefault(),this.sequenceTimeout=setTimeout(()=>{this.resetSequence()},this.SEQUENCE_TIMEOUT)):this.resetSequence()}start(){this.started||(document.addEventListener("keydown",this.handleKeyDown),this.started=!0)}stop(){document.removeEventListener("keydown",this.handleKeyDown),this.resetSequence(),this.started=!1}getShortcuts(){return Array.from(this.shortcuts.values())}clear(){this.shortcuts.clear(),this.sequentialShortcuts.clear(),this.modifierShortcuts.clear(),this.resetSequence()}}let jD=null;function zp(){return jD||(jD=new p6e),jD}function Hy(){if(typeof window>"u")return{};try{const e=localStorage.getItem(a9);return e?JSON.parse(e):{}}catch{return{}}}function g6e(e){typeof window>"u"||(localStorage.setItem(a9,JSON.stringify(e)),Nce())}function s9(e,t){const r=Hy();return r[e]?r[e]:t[e]?.keys||""}function v6e(e,t,r){const n=Hy(),a=e.toLowerCase().trim();for(const[s,i]of Object.entries(t)){if(s===r)continue;if((n[s]||i.keys).toLowerCase().trim()===a)return s}return null}function b6e(e,t,r){const n=Hy();t===r[e]?.keys?delete n[e]:n[e]=t,g6e(n)}function y6e(){typeof window>"u"||(localStorage.removeItem(a9),Nce())}function Nce(){typeof window<"u"&&window.dispatchEvent(new CustomEvent(dR))}function e1(){const[e,t]=w.useState(0);return w.useEffect(()=>{const r=()=>{t(n=>n+1)};return window.addEventListener(dR,r),()=>{window.removeEventListener(dR,r)}},[]),e}function x6e(e,t,r){w.useEffect(()=>{const n=zp();return n.register(e,t,r),n.isStarted()||n.start(),()=>{n.unregister(e)}},[e,t,r])}function w6e(e){w.useEffect(()=>{const t=zp();return e?t.setEnabled(!1):t.setEnabled(!0),()=>{t.setEnabled(!0)}},[e])}const qy={draft:{label:"Draft",icon:ce.createElement(z6,{className:"w-4 h-4"}),color:"text-gray-600",bgColor:"bg-gray-100"},active:{label:"Active",icon:ce.createElement(sy,{className:"w-4 h-4"}),color:"text-blue-700",bgColor:"bg-blue-100"},completed:{label:"Completed",icon:ce.createElement(Yn,{className:"w-4 h-4"}),color:"text-green-700",bgColor:"bg-green-100"},cancelled:{label:"Cancelled",icon:ce.createElement(us,{className:"w-4 h-4"}),color:"text-red-700",bgColor:"bg-red-100"}},ED={draft:"#9ca3af",active:"#3b82f6",completed:"#22c55e",cancelled:"#ef4444"},Cce={1:"bg-gray-200",2:"bg-blue-200",3:"bg-yellow-200",4:"bg-orange-200",5:"bg-red-200"},fR="plans.search",jce="plans.viewMode",S6e=300;function k6e(){return typeof window>"u"?"":localStorage.getItem(fR)||""}function _6e(e){typeof window>"u"||(e?localStorage.setItem(fR,e):localStorage.removeItem(fR))}function N6e(){return typeof window>"u"?"list":localStorage.getItem(jce)==="roadmap"?"roadmap":"list"}function C6e(e){typeof window>"u"||localStorage.setItem(jce,e)}function ZY(e,t){if(!t)return{matched:!0,indices:[]};const r=e.toLowerCase(),n=t.toLowerCase(),a=[];let s=0;for(let i=0;i<r.length&&s<n.length;i++)r[i]===n[s]&&(a.push(i),s++);return s===n.length?{matched:!0,indices:a}:null}function j6e(e,t){if(t.length===0)return ce.createElement(ce.Fragment,null,e);const r=[],n=new Set(t);let a=0;for(let s=0;s<e.length;s++)n.has(s)&&(s>a&&r.push(ce.createElement("span",{key:`text-${a}`},e.slice(a,s))),r.push(ce.createElement("mark",{key:`match-${s}`,className:"bg-yellow-200 dark:bg-yellow-700/50 text-gray-900 dark:text-yellow-100 rounded-sm px-0.5"},e[s])),a=s+1);return a<e.length&&r.push(ce.createElement("span",{key:`text-${a}`},e.slice(a))),ce.createElement(ce.Fragment,null,...r)}function Ep(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function hR(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:Ep(e)}function E6e(e){return pt({queryKey:["plans",e,"with-progress"],queryFn:async()=>{const t=new URLSearchParams;t.set("hydrate.progress","true"),e&&t.set("status",e);const r=await fetch(`/api/plans?${t.toString()}`);if(!r.ok)throw new Error("Failed to fetch plans");return r.json()}})}function M6e(e){return pt({queryKey:["plans",e],queryFn:async()=>{if(!e)throw new Error("No plan selected");const t=await fetch(`/api/plans/${e}?hydrate.progress=true`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch plan")}return t.json()},enabled:!!e})}function T6e(e){return pt({queryKey:["plans",e,"tasks"],queryFn:async()=>{if(!e)throw new Error("No plan selected");const t=await fetch(`/api/plans/${e}/tasks`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch plan tasks")}return t.json()},enabled:!!e})}function A6e(e){return pt({queryKey:["plans",e,"progress"],queryFn:async()=>{if(!e)throw new Error("No plan selected");const t=await fetch(`/api/plans/${e}/progress`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch plan progress")}return t.json()},enabled:!!e})}function D6e(){const e=ft();return kt({mutationFn:async({planId:t,updates:r})=>{const n=await fetch(`/api/plans/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to update plan")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["plans"]}),e.invalidateQueries({queryKey:["plans",r.planId]})}})}function L6e(){const e=ft();return kt({mutationFn:async({planId:t,taskId:r})=>{const n=await fetch(`/api/plans/${t}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to add task to plan")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["plans",r.planId,"tasks"]}),e.invalidateQueries({queryKey:["plans",r.planId,"progress"]}),e.invalidateQueries({queryKey:["plans",r.planId]})}})}function O6e(){const e=ft();return kt({mutationFn:async({planId:t,taskId:r})=>{const n=await fetch(`/api/plans/${t}/tasks/${r}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to remove task from plan")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["plans",r.planId,"tasks"]}),e.invalidateQueries({queryKey:["plans",r.planId,"progress"]}),e.invalidateQueries({queryKey:["plans",r.planId]})}})}function I6e(e,t){return pt({queryKey:["tasks","available",e,t],queryFn:async()=>{if(!e)return[];const r=await fetch("/api/tasks?limit=500");if(!r.ok)throw new Error("Failed to fetch tasks");const n=await r.json(),a=n.tasks||n.items||(Array.isArray(n)?n:[]),s=await fetch(`/api/plans/${e}/tasks`);if(!s.ok)throw new Error("Failed to fetch plan tasks");const i=await s.json(),l=new Set(i.map(u=>u.id));let c=a.filter(u=>!l.has(u.id));if(t){const u=t.toLowerCase();c=c.filter(d=>d.title.toLowerCase().includes(u)||d.id.toLowerCase().includes(u))}return c.slice(0,50)},enabled:!!e})}function R6e(){const e=ft();return kt({mutationFn:async t=>{const r=await fetch(`/api/plans/${t}`,{method:"DELETE"});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to delete plan")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["plans"]})}})}function P6e(){const e=ft();return kt({mutationFn:async({title:t,createdBy:r,initialTask:n,initialTaskId:a,additionalTasks:s,status:i,tags:l})=>{const c=await fetch("/api/plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,createdBy:r,initialTask:n,initialTaskId:a,status:i,tags:l})});if(!c.ok){const d=await c.json();throw new Error(d.error?.message||"Failed to create plan")}const u=await c.json();if(s&&s.length>0)try{const d=s.map(async f=>{if("existingTaskId"in f){const m=await fetch(`/api/plans/${u.id}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:f.existingTaskId})});if(!m.ok){const p=await m.json().catch(()=>({}));throw console.error("Failed to add existing task to plan:",p),new Error(p.error?.message||"Failed to add task to plan")}}else{const m=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:f.title,priority:f.priority||3,createdBy:r})});if(!m.ok){const y=await m.json().catch(()=>({}));throw console.error("Failed to create task:",y),new Error(y.error?.message||"Failed to create task")}const p=await m.json(),v=p.task||p,b=await fetch(`/api/plans/${u.id}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:v.id})});if(!b.ok){const y=await b.json().catch(()=>({}));throw console.error("Failed to add new task to plan:",y),new Error(y.error?.message||"Failed to add task to plan")}}});await Promise.all(d)}catch(d){console.error("Rolling back plan creation due to task error:",d);try{await fetch(`/api/plans/${u.id}`,{method:"DELETE"})}catch(f){console.error("Failed to rollback plan:",f)}throw d}return u},onSuccess:()=>{e.invalidateQueries({queryKey:["plans"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function Ece({status:e}){const t=qy[e]||qy.draft;return o.jsxs("span",{"data-testid":`status-badge-${e}`,className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${t.bgColor} ${t.color}`,children:[t.icon,t.label]})}const z6e=[{value:null,label:"All"},{value:"active",label:"Active"},{value:"draft",label:"Draft"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}];function B6e({selectedStatus:e,onStatusChange:t}){return o.jsx("div",{"data-testid":"status-filter",className:"flex gap-1 p-1 bg-gray-100 rounded-lg",children:z6e.map(r=>o.jsx("button",{"data-testid":`status-filter-${r.value??"all"}`,onClick:()=>t(r.value),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${e===r.value?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:r.label},r.value??"all"))})}function $6e({view:e,onViewChange:t}){return o.jsxs("div",{"data-testid":"view-toggle",className:"flex p-0.5 bg-gray-100 rounded-lg",children:[o.jsxs("button",{"data-testid":"view-toggle-list",onClick:()=>t("list"),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${e==="list"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,"aria-label":"List view",children:[o.jsx(Wp,{className:"w-4 h-4"}),"List"]}),o.jsxs("button",{"data-testid":"view-toggle-roadmap",onClick:()=>t("roadmap"),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${e==="roadmap"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,"aria-label":"Roadmap view",children:[o.jsx(Uae,{className:"w-4 h-4"}),"Roadmap"]})]})}function F6e({value:e,onChange:t,onClear:r}){const n=w.useRef(null);return w.useEffect(()=>{const a=s=>{s.key==="Escape"&&document.activeElement===n.current&&(s.preventDefault(),r(),n.current?.blur()),s.key==="/"&&!(s.target instanceof HTMLInputElement||s.target instanceof HTMLTextAreaElement)&&(s.preventDefault(),n.current?.focus())};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[r]),o.jsxs("div",{className:"relative flex-1 max-w-md","data-testid":"plan-search-container",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"}),o.jsx("input",{ref:n,type:"text",name:"plan-search",value:e,onChange:a=>t(a.target.value),placeholder:"Search plans... (Press / to focus)",className:"w-full pl-10 pr-8 py-1.5 text-sm border border-[var(--color-border)] dark:border-[var(--color-card-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors","data-testid":"plan-search-input"}),e&&o.jsx("button",{onClick:r,className:"absolute inset-y-0 right-0 pr-2 flex items-center text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]","data-testid":"plan-search-clear","aria-label":"Clear search (Escape)",children:o.jsx(yt,{className:"w-4 h-4"})})]})}function U6e({plan:e,isSelected:t,onClick:r,searchMatchIndices:n,progressRing:a}){const s=e._progress,i=s&&s.totalTasks>0,l=n&&n.length>0?j6e(e.title,n):e.title;return o.jsx("div",{"data-testid":`plan-item-${e.id}`,className:`p-4 rounded-lg border cursor-pointer transition-colors ${t?"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700":"bg-white dark:bg-[var(--color-surface)] border-gray-200 dark:border-[var(--color-border)] hover:border-gray-300 dark:hover:border-[var(--color-border-hover)] hover:bg-gray-50 dark:hover:bg-[var(--color-surface-hover)]"}`,onClick:()=>r(e.id),children:o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex items-start justify-between mb-2",children:o.jsx("h3",{"data-testid":"plan-item-title",className:"font-medium text-gray-900 dark:text-[var(--color-text)] truncate flex-1",children:l})}),o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(Ece,{status:e.status}),o.jsxs("span",{className:"text-xs text-gray-500 dark:text-[var(--color-text-tertiary)]",title:Ep(e.updatedAt),children:["Updated ",hR(e.updatedAt)]})]}),e.tags&&e.tags.length>0&&o.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map(c=>o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 dark:bg-[var(--color-surface-hover)] text-gray-600 dark:text-[var(--color-text-secondary)] rounded",children:c},c)),e.tags.length>3&&o.jsxs("span",{className:"text-xs text-gray-400 dark:text-[var(--color-text-tertiary)]",children:["+",e.tags.length-3]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a||(i?o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-blue-500 flex items-center justify-center",title:`${s.completionPercentage}% complete`,"data-testid":`plan-progress-${e.id}`,children:o.jsxs("span",{className:"text-[10px] text-blue-500 font-medium",children:[s.completionPercentage,"%"]})}):o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-dashed border-gray-200 dark:border-gray-600 flex items-center justify-center",title:"No tasks in plan","data-testid":`plan-progress-empty-${e.id}`,children:o.jsx("span",{className:"text-[8px] text-gray-400 dark:text-gray-500",children:"--"})})),o.jsx(gn,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})]})]})})}function H6e({tasks:e,isEditMode:t=!1,onRemoveTask:r,removingTaskId:n,onRemoveNotAllowed:a,taskLinkBase:s="/tasks"}){const[i,l]=w.useState(null);if(e.length===0)return o.jsx("div",{"data-testid":"plan-tasks-empty",className:"text-center py-8 text-gray-500 text-sm",children:"No tasks in this plan"});const c=e.length===1,u=d=>{if(c){a?.();return}i===d?(r?.(d),l(null)):l(d)};return o.jsxs("div",{"data-testid":"plan-tasks-list",className:"space-y-2",children:[c&&t&&o.jsxs("div",{"data-testid":"last-task-warning",className:"flex items-center gap-2 p-2 mb-2 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{children:"This is the only task. Plans must have at least one task."})]}),e.map(d=>o.jsxs("div",{"data-testid":`plan-task-${d.id}`,className:`flex items-center gap-3 p-2 bg-gray-50 rounded-lg group ${i===d.id?"bg-red-50 border border-red-200":""}`,children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${Cce[d.priority]||"bg-gray-200"}`,title:`Priority ${d.priority}`}),o.jsx("a",{href:`${s}?selected=${d.id}`,className:"flex-1 text-sm text-gray-900 truncate hover:text-blue-600 hover:underline",onClick:f=>f.stopPropagation(),children:d.title}),o.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${d.status==="closed"?"bg-green-100 text-green-700":d.status==="blocked"?"bg-red-100 text-red-700":d.status==="in_progress"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:d.status.replace("_"," ")}),t&&r&&o.jsx("button",{"data-testid":`remove-task-${d.id}`,onClick:()=>u(d.id),disabled:n===d.id||c,className:`p-1 rounded transition-colors ${c?"text-gray-300 cursor-not-allowed opacity-50":i===d.id?"bg-red-500 text-white hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50 opacity-0 group-hover:opacity-100"} ${n===d.id?"opacity-50 cursor-not-allowed":""}`,title:c?"Cannot remove - plans must have at least one task":i===d.id?"Click again to confirm removal":"Remove from plan",children:n===d.id?o.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):o.jsx(pr,{className:"w-4 h-4"})})]},d.id))]})}function q6e({progress:e}){const t=[{label:"Completed",count:e.completedTasks,icon:o.jsx(Yn,{className:"w-4 h-4 text-green-500"})},{label:"In Progress",count:e.inProgressTasks,icon:o.jsx(sy,{className:"w-4 h-4 text-blue-500"})},{label:"Blocked",count:e.blockedTasks,icon:o.jsx(Rt,{className:"w-4 h-4 text-red-500"})},{label:"Remaining",count:e.remainingTasks,icon:o.jsx(B6,{className:"w-4 h-4 text-gray-400"})}];return o.jsx("div",{"data-testid":"task-status-summary",className:"grid grid-cols-2 gap-3",children:t.map(r=>o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[r.icon,o.jsxs("div",{children:[o.jsx("div",{className:"text-lg font-semibold text-gray-900",children:r.count}),o.jsx("div",{className:"text-xs text-gray-500",children:r.label})]})]},r.label))})}function W6e({planId:e,onClose:t,onAddTask:r,isAdding:n}){const[a,s]=w.useState(""),[i,l]=w.useState(""),c=w.useRef(void 0);w.useEffect(()=>(c.current=setTimeout(()=>{l(a)},300),()=>{c.current&&clearTimeout(c.current)}),[a]);const{data:u=[],isLoading:d}=I6e(e,i);return o.jsx("div",{"data-testid":"task-picker-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:f=>f.target===f.currentTarget&&t(),children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[80vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add Task to Plan"}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","data-testid":"task-picker-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-4 border-b border-gray-200",children:o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text","data-testid":"task-picker-search",placeholder:"Search tasks by title or ID...",value:a,onChange:f=>s(f.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading tasks..."}):u.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:a?"No matching tasks found":"All tasks are already in this plan"}):o.jsx("div",{className:"space-y-2",children:u.map(f=>o.jsxs("button",{"data-testid":`task-picker-item-${f.id}`,onClick:()=>r(f.id),disabled:n,className:"w-full flex items-center gap-3 p-3 bg-gray-50 hover:bg-blue-50 rounded-lg text-left transition-colors disabled:opacity-50",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${Cce[f.priority]||"bg-gray-200"}`,title:`Priority ${f.priority}`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:f.title}),o.jsx("div",{className:"text-xs text-gray-500 font-mono",children:f.id})]}),o.jsx("span",{className:`text-xs px-2 py-0.5 rounded flex-shrink-0 ${f.status==="closed"?"bg-green-100 text-green-700":f.status==="blocked"?"bg-red-100 text-red-700":f.status==="in_progress"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:f.status.replace("_"," ")}),o.jsx(dr,{className:"w-4 h-4 text-blue-500 flex-shrink-0"})]},f.id))})})]})})}function K6e({active:e,payload:t}){if(!e||!t?.length)return null;const r=t[0].payload,n=qy[r.status]||qy.draft;return o.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-gray-200 max-w-xs","data-testid":"roadmap-tooltip",children:[o.jsx("div",{className:"font-medium text-gray-900 mb-1 truncate",children:r.title}),o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${n.bgColor} ${n.color}`,children:[n.icon,n.label]}),o.jsxs("span",{className:"text-xs text-gray-500",children:[r.completionPercentage,"% complete"]})]}),o.jsxs("div",{className:"text-xs text-gray-500",children:[o.jsxs("div",{children:["Start: ",r.startDate.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),o.jsxs("div",{children:["End: ",r.endDate.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),o.jsxs("div",{children:["Duration: ",r.duration," days"]})]})]})}function G6e({plans:e,onPlanClick:t,selectedPlanId:r}){const{timelineStart:n,timelineEnd:a,chartData:s,tickValues:i,tickFormatter:l}=w.useMemo(()=>{if(e.length===0){const k=new Date,j=new Date(k);j.setDate(j.getDate()-7);const E=new Date(k);return E.setDate(E.getDate()+30),{timelineStart:j,timelineEnd:E,chartData:[],tickValues:[],tickFormatter:T=>""}}let f=new Date,m=new Date,p=!1;e.forEach(k=>{const j=new Date(k.createdAt),E=new Date(k.updatedAt),T=k.completedAt?new Date(k.completedAt):null,O=k.cancelledAt?new Date(k.cancelledAt):null,R=j,H=T||O||E;p?(R<f&&(f=new Date(R)),H>m&&(m=new Date(H))):(f=new Date(R),m=new Date(H),p=!0)});const v=new Date(f);v.setDate(v.getDate()-7);const b=new Date(m);b.setDate(b.getDate()+14);const y=Math.ceil((b.getTime()-v.getTime())/(1e3*60*60*24)),S=e.map(k=>{const j=new Date(k.createdAt),E=new Date(k.updatedAt),T=k.completedAt?new Date(k.completedAt):null,O=k.cancelledAt?new Date(k.cancelledAt):null,R=j,H=T||O||E,$=Math.ceil((R.getTime()-v.getTime())/(1e3*60*60*24)),L=Math.max(1,Math.ceil((H.getTime()-R.getTime())/(1e3*60*60*24)));return{planId:k.id,title:k.title,status:k.status,startDate:R,endDate:H,startOffset:$,duration:L,completionPercentage:k._progress?.completionPercentage??0}}),_=[];for(let k=0;k<=y;k+=7)_.push(k);return{timelineStart:v,timelineEnd:b,chartData:S,tickValues:_,tickFormatter:k=>{const j=new Date(v);return j.setDate(j.getDate()+k),j.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}},[e]),c=Math.ceil((a.getTime()-n.getTime())/(1e3*60*60*24));if(e.length===0)return o.jsxs("div",{"data-testid":"roadmap-empty",className:"flex flex-col items-center justify-center h-full py-12 text-center",children:[o.jsx(Uae,{className:"w-12 h-12 text-gray-300 mb-3"}),o.jsx("p",{className:"text-gray-500",children:"No plans to display in roadmap"}),o.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create plans to see them on the timeline"})]});const d=Math.max(200,s.length*48+60);return o.jsxs("div",{"data-testid":"roadmap-view",className:"h-full flex flex-col bg-white rounded-lg border border-gray-200 overflow-hidden",children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-gray-50",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:[n.toLocaleDateString("en-US",{month:"long",year:"numeric"})," "," ",a.toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),o.jsxs("div",{className:"text-xs text-gray-500",children:[e.length," plan",e.length!==1?"s":""]})]})}),o.jsx("div",{className:"flex-1 overflow-auto p-4","data-testid":"roadmap-chart-container",children:o.jsx("div",{style:{height:d,minWidth:Math.max(600,c*8)},children:o.jsx(kj,{width:"100%",height:"100%",children:o.jsxs(kce,{data:s,layout:"vertical",barCategoryGap:8,margin:{top:20,right:30,left:200,bottom:20},children:[o.jsx(Qh,{type:"number",dataKey:"startOffset",domain:[0,c],ticks:i,tickFormatter:l,axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"},tick:{fontSize:11,fill:"#6b7280"}}),o.jsx(Jh,{type:"category",dataKey:"title",width:190,axisLine:{stroke:"#e5e7eb"},tickLine:!1,tick:({x:f,y:m,payload:p})=>o.jsx("g",{transform:`translate(${f},${m})`,children:o.jsx("text",{x:-5,y:0,dy:4,textAnchor:"end",fill:"#374151",fontSize:12,fontWeight:500,style:{cursor:"pointer"},children:p.value.length>25?p.value.slice(0,22)+"...":p.value})})}),o.jsx(Ci,{content:o.jsx(K6e,{}),cursor:{fill:"rgba(59, 130, 246, 0.05)"}}),o.jsx(qd,{dataKey:"duration",radius:[4,4,4,4],style:{cursor:"pointer"},onClick:f=>{const m=f;m?.planId&&t(m.planId)},children:s.map(f=>o.jsx(Kx,{fill:ED[f.status]||ED.draft,stroke:r===f.planId?"#1d4ed8":"transparent",strokeWidth:r===f.planId?2:0},f.planId))})]})})})}),o.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50",children:o.jsx("div",{className:"flex items-center justify-center gap-6","data-testid":"roadmap-legend",children:Object.entries(qy).map(([f,m])=>o.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[o.jsx("span",{className:"w-3 h-3 rounded",style:{backgroundColor:ED[f]}}),o.jsx("span",{className:"text-gray-600",children:m.label})]},f))})})]})}function V6e(e){switch(e){case"draft":return[{status:"active",label:"Activate",icon:Yr,color:"bg-blue-500 hover:bg-blue-600"}];case"active":return[{status:"completed",label:"Complete",icon:Yn,color:"bg-green-500 hover:bg-green-600"},{status:"cancelled",label:"Cancel",icon:VC,color:"bg-red-500 hover:bg-red-600"}];case"completed":case"cancelled":return[{status:"draft",label:"Reopen as Draft",icon:z6,color:"bg-gray-500 hover:bg-gray-600"}];default:return[]}}function Y6e({planId:e,onClose:t,renderProgressRing:r,onRemoveTaskNotAllowed:n,taskLinkBase:a="/tasks",onDeleteSuccess:s,onDeleteError:i}){const{data:l,isLoading:c,isError:u,error:d}=M6e(e),{data:f=[]}=T6e(e),{data:m}=A6e(e),[p,v]=w.useState(!1),[b,y]=w.useState(""),[S,_]=w.useState(!1),[N,k]=w.useState(null),[j,E]=w.useState(!1),T=D6e(),O=R6e(),R=L6e(),H=O6e();w.useEffect(()=>{l&&y(l.title)},[l]),w.useEffect(()=>{v(!1),_(!1),k(null)},[e]);const $=w.useCallback(async()=>{if(!l||b.trim()===l.title){v(!1);return}try{await T.mutateAsync({planId:e,updates:{title:b.trim()}}),v(!1)}catch(q){console.error("Failed to update title:",q)}},[l,b,e,T]),L=w.useCallback(()=>{l&&y(l.title),v(!1)},[l]),A=w.useCallback(async q=>{if(!(!l||q===l.status))try{await T.mutateAsync({planId:e,updates:{status:q}})}catch(Q){console.error("Failed to update status:",Q)}},[l,e,T]),M=w.useCallback(async q=>{try{await R.mutateAsync({planId:e,taskId:q}),_(!1)}catch(Q){console.error("Failed to add task:",Q)}},[e,R]),P=w.useCallback(async q=>{k(q);try{await H.mutateAsync({planId:e,taskId:q})}catch(Q){console.error("Failed to remove task:",Q)}finally{k(null)}},[e,H]),I=w.useCallback(()=>{n?n():console.warn("Cannot remove the last task. Plans must have at least one task.")},[n]),B=w.useCallback(async()=>{try{await O.mutateAsync(e),E(!1),s&&s(),t()}catch(q){const Q=q.message||"Failed to delete plan";i?i(Q):console.error("Failed to delete plan:",q)}},[e,O,s,i,t]);if(c)return o.jsx("div",{"data-testid":"plan-detail-loading",className:"h-full flex items-center justify-center bg-white",children:o.jsx("div",{className:"text-gray-500",children:"Loading plan..."})});if(u)return o.jsxs("div",{"data-testid":"plan-detail-error",className:"h-full flex flex-col items-center justify-center bg-white",children:[o.jsx("div",{className:"text-red-600 mb-2",children:"Failed to load plan"}),o.jsx("div",{className:"text-sm text-gray-500",children:d?.message})]});if(!l)return o.jsx("div",{"data-testid":"plan-detail-not-found",className:"h-full flex items-center justify-center bg-white",children:o.jsx("div",{className:"text-gray-500",children:"Plan not found"})});const F=V6e(l.status);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{"data-testid":"plan-detail-panel",className:"h-full flex flex-col bg-white border-l border-gray-200",children:[o.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"mb-2",children:o.jsx(Ece,{status:l.status})}),p?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text","data-testid":"plan-title-input",value:b,onChange:q=>y(q.target.value),onKeyDown:q=>{q.key==="Enter"&&$(),q.key==="Escape"&&L()},className:"flex-1 text-lg font-semibold text-gray-900 border border-blue-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),o.jsx("button",{"data-testid":"save-title-btn",onClick:$,disabled:T.isPending,className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Save",children:o.jsx(Vn,{className:"w-5 h-5"})}),o.jsx("button",{"data-testid":"cancel-edit-btn",onClick:L,className:"p-1 text-gray-400 hover:bg-gray-100 rounded",title:"Cancel",children:o.jsx(yt,{className:"w-5 h-5"})})]}):o.jsxs("div",{className:"flex items-center gap-2 group",children:[o.jsx("h2",{"data-testid":"plan-detail-title",className:"text-lg font-semibold text-gray-900",children:l.title}),o.jsx("button",{"data-testid":"edit-title-btn",onClick:()=>v(!0),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded opacity-0 group-hover:opacity-100 transition-opacity",title:"Edit title",children:o.jsx(Uh,{className:"w-4 h-4"})})]}),o.jsx("div",{className:"mt-1 text-xs text-gray-500 font-mono",children:o.jsx("span",{"data-testid":"plan-detail-id",children:l.id})})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>E(!0),className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded","aria-label":"Delete plan","data-testid":"plan-detail-delete",title:"Delete plan",children:o.jsx(pr,{className:"w-5 h-5"})}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","aria-label":"Close panel","data-testid":"plan-detail-close",children:o.jsx(yt,{className:"w-5 h-5"})})]})]}),F.length>0&&o.jsx("div",{className:"flex gap-2 p-4 border-b border-gray-200 bg-gray-50",children:F.map(q=>{const Q=q.icon;return o.jsxs("button",{"data-testid":`status-action-${q.status}`,onClick:()=>A(q.status),disabled:T.isPending,className:`flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white rounded ${q.color} disabled:opacity-50`,children:[o.jsx(Q,{className:"w-4 h-4"}),q.label]},q.status)})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[m&&o.jsxs("div",{className:"mb-6","data-testid":"plan-progress-section",children:[o.jsx("div",{className:"text-sm font-medium text-gray-700 mb-4",children:"Progress"}),o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r?r({percentage:m.completionPercentage,completed:m.completedTasks,total:m.totalTasks}):o.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-blue-500 flex items-center justify-center","data-testid":"plan-detail-progress-ring",children:o.jsxs("span",{className:"text-xl font-bold text-blue-500",children:[m.completionPercentage,"%"]})}),o.jsx("div",{className:"w-full mt-2",children:o.jsx(q6e,{progress:m})})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"text-sm font-medium text-gray-700",children:["Tasks (",f.length,")"]}),o.jsxs("button",{"data-testid":"add-task-btn",onClick:()=>_(!0),className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-blue-600 hover:bg-blue-50 rounded transition-colors",children:[o.jsx(dr,{className:"w-3 h-3"}),"Add Task"]})]}),o.jsx(H6e,{tasks:f,isEditMode:!0,onRemoveTask:P,removingTaskId:N,onRemoveNotAllowed:I,taskLinkBase:a})]}),o.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-gray-500",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(Rr,{className:"w-3 h-3"}),o.jsx("span",{className:"font-medium",children:"Created:"})]}),o.jsx("span",{title:Ep(l.createdAt),children:hR(l.createdAt)})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(Rr,{className:"w-3 h-3"}),o.jsx("span",{className:"font-medium",children:"Updated:"})]}),o.jsx("span",{title:Ep(l.updatedAt),children:hR(l.updatedAt)})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsx("span",{className:"font-medium",children:"Created by:"})]}),o.jsx("span",{className:"font-mono",children:l.createdBy})]}),l.completedAt&&o.jsxs("div",{className:"col-span-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(Yn,{className:"w-3 h-3 text-green-500"}),o.jsx("span",{className:"font-medium",children:"Completed:"})]}),o.jsx("span",{children:Ep(l.completedAt)})]}),l.cancelledAt&&o.jsxs("div",{className:"col-span-2",children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(us,{className:"w-3 h-3 text-red-500"}),o.jsx("span",{className:"font-medium",children:"Cancelled:"})]}),o.jsx("span",{children:Ep(l.cancelledAt)}),l.cancelReason&&o.jsx("p",{className:"mt-1 text-gray-600",children:l.cancelReason})]})]}),l.tags&&l.tags.length>0&&o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:l.tags.map(q=>o.jsx("span",{"data-testid":`plan-tag-${q}`,className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-700 rounded",children:q},q))})]})]})]})]}),S&&o.jsx(W6e,{planId:e,onClose:()=>_(!1),onAddTask:M,isAdding:R.isPending}),j&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:q=>q.target===q.currentTarget&&E(!1),"data-testid":"delete-plan-modal",children:o.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Plan"}),o.jsx("p",{className:"text-sm text-gray-500",children:"This action cannot be undone."})]})]}),o.jsxs("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete ",o.jsxs("span",{className:"font-semibold",children:['"',l.title,'"']}),"? Tasks in this plan will be unlinked but not deleted."]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:()=>E(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors","data-testid":"delete-plan-cancel",children:"Cancel"}),o.jsx("button",{onClick:B,disabled:O.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors disabled:opacity-50","data-testid":"delete-plan-confirm",children:O.isPending?"Deleting...":"Delete Plan"})]})]})})})]})}const XY={draft:{label:"Draft",icon:o.jsx(z6,{className:"w-3 h-3"}),color:"bg-gray-100 text-gray-700 dark:bg-gray-800/50 dark:text-gray-300"},active:{label:"Active",icon:o.jsx(sy,{className:"w-3 h-3"}),color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"},completed:{label:"Completed",icon:o.jsx(Yn,{className:"w-3 h-3"}),color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"},cancelled:{label:"Cancelled",icon:o.jsx(us,{className:"w-3 h-3"}),color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}};function Q6e(e,t){if(t.length===0)return o.jsx(o.Fragment,{children:e});const r=[],n=new Set(t);let a=0;for(let s=0;s<e.length;s++)n.has(s)&&(s>a&&r.push(o.jsx("span",{children:e.slice(a,s)},`text-${a}`)),r.push(o.jsx("mark",{className:"bg-yellow-200 text-gray-900 dark:bg-yellow-700 dark:text-white rounded-sm px-0.5",children:e[s]},`match-${s}`)),a=s+1);return a<e.length&&r.push(o.jsx("span",{children:e.slice(a)},`text-${a}`)),o.jsx(o.Fragment,{children:r})}function J6e(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function Z6e({plan:e,isSelected:t,onClick:r,searchMatchIndices:n,progressRing:a}){const s=XY[e.status]||XY.draft,i=e._progress,l=i&&i.totalTasks>0,c=w.useMemo(()=>n&&n.length>0?Q6e(e.title,n):e.title,[e.title,n]);return o.jsxs("div",{className:`
        flex gap-3 p-4
        bg-[var(--color-surface)] border-b border-[var(--color-border)]
        cursor-pointer transition-colors duration-150
        active:bg-[var(--color-surface-hover)]
        ${t?"bg-blue-50 dark:bg-blue-900/20":""}
      `,onClick:r,"data-testid":`mobile-plan-card-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0 mt-0.5",children:o.jsx(tu,{className:"w-5 h-5 text-blue-500"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] line-clamp-2 mb-1","data-testid":`mobile-plan-title-${e.id}`,children:c}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] font-mono",children:e.id}),o.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:[" ",J6e(e.updatedAt)]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[o.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 text-xs font-medium rounded ${s.color}`,children:[s.icon,s.label]}),e.tags&&e.tags.length>0&&o.jsxs(o.Fragment,{children:[e.tags.slice(0,2).map(u=>o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-surface-hover)] text-[var(--color-text-secondary)] rounded truncate max-w-20",children:u},u)),e.tags.length>2&&o.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["+",e.tags.length-2]})]})]})]}),o.jsx("div",{className:"flex-shrink-0 self-center",children:a||(l?o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-blue-500 flex items-center justify-center",title:`${i.completionPercentage}% complete`,"data-testid":`mobile-plan-progress-${e.id}`,children:o.jsxs("span",{className:"text-[10px] text-blue-500 font-medium",children:[i.completionPercentage,"%"]})}):o.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-dashed border-[var(--color-border)] flex items-center justify-center",title:"No tasks in plan",children:o.jsx("span",{className:"text-[8px] text-[var(--color-text-muted)]",children:"--"})}))}),o.jsx("div",{className:"flex-shrink-0 self-center text-[var(--color-text-tertiary)]",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}function X6e({isOpen:e,onClose:t,onSuccess:r,currentUserId:n,isMobile:a=!1,onToastSuccess:s,onToastError:i,onCreateNewTask:l}){const c=ft(),[u,d]=w.useState(""),[f,m]=w.useState([]),[p,v]=w.useState(""),[b,y]=w.useState(""),S=P6e();w.useEffect(()=>{e&&(d(""),m([]),v(""),y(""))},[e]);const _=w.useRef(void 0);w.useEffect(()=>(_.current=setTimeout(()=>{y(p)},300),()=>{_.current&&clearTimeout(_.current)}),[p]);const{data:N=[],isLoading:k,refetch:j}=pt({queryKey:["tasks","for-plan-creation",b],queryFn:async()=>{const A=b?`/api/tasks?limit=50&search=${encodeURIComponent(b)}`:"/api/tasks?limit=50",M=await fetch(A);if(!M.ok)throw new Error("Failed to fetch tasks");const P=await M.json();return P.tasks||P.items||P.data||(Array.isArray(P)?P:[])},enabled:e}),E=N.filter(A=>!f.some(M=>M.taskId===A.id)),T=f.length>0,O=u.trim().length>0&&T&&n,R=w.useCallback(A=>{m(M=>[...M,{id:String(Date.now()),taskId:A.id,taskTitle:A.title}])},[]),H=w.useCallback(A=>{m(M=>M.filter(P=>P.id!==A))},[]),$=w.useCallback(A=>{c.invalidateQueries({queryKey:["tasks","for-plan-creation"]}),j(),m(M=>[...M,{id:String(Date.now()),taskId:A.id,taskTitle:A.title}])},[c,j]);w.useEffect(()=>(e&&(window.__createPlanModalTaskCreated=$),()=>{delete window.__createPlanModalTaskCreated}),[e,$]);const L=async()=>{if(O)try{const A=f[0],M=f.slice(1),P=await S.mutateAsync({title:u.trim(),createdBy:n,initialTaskId:A.taskId,additionalTasks:M.map(I=>({existingTaskId:I.taskId}))});s?.("Plan created successfully"),r?.({id:P.id,title:u.trim()}),t()}catch(A){i?.(A.message||"Failed to create plan")}};return e?a?o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)]","data-testid":"create-plan-modal",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",children:[o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Cancel","data-testid":"create-plan-close",children:o.jsx(Ul,{className:"w-5 h-5"})}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Create Plan"}),o.jsx("button",{onClick:L,disabled:!O||S.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors touch-target","data-testid":"create-plan-submit",children:S.isPending?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):"Create"})]}),o.jsxs("div",{className:"p-4 pb-20 overflow-y-auto h-[calc(100vh-60px)] space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"plan-title-mobile",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Plan Title *"}),o.jsx("input",{id:"plan-title-mobile",type:"text","data-testid":"plan-title-input",placeholder:"Enter plan title...",value:u,onChange:A=>d(A.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),o.jsx(eQ,{selectedTasks:f,availableTasks:E,isLoadingTasks:k,searchQuery:p,onSearchChange:v,onSelectTask:R,onRemoveTask:H,onCreateNewTask:l,isMobile:!0})]})]}):o.jsx("div",{"data-testid":"create-plan-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:A=>A.target===A.currentTarget&&t(),children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Create Plan"}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded","data-testid":"create-plan-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"plan-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Plan Title *"}),o.jsx("input",{id:"plan-title",type:"text","data-testid":"plan-title-input",placeholder:"Enter plan title...",value:u,onChange:A=>d(A.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white",autoFocus:!0})]}),o.jsx(eQ,{selectedTasks:f,availableTasks:E,isLoadingTasks:k,searchQuery:p,onSearchChange:v,onSelectTask:R,onRemoveTask:H,onCreateNewTask:l,isMobile:!1})]}),o.jsxs("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors","data-testid":"create-plan-cancel",children:"Cancel"}),o.jsx("button",{onClick:L,disabled:!O||S.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"create-plan-submit",children:S.isPending?"Creating...":"Create Plan"})]})]})}):null}function eQ({selectedTasks:e,availableTasks:t,isLoadingTasks:r,searchQuery:n,onSearchChange:a,onSelectTask:s,onRemoveTask:i,onCreateNewTask:l,isMobile:c}){return o.jsxs("div",{className:"border border-blue-200 dark:border-blue-800 rounded-lg p-4 bg-blue-50 dark:bg-blue-900/20",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(YC,{className:"w-4 h-4 text-blue-500"}),o.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["Tasks (",e.length,")"]})]}),l&&o.jsxs("button",{onClick:l,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-300 hover:bg-green-100 dark:hover:bg-green-900/40 rounded transition-colors","data-testid":"create-new-task-btn",children:[o.jsx(Hae,{className:"w-3 h-3"}),"Create New Task"]})]}),o.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-4",children:"Plans must have at least one task. Search and select existing tasks below."}),e.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 uppercase tracking-wide",children:"Selected Tasks"}),o.jsx("div",{className:"space-y-2",children:e.map((u,d)=>o.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 bg-white dark:bg-gray-800 border border-green-200 dark:border-green-800 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-green-100 dark:bg-green-900/50 flex items-center justify-center",children:o.jsx("span",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:d+1})}),o.jsx("span",{className:"text-sm text-gray-900 dark:text-white truncate",children:u.taskTitle})]}),o.jsx("button",{onClick:()=>i(u.id),className:"flex-shrink-0 p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors","aria-label":"Remove task","data-testid":`remove-selected-task-${u.taskId}`,children:o.jsx(pr,{className:"w-4 h-4"})})]},u.id))})]}),o.jsxs("div",{className:"relative mb-3",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text","data-testid":"task-search-input",placeholder:"Search tasks by title or ID...",value:n,onChange:u=>a(u.target.value),className:`w-full pl-10 pr-4 ${c?"py-2.5":"py-2"} border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white`})]}),o.jsx("div",{className:`${c?"max-h-60":"max-h-48"} overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800`,children:r?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500 text-sm",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin mr-2"}),"Loading tasks..."]}):t.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500 text-sm",children:[n?"No matching tasks found":"No tasks available",l&&o.jsx("button",{onClick:l,className:"block mx-auto mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Create a new task"})]}):o.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:t.map(u=>o.jsxs("button",{"data-testid":`available-task-${u.id}`,onClick:()=>s(u),className:`w-full flex items-center gap-3 p-3 text-left transition-colors ${c?"touch-target":""} hover:bg-gray-50 dark:hover:bg-gray-700`,children:[o.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded border border-gray-300 dark:border-gray-600 flex items-center justify-center",children:o.jsx(dr,{className:"w-3 h-3 text-gray-400"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:u.title}),o.jsx("div",{className:"text-xs text-gray-500 font-mono",children:u.id})]})]},u.id))})})]})}function tQ(e){const t=window.__createPlanModalTaskCreated;t&&t(e)}function eze(){return typeof window>"u"?!1:navigator.platform.toUpperCase().indexOf("MAC")>=0}function mR(e){return eze()?e.replace(/Cmd/gi,"").replace(/Ctrl/gi,"").replace(/Alt/gi,"").replace(/Shift/gi,""):e.replace(/Cmd/gi,"Ctrl")}const tze={navigation:"Navigation",actions:"Actions",views:"Views",editing:"Editing",other:"Other"};function rze(e){const t={navigation:[],actions:[],views:[],editing:[],other:[]};for(const[r,n]of Object.entries(e)){const a=n.category||"other";t[a].push({actionId:r,description:n.description||r,defaultKeys:n.keys})}return t}function nze({actionId:e,description:t,currentKeys:r,defaultKeys:n,defaults:a,onSave:s,onCancel:i,isMobile:l}){const[c,u]=w.useState([]),[d,f]=w.useState(!1),[m,p]=w.useState(null),v=w.useRef(null),b=w.useCallback(j=>{if(!d)return;j.preventDefault(),j.stopPropagation();const E=j.key.toLowerCase();if(["meta","control","alt","shift"].includes(E))return;let T=[];if(j.metaKey||j.ctrlKey){const H=[];j.metaKey&&H.push("Cmd"),j.ctrlKey&&H.push("Ctrl"),j.altKey&&H.push("Alt"),j.shiftKey&&H.push("Shift"),H.push(E.toUpperCase()),T=[H.join("+")]}else T=[...c,E.toUpperCase()];const O=T.join(" ");u(T);const R=v6e(O,a,e);if(R){const H=a[R]?.description||R;p(H)}else p(null)},[d,c,e,a]);w.useEffect(()=>{if(d)return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[d,b]);const y=()=>{u([]),p(null),f(!0),v.current?.focus()},S=()=>{f(!1)},_=()=>{c.length>0&&!m&&s(c.join(" "))},N=()=>{s(n)},k=c.length>0?mR(c.join(" ")):mR(r);return o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50","data-testid":"shortcut-edit-modal",children:o.jsxs("div",{className:`
        bg-white dark:bg-gray-800 shadow-xl w-full p-4 sm:p-6
        ${l?"rounded-t-2xl max-h-[90vh] overflow-y-auto pb-safe":"rounded-lg max-w-md"}
      `,children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Edit Shortcut"}),o.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 min-h-[44px] min-w-[44px] flex items-center justify-center","data-testid":"shortcut-edit-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-4",children:t}),o.jsx("div",{ref:v,tabIndex:0,onClick:y,onBlur:S,className:`
            p-4 sm:p-6 rounded-lg border-2 text-center font-mono text-base sm:text-lg cursor-pointer transition-all min-h-[60px] flex items-center justify-center
            ${d?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900"}
            ${m?"border-red-500 bg-red-50 dark:bg-red-900/20":""}
          `,"data-testid":"shortcut-capture-area",children:d&&c.length===0?o.jsx("span",{className:"text-gray-400",children:"Press keys..."}):o.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:k})}),d&&o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"Press a key combination. For sequential shortcuts, press keys one after another."}),m&&o.jsxs("div",{className:"flex items-center gap-2 mt-3 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:[o.jsx(Rt,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),o.jsxs("p",{className:"text-xs sm:text-sm text-red-600 dark:text-red-400","data-testid":"shortcut-conflict-warning",children:["Conflicts with: ",m]})]}),o.jsxs("div",{className:`mt-6 ${l?"space-y-3":"flex items-center justify-between"}`,children:[o.jsxs("button",{onClick:N,className:`flex items-center justify-center gap-2 px-3 py-3 sm:py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 min-h-[44px] ${l?"w-full border border-gray-200 dark:border-gray-700 rounded-lg":""}`,"data-testid":"shortcut-reset-default",children:[o.jsx(Ri,{className:"w-4 h-4"}),"Reset to Default"]}),o.jsxs("div",{className:`flex gap-2 ${l?"flex-col-reverse":""}`,children:[o.jsx("button",{onClick:i,className:`px-4 py-3 sm:py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg min-h-[44px] ${l?"w-full border border-gray-200 dark:border-gray-700":""}`,"data-testid":"shortcut-edit-cancel",children:"Cancel"}),o.jsxs("button",{onClick:_,disabled:c.length===0||!!m,className:`px-4 py-3 sm:py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg flex items-center justify-center gap-2 min-h-[44px] ${l?"w-full":""}`,"data-testid":"shortcut-edit-save",children:[o.jsx(Vn,{className:"w-4 h-4"}),"Save"]})]})]})]})})}function aze({actionId:e,description:t,currentKeys:r,isCustomized:n,onEdit:a,isMobile:s}){return o.jsxs("button",{onClick:a,className:`
        w-full text-left py-3 px-3 sm:px-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 active:bg-gray-100 dark:active:bg-gray-700 rounded-lg group min-h-[56px]
        ${s?"flex flex-col gap-2":"flex items-center justify-between"}
      `,"data-testid":`shortcut-row-${e}`,children:[o.jsxs("div",{className:`${s?"w-full":"flex-1"}`,children:[o.jsx("span",{className:"text-xs sm:text-sm text-gray-900 dark:text-gray-100",children:t}),n&&o.jsx("span",{className:"ml-2 text-xs px-1.5 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:"Customized"})]}),o.jsxs("div",{className:`flex items-center gap-3 ${s?"w-full justify-between":""}`,children:[o.jsx("kbd",{className:"px-2 py-1 text-xs sm:text-sm font-mono bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded border border-gray-200 dark:border-gray-700",children:mR(r)}),o.jsx("span",{className:`text-xs sm:text-sm text-blue-600 dark:text-blue-400 ${s?"":"opacity-0 group-hover:opacity-100 transition-opacity"}`,children:s?"Edit":"Customize"})]})]})}function sze({defaults:e,isMobile:t}){const[r,n]=w.useState({}),[a,s]=w.useState(null),[i,l]=w.useState(!1);w6e(!!a),w.useEffect(()=>{n(Hy())},[]);const c=rze(e),u=m=>{a&&(b6e(a.actionId,m,e),n(Hy()),s(null))},d=()=>{y6e(),n({}),l(!1)},f=Object.keys(r).length>0;return o.jsxs("div",{"data-testid":"settings-shortcuts-section",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-2",children:[o.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 dark:text-gray-100",children:"Keyboard Shortcuts"}),f&&o.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-3 py-2 sm:py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 sm:border-0 min-h-[44px] sm:min-h-0","data-testid":"shortcuts-reset-all",children:[o.jsx(Ri,{className:"w-4 h-4"}),"Reset to Defaults"]})]}),o.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-4 sm:mb-6",children:["View and customize keyboard shortcuts. ",t?"Tap":'Click "Customize"'," to change a shortcut."]}),o.jsx("div",{className:"space-y-6",children:Object.entries(c).map(([m,p])=>p.length===0?null:o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 px-4",children:tze[m]}),o.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg divide-y divide-gray-200 dark:divide-gray-700",children:p.map(({actionId:v,description:b,defaultKeys:y})=>{const S=s9(v,e),_=!!r[v];return o.jsx(aze,{actionId:v,description:b,currentKeys:S,isCustomized:_,onEdit:()=>s({actionId:v,description:b,currentKeys:S,defaultKeys:y}),isMobile:t},v)})})]},m))}),a&&o.jsx(nze,{actionId:a.actionId,description:a.description,currentKeys:a.currentKeys,defaultKeys:a.defaultKeys,defaults:e,onSave:u,onCancel:()=>s(null),isMobile:t}),i&&o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50","data-testid":"reset-confirm-modal",children:o.jsxs("div",{className:`
            bg-white dark:bg-gray-800 shadow-xl w-full p-4 sm:p-6
            ${t?"rounded-t-2xl":"rounded-lg max-w-sm"}
          `,children:[o.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Reset All Shortcuts?"}),o.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-4 sm:mb-6",children:"This will reset all keyboard shortcuts to their default values. This action cannot be undone."}),o.jsxs("div",{className:`flex gap-2 ${t?"flex-col-reverse":"justify-end"}`,children:[o.jsx("button",{onClick:()=>l(!1),className:`px-4 py-3 sm:py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg min-h-[44px] ${t?"w-full border border-gray-200 dark:border-gray-700":""}`,"data-testid":"reset-confirm-cancel",children:"Cancel"}),o.jsx("button",{onClick:d,className:`px-4 py-3 sm:py-2 text-sm font-medium text-white bg-red-500 hover:bg-red-600 rounded-lg min-h-[44px] ${t?"w-full":""}`,"data-testid":"reset-confirm-yes",children:"Reset All"})]})]})}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-6 text-center",children:"Changes to keyboard shortcuts take effect immediately."})]})}const pR=[{value:"updatedAt",label:"Updated",defaultDirection:"desc"},{value:"createdAt",label:"Created",defaultDirection:"desc"},{value:"title",label:"Title",defaultDirection:"asc"},{value:"contentType",label:"Type",defaultDirection:"asc"}],gR=[{value:"text",label:"Text",color:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200"},{value:"markdown",label:"Markdown",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-300"},{value:"json",label:"JSON",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300"}],aN={sortField:"documents.sortBy",sortDirection:"documents.sortDir"},Ob={contentTypes:[],tags:[]};function Mce(){if(typeof window>"u")return{field:"updatedAt",direction:"desc"};const e=localStorage.getItem(aN.sortField),t=localStorage.getItem(aN.sortDirection);return{field:e&&["updatedAt","createdAt","title","contentType"].includes(e)?e:"updatedAt",direction:t==="asc"||t==="desc"?t:"desc"}}function sN(e,t){typeof window>"u"||(localStorage.setItem(aN.sortField,e),localStorage.setItem(aN.sortDirection,t))}function Tce(e,t){const r=t?.toLowerCase().trim()||"",n=e.contentTypes.length>0,a=e.tags.length>0,s=r.length>0;return!n&&!a&&!s?()=>!0:i=>{if(s&&!(i.title||"").toLowerCase().includes(r))return!1;if(n){const l=(i.contentType||"text").toLowerCase();if(!e.contentTypes.some(c=>c.toLowerCase()===l))return!1}if(a){const l=i.tags||[];if(!e.tags.some(c=>l.includes(c)))return!1}return!0}}function t1(e){return e.contentTypes.length+e.tags.length}function nh(e){return t1(e)>0}function ize(e){return pR.find(r=>r.value===e)?.defaultDirection??"desc"}function iN({sortField:e,sortDirection:t,onSortFieldChange:r,onSortDirectionChange:n}){const[a,s]=w.useState(!1),i=pR.find(u=>u.value===e),l=u=>{u===e?n(t==="asc"?"desc":"asc"):(r(u),n(ize(u))),s(!1)},c=()=>{n(t==="asc"?"desc":"asc")};return o.jsxs("div",{className:"flex items-center gap-1","data-testid":"document-sort-dropdown",children:[o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>s(!a),className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors","data-testid":"sort-field-trigger",children:[o.jsx(t0,{className:"w-4 h-4"}),o.jsxs("span",{children:["Sort: ",i?.label||"Updated"]}),o.jsx(Yt,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`})]}),a&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),o.jsx("div",{className:"absolute left-0 top-full mt-1 w-40 py-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-20",children:pR.map(u=>o.jsxs("button",{onClick:()=>l(u.value),className:"flex items-center justify-between w-full px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","data-testid":`sort-option-${u.value}`,children:[o.jsx("span",{children:u.label}),e===u.value&&o.jsx(Vn,{className:"w-4 h-4 text-blue-600"})]},u.value))})]})]}),o.jsx("button",{onClick:c,className:"p-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",title:t==="asc"?"Ascending":"Descending","data-testid":"sort-direction-toggle",children:t==="asc"?o.jsx(Px,{className:"w-4 h-4"}):o.jsx(Rx,{className:"w-4 h-4"})})]})}function Ace({filters:e,onFilterChange:t,onClearFilters:r,availableTags:n}){const[a,s]=w.useState(!1),[i,l]=w.useState(!1),c=t1(e),u=nh(e),d=v=>{const b=e.contentTypes.includes(v)?e.contentTypes.filter(y=>y!==v):[...e.contentTypes,v];t({...e,contentTypes:b})},f=v=>{const b=e.tags.includes(v)?e.tags.filter(y=>y!==v):[...e.tags,v];t({...e,tags:b})},m=v=>{t({...e,contentTypes:e.contentTypes.filter(b=>b!==v)})},p=v=>{t({...e,tags:e.tags.filter(b=>b!==v)})};return o.jsxs("div",{"data-testid":"document-filter-bar",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>s(!a),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${u?"text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/50 hover:bg-blue-200 dark:hover:bg-blue-900/70":"text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700"}`,"data-testid":"filter-toggle",children:[o.jsx(ru,{className:"w-4 h-4"}),o.jsx("span",{children:"Filters"}),c>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-semibold bg-blue-600 text-white rounded-full",children:c}),a?o.jsx(e0,{className:"w-4 h-4"}):o.jsx(Yt,{className:"w-4 h-4"})]}),u&&o.jsx("button",{onClick:r,className:"px-2 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors","data-testid":"clear-filters",children:"Clear"})]}),a&&o.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"filter-panel",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Type"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:gR.map(v=>{const b=e.contentTypes.includes(v.value);return o.jsxs("button",{onClick:()=>d(v.value),className:`flex items-center gap-1.5 px-3 py-1.5 text-sm rounded-md border transition-colors ${b?`${v.color} border-transparent font-medium`:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:border-gray-400 dark:hover:border-gray-500"}`,"data-testid":`filter-type-${v.value}`,children:[b&&o.jsx(Vn,{className:"w-3 h-3"}),v.label]},v.value)})})]}),n.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Tags"}),o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 min-h-[38px] px-2 py-1.5 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 cursor-text",onClick:()=>l(!0),children:[e.tags.map(v=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-100 rounded",children:[v,o.jsx("button",{onClick:b=>{b.stopPropagation(),f(v)},className:"hover:opacity-70 transition-opacity","data-testid":`remove-tag-input-${v}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},v)),e.tags.length===0&&o.jsxs("span",{className:"text-sm text-gray-400 dark:text-gray-500 flex items-center gap-1.5",children:[o.jsx(Vc,{className:"w-4 h-4"}),"Click to select tags..."]})]}),i&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),o.jsx("div",{className:"absolute left-0 top-full mt-1 w-full max-h-48 overflow-y-auto py-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-20",children:n.filter(v=>!e.tags.includes(v)).length===0?o.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"All tags selected"}):n.filter(v=>!e.tags.includes(v)).map(v=>o.jsxs("button",{onClick:()=>f(v),className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","data-testid":`filter-tag-${v}`,children:[o.jsx(Vc,{className:"w-3 h-3 text-gray-400"}),o.jsx("span",{children:v})]},v))})]})]})]})]}),!a&&u&&o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5","data-testid":"filter-chips",children:[e.contentTypes.map(v=>{const b=gR.find(y=>y.value===v);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${b?.color||"bg-gray-100 text-gray-700"}`,children:[b?.label||v,o.jsx("button",{onClick:()=>m(v),className:"hover:opacity-70 transition-opacity","data-testid":`remove-type-${v}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},`type-${v}`)}),e.tags.map(v=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-100 rounded-full",children:[o.jsx(Vc,{className:"w-3 h-3"}),v,o.jsx("button",{onClick:()=>p(v),className:"hover:opacity-70 transition-opacity","data-testid":`remove-tag-${v}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},`tag-${v}`))]})]})}function Dce({open:e,onClose:t,filters:r,onFilterChange:n,onClearFilters:a,availableTags:s}){const i=w.useRef(null),l=w.useRef(null),c=w.useRef(0),u=t1(r);w.useEffect(()=>{if(e){const y=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=y}}},[e]),w.useEffect(()=>{if(!e)return;const y=S=>{S.key==="Escape"&&t()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[e,t]),w.useEffect(()=>{if(!e)return;window.history.pushState({mobileSheet:!0},"");const y=S=>{S.state?.mobileSheet===void 0&&t()};return window.addEventListener("popstate",y),()=>{window.removeEventListener("popstate",y),window.history.state?.mobileSheet&&window.history.back()}},[e,t]);const d=y=>{l.current=y.touches[0].clientY,c.current=0},f=y=>{l.current!==null&&(c.current=y.touches[0].clientY-l.current,c.current<0&&(c.current=0),i.current&&c.current>0&&(i.current.style.transform=`translateY(${c.current}px)`))},m=()=>{l.current!==null&&(c.current>100?t():i.current&&(i.current.style.transform="translateY(0)"),l.current=null,c.current=0)};w.useEffect(()=>{e&&i.current&&i.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},[e]);const p=y=>{const S=r.contentTypes.includes(y)?r.contentTypes.filter(_=>_!==y):[...r.contentTypes,y];n({...r,contentTypes:S})},v=y=>{const S=r.tags.includes(y)?r.tags.filter(_=>_!==y):[...r.tags,y];n({...r,tags:S})},b=()=>{a(),t()};return e?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"mobile-document-filter",role:"dialog","aria-modal":"true","aria-label":"Document filters",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-200",onClick:t,"aria-hidden":"true"}),o.jsxs("div",{ref:i,className:"absolute inset-x-0 bottom-0 top-0 bg-[var(--color-bg)] shadow-2xl flex flex-col transform transition-transform duration-200 ease-out",style:{transform:e?"translateY(0)":"translateY(100%)"},children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",onTouchStart:d,onTouchMove:f,onTouchEnd:m,children:[o.jsx("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 w-10 h-1 bg-[var(--color-border)] rounded-full"}),o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Close",children:o.jsx(Ul,{className:"w-5 h-5"})}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Filters"})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2",children:"Type"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:gR.map(y=>{const S=r.contentTypes.includes(y.value);return o.jsxs("button",{onClick:()=>p(y.value),className:`flex items-center gap-1.5 px-3 py-2 text-sm rounded-lg border transition-colors touch-target ${S?`${y.color} border-transparent font-medium`:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300"}`,"data-testid":`mobile-filter-type-${y.value}`,children:[S&&o.jsx(Vn,{className:"w-4 h-4"}),y.label]},y.value)})})]}),s.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-2",children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(y=>{const S=r.tags.includes(y);return o.jsxs("button",{onClick:()=>v(y),className:`flex items-center gap-1.5 px-3 py-2 text-sm rounded-lg border transition-colors touch-target ${S?"bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-100 border-transparent font-medium":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300"}`,"data-testid":`mobile-filter-tag-${y}`,children:[o.jsx(Vc,{className:"w-4 h-4"}),y,S&&o.jsx(Vn,{className:"w-4 h-4"})]},y)})})]}),u>0&&o.jsxs("button",{onClick:b,className:"w-full py-2.5 text-sm font-medium text-red-600 dark:text-red-400 border border-red-300 dark:border-red-800 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors touch-target","data-testid":"mobile-clear-filters",children:["Clear all filters (",u,")"]}),o.jsx("button",{onClick:t,className:"w-full py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors touch-target","data-testid":"mobile-apply-filters",children:"Apply Filters"})]})]})]}):null}function oze({tags:e,onTagsChange:t,disabled:r=!1,placeholder:n="Add tag..."}){const[a,s]=w.useState(""),[i,l]=w.useState(!1),c=w.useRef(null);w.useEffect(()=>{i&&c.current&&c.current.focus()},[i]);const u=()=>{const p=a.trim().toLowerCase();p&&!e.includes(p)&&t([...e,p]),s(""),l(!1)},d=p=>{t(e.filter(v=>v!==p))},f=p=>{p.key==="Enter"?(p.preventDefault(),u()):p.key==="Escape"?(s(""),l(!1)):p.key==="Backspace"&&a===""&&e.length>0&&d(e[e.length-1])},m=()=>{a.trim()?u():l(!1)};return o.jsxs("div",{"data-testid":"document-tag-input",children:[o.jsxs("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2 flex items-center gap-1",children:[o.jsx(Vc,{className:"w-3 h-3"}),"Tags"]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[e.map(p=>o.jsxs("span",{"data-testid":`document-tag-${p}`,className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-100 rounded",children:[p,!r&&o.jsx("button",{onClick:()=>d(p),className:"hover:opacity-70 transition-opacity","data-testid":`remove-tag-${p}`,"aria-label":`Remove tag ${p}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},p)),!r&&(i?o.jsx("input",{ref:c,type:"text",value:a,onChange:p=>s(p.target.value),onKeyDown:f,onBlur:m,placeholder:n,className:"px-2 py-0.5 text-xs border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 min-w-[80px]","data-testid":"tag-input"}):o.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors","data-testid":"add-tag-button",children:[o.jsx(dr,{className:"w-3 h-3"}),"Add tag"]})),e.length===0&&r&&o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"No tags"})]})]})}function rQ({isOpen:e,onClose:t,onConfirm:r,library:n,documentCount:a=0,isDeleting:s=!1,error:i=null,isMobile:l=!1}){const[c,u]=w.useState(!0);w.useEffect(()=>{e&&u(!0)},[e]);const d=async()=>{await r(c)},f=()=>{s||t()};return e?l?o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)]","data-testid":"delete-library-modal",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",children:[o.jsx("button",{onClick:f,disabled:s,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target disabled:opacity-50","aria-label":"Cancel","data-testid":"delete-library-close",children:o.jsx(Ul,{className:"w-5 h-5"})}),o.jsx(pr,{className:"w-5 h-5 text-red-500"}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Delete Library"})]}),o.jsx("div",{className:"p-4 pb-24 overflow-y-auto",children:o.jsx(nQ,{library:n,documentCount:a,deleteDocuments:c,setDeleteDocuments:u,error:i})}),o.jsx("div",{className:"fixed bottom-0 left-0 right-0 px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:f,disabled:s,className:"px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors disabled:opacity-50 touch-target","data-testid":"delete-library-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:d,disabled:s,className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"delete-library-confirm-button",children:s?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete Library"]})})]})})]}):o.jsx("div",{"data-testid":"delete-library-modal",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:m=>m.target===m.currentTarget&&f(),children:o.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md mx-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pr,{className:"w-5 h-5 text-red-500"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Library"})]}),o.jsx("button",{onClick:f,disabled:s,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded disabled:opacity-50","data-testid":"delete-library-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-4",children:o.jsx(nQ,{library:n,documentCount:a,deleteDocuments:c,setDeleteDocuments:u,error:i})}),o.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 rounded-b-lg",children:[o.jsx("button",{type:"button",onClick:f,disabled:s,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors disabled:opacity-50","data-testid":"delete-library-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:d,disabled:s,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"delete-library-confirm-button",children:s?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete Library"]})})]})]})}):null}function nQ({library:e,documentCount:t,deleteDocuments:r,setDeleteDocuments:n,error:a}){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg mb-4",children:[o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-300",children:"This action cannot be undone"}),o.jsxs("p",{className:"mt-1 text-sm text-red-700 dark:text-red-400",children:['You are about to delete the library "',o.jsx("strong",{children:e?.name}),'".',t>0&&o.jsxs(o.Fragment,{children:[" ","This library contains ",o.jsx("strong",{children:t})," document",t===1?"":"s","."]})]})]})]}),t>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What should happen to the documents in this library?"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[o.jsx("input",{type:"radio",name:"deleteDocuments",checked:r,onChange:()=>n(!0),className:"mt-0.5","data-testid":"delete-documents-radio"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Delete all documents"}),o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["Permanently delete all ",t," document",t===1?"":"s"," in this library"]})]})]}),o.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[o.jsx("input",{type:"radio",name:"deleteDocuments",checked:!r,onChange:()=>n(!1),className:"mt-0.5","data-testid":"keep-documents-radio"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Keep documents"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"Remove documents from this library but don't delete them"})]})]})]})]}),a&&o.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-400","data-testid":"delete-library-error",children:a})]})}var i9=ewe();function ns(e){this.content=e}ns.prototype={constructor:ns,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,r){var n=r&&r!=e?this.remove(r):this,a=n.find(e),s=n.content.slice();return a==-1?s.push(r||e,t):(s[a+1]=t,r&&(s[a]=r)),new ns(s)},remove:function(e){var t=this.find(e);if(t==-1)return this;var r=this.content.slice();return r.splice(t,2),new ns(r)},addToStart:function(e,t){return new ns([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var r=this.remove(e).content.slice();return r.push(e,t),new ns(r)},addBefore:function(e,t,r){var n=this.remove(t),a=n.content.slice(),s=n.find(e);return a.splice(s==-1?a.length:s,0,t,r),new ns(a)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=ns.from(e),e.size?new ns(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=ns.from(e),e.size?new ns(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=ns.from(e);for(var r=0;r<e.content.length;r+=2)t=t.remove(e.content[r]);return t},toObject:function(){var e={};return this.forEach(function(t,r){e[t]=r}),e},get size(){return this.content.length>>1}};ns.from=function(e){if(e instanceof ns)return e;var t=[];if(e)for(var r in e)t.push(r,e[r]);return new ns(t)};function Lce(e,t,r){for(let n=0;;n++){if(n==e.childCount||n==t.childCount)return e.childCount==t.childCount?null:r;let a=e.child(n),s=t.child(n);if(a==s){r+=a.nodeSize;continue}if(!a.sameMarkup(s))return r;if(a.isText&&a.text!=s.text){for(let i=0;a.text[i]==s.text[i];i++)r++;return r}if(a.content.size||s.content.size){let i=Lce(a.content,s.content,r+1);if(i!=null)return i}r+=a.nodeSize}}function Oce(e,t,r,n){for(let a=e.childCount,s=t.childCount;;){if(a==0||s==0)return a==s?null:{a:r,b:n};let i=e.child(--a),l=t.child(--s),c=i.nodeSize;if(i==l){r-=c,n-=c;continue}if(!i.sameMarkup(l))return{a:r,b:n};if(i.isText&&i.text!=l.text){let u=0,d=Math.min(i.text.length,l.text.length);for(;u<d&&i.text[i.text.length-u-1]==l.text[l.text.length-u-1];)u++,r--,n--;return{a:r,b:n}}if(i.content.size||l.content.size){let u=Oce(i.content,l.content,r-1,n-1);if(u)return u}r-=c,n-=c}}class Ge{constructor(t,r){if(this.content=t,this.size=r||0,r==null)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,r,n,a=0,s){for(let i=0,l=0;l<r;i++){let c=this.content[i],u=l+c.nodeSize;if(u>t&&n(c,a+l,s||null,i)!==!1&&c.content.size){let d=l+1;c.nodesBetween(Math.max(0,t-d),Math.min(c.content.size,r-d),n,a+d)}l=u}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,r,n,a){let s="",i=!0;return this.nodesBetween(t,r,(l,c)=>{let u=l.isText?l.text.slice(Math.max(t,c)-c,r-c):l.isLeaf?a?typeof a=="function"?a(l):a:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&n&&(i?i=!1:s+=n),s+=u},0),s}append(t){if(!t.size)return this;if(!this.size)return t;let r=this.lastChild,n=t.firstChild,a=this.content.slice(),s=0;for(r.isText&&r.sameMarkup(n)&&(a[a.length-1]=r.withText(r.text+n.text),s=1);s<t.content.length;s++)a.push(t.content[s]);return new Ge(a,this.size+t.size)}cut(t,r=this.size){if(t==0&&r==this.size)return this;let n=[],a=0;if(r>t)for(let s=0,i=0;i<r;s++){let l=this.content[s],c=i+l.nodeSize;c>t&&((i<t||c>r)&&(l.isText?l=l.cut(Math.max(0,t-i),Math.min(l.text.length,r-i)):l=l.cut(Math.max(0,t-i-1),Math.min(l.content.size,r-i-1))),n.push(l),a+=l.nodeSize),i=c}return new Ge(n,a)}cutByIndex(t,r){return t==r?Ge.empty:t==0&&r==this.content.length?this:new Ge(this.content.slice(t,r))}replaceChild(t,r){let n=this.content[t];if(n==r)return this;let a=this.content.slice(),s=this.size+r.nodeSize-n.nodeSize;return a[t]=r,new Ge(a,s)}addToStart(t){return new Ge([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new Ge(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(t.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let r=this.content[t];if(!r)throw new RangeError("Index "+t+" out of range for "+this);return r}maybeChild(t){return this.content[t]||null}forEach(t){for(let r=0,n=0;r<this.content.length;r++){let a=this.content[r];t(a,n,r),n+=a.nodeSize}}findDiffStart(t,r=0){return Lce(this,t,r)}findDiffEnd(t,r=this.size,n=t.size){return Oce(this,t,r,n)}findIndex(t){if(t==0)return uS(0,t);if(t==this.size)return uS(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,n=0;;r++){let a=this.child(r),s=n+a.nodeSize;if(s>=t)return s==t?uS(r+1,s):uS(r,n);n=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,r){if(!r)return Ge.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ge(r.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return Ge.empty;let r,n=0;for(let a=0;a<t.length;a++){let s=t[a];n+=s.nodeSize,a&&s.isText&&t[a-1].sameMarkup(s)?(r||(r=t.slice(0,a)),r[r.length-1]=s.withText(r[r.length-1].text+s.text)):r&&r.push(s)}return new Ge(r||t,n)}static from(t){if(!t)return Ge.empty;if(t instanceof Ge)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Ge([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ge.empty=new Ge([],0);const MD={index:0,offset:0};function uS(e,t){return MD.index=e,MD.offset=t,MD}function oN(e,t){if(e===t)return!0;if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return!1;let r=Array.isArray(e);if(Array.isArray(t)!=r)return!1;if(r){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!oN(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!oN(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let hn=class vR{constructor(t,r){this.type=t,this.attrs=r}addToSet(t){let r,n=!1;for(let a=0;a<t.length;a++){let s=t[a];if(this.eq(s))return t;if(this.type.excludes(s.type))r||(r=t.slice(0,a));else{if(s.type.excludes(this.type))return t;!n&&s.type.rank>this.type.rank&&(r||(r=t.slice(0,a)),r.push(this),n=!0),r&&r.push(s)}}return r||(r=t.slice()),n||r.push(this),r}removeFromSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return t.slice(0,r).concat(t.slice(r+1));return t}isInSet(t){for(let r=0;r<t.length;r++)if(this.eq(t[r]))return!0;return!1}eq(t){return this==t||this.type==t.type&&oN(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let a=n.create(r.attrs);return n.checkAttrs(a.attrs),a}static sameSet(t,r){if(t==r)return!0;if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(r[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return vR.none;if(t instanceof vR)return[t];let r=t.slice();return r.sort((n,a)=>n.type.rank-a.type.rank),r}};hn.none=[];class lN extends Error{}class vt{constructor(t,r,n){this.content=t,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,r){let n=Rce(this.content,t+this.openStart,r);return n&&new vt(n,this.openStart,this.openEnd)}removeBetween(t,r){return new vt(Ice(this.content,t+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,r){if(!r)return vt.empty;let n=r.openStart||0,a=r.openEnd||0;if(typeof n!="number"||typeof a!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new vt(Ge.fromJSON(t,r.content),n,a)}static maxOpen(t,r=!0){let n=0,a=0;for(let s=t.firstChild;s&&!s.isLeaf&&(r||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=t.lastChild;s&&!s.isLeaf&&(r||!s.type.spec.isolating);s=s.lastChild)a++;return new vt(t,n,a)}}vt.empty=new vt(Ge.empty,0,0);function Ice(e,t,r){let{index:n,offset:a}=e.findIndex(t),s=e.maybeChild(n),{index:i,offset:l}=e.findIndex(r);if(a==t||s.isText){if(l!=r&&!e.child(i).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(r))}if(n!=i)throw new RangeError("Removing non-flat range");return e.replaceChild(n,s.copy(Ice(s.content,t-a-1,r-a-1)))}function Rce(e,t,r,n){let{index:a,offset:s}=e.findIndex(t),i=e.maybeChild(a);if(s==t||i.isText)return n&&!n.canReplace(a,a,r)?null:e.cut(0,t).append(r).append(e.cut(t));let l=Rce(i.content,t-s-1,r,i);return l&&e.replaceChild(a,i.copy(l))}function lze(e,t,r){if(r.openStart>e.depth)throw new lN("Inserted content deeper than insertion position");if(e.depth-r.openStart!=t.depth-r.openEnd)throw new lN("Inconsistent open depths");return Pce(e,t,r,0)}function Pce(e,t,r,n){let a=e.index(n),s=e.node(n);if(a==t.index(n)&&n<e.depth-r.openStart){let i=Pce(e,t,r,n+1);return s.copy(s.content.replaceChild(a,i))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&e.depth==n&&t.depth==n){let i=e.parent,l=i.content;return sh(i,l.cut(0,e.parentOffset).append(r.content).append(l.cut(t.parentOffset)))}else{let{start:i,end:l}=cze(r,e);return sh(s,Bce(e,i,l,t,n))}else return sh(s,cN(e,t,n))}function zce(e,t){if(!t.type.compatibleContent(e.type))throw new lN("Cannot join "+t.type.name+" onto "+e.type.name)}function bR(e,t,r){let n=e.node(r);return zce(n,t.node(r)),n}function ah(e,t){let r=t.length-1;r>=0&&e.isText&&e.sameMarkup(t[r])?t[r]=e.withText(t[r].text+e.text):t.push(e)}function Ib(e,t,r,n){let a=(t||e).node(r),s=0,i=t?t.index(r):a.childCount;e&&(s=e.index(r),e.depth>r?s++:e.textOffset&&(ah(e.nodeAfter,n),s++));for(let l=s;l<i;l++)ah(a.child(l),n);t&&t.depth==r&&t.textOffset&&ah(t.nodeBefore,n)}function sh(e,t){return e.type.checkContent(t),e.copy(t)}function Bce(e,t,r,n,a){let s=e.depth>a&&bR(e,t,a+1),i=n.depth>a&&bR(r,n,a+1),l=[];return Ib(null,e,a,l),s&&i&&t.index(a)==r.index(a)?(zce(s,i),ah(sh(s,Bce(e,t,r,n,a+1)),l)):(s&&ah(sh(s,cN(e,t,a+1)),l),Ib(t,r,a,l),i&&ah(sh(i,cN(r,n,a+1)),l)),Ib(n,null,a,l),new Ge(l)}function cN(e,t,r){let n=[];if(Ib(null,e,r,n),e.depth>r){let a=bR(e,t,r+1);ah(sh(a,cN(e,t,r+1)),n)}return Ib(t,null,r,n),new Ge(n)}function cze(e,t){let r=t.depth-e.openStart,a=t.node(r).copy(e.content);for(let s=r-1;s>=0;s--)a=t.node(s).copy(Ge.from(a));return{start:a.resolveNoCache(e.openStart+r),end:a.resolveNoCache(a.content.size-e.openEnd-r)}}class Wy{constructor(t,r,n){this.pos=t,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,r=this.index(this.depth);if(r==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],a=t.child(r);return n?t.child(r).cut(n):a}get nodeBefore(){let t=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(t).cut(0,r):t==0?null:this.parent.child(t-1)}posAtIndex(t,r){r=this.resolveDepth(r);let n=this.path[r*3],a=r==0?0:this.path[r*3-1]+1;for(let s=0;s<t;s++)a+=n.child(s).nodeSize;return a}marks(){let t=this.parent,r=this.index();if(t.content.size==0)return hn.none;if(this.textOffset)return t.child(r).marks;let n=t.maybeChild(r-1),a=t.maybeChild(r);if(!n){let l=n;n=a,a=l}let s=n.marks;for(var i=0;i<s.length;i++)s[i].type.spec.inclusive===!1&&(!a||!s[i].isInSet(a.marks))&&(s=s[i--].removeFromSet(s));return s}marksAcross(t){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,a=t.parent.maybeChild(t.index());for(var s=0;s<n.length;s++)n[s].type.spec.inclusive===!1&&(!a||!n[s].isInSet(a.marks))&&(n=n[s--].removeFromSet(n));return n}sharedDepth(t){for(let r=this.depth;r>0;r--)if(this.start(r)<=t&&this.end(r)>=t)return r;return 0}blockRange(t=this,r){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!r||r(this.node(n))))return new uN(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let r=1;r<=this.depth;r++)t+=(t?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return t+":"+this.parentOffset}static resolve(t,r){if(!(r>=0&&r<=t.content.size))throw new RangeError("Position "+r+" out of range");let n=[],a=0,s=r;for(let i=t;;){let{index:l,offset:c}=i.content.findIndex(s),u=s-c;if(n.push(i,l,a+c),!u||(i=i.child(l),i.isText))break;s=u-1,a+=c+1}return new Wy(r,n,s)}static resolveCached(t,r){let n=aQ.get(t);if(n)for(let s=0;s<n.elts.length;s++){let i=n.elts[s];if(i.pos==r)return i}else aQ.set(t,n=new uze);let a=n.elts[n.i]=Wy.resolve(t,r);return n.i=(n.i+1)%dze,a}}class uze{constructor(){this.elts=[],this.i=0}}const dze=12,aQ=new WeakMap;class uN{constructor(t,r,n){this.$from=t,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const fze=Object.create(null);let Cd=class yR{constructor(t,r,n,a=hn.none){this.type=t,this.attrs=r,this.marks=a,this.content=n||Ge.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,r,n,a=0){this.content.nodesBetween(t,r,n,a,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,r,n,a){return this.content.textBetween(t,r,n,a)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,r,n){return this.type==t&&oN(this.attrs,r||t.defaultAttrs||fze)&&hn.sameSet(this.marks,n||hn.none)}copy(t=null){return t==this.content?this:new yR(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new yR(this.type,this.attrs,this.content,t)}cut(t,r=this.content.size){return t==0&&r==this.content.size?this:this.copy(this.content.cut(t,r))}slice(t,r=this.content.size,n=!1){if(t==r)return vt.empty;let a=this.resolve(t),s=this.resolve(r),i=n?0:a.sharedDepth(r),l=a.start(i),u=a.node(i).content.cut(a.pos-l,s.pos-l);return new vt(u,a.depth-i,s.depth-i)}replace(t,r,n){return lze(this.resolve(t),this.resolve(r),n)}nodeAt(t){for(let r=this;;){let{index:n,offset:a}=r.content.findIndex(t);if(r=r.maybeChild(n),!r)return null;if(a==t||r.isText)return r;t-=a+1}}childAfter(t){let{index:r,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(r),index:r,offset:n};let a=this.content.child(r-1);return{node:a,index:r-1,offset:n-a.nodeSize}}resolve(t){return Wy.resolveCached(this,t)}resolveNoCache(t){return Wy.resolve(this,t)}rangeHasMark(t,r,n){let a=!1;return r>t&&this.nodesBetween(t,r,s=>(n.isInSet(s.marks)&&(a=!0),!a)),a}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),$ce(this.marks,t)}contentMatchAt(t){let r=this.type.contentMatch.matchFragment(this.content,0,t);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(t,r,n=Ge.empty,a=0,s=n.childCount){let i=this.contentMatchAt(t).matchFragment(n,a,s),l=i&&i.matchFragment(this.content,r);if(!l||!l.validEnd)return!1;for(let c=a;c<s;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0}canReplaceWith(t,r,n,a){if(a&&!this.type.allowsMarks(a))return!1;let s=this.contentMatchAt(t).matchType(n),i=s&&s.matchFragment(this.content,r);return i?i.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=hn.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),t=n.addToSet(t)}if(!hn.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let t={type:this.type.name};for(let r in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(r=>r.toJSON())),t}static fromJSON(t,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(t.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(r.text,n)}let a=Ge.fromJSON(t,r.content),s=t.nodeType(r.type).create(r.attrs,a,n);return s.type.checkAttrs(s.attrs),s}};Cd.prototype.text=void 0;class dN extends Cd{constructor(t,r,n,a){if(super(t,r,null,a),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):$ce(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,r){return this.text.slice(t,r)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new dN(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new dN(this.type,this.attrs,t,this.marks)}cut(t=0,r=this.text.length){return t==0&&r==this.text.length?this:this.withText(this.text.slice(t,r))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function $ce(e,t){for(let r=e.length-1;r>=0;r--)t=e[r].type.name+"("+t+")";return t}class Nh{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,r){let n=new hze(t,r);if(n.next==null)return Nh.empty;let a=Fce(n);n.next&&n.err("Unexpected trailing text");let s=xze(yze(a));return wze(s,n),s}matchType(t){for(let r=0;r<this.next.length;r++)if(this.next[r].type==t)return this.next[r].next;return null}matchFragment(t,r=0,n=t.childCount){let a=this;for(let s=r;a&&s<n;s++)a=a.matchType(t.child(s).type);return a}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:r}=this.next[t];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(t){for(let r=0;r<this.next.length;r++)for(let n=0;n<t.next.length;n++)if(this.next[r].type==t.next[n].type)return!0;return!1}fillBefore(t,r=!1,n=0){let a=[this];function s(i,l){let c=i.matchFragment(t,n);if(c&&(!r||c.validEnd))return Ge.from(l.map(u=>u.createAndFill()));for(let u=0;u<i.next.length;u++){let{type:d,next:f}=i.next[u];if(!(d.isText||d.hasRequiredAttrs())&&a.indexOf(f)==-1){a.push(f);let m=s(f,l.concat(d));if(m)return m}}return null}return s(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let r=this.computeWrapping(t);return this.wrapCache.push(t,r),r}computeWrapping(t){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let a=n.shift(),s=a.match;if(s.matchType(t)){let i=[];for(let l=a;l.type;l=l.via)i.push(l.type);return i.reverse()}for(let i=0;i<s.next.length;i++){let{type:l,next:c}=s.next[i];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in r)&&(!a.type||c.validEnd)&&(n.push({match:l.contentMatch,type:l,via:a}),r[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function r(n){t.push(n);for(let a=0;a<n.next.length;a++)t.indexOf(n.next[a].next)==-1&&r(n.next[a].next)}return r(this),t.map((n,a)=>{let s=a+(n.validEnd?"*":" ")+" ";for(let i=0;i<n.next.length;i++)s+=(i?", ":"")+n.next[i].type.name+"->"+t.indexOf(n.next[i].next);return s}).join(`
`)}}Nh.empty=new Nh(!0);class hze{constructor(t,r){this.string=t,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function Fce(e){let t=[];do t.push(mze(e));while(e.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function mze(e){let t=[];do t.push(pze(e));while(e.next&&e.next!=")"&&e.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function pze(e){let t=bze(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else if(e.eat("{"))t=gze(e,t);else break;return t}function sQ(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function gze(e,t){let r=sQ(e),n=r;return e.eat(",")&&(e.next!="}"?n=sQ(e):n=-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:t}}function vze(e,t){let r=e.nodeTypes,n=r[t];if(n)return[n];let a=[];for(let s in r){let i=r[s];i.isInGroup(t)&&a.push(i)}return a.length==0&&e.err("No node type or group '"+t+"' found"),a}function bze(e){if(e.eat("(")){let t=Fce(e);return e.eat(")")||e.err("Missing closing paren"),t}else if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=vze(e,e.next).map(r=>(e.inline==null?e.inline=r.isInline:e.inline!=r.isInline&&e.err("Mixing inline and block content"),{type:"name",value:r}));return e.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function yze(e){let t=[[]];return a(s(e,0),r()),t;function r(){return t.push([])-1}function n(i,l,c){let u={term:c,to:l};return t[i].push(u),u}function a(i,l){i.forEach(c=>c.to=l)}function s(i,l){if(i.type=="choice")return i.exprs.reduce((c,u)=>c.concat(s(u,l)),[]);if(i.type=="seq")for(let c=0;;c++){let u=s(i.exprs[c],l);if(c==i.exprs.length-1)return u;a(u,l=r())}else if(i.type=="star"){let c=r();return n(l,c),a(s(i.expr,c),c),[n(c)]}else if(i.type=="plus"){let c=r();return a(s(i.expr,l),c),a(s(i.expr,c),c),[n(c)]}else{if(i.type=="opt")return[n(l)].concat(s(i.expr,l));if(i.type=="range"){let c=l;for(let u=0;u<i.min;u++){let d=r();a(s(i.expr,c),d),c=d}if(i.max==-1)a(s(i.expr,c),c);else for(let u=i.min;u<i.max;u++){let d=r();n(c,d),a(s(i.expr,c),d),c=d}return[n(c)]}else{if(i.type=="name")return[n(l,void 0,i.value)];throw new Error("Unknown expr type")}}}}function Uce(e,t){return t-e}function iQ(e,t){let r=[];return n(t),r.sort(Uce);function n(a){let s=e[a];if(s.length==1&&!s[0].term)return n(s[0].to);r.push(a);for(let i=0;i<s.length;i++){let{term:l,to:c}=s[i];!l&&r.indexOf(c)==-1&&n(c)}}}function xze(e){let t=Object.create(null);return r(iQ(e,0));function r(n){let a=[];n.forEach(i=>{e[i].forEach(({term:l,to:c})=>{if(!l)return;let u;for(let d=0;d<a.length;d++)a[d][0]==l&&(u=a[d][1]);iQ(e,c).forEach(d=>{u||a.push([l,u=[]]),u.indexOf(d)==-1&&u.push(d)})})});let s=t[n.join(",")]=new Nh(n.indexOf(e.length-1)>-1);for(let i=0;i<a.length;i++){let l=a[i][1].sort(Uce);s.next.push({type:a[i][0],next:t[l.join(",")]||r(l)})}return s}}function wze(e,t){for(let r=0,n=[e];r<n.length;r++){let a=n[r],s=!a.validEnd,i=[];for(let l=0;l<a.next.length;l++){let{type:c,next:u}=a.next[l];i.push(c.name),s&&!(c.isText||c.hasRequiredAttrs())&&(s=!1),n.indexOf(u)==-1&&n.push(u)}s&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Hce(e){let t=Object.create(null);for(let r in e){let n=e[r];if(!n.hasDefault)return null;t[r]=n.default}return t}function qce(e,t){let r=Object.create(null);for(let n in e){let a=t&&t[n];if(a===void 0){let s=e[n];if(s.hasDefault)a=s.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=a}return r}function Wce(e,t,r,n){for(let a in t)if(!(a in e))throw new RangeError(`Unsupported attribute ${a} for ${r} of type ${a}`);for(let a in e){let s=e[a];s.validate&&s.validate(t[a])}}function Kce(e,t){let r=Object.create(null);if(t)for(let n in t)r[n]=new kze(e,n,t[n]);return r}let oQ=class Gce{constructor(t,r,n){this.name=t,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Kce(t,n.attrs),this.defaultAttrs=Hce(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Nh.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:qce(this.attrs,t)}create(t=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Cd(this,this.computeAttrs(t),Ge.from(r),hn.setFrom(n))}createChecked(t=null,r,n){return r=Ge.from(r),this.checkContent(r),new Cd(this,this.computeAttrs(t),r,hn.setFrom(n))}createAndFill(t=null,r,n){if(t=this.computeAttrs(t),r=Ge.from(r),r.size){let i=this.contentMatch.fillBefore(r);if(!i)return null;r=i.append(r)}let a=this.contentMatch.matchFragment(r),s=a&&a.fillBefore(Ge.empty,!0);return s?new Cd(this,t,r.append(s),hn.setFrom(n)):null}validContent(t){let r=this.contentMatch.matchFragment(t);if(!r||!r.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){Wce(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let r=0;r<t.length;r++)if(!this.allowsMarkType(t[r].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let r;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?r&&r.push(t[n]):r||(r=t.slice(0,n));return r?r.length?r:hn.none:t}static compile(t,r){let n=Object.create(null);t.forEach((s,i)=>n[s]=new Gce(s,r,i));let a=r.spec.topNode||"doc";if(!n[a])throw new RangeError("Schema is missing its top node type ('"+a+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function Sze(e,t,r){let n=r.split("|");return a=>{let s=a===null?"null":typeof a;if(n.indexOf(s)<0)throw new RangeError(`Expected value of type ${n} for attribute ${t} on type ${e}, got ${s}`)}}class kze{constructor(t,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?Sze(t,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Vj{constructor(t,r,n,a){this.name=t,this.rank=r,this.schema=n,this.spec=a,this.attrs=Kce(t,a.attrs),this.excluded=null;let s=Hce(this.attrs);this.instance=s?new hn(this,s):null}create(t=null){return!t&&this.instance?this.instance:new hn(this,qce(this.attrs,t))}static compile(t,r){let n=Object.create(null),a=0;return t.forEach((s,i)=>n[s]=new Vj(s,a++,r,i)),n}removeFromSet(t){for(var r=0;r<t.length;r++)t[r].type==this&&(t=t.slice(0,r).concat(t.slice(r+1)),r--);return t}isInSet(t){for(let r=0;r<t.length;r++)if(t[r].type==this)return t[r]}checkAttrs(t){Wce(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class Vce{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let a in t)r[a]=t[a];r.nodes=ns.from(t.nodes),r.marks=ns.from(t.marks||{}),this.nodes=oQ.compile(this.spec.nodes,this),this.marks=Vj.compile(this.spec.marks,this);let n=Object.create(null);for(let a in this.nodes){if(a in this.marks)throw new RangeError(a+" can not be both a node and a mark");let s=this.nodes[a],i=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=n[i]||(n[i]=Nh.parse(i,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?lQ(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let a in this.marks){let s=this.marks[a],i=s.spec.excludes;s.excluded=i==null?[s]:i==""?[]:lQ(this,i.split(" "))}this.nodeFromJSON=a=>Cd.fromJSON(this,a),this.markFromJSON=a=>hn.fromJSON(this,a),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,r=null,n,a){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof oQ){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(r,n,a)}text(t,r){let n=this.nodes.text;return new dN(n,n.defaultAttrs,t,hn.setFrom(r))}mark(t,r){return typeof t=="string"&&(t=this.marks[t]),t.create(r)}nodeType(t){let r=this.nodes[t];if(!r)throw new RangeError("Unknown node type: "+t);return r}}function lQ(e,t){let r=[];for(let n=0;n<t.length;n++){let a=t[n],s=e.marks[a],i=s;if(s)r.push(s);else for(let l in e.marks){let c=e.marks[l];(a=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(a)>-1)&&r.push(i=c)}if(!i)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return r}function _ze(e){return e.tag!=null}function Nze(e){return e.style!=null}class jd{constructor(t,r){this.schema=t,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(a=>{if(_ze(a))this.tags.push(a);else if(Nze(a)){let s=/[^=]*/.exec(a.style)[0];n.indexOf(s)<0&&n.push(s),this.styles.push(a)}}),this.normalizeLists=!this.tags.some(a=>{if(!/^(ul|ol)\b/.test(a.tag)||!a.node)return!1;let s=t.nodes[a.node];return s.contentMatch.matchType(s)})}parse(t,r={}){let n=new uQ(this,r,!1);return n.addAll(t,hn.none,r.from,r.to),n.finish()}parseSlice(t,r={}){let n=new uQ(this,r,!0);return n.addAll(t,hn.none,r.from,r.to),vt.maxOpen(n.finish())}matchTag(t,r,n){for(let a=n?this.tags.indexOf(n)+1:0;a<this.tags.length;a++){let s=this.tags[a];if(Eze(t,s.tag)&&(s.namespace===void 0||t.namespaceURI==s.namespace)&&(!s.context||r.matchesContext(s.context))){if(s.getAttrs){let i=s.getAttrs(t);if(i===!1)continue;s.attrs=i||void 0}return s}}}matchStyle(t,r,n,a){for(let s=a?this.styles.indexOf(a)+1:0;s<this.styles.length;s++){let i=this.styles[s],l=i.style;if(!(l.indexOf(t)!=0||i.context&&!n.matchesContext(i.context)||l.length>t.length&&(l.charCodeAt(t.length)!=61||l.slice(t.length+1)!=r))){if(i.getAttrs){let c=i.getAttrs(r);if(c===!1)continue;i.attrs=c||void 0}return i}}}static schemaRules(t){let r=[];function n(a){let s=a.priority==null?50:a.priority,i=0;for(;i<r.length;i++){let l=r[i];if((l.priority==null?50:l.priority)<s)break}r.splice(i,0,a)}for(let a in t.marks){let s=t.marks[a].spec.parseDOM;s&&s.forEach(i=>{n(i=dQ(i)),i.mark||i.ignore||i.clearMark||(i.mark=a)})}for(let a in t.nodes){let s=t.nodes[a].spec.parseDOM;s&&s.forEach(i=>{n(i=dQ(i)),i.node||i.ignore||i.mark||(i.node=a)})}return r}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new jd(t,jd.schemaRules(t)))}}const Yce={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Cze={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Qce={ol:!0,ul:!0},Ky=1,xR=2,Rb=4;function cQ(e,t,r){return t!=null?(t?Ky:0)|(t==="full"?xR:0):e&&e.whitespace=="pre"?Ky|xR:r&~Rb}class dS{constructor(t,r,n,a,s,i){this.type=t,this.attrs=r,this.marks=n,this.solid=a,this.options=i,this.content=[],this.activeMarks=hn.none,this.match=s||(i&Rb?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ge.from(t));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,a;return(a=n.findWrapping(t.type))?(this.match=n,a):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&Ky)){let n=this.content[this.content.length-1],a;if(n&&n.isText&&(a=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==a[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-a[0].length))}}let r=Ge.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Ge.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!Yce.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class uQ{constructor(t,r,n){this.parser=t,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let a=r.topNode,s,i=cQ(null,r.preserveWhitespace,0)|(n?Rb:0);a?s=new dS(a.type,a.attrs,hn.none,!0,r.topMatch||a.type.contentMatch,i):n?s=new dS(null,null,hn.none,!0,null,i):s=new dS(t.schema.topNodeType,null,hn.none,!0,null,i),this.nodes=[s],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,r){t.nodeType==3?this.addTextNode(t,r):t.nodeType==1&&this.addElement(t,r)}addTextNode(t,r){let n=t.nodeValue,a=this.top,s=a.options&xR?"full":this.localPreserveWS||(a.options&Ky)>0,{schema:i}=this.parser;if(s==="full"||a.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(s)if(s==="full")n=n.replace(/\r\n?/g,`
`);else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let l=n.split(/\r?\n|\r/);for(let c=0;c<l.length;c++)c&&this.insertNode(i.linebreakReplacement.create(),r,!0),l[c]&&this.insertNode(i.text(l[c]),r,!/\S/.test(l[c]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let l=a.content[a.content.length-1],c=t.previousSibling;(!l||c&&c.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),r,!/\S/.test(n)),this.findInText(t)}else this.findInside(t)}addElement(t,r,n){let a=this.localPreserveWS,s=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let i=t.nodeName.toLowerCase(),l;Qce.hasOwnProperty(i)&&this.parser.normalizeLists&&jze(t);let c=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(l=this.parser.matchTag(t,this,n));e:if(c?c.ignore:Cze.hasOwnProperty(i))this.findInside(t),this.ignoreFallback(t,r);else if(!c||c.skip||c.closeParent){c&&c.closeParent?this.open=Math.max(0,this.open-1):c&&c.skip.nodeType&&(t=c.skip);let u,d=this.needsBlock;if(Yce.hasOwnProperty(i))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),u=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,r);break e}let f=c&&c.skip?r:this.readStyles(t,r);f&&this.addAll(t,f),u&&this.sync(s),this.needsBlock=d}else{let u=this.readStyles(t,r);u&&this.addElementByRule(t,c,u,c.consuming===!1?l:void 0)}this.localPreserveWS=a}leafFallback(t,r){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),r)}ignoreFallback(t,r){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(t,r){let n=t.style;if(n&&n.length)for(let a=0;a<this.parser.matchedStyles.length;a++){let s=this.parser.matchedStyles[a],i=n.getPropertyValue(s);if(i)for(let l=void 0;;){let c=this.parser.matchStyle(s,i,this,l);if(!c)break;if(c.ignore)return null;if(c.clearMark?r=r.filter(u=>!c.clearMark(u)):r=r.concat(this.parser.schema.marks[c.mark].create(c.attrs)),c.consuming===!1)l=c;else break}}return r}addElementByRule(t,r,n,a){let s,i;if(r.node)if(i=this.parser.schema.nodes[r.node],i.isLeaf)this.insertNode(i.create(r.attrs),n,t.nodeName=="BR")||this.leafFallback(t,n);else{let c=this.enter(i,r.attrs||null,n,r.preserveWhitespace);c&&(s=!0,n=c)}else{let c=this.parser.schema.marks[r.mark];n=n.concat(c.create(r.attrs))}let l=this.top;if(i&&i.isLeaf)this.findInside(t);else if(a)this.addElement(t,n,a);else if(r.getContent)this.findInside(t),r.getContent(t,this.parser.schema).forEach(c=>this.insertNode(c,n,!1));else{let c=t;typeof r.contentElement=="string"?c=t.querySelector(r.contentElement):typeof r.contentElement=="function"?c=r.contentElement(t):r.contentElement&&(c=r.contentElement),this.findAround(t,c,!0),this.addAll(c,n),this.findAround(t,c,!1)}s&&this.sync(l)&&this.open--}addAll(t,r,n,a){let s=n||0;for(let i=n?t.childNodes[n]:t.firstChild,l=a==null?null:t.childNodes[a];i!=l;i=i.nextSibling,++s)this.findAtPoint(t,s),this.addDOM(i,r);this.findAtPoint(t,s)}findPlace(t,r,n){let a,s;for(let i=this.open,l=0;i>=0;i--){let c=this.nodes[i],u=c.findWrapping(t);if(u&&(!a||a.length>u.length+l)&&(a=u,s=c,!u.length))break;if(c.solid){if(n)break;l+=2}}if(!a)return null;this.sync(s);for(let i=0;i<a.length;i++)r=this.enterInner(a[i],null,r,!1);return r}insertNode(t,r,n){if(t.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(r=this.enterInner(s,null,r))}let a=this.findPlace(t,r,n);if(a){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(t.type));let i=hn.none;for(let l of a.concat(t.marks))(s.type?s.type.allowsMarkType(l.type):fQ(l.type,t.type))&&(i=l.addToSet(i));return s.content.push(t.mark(i)),!0}return!1}enter(t,r,n,a){let s=this.findPlace(t.create(r),n,!1);return s&&(s=this.enterInner(t,r,n,!0,a)),s}enterInner(t,r,n,a=!1,s){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(t);let l=cQ(t,s,i.options);i.options&Rb&&i.content.length==0&&(l|=Rb);let c=hn.none;return n=n.filter(u=>(i.type?i.type.allowsMarkType(u.type):fQ(u.type,t))?(c=u.addToSet(c),!1):!0),this.nodes.push(new dS(t,r,c,a,null,l)),this.open++,n}closeExtra(t=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let r=this.open;r>=0;r--){if(this.nodes[r]==t)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=Ky)}return!1}get currentPos(){this.closeExtra();let t=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let a=n.length-1;a>=0;a--)t+=n[a].nodeSize;r&&t++}return t}findAtPoint(t,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&t.nodeType==1&&t.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(t,r,n){if(t!=r&&this.find)for(let a=0;a<this.find.length;a++)this.find[a].pos==null&&t.nodeType==1&&t.contains(this.find[a].node)&&r.compareDocumentPosition(this.find[a].node)&(n?2:4)&&(this.find[a].pos=this.currentPos)}findInText(t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&(this.find[r].pos=this.currentPos-(t.nodeValue.length-this.find[r].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let r=t.split("/"),n=this.options.context,a=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+(a?0:1),i=(l,c)=>{for(;l>=0;l--){let u=r[l];if(u==""){if(l==r.length-1||l==0)continue;for(;c>=s;c--)if(i(l-1,c))return!0;return!1}else{let d=c>0||c==0&&a?this.nodes[c].type:n&&c>=s?n.node(c-s).type:null;if(!d||d.name!=u&&!d.isInGroup(u))return!1;c--}}return!0};return i(r.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let r=t.depth;r>=0;r--){let n=t.node(r).contentMatchAt(t.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function jze(e){for(let t=e.firstChild,r=null;t;t=t.nextSibling){let n=t.nodeType==1?t.nodeName.toLowerCase():null;n&&Qce.hasOwnProperty(n)&&r?(r.appendChild(t),t=r):n=="li"?r=t:n&&(r=null)}}function Eze(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function dQ(e){let t={};for(let r in e)t[r]=e[r];return t}function fQ(e,t){let r=t.schema.nodes;for(let n in r){let a=r[n];if(!a.allowsMarkType(e))continue;let s=[],i=l=>{s.push(l);for(let c=0;c<l.edgeCount;c++){let{type:u,next:d}=l.edge(c);if(u==t||s.indexOf(d)<0&&i(d))return!0}};if(i(a.contentMatch))return!0}}class Zh{constructor(t,r){this.nodes=t,this.marks=r}serializeFragment(t,r={},n){n||(n=TD(r).createDocumentFragment());let a=n,s=[];return t.forEach(i=>{if(s.length||i.marks.length){let l=0,c=0;for(;l<s.length&&c<i.marks.length;){let u=i.marks[c];if(!this.marks[u.type.name]){c++;continue}if(!u.eq(s[l][0])||u.type.spec.spanning===!1)break;l++,c++}for(;l<s.length;)a=s.pop()[1];for(;c<i.marks.length;){let u=i.marks[c++],d=this.serializeMark(u,i.isInline,r);d&&(s.push([u,a]),a.appendChild(d.dom),a=d.contentDOM||d.dom)}}a.appendChild(this.serializeNodeInner(i,r))}),n}serializeNodeInner(t,r){let{dom:n,contentDOM:a}=xk(TD(r),this.nodes[t.type.name](t),null,t.attrs);if(a){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,r,a)}return n}serializeNode(t,r={}){let n=this.serializeNodeInner(t,r);for(let a=t.marks.length-1;a>=0;a--){let s=this.serializeMark(t.marks[a],t.isInline,r);s&&((s.contentDOM||s.dom).appendChild(n),n=s.dom)}return n}serializeMark(t,r,n={}){let a=this.marks[t.type.name];return a&&xk(TD(n),a(t,r),null,t.attrs)}static renderSpec(t,r,n=null,a){return xk(t,r,n,a)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new Zh(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let r=hQ(t.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(t){return hQ(t.marks)}}function hQ(e){let t={};for(let r in e){let n=e[r].spec.toDOM;n&&(t[r]=n)}return t}function TD(e){return e.document||window.document}const mQ=new WeakMap;function Mze(e){let t=mQ.get(e);return t===void 0&&mQ.set(e,t=Tze(e)),t}function Tze(e){let t=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")t||(t=[]),t.push(n);else for(let a=0;a<n.length;a++)r(n[a]);else for(let a in n)r(n[a])}return r(e),t}function xk(e,t,r,n){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let a=t[0],s;if(typeof a!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(s=Mze(n))&&s.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let i=a.indexOf(" ");i>0&&(r=a.slice(0,i),a=a.slice(i+1));let l,c=r?e.createElementNS(r,a):e.createElement(a),u=t[1],d=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){d=2;for(let f in u)if(u[f]!=null){let m=f.indexOf(" ");m>0?c.setAttributeNS(f.slice(0,m),f.slice(m+1),u[f]):f=="style"&&c.style?c.style.cssText=u[f]:c.setAttribute(f,u[f])}}for(let f=d;f<t.length;f++){let m=t[f];if(m===0){if(f<t.length-1||f>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:p,contentDOM:v}=xk(e,m,r,n);if(c.appendChild(p),v){if(l)throw new RangeError("Multiple content holes");l=v}}}return{dom:c,contentDOM:l}}const Jce=65535,Zce=Math.pow(2,16);function Aze(e,t){return e+t*Zce}function pQ(e){return e&Jce}function Dze(e){return(e-(e&Jce))/Zce}const Xce=1,eue=2,wk=4,tue=8;class wR{constructor(t,r,n){this.pos=t,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&tue)>0}get deletedBefore(){return(this.delInfo&(Xce|wk))>0}get deletedAfter(){return(this.delInfo&(eue|wk))>0}get deletedAcross(){return(this.delInfo&wk)>0}}class Mi{constructor(t,r=!1){if(this.ranges=t,this.inverted=r,!t.length&&Mi.empty)return Mi.empty}recover(t){let r=0,n=pQ(t);if(!this.inverted)for(let a=0;a<n;a++)r+=this.ranges[a*3+2]-this.ranges[a*3+1];return this.ranges[n*3]+r+Dze(t)}mapResult(t,r=1){return this._map(t,r,!1)}map(t,r=1){return this._map(t,r,!0)}_map(t,r,n){let a=0,s=this.inverted?2:1,i=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?a:0);if(c>t)break;let u=this.ranges[l+s],d=this.ranges[l+i],f=c+u;if(t<=f){let m=u?t==c?-1:t==f?1:r:r,p=c+a+(m<0?0:d);if(n)return p;let v=t==(r<0?c:f)?null:Aze(l/3,t-c),b=t==c?eue:t==f?Xce:wk;return(r<0?t!=c:t!=f)&&(b|=tue),new wR(p,b,v)}a+=d-u}return n?t+a:new wR(t+a,0,null)}touches(t,r){let n=0,a=pQ(r),s=this.inverted?2:1,i=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?n:0);if(c>t)break;let u=this.ranges[l+s],d=c+u;if(t<=d&&l==a*3)return!0;n+=this.ranges[l+i]-u}return!1}forEach(t){let r=this.inverted?2:1,n=this.inverted?1:2;for(let a=0,s=0;a<this.ranges.length;a+=3){let i=this.ranges[a],l=i-(this.inverted?s:0),c=i+(this.inverted?0:s),u=this.ranges[a+r],d=this.ranges[a+n];t(l,l+u,c,c+d),s+=d-u}}invert(){return new Mi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Mi.empty:new Mi(t<0?[0,-t,0]:[0,0,t])}}Mi.empty=new Mi([]);class Gy{constructor(t,r,n=0,a=t?t.length:0){this.mirror=r,this.from=n,this.to=a,this._maps=t||[],this.ownData=!(t||r)}get maps(){return this._maps}slice(t=0,r=this.maps.length){return new Gy(this._maps,this.mirror,t,r)}appendMap(t,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(t){for(let r=0,n=this._maps.length;r<t._maps.length;r++){let a=t.getMirror(r);this.appendMap(t._maps[r],a!=null&&a<r?n+a:void 0)}}getMirror(t){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==t)return this.mirror[r+(r%2?-1:1)]}}setMirror(t,r){this.mirror||(this.mirror=[]),this.mirror.push(t,r)}appendMappingInverted(t){for(let r=t.maps.length-1,n=this._maps.length+t._maps.length;r>=0;r--){let a=t.getMirror(r);this.appendMap(t._maps[r].invert(),a!=null&&a>r?n-a-1:void 0)}}invert(){let t=new Gy;return t.appendMappingInverted(this),t}map(t,r=1){if(this.mirror)return this._map(t,r,!0);for(let n=this.from;n<this.to;n++)t=this._maps[n].map(t,r);return t}mapResult(t,r=1){return this._map(t,r,!1)}_map(t,r,n){let a=0;for(let s=this.from;s<this.to;s++){let i=this._maps[s],l=i.mapResult(t,r);if(l.recover!=null){let c=this.getMirror(s);if(c!=null&&c>s&&c<this.to){s=c,t=this._maps[c].recover(l.recover);continue}}a|=l.delInfo,t=l.pos}return n?t:new wR(t,a,null)}}const AD=Object.create(null);class Ss{getMap(){return Mi.empty}merge(t){return null}static fromJSON(t,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=AD[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in AD)throw new RangeError("Duplicate use of step JSON ID "+t);return AD[t]=r,r.prototype.jsonID=t,r}}class pa{constructor(t,r){this.doc=t,this.failed=r}static ok(t){return new pa(t,null)}static fail(t){return new pa(null,t)}static fromReplace(t,r,n,a){try{return pa.ok(t.replace(r,n,a))}catch(s){if(s instanceof lN)return pa.fail(s.message);throw s}}}function o9(e,t,r){let n=[];for(let a=0;a<e.childCount;a++){let s=e.child(a);s.content.size&&(s=s.copy(o9(s.content,t,s))),s.isInline&&(s=t(s,r,a)),n.push(s)}return Ge.fromArray(n)}class bd extends Ss{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=t.resolve(this.from),a=n.node(n.sharedDepth(this.to)),s=new vt(o9(r.content,(i,l)=>!i.isAtom||!l.type.allowsMarkType(this.mark.type)?i:i.mark(this.mark.addToSet(i.marks)),a),r.openStart,r.openEnd);return pa.fromReplace(t,this.from,this.to,s)}invert(){return new Wo(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new bd(r.pos,n.pos,this.mark)}merge(t){return t instanceof bd&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new bd(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new bd(r.from,r.to,t.markFromJSON(r.mark))}}Ss.jsonID("addMark",bd);class Wo extends Ss{constructor(t,r,n){super(),this.from=t,this.to=r,this.mark=n}apply(t){let r=t.slice(this.from,this.to),n=new vt(o9(r.content,a=>a.mark(this.mark.removeFromSet(a.marks)),t),r.openStart,r.openEnd);return pa.fromReplace(t,this.from,this.to,n)}invert(){return new bd(this.from,this.to,this.mark)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Wo(r.pos,n.pos,this.mark)}merge(t){return t instanceof Wo&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Wo(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Wo(r.from,r.to,t.markFromJSON(r.mark))}}Ss.jsonID("removeMark",Wo);class yd extends Ss{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return pa.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return pa.fromReplace(t,this.pos,this.pos+1,new vt(Ge.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let a=0;a<r.marks.length;a++)if(!r.marks[a].isInSet(n))return new yd(this.pos,r.marks[a]);return new yd(this.pos,this.mark)}}return new Ch(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new yd(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new yd(r.pos,t.markFromJSON(r.mark))}}Ss.jsonID("addNodeMark",yd);class Ch extends Ss{constructor(t,r){super(),this.pos=t,this.mark=r}apply(t){let r=t.nodeAt(this.pos);if(!r)return pa.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return pa.fromReplace(t,this.pos,this.pos+1,new vt(Ge.from(n),0,r.isLeaf?0:1))}invert(t){let r=t.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new yd(this.pos,this.mark)}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new Ch(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ch(r.pos,t.markFromJSON(r.mark))}}Ss.jsonID("removeNodeMark",Ch);class Fa extends Ss{constructor(t,r,n,a=!1){super(),this.from=t,this.to=r,this.slice=n,this.structure=a}apply(t){return this.structure&&SR(t,this.from,this.to)?pa.fail("Structure replace would overwrite content"):pa.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Mi([this.from,this.to-this.from,this.slice.size])}invert(t){return new Fa(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new Fa(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(t){if(!(t instanceof Fa)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let r=this.slice.size+t.slice.size==0?vt.empty:new vt(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Fa(this.from,this.to+(t.to-t.from),r,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let r=this.slice.size+t.slice.size==0?vt.empty:new vt(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Fa(t.from,this.to,r,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Fa(r.from,r.to,vt.fromJSON(t,r.slice),!!r.structure)}}Ss.jsonID("replace",Fa);class Ha extends Ss{constructor(t,r,n,a,s,i,l=!1){super(),this.from=t,this.to=r,this.gapFrom=n,this.gapTo=a,this.slice=s,this.insert=i,this.structure=l}apply(t){if(this.structure&&(SR(t,this.from,this.gapFrom)||SR(t,this.gapTo,this.to)))return pa.fail("Structure gap-replace would overwrite content");let r=t.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return pa.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?pa.fromReplace(t,this.from,this.to,n):pa.fail("Content does not fit in gap")}getMap(){return new Mi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let r=this.gapTo-this.gapFrom;return new Ha(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let r=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),a=this.from==this.gapFrom?r.pos:t.map(this.gapFrom,-1),s=this.to==this.gapTo?n.pos:t.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||a<r.pos||s>n.pos?null:new Ha(r.pos,n.pos,a,s,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ha(r.from,r.to,r.gapFrom,r.gapTo,vt.fromJSON(t,r.slice),r.insert,!!r.structure)}}Ss.jsonID("replaceAround",Ha);function SR(e,t,r){let n=e.resolve(t),a=r-t,s=n.depth;for(;a>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,a--;if(a>0){let i=n.node(s).maybeChild(n.indexAfter(s));for(;a>0;){if(!i||i.isLeaf)return!0;i=i.firstChild,a--}}return!1}function Lze(e,t,r,n){let a=[],s=[],i,l;e.doc.nodesBetween(t,r,(c,u,d)=>{if(!c.isInline)return;let f=c.marks;if(!n.isInSet(f)&&d.type.allowsMarkType(n.type)){let m=Math.max(u,t),p=Math.min(u+c.nodeSize,r),v=n.addToSet(f);for(let b=0;b<f.length;b++)f[b].isInSet(v)||(i&&i.to==m&&i.mark.eq(f[b])?i.to=p:a.push(i=new Wo(m,p,f[b])));l&&l.to==m?l.to=p:s.push(l=new bd(m,p,n))}}),a.forEach(c=>e.step(c)),s.forEach(c=>e.step(c))}function Oze(e,t,r,n){let a=[],s=0;e.doc.nodesBetween(t,r,(i,l)=>{if(!i.isInline)return;s++;let c=null;if(n instanceof Vj){let u=i.marks,d;for(;d=n.isInSet(u);)(c||(c=[])).push(d),u=d.removeFromSet(u)}else n?n.isInSet(i.marks)&&(c=[n]):c=i.marks;if(c&&c.length){let u=Math.min(l+i.nodeSize,r);for(let d=0;d<c.length;d++){let f=c[d],m;for(let p=0;p<a.length;p++){let v=a[p];v.step==s-1&&f.eq(a[p].style)&&(m=v)}m?(m.to=u,m.step=s):a.push({style:f,from:Math.max(l,t),to:u,step:s})}}}),a.forEach(i=>e.step(new Wo(i.from,i.to,i.style)))}function l9(e,t,r,n=r.contentMatch,a=!0){let s=e.doc.nodeAt(t),i=[],l=t+1;for(let c=0;c<s.childCount;c++){let u=s.child(c),d=l+u.nodeSize,f=n.matchType(u.type);if(!f)i.push(new Fa(l,d,vt.empty));else{n=f;for(let m=0;m<u.marks.length;m++)r.allowsMarkType(u.marks[m].type)||e.step(new Wo(l,d,u.marks[m]));if(a&&u.isText&&r.whitespace!="pre"){let m,p=/\r?\n|\r/g,v;for(;m=p.exec(u.text);)v||(v=new vt(Ge.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),i.push(new Fa(l+m.index,l+m.index+m[0].length,v))}}l=d}if(!n.validEnd){let c=n.fillBefore(Ge.empty,!0);e.replace(l,l,new vt(c,0,0))}for(let c=i.length-1;c>=0;c--)e.step(i[c])}function Ize(e,t,r){return(t==0||e.canReplace(t,e.childCount))&&(r==e.childCount||e.canReplace(0,r))}function h0(e){let r=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,a=0,s=0;;--n){let i=e.$from.node(n),l=e.$from.index(n)+a,c=e.$to.indexAfter(n)-s;if(n<e.depth&&i.canReplace(l,c,r))return n;if(n==0||i.type.spec.isolating||!Ize(i,l,c))break;l&&(a=1),c<i.childCount&&(s=1)}return null}function Rze(e,t,r){let{$from:n,$to:a,depth:s}=t,i=n.before(s+1),l=a.after(s+1),c=i,u=l,d=Ge.empty,f=0;for(let v=s,b=!1;v>r;v--)b||n.index(v)>0?(b=!0,d=Ge.from(n.node(v).copy(d)),f++):c--;let m=Ge.empty,p=0;for(let v=s,b=!1;v>r;v--)b||a.after(v+1)<a.end(v)?(b=!0,m=Ge.from(a.node(v).copy(m)),p++):u++;e.step(new Ha(c,u,i,l,new vt(d.append(m),f,p),d.size-f,!0))}function c9(e,t,r=null,n=e){let a=Pze(e,t),s=a&&zze(n,t);return s?a.map(gQ).concat({type:t,attrs:r}).concat(s.map(gQ)):null}function gQ(e){return{type:e,attrs:null}}function Pze(e,t){let{parent:r,startIndex:n,endIndex:a}=e,s=r.contentMatchAt(n).findWrapping(t);if(!s)return null;let i=s.length?s[0]:t;return r.canReplaceWith(n,a,i)?s:null}function zze(e,t){let{parent:r,startIndex:n,endIndex:a}=e,s=r.child(n),i=t.contentMatch.findWrapping(s.type);if(!i)return null;let c=(i.length?i[i.length-1]:t).contentMatch;for(let u=n;c&&u<a;u++)c=c.matchType(r.child(u).type);return!c||!c.validEnd?null:i}function Bze(e,t,r){let n=Ge.empty;for(let i=r.length-1;i>=0;i--){if(n.size){let l=r[i].type.contentMatch.matchFragment(n);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Ge.from(r[i].type.create(r[i].attrs,n))}let a=t.start,s=t.end;e.step(new Ha(a,s,a,s,new vt(n,0,0),r.length,!0))}function $ze(e,t,r,n,a){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,r,(i,l)=>{let c=typeof a=="function"?a(i):a;if(i.isTextblock&&!i.hasMarkup(n,c)&&Fze(e.doc,e.mapping.slice(s).map(l),n)){let u=null;if(n.schema.linebreakReplacement){let p=n.whitespace=="pre",v=!!n.contentMatch.matchType(n.schema.linebreakReplacement);p&&!v?u=!1:!p&&v&&(u=!0)}u===!1&&nue(e,i,l,s),l9(e,e.mapping.slice(s).map(l,1),n,void 0,u===null);let d=e.mapping.slice(s),f=d.map(l,1),m=d.map(l+i.nodeSize,1);return e.step(new Ha(f,m,f+1,m-1,new vt(Ge.from(n.create(c,null,i.marks)),0,0),1,!0)),u===!0&&rue(e,i,l,s),!1}})}function rue(e,t,r,n){t.forEach((a,s)=>{if(a.isText){let i,l=/\r?\n|\r/g;for(;i=l.exec(a.text);){let c=e.mapping.slice(n).map(r+1+s+i.index);e.replaceWith(c,c+1,t.type.schema.linebreakReplacement.create())}}})}function nue(e,t,r,n){t.forEach((a,s)=>{if(a.type==a.type.schema.linebreakReplacement){let i=e.mapping.slice(n).map(r+1+s);e.replaceWith(i,i+1,t.type.schema.text(`
`))}})}function Fze(e,t,r){let n=e.resolve(t),a=n.index();return n.parent.canReplaceWith(a,a+1,r)}function Uze(e,t,r,n,a){let s=e.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");r||(r=s.type);let i=r.create(n,null,a||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,i);if(!r.validContent(s.content))throw new RangeError("Invalid content for node type "+r.name);e.step(new Ha(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new vt(Ge.from(i),0,0),1,!0))}function Xc(e,t,r=1,n){let a=e.resolve(t),s=a.depth-r,i=n&&n[n.length-1]||a.parent;if(s<0||a.parent.type.spec.isolating||!a.parent.canReplace(a.index(),a.parent.childCount)||!i.type.validContent(a.parent.content.cutByIndex(a.index(),a.parent.childCount)))return!1;for(let u=a.depth-1,d=r-2;u>s;u--,d--){let f=a.node(u),m=a.index(u);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(m,f.childCount),v=n&&n[d+1];v&&(p=p.replaceChild(0,v.type.create(v.attrs)));let b=n&&n[d]||f;if(!f.canReplace(m+1,f.childCount)||!b.type.validContent(p))return!1}let l=a.indexAfter(s),c=n&&n[0];return a.node(s).canReplaceWith(l,l,c?c.type:a.node(s+1).type)}function Hze(e,t,r=1,n){let a=e.doc.resolve(t),s=Ge.empty,i=Ge.empty;for(let l=a.depth,c=a.depth-r,u=r-1;l>c;l--,u--){s=Ge.from(a.node(l).copy(s));let d=n&&n[u];i=Ge.from(d?d.type.create(d.attrs,i):a.node(l).copy(i))}e.step(new Fa(t,t,new vt(s.append(i),r,r),!0))}function Wd(e,t){let r=e.resolve(t),n=r.index();return aue(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function qze(e,t){t.content.size||e.type.compatibleContent(t.type);let r=e.contentMatchAt(e.childCount),{linebreakReplacement:n}=e.type.schema;for(let a=0;a<t.childCount;a++){let s=t.child(a),i=s.type==n?e.type.schema.nodes.text:s.type;if(r=r.matchType(i),!r||!e.type.allowsMarks(s.marks))return!1}return r.validEnd}function aue(e,t){return!!(e&&t&&!e.isLeaf&&qze(e,t))}function Yj(e,t,r=-1){let n=e.resolve(t);for(let a=n.depth;;a--){let s,i,l=n.index(a);if(a==n.depth?(s=n.nodeBefore,i=n.nodeAfter):r>0?(s=n.node(a+1),l++,i=n.node(a).maybeChild(l)):(s=n.node(a).maybeChild(l-1),i=n.node(a+1)),s&&!s.isTextblock&&aue(s,i)&&n.node(a).canReplace(l,l+1))return t;if(a==0)break;t=r<0?n.before(a):n.after(a)}}function Wze(e,t,r){let n=null,{linebreakReplacement:a}=e.doc.type.schema,s=e.doc.resolve(t-r),i=s.node().type;if(a&&i.inlineContent){let d=i.whitespace=="pre",f=!!i.contentMatch.matchType(a);d&&!f?n=!1:!d&&f&&(n=!0)}let l=e.steps.length;if(n===!1){let d=e.doc.resolve(t+r);nue(e,d.node(),d.before(),l)}i.inlineContent&&l9(e,t+r-1,i,s.node().contentMatchAt(s.index()),n==null);let c=e.mapping.slice(l),u=c.map(t-r);if(e.step(new Fa(u,c.map(t+r,-1),vt.empty,!0)),n===!0){let d=e.doc.resolve(u);rue(e,d.node(),d.before(),e.steps.length)}return e}function Kze(e,t,r){let n=e.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),r))return t;if(n.parentOffset==0)for(let a=n.depth-1;a>=0;a--){let s=n.index(a);if(n.node(a).canReplaceWith(s,s,r))return n.before(a+1);if(s>0)return null}if(n.parentOffset==n.parent.content.size)for(let a=n.depth-1;a>=0;a--){let s=n.indexAfter(a);if(n.node(a).canReplaceWith(s,s,r))return n.after(a+1);if(s<n.node(a).childCount)return null}return null}function sue(e,t,r){let n=e.resolve(t);if(!r.content.size)return t;let a=r.content;for(let s=0;s<r.openStart;s++)a=a.firstChild.content;for(let s=1;s<=(r.openStart==0&&r.size?2:1);s++)for(let i=n.depth;i>=0;i--){let l=i==n.depth?0:n.pos<=(n.start(i+1)+n.end(i+1))/2?-1:1,c=n.index(i)+(l>0?1:0),u=n.node(i),d=!1;if(s==1)d=u.canReplace(c,c,a);else{let f=u.contentMatchAt(c).findWrapping(a.firstChild.type);d=f&&u.canReplaceWith(c,c,f[0])}if(d)return l==0?n.pos:l<0?n.before(i+1):n.after(i+1)}return null}function Qj(e,t,r=t,n=vt.empty){if(t==r&&!n.size)return null;let a=e.resolve(t),s=e.resolve(r);return iue(a,s,n)?new Fa(t,r,n):new Gze(a,s,n).fit()}function iue(e,t,r){return!r.openStart&&!r.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),r.content)}class Gze{constructor(t,r,n){this.$from=t,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Ge.empty;for(let a=0;a<=t.depth;a++){let s=t.node(a);this.frontier.push({type:s.type,match:s.contentMatchAt(t.indexAfter(a))})}for(let a=t.depth;a>0;a--)this.placed=Ge.from(t.node(a).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,a=this.close(t<0?this.$to:n.doc.resolve(t));if(!a)return null;let s=this.placed,i=n.depth,l=a.depth;for(;i&&l&&s.childCount==1;)s=s.firstChild.content,i--,l--;let c=new vt(s,i,l);return t>-1?new Ha(n.pos,t,this.$to.pos,this.$to.end(),c,r):c.size||n.pos!=this.$to.pos?new Fa(n.pos,a.pos,c):null}findFittable(){let t=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,a=this.unplaced.openEnd;n<t;n++){let s=r.firstChild;if(r.childCount>1&&(a=0),s.type.spec.isolating&&a<=n){t=n;break}r=s.content}for(let r=1;r<=2;r++)for(let n=r==1?t:this.unplaced.openStart;n>=0;n--){let a,s=null;n?(s=DD(this.unplaced.content,n-1).firstChild,a=s.content):a=this.unplaced.content;let i=a.firstChild;for(let l=this.depth;l>=0;l--){let{type:c,match:u}=this.frontier[l],d,f=null;if(r==1&&(i?u.matchType(i.type)||(f=u.fillBefore(Ge.from(i),!1)):s&&c.compatibleContent(s.type)))return{sliceDepth:n,frontierDepth:l,parent:s,inject:f};if(r==2&&i&&(d=u.findWrapping(i.type)))return{sliceDepth:n,frontierDepth:l,parent:s,wrap:d};if(s&&u.matchType(s.type))break}}}openMore(){let{content:t,openStart:r,openEnd:n}=this.unplaced,a=DD(t,r);return!a.childCount||a.firstChild.isLeaf?!1:(this.unplaced=new vt(t,r+1,Math.max(n,a.size+r>=t.size-n?r+1:0)),!0)}dropNode(){let{content:t,openStart:r,openEnd:n}=this.unplaced,a=DD(t,r);if(a.childCount<=1&&r>0){let s=t.size-r<=r+a.size;this.unplaced=new vt(fb(t,r-1,1),r-1,s?r-1:n)}else this.unplaced=new vt(fb(t,r,1),r,n)}placeNodes({sliceDepth:t,frontierDepth:r,parent:n,inject:a,wrap:s}){for(;this.depth>r;)this.closeFrontierNode();if(s)for(let b=0;b<s.length;b++)this.openFrontierNode(s[b]);let i=this.unplaced,l=n?n.content:i.content,c=i.openStart-t,u=0,d=[],{match:f,type:m}=this.frontier[r];if(a){for(let b=0;b<a.childCount;b++)d.push(a.child(b));f=f.matchFragment(a)}let p=l.size+t-(i.content.size-i.openEnd);for(;u<l.childCount;){let b=l.child(u),y=f.matchType(b.type);if(!y)break;u++,(u>1||c==0||b.content.size)&&(f=y,d.push(oue(b.mark(m.allowedMarks(b.marks)),u==1?c:0,u==l.childCount?p:-1)))}let v=u==l.childCount;v||(p=-1),this.placed=hb(this.placed,r,Ge.from(d)),this.frontier[r].match=f,v&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let b=0,y=l;b<p;b++){let S=y.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),y=S.content}this.unplaced=v?t==0?vt.empty:new vt(fb(i.content,t-1,1),t-1,p<0?i.openEnd:t-1):new vt(fb(i.content,t,u),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],r;if(!t.type.isTextblock||!LD(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,a=this.$to.after(n);for(;n>1&&a==this.$to.end(--n);)++a;return a}findCloseLevel(t){e:for(let r=Math.min(this.depth,t.depth);r>=0;r--){let{match:n,type:a}=this.frontier[r],s=r<t.depth&&t.end(r+1)==t.pos+(t.depth-(r+1)),i=LD(t,r,a,n,s);if(i){for(let l=r-1;l>=0;l--){let{match:c,type:u}=this.frontier[l],d=LD(t,l,u,c,!0);if(!d||d.childCount)continue e}return{depth:r,fit:i,move:s?t.doc.resolve(t.after(r+1)):t}}}}close(t){let r=this.findCloseLevel(t);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=hb(this.placed,r.depth,r.fit)),t=r.move;for(let n=r.depth+1;n<=t.depth;n++){let a=t.node(n),s=a.type.contentMatch.fillBefore(a.content,!0,t.index(n));this.openFrontierNode(a.type,a.attrs,s)}return t}openFrontierNode(t,r=null,n){let a=this.frontier[this.depth];a.match=a.match.matchType(t),this.placed=hb(this.placed,this.depth,Ge.from(t.create(r,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Ge.empty,!0);r.childCount&&(this.placed=hb(this.placed,this.frontier.length,r))}}function fb(e,t,r){return t==0?e.cutByIndex(r,e.childCount):e.replaceChild(0,e.firstChild.copy(fb(e.firstChild.content,t-1,r)))}function hb(e,t,r){return t==0?e.append(r):e.replaceChild(e.childCount-1,e.lastChild.copy(hb(e.lastChild.content,t-1,r)))}function DD(e,t){for(let r=0;r<t;r++)e=e.firstChild.content;return e}function oue(e,t,r){if(t<=0)return e;let n=e.content;return t>1&&(n=n.replaceChild(0,oue(n.firstChild,t-1,n.childCount==1?r-1:0))),t>0&&(n=e.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(e.type.contentMatch.matchFragment(n).fillBefore(Ge.empty,!0)))),e.copy(n)}function LD(e,t,r,n,a){let s=e.node(t),i=a?e.indexAfter(t):e.index(t);if(i==s.childCount&&!r.compatibleContent(s.type))return null;let l=n.fillBefore(s.content,!0,i);return l&&!Vze(r,s.content,i)?l:null}function Vze(e,t,r){for(let n=r;n<t.childCount;n++)if(!e.allowsMarks(t.child(n).marks))return!0;return!1}function Yze(e){return e.spec.defining||e.spec.definingForContent}function Qze(e,t,r,n){if(!n.size)return e.deleteRange(t,r);let a=e.doc.resolve(t),s=e.doc.resolve(r);if(iue(a,s,n))return e.step(new Fa(t,r,n));let i=cue(a,s);i[i.length-1]==0&&i.pop();let l=-(a.depth+1);i.unshift(l);for(let m=a.depth,p=a.pos-1;m>0;m--,p--){let v=a.node(m).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;i.indexOf(m)>-1?l=m:a.before(m)==p&&i.splice(1,0,-m)}let c=i.indexOf(l),u=[],d=n.openStart;for(let m=n.content,p=0;;p++){let v=m.firstChild;if(u.push(v),p==n.openStart)break;m=v.content}for(let m=d-1;m>=0;m--){let p=u[m],v=Yze(p.type);if(v&&!p.sameMarkup(a.node(Math.abs(l)-1)))d=m;else if(v||!p.type.isTextblock)break}for(let m=n.openStart;m>=0;m--){let p=(m+d+1)%(n.openStart+1),v=u[p];if(v)for(let b=0;b<i.length;b++){let y=i[(b+c)%i.length],S=!0;y<0&&(S=!1,y=-y);let _=a.node(y-1),N=a.index(y-1);if(_.canReplaceWith(N,N,v.type,v.marks))return e.replace(a.before(y),S?s.after(y):r,new vt(lue(n.content,0,n.openStart,p),p,n.openEnd))}}let f=e.steps.length;for(let m=i.length-1;m>=0&&(e.replace(t,r,n),!(e.steps.length>f));m--){let p=i[m];p<0||(t=a.before(p),r=s.after(p))}}function lue(e,t,r,n,a){if(t<r){let s=e.firstChild;e=e.replaceChild(0,s.copy(lue(s.content,t+1,r,n,s)))}if(t>n){let s=a.contentMatchAt(0),i=s.fillBefore(e).append(e);e=i.append(s.matchFragment(i).fillBefore(Ge.empty,!0))}return e}function Jze(e,t,r,n){if(!n.isInline&&t==r&&e.doc.resolve(t).parent.content.size){let a=Kze(e.doc,t,n.type);a!=null&&(t=r=a)}e.replaceRange(t,r,new vt(Ge.from(n),0,0))}function Zze(e,t,r){let n=e.doc.resolve(t),a=e.doc.resolve(r),s=cue(n,a);for(let i=0;i<s.length;i++){let l=s[i],c=i==s.length-1;if(c&&l==0||n.node(l).type.contentMatch.validEnd)return e.delete(n.start(l),a.end(l));if(l>0&&(c||n.node(l-1).canReplace(n.index(l-1),a.indexAfter(l-1))))return e.delete(n.before(l),a.after(l))}for(let i=1;i<=n.depth&&i<=a.depth;i++)if(t-n.start(i)==n.depth-i&&r>n.end(i)&&a.end(i)-r!=a.depth-i&&n.start(i-1)==a.start(i-1)&&n.node(i-1).canReplace(n.index(i-1),a.index(i-1)))return e.delete(n.before(i),r);e.delete(t,r)}function cue(e,t){let r=[],n=Math.min(e.depth,t.depth);for(let a=n;a>=0;a--){let s=e.start(a);if(s<e.pos-(e.depth-a)||t.end(a)>t.pos+(t.depth-a)||e.node(a).type.spec.isolating||t.node(a).type.spec.isolating)break;(s==t.start(a)||a==e.depth&&a==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&a&&t.start(a-1)==s-1)&&r.push(a)}return r}class Bp extends Ss{constructor(t,r,n){super(),this.pos=t,this.attr=r,this.value=n}apply(t){let r=t.nodeAt(this.pos);if(!r)return pa.fail("No node at attribute step's position");let n=Object.create(null);for(let s in r.attrs)n[s]=r.attrs[s];n[this.attr]=this.value;let a=r.type.create(n,null,r.marks);return pa.fromReplace(t,this.pos,this.pos+1,new vt(Ge.from(a),0,r.isLeaf?0:1))}getMap(){return Mi.empty}invert(t){return new Bp(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let r=t.mapResult(this.pos,1);return r.deletedAfter?null:new Bp(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Bp(r.pos,r.attr,r.value)}}Ss.jsonID("attr",Bp);class Vy extends Ss{constructor(t,r){super(),this.attr=t,this.value=r}apply(t){let r=Object.create(null);for(let a in t.attrs)r[a]=t.attrs[a];r[this.attr]=this.value;let n=t.type.create(r,t.content,t.marks);return pa.ok(n)}getMap(){return Mi.empty}invert(t){return new Vy(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Vy(r.attr,r.value)}}Ss.jsonID("docAttr",Vy);let Sg=class extends Error{};Sg=function e(t){let r=Error.call(this,t);return r.__proto__=e.prototype,r};Sg.prototype=Object.create(Error.prototype);Sg.prototype.constructor=Sg;Sg.prototype.name="TransformError";let uue=class{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Gy}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let r=this.maybeStep(t);if(r.failed)throw new Sg(r.failed);return this}maybeStep(t){let r=t.apply(this.doc);return r.failed||this.addStep(t,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let t=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let a=this.mapping.maps[n];n&&(t=a.map(t,1),r=a.map(r,-1)),a.forEach((s,i,l,c)=>{t=Math.min(t,l),r=Math.max(r,c)})}return t==1e9?null:{from:t,to:r}}addStep(t,r){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=r}replace(t,r=t,n=vt.empty){let a=Qj(this.doc,t,r,n);return a&&this.step(a),this}replaceWith(t,r,n){return this.replace(t,r,new vt(Ge.from(n),0,0))}delete(t,r){return this.replace(t,r,vt.empty)}insert(t,r){return this.replaceWith(t,t,r)}replaceRange(t,r,n){return Qze(this,t,r,n),this}replaceRangeWith(t,r,n){return Jze(this,t,r,n),this}deleteRange(t,r){return Zze(this,t,r),this}lift(t,r){return Rze(this,t,r),this}join(t,r=1){return Wze(this,t,r),this}wrap(t,r){return Bze(this,t,r),this}setBlockType(t,r=t,n,a=null){return $ze(this,t,r,n,a),this}setNodeMarkup(t,r,n=null,a){return Uze(this,t,r,n,a),this}setNodeAttribute(t,r,n){return this.step(new Bp(t,r,n)),this}setDocAttribute(t,r){return this.step(new Vy(t,r)),this}addNodeMark(t,r){return this.step(new yd(t,r)),this}removeNodeMark(t,r){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(r instanceof hn)r.isInSet(n.marks)&&this.step(new Ch(t,r));else{let a=n.marks,s,i=[];for(;s=r.isInSet(a);)i.push(new Ch(t,s)),a=s.removeFromSet(a);for(let l=i.length-1;l>=0;l--)this.step(i[l])}return this}split(t,r=1,n){return Hze(this,t,r,n),this}addMark(t,r,n){return Lze(this,t,r,n),this}removeMark(t,r,n){return Oze(this,t,r,n),this}clearIncompatible(t,r,n){return l9(this,t,r,n),this}};const OD=Object.create(null);let cr=class{constructor(t,r,n){this.$anchor=t,this.$head=r,this.ranges=n||[new Xze(t.min(r),t.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let r=0;r<t.length;r++)if(t[r].$from.pos!=t[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,r=vt.empty){let n=r.content.lastChild,a=null;for(let l=0;l<r.openEnd;l++)a=n,n=n.lastChild;let s=t.steps.length,i=this.ranges;for(let l=0;l<i.length;l++){let{$from:c,$to:u}=i[l],d=t.mapping.slice(s);t.replaceRange(d.map(c.pos),d.map(u.pos),l?vt.empty:r),l==0&&yQ(t,s,(n?n.isInline:a&&a.isTextblock)?-1:1)}}replaceWith(t,r){let n=t.steps.length,a=this.ranges;for(let s=0;s<a.length;s++){let{$from:i,$to:l}=a[s],c=t.mapping.slice(n),u=c.map(i.pos),d=c.map(l.pos);s?t.deleteRange(u,d):(t.replaceRangeWith(u,d,r),yQ(t,n,r.isInline?-1:1))}}static findFrom(t,r,n=!1){let a=t.parent.inlineContent?new Jt(t):gp(t.node(0),t.parent,t.pos,t.index(),r,n);if(a)return a;for(let s=t.depth-1;s>=0;s--){let i=r<0?gp(t.node(0),t.node(s),t.before(s+1),t.index(s),r,n):gp(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,r,n);if(i)return i}return null}static near(t,r=1){return this.findFrom(t,r)||this.findFrom(t,-r)||new Oi(t.node(0))}static atStart(t){return gp(t,t,0,0,1)||new Oi(t)}static atEnd(t){return gp(t,t,t.content.size,t.childCount,-1)||new Oi(t)}static fromJSON(t,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=OD[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(t,r)}static jsonID(t,r){if(t in OD)throw new RangeError("Duplicate use of selection JSON ID "+t);return OD[t]=r,r.prototype.jsonID=t,r}getBookmark(){return Jt.between(this.$anchor,this.$head).getBookmark()}};cr.prototype.visible=!0;let Xze=class{constructor(t,r){this.$from=t,this.$to=r}},vQ=!1;function bQ(e){!vQ&&!e.parent.inlineContent&&(vQ=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Jt extends cr{constructor(t,r=t){bQ(t),bQ(r),super(t,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,r){let n=t.resolve(r.map(this.head));if(!n.parent.inlineContent)return cr.near(n);let a=t.resolve(r.map(this.anchor));return new Jt(a.parent.inlineContent?a:n,n)}replace(t,r=vt.empty){if(super.replace(t,r),r==vt.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof Jt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Jj(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Jt(t.resolve(r.anchor),t.resolve(r.head))}static create(t,r,n=r){let a=t.resolve(r);return new this(a,n==r?a:t.resolve(n))}static between(t,r,n){let a=t.pos-r.pos;if((!n||a)&&(n=a>=0?1:-1),!r.parent.inlineContent){let s=cr.findFrom(r,n,!0)||cr.findFrom(r,-n,!0);if(s)r=s.$head;else return cr.near(r,n)}return t.parent.inlineContent||(a==0?t=r:(t=(cr.findFrom(t,-n,!0)||cr.findFrom(t,n,!0)).$anchor,t.pos<r.pos!=a<0&&(t=r))),new Jt(t,r)}}cr.jsonID("text",Jt);class Jj{constructor(t,r){this.anchor=t,this.head=r}map(t){return new Jj(t.map(this.anchor),t.map(this.head))}resolve(t){return Jt.between(t.resolve(this.anchor),t.resolve(this.head))}}class Ft extends cr{constructor(t){let r=t.nodeAfter,n=t.node(0).resolve(t.pos+r.nodeSize);super(t,n),this.node=r}map(t,r){let{deleted:n,pos:a}=r.mapResult(this.anchor),s=t.resolve(a);return n?cr.near(s):new Ft(s)}content(){return new vt(Ge.from(this.node),0,0)}eq(t){return t instanceof Ft&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new u9(this.anchor)}static fromJSON(t,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ft(t.resolve(r.anchor))}static create(t,r){return new Ft(t.resolve(r))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}Ft.prototype.visible=!1;cr.jsonID("node",Ft);class u9{constructor(t){this.anchor=t}map(t){let{deleted:r,pos:n}=t.mapResult(this.anchor);return r?new Jj(n,n):new u9(n)}resolve(t){let r=t.resolve(this.anchor),n=r.nodeAfter;return n&&Ft.isSelectable(n)?new Ft(r):cr.near(r)}}class Oi extends cr{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,r=vt.empty){if(r==vt.empty){t.delete(0,t.doc.content.size);let n=cr.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,r)}toJSON(){return{type:"all"}}static fromJSON(t){return new Oi(t)}map(t){return new Oi(t)}eq(t){return t instanceof Oi}getBookmark(){return e9e}}cr.jsonID("all",Oi);const e9e={map(){return this},resolve(e){return new Oi(e)}};function gp(e,t,r,n,a,s=!1){if(t.inlineContent)return Jt.create(e,r);for(let i=n-(a>0?0:1);a>0?i<t.childCount:i>=0;i+=a){let l=t.child(i);if(l.isAtom){if(!s&&Ft.isSelectable(l))return Ft.create(e,r-(a<0?l.nodeSize:0))}else{let c=gp(e,l,r+a,a<0?l.childCount:0,a,s);if(c)return c}r+=l.nodeSize*a}return null}function yQ(e,t,r){let n=e.steps.length-1;if(n<t)return;let a=e.steps[n];if(!(a instanceof Fa||a instanceof Ha))return;let s=e.mapping.maps[n],i;s.forEach((l,c,u,d)=>{i==null&&(i=d)}),e.setSelection(cr.near(e.doc.resolve(i),r))}const xQ=1,fS=2,wQ=4;class t9e extends uue{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|xQ)&~fS,this.storedMarks=null,this}get selectionSet(){return(this.updated&xQ)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=fS,this}ensureMarks(t){return hn.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&fS)>0}addStep(t,r){super.addStep(t,r),this.updated=this.updated&~fS,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,r=!0){let n=this.selection;return r&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||hn.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,r,n){let a=this.doc.type.schema;if(r==null)return t?this.replaceSelectionWith(a.text(t),!0):this.deleteSelection();{if(n==null&&(n=r),!t)return this.deleteRange(r,n);let s=this.storedMarks;if(!s){let i=this.doc.resolve(r);s=n==r?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,a.text(t,s)),!this.selection.empty&&this.selection.to==r+t.length&&this.setSelection(cr.near(this.selection.$to)),this}}setMeta(t,r){return this.meta[typeof t=="string"?t:t.key]=r,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=wQ,this}get scrolledIntoView(){return(this.updated&wQ)>0}}function SQ(e,t){return!t||!e?e:e.bind(t)}class mb{constructor(t,r,n){this.name=t,this.init=SQ(r.init,n),this.apply=SQ(r.apply,n)}}const r9e=[new mb("doc",{init(e){return e.doc||e.schema.topNodeType.createAndFill()},apply(e){return e.doc}}),new mb("selection",{init(e,t){return e.selection||cr.atStart(t.doc)},apply(e){return e.selection}}),new mb("storedMarks",{init(e){return e.storedMarks||null},apply(e,t,r,n){return n.selection.$cursor?e.storedMarks:null}}),new mb("scrollToSelection",{init(){return 0},apply(e,t){return e.scrolledIntoView?t+1:t}})];class ID{constructor(t,r){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=r9e.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new mb(n.key,n.spec.state,n))})}}class Mp{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let a=this.config.plugins[n];if(a.spec.filterTransaction&&!a.spec.filterTransaction.call(a,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let r=[t],n=this.applyInner(t),a=null;for(;;){let s=!1;for(let i=0;i<this.config.plugins.length;i++){let l=this.config.plugins[i];if(l.spec.appendTransaction){let c=a?a[i].n:0,u=a?a[i].state:this,d=c<r.length&&l.spec.appendTransaction.call(l,c?r.slice(c):r,u,n);if(d&&n.filterTransaction(d,i)){if(d.setMeta("appendedTransaction",t),!a){a=[];for(let f=0;f<this.config.plugins.length;f++)a.push(f<i?{state:n,n:r.length}:{state:this,n:0})}r.push(d),n=n.applyInner(d),s=!0}a&&(a[i]={state:n,n:r.length})}}if(!s)return{state:n,transactions:r}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new Mp(this.config),n=this.config.fields;for(let a=0;a<n.length;a++){let s=n[a];r[s.name]=s.apply(t,this[s.name],this,r)}return r}get tr(){return new t9e(this)}static create(t){let r=new ID(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new Mp(r);for(let a=0;a<r.fields.length;a++)n[r.fields[a].name]=r.fields[a].init(t,n);return n}reconfigure(t){let r=new ID(this.schema,t.plugins),n=r.fields,a=new Mp(r);for(let s=0;s<n.length;s++){let i=n[s].name;a[i]=this.hasOwnProperty(i)?this[i]:n[s].init(t,a)}return a}toJSON(t){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&typeof t=="object")for(let n in t){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let a=t[n],s=a.spec.state;s&&s.toJSON&&(r[n]=s.toJSON.call(a,this[a.key]))}return r}static fromJSON(t,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let a=new ID(t.schema,t.plugins),s=new Mp(a);return a.fields.forEach(i=>{if(i.name=="doc")s.doc=Cd.fromJSON(t.schema,r.doc);else if(i.name=="selection")s.selection=cr.fromJSON(s.doc,r.selection);else if(i.name=="storedMarks")r.storedMarks&&(s.storedMarks=r.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let l in n){let c=n[l],u=c.spec.state;if(c.key==i.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(r,l)){s[i.name]=u.fromJSON.call(c,t,r[l],s);return}}s[i.name]=i.init(t,s)}}),s}}function due(e,t,r){for(let n in e){let a=e[n];a instanceof Function?a=a.bind(t):n=="handleDOMEvents"&&(a=due(a,t,{})),r[n]=a}return r}class Hr{constructor(t){this.spec=t,this.props={},t.props&&due(t.props,this,this.props),this.key=t.key?t.key.key:fue("plugin")}getState(t){return t[this.key]}}const RD=Object.create(null);function fue(e){return e in RD?e+"$"+ ++RD[e]:(RD[e]=0,e+"$")}class Qr{constructor(t="key"){this.key=fue(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const d9=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function hue(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("backward",e):r.parentOffset>0)?null:r}const mue=(e,t,r)=>{let n=hue(e,r);if(!n)return!1;let a=f9(n);if(!a){let i=n.blockRange(),l=i&&h0(i);return l==null?!1:(t&&t(e.tr.lift(i,l).scrollIntoView()),!0)}let s=a.nodeBefore;if(kue(e,a,t,-1))return!0;if(n.parent.content.size==0&&(kg(s,"end")||Ft.isSelectable(s)))for(let i=n.depth;;i--){let l=Qj(e.doc,n.before(i),n.after(i),vt.empty);if(l&&l.slice.size<l.to-l.from){if(t){let c=e.tr.step(l);c.setSelection(kg(s,"end")?cr.findFrom(c.doc.resolve(c.mapping.map(a.pos,-1)),-1):Ft.create(c.doc,a.pos-s.nodeSize)),t(c.scrollIntoView())}return!0}if(i==1||n.node(i-1).childCount>1)break}return s.isAtom&&a.depth==n.depth-1?(t&&t(e.tr.delete(a.pos-s.nodeSize,a.pos).scrollIntoView()),!0):!1},n9e=(e,t,r)=>{let n=hue(e,r);if(!n)return!1;let a=f9(n);return a?pue(e,a,t):!1},a9e=(e,t,r)=>{let n=vue(e,r);if(!n)return!1;let a=h9(n);return a?pue(e,a,t):!1};function pue(e,t,r){let n=t.nodeBefore,a=n,s=t.pos-1;for(;!a.isTextblock;s--){if(a.type.spec.isolating)return!1;let d=a.lastChild;if(!d)return!1;a=d}let i=t.nodeAfter,l=i,c=t.pos+1;for(;!l.isTextblock;c++){if(l.type.spec.isolating)return!1;let d=l.firstChild;if(!d)return!1;l=d}let u=Qj(e.doc,s,c,vt.empty);if(!u||u.from!=s||u instanceof Fa&&u.slice.size>=c-s)return!1;if(r){let d=e.tr.step(u);d.setSelection(Jt.create(d.doc,s)),r(d.scrollIntoView())}return!0}function kg(e,t,r=!1){for(let n=e;n;n=t=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const gue=(e,t,r)=>{let{$head:n,empty:a}=e.selection,s=n;if(!a)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",e):n.parentOffset>0)return!1;s=f9(n)}let i=s&&s.nodeBefore;return!i||!Ft.isSelectable(i)?!1:(t&&t(e.tr.setSelection(Ft.create(e.doc,s.pos-i.nodeSize)).scrollIntoView()),!0)};function f9(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function vue(e,t){let{$cursor:r}=e.selection;return!r||(t?!t.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)?null:r}const bue=(e,t,r)=>{let n=vue(e,r);if(!n)return!1;let a=h9(n);if(!a)return!1;let s=a.nodeAfter;if(kue(e,a,t,1))return!0;if(n.parent.content.size==0&&(kg(s,"start")||Ft.isSelectable(s))){let i=Qj(e.doc,n.before(),n.after(),vt.empty);if(i&&i.slice.size<i.to-i.from){if(t){let l=e.tr.step(i);l.setSelection(kg(s,"start")?cr.findFrom(l.doc.resolve(l.mapping.map(a.pos)),1):Ft.create(l.doc,l.mapping.map(a.pos))),t(l.scrollIntoView())}return!0}}return s.isAtom&&a.depth==n.depth-1?(t&&t(e.tr.delete(a.pos,a.pos+s.nodeSize).scrollIntoView()),!0):!1},yue=(e,t,r)=>{let{$head:n,empty:a}=e.selection,s=n;if(!a)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)return!1;s=h9(n)}let i=s&&s.nodeAfter;return!i||!Ft.isSelectable(i)?!1:(t&&t(e.tr.setSelection(Ft.create(e.doc,s.pos)).scrollIntoView()),!0)};function h9(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let r=e.node(t);if(e.index(t)+1<r.childCount)return e.doc.resolve(e.after(t+1));if(r.type.spec.isolating)break}return null}const s9e=(e,t)=>{let r=e.selection,n=r instanceof Ft,a;if(n){if(r.node.isTextblock||!Wd(e.doc,r.from))return!1;a=r.from}else if(a=Yj(e.doc,r.from,-1),a==null)return!1;if(t){let s=e.tr.join(a);n&&s.setSelection(Ft.create(s.doc,a-e.doc.resolve(a).nodeBefore.nodeSize)),t(s.scrollIntoView())}return!0},i9e=(e,t)=>{let r=e.selection,n;if(r instanceof Ft){if(r.node.isTextblock||!Wd(e.doc,r.to))return!1;n=r.to}else if(n=Yj(e.doc,r.to,1),n==null)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0},o9e=(e,t)=>{let{$from:r,$to:n}=e.selection,a=r.blockRange(n),s=a&&h0(a);return s==null?!1:(t&&t(e.tr.lift(a,s).scrollIntoView()),!0)},xue=(e,t)=>{let{$head:r,$anchor:n}=e.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function m9(e){for(let t=0;t<e.edgeCount;t++){let{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const l9e=(e,t)=>{let{$head:r,$anchor:n}=e.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let a=r.node(-1),s=r.indexAfter(-1),i=m9(a.contentMatchAt(s));if(!i||!a.canReplaceWith(s,s,i))return!1;if(t){let l=r.after(),c=e.tr.replaceWith(l,l,i.createAndFill());c.setSelection(cr.near(c.doc.resolve(l),1)),t(c.scrollIntoView())}return!0},wue=(e,t)=>{let r=e.selection,{$from:n,$to:a}=r;if(r instanceof Oi||n.parent.inlineContent||a.parent.inlineContent)return!1;let s=m9(a.parent.contentMatchAt(a.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let i=(!n.parentOffset&&a.index()<a.parent.childCount?n:a).pos,l=e.tr.insert(i,s.createAndFill());l.setSelection(Jt.create(l.doc,i+1)),t(l.scrollIntoView())}return!0},Sue=(e,t)=>{let{$cursor:r}=e.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let s=r.before();if(Xc(e.doc,s))return t&&t(e.tr.split(s).scrollIntoView()),!0}let n=r.blockRange(),a=n&&h0(n);return a==null?!1:(t&&t(e.tr.lift(n,a).scrollIntoView()),!0)};function c9e(e){return(t,r)=>{let{$from:n,$to:a}=t.selection;if(t.selection instanceof Ft&&t.selection.node.isBlock)return!n.parentOffset||!Xc(t.doc,n.pos)?!1:(r&&r(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let s=[],i,l,c=!1,u=!1;for(let p=n.depth;;p--)if(n.node(p).isBlock){c=n.end(p)==n.pos+(n.depth-p),u=n.start(p)==n.pos-(n.depth-p),l=m9(n.node(p-1).contentMatchAt(n.indexAfter(p-1))),s.unshift(c&&l?{type:l}:null),i=p;break}else{if(p==1)return!1;s.unshift(null)}let d=t.tr;(t.selection instanceof Jt||t.selection instanceof Oi)&&d.deleteSelection();let f=d.mapping.map(n.pos),m=Xc(d.doc,f,s.length,s);if(m||(s[0]=l?{type:l}:null,m=Xc(d.doc,f,s.length,s)),!m)return!1;if(d.split(f,s.length,s),!c&&u&&n.node(i).type!=l){let p=d.mapping.map(n.before(i)),v=d.doc.resolve(p);l&&n.node(i-1).canReplaceWith(v.index(),v.index()+1,l)&&d.setNodeMarkup(d.mapping.map(n.before(i)),l)}return r&&r(d.scrollIntoView()),!0}}const u9e=c9e(),d9e=(e,t)=>{let{$from:r,to:n}=e.selection,a,s=r.sharedDepth(n);return s==0?!1:(a=r.before(s),t&&t(e.tr.setSelection(Ft.create(e.doc,a))),!0)};function f9e(e,t,r){let n=t.nodeBefore,a=t.nodeAfter,s=t.index();return!n||!a||!n.type.compatibleContent(a.type)?!1:!n.content.size&&t.parent.canReplace(s-1,s)?(r&&r(e.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(s,s+1)||!(a.isTextblock||Wd(e.doc,t.pos))?!1:(r&&r(e.tr.join(t.pos).scrollIntoView()),!0)}function kue(e,t,r,n){let a=t.nodeBefore,s=t.nodeAfter,i,l,c=a.type.spec.isolating||s.type.spec.isolating;if(!c&&f9e(e,t,r))return!0;let u=!c&&t.parent.canReplace(t.index(),t.index()+1);if(u&&(i=(l=a.contentMatchAt(a.childCount)).findWrapping(s.type))&&l.matchType(i[0]||s.type).validEnd){if(r){let p=t.pos+s.nodeSize,v=Ge.empty;for(let S=i.length-1;S>=0;S--)v=Ge.from(i[S].create(null,v));v=Ge.from(a.copy(v));let b=e.tr.step(new Ha(t.pos-1,p,t.pos,p,new vt(v,1,0),i.length,!0)),y=b.doc.resolve(p+2*i.length);y.nodeAfter&&y.nodeAfter.type==a.type&&Wd(b.doc,y.pos)&&b.join(y.pos),r(b.scrollIntoView())}return!0}let d=s.type.spec.isolating||n>0&&c?null:cr.findFrom(t,1),f=d&&d.$from.blockRange(d.$to),m=f&&h0(f);if(m!=null&&m>=t.depth)return r&&r(e.tr.lift(f,m).scrollIntoView()),!0;if(u&&kg(s,"start",!0)&&kg(a,"end")){let p=a,v=[];for(;v.push(p),!p.isTextblock;)p=p.lastChild;let b=s,y=1;for(;!b.isTextblock;b=b.firstChild)y++;if(p.canReplace(p.childCount,p.childCount,b.content)){if(r){let S=Ge.empty;for(let N=v.length-1;N>=0;N--)S=Ge.from(v[N].copy(S));let _=e.tr.step(new Ha(t.pos-v.length,t.pos+s.nodeSize,t.pos+y,t.pos+s.nodeSize-y,new vt(S,v.length,0),0,!0));r(_.scrollIntoView())}return!0}}return!1}function _ue(e){return function(t,r){let n=t.selection,a=e<0?n.$from:n.$to,s=a.depth;for(;a.node(s).isInline;){if(!s)return!1;s--}return a.node(s).isTextblock?(r&&r(t.tr.setSelection(Jt.create(t.doc,e<0?a.start(s):a.end(s)))),!0):!1}}const h9e=_ue(-1),m9e=_ue(1);function p9e(e,t=null){return function(r,n){let{$from:a,$to:s}=r.selection,i=a.blockRange(s),l=i&&c9(i,e,t);return l?(n&&n(r.tr.wrap(i,l).scrollIntoView()),!0):!1}}function kQ(e,t=null){return function(r,n){let a=!1;for(let s=0;s<r.selection.ranges.length&&!a;s++){let{$from:{pos:i},$to:{pos:l}}=r.selection.ranges[s];r.doc.nodesBetween(i,l,(c,u)=>{if(a)return!1;if(!(!c.isTextblock||c.hasMarkup(e,t)))if(c.type==e)a=!0;else{let d=r.doc.resolve(u),f=d.index();a=d.parent.canReplaceWith(f,f+1,e)}})}if(!a)return!1;if(n){let s=r.tr;for(let i=0;i<r.selection.ranges.length;i++){let{$from:{pos:l},$to:{pos:c}}=r.selection.ranges[i];s.setBlockType(l,c,e,t)}n(s.scrollIntoView())}return!0}}function p9(...e){return function(t,r,n){for(let a=0;a<e.length;a++)if(e[a](t,r,n))return!0;return!1}}p9(d9,mue,gue);p9(d9,bue,yue);p9(xue,wue,Sue,u9e);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function g9e(e,t=null){return function(r,n){let{$from:a,$to:s}=r.selection,i=a.blockRange(s);if(!i)return!1;let l=n?r.tr:null;return v9e(l,i,e,t)?(n&&n(l.scrollIntoView()),!0):!1}}function v9e(e,t,r,n=null){let a=!1,s=t,i=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(r)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let c=i.resolve(t.start-2);s=new uN(c,c,t.depth),t.endIndex<t.parent.childCount&&(t=new uN(t.$from,i.resolve(t.$to.end(t.depth)),t.depth)),a=!0}let l=c9(s,r,n,t);return l?(e&&b9e(e,t,l,a,r),!0):!1}function b9e(e,t,r,n,a){let s=Ge.empty;for(let d=r.length-1;d>=0;d--)s=Ge.from(r[d].type.create(r[d].attrs,s));e.step(new Ha(t.start-(n?2:0),t.end,t.start,t.end,new vt(s,0,0),r.length,!0));let i=0;for(let d=0;d<r.length;d++)r[d].type==a&&(i=d+1);let l=r.length-i,c=t.start+r.length-(n?2:0),u=t.parent;for(let d=t.startIndex,f=t.endIndex,m=!0;d<f;d++,m=!1)!m&&Xc(e.doc,c,l)&&(e.split(c,l),c+=2*l),c+=u.child(d).nodeSize;return e}function y9e(e){return function(t,r){let{$from:n,$to:a}=t.selection,s=n.blockRange(a,i=>i.childCount>0&&i.firstChild.type==e);return s?r?n.node(s.depth-1).type==e?x9e(t,r,e,s):w9e(t,r,s):!0:!1}}function x9e(e,t,r,n){let a=e.tr,s=n.end,i=n.$to.end(n.depth);s<i&&(a.step(new Ha(s-1,i,s,i,new vt(Ge.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new uN(a.doc.resolve(n.$from.pos),a.doc.resolve(i),n.depth));const l=h0(n);if(l==null)return!1;a.lift(n,l);let c=a.doc.resolve(a.mapping.map(s,-1)-1);return Wd(a.doc,c.pos)&&c.nodeBefore.type==c.nodeAfter.type&&a.join(c.pos),t(a.scrollIntoView()),!0}function w9e(e,t,r){let n=e.tr,a=r.parent;for(let p=r.end,v=r.endIndex-1,b=r.startIndex;v>b;v--)p-=a.child(v).nodeSize,n.delete(p-1,p+1);let s=n.doc.resolve(r.start),i=s.nodeAfter;if(n.mapping.map(r.end)!=r.start+s.nodeAfter.nodeSize)return!1;let l=r.startIndex==0,c=r.endIndex==a.childCount,u=s.node(-1),d=s.index(-1);if(!u.canReplace(d+(l?0:1),d+1,i.content.append(c?Ge.empty:Ge.from(a))))return!1;let f=s.pos,m=f+i.nodeSize;return n.step(new Ha(f-(l?1:0),m+(c?1:0),f+1,m-1,new vt((l?Ge.empty:Ge.from(a.copy(Ge.empty))).append(c?Ge.empty:Ge.from(a.copy(Ge.empty))),l?0:1,c?0:1),l?0:1)),t(n.scrollIntoView()),!0}function S9e(e){return function(t,r){let{$from:n,$to:a}=t.selection,s=n.blockRange(a,u=>u.childCount>0&&u.firstChild.type==e);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let l=s.parent,c=l.child(i-1);if(c.type!=e)return!1;if(r){let u=c.lastChild&&c.lastChild.type==l.type,d=Ge.from(u?e.create():null),f=new vt(Ge.from(e.create(null,Ge.from(l.type.create(null,d)))),u?3:1,0),m=s.start,p=s.end;r(t.tr.step(new Ha(m-(u?3:1),p,m,p,f,1,!0)).scrollIntoView())}return!0}}const as=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},_g=function(e){let t=e.assignedSlot||e.parentNode;return t&&t.nodeType==11?t.host:t};let kR=null;const Pc=function(e,t,r){let n=kR||(kR=document.createRange());return n.setEnd(e,r??e.nodeValue.length),n.setStart(e,t||0),n},k9e=function(){kR=null},jh=function(e,t,r,n){return r&&(_Q(e,t,r,n,-1)||_Q(e,t,r,n,1))},_9e=/^(img|br|input|textarea|hr)$/i;function _Q(e,t,r,n,a){for(var s;;){if(e==r&&t==n)return!0;if(t==(a<0?0:vo(e))){let i=e.parentNode;if(!i||i.nodeType!=1||r1(e)||_9e.test(e.nodeName)||e.contentEditable=="false")return!1;t=as(e)+(a<0?0:1),e=i}else if(e.nodeType==1){let i=e.childNodes[t+(a<0?-1:0)];if(i.nodeType==1&&i.contentEditable=="false")if(!((s=i.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)t+=a;else return!1;else e=i,t=a<0?vo(e):0}else return!1}}function vo(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function N9e(e,t){for(;;){if(e.nodeType==3&&t)return e;if(e.nodeType==1&&t>0){if(e.contentEditable=="false")return null;e=e.childNodes[t-1],t=vo(e)}else if(e.parentNode&&!r1(e))t=as(e),e=e.parentNode;else return null}}function C9e(e,t){for(;;){if(e.nodeType==3&&t<e.nodeValue.length)return e;if(e.nodeType==1&&t<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[t],t=0}else if(e.parentNode&&!r1(e))t=as(e)+1,e=e.parentNode;else return null}}function j9e(e,t,r){for(let n=t==0,a=t==vo(e);n||a;){if(e==r)return!0;let s=as(e);if(e=e.parentNode,!e)return!1;n=n&&s==0,a=a&&s==vo(e)}}function r1(e){let t;for(let r=e;r&&!(t=r.pmViewDesc);r=r.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const Zj=function(e){return e.focusNode&&jh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Hf(e,t){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=e,r.key=r.code=t,r}function E9e(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function M9e(e,t,r){if(e.caretPositionFromPoint)try{let n=e.caretPositionFromPoint(t,r);if(n)return{node:n.offsetNode,offset:Math.min(vo(n.offsetNode),n.offset)}}catch{}if(e.caretRangeFromPoint){let n=e.caretRangeFromPoint(t,r);if(n)return{node:n.startContainer,offset:Math.min(vo(n.startContainer),n.startOffset)}}}const Il=typeof navigator<"u"?navigator:null,NQ=typeof document<"u"?document:null,Kd=Il&&Il.userAgent||"",_R=/Edge\/(\d+)/.exec(Kd),Nue=/MSIE \d/.exec(Kd),NR=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Kd),ai=!!(Nue||NR||_R),Ed=Nue?document.documentMode:NR?+NR[1]:_R?+_R[1]:0,yo=!ai&&/gecko\/(\d+)/i.test(Kd);yo&&+(/Firefox\/(\d+)/.exec(Kd)||[0,0])[1];const CR=!ai&&/Chrome\/(\d+)/.exec(Kd),Ua=!!CR,Cue=CR?+CR[1]:0,fs=!ai&&!!Il&&/Apple Computer/.test(Il.vendor),Ng=fs&&(/Mobile\/\w+/.test(Kd)||!!Il&&Il.maxTouchPoints>2),uo=Ng||(Il?/Mac/.test(Il.platform):!1),jue=Il?/Win/.test(Il.platform):!1,qc=/Android \d/.test(Kd),n1=!!NQ&&"webkitFontSmoothing"in NQ.documentElement.style,T9e=n1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function A9e(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function gc(e,t){return typeof e=="number"?e:e[t]}function D9e(e){let t=e.getBoundingClientRect(),r=t.width/e.offsetWidth||1,n=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*r,top:t.top,bottom:t.top+e.clientHeight*n}}function CQ(e,t,r){let n=e.someProp("scrollThreshold")||0,a=e.someProp("scrollMargin")||5,s=e.dom.ownerDocument;for(let i=r||e.dom;i;){if(i.nodeType!=1){i=_g(i);continue}let l=i,c=l==s.body,u=c?A9e(s):D9e(l),d=0,f=0;if(t.top<u.top+gc(n,"top")?f=-(u.top-t.top+gc(a,"top")):t.bottom>u.bottom-gc(n,"bottom")&&(f=t.bottom-t.top>u.bottom-u.top?t.top+gc(a,"top")-u.top:t.bottom-u.bottom+gc(a,"bottom")),t.left<u.left+gc(n,"left")?d=-(u.left-t.left+gc(a,"left")):t.right>u.right-gc(n,"right")&&(d=t.right-u.right+gc(a,"right")),d||f)if(c)s.defaultView.scrollBy(d,f);else{let p=l.scrollLeft,v=l.scrollTop;f&&(l.scrollTop+=f),d&&(l.scrollLeft+=d);let b=l.scrollLeft-p,y=l.scrollTop-v;t={left:t.left-b,top:t.top-y,right:t.right-b,bottom:t.bottom-y}}let m=c?"fixed":getComputedStyle(i).position;if(/^(fixed|sticky)$/.test(m))break;i=m=="absolute"?i.offsetParent:_g(i)}}function L9e(e){let t=e.dom.getBoundingClientRect(),r=Math.max(0,t.top),n,a;for(let s=(t.left+t.right)/2,i=r+1;i<Math.min(innerHeight,t.bottom);i+=5){let l=e.root.elementFromPoint(s,i);if(!l||l==e.dom||!e.dom.contains(l))continue;let c=l.getBoundingClientRect();if(c.top>=r-20){n=l,a=c.top;break}}return{refDOM:n,refTop:a,stack:Eue(e.dom)}}function Eue(e){let t=[],r=e.ownerDocument;for(let n=e;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),e!=r);n=_g(n));return t}function O9e({refDOM:e,refTop:t,stack:r}){let n=e?e.getBoundingClientRect().top:0;Mue(r,n==0?0:n-t)}function Mue(e,t){for(let r=0;r<e.length;r++){let{dom:n,top:a,left:s}=e[r];n.scrollTop!=a+t&&(n.scrollTop=a+t),n.scrollLeft!=s&&(n.scrollLeft=s)}}let Xm=null;function I9e(e){if(e.setActive)return e.setActive();if(Xm)return e.focus(Xm);let t=Eue(e);e.focus(Xm==null?{get preventScroll(){return Xm={preventScroll:!0},!0}}:void 0),Xm||(Xm=!1,Mue(t,0))}function Tue(e,t){let r,n=2e8,a,s=0,i=t.top,l=t.top,c,u;for(let d=e.firstChild,f=0;d;d=d.nextSibling,f++){let m;if(d.nodeType==1)m=d.getClientRects();else if(d.nodeType==3)m=Pc(d).getClientRects();else continue;for(let p=0;p<m.length;p++){let v=m[p];if(v.top<=i&&v.bottom>=l){i=Math.max(v.bottom,i),l=Math.min(v.top,l);let b=v.left>t.left?v.left-t.left:v.right<t.left?t.left-v.right:0;if(b<n){r=d,n=b,a=b&&r.nodeType==3?{left:v.right<t.left?v.right:v.left,top:t.top}:t,d.nodeType==1&&b&&(s=f+(t.left>=(v.left+v.right)/2?1:0));continue}}else v.top>t.top&&!c&&v.left<=t.left&&v.right>=t.left&&(c=d,u={left:Math.max(v.left,Math.min(v.right,t.left)),top:v.top});!r&&(t.left>=v.right&&t.top>=v.top||t.left>=v.left&&t.top>=v.bottom)&&(s=f+1)}}return!r&&c&&(r=c,a=u,n=0),r&&r.nodeType==3?R9e(r,a):!r||n&&r.nodeType==1?{node:e,offset:s}:Tue(r,a)}function R9e(e,t){let r=e.nodeValue.length,n=document.createRange(),a;for(let s=0;s<r;s++){n.setEnd(e,s+1),n.setStart(e,s);let i=rd(n,1);if(i.top!=i.bottom&&g9(t,i)){a={node:e,offset:s+(t.left>=(i.left+i.right)/2?1:0)};break}}return n.detach(),a||{node:e,offset:0}}function g9(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function P9e(e,t){let r=e.parentNode;return r&&/^li$/i.test(r.nodeName)&&t.left<e.getBoundingClientRect().left?r:e}function z9e(e,t,r){let{node:n,offset:a}=Tue(t,r),s=-1;if(n.nodeType==1&&!n.firstChild){let i=n.getBoundingClientRect();s=i.left!=i.right&&r.left>(i.left+i.right)/2?1:-1}return e.docView.posFromDOM(n,a,s)}function B9e(e,t,r,n){let a=-1;for(let s=t,i=!1;s!=e.dom;){let l=e.docView.nearestDesc(s,!0),c;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((c=l.dom.getBoundingClientRect()).width||c.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!i&&c.left>n.left||c.top>n.top?a=l.posBefore:(!i&&c.right<n.left||c.bottom<n.top)&&(a=l.posAfter),i=!0),!l.contentDOM&&a<0&&!l.node.isText))return(l.node.isBlock?n.top<(c.top+c.bottom)/2:n.left<(c.left+c.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return a>-1?a:e.docView.posFromDOM(t,r,-1)}function Aue(e,t,r){let n=e.childNodes.length;if(n&&r.top<r.bottom)for(let a=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-r.top)/(r.bottom-r.top))-2)),s=a;;){let i=e.childNodes[s];if(i.nodeType==1){let l=i.getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(g9(t,u))return Aue(i,t,u)}}if((s=(s+1)%n)==a)break}return e}function $9e(e,t){let r=e.dom.ownerDocument,n,a=0,s=M9e(r,t.left,t.top);s&&({node:n,offset:a}=s);let i=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top),l;if(!i||!e.dom.contains(i.nodeType!=1?i.parentNode:i)){let u=e.dom.getBoundingClientRect();if(!g9(t,u)||(i=Aue(e.dom,t,u),!i))return null}if(fs)for(let u=i;n&&u;u=_g(u))u.draggable&&(n=void 0);if(i=P9e(i,t),n){if(yo&&n.nodeType==1&&(a=Math.min(a,n.childNodes.length),a<n.childNodes.length)){let d=n.childNodes[a],f;d.nodeName=="IMG"&&(f=d.getBoundingClientRect()).right<=t.left&&f.bottom>t.top&&a++}let u;n1&&a&&n.nodeType==1&&(u=n.childNodes[a-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=t.top&&a--,n==e.dom&&a==n.childNodes.length-1&&n.lastChild.nodeType==1&&t.top>n.lastChild.getBoundingClientRect().bottom?l=e.state.doc.content.size:(a==0||n.nodeType!=1||n.childNodes[a-1].nodeName!="BR")&&(l=B9e(e,n,a,t))}l==null&&(l=z9e(e,i,t));let c=e.docView.nearestDesc(i,!0);return{pos:l,inside:c?c.posAtStart-c.border:-1}}function jQ(e){return e.top<e.bottom||e.left<e.right}function rd(e,t){let r=e.getClientRects();if(r.length){let n=r[t<0?0:r.length-1];if(jQ(n))return n}return Array.prototype.find.call(r,jQ)||e.getBoundingClientRect()}const F9e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Due(e,t,r){let{node:n,offset:a,atom:s}=e.docView.domFromPos(t,r<0?-1:1),i=n1||yo;if(n.nodeType==3)if(i&&(F9e.test(n.nodeValue)||(r<0?!a:a==n.nodeValue.length))){let c=rd(Pc(n,a,a),r);if(yo&&a&&/\s/.test(n.nodeValue[a-1])&&a<n.nodeValue.length){let u=rd(Pc(n,a-1,a-1),-1);if(u.top==c.top){let d=rd(Pc(n,a,a+1),-1);if(d.top!=c.top)return jv(d,d.left<u.left)}}return c}else{let c=a,u=a,d=r<0?1:-1;return r<0&&!a?(u++,d=-1):r>=0&&a==n.nodeValue.length?(c--,d=1):r<0?c--:u++,jv(rd(Pc(n,c,u),d),d<0)}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(s==null&&a&&(r<0||a==vo(n))){let c=n.childNodes[a-1];if(c.nodeType==1)return PD(c.getBoundingClientRect(),!1)}if(s==null&&a<vo(n)){let c=n.childNodes[a];if(c.nodeType==1)return PD(c.getBoundingClientRect(),!0)}return PD(n.getBoundingClientRect(),r>=0)}if(s==null&&a&&(r<0||a==vo(n))){let c=n.childNodes[a-1],u=c.nodeType==3?Pc(c,vo(c)-(i?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(u)return jv(rd(u,1),!1)}if(s==null&&a<vo(n)){let c=n.childNodes[a];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let u=c?c.nodeType==3?Pc(c,0,i?0:1):c.nodeType==1?c:null:null;if(u)return jv(rd(u,-1),!0)}return jv(rd(n.nodeType==3?Pc(n):n,-r),r>=0)}function jv(e,t){if(e.width==0)return e;let r=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:r,right:r}}function PD(e,t){if(e.height==0)return e;let r=t?e.top:e.bottom;return{top:r,bottom:r,left:e.left,right:e.right}}function Lue(e,t,r){let n=e.state,a=e.root.activeElement;n!=t&&e.updateState(t),a!=e.dom&&e.focus();try{return r()}finally{n!=t&&e.updateState(n),a!=e.dom&&a&&a.focus()}}function U9e(e,t,r){let n=t.selection,a=r=="up"?n.$from:n.$to;return Lue(e,t,()=>{let{node:s}=e.docView.domFromPos(a.pos,r=="up"?-1:1);for(;;){let l=e.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let i=Due(e,a.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let c;if(l.nodeType==1)c=l.getClientRects();else if(l.nodeType==3)c=Pc(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<c.length;u++){let d=c[u];if(d.bottom>d.top+1&&(r=="up"?i.top-d.top>(d.bottom-i.top)*2:d.bottom-i.bottom>(i.bottom-d.top)*2))return!1}}return!0})}const H9e=/[\u0590-\u08ac]/;function q9e(e,t,r){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let a=n.parentOffset,s=!a,i=a==n.parent.content.size,l=e.domSelection();return l?!H9e.test(n.parent.textContent)||!l.modify?r=="left"||r=="backward"?s:i:Lue(e,t,()=>{let{focusNode:c,focusOffset:u,anchorNode:d,anchorOffset:f}=e.domSelectionRange(),m=l.caretBidiLevel;l.modify("move",r,"character");let p=n.depth?e.docView.domAfterPos(n.before()):e.dom,{focusNode:v,focusOffset:b}=e.domSelectionRange(),y=v&&!p.contains(v.nodeType==1?v:v.parentNode)||c==v&&u==b;try{l.collapse(d,f),c&&(c!=d||u!=f)&&l.extend&&l.extend(c,u)}catch{}return m!=null&&(l.caretBidiLevel=m),y}):n.pos==n.start()||n.pos==n.end()}let EQ=null,MQ=null,TQ=!1;function W9e(e,t,r){return EQ==t&&MQ==r?TQ:(EQ=t,MQ=r,TQ=r=="up"||r=="down"?U9e(e,t,r):q9e(e,t,r))}const xo=0,AQ=1,Yf=2,Rl=3;class a1{constructor(t,r,n,a){this.parent=t,this.children=r,this.dom=n,this.contentDOM=a,this.dirty=xo,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,r,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let r=0;r<this.children.length;r++)t+=this.children[r].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let r=0,n=this.posAtStart;;r++){let a=this.children[r];if(a==t)return n;n+=a.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,r,n){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(n<0){let s,i;if(t==this.contentDOM)s=t.childNodes[r-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&!((i=s.pmViewDesc)&&i.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(i)+i.size:this.posAtStart}else{let s,i;if(t==this.contentDOM)s=t.childNodes[r];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&!((i=s.pmViewDesc)&&i.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(i):this.posAtEnd}let a;if(t==this.dom&&this.contentDOM)a=r>as(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let s=t;;s=s.parentNode){if(s==this.dom){a=!1;break}if(s.previousSibling)break}if(a==null&&r==t.childNodes.length)for(let s=t;;s=s.parentNode){if(s==this.dom){a=!0;break}if(s.nextSibling)break}}return a??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,r=!1){for(let n=!0,a=t;a;a=a.parentNode){let s=this.getDesc(a),i;if(s&&(!r||s.node))if(n&&(i=s.nodeDOM)&&!(i.nodeType==1?i.contains(t.nodeType==1?t:t.parentNode):i==t))n=!1;else return s}}getDesc(t){let r=t.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(t,r,n){for(let a=t;a;a=a.parentNode){let s=this.getDesc(a);if(s)return s.localPosFromDOM(t,r,n)}return-1}descAt(t){for(let r=0,n=0;r<this.children.length;r++){let a=this.children[r],s=n+a.size;if(n==t&&s!=n){for(;!a.border&&a.children.length;)for(let i=0;i<a.children.length;i++){let l=a.children[i];if(l.size){a=l;break}}return a}if(t<s)return a.descAt(t-n-a.border);n=s}}domFromPos(t,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,a=0;for(let s=0;n<this.children.length;n++){let i=this.children[n],l=s+i.size;if(l>t||i instanceof Iue){a=t-s;break}s=l}if(a)return this.children[n].domFromPos(a-this.children[n].border,r);for(let s;n&&!(s=this.children[n-1]).size&&s instanceof Oue&&s.side>=0;n--);if(r<=0){let s,i=!0;for(;s=n?this.children[n-1]:null,!(!s||s.dom.parentNode==this.contentDOM);n--,i=!1);return s&&r&&i&&!s.border&&!s.domAtom?s.domFromPos(s.size,r):{node:this.contentDOM,offset:s?as(s.dom)+1:0}}else{let s,i=!0;for(;s=n<this.children.length?this.children[n]:null,!(!s||s.dom.parentNode==this.contentDOM);n++,i=!1);return s&&i&&!s.border&&!s.domAtom?s.domFromPos(0,r):{node:this.contentDOM,offset:s?as(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let a=-1,s=-1;for(let i=n,l=0;;l++){let c=this.children[l],u=i+c.size;if(a==-1&&t<=u){let d=i+c.border;if(t>=d&&r<=u-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(t,r,d);t=i;for(let f=l;f>0;f--){let m=this.children[f-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){a=as(m.dom)+1;break}t-=m.size}a==-1&&(a=0)}if(a>-1&&(u>r||l==this.children.length-1)){r=u;for(let d=l+1;d<this.children.length;d++){let f=this.children[d];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){s=as(f.dom);break}r+=f.size}s==-1&&(s=this.contentDOM.childNodes.length);break}i=u}return{node:this.contentDOM,from:t,to:r,fromOffset:a,toOffset:s}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[t<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(t)}domAfterPos(t){let{node:r,offset:n}=this.domFromPos(t,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+t);return r.childNodes[n]}setSelection(t,r,n,a=!1){let s=Math.min(t,r),i=Math.max(t,r);for(let p=0,v=0;p<this.children.length;p++){let b=this.children[p],y=v+b.size;if(s>v&&i<y)return b.setSelection(t-v-b.border,r-v-b.border,n,a);v=y}let l=this.domFromPos(t,t?-1:1),c=r==t?l:this.domFromPos(r,r?-1:1),u=n.root.getSelection(),d=n.domSelectionRange(),f=!1;if((yo||fs)&&t==r){let{node:p,offset:v}=l;if(p.nodeType==3){if(f=!!(v&&p.nodeValue[v-1]==`
`),f&&v==p.nodeValue.length)for(let b=p,y;b;b=b.parentNode){if(y=b.nextSibling){y.nodeName=="BR"&&(l=c={node:y.parentNode,offset:as(y)+1});break}let S=b.pmViewDesc;if(S&&S.node&&S.node.isBlock)break}}else{let b=p.childNodes[v-1];f=b&&(b.nodeName=="BR"||b.contentEditable=="false")}}if(yo&&d.focusNode&&d.focusNode!=c.node&&d.focusNode.nodeType==1){let p=d.focusNode.childNodes[d.focusOffset];p&&p.contentEditable=="false"&&(a=!0)}if(!(a||f&&fs)&&jh(l.node,l.offset,d.anchorNode,d.anchorOffset)&&jh(c.node,c.offset,d.focusNode,d.focusOffset))return;let m=!1;if((u.extend||t==r)&&!(f&&yo)){u.collapse(l.node,l.offset);try{t!=r&&u.extend(c.node,c.offset),m=!0}catch{}}if(!m){if(t>r){let v=l;l=c,c=v}let p=document.createRange();p.setEnd(c.node,c.offset),p.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,r){for(let n=0,a=0;a<this.children.length;a++){let s=this.children[a],i=n+s.size;if(n==i?t<=i&&r>=n:t<i&&r>n){let l=n+s.border,c=i-s.border;if(t>=l&&r<=c){this.dirty=t==n||r==i?Yf:AQ,t==l&&r==c&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Rl:s.markDirty(t-l,r-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Yf:Rl}n=i}this.dirty=Yf}markParentsDirty(){let t=1;for(let r=this.parent;r;r=r.parent,t++){let n=t==1?Yf:AQ;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class Oue extends a1{constructor(t,r,n,a){let s,i=r.type.toDOM;if(typeof i=="function"&&(i=i(n,()=>{if(!s)return a;if(s.parent)return s.parent.posBeforeChild(s)})),!r.type.spec.raw){if(i.nodeType!=1){let l=document.createElement("span");l.appendChild(i),i=l}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(t,[],i,null),this.widget=r,this.widget=r,s=this}matchesWidget(t){return this.dirty==xo&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let r=this.widget.spec.stopEvent;return r?r(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class K9e extends a1{constructor(t,r,n,a){super(t,[],r,null),this.textDOM=n,this.text=a}get size(){return this.text.length}localPosFromDOM(t,r){return t!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class Eh extends a1{constructor(t,r,n,a,s){super(t,[],n,a),this.mark=r,this.spec=s}static create(t,r,n,a){let s=a.nodeViews[r.type.name],i=s&&s(r,a,n);return(!i||!i.dom)&&(i=Zh.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new Eh(t,r,i.dom,i.contentDOM||i.dom,i)}parseRule(){return this.dirty&Rl||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=Rl&&this.mark.eq(t)}markDirty(t,r){if(super.markDirty(t,r),this.dirty!=xo){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=xo}}slice(t,r,n){let a=Eh.create(this.parent,this.mark,!0,n),s=this.children,i=this.size;r<i&&(s=ER(s,r,i,n)),t>0&&(s=ER(s,0,t,n));for(let l=0;l<s.length;l++)s[l].parent=a;return a.children=s,a}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Md extends a1{constructor(t,r,n,a,s,i,l,c,u){super(t,[],s,i),this.node=r,this.outerDeco=n,this.innerDeco=a,this.nodeDOM=l}static create(t,r,n,a,s,i){let l=s.nodeViews[r.type.name],c,u=l&&l(r,s,()=>{if(!c)return i;if(c.parent)return c.parent.posBeforeChild(c)},n,a),d=u&&u.dom,f=u&&u.contentDOM;if(r.isText){if(!d)d=document.createTextNode(r.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:f}=Zh.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!f&&!r.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),r.type.spec.draggable&&(d.draggable=!0));let m=d;return d=zue(d,n,r),u?c=new G9e(t,r,n,a,d,f||null,m,u,s,i+1):r.isText?new Xj(t,r,n,a,d,m,s):new Md(t,r,n,a,d,f||null,m,s,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>Ge.empty)}return t}matchesNode(t,r,n){return this.dirty==xo&&t.eq(this.node)&&fN(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,r){let n=this.node.inlineContent,a=r,s=t.composing?this.localCompositionInfo(t,r):null,i=s&&s.pos>-1?s:null,l=s&&s.pos<0,c=new Y9e(this,i&&i.node,t);Z9e(this.node,this.innerDeco,(u,d,f)=>{u.spec.marks?c.syncToMarks(u.spec.marks,n,t,d):u.type.side>=0&&!f&&c.syncToMarks(d==this.node.childCount?hn.none:this.node.child(d).marks,n,t,d),c.placeWidget(u,t,a)},(u,d,f,m)=>{c.syncToMarks(u.marks,n,t,m);let p;c.findNodeMatch(u,d,f,m)||l&&t.state.selection.from>a&&t.state.selection.to<a+u.nodeSize&&(p=c.findIndexWithChild(s.node))>-1&&c.updateNodeAt(u,d,f,p,t)||c.updateNextNode(u,d,f,t,m,a)||c.addNode(u,d,f,t,a),a+=u.nodeSize}),c.syncToMarks([],n,t,0),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==Yf)&&(i&&this.protectLocalComposition(t,i),Rue(this.contentDOM,this.children,t),Ng&&X9e(this.dom))}localCompositionInfo(t,r){let{from:n,to:a}=t.state.selection;if(!(t.state.selection instanceof Jt)||n<r||a>r+this.node.content.size)return null;let s=t.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let i=s.nodeValue,l=eBe(this.node.content,i,n-r,a-r);return l<0?null:{node:s,pos:l,text:i}}else return{node:s,pos:-1,text:""}}protectLocalComposition(t,{node:r,pos:n,text:a}){if(this.getDesc(r))return;let s=r;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let i=new K9e(this,s,r,a);t.input.compositionNodes.push(i),this.children=ER(this.children,n,n+a.length,t,i)}update(t,r,n,a){return this.dirty==Rl||!t.sameMarkup(this.node)?!1:(this.updateInner(t,r,n,a),!0)}updateInner(t,r,n,a){this.updateOuterDeco(r),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(a,this.posAtStart),this.dirty=xo}updateOuterDeco(t){if(fN(t,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=Pue(this.dom,this.nodeDOM,jR(this.outerDeco,this.node,r),jR(t,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function DQ(e,t,r,n,a){zue(n,t,e);let s=new Md(void 0,e,t,r,n,n,n,a,0);return s.contentDOM&&s.updateChildren(a,0),s}class Xj extends Md{constructor(t,r,n,a,s,i,l){super(t,r,n,a,s,null,i,l,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,r,n,a){return this.dirty==Rl||this.dirty!=xo&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=xo||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,a.trackWrites==this.nodeDOM&&(a.trackWrites=null)),this.node=t,this.dirty=xo,!0)}inParent(){let t=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,r,n){return t==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(t,r,n)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,r,n){let a=this.node.cut(t,r),s=document.createTextNode(a.text);return new Xj(this.parent,a,this.outerDeco,this.innerDeco,s,s,n)}markDirty(t,r){super.markDirty(t,r),this.dom!=this.nodeDOM&&(t==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=Rl)}get domAtom(){return!1}isText(t){return this.node.text==t}}class Iue extends a1{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==xo&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class G9e extends Md{constructor(t,r,n,a,s,i,l,c,u,d){super(t,r,n,a,s,i,l,u,d),this.spec=c}update(t,r,n,a){if(this.dirty==Rl)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let s=this.spec.update(t,r,n);return s&&this.updateInner(t,r,n,a),s}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,r,n,a)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,r,n,a){this.spec.setSelection?this.spec.setSelection(t,r,n.root):super.setSelection(t,r,n,a)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Rue(e,t,r){let n=e.firstChild,a=!1;for(let s=0;s<t.length;s++){let i=t[s],l=i.dom;if(l.parentNode==e){for(;l!=n;)n=LQ(n),a=!0;n=n.nextSibling}else a=!0,e.insertBefore(l,n);if(i instanceof Eh){let c=n?n.previousSibling:e.lastChild;Rue(i.contentDOM,i.children,r),n=c?c.nextSibling:e.firstChild}}for(;n;)n=LQ(n),a=!0;a&&r.trackWrites==e&&(r.trackWrites=null)}const Pb=function(e){e&&(this.nodeName=e)};Pb.prototype=Object.create(null);const Qf=[new Pb];function jR(e,t,r){if(e.length==0)return Qf;let n=r?Qf[0]:new Pb,a=[n];for(let s=0;s<e.length;s++){let i=e[s].type.attrs;if(i){i.nodeName&&a.push(n=new Pb(i.nodeName));for(let l in i){let c=i[l];c!=null&&(r&&a.length==1&&a.push(n=new Pb(t.isInline?"span":"div")),l=="class"?n.class=(n.class?n.class+" ":"")+c:l=="style"?n.style=(n.style?n.style+";":"")+c:l!="nodeName"&&(n[l]=c))}}}return a}function Pue(e,t,r,n){if(r==Qf&&n==Qf)return t;let a=t;for(let s=0;s<n.length;s++){let i=n[s],l=r[s];if(s){let c;l&&l.nodeName==i.nodeName&&a!=e&&(c=a.parentNode)&&c.nodeName.toLowerCase()==i.nodeName||(c=document.createElement(i.nodeName),c.pmIsDeco=!0,c.appendChild(a),l=Qf[0]),a=c}V9e(a,l||Qf[0],i)}return a}function V9e(e,t,r){for(let n in t)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&e.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=t[n]&&e.setAttribute(n,r[n]);if(t.class!=r.class){let n=t.class?t.class.split(" ").filter(Boolean):[],a=r.class?r.class.split(" ").filter(Boolean):[];for(let s=0;s<n.length;s++)a.indexOf(n[s])==-1&&e.classList.remove(n[s]);for(let s=0;s<a.length;s++)n.indexOf(a[s])==-1&&e.classList.add(a[s]);e.classList.length==0&&e.removeAttribute("class")}if(t.style!=r.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,a;for(;a=n.exec(t.style);)e.style.removeProperty(a[1])}r.style&&(e.style.cssText+=r.style)}}function zue(e,t,r){return Pue(e,e,Qf,jR(t,r,e.nodeType!=1))}function fN(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].type.eq(t[r].type))return!1;return!0}function LQ(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Y9e{constructor(t,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=Q9e(t.node.content,t)}destroyBetween(t,r){if(t!=r){for(let n=t;n<r;n++)this.top.children[n].destroy();this.top.children.splice(t,r-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,r,n,a){let s=0,i=this.stack.length>>1,l=Math.min(i,t.length);for(;s<l&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&t[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=xo,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<t.length;){this.stack.push(this.top,this.index+1);let c=-1,u=this.top.children.length;a<this.preMatch.index&&(u=Math.min(this.index+3,u));for(let d=this.index;d<u;d++){let f=this.top.children[d];if(f.matchesMark(t[i])&&!this.isLocked(f.dom)){c=d;break}}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{let d=Eh.create(this.top,t[i],r,n);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,i++}}findNodeMatch(t,r,n,a){let s=-1,i;if(a>=this.preMatch.index&&(i=this.preMatch.matches[a-this.preMatch.index]).parent==this.top&&i.matchesNode(t,r,n))s=this.top.children.indexOf(i,this.index);else for(let l=this.index,c=Math.min(this.top.children.length,l+5);l<c;l++){let u=this.top.children[l];if(u.matchesNode(t,r,n)&&!this.preMatch.matched.has(u)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,r,n,a,s){let i=this.top.children[a];return i.dirty==Rl&&i.dom==i.contentDOM&&(i.dirty=Yf),i.update(t,r,n,s)?(this.destroyBetween(this.index,a),this.index++,!0):!1}findIndexWithChild(t){for(;;){let r=t.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=t.pmViewDesc;if(n){for(let a=this.index;a<this.top.children.length;a++)if(this.top.children[a]==n)return a}return-1}t=r}}updateNextNode(t,r,n,a,s,i){for(let l=this.index;l<this.top.children.length;l++){let c=this.top.children[l];if(c instanceof Md){let u=this.preMatch.matched.get(c);if(u!=null&&u!=s)return!1;let d=c.dom,f,m=this.isLocked(d)&&!(t.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==t.text&&c.dirty!=Rl&&fN(r,c.outerDeco));if(!m&&c.update(t,r,n,a))return this.destroyBetween(this.index,l),c.dom!=d&&(this.changed=!0),this.index++,!0;if(!m&&(f=this.recreateWrapper(c,t,r,n,a,i)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Yf,f.updateChildren(a,i+1),f.dirty=xo),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,r,n,a,s,i){if(t.dirty||r.isAtom||!t.children.length||!t.node.content.eq(r.content)||!fN(n,t.outerDeco)||!a.eq(t.innerDeco))return null;let l=Md.create(this.top,r,n,a,s,i);if(l.contentDOM){l.children=t.children,t.children=[];for(let c of l.children)c.parent=l}return t.destroy(),l}addNode(t,r,n,a,s){let i=Md.create(this.top,t,r,n,a,s);i.contentDOM&&i.updateChildren(a,s+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(t,r,n){let a=this.index<this.top.children.length?this.top.children[this.index]:null;if(a&&a.matchesWidget(t)&&(t==a.widget||!a.widget.type.toDOM.parentNode))this.index++;else{let s=new Oue(this.top,t,r,n);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],r=this.top;for(;t instanceof Eh;)r=t,t=r.children[r.children.length-1];(!t||!(t instanceof Xj)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((fs||Ua)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(t,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);t=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),t=="BR"&&(n.className="ProseMirror-trailingBreak");let a=new Iue(this.top,[],n,null);r!=this.top?r.children.push(a):r.children.splice(this.index++,0,a),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function Q9e(e,t){let r=t,n=r.children.length,a=e.childCount,s=new Map,i=[];e:for(;a>0;){let l;for(;;)if(n){let u=r.children[n-1];if(u instanceof Eh)r=u,n=u.children.length;else{l=u,n--;break}}else{if(r==t)break e;n=r.parent.children.indexOf(r),r=r.parent}let c=l.node;if(c){if(c!=e.child(a-1))break;--a,s.set(l,a),i.push(l)}}return{index:a,matched:s,matches:i.reverse()}}function J9e(e,t){return e.type.side-t.type.side}function Z9e(e,t,r,n){let a=t.locals(e),s=0;if(a.length==0){for(let u=0;u<e.childCount;u++){let d=e.child(u);n(d,a,t.forChild(s,d),u),s+=d.nodeSize}return}let i=0,l=[],c=null;for(let u=0;;){let d,f;for(;i<a.length&&a[i].to==s;){let y=a[i++];y.widget&&(d?(f||(f=[d])).push(y):d=y)}if(d)if(f){f.sort(J9e);for(let y=0;y<f.length;y++)r(f[y],u,!!c)}else r(d,u,!!c);let m,p;if(c)p=-1,m=c,c=null;else if(u<e.childCount)p=u,m=e.child(u++);else break;for(let y=0;y<l.length;y++)l[y].to<=s&&l.splice(y--,1);for(;i<a.length&&a[i].from<=s&&a[i].to>s;)l.push(a[i++]);let v=s+m.nodeSize;if(m.isText){let y=v;i<a.length&&a[i].from<y&&(y=a[i].from);for(let S=0;S<l.length;S++)l[S].to<y&&(y=l[S].to);y<v&&(c=m.cut(y-s),m=m.cut(0,y-s),v=y,p=-1)}else for(;i<a.length&&a[i].to<v;)i++;let b=m.isInline&&!m.isLeaf?l.filter(y=>!y.inline):l.slice();n(m,b,t.forChild(s,m),p),s=v}}function X9e(e){if(e.nodeName=="UL"||e.nodeName=="OL"){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function eBe(e,t,r,n){for(let a=0,s=0;a<e.childCount&&s<=n;){let i=e.child(a++),l=s;if(s+=i.nodeSize,!i.isText)continue;let c=i.text;for(;a<e.childCount;){let u=e.child(a++);if(s+=u.nodeSize,!u.isText)break;c+=u.text}if(s>=r){if(s>=n&&c.slice(n-t.length-l,n-l)==t)return n-t.length;let u=l<n?c.lastIndexOf(t,n-l-1):-1;if(u>=0&&u+t.length+l>=r)return l+u;if(r==n&&c.length>=n+t.length-l&&c.slice(n-l,n-l+t.length)==t)return n}}return-1}function ER(e,t,r,n,a){let s=[];for(let i=0,l=0;i<e.length;i++){let c=e[i],u=l,d=l+=c.size;u>=r||d<=t?s.push(c):(u<t&&s.push(c.slice(0,t-u,n)),a&&(s.push(a),a=void 0),d>r&&s.push(c.slice(r-u,c.size,n)))}return s}function v9(e,t=null){let r=e.domSelectionRange(),n=e.state.doc;if(!r.focusNode)return null;let a=e.docView.nearestDesc(r.focusNode),s=a&&a.size==0,i=e.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(i<0)return null;let l=n.resolve(i),c,u;if(Zj(r)){for(c=i;a&&!a.node;)a=a.parent;let f=a.node;if(a&&f.isAtom&&Ft.isSelectable(f)&&a.parent&&!(f.isInline&&j9e(r.focusNode,r.focusOffset,a.dom))){let m=a.posBefore;u=new Ft(i==m?l:n.resolve(m))}}else{if(r instanceof e.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let f=i,m=i;for(let p=0;p<r.rangeCount;p++){let v=r.getRangeAt(p);f=Math.min(f,e.docView.posFromDOM(v.startContainer,v.startOffset,1)),m=Math.max(m,e.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(f<0)return null;[c,i]=m==e.state.selection.anchor?[m,f]:[f,m],l=n.resolve(i)}else c=e.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(c<0)return null}let d=n.resolve(c);if(!u){let f=t=="pointer"||e.state.selection.head<l.pos&&!s?1:-1;u=b9(e,d,l,f)}return u}function Bue(e){return e.editable?e.hasFocus():Fue(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function eu(e,t=!1){let r=e.state.selection;if($ue(e,r),!!Bue(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Ua){let n=e.domSelectionRange(),a=e.domObserver.currentSelection;if(n.anchorNode&&a.anchorNode&&jh(n.anchorNode,n.anchorOffset,a.anchorNode,a.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)rBe(e);else{let{anchor:n,head:a}=r,s,i;OQ&&!(r instanceof Jt)&&(r.$from.parent.inlineContent||(s=IQ(e,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(i=IQ(e,r.to))),e.docView.setSelection(n,a,e,t),OQ&&(s&&RQ(s),i&&RQ(i)),r.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&tBe(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const OQ=fs||Ua&&Cue<63;function IQ(e,t){let{node:r,offset:n}=e.docView.domFromPos(t,0),a=n<r.childNodes.length?r.childNodes[n]:null,s=n?r.childNodes[n-1]:null;if(fs&&a&&a.contentEditable=="false")return zD(a);if((!a||a.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(a)return zD(a);if(s)return zD(s)}}function zD(e){return e.contentEditable="true",fs&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function RQ(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function tBe(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let r=e.domSelectionRange(),n=r.anchorNode,a=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=a)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!Bue(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}function rBe(e){let t=e.domSelection();if(!t)return;let r=e.cursorWrapper.dom,n=r.nodeName=="IMG";n?t.collapse(r.parentNode,as(r)+1):t.collapse(r,0),!n&&!e.state.selection.visible&&ai&&Ed<=11&&(r.disabled=!0,r.disabled=!1)}function $ue(e,t){if(t instanceof Ft){let r=e.docView.descAt(t.from);r!=e.lastSelectedViewDesc&&(PQ(e),r&&r.selectNode(),e.lastSelectedViewDesc=r)}else PQ(e)}function PQ(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function b9(e,t,r,n){return e.someProp("createSelectionBetween",a=>a(e,t,r))||Jt.between(t,r,n)}function zQ(e){return e.editable&&!e.hasFocus()?!1:Fue(e)}function Fue(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function nBe(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),r=e.domSelectionRange();return jh(t.node,t.offset,r.anchorNode,r.anchorOffset)}function MR(e,t){let{$anchor:r,$head:n}=e.selection,a=t>0?r.max(n):r.min(n),s=a.parent.inlineContent?a.depth?e.doc.resolve(t>0?a.after():a.before()):null:a;return s&&cr.findFrom(s,t)}function sd(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function BQ(e,t,r){let n=e.state.selection;if(n instanceof Jt)if(r.indexOf("s")>-1){let{$head:a}=n,s=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let i=e.state.doc.resolve(a.pos+s.nodeSize*(t<0?-1:1));return sd(e,new Jt(n.$anchor,i))}else if(n.empty){if(e.endOfTextblock(t>0?"forward":"backward")){let a=MR(e.state,t);return a&&a instanceof Ft?sd(e,a):!1}else if(!(uo&&r.indexOf("m")>-1)){let a=n.$head,s=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter,i;if(!s||s.isText)return!1;let l=t<0?a.pos-s.nodeSize:a.pos;return s.isAtom||(i=e.docView.descAt(l))&&!i.contentDOM?Ft.isSelectable(s)?sd(e,new Ft(t<0?e.state.doc.resolve(a.pos-s.nodeSize):a)):n1?sd(e,new Jt(e.state.doc.resolve(t<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(n instanceof Ft&&n.node.isInline)return sd(e,new Jt(t>0?n.$to:n.$from));{let a=MR(e.state,t);return a?sd(e,a):!1}}}function hN(e){return e.nodeType==3?e.nodeValue.length:e.childNodes.length}function zb(e,t){let r=e.pmViewDesc;return r&&r.size==0&&(t<0||e.nextSibling||e.nodeName!="BR")}function ep(e,t){return t<0?aBe(e):sBe(e)}function aBe(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let a,s,i=!1;for(yo&&r.nodeType==1&&n<hN(r)&&zb(r.childNodes[n],-1)&&(i=!0);;)if(n>0){if(r.nodeType!=1)break;{let l=r.childNodes[n-1];if(zb(l,-1))a=r,s=--n;else if(l.nodeType==3)r=l,n=r.nodeValue.length;else break}}else{if(Uue(r))break;{let l=r.previousSibling;for(;l&&zb(l,-1);)a=r.parentNode,s=as(l),l=l.previousSibling;if(l)r=l,n=hN(r);else{if(r=r.parentNode,r==e.dom)break;n=0}}}i?TR(e,r,n):a&&TR(e,a,s)}function sBe(e){let t=e.domSelectionRange(),r=t.focusNode,n=t.focusOffset;if(!r)return;let a=hN(r),s,i;for(;;)if(n<a){if(r.nodeType!=1)break;let l=r.childNodes[n];if(zb(l,1))s=r,i=++n;else break}else{if(Uue(r))break;{let l=r.nextSibling;for(;l&&zb(l,1);)s=l.parentNode,i=as(l)+1,l=l.nextSibling;if(l)r=l,n=0,a=hN(r);else{if(r=r.parentNode,r==e.dom)break;n=a=0}}}s&&TR(e,s,i)}function Uue(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function iBe(e,t){for(;e&&t==e.childNodes.length&&!r1(e);)t=as(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let r=e.childNodes[t];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=0}}function oBe(e,t){for(;e&&!t&&!r1(e);)t=as(e),e=e.parentNode;for(;e&&t;){let r=e.childNodes[t-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;e=r,t=e.childNodes.length}}function TR(e,t,r){if(t.nodeType!=3){let s,i;(i=iBe(t,r))?(t=i,r=0):(s=oBe(t,r))&&(t=s,r=s.nodeValue.length)}let n=e.domSelection();if(!n)return;if(Zj(n)){let s=document.createRange();s.setEnd(t,r),s.setStart(t,r),n.removeAllRanges(),n.addRange(s)}else n.extend&&n.extend(t,r);e.domObserver.setCurSelection();let{state:a}=e;setTimeout(()=>{e.state==a&&eu(e)},50)}function $Q(e,t){let r=e.state.doc.resolve(t);if(!(Ua||jue)&&r.parent.inlineContent){let a=e.coordsAtPos(t);if(t>r.start()){let s=e.coordsAtPos(t-1),i=(s.top+s.bottom)/2;if(i>a.top&&i<a.bottom&&Math.abs(s.left-a.left)>1)return s.left<a.left?"ltr":"rtl"}if(t<r.end()){let s=e.coordsAtPos(t+1),i=(s.top+s.bottom)/2;if(i>a.top&&i<a.bottom&&Math.abs(s.left-a.left)>1)return s.left>a.left?"ltr":"rtl"}}return getComputedStyle(e.dom).direction=="rtl"?"rtl":"ltr"}function FQ(e,t,r){let n=e.state.selection;if(n instanceof Jt&&!n.empty||r.indexOf("s")>-1||uo&&r.indexOf("m")>-1)return!1;let{$from:a,$to:s}=n;if(!a.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let i=MR(e.state,t);if(i&&i instanceof Ft)return sd(e,i)}if(!a.parent.inlineContent){let i=t<0?a:s,l=n instanceof Oi?cr.near(i,t):cr.findFrom(i,t);return l?sd(e,l):!1}return!1}function UQ(e,t){if(!(e.state.selection instanceof Jt))return!0;let{$head:r,$anchor:n,empty:a}=e.state.selection;if(!r.sameParent(n))return!0;if(!a)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){let i=e.state.tr;return t<0?i.delete(r.pos-s.nodeSize,r.pos):i.delete(r.pos,r.pos+s.nodeSize),e.dispatch(i),!0}return!1}function HQ(e,t,r){e.domObserver.stop(),t.contentEditable=r,e.domObserver.start()}function lBe(e){if(!fs||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(t&&t.nodeType==1&&r==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let n=t.firstChild;HQ(e,n,"true"),setTimeout(()=>HQ(e,n,"false"),20)}return!1}function cBe(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function uBe(e,t){let r=t.keyCode,n=cBe(t);if(r==8||uo&&r==72&&n=="c")return UQ(e,-1)||ep(e,-1);if(r==46&&!t.shiftKey||uo&&r==68&&n=="c")return UQ(e,1)||ep(e,1);if(r==13||r==27)return!0;if(r==37||uo&&r==66&&n=="c"){let a=r==37?$Q(e,e.state.selection.from)=="ltr"?-1:1:-1;return BQ(e,a,n)||ep(e,a)}else if(r==39||uo&&r==70&&n=="c"){let a=r==39?$Q(e,e.state.selection.from)=="ltr"?1:-1:1;return BQ(e,a,n)||ep(e,a)}else{if(r==38||uo&&r==80&&n=="c")return FQ(e,-1,n)||ep(e,-1);if(r==40||uo&&r==78&&n=="c")return lBe(e)||FQ(e,1,n)||ep(e,1);if(n==(uo?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function y9(e,t){e.someProp("transformCopied",p=>{t=p(t,e)});let r=[],{content:n,openStart:a,openEnd:s}=t;for(;a>1&&s>1&&n.childCount==1&&n.firstChild.childCount==1;){a--,s--;let p=n.firstChild;r.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),n=p.content}let i=e.someProp("clipboardSerializer")||Zh.fromSchema(e.state.schema),l=Vue(),c=l.createElement("div");c.appendChild(i.serializeFragment(n,{document:l}));let u=c.firstChild,d,f=0;for(;u&&u.nodeType==1&&(d=Gue[u.nodeName.toLowerCase()]);){for(let p=d.length-1;p>=0;p--){let v=l.createElement(d[p]);for(;c.firstChild;)v.appendChild(c.firstChild);c.appendChild(v),f++}u=c.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${a} ${s}${f?` -${f}`:""} ${JSON.stringify(r)}`);let m=e.someProp("clipboardTextSerializer",p=>p(t,e))||t.content.textBetween(0,t.content.size,`

`);return{dom:c,text:m,slice:t}}function Hue(e,t,r,n,a){let s=a.parent.type.spec.code,i,l;if(!r&&!t)return null;let c=!!t&&(n||s||!r);if(c){if(e.someProp("transformPastedText",m=>{t=m(t,s||n,e)}),s)return l=new vt(Ge.from(e.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),e.someProp("transformPasted",m=>{l=m(l,e,!0)}),l;let f=e.someProp("clipboardTextParser",m=>m(t,a,n,e));if(f)l=f;else{let m=a.marks(),{schema:p}=e.state,v=Zh.fromSchema(p);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(b=>{let y=i.appendChild(document.createElement("p"));b&&y.appendChild(v.serializeNode(p.text(b,m)))})}}else e.someProp("transformPastedHTML",f=>{r=f(r,e)}),i=mBe(r),n1&&pBe(i);let u=i&&i.querySelector("[data-pm-slice]"),d=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let f=+d[3];f>0;f--){let m=i.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;i=m}if(l||(l=(e.someProp("clipboardParser")||e.someProp("domParser")||jd.fromSchema(e.state.schema)).parseSlice(i,{preserveWhitespace:!!(c||d),context:a,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!dBe.test(m.parentNode.nodeName)?{ignore:!0}:null}})),d)l=gBe(qQ(l,+d[1],+d[2]),d[4]);else if(l=vt.maxOpen(fBe(l.content,a),!0),l.openStart||l.openEnd){let f=0,m=0;for(let p=l.content.firstChild;f<l.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=l.content.lastChild;m<l.openEnd&&!p.type.spec.isolating;m++,p=p.lastChild);l=qQ(l,f,m)}return e.someProp("transformPasted",f=>{l=f(l,e,c)}),l}const dBe=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function fBe(e,t){if(e.childCount<2)return e;for(let r=t.depth;r>=0;r--){let a=t.node(r).contentMatchAt(t.index(r)),s,i=[];if(e.forEach(l=>{if(!i)return;let c=a.findWrapping(l.type),u;if(!c)return i=null;if(u=i.length&&s.length&&Wue(c,s,l,i[i.length-1],0))i[i.length-1]=u;else{i.length&&(i[i.length-1]=Kue(i[i.length-1],s.length));let d=que(l,c);i.push(d),a=a.matchType(d.type),s=c}}),i)return Ge.from(i)}return e}function que(e,t,r=0){for(let n=t.length-1;n>=r;n--)e=t[n].create(null,Ge.from(e));return e}function Wue(e,t,r,n,a){if(a<e.length&&a<t.length&&e[a]==t[a]){let s=Wue(e,t,r,n.lastChild,a+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));if(n.contentMatchAt(n.childCount).matchType(a==e.length-1?r.type:e[a+1]))return n.copy(n.content.append(Ge.from(que(r,e,a+1))))}}function Kue(e,t){if(t==0)return e;let r=e.content.replaceChild(e.childCount-1,Kue(e.lastChild,t-1)),n=e.contentMatchAt(e.childCount).fillBefore(Ge.empty,!0);return e.copy(r.append(n))}function AR(e,t,r,n,a,s){let i=t<0?e.firstChild:e.lastChild,l=i.content;return e.childCount>1&&(s=0),a<n-1&&(l=AR(l,t,r,n,a+1,s)),a>=r&&(l=t<0?i.contentMatchAt(0).fillBefore(l,s<=a).append(l):l.append(i.contentMatchAt(i.childCount).fillBefore(Ge.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,i.copy(l))}function qQ(e,t,r){return t<e.openStart&&(e=new vt(AR(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),r<e.openEnd&&(e=new vt(AR(e.content,1,r,e.openEnd,0,0),e.openStart,r)),e}const Gue={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let WQ=null;function Vue(){return WQ||(WQ=document.implementation.createHTMLDocument("title"))}let BD=null;function hBe(e){let t=window.trustedTypes;return t?(BD||(BD=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),BD.createHTML(e)):e}function mBe(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let r=Vue().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(e),a;if((a=n&&Gue[n[1].toLowerCase()])&&(e=a.map(s=>"<"+s+">").join("")+e+a.map(s=>"</"+s+">").reverse().join("")),r.innerHTML=hBe(e),a)for(let s=0;s<a.length;s++)r=r.querySelector(a[s])||r;return r}function pBe(e){let t=e.querySelectorAll(Ua?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<t.length;r++){let n=t[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),n)}}function gBe(e,t){if(!e.size)return e;let r=e.content.firstChild.type.schema,n;try{n=JSON.parse(t)}catch{return e}let{content:a,openStart:s,openEnd:i}=e;for(let l=n.length-2;l>=0;l-=2){let c=r.nodes[n[l]];if(!c||c.hasRequiredAttrs())break;a=Ge.from(c.create(n[l+1],a)),s++,i++}return new vt(a,s,i)}const Bs={},$s={},vBe={touchstart:!0,touchmove:!0};class bBe{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function yBe(e){for(let t in Bs){let r=Bs[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=n=>{wBe(e,n)&&!x9(e,n)&&(e.editable||!(n.type in $s))&&r(e,n)},vBe[t]?{passive:!0}:void 0)}fs&&e.dom.addEventListener("input",()=>null),DR(e)}function xd(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function xBe(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}function DR(e){e.someProp("handleDOMEvents",t=>{for(let r in t)e.input.eventHandlers[r]||e.dom.addEventListener(r,e.input.eventHandlers[r]=n=>x9(e,n))})}function x9(e,t){return e.someProp("handleDOMEvents",r=>{let n=r[t.type];return n?n(e,t)||t.defaultPrevented:!1})}function wBe(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let r=t.target;r!=e.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(t))return!1;return!0}function SBe(e,t){!x9(e,t)&&Bs[t.type]&&(e.editable||!(t.type in $s))&&Bs[t.type](e,t)}$s.keydown=(e,t)=>{let r=t;if(e.input.shiftKey=r.keyCode==16||r.shiftKey,!Que(e,r)&&(e.input.lastKeyCode=r.keyCode,e.input.lastKeyCodeTime=Date.now(),!(qc&&Ua&&r.keyCode==13)))if(r.keyCode!=229&&e.domObserver.forceFlush(),Ng&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();e.input.lastIOSEnter=n,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==n&&(e.someProp("handleKeyDown",a=>a(e,Hf(13,"Enter"))),e.input.lastIOSEnter=0)},200)}else e.someProp("handleKeyDown",n=>n(e,r))||uBe(e,r)?r.preventDefault():xd(e,"key")};$s.keyup=(e,t)=>{t.keyCode==16&&(e.input.shiftKey=!1)};$s.keypress=(e,t)=>{let r=t;if(Que(e,r)||!r.charCode||r.ctrlKey&&!r.altKey||uo&&r.metaKey)return;if(e.someProp("handleKeyPress",a=>a(e,r))){r.preventDefault();return}let n=e.state.selection;if(!(n instanceof Jt)||!n.$from.sameParent(n.$to)){let a=String.fromCharCode(r.charCode),s=()=>e.state.tr.insertText(a).scrollIntoView();!/[\r\n]/.test(a)&&!e.someProp("handleTextInput",i=>i(e,n.$from.pos,n.$to.pos,a,s))&&e.dispatch(s()),r.preventDefault()}};function e2(e){return{left:e.clientX,top:e.clientY}}function kBe(e,t){let r=t.x-e.clientX,n=t.y-e.clientY;return r*r+n*n<100}function w9(e,t,r,n,a){if(n==-1)return!1;let s=e.state.doc.resolve(n);for(let i=s.depth+1;i>0;i--)if(e.someProp(t,l=>i>s.depth?l(e,r,s.nodeAfter,s.before(i),a,!0):l(e,r,s.node(i),s.before(i),a,!1)))return!0;return!1}function $p(e,t,r){if(e.focused||e.focus(),e.state.selection.eq(t))return;let n=e.state.tr.setSelection(t);n.setMeta("pointer",!0),e.dispatch(n)}function _Be(e,t){if(t==-1)return!1;let r=e.state.doc.resolve(t),n=r.nodeAfter;return n&&n.isAtom&&Ft.isSelectable(n)?($p(e,new Ft(r)),!0):!1}function NBe(e,t){if(t==-1)return!1;let r=e.state.selection,n,a;r instanceof Ft&&(n=r.node);let s=e.state.doc.resolve(t);for(let i=s.depth+1;i>0;i--){let l=i>s.depth?s.nodeAfter:s.node(i);if(Ft.isSelectable(l)){n&&r.$from.depth>0&&i>=r.$from.depth&&s.before(r.$from.depth+1)==r.$from.pos?a=s.before(r.$from.depth):a=s.before(i);break}}return a!=null?($p(e,Ft.create(e.state.doc,a)),!0):!1}function CBe(e,t,r,n,a){return w9(e,"handleClickOn",t,r,n)||e.someProp("handleClick",s=>s(e,t,n))||(a?NBe(e,r):_Be(e,r))}function jBe(e,t,r,n){return w9(e,"handleDoubleClickOn",t,r,n)||e.someProp("handleDoubleClick",a=>a(e,t,n))}function EBe(e,t,r,n){return w9(e,"handleTripleClickOn",t,r,n)||e.someProp("handleTripleClick",a=>a(e,t,n))||MBe(e,r,n)}function MBe(e,t,r){if(r.button!=0)return!1;let n=e.state.doc;if(t==-1)return n.inlineContent?($p(e,Jt.create(n,0,n.content.size)),!0):!1;let a=n.resolve(t);for(let s=a.depth+1;s>0;s--){let i=s>a.depth?a.nodeAfter:a.node(s),l=a.before(s);if(i.inlineContent)$p(e,Jt.create(n,l+1,l+1+i.content.size));else if(Ft.isSelectable(i))$p(e,Ft.create(n,l));else continue;return!0}}function S9(e){return mN(e)}const Yue=uo?"metaKey":"ctrlKey";Bs.mousedown=(e,t)=>{let r=t;e.input.shiftKey=r.shiftKey;let n=S9(e),a=Date.now(),s="singleClick";a-e.input.lastClick.time<500&&kBe(r,e.input.lastClick)&&!r[Yue]&&e.input.lastClick.button==r.button&&(e.input.lastClick.type=="singleClick"?s="doubleClick":e.input.lastClick.type=="doubleClick"&&(s="tripleClick")),e.input.lastClick={time:a,x:r.clientX,y:r.clientY,type:s,button:r.button};let i=e.posAtCoords(e2(r));i&&(s=="singleClick"?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new TBe(e,i,r,!!n)):(s=="doubleClick"?jBe:EBe)(e,i.pos,i.inside,r)?r.preventDefault():xd(e,"pointer"))};class TBe{constructor(t,r,n,a){this.view=t,this.pos=r,this.event=n,this.flushed=a,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Yue],this.allowDefault=n.shiftKey;let s,i;if(r.inside>-1)s=t.state.doc.nodeAt(r.inside),i=r.inside;else{let d=t.state.doc.resolve(r.pos);s=d.parent,i=d.depth?d.before():0}const l=a?null:n.target,c=l?t.docView.nearestDesc(l,!0):null;this.target=c&&c.nodeDOM.nodeType==1?c.nodeDOM:null;let{selection:u}=t.state;(n.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof Ft&&u.from<=i&&u.to>i)&&(this.mightDrag={node:s,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&yo&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),xd(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>eu(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(e2(t))),this.updateAllowDefault(t),this.allowDefault||!r?xd(this.view,"pointer"):CBe(this.view,r.pos,r.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||fs&&this.mightDrag&&!this.mightDrag.node.isAtom||Ua&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?($p(this.view,cr.near(this.view.state.doc.resolve(r.pos))),t.preventDefault()):xd(this.view,"pointer")}move(t){this.updateAllowDefault(t),xd(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}Bs.touchstart=e=>{e.input.lastTouch=Date.now(),S9(e),xd(e,"pointer")};Bs.touchmove=e=>{e.input.lastTouch=Date.now(),xd(e,"pointer")};Bs.contextmenu=e=>S9(e);function Que(e,t){return e.composing?!0:fs&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500?(e.input.compositionEndedAt=-2e8,!0):!1}const ABe=qc?5e3:-1;$s.compositionstart=$s.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,r=t.selection.$to;if(t.selection instanceof Jt&&(t.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||Ua&&jue&&DBe(e)))e.markCursor=e.state.storedMarks||r.marks(),mN(e,!0),e.markCursor=null;else if(mN(e,!t.selection.empty),yo&&t.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=e.domSelectionRange();for(let a=n.focusNode,s=n.focusOffset;a&&a.nodeType==1&&s!=0;){let i=s<0?a.lastChild:a.childNodes[s-1];if(!i)break;if(i.nodeType==3){let l=e.domSelection();l&&l.collapse(i,i.nodeValue.length);break}else a=i,s=-1}}e.input.composing=!0}Jue(e,ABe)};function DBe(e){let{focusNode:t,focusOffset:r}=e.domSelectionRange();if(!t||t.nodeType!=1||r>=t.childNodes.length)return!1;let n=t.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}$s.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.badSafariComposition?e.domObserver.forceFlush():e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,Jue(e,20))};function Jue(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>mN(e),t))}function Zue(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=OBe());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function LBe(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let r=N9e(t.focusNode,t.focusOffset),n=C9e(t.focusNode,t.focusOffset);if(r&&n&&r!=n){let a=n.pmViewDesc,s=e.domObserver.lastChangedTextNode;if(r==s||n==s)return s;if(!a||!a.isText(n.nodeValue))return n;if(e.input.compositionNode==n){let i=r.pmViewDesc;if(!(!i||!i.isText(r.nodeValue)))return n}}return r||n}function OBe(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}function mN(e,t=!1){if(!(qc&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),Zue(e),t||e.docView&&e.docView.dirty){let r=v9(e),n=e.state.selection;return r&&!r.eq(n)?e.dispatch(e.state.tr.setSelection(r)):(e.markCursor||t)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}function IBe(e,t){if(!e.dom.parentNode)return;let r=e.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(t),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),a=document.createRange();a.selectNodeContents(t),e.dom.blur(),n.removeAllRanges(),n.addRange(a),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),e.focus()},50)}const Yy=ai&&Ed<15||Ng&&T9e<604;Bs.copy=$s.cut=(e,t)=>{let r=t,n=e.state.selection,a=r.type=="cut";if(n.empty)return;let s=Yy?null:r.clipboardData,i=n.content(),{dom:l,text:c}=y9(e,i);s?(r.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",c)):IBe(e,l),a&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function RBe(e){return e.openStart==0&&e.openEnd==0&&e.content.childCount==1?e.content.firstChild:null}function PBe(e,t){if(!e.dom.parentNode)return;let r=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,n=e.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let a=e.input.shiftKey&&e.input.lastKeyCode!=45;setTimeout(()=>{e.focus(),n.parentNode&&n.parentNode.removeChild(n),r?Qy(e,n.value,null,a,t):Qy(e,n.textContent,n.innerHTML,a,t)},50)}function Qy(e,t,r,n,a){let s=Hue(e,t,r,n,e.state.selection.$from);if(e.someProp("handlePaste",c=>c(e,a,s||vt.empty)))return!0;if(!s)return!1;let i=RBe(s),l=i?e.state.tr.replaceSelectionWith(i,n):e.state.tr.replaceSelection(s);return e.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Xue(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let r=e.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}$s.paste=(e,t)=>{let r=t;if(e.composing&&!qc)return;let n=Yy?null:r.clipboardData,a=e.input.shiftKey&&e.input.lastKeyCode!=45;n&&Qy(e,Xue(n),n.getData("text/html"),a,r)?r.preventDefault():PBe(e,r)};class ede{constructor(t,r,n){this.slice=t,this.move=r,this.node=n}}const zBe=uo?"altKey":"ctrlKey";function tde(e,t){let r=e.someProp("dragCopies",n=>!n(t));return r??!t[zBe]}Bs.dragstart=(e,t)=>{let r=t,n=e.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let a=e.state.selection,s=a.empty?null:e.posAtCoords(e2(r)),i;if(!(s&&s.pos>=a.from&&s.pos<=(a instanceof Ft?a.to-1:a.to))){if(n&&n.mightDrag)i=Ft.create(e.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let f=e.docView.nearestDesc(r.target,!0);f&&f.node.type.spec.draggable&&f!=e.docView&&(i=Ft.create(e.state.doc,f.posBefore))}}let l=(i||e.state.selection).content(),{dom:c,text:u,slice:d}=y9(e,l);(!r.dataTransfer.files.length||!Ua||Cue>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(Yy?"Text":"text/html",c.innerHTML),r.dataTransfer.effectAllowed="copyMove",Yy||r.dataTransfer.setData("text/plain",u),e.dragging=new ede(d,tde(e,r),i)};Bs.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)};$s.dragover=$s.dragenter=(e,t)=>t.preventDefault();$s.drop=(e,t)=>{try{BBe(e,t,e.dragging)}finally{e.dragging=null}};function BBe(e,t,r){if(!t.dataTransfer)return;let n=e.posAtCoords(e2(t));if(!n)return;let a=e.state.doc.resolve(n.pos),s=r&&r.slice;s?e.someProp("transformPasted",p=>{s=p(s,e,!1)}):s=Hue(e,Xue(t.dataTransfer),Yy?null:t.dataTransfer.getData("text/html"),!1,a);let i=!!(r&&tde(e,t));if(e.someProp("handleDrop",p=>p(e,t,s||vt.empty,i))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?sue(e.state.doc,a.pos,s):a.pos;l==null&&(l=a.pos);let c=e.state.tr;if(i){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(f))return;let m=c.doc.resolve(u);if(d&&Ft.isSelectable(s.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new Ft(m));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,b,y,S)=>p=S),c.setSelection(b9(e,m,c.doc.resolve(p)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}Bs.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&eu(e)},20))};Bs.blur=(e,t)=>{let r=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),r.relatedTarget&&e.dom.contains(r.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)};Bs.beforeinput=(e,t)=>{if(Ua&&qc&&t.inputType=="deleteContentBackward"){e.domObserver.flushSoon();let{domChangeCount:n}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=n||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",s=>s(e,Hf(8,"Backspace")))))return;let{$cursor:a}=e.state.selection;a&&a.pos>0&&e.dispatch(e.state.tr.delete(a.pos-1,a.pos).scrollIntoView())},50)}};for(let e in $s)Bs[e]=$s[e];function Jy(e,t){if(e==t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0}class pN{constructor(t,r){this.toDOM=t,this.spec=r||ih,this.side=this.spec.side||0}map(t,r,n,a){let{pos:s,deleted:i}=t.mapResult(r.from+a,this.side<0?-1:1);return i?null:new ga(s-n,s-n,this)}valid(){return!0}eq(t){return this==t||t instanceof pN&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Jy(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Td{constructor(t,r){this.attrs=t,this.spec=r||ih}map(t,r,n,a){let s=t.map(r.from+a,this.spec.inclusiveStart?-1:1)-n,i=t.map(r.to+a,this.spec.inclusiveEnd?1:-1)-n;return s>=i?null:new ga(s,i,this)}valid(t,r){return r.from<r.to}eq(t){return this==t||t instanceof Td&&Jy(this.attrs,t.attrs)&&Jy(this.spec,t.spec)}static is(t){return t.type instanceof Td}destroy(){}}class k9{constructor(t,r){this.attrs=t,this.spec=r||ih}map(t,r,n,a){let s=t.mapResult(r.from+a,1);if(s.deleted)return null;let i=t.mapResult(r.to+a,-1);return i.deleted||i.pos<=s.pos?null:new ga(s.pos-n,i.pos-n,this)}valid(t,r){let{index:n,offset:a}=t.content.findIndex(r.from),s;return a==r.from&&!(s=t.child(n)).isText&&a+s.nodeSize==r.to}eq(t){return this==t||t instanceof k9&&Jy(this.attrs,t.attrs)&&Jy(this.spec,t.spec)}destroy(){}}class ga{constructor(t,r,n){this.from=t,this.to=r,this.type=n}copy(t,r){return new ga(t,r,this.type)}eq(t,r=0){return this.type.eq(t.type)&&this.from+r==t.from&&this.to+r==t.to}map(t,r,n){return this.type.map(t,this,r,n)}static widget(t,r,n){return new ga(t,t,new pN(r,n))}static inline(t,r,n,a){return new ga(t,r,new Td(n,a))}static node(t,r,n,a){return new ga(t,r,new k9(n,a))}get spec(){return this.type.spec}get inline(){return this.type instanceof Td}get widget(){return this.type instanceof pN}}const vp=[],ih={};class en{constructor(t,r){this.local=t.length?t:vp,this.children=r.length?r:vp}static create(t,r){return r.length?gN(r,t,0,ih):ys}find(t,r,n){let a=[];return this.findInner(t??0,r??1e9,a,0,n),a}findInner(t,r,n,a,s){for(let i=0;i<this.local.length;i++){let l=this.local[i];l.from<=r&&l.to>=t&&(!s||s(l.spec))&&n.push(l.copy(l.from+a,l.to+a))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<r&&this.children[i+1]>t){let l=this.children[i]+1;this.children[i+2].findInner(t-l,r-l,n,a+l,s)}}map(t,r,n){return this==ys||t.maps.length==0?this:this.mapInner(t,r,0,0,n||ih)}mapInner(t,r,n,a,s){let i;for(let l=0;l<this.local.length;l++){let c=this.local[l].map(t,n,a);c&&c.type.valid(r,c)?(i||(i=[])).push(c):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?$Be(this.children,i||[],t,r,n,a,s):i?new en(i.sort(oh),vp):ys}add(t,r){return r.length?this==ys?en.create(t,r):this.addInner(t,r,0):this}addInner(t,r,n){let a,s=0;t.forEach((l,c)=>{let u=c+n,d;if(d=nde(r,l,u)){for(a||(a=this.children.slice());s<a.length&&a[s]<c;)s+=3;a[s]==c?a[s+2]=a[s+2].addInner(l,d,u+1):a.splice(s,0,c,c+l.nodeSize,gN(d,l,u+1,ih)),s+=3}});let i=rde(s?ade(r):r,-n);for(let l=0;l<i.length;l++)i[l].type.valid(t,i[l])||i.splice(l--,1);return new en(i.length?this.local.concat(i).sort(oh):this.local,a||this.children)}remove(t){return t.length==0||this==ys?this:this.removeInner(t,0)}removeInner(t,r){let n=this.children,a=this.local;for(let s=0;s<n.length;s+=3){let i,l=n[s]+r,c=n[s+1]+r;for(let d=0,f;d<t.length;d++)(f=t[d])&&f.from>l&&f.to<c&&(t[d]=null,(i||(i=[])).push(f));if(!i)continue;n==this.children&&(n=this.children.slice());let u=n[s+2].removeInner(i,l+1);u!=ys?n[s+2]=u:(n.splice(s,3),s-=3)}if(a.length){for(let s=0,i;s<t.length;s++)if(i=t[s])for(let l=0;l<a.length;l++)a[l].eq(i,r)&&(a==this.local&&(a=this.local.slice()),a.splice(l--,1))}return n==this.children&&a==this.local?this:a.length||n.length?new en(a,n):ys}forChild(t,r){if(this==ys)return this;if(r.isLeaf)return en.empty;let n,a;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=t){this.children[l]==t&&(n=this.children[l+2]);break}let s=t+1,i=s+r.content.size;for(let l=0;l<this.local.length;l++){let c=this.local[l];if(c.from<i&&c.to>s&&c.type instanceof Td){let u=Math.max(s,c.from)-s,d=Math.min(i,c.to)-s;u<d&&(a||(a=[])).push(c.copy(u,d))}}if(a){let l=new en(a.sort(oh),vp);return n?new dd([l,n]):l}return n||ys}eq(t){if(this==t)return!0;if(!(t instanceof en)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(t.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=t.children[r]||this.children[r+1]!=t.children[r+1]||!this.children[r+2].eq(t.children[r+2]))return!1;return!0}locals(t){return _9(this.localsInner(t))}localsInner(t){if(this==ys)return vp;if(t.inlineContent||!this.local.some(Td.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Td||r.push(this.local[n]);return r}forEachSet(t){t(this)}}en.empty=new en([],[]);en.removeOverlap=_9;const ys=en.empty;class dd{constructor(t){this.members=t}map(t,r){const n=this.members.map(a=>a.map(t,r,ih));return dd.from(n)}forChild(t,r){if(r.isLeaf)return en.empty;let n=[];for(let a=0;a<this.members.length;a++){let s=this.members[a].forChild(t,r);s!=ys&&(s instanceof dd?n=n.concat(s.members):n.push(s))}return dd.from(n)}eq(t){if(!(t instanceof dd)||t.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(t.members[r]))return!1;return!0}locals(t){let r,n=!0;for(let a=0;a<this.members.length;a++){let s=this.members[a].localsInner(t);if(s.length)if(!r)r=s;else{n&&(r=r.slice(),n=!1);for(let i=0;i<s.length;i++)r.push(s[i])}}return r?_9(n?r:r.sort(oh)):vp}static from(t){switch(t.length){case 0:return ys;case 1:return t[0];default:return new dd(t.every(r=>r instanceof en)?t:t.reduce((r,n)=>r.concat(n instanceof en?n:n.members),[]))}}forEachSet(t){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(t)}}function $Be(e,t,r,n,a,s,i){let l=e.slice();for(let u=0,d=s;u<r.maps.length;u++){let f=0;r.maps[u].forEach((m,p,v,b)=>{let y=b-v-(p-m);for(let S=0;S<l.length;S+=3){let _=l[S+1];if(_<0||m>_+d-f)continue;let N=l[S]+d-f;p>=N?l[S+1]=m<=N?-2:-1:m>=d&&y&&(l[S]+=y,l[S+1]+=y)}f+=y}),d=r.maps[u].map(d,-1)}let c=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){c=!0,l[u+1]=-1;continue}let d=r.map(e[u]+s),f=d-a;if(f<0||f>=n.content.size){c=!0;continue}let m=r.map(e[u+1]+s,-1),p=m-a,{index:v,offset:b}=n.content.findIndex(f),y=n.maybeChild(v);if(y&&b==f&&b+y.nodeSize==p){let S=l[u+2].mapInner(r,y,d+1,e[u]+s+1,i);S!=ys?(l[u]=f,l[u+1]=p,l[u+2]=S):(l[u+1]=-2,c=!0)}else c=!0}if(c){let u=FBe(l,e,t,r,a,s,i),d=gN(u,n,0,i);t=d.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,m=0;f<d.children.length;f+=3){let p=d.children[f];for(;m<l.length&&l[m]<p;)m+=3;l.splice(m,0,d.children[f],d.children[f+1],d.children[f+2])}}return new en(t.sort(oh),l)}function rde(e,t){if(!t||!e.length)return e;let r=[];for(let n=0;n<e.length;n++){let a=e[n];r.push(new ga(a.from+t,a.to+t,a.type))}return r}function FBe(e,t,r,n,a,s,i){function l(c,u){for(let d=0;d<c.local.length;d++){let f=c.local[d].map(n,a,u);f?r.push(f):i.onRemove&&i.onRemove(c.local[d].spec)}for(let d=0;d<c.children.length;d+=3)l(c.children[d+2],c.children[d]+u+1)}for(let c=0;c<e.length;c+=3)e[c+1]==-1&&l(e[c+2],t[c]+s+1);return r}function nde(e,t,r){if(t.isLeaf)return null;let n=r+t.nodeSize,a=null;for(let s=0,i;s<e.length;s++)(i=e[s])&&i.from>r&&i.to<n&&((a||(a=[])).push(i),e[s]=null);return a}function ade(e){let t=[];for(let r=0;r<e.length;r++)e[r]!=null&&t.push(e[r]);return t}function gN(e,t,r,n){let a=[],s=!1;t.forEach((l,c)=>{let u=nde(e,l,c+r);if(u){s=!0;let d=gN(u,l,r+c+1,n);d!=ys&&a.push(c,c+l.nodeSize,d)}});let i=rde(s?ade(e):e,-r).sort(oh);for(let l=0;l<i.length;l++)i[l].type.valid(t,i[l])||(n.onRemove&&n.onRemove(i[l].spec),i.splice(l--,1));return i.length||a.length?new en(i,a):ys}function oh(e,t){return e.from-t.from||e.to-t.to}function _9(e){let t=e;for(let r=0;r<t.length-1;r++){let n=t[r];if(n.from!=n.to)for(let a=r+1;a<t.length;a++){let s=t[a];if(s.from==n.from){s.to!=n.to&&(t==e&&(t=e.slice()),t[a]=s.copy(s.from,n.to),KQ(t,a+1,s.copy(n.to,s.to)));continue}else{s.from<n.to&&(t==e&&(t=e.slice()),t[r]=n.copy(n.from,s.from),KQ(t,a,n.copy(s.from,n.to)));break}}}return t}function KQ(e,t,r){for(;t<e.length&&oh(r,e[t])>0;)t++;e.splice(t,0,r)}function $D(e){let t=[];return e.someProp("decorations",r=>{let n=r(e.state);n&&n!=ys&&t.push(n)}),e.cursorWrapper&&t.push(en.create(e.state.doc,[e.cursorWrapper.deco])),dd.from(t)}const UBe={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},HBe=ai&&Ed<=11;class qBe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class WBe{constructor(t,r){this.view=t,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new qBe,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let a=0;a<n.length;a++)this.queue.push(n[a]);ai&&Ed<=11&&n.some(a=>a.type=="childList"&&a.removedNodes.length||a.type=="characterData"&&a.oldValue.length>a.target.nodeValue.length)?this.flushSoon():fs&&t.composing&&n.some(a=>a.type=="childList"&&a.target.nodeName=="TR")?(t.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),HBe&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,UBe)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let r=0;r<t.length;r++)this.queue.push(t[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(zQ(this.view)){if(this.suppressingSelectionUpdates)return eu(this.view);if(ai&&Ed<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&jh(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let r=new Set,n;for(let s=t.focusNode;s;s=_g(s))r.add(s);for(let s=t.anchorNode;s;s=_g(s))if(r.has(s)){n=s;break}let a=n&&this.view.docView.nearestDesc(n);if(a&&a.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=t.domSelectionRange(),a=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&zQ(t)&&!this.ignoreSelectionChange(n),s=-1,i=-1,l=!1,c=[];if(t.editable)for(let d=0;d<r.length;d++){let f=this.registerMutation(r[d],c);f&&(s=s<0?f.from:Math.min(f.from,s),i=i<0?f.to:Math.max(f.to,i),f.typeOver&&(l=!0))}if(yo&&c.length){let d=c.filter(f=>f.nodeName=="BR");if(d.length==2){let[f,m]=d;f.parentNode&&f.parentNode.parentNode==m.parentNode?m.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let m of d){let p=m.parentNode;p&&p.nodeName=="LI"&&(!f||VBe(t,f)!=p)&&m.remove()}}}else if((Ua||fs)&&c.some(d=>d.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let d of c)if(d.nodeName=="BR"&&d.parentNode){let f=d.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&d.parentNode.removeChild(d)}}let u=null;s<0&&a&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Zj(n)&&(u=v9(t))&&u.eq(cr.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,eu(t),this.currentSelection.set(n),t.scrollToSelection()):(s>-1||a)&&(s>-1&&(t.docView.markDirty(s,i),KBe(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,YBe(t,c)),this.handleDOMChange(s,i,l,c),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||eu(t),this.currentSelection.set(n))}registerMutation(t,r){if(r.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(n==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if(t.type=="childList"){for(let d=0;d<t.addedNodes.length;d++){let f=t.addedNodes[d];r.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let a=t.previousSibling,s=t.nextSibling;if(ai&&Ed<=11&&t.addedNodes.length)for(let d=0;d<t.addedNodes.length;d++){let{previousSibling:f,nextSibling:m}=t.addedNodes[d];(!f||Array.prototype.indexOf.call(t.addedNodes,f)<0)&&(a=f),(!m||Array.prototype.indexOf.call(t.addedNodes,m)<0)&&(s=m)}let i=a&&a.parentNode==t.target?as(a)+1:0,l=n.localPosFromDOM(t.target,i,-1),c=s&&s.parentNode==t.target?as(s):t.target.childNodes.length,u=n.localPosFromDOM(t.target,c,1);return{from:l,to:u}}else return t.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=t.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let GQ=new WeakMap,VQ=!1;function KBe(e){if(!GQ.has(e)&&(GQ.set(e,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)!==-1)){if(e.requiresGeckoHackNode=yo,VQ)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),VQ=!0}}function YQ(e,t){let r=t.startContainer,n=t.startOffset,a=t.endContainer,s=t.endOffset,i=e.domAtPos(e.state.selection.anchor);return jh(i.node,i.offset,a,s)&&([r,n,a,s]=[a,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:a,focusOffset:s}}function GBe(e,t){if(t.getComposedRanges){let a=t.getComposedRanges(e.root)[0];if(a)return YQ(e,a)}let r;function n(a){a.preventDefault(),a.stopImmediatePropagation(),r=a.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0),r?YQ(e,r):null}function VBe(e,t){for(let r=t.parentNode;r&&r!=e.dom;r=r.parentNode){let n=e.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function YBe(e,t){var r;let{focusNode:n,focusOffset:a}=e.domSelectionRange();for(let s of t)if(((r=s.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let i=s.nextSibling;for(;i&&i.nodeName!="TD"&&i.nodeName!="TH";)i=i.nextSibling;if(i){let l=i;for(;;){let c=l.firstChild;if(!c||c.nodeType!=1||c.contentEditable=="false"||/^(BR|IMG)$/.test(c.nodeName))break;l=c}l.insertBefore(s,l.firstChild),n==s&&e.domSelection().collapse(s,a)}else s.parentNode.removeChild(s)}}function QBe(e,t,r){let{node:n,fromOffset:a,toOffset:s,from:i,to:l}=e.docView.parseRange(t,r),c=e.domSelectionRange(),u,d=c.anchorNode;if(d&&e.dom.contains(d.nodeType==1?d:d.parentNode)&&(u=[{node:d,offset:c.anchorOffset}],Zj(c)||u.push({node:c.focusNode,offset:c.focusOffset})),Ua&&e.input.lastKeyCode===8)for(let y=s;y>a;y--){let S=n.childNodes[y-1],_=S.pmViewDesc;if(S.nodeName=="BR"&&!_){s=y;break}if(!_||_.size)break}let f=e.state.doc,m=e.someProp("domParser")||jd.fromSchema(e.state.schema),p=f.resolve(i),v=null,b=m.parse(n,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:a,to:s,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:JBe,context:p});if(u&&u[0].pos!=null){let y=u[0].pos,S=u[1]&&u[1].pos;S==null&&(S=y),v={anchor:y+i,head:S+i}}return{doc:b,sel:v,from:i,to:l}}function JBe(e){let t=e.pmViewDesc;if(t)return t.parseRule();if(e.nodeName=="BR"&&e.parentNode){if(fs&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(e.parentNode.lastChild==e||fs&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if(e.nodeName=="IMG"&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const ZBe=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function XBe(e,t,r,n,a){let s=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let T=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,O=v9(e,T);if(O&&!e.state.selection.eq(O)){if(Ua&&qc&&e.input.lastKeyCode===13&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",H=>H(e,Hf(13,"Enter"))))return;let R=e.state.tr.setSelection(O);T=="pointer"?R.setMeta("pointer",!0):T=="key"&&R.scrollIntoView(),s&&R.setMeta("composition",s),e.dispatch(R)}return}let i=e.state.doc.resolve(t),l=i.sharedDepth(r);t=i.before(l+1),r=e.state.doc.resolve(r).after(l+1);let c=e.state.selection,u=QBe(e,t,r),d=e.state.doc,f=d.slice(u.from,u.to),m,p;e.input.lastKeyCode===8&&Date.now()-100<e.input.lastKeyCodeTime?(m=e.state.selection.to,p="end"):(m=e.state.selection.from,p="start"),e.input.lastKeyCode=null;let v=r$e(f.content,u.doc.content,u.from,m,p);if(v&&e.input.domChangeCount++,(Ng&&e.input.lastIOSEnter>Date.now()-225||qc)&&a.some(T=>T.nodeType==1&&!ZBe.test(T.nodeName))&&(!v||v.endA>=v.endB)&&e.someProp("handleKeyDown",T=>T(e,Hf(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!v)if(n&&c instanceof Jt&&!c.empty&&c.$head.sameParent(c.$anchor)&&!e.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))v={start:c.from,endA:c.to,endB:c.to};else{if(u.sel){let T=QQ(e,e.state.doc,u.sel);if(T&&!T.eq(e.state.selection)){let O=e.state.tr.setSelection(T);s&&O.setMeta("composition",s),e.dispatch(O)}}return}e.state.selection.from<e.state.selection.to&&v.start==v.endB&&e.state.selection instanceof Jt&&(v.start>e.state.selection.from&&v.start<=e.state.selection.from+2&&e.state.selection.from>=u.from?v.start=e.state.selection.from:v.endA<e.state.selection.to&&v.endA>=e.state.selection.to-2&&e.state.selection.to<=u.to&&(v.endB+=e.state.selection.to-v.endA,v.endA=e.state.selection.to)),ai&&Ed<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>u.from&&u.doc.textBetween(v.start-u.from-1,v.start-u.from+1)==" "&&(v.start--,v.endA--,v.endB--);let b=u.doc.resolveNoCache(v.start-u.from),y=u.doc.resolveNoCache(v.endB-u.from),S=d.resolve(v.start),_=b.sameParent(y)&&b.parent.inlineContent&&S.end()>=v.endA;if((Ng&&e.input.lastIOSEnter>Date.now()-225&&(!_||a.some(T=>T.nodeName=="DIV"||T.nodeName=="P"))||!_&&b.pos<u.doc.content.size&&(!b.sameParent(y)||!b.parent.inlineContent)&&b.pos<y.pos&&!/\S/.test(u.doc.textBetween(b.pos,y.pos,"","")))&&e.someProp("handleKeyDown",T=>T(e,Hf(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>v.start&&t$e(d,v.start,v.endA,b,y)&&e.someProp("handleKeyDown",T=>T(e,Hf(8,"Backspace")))){qc&&Ua&&e.domObserver.suppressSelectionUpdates();return}Ua&&v.endB==v.start&&(e.input.lastChromeDelete=Date.now()),qc&&!_&&b.start()!=y.start()&&y.parentOffset==0&&b.depth==y.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==v.endA&&(v.endB-=2,y=u.doc.resolveNoCache(v.endB-u.from),setTimeout(()=>{e.someProp("handleKeyDown",function(T){return T(e,Hf(13,"Enter"))})},20));let N=v.start,k=v.endA,j=T=>{let O=T||e.state.tr.replace(N,k,u.doc.slice(v.start-u.from,v.endB-u.from));if(u.sel){let R=QQ(e,O.doc,u.sel);R&&!(Ua&&e.composing&&R.empty&&(v.start!=v.endB||e.input.lastChromeDelete<Date.now()-100)&&(R.head==N||R.head==O.mapping.map(k)-1)||ai&&R.empty&&R.head==N)&&O.setSelection(R)}return s&&O.setMeta("composition",s),O.scrollIntoView()},E;if(_)if(b.pos==y.pos){ai&&Ed<=11&&b.parentOffset==0&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>eu(e),20));let T=j(e.state.tr.delete(N,k)),O=d.resolve(v.start).marksAcross(d.resolve(v.endA));O&&T.ensureMarks(O),e.dispatch(T)}else if(v.endA==v.endB&&(E=e$e(b.parent.content.cut(b.parentOffset,y.parentOffset),S.parent.content.cut(S.parentOffset,v.endA-S.start())))){let T=j(e.state.tr);E.type=="add"?T.addMark(N,k,E.mark):T.removeMark(N,k,E.mark),e.dispatch(T)}else if(b.parent.child(b.index()).isText&&b.index()==y.index()-(y.textOffset?0:1)){let T=b.parent.textBetween(b.parentOffset,y.parentOffset),O=()=>j(e.state.tr.insertText(T,N,k));e.someProp("handleTextInput",R=>R(e,N,k,T,O))||e.dispatch(O())}else e.dispatch(j());else e.dispatch(j())}function QQ(e,t,r){return Math.max(r.anchor,r.head)>t.content.size?null:b9(e,t.resolve(r.anchor),t.resolve(r.head))}function e$e(e,t){let r=e.firstChild.marks,n=t.firstChild.marks,a=r,s=n,i,l,c;for(let d=0;d<n.length;d++)a=n[d].removeFromSet(a);for(let d=0;d<r.length;d++)s=r[d].removeFromSet(s);if(a.length==1&&s.length==0)l=a[0],i="add",c=d=>d.mark(l.addToSet(d.marks));else if(a.length==0&&s.length==1)l=s[0],i="remove",c=d=>d.mark(l.removeFromSet(d.marks));else return null;let u=[];for(let d=0;d<t.childCount;d++)u.push(c(t.child(d)));if(Ge.from(u).eq(e))return{mark:l,type:i}}function t$e(e,t,r,n,a){if(r-t<=a.pos-n.pos||FD(n,!0,!1)<a.pos)return!1;let s=e.resolve(t);if(!n.parent.isTextblock){let l=s.nodeAfter;return l!=null&&r==t+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let i=e.resolve(FD(s,!0,!0));return!i.parent.isTextblock||i.pos>r||FD(i,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(i.parent.content)}function FD(e,t,r){let n=e.depth,a=t?e.end():e.pos;for(;n>0&&(t||e.indexAfter(n)==e.node(n).childCount);)n--,a++,t=!1;if(r){let s=e.node(n).maybeChild(e.indexAfter(n));for(;s&&!s.isLeaf;)s=s.firstChild,a++}return a}function r$e(e,t,r,n,a){let s=e.findDiffStart(t,r);if(s==null)return null;let{a:i,b:l}=e.findDiffEnd(t,r+e.size,r+t.size);if(a=="end"){let c=Math.max(0,s-Math.min(i,l));n-=i+c-s}if(i<s&&e.size<t.size){let c=n<=s&&n>=i?s-n:0;s-=c,s&&s<t.size&&JQ(t.textBetween(s-1,s+1))&&(s+=c?1:-1),l=s+(l-i),i=s}else if(l<s){let c=n<=s&&n>=l?s-n:0;s-=c,s&&s<e.size&&JQ(e.textBetween(s-1,s+1))&&(s+=c?1:-1),i=s+(i-l),l=s}return{start:s,endA:i,endB:l}}function JQ(e){if(e.length!=2)return!1;let t=e.charCodeAt(0),r=e.charCodeAt(1);return t>=56320&&t<=57343&&r>=55296&&r<=56319}class sde{constructor(t,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new bBe,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(rJ),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=eJ(this),XQ(this),this.nodeViews=tJ(this),this.docView=DQ(this.state.doc,ZQ(this),$D(this),this.dom,this),this.domObserver=new WBe(this,(n,a,s,i)=>XBe(this,n,a,s,i)),this.domObserver.start(),yBe(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let r in t)this._props[r]=t[r];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&DR(this);let r=this._props;this._props=t,t.plugins&&(t.plugins.forEach(rJ),this.directPlugins=t.plugins),this.updateStateInner(t.state,r)}setProps(t){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in t)r[n]=t[n];this.update(r)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,r){var n;let a=this.state,s=!1,i=!1;t.storedMarks&&this.composing&&(Zue(this),i=!0),this.state=t;let l=a.plugins!=t.plugins||this._props.plugins!=r.plugins;if(l||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let p=tJ(this);a$e(p,this.nodeViews)&&(this.nodeViews=p,s=!0)}(l||r.handleDOMEvents!=this._props.handleDOMEvents)&&DR(this),this.editable=eJ(this),XQ(this);let c=$D(this),u=ZQ(this),d=a.plugins!=t.plugins&&!a.doc.eq(t.doc)?"reset":t.scrollToSelection>a.scrollToSelection?"to selection":"preserve",f=s||!this.docView.matchesNode(t.doc,u,c);(f||!t.selection.eq(a.selection))&&(i=!0);let m=d=="preserve"&&i&&this.dom.style.overflowAnchor==null&&L9e(this);if(i){this.domObserver.stop();let p=f&&(ai||Ua)&&!this.composing&&!a.selection.empty&&!t.selection.empty&&n$e(a.selection,t.selection);if(f){let v=Ua?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=LBe(this)),(s||!this.docView.update(t.doc,u,c,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=DQ(t.doc,u,c,this.dom,this)),v&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&nBe(this))?eu(this,p):($ue(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(a),!((n=this.dragging)===null||n===void 0)&&n.node&&!a.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,a),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():m&&O9e(m)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof Ft){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&CQ(this,r.getBoundingClientRect(),t)}else CQ(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,t)}}updateDraggedNode(t,r){let n=t.node,a=-1;if(this.state.doc.nodeAt(n.from)==n.node)a=n.from;else{let s=n.from+(this.state.doc.content.size-r.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==n.node&&(a=s)}this.dragging=new ede(t.slice,t.move,a<0?void 0:Ft.create(this.state.doc,a))}someProp(t,r){let n=this._props&&this._props[t],a;if(n!=null&&(a=r?r(n):n))return a;for(let i=0;i<this.directPlugins.length;i++){let l=this.directPlugins[i].props[t];if(l!=null&&(a=r?r(l):l))return a}let s=this.state.plugins;if(s)for(let i=0;i<s.length;i++){let l=s[i].props[t];if(l!=null&&(a=r?r(l):l))return a}}hasFocus(){if(ai){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&I9e(this.dom),eu(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return t||document}updateRoot(){this._root=null}posAtCoords(t){return $9e(this,t)}coordsAtPos(t,r=1){return Due(this,t,r)}domAtPos(t,r=0){return this.docView.domFromPos(t,r)}nodeDOM(t){let r=this.docView.descAt(t);return r?r.nodeDOM:null}posAtDOM(t,r,n=-1){let a=this.docView.posFromDOM(t,r,n);if(a==null)throw new RangeError("DOM position not inside the editor");return a}endOfTextblock(t,r){return W9e(this,r||this.state,t)}pasteHTML(t,r){return Qy(this,"",t,!1,r||new ClipboardEvent("paste"))}pasteText(t,r){return Qy(this,t,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(t){return y9(this,t)}destroy(){this.docView&&(xBe(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],$D(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,k9e())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return SBe(this,t)}domSelectionRange(){let t=this.domSelection();return t?fs&&this.root.nodeType===11&&E9e(this.dom.ownerDocument)==this.dom&&GBe(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}sde.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};function ZQ(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(e.state)),r)for(let n in r)n=="class"?t.class+=" "+r[n]:n=="style"?t.style=(t.style?t.style+";":"")+r[n]:!t[n]&&n!="contenteditable"&&n!="nodeName"&&(t[n]=String(r[n]))}),t.translate||(t.translate="no"),[ga.node(0,e.state.doc.content.size,t)]}function XQ(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ga.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function eJ(e){return!e.someProp("editable",t=>t(e.state)===!1)}function n$e(e,t){let r=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(r)!=t.$anchor.start(r)}function tJ(e){let t=Object.create(null);function r(n){for(let a in n)Object.prototype.hasOwnProperty.call(t,a)||(t[a]=n[a])}return e.someProp("nodeViews",r),e.someProp("markViews",r),t}function a$e(e,t){let r=0,n=0;for(let a in e){if(e[a]!=t[a])return!0;r++}for(let a in t)n++;return r!=n}function rJ(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Rd={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},vN={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},s$e=typeof navigator<"u"&&/Mac/.test(navigator.platform),i$e=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ss=0;ss<10;ss++)Rd[48+ss]=Rd[96+ss]=String(ss);for(var ss=1;ss<=24;ss++)Rd[ss+111]="F"+ss;for(var ss=65;ss<=90;ss++)Rd[ss]=String.fromCharCode(ss+32),vN[ss]=String.fromCharCode(ss);for(var UD in Rd)vN.hasOwnProperty(UD)||(vN[UD]=Rd[UD]);function o$e(e){var t=s$e&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||i$e&&e.shiftKey&&e.key&&e.key.length==1||e.key=="Unidentified",r=!t&&e.key||(e.shiftKey?vN:Rd)[e.keyCode]||e.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const l$e=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),c$e=typeof navigator<"u"&&/Win/.test(navigator.platform);function u$e(e){let t=e.split(/-(?!$)/),r=t[t.length-1];r=="Space"&&(r=" ");let n,a,s,i;for(let l=0;l<t.length-1;l++){let c=t[l];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))a=!0;else if(/^s(hift)?$/i.test(c))s=!0;else if(/^mod$/i.test(c))l$e?i=!0:a=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(r="Alt-"+r),a&&(r="Ctrl-"+r),i&&(r="Meta-"+r),s&&(r="Shift-"+r),r}function d$e(e){let t=Object.create(null);for(let r in e)t[u$e(r)]=e[r];return t}function HD(e,t,r=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),r&&t.shiftKey&&(e="Shift-"+e),e}function f$e(e){return new Hr({props:{handleKeyDown:ide(e)}})}function ide(e){let t=d$e(e);return function(r,n){let a=o$e(n),s,i=t[HD(a,n)];if(i&&i(r.state,r.dispatch,r))return!0;if(a.length==1&&a!=" "){if(n.shiftKey){let l=t[HD(a,n,!1)];if(l&&l(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(c$e&&n.ctrlKey&&n.altKey)&&(s=Rd[n.keyCode])&&s!=a){let l=t[HD(s,n)];if(l&&l(r.state,r.dispatch,r))return!0}}return!1}}var h$e=Object.defineProperty,N9=(e,t)=>{for(var r in t)h$e(e,r,{get:t[r],enumerable:!0})};function t2(e){const{state:t,transaction:r}=e;let{selection:n}=r,{doc:a}=r,{storedMarks:s}=r;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return n},get doc(){return a},get tr(){return n=r.selection,a=r.doc,s=r.storedMarks,r}}}var r2=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:n}=t,{tr:a}=r,s=this.buildProps(a);return Object.fromEntries(Object.entries(e).map(([i,l])=>[i,(...u)=>{const d=l(...u)(s);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(a),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:n,state:a}=this,{view:s}=n,i=[],l=!!e,c=e||a.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),i.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,m])=>[f,(...v)=>{const b=this.buildProps(c,t),y=m(...v)(b);return i.push(y),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,n=!1,a=e||r.tr,s=this.buildProps(a,n);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(a,n)}}buildProps(e,t=!0){const{rawCommands:r,editor:n,state:a}=this,{view:s}=n,i={tr:e,editor:n,view:s,state:t2({state:a,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(i)]))}};return i}},ode={};N9(ode,{blur:()=>m$e,clearContent:()=>p$e,clearNodes:()=>g$e,command:()=>v$e,createParagraphNear:()=>b$e,cut:()=>y$e,deleteCurrentNode:()=>x$e,deleteNode:()=>w$e,deleteRange:()=>S$e,deleteSelection:()=>k$e,enter:()=>_$e,exitCode:()=>N$e,extendMarkRange:()=>C$e,first:()=>j$e,focus:()=>M$e,forEach:()=>T$e,insertContent:()=>A$e,insertContentAt:()=>O$e,joinBackward:()=>P$e,joinDown:()=>R$e,joinForward:()=>z$e,joinItemBackward:()=>B$e,joinItemForward:()=>$$e,joinTextblockBackward:()=>F$e,joinTextblockForward:()=>U$e,joinUp:()=>I$e,keyboardShortcut:()=>q$e,lift:()=>W$e,liftEmptyBlock:()=>K$e,liftListItem:()=>G$e,newlineInCode:()=>V$e,resetAttributes:()=>Y$e,scrollIntoView:()=>Q$e,selectAll:()=>J$e,selectNodeBackward:()=>Z$e,selectNodeForward:()=>X$e,selectParentNode:()=>e8e,selectTextblockEnd:()=>t8e,selectTextblockStart:()=>r8e,setContent:()=>n8e,setMark:()=>k8e,setMeta:()=>_8e,setNode:()=>N8e,setNodeSelection:()=>C8e,setTextDirection:()=>j8e,setTextSelection:()=>E8e,sinkListItem:()=>M8e,splitBlock:()=>T8e,splitListItem:()=>A8e,toggleList:()=>D8e,toggleMark:()=>L8e,toggleNode:()=>O8e,toggleWrap:()=>I8e,undoInputRule:()=>R8e,unsetAllMarks:()=>P8e,unsetMark:()=>z8e,unsetTextDirection:()=>B8e,updateAttributes:()=>$8e,wrapIn:()=>F8e,wrapInList:()=>U8e});var m$e=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var r;e.isDestroyed||(t.dom.blur(),(r=window?.getSelection())==null||r.removeAllRanges())}),!0),p$e=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),g$e=()=>({state:e,tr:t,dispatch:r})=>{const{selection:n}=t,{ranges:a}=n;return r&&a.forEach(({$from:s,$to:i})=>{e.doc.nodesBetween(s.pos,i.pos,(l,c)=>{if(l.type.isText)return;const{doc:u,mapping:d}=t,f=u.resolve(d.map(c)),m=u.resolve(d.map(c+l.nodeSize)),p=f.blockRange(m);if(!p)return;const v=h0(p);if(l.type.isTextblock){const{defaultType:b}=f.parent.contentMatchAt(f.index());t.setNodeMarkup(p.start,b)}(v||v===0)&&t.lift(p,v)})}),!0},v$e=e=>t=>e(t),b$e=()=>({state:e,dispatch:t})=>wue(e,t),y$e=(e,t)=>({editor:r,tr:n})=>{const{state:a}=r,s=a.doc.slice(e.from,e.to);n.deleteRange(e.from,e.to);const i=n.mapping.map(t);return n.insert(i,s.content),n.setSelection(new Jt(n.doc.resolve(Math.max(i-1,0)))),!0},x$e=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,n=r.$anchor.node();if(n.content.size>0)return!1;const a=e.selection.$anchor;for(let s=a.depth;s>0;s-=1)if(a.node(s).type===n.type){if(t){const l=a.before(s),c=a.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1};function ba(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var w$e=e=>({tr:t,state:r,dispatch:n})=>{const a=ba(e,r.schema),s=t.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===a){if(n){const c=s.before(i),u=s.after(i);t.delete(c,u).scrollIntoView()}return!0}return!1},S$e=e=>({tr:t,dispatch:r})=>{const{from:n,to:a}=e;return r&&t.delete(n,a),!0},k$e=()=>({state:e,dispatch:t})=>d9(e,t),_$e=()=>({commands:e})=>e.keyboardShortcut("Enter"),N$e=()=>({state:e,dispatch:t})=>l9e(e,t);function C9(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function bN(e,t,r={strict:!0}){const n=Object.keys(t);return n.length?n.every(a=>r.strict?t[a]===e[a]:C9(t[a])?t[a].test(e[a]):t[a]===e[a]):!0}function lde(e,t,r={}){return e.find(n=>n.type===t&&bN(Object.fromEntries(Object.keys(r).map(a=>[a,n.attrs[a]])),r))}function nJ(e,t,r={}){return!!lde(e,t,r)}function j9(e,t,r){var n;if(!e||!t)return;let a=e.parent.childAfter(e.parentOffset);if((!a.node||!a.node.marks.some(d=>d.type===t))&&(a=e.parent.childBefore(e.parentOffset)),!a.node||!a.node.marks.some(d=>d.type===t)||(r=r||((n=a.node.marks[0])==null?void 0:n.attrs),!lde([...a.node.marks],t,r)))return;let i=a.index,l=e.start()+a.offset,c=i+1,u=l+a.node.nodeSize;for(;i>0&&nJ([...e.parent.child(i-1).marks],t,r);)i-=1,l-=e.parent.child(i).nodeSize;for(;c<e.parent.childCount&&nJ([...e.parent.child(c).marks],t,r);)u+=e.parent.child(c).nodeSize,c+=1;return{from:l,to:u}}function gu(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var C$e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{const s=gu(e,n.schema),{doc:i,selection:l}=r,{$from:c,from:u,to:d}=l;if(a){const f=j9(c,s,t);if(f&&f.from<=u&&f.to>=d){const m=Jt.create(i,f.from,f.to);r.setSelection(m)}}return!0},j$e=e=>t=>{const r=typeof e=="function"?e(t):e;for(let n=0;n<r.length;n+=1)if(r[n](t))return!0;return!1};function cde(e){return e instanceof Jt}function Jf(e=0,t=0,r=0){return Math.min(Math.max(e,t),r)}function ude(e,t=null){if(!t)return null;const r=cr.atStart(e),n=cr.atEnd(e);if(t==="start"||t===!0)return r;if(t==="end")return n;const a=r.from,s=n.to;return t==="all"?Jt.create(e,Jf(0,a,s),Jf(e.content.size,a,s)):Jt.create(e,Jf(t,a,s),Jf(t,a,s))}function aJ(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function yN(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function E$e(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var M$e=(e=null,t={})=>({editor:r,view:n,tr:a,dispatch:s})=>{t={scrollIntoView:!0,...t};const i=()=>{(yN()||aJ())&&n.dom.focus(),E$e()&&!yN()&&!aJ()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),t?.scrollIntoView&&r.commands.scrollIntoView())})};if(n.hasFocus()&&e===null||e===!1)return!0;if(s&&e===null&&!cde(r.state.selection))return i(),!0;const l=ude(a.doc,e)||r.state.selection,c=r.state.selection.eq(l);return s&&(c||a.setSelection(l),c&&a.storedMarks&&a.setStoredMarks(a.storedMarks),i()),!0},T$e=(e,t)=>r=>e.every((n,a)=>t(n,{...r,index:a})),A$e=(e,t)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},e,t),dde=e=>{const t=e.childNodes;for(let r=t.length-1;r>=0;r-=1){const n=t[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?e.removeChild(n):n.nodeType===1&&dde(n)}return e};function hS(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${e}</body>`,r=new window.DOMParser().parseFromString(t,"text/html").body;return dde(r)}function Zy(e,t,r){if(e instanceof Cd||e instanceof Ge)return e;r={slice:!0,parseOptions:{},...r};const n=typeof e=="object"&&e!==null,a=typeof e=="string";if(n)try{if(Array.isArray(e)&&e.length>0)return Ge.fromArray(e.map(l=>t.nodeFromJSON(l)));const i=t.nodeFromJSON(e);return r.errorOnInvalidContent&&i.check(),i}catch(s){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",s),Zy("",t,r)}if(a){if(r.errorOnInvalidContent){let i=!1,l="";const c=new Vce({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(i=!0,l=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?jd.fromSchema(c).parseSlice(hS(e),r.parseOptions):jd.fromSchema(c).parse(hS(e),r.parseOptions),r.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=jd.fromSchema(t);return r.slice?s.parseSlice(hS(e),r.parseOptions).content:s.parse(hS(e),r.parseOptions)}return Zy("",t,r)}function D$e(e,t,r){const n=e.steps.length-1;if(n<t)return;const a=e.steps[n];if(!(a instanceof Fa||a instanceof Ha))return;const s=e.mapping.maps[n];let i=0;s.forEach((l,c,u,d)=>{i===0&&(i=d)}),e.setSelection(cr.near(e.doc.resolve(i),r))}var L$e=e=>!("type"in e),O$e=(e,t,r)=>({tr:n,dispatch:a,editor:s})=>{var i;if(a){r={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let l;const c=y=>{s.emit("contentError",{editor:s,error:y,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Zy(t,s.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(y){c(y)}try{l=Zy(t,s.schema,{parseOptions:u,errorOnInvalidContent:(i=r.errorOnInvalidContent)!=null?i:s.options.enableContentCheck})}catch(y){return c(y),!1}let{from:d,to:f}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},m=!0,p=!0;if((L$e(l)?l:[l]).forEach(y=>{y.check(),m=m?y.isText&&y.marks.length===0:!1,p=p?y.isBlock:!1}),d===f&&p){const{parent:y}=n.doc.resolve(d);y.isTextblock&&!y.type.spec.code&&!y.childCount&&(d-=1,f+=1)}let b;if(m){if(Array.isArray(t))b=t.map(y=>y.text||"").join("");else if(t instanceof Ge){let y="";t.forEach(S=>{S.text&&(y+=S.text)}),b=y}else typeof t=="object"&&t&&t.text?b=t.text:b=t;n.insertText(b,d,f)}else{b=l;const y=n.doc.resolve(d),S=y.node(),_=y.parentOffset===0,N=S.isText||S.isTextblock,k=S.content.size>0;_&&N&&k&&(d=Math.max(0,d-1)),n.replaceWith(d,f,b)}r.updateSelection&&D$e(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:d,text:b}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:d,text:b})}return!0},I$e=()=>({state:e,dispatch:t})=>s9e(e,t),R$e=()=>({state:e,dispatch:t})=>i9e(e,t),P$e=()=>({state:e,dispatch:t})=>mue(e,t),z$e=()=>({state:e,dispatch:t})=>bue(e,t),B$e=()=>({state:e,dispatch:t,tr:r})=>{try{const n=Yj(e.doc,e.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},$$e=()=>({state:e,dispatch:t,tr:r})=>{try{const n=Yj(e.doc,e.selection.$from.pos,1);return n==null?!1:(r.join(n,2),t&&t(r),!0)}catch{return!1}},F$e=()=>({state:e,dispatch:t})=>n9e(e,t),U$e=()=>({state:e,dispatch:t})=>a9e(e,t);function fde(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function H$e(e){const t=e.split(/-(?!$)/);let r=t[t.length-1];r==="Space"&&(r=" ");let n,a,s,i;for(let l=0;l<t.length-1;l+=1){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))a=!0;else if(/^s(hift)?$/i.test(c))s=!0;else if(/^mod$/i.test(c))yN()||fde()?i=!0:a=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return n&&(r=`Alt-${r}`),a&&(r=`Ctrl-${r}`),i&&(r=`Meta-${r}`),s&&(r=`Shift-${r}`),r}var q$e=e=>({editor:t,view:r,tr:n,dispatch:a})=>{const s=H$e(e).split(/-(?!$)/),i=s.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),l=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,l))});return c?.steps.forEach(u=>{const d=u.map(n.mapping);d&&a&&n.maybeStep(d)}),!0};function Pd(e,t,r={}){const{from:n,to:a,empty:s}=e.selection,i=t?ba(t,e.schema):null,l=[];e.doc.nodesBetween(n,a,(f,m)=>{if(f.isText)return;const p=Math.max(n,m),v=Math.min(a,m+f.nodeSize);l.push({node:f,from:p,to:v})});const c=a-n,u=l.filter(f=>i?i.name===f.node.type.name:!0).filter(f=>bN(f.node.attrs,r,{strict:!1}));return s?!!u.length:u.reduce((f,m)=>f+m.to-m.from,0)>=c}var W$e=(e,t={})=>({state:r,dispatch:n})=>{const a=ba(e,r.schema);return Pd(r,a,t)?o9e(r,n):!1},K$e=()=>({state:e,dispatch:t})=>Sue(e,t),G$e=e=>({state:t,dispatch:r})=>{const n=ba(e,t.schema);return y9e(n)(t,r)},V$e=()=>({state:e,dispatch:t})=>xue(e,t);function n2(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function sJ(e,t){const r=typeof t=="string"?[t]:t;return Object.keys(e).reduce((n,a)=>(r.includes(a)||(n[a]=e[a]),n),{})}var Y$e=(e,t)=>({tr:r,state:n,dispatch:a})=>{let s=null,i=null;const l=n2(typeof e=="string"?e:e.name,n.schema);if(!l)return!1;l==="node"&&(s=ba(e,n.schema)),l==="mark"&&(i=gu(e,n.schema));let c=!1;return r.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(d,f)=>{s&&s===d.type&&(c=!0,a&&r.setNodeMarkup(f,void 0,sJ(d.attrs,t))),i&&d.marks.length&&d.marks.forEach(m=>{i===m.type&&(c=!0,a&&r.addMark(f,f+d.nodeSize,i.create(sJ(m.attrs,t))))})})}),c},Q$e=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),J$e=()=>({tr:e,dispatch:t})=>{if(t){const r=new Oi(e.doc);e.setSelection(r)}return!0},Z$e=()=>({state:e,dispatch:t})=>gue(e,t),X$e=()=>({state:e,dispatch:t})=>yue(e,t),e8e=()=>({state:e,dispatch:t})=>d9e(e,t),t8e=()=>({state:e,dispatch:t})=>m9e(e,t),r8e=()=>({state:e,dispatch:t})=>h9e(e,t);function LR(e,t,r={},n={}){return Zy(e,t,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var n8e=(e,{errorOnInvalidContent:t,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:a,tr:s,dispatch:i,commands:l})=>{const{doc:c}=s;if(n.preserveWhitespace!=="full"){const u=LR(e,a.schema,n,{errorOnInvalidContent:t??a.options.enableContentCheck});return i&&s.replaceWith(0,c.content.size,u).setMeta("preventUpdate",!r),!0}return i&&s.setMeta("preventUpdate",!r),l.insertContentAt({from:0,to:c.content.size},e,{parseOptions:n,errorOnInvalidContent:t??a.options.enableContentCheck})};function hde(e,t){const r=gu(t,e.schema),{from:n,to:a,empty:s}=e.selection,i=[];s?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(n,a,c=>{i.push(...c.marks)});const l=i.find(c=>c.type.name===r.name);return l?{...l.attrs}:{}}function mde(e,t){const r=new uue(e);return t.forEach(n=>{n.steps.forEach(a=>{r.step(a)})}),r}function a8e(e){for(let t=0;t<e.edgeCount;t+=1){const{type:r}=e.edge(t);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function OR(e,t){const r=[];return e.descendants((n,a)=>{t(n)&&r.push({node:n,pos:a})}),r}function s8e(e,t,r){const n=[];return e.nodesBetween(t.from,t.to,(a,s)=>{r(a)&&n.push({node:a,pos:s})}),n}function i8e(e,t){for(let r=e.depth;r>0;r-=1){const n=e.node(r);if(t(n))return{pos:r>0?e.before(r):0,start:e.start(r),depth:r,node:n}}}function a2(e){return t=>i8e(t.$from,e)}function It(e,t,r){return e.config[t]===void 0&&e.parent?It(e.parent,t,r):typeof e.config[t]=="function"?e.config[t].bind({...r,parent:e.parent?It(e.parent,t,r):null}):e.config[t]}function E9(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},n=It(t,"addExtensions",r);return n?[t,...E9(n())]:t}).flat(10)}function M9(e,t){const r=Zh.fromSchema(t).serializeFragment(e),a=document.implementation.createHTMLDocument().createElement("div");return a.appendChild(r),a.innerHTML}function pde(e){return typeof e=="function"}function Kr(e,t=void 0,...r){return pde(e)?t?e.bind(t)(...r):e(...r):e}function o8e(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Cg(e){const t=e.filter(a=>a.type==="extension"),r=e.filter(a=>a.type==="node"),n=e.filter(a=>a.type==="mark");return{baseExtensions:t,nodeExtensions:r,markExtensions:n}}function gde(e){const t=[],{nodeExtensions:r,markExtensions:n}=Cg(e),a=[...r,...n],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const l={name:i.name,options:i.options,storage:i.storage,extensions:a},c=It(i,"addGlobalAttributes",l);if(!c)return;c().forEach(d=>{d.types.forEach(f=>{Object.entries(d.attributes).forEach(([m,p])=>{t.push({type:f,name:m,attribute:{...s,...p}})})})})}),a.forEach(i=>{const l={name:i.name,options:i.options,storage:i.storage},c=It(i,"addAttributes",l);if(!c)return;const u=c();Object.entries(u).forEach(([d,f])=>{const m={...s,...f};typeof m?.default=="function"&&(m.default=m.default()),m?.isRequired&&m?.default===void 0&&delete m.default,t.push({type:i.name,name:d,attribute:m})})}),t}function Jn(...e){return e.filter(t=>!!t).reduce((t,r)=>{const n={...t};return Object.entries(r).forEach(([a,s])=>{if(!n[a]){n[a]=s;return}if(a==="class"){const l=s?String(s).split(" "):[],c=n[a]?n[a].split(" "):[],u=l.filter(d=>!c.includes(d));n[a]=[...c,...u].join(" ")}else if(a==="style"){const l=s?s.split(";").map(d=>d.trim()).filter(Boolean):[],c=n[a]?n[a].split(";").map(d=>d.trim()).filter(Boolean):[],u=new Map;c.forEach(d=>{const[f,m]=d.split(":").map(p=>p.trim());u.set(f,m)}),l.forEach(d=>{const[f,m]=d.split(":").map(p=>p.trim());u.set(f,m)}),n[a]=Array.from(u.entries()).map(([d,f])=>`${d}: ${f}`).join("; ")}else n[a]=s}),n},{})}function Xy(e,t){return t.filter(r=>r.type===e.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(e.attrs)||{}:{[r.name]:e.attrs[r.name]}).reduce((r,n)=>Jn(r,n),{})}function l8e(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function iJ(e,t){return"style"in e?e:{...e,getAttrs:r=>{const n=e.getAttrs?e.getAttrs(r):e.attrs;if(n===!1)return!1;const a=t.reduce((s,i)=>{const l=i.attribute.parseHTML?i.attribute.parseHTML(r):l8e(r.getAttribute(i.name));return l==null?s:{...s,[i.name]:l}},{});return{...n,...a}}}}function oJ(e){return Object.fromEntries(Object.entries(e).filter(([t,r])=>t==="attrs"&&o8e(r)?!1:r!=null))}function lJ(e){var t,r;const n={};return!((t=e?.attribute)!=null&&t.isRequired)&&"default"in(e?.attribute||{})&&(n.default=e.attribute.default),((r=e?.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=e.attribute.validate),[e.name,n]}function c8e(e,t){var r;const n=gde(e),{nodeExtensions:a,markExtensions:s}=Cg(e),i=(r=a.find(u=>It(u,"topNode")))==null?void 0:r.name,l=Object.fromEntries(a.map(u=>{const d=n.filter(S=>S.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:t},m=e.reduce((S,_)=>{const N=It(_,"extendNodeSchema",f);return{...S,...N?N(u):{}}},{}),p=oJ({...m,content:Kr(It(u,"content",f)),marks:Kr(It(u,"marks",f)),group:Kr(It(u,"group",f)),inline:Kr(It(u,"inline",f)),atom:Kr(It(u,"atom",f)),selectable:Kr(It(u,"selectable",f)),draggable:Kr(It(u,"draggable",f)),code:Kr(It(u,"code",f)),whitespace:Kr(It(u,"whitespace",f)),linebreakReplacement:Kr(It(u,"linebreakReplacement",f)),defining:Kr(It(u,"defining",f)),isolating:Kr(It(u,"isolating",f)),attrs:Object.fromEntries(d.map(lJ))}),v=Kr(It(u,"parseHTML",f));v&&(p.parseDOM=v.map(S=>iJ(S,d)));const b=It(u,"renderHTML",f);b&&(p.toDOM=S=>b({node:S,HTMLAttributes:Xy(S,d)}));const y=It(u,"renderText",f);return y&&(p.toText=y),[u.name,p]})),c=Object.fromEntries(s.map(u=>{const d=n.filter(y=>y.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:t},m=e.reduce((y,S)=>{const _=It(S,"extendMarkSchema",f);return{...y,..._?_(u):{}}},{}),p=oJ({...m,inclusive:Kr(It(u,"inclusive",f)),excludes:Kr(It(u,"excludes",f)),group:Kr(It(u,"group",f)),spanning:Kr(It(u,"spanning",f)),code:Kr(It(u,"code",f)),attrs:Object.fromEntries(d.map(lJ))}),v=Kr(It(u,"parseHTML",f));v&&(p.parseDOM=v.map(y=>iJ(y,d)));const b=It(u,"renderHTML",f);return b&&(p.toDOM=y=>b({mark:y,HTMLAttributes:Xy(y,d)})),[u.name,p]}));return new Vce({topNode:i,nodes:l,marks:c})}function u8e(e){const t=e.filter((r,n)=>e.indexOf(r)!==n);return Array.from(new Set(t))}function xN(e){return e.sort((r,n)=>{const a=It(r,"priority")||100,s=It(n,"priority")||100;return a>s?-1:a<s?1:0})}function vde(e){const t=xN(E9(e)),r=u8e(t.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),t}function bde(e,t,r){const{from:n,to:a}=t,{blockSeparator:s=`

`,textSerializers:i={}}=r||{};let l="";return e.nodesBetween(n,a,(c,u,d,f)=>{var m;c.isBlock&&u>n&&(l+=s);const p=i?.[c.type.name];if(p)return d&&(l+=p({node:c,pos:u,parent:d,index:f,range:t})),!1;c.isText&&(l+=(m=c?.text)==null?void 0:m.slice(Math.max(n,u)-u,a-u))}),l}function d8e(e,t){const r={from:0,to:e.content.size};return bde(e,r,t)}function yde(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,r])=>[t,r.spec.toText]))}function f8e(e,t){const r=ba(t,e.schema),{from:n,to:a}=e.selection,s=[];e.doc.nodesBetween(n,a,l=>{s.push(l)});const i=s.reverse().find(l=>l.type.name===r.name);return i?{...i.attrs}:{}}function xde(e,t){const r=n2(typeof t=="string"?t:t.name,e.schema);return r==="node"?f8e(e,t):r==="mark"?hde(e,t):{}}function h8e(e,t=JSON.stringify){const r={};return e.filter(n=>{const a=t(n);return Object.prototype.hasOwnProperty.call(r,a)?!1:r[a]=!0})}function m8e(e){const t=h8e(e);return t.length===1?t:t.filter((r,n)=>!t.filter((s,i)=>i!==n).some(s=>r.oldRange.from>=s.oldRange.from&&r.oldRange.to<=s.oldRange.to&&r.newRange.from>=s.newRange.from&&r.newRange.to<=s.newRange.to))}function wde(e){const{mapping:t,steps:r}=e,n=[];return t.maps.forEach((a,s)=>{const i=[];if(a.ranges.length)a.forEach((l,c)=>{i.push({from:l,to:c})});else{const{from:l,to:c}=r[s];if(l===void 0||c===void 0)return;i.push({from:l,to:c})}i.forEach(({from:l,to:c})=>{const u=t.slice(s).map(l,-1),d=t.slice(s).map(c),f=t.invert().map(u,-1),m=t.invert().map(d);n.push({oldRange:{from:f,to:m},newRange:{from:u,to:d}})})}),m8e(n)}function T9(e,t,r){const n=[];return e===t?r.resolve(e).marks().forEach(a=>{const s=r.resolve(e),i=j9(s,a.type);i&&n.push({mark:a,...i})}):r.nodesBetween(e,t,(a,s)=>{!a||a?.nodeSize===void 0||n.push(...a.marks.map(i=>({from:s,to:s+a.nodeSize,mark:i})))}),n}var p8e=(e,t,r,n=20)=>{const a=e.doc.resolve(r);let s=n,i=null;for(;s>0&&i===null;){const l=a.node(s);l?.type.name===t?i=l:s-=1}return[i,s]};function mS(e,t){return t.nodes[e]||t.marks[e]||null}function Sk(e,t,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const a=e.find(s=>s.type===t&&s.name===n);return a?a.attribute.keepOnSplit:!1}))}var g8e=(e,t=500)=>{let r="";const n=e.parentOffset;return e.parent.nodesBetween(Math.max(0,n-t),n,(a,s,i,l)=>{var c,u;const d=((u=(c=a.type.spec).toText)==null?void 0:u.call(c,{node:a,pos:s,parent:i,index:l}))||a.textContent||"%leaf%";r+=a.isAtom&&!a.isText?d:d.slice(0,Math.max(0,n-s))}),r};function IR(e,t,r={}){const{empty:n,ranges:a}=e.selection,s=t?gu(t,e.schema):null;if(n)return!!(e.storedMarks||e.selection.$from.marks()).filter(f=>s?s.name===f.type.name:!0).find(f=>bN(f.attrs,r,{strict:!1}));let i=0;const l=[];if(a.forEach(({$from:f,$to:m})=>{const p=f.pos,v=m.pos;e.doc.nodesBetween(p,v,(b,y)=>{if(!b.isText&&!b.marks.length)return;const S=Math.max(p,y),_=Math.min(v,y+b.nodeSize),N=_-S;i+=N,l.push(...b.marks.map(k=>({mark:k,from:S,to:_})))})}),i===0)return!1;const c=l.filter(f=>s?s.name===f.mark.type.name:!0).filter(f=>bN(f.mark.attrs,r,{strict:!1})).reduce((f,m)=>f+m.to-m.from,0),u=l.filter(f=>s?f.mark.type!==s&&f.mark.type.excludes(s):!0).reduce((f,m)=>f+m.to-m.from,0);return(c>0?c+u:c)>=i}function v8e(e,t,r={}){if(!t)return Pd(e,null,r)||IR(e,null,r);const n=n2(t,e.schema);return n==="node"?Pd(e,t,r):n==="mark"?IR(e,t,r):!1}var b8e=(e,t)=>{const{$from:r,$to:n,$anchor:a}=e.selection;if(t){const s=a2(l=>l.type.name===t)(e.selection);if(!s)return!1;const i=e.doc.resolve(s.pos+1);return a.pos+1===i.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},y8e=e=>{const{$from:t,$to:r}=e.selection;return!(t.parentOffset>0||t.pos!==r.pos)};function cJ(e,t){return Array.isArray(t)?t.some(r=>(typeof r=="string"?r:r.name)===e.name):t}function uJ(e,t){const{nodeExtensions:r}=Cg(t),n=r.find(i=>i.name===e);if(!n)return!1;const a={name:n.name,options:n.options,storage:n.storage},s=Kr(It(n,"group",a));return typeof s!="string"?!1:s.split(" ").includes("list")}function s1(e,{checkChildren:t=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((n=e.text)!=null?n:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let a=!0;return e.content.forEach(s=>{a!==!1&&(s1(s,{ignoreWhitespace:r,checkChildren:t})||(a=!1))}),a}return!1}function A9(e){return e instanceof Ft}var Sde=class kde{constructor(t){this.position=t}static fromJSON(t){return new kde(t.position)}toJSON(){return{position:this.position}}};function x8e(e,t){const r=t.mapping.mapResult(e.position);return{position:new Sde(r.pos),mapResult:r}}function w8e(e){return new Sde(e)}function S8e(e,t,r){var n;const{selection:a}=t;let s=null;if(cde(a)&&(s=a.$cursor),s){const l=(n=e.storedMarks)!=null?n:s.marks();return s.parent.type.allowsMarkType(r)&&(!!r.isInSet(l)||!l.some(u=>u.type.excludes(r)))}const{ranges:i}=a;return i.some(({$from:l,$to:c})=>{let u=l.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(r):!1;return e.doc.nodesBetween(l.pos,c.pos,(d,f,m)=>{if(u)return!1;if(d.isInline){const p=!m||m.type.allowsMarkType(r),v=!!r.isInSet(d.marks)||!d.marks.some(b=>b.type.excludes(r));u=p&&v}return!u}),u})}var k8e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{const{selection:s}=r,{empty:i,ranges:l}=s,c=gu(e,n.schema);if(a)if(i){const u=hde(n,c);r.addStoredMark(c.create({...u,...t}))}else l.forEach(u=>{const d=u.$from.pos,f=u.$to.pos;n.doc.nodesBetween(d,f,(m,p)=>{const v=Math.max(p,d),b=Math.min(p+m.nodeSize,f);m.marks.find(S=>S.type===c)?m.marks.forEach(S=>{c===S.type&&r.addMark(v,b,c.create({...S.attrs,...t}))}):r.addMark(v,b,c.create(t))})});return S8e(n,r,c)},_8e=(e,t)=>({tr:r})=>(r.setMeta(e,t),!0),N8e=(e,t={})=>({state:r,dispatch:n,chain:a})=>{const s=ba(e,r.schema);let i;return r.selection.$anchor.sameParent(r.selection.$head)&&(i=r.selection.$anchor.parent.attrs),s.isTextblock?a().command(({commands:l})=>kQ(s,{...i,...t})(r)?!0:l.clearNodes()).command(({state:l})=>kQ(s,{...i,...t})(l,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},C8e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,a=Jf(e,0,n.content.size),s=Ft.create(n,a);t.setSelection(s)}return!0},j8e=(e,t)=>({tr:r,state:n,dispatch:a})=>{const{selection:s}=n;let i,l;return typeof t=="number"?(i=t,l=t):t&&"from"in t&&"to"in t?(i=t.from,l=t.to):(i=s.from,l=s.to),a&&r.doc.nodesBetween(i,l,(c,u)=>{c.isText||r.setNodeMarkup(u,void 0,{...c.attrs,dir:e})}),!0},E8e=e=>({tr:t,dispatch:r})=>{if(r){const{doc:n}=t,{from:a,to:s}=typeof e=="number"?{from:e,to:e}:e,i=Jt.atStart(n).from,l=Jt.atEnd(n).to,c=Jf(a,i,l),u=Jf(s,i,l),d=Jt.create(n,c,u);t.setSelection(d)}return!0},M8e=e=>({state:t,dispatch:r})=>{const n=ba(e,t.schema);return S9e(n)(t,r)};function dJ(e,t){const r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(r){const n=r.filter(a=>t?.includes(a.type.name));e.tr.ensureMarks(n)}}var T8e=({keepMarks:e=!0}={})=>({tr:t,state:r,dispatch:n,editor:a})=>{const{selection:s,doc:i}=t,{$from:l,$to:c}=s,u=a.extensionManager.attributes,d=Sk(u,l.node().type.name,l.node().attrs);if(s instanceof Ft&&s.node.isBlock)return!l.parentOffset||!Xc(i,l.pos)?!1:(n&&(e&&dJ(r,a.extensionManager.splittableMarks),t.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const f=c.parentOffset===c.parent.content.size,m=l.depth===0?void 0:a8e(l.node(-1).contentMatchAt(l.indexAfter(-1)));let p=f&&m?[{type:m,attrs:d}]:void 0,v=Xc(t.doc,t.mapping.map(l.pos),1,p);if(!p&&!v&&Xc(t.doc,t.mapping.map(l.pos),1,m?[{type:m}]:void 0)&&(v=!0,p=m?[{type:m,attrs:d}]:void 0),n){if(v&&(s instanceof Jt&&t.deleteSelection(),t.split(t.mapping.map(l.pos),1,p),m&&!f&&!l.parentOffset&&l.parent.type!==m)){const b=t.mapping.map(l.before()),y=t.doc.resolve(b);l.node(-1).canReplaceWith(y.index(),y.index()+1,m)&&t.setNodeMarkup(t.mapping.map(l.before()),m)}e&&dJ(r,a.extensionManager.splittableMarks),t.scrollIntoView()}return v},A8e=(e,t={})=>({tr:r,state:n,dispatch:a,editor:s})=>{var i;const l=ba(e,n.schema),{$from:c,$to:u}=n.selection,d=n.selection.node;if(d&&d.isBlock||c.depth<2||!c.sameParent(u))return!1;const f=c.node(-1);if(f.type!==l)return!1;const m=s.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==l||c.index(-2)!==c.node(-2).childCount-1)return!1;if(a){let S=Ge.empty;const _=c.index(-1)?1:c.index(-2)?2:3;for(let O=c.depth-_;O>=c.depth-3;O-=1)S=Ge.from(c.node(O).copy(S));const N=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,k={...Sk(m,c.node().type.name,c.node().attrs),...t},j=((i=l.contentMatch.defaultType)==null?void 0:i.createAndFill(k))||void 0;S=S.append(Ge.from(l.createAndFill(null,j)||void 0));const E=c.before(c.depth-(_-1));r.replace(E,c.after(-N),new vt(S,4-_,0));let T=-1;r.doc.nodesBetween(E,r.doc.content.size,(O,R)=>{if(T>-1)return!1;O.isTextblock&&O.content.size===0&&(T=R+1)}),T>-1&&r.setSelection(Jt.near(r.doc.resolve(T))),r.scrollIntoView()}return!0}const p=u.pos===c.end()?f.contentMatchAt(0).defaultType:null,v={...Sk(m,f.type.name,f.attrs),...t},b={...Sk(m,c.node().type.name,c.node().attrs),...t};r.delete(c.pos,u.pos);const y=p?[{type:l,attrs:v},{type:p,attrs:b}]:[{type:l,attrs:v}];if(!Xc(r.doc,c.pos,2))return!1;if(a){const{selection:S,storedMarks:_}=n,{splittableMarks:N}=s.extensionManager,k=_||S.$to.parentOffset&&S.$from.marks();if(r.split(c.pos,2,y).scrollIntoView(),!k||!a)return!0;const j=k.filter(E=>N.includes(E.type.name));r.ensureMarks(j)}return!0},qD=(e,t)=>{const r=a2(i=>i.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const a=e.doc.nodeAt(n);return r.node.type===a?.type&&Wd(e.doc,r.pos)&&e.join(r.pos),!0},WD=(e,t)=>{const r=a2(i=>i.type===t)(e.selection);if(!r)return!0;const n=e.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const a=e.doc.nodeAt(n);return r.node.type===a?.type&&Wd(e.doc,n)&&e.join(n),!0},D8e=(e,t,r,n={})=>({editor:a,tr:s,state:i,dispatch:l,chain:c,commands:u,can:d})=>{const{extensions:f,splittableMarks:m}=a.extensionManager,p=ba(e,i.schema),v=ba(t,i.schema),{selection:b,storedMarks:y}=i,{$from:S,$to:_}=b,N=S.blockRange(_),k=y||b.$to.parentOffset&&b.$from.marks();if(!N)return!1;const j=a2(E=>uJ(E.type.name,f))(b);if(N.depth>=1&&j&&N.depth-j.depth<=1){if(j.node.type===p)return u.liftListItem(v);if(uJ(j.node.type.name,f)&&p.validContent(j.node.content)&&l)return c().command(()=>(s.setNodeMarkup(j.pos,p),!0)).command(()=>qD(s,p)).command(()=>WD(s,p)).run()}return!r||!k||!l?c().command(()=>d().wrapInList(p,n)?!0:u.clearNodes()).wrapInList(p,n).command(()=>qD(s,p)).command(()=>WD(s,p)).run():c().command(()=>{const E=d().wrapInList(p,n),T=k.filter(O=>m.includes(O.type.name));return s.ensureMarks(T),E?!0:u.clearNodes()}).wrapInList(p,n).command(()=>qD(s,p)).command(()=>WD(s,p)).run()},L8e=(e,t={},r={})=>({state:n,commands:a})=>{const{extendEmptyMarkRange:s=!1}=r,i=gu(e,n.schema);return IR(n,i,t)?a.unsetMark(i,{extendEmptyMarkRange:s}):a.setMark(i,t)},O8e=(e,t,r={})=>({state:n,commands:a})=>{const s=ba(e,n.schema),i=ba(t,n.schema),l=Pd(n,s,r);let c;return n.selection.$anchor.sameParent(n.selection.$head)&&(c=n.selection.$anchor.parent.attrs),l?a.setNode(i,c):a.setNode(s,{...c,...r})},I8e=(e,t={})=>({state:r,commands:n})=>{const a=ba(e,r.schema);return Pd(r,a,t)?n.lift(a):n.wrapIn(a,t)},R8e=()=>({state:e,dispatch:t})=>{const r=e.plugins;for(let n=0;n<r.length;n+=1){const a=r[n];let s;if(a.spec.isInputRules&&(s=a.getState(e))){if(t){const i=e.tr,l=s.transform;for(let c=l.steps.length-1;c>=0;c-=1)i.step(l.steps[c].invert(l.docs[c]));if(s.text){const c=i.doc.resolve(s.from).marks();i.replaceWith(s.from,s.to,e.schema.text(s.text,c))}else i.delete(s.from,s.to)}return!0}}return!1},P8e=()=>({tr:e,dispatch:t})=>{const{selection:r}=e,{empty:n,ranges:a}=r;return n||t&&a.forEach(s=>{e.removeMark(s.$from.pos,s.$to.pos)}),!0},z8e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{var s;const{extendEmptyMarkRange:i=!1}=t,{selection:l}=r,c=gu(e,n.schema),{$from:u,empty:d,ranges:f}=l;if(!a)return!0;if(d&&i){let{from:m,to:p}=l;const v=(s=u.marks().find(y=>y.type===c))==null?void 0:s.attrs,b=j9(u,c,v);b&&(m=b.from,p=b.to),r.removeMark(m,p,c)}else f.forEach(m=>{r.removeMark(m.$from.pos,m.$to.pos,c)});return r.removeStoredMark(c),!0},B8e=e=>({tr:t,state:r,dispatch:n})=>{const{selection:a}=r;let s,i;return typeof e=="number"?(s=e,i=e):e&&"from"in e&&"to"in e?(s=e.from,i=e.to):(s=a.from,i=a.to),n&&t.doc.nodesBetween(s,i,(l,c)=>{if(l.isText)return;const u={...l.attrs};delete u.dir,t.setNodeMarkup(c,void 0,u)}),!0},$8e=(e,t={})=>({tr:r,state:n,dispatch:a})=>{let s=null,i=null;const l=n2(typeof e=="string"?e:e.name,n.schema);if(!l)return!1;l==="node"&&(s=ba(e,n.schema)),l==="mark"&&(i=gu(e,n.schema));let c=!1;return r.selection.ranges.forEach(u=>{const d=u.$from.pos,f=u.$to.pos;let m,p,v,b;r.selection.empty?n.doc.nodesBetween(d,f,(y,S)=>{s&&s===y.type&&(c=!0,v=Math.max(S,d),b=Math.min(S+y.nodeSize,f),m=S,p=y)}):n.doc.nodesBetween(d,f,(y,S)=>{S<d&&s&&s===y.type&&(c=!0,v=Math.max(S,d),b=Math.min(S+y.nodeSize,f),m=S,p=y),S>=d&&S<=f&&(s&&s===y.type&&(c=!0,a&&r.setNodeMarkup(S,void 0,{...y.attrs,...t})),i&&y.marks.length&&y.marks.forEach(_=>{if(i===_.type&&(c=!0,a)){const N=Math.max(S,d),k=Math.min(S+y.nodeSize,f);r.addMark(N,k,i.create({..._.attrs,...t}))}}))}),p&&(m!==void 0&&a&&r.setNodeMarkup(m,void 0,{...p.attrs,...t}),i&&p.marks.length&&p.marks.forEach(y=>{i===y.type&&a&&r.addMark(v,b,i.create({...y.attrs,...t}))}))}),c},F8e=(e,t={})=>({state:r,dispatch:n})=>{const a=ba(e,r.schema);return p9e(a,t)(r,n)},U8e=(e,t={})=>({state:r,dispatch:n})=>{const a=ba(e,r.schema);return g9e(a,t)(r,n)},H8e=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(n=>n.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(n=>n!==t):delete this.callbacks[e]),this}once(e,t){const r=(...n)=>{this.off(e,r),t.apply(this,n)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}},s2=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=(t=e.undoable)!=null?t:!0}},q8e=(e,t)=>{if(C9(t))return t.exec(e);const r=t(e);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=e,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function pS(e){var t;const{editor:r,from:n,to:a,text:s,rules:i,plugin:l}=e,{view:c}=r;if(c.composing)return!1;const u=c.state.doc.resolve(n);if(u.parent.type.spec.code||(t=u.nodeBefore||u.nodeAfter)!=null&&t.marks.find(m=>m.type.spec.code))return!1;let d=!1;const f=g8e(u)+s;return i.forEach(m=>{if(d)return;const p=q8e(f,m.find);if(!p)return;const v=c.state.tr,b=t2({state:c.state,transaction:v}),y={from:n-(p[0].length-s.length),to:a},{commands:S,chain:_,can:N}=new r2({editor:r,state:b});m.handler({state:b,range:y,match:p,commands:S,chain:_,can:N})===null||!v.steps.length||(m.undoable&&v.setMeta(l,{transform:v,from:n,to:a,text:s}),c.dispatch(v),d=!0)}),d}function W8e(e){const{editor:t,rules:r}=e,n=new Hr({state:{init(){return null},apply(a,s,i){const l=a.getMeta(n);if(l)return l;const c=a.getMeta("applyInputRules");return!!c&&setTimeout(()=>{let{text:d}=c;typeof d=="string"?d=d:d=M9(Ge.from(d),i.schema);const{from:f}=c,m=f+d.length;pS({editor:t,from:f,to:m,text:d,rules:r,plugin:n})}),a.selectionSet||a.docChanged?null:s}},props:{handleTextInput(a,s,i,l){return pS({editor:t,from:s,to:i,text:l,rules:r,plugin:n})},handleDOMEvents:{compositionend:a=>(setTimeout(()=>{const{$cursor:s}=a.state.selection;s&&pS({editor:t,from:s.pos,to:s.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(a,s){if(s.key!=="Enter")return!1;const{$cursor:i}=a.state.selection;return i?pS({editor:t,from:i.pos,to:i.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function K8e(e){return Object.prototype.toString.call(e).slice(8,-1)}function gS(e){return K8e(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function _de(e,t){const r={...e};return gS(e)&&gS(t)&&Object.keys(t).forEach(n=>{gS(t[n])&&gS(e[n])?r[n]=_de(e[n],t[n]):r[n]=t[n]}),r}var D9=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...Kr(It(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Kr(It(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){const t=this.extend({...this.config,addOptions:()=>_de(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},Xh=class Nde extends D9{constructor(){super(...arguments),this.type="mark"}static create(t={}){const r=typeof t=="function"?t():t;return new Nde(r)}static handleExit({editor:t,mark:r}){const{tr:n}=t.state,a=t.state.selection.$from;if(a.pos===a.end()){const i=a.marks();if(!!!i.find(u=>u?.type.name===r.name))return!1;const c=i.find(u=>u?.type.name===r.name);return c&&n.removeStoredMark(c),n.insertText(" ",a.pos),t.view.dispatch(n),!0}return!1}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function G8e(e){return typeof e=="number"}var V8e=class{constructor(e){this.find=e.find,this.handler=e.handler}},Y8e=(e,t,r)=>{if(C9(t))return[...e.matchAll(t)];const n=t(e,r);return n?n.map(a=>{const s=[a.text];return s.index=a.index,s.input=e,s.data=a.data,a.replaceWith&&(a.text.includes(a.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(a.replaceWith)),s}):[]};function Q8e(e){const{editor:t,state:r,from:n,to:a,rule:s,pasteEvent:i,dropEvent:l}=e,{commands:c,chain:u,can:d}=new r2({editor:t,state:r}),f=[];return r.doc.nodesBetween(n,a,(p,v)=>{var b,y,S,_,N;if((y=(b=p.type)==null?void 0:b.spec)!=null&&y.code||!(p.isText||p.isTextblock||p.isInline))return;const k=(N=(_=(S=p.content)==null?void 0:S.size)!=null?_:p.nodeSize)!=null?N:0,j=Math.max(n,v),E=Math.min(a,v+k);if(j>=E)return;const T=p.isText?p.text||"":p.textBetween(j-v,E-v,void 0,"");Y8e(T,s.find,i).forEach(R=>{if(R.index===void 0)return;const H=j+R.index+1,$=H+R[0].length,L={from:r.tr.mapping.map(H),to:r.tr.mapping.map($)},A=s.handler({state:r,range:L,match:R,commands:c,chain:u,can:d,pasteEvent:i,dropEvent:l});f.push(A)})}),f.every(p=>p!==null)}var vS=null,J8e=e=>{var t;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=r.clipboardData)==null||t.setData("text/html",e),r};function Z8e(e){const{editor:t,rules:r}=e;let n=null,a=!1,s=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const c=({state:d,from:f,to:m,rule:p,pasteEvt:v})=>{const b=d.tr,y=t2({state:d,transaction:b});if(!(!Q8e({editor:t,state:y,from:Math.max(f-1,0),to:m.b-1,rule:p,pasteEvent:v,dropEvent:l})||!b.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,b}};return r.map(d=>new Hr({view(f){const m=v=>{var b;n=(b=f.dom.parentElement)!=null&&b.contains(v.target)?f.dom.parentElement:null,n&&(vS=t)},p=()=>{vS&&(vS=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(f,m)=>{if(s=n===f.dom.parentElement,l=m,!s){const p=vS;p?.isEditable&&setTimeout(()=>{const v=p.state.selection;v&&p.commands.deleteRange({from:v.from,to:v.to})},10)}return!1},paste:(f,m)=>{var p;const v=(p=m.clipboardData)==null?void 0:p.getData("text/html");return i=m,a=!!v?.includes("data-pm-slice"),!1}}},appendTransaction:(f,m,p)=>{const v=f[0],b=v.getMeta("uiEvent")==="paste"&&!a,y=v.getMeta("uiEvent")==="drop"&&!s,S=v.getMeta("applyPasteRules"),_=!!S;if(!b&&!y&&!_)return;if(_){let{text:j}=S;typeof j=="string"?j=j:j=M9(Ge.from(j),p.schema);const{from:E}=S,T=E+j.length,O=J8e(j);return c({rule:d,state:p,from:E,to:{b:T},pasteEvt:O})}const N=m.doc.content.findDiffStart(p.doc.content),k=m.doc.content.findDiffEnd(p.doc.content);if(!(!G8e(N)||!k||N===k.b))return c({rule:d,state:p,from:N,to:k,pasteEvt:i})}}))}var i2=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=vde(e),this.schema=c8e(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:mS(t.name,this.schema)},n=It(t,"addCommands",r);return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this;return xN([...this.extensions].reverse()).flatMap(n=>{const a={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:mS(n.name,this.schema)},s=[],i=It(n,"addKeyboardShortcuts",a);let l={};if(n.type==="mark"&&It(n,"exitable",a)&&(l.ArrowRight=()=>Xh.handleExit({editor:e,mark:n})),i){const m=Object.fromEntries(Object.entries(i()).map(([p,v])=>[p,()=>v({editor:e})]));l={...l,...m}}const c=f$e(l);s.push(c);const u=It(n,"addInputRules",a);if(cJ(n,e.options.enableInputRules)&&u){const m=u();if(m&&m.length){const p=W8e({editor:e,rules:m}),v=Array.isArray(p)?p:[p];s.push(...v)}}const d=It(n,"addPasteRules",a);if(cJ(n,e.options.enablePasteRules)&&d){const m=d();if(m&&m.length){const p=Z8e({editor:e,rules:m});s.push(...p)}}const f=It(n,"addProseMirrorPlugins",a);if(f){const m=f();s.push(...m)}return s})}get attributes(){return gde(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Cg(this.extensions);return Object.fromEntries(t.filter(r=>!!It(r,"addNodeView")).map(r=>{const n=this.attributes.filter(c=>c.type===r.name),a={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:ba(r.name,this.schema)},s=It(r,"addNodeView",a);if(!s)return[];const i=s();if(!i)return[];const l=(c,u,d,f,m)=>{const p=Xy(c,n);return i({node:c,view:u,getPos:d,decorations:f,innerDecorations:m,editor:e,extension:r,HTMLAttributes:p})};return[r.name,l]}))}dispatchTransaction(e){const{editor:t}=this;return xN([...this.extensions].reverse()).reduceRight((n,a)=>{const s={name:a.name,options:a.options,storage:this.editor.extensionStorage[a.name],editor:t,type:mS(a.name,this.schema)},i=It(a,"dispatchTransaction",s);return i?l=>{i.call(s,{transaction:l,next:n})}:n},e)}get markViews(){const{editor:e}=this,{markExtensions:t}=Cg(this.extensions);return Object.fromEntries(t.filter(r=>!!It(r,"addMarkView")).map(r=>{const n=this.attributes.filter(l=>l.type===r.name),a={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:e,type:gu(r.name,this.schema)},s=It(r,"addMarkView",a);if(!s)return[];const i=(l,c,u)=>{const d=Xy(l,n);return s()({mark:l,view:c,inline:u,editor:e,extension:r,HTMLAttributes:d,updateAttributes:f=>{hFe(l,e,f)}})};return[r.name,i]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(t=>[t.name,t.storage])),e.forEach(t=>{var r;const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:mS(t.name,this.schema)};t.type==="mark"&&((r=Kr(It(t,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(t.name);const a=It(t,"onBeforeCreate",n),s=It(t,"onCreate",n),i=It(t,"onUpdate",n),l=It(t,"onSelectionUpdate",n),c=It(t,"onTransaction",n),u=It(t,"onFocus",n),d=It(t,"onBlur",n),f=It(t,"onDestroy",n);a&&this.editor.on("beforeCreate",a),s&&this.editor.on("create",s),i&&this.editor.on("update",i),l&&this.editor.on("selectionUpdate",l),c&&this.editor.on("transaction",c),u&&this.editor.on("focus",u),d&&this.editor.on("blur",d),f&&this.editor.on("destroy",f)})}};i2.resolve=vde;i2.sort=xN;i2.flatten=E9;var X8e={};N9(X8e,{ClipboardTextSerializer:()=>jde,Commands:()=>Ede,Delete:()=>Mde,Drop:()=>Tde,Editable:()=>Ade,FocusEvents:()=>Lde,Keymap:()=>Ode,Paste:()=>Ide,Tabindex:()=>Rde,TextDirection:()=>Pde,focusEventsPluginKey:()=>Dde});var Br=class Cde extends D9{constructor(){super(...arguments),this.type="extension"}static create(t={}){const r=typeof t=="function"?t():t;return new Cde(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}},jde=Br.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Hr({key:new Qr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:r}=e,{doc:n,selection:a}=t,{ranges:s}=a,i=Math.min(...s.map(d=>d.$from.pos)),l=Math.max(...s.map(d=>d.$to.pos)),c=yde(r);return bde(n,{from:i,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),Ede=Br.create({name:"commands",addCommands(){return{...ode}}}),Mde=Br.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var r,n,a;const s=()=>{var i,l,c,u;if((u=(c=(l=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:l.filterTransaction)==null?void 0:c.call(l,e))!=null?u:e.getMeta("y-sync$"))return;const d=mde(e.before,[e,...t]);wde(d).forEach(p=>{d.mapping.mapResult(p.oldRange.from).deletedAfter&&d.mapping.mapResult(p.oldRange.to).deletedBefore&&d.before.nodesBetween(p.oldRange.from,p.oldRange.to,(v,b)=>{const y=b+v.nodeSize-2,S=p.oldRange.from<=b&&y<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:v,from:b,to:y,newFrom:d.mapping.map(b),newTo:d.mapping.map(y),deletedRange:p.oldRange,newRange:p.newRange,partial:!S,editor:this.editor,transaction:e,combinedTransform:d})})});const m=d.mapping;d.steps.forEach((p,v)=>{var b,y;if(p instanceof Wo){const S=m.slice(v).map(p.from,-1),_=m.slice(v).map(p.to),N=m.invert().map(S,-1),k=m.invert().map(_),j=(b=d.doc.nodeAt(S-1))==null?void 0:b.marks.some(T=>T.eq(p.mark)),E=(y=d.doc.nodeAt(_))==null?void 0:y.marks.some(T=>T.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:N,to:k},newRange:{from:S,to:_},partial:!!(E||j),editor:this.editor,transaction:e,combinedTransform:d})}})};(a=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||a?setTimeout(s,0):s()}}),Tde=Br.create({name:"drop",addProseMirrorPlugins(){return[new Hr({key:new Qr("tiptapDrop"),props:{handleDrop:(e,t,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:r,moved:n})}}})]}}),Ade=Br.create({name:"editable",addProseMirrorPlugins(){return[new Hr({key:new Qr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Dde=new Qr("focusEvents"),Lde=Br.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new Hr({key:Dde,props:{handleDOMEvents:{focus:(t,r)=>{e.isFocused=!0;const n=e.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1},blur:(t,r)=>{e.isFocused=!1;const n=e.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return t.dispatch(n),!1}}}})]}}),Ode=Br.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:l})=>{const{selection:c,doc:u}=l,{empty:d,$anchor:f}=c,{pos:m,parent:p}=f,v=f.parent.isTextblock&&m>0?l.doc.resolve(m-1):f,b=v.parent.type.spec.isolating,y=f.pos-f.parentOffset,S=b&&v.parent.childCount===1?y===f.pos:cr.atStart(u).from===m;return!d||!p.type.isTextblock||p.textContent.length||!S||S&&f.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},a={...n},s={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return yN()||fde()?s:a},addProseMirrorPlugins(){return[new Hr({key:new Qr("clearDocument"),appendTransaction:(e,t,r)=>{if(e.some(b=>b.getMeta("composition")))return;const n=e.some(b=>b.docChanged)&&!t.doc.eq(r.doc),a=e.some(b=>b.getMeta("preventClearDocument"));if(!n||a)return;const{empty:s,from:i,to:l}=t.selection,c=cr.atStart(t.doc).from,u=cr.atEnd(t.doc).to;if(s||!(i===c&&l===u)||!s1(r.doc))return;const m=r.tr,p=t2({state:r,transaction:m}),{commands:v}=new r2({editor:this.editor,state:p});if(v.clearNodes(),!!m.steps.length)return m}})]}}),Ide=Br.create({name:"paste",addProseMirrorPlugins(){return[new Hr({key:new Qr("tiptapPaste"),props:{handlePaste:(e,t,r)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:r})}}})]}}),Rde=Br.create({name:"tabindex",addProseMirrorPlugins(){return[new Hr({key:new Qr("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Pde=Br.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:e}=Cg(this.extensions);return[{types:e.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const r=t.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new Hr({key:new Qr("textDirection"),props:{attributes:()=>{const e=this.options.direction;return e?{dir:e}:{}}}})]}}),eFe=class pb{constructor(t,r,n=!1,a=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=r,this.currentNode=a}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(t);return new pb(r,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new pb(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new pb(t,this.editor)}get children(){const t=[];return this.node.content.forEach((r,n)=>{const a=r.isBlock&&!r.isTextblock,s=r.isAtom&&!r.isText,i=r.isInline,l=this.pos+n+(s?0:1);if(l<0||l>this.resolvedPos.doc.nodeSize-2)return;const c=this.resolvedPos.doc.resolve(l);if(!a&&!i&&c.depth<=this.depth)return;const u=new pb(c,this.editor,a,a||i?r:null);a&&(u.actualDepth=this.depth+1),t.push(u)}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,r={}){let n=null,a=this.parent;for(;a&&!n;){if(a.node.type.name===t)if(Object.keys(r).length>0){const s=a.node.attrs,i=Object.keys(r);for(let l=0;l<i.length;l+=1){const c=i[l];if(s[c]!==r[c])break}}else n=a;a=a.parent}return n}querySelector(t,r={}){return this.querySelectorAll(t,r,!0)[0]||null}querySelectorAll(t,r={},n=!1){let a=[];if(!this.children||this.children.length===0)return a;const s=Object.keys(r);return this.children.forEach(i=>{n&&a.length>0||(i.node.type.name===t&&s.every(c=>r[c]===i.node.attrs[c])&&a.push(i),!(n&&a.length>0)&&(a=a.concat(i.querySelectorAll(t,r,n))))}),a}setAttribute(t){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(r)}},tFe=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function rFe(e,t,r){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const a=document.createElement("style");return t&&a.setAttribute("nonce",t),a.setAttribute("data-tiptap-style",""),a.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(a),a}var nFe=class extends H8e{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:x8e,createMappablePosition:w8e},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:a,moved:s})=>this.options.onDrop(n,a,s)),this.on("paste",({event:n,slice:a})=>this.options.onPaste(n,a)),this.on("delete",this.options.onDelete);const t=this.createDoc(),r=ude(t,this.options.autofocus);this.editorState=Mp.create({doc:t,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=rFe(tFe,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const r=pde(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(a=>{const s=typeof a=="string"?`${a}$`:a.key;r=r.filter(i=>!i.key.startsWith(s))}),t.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[Ade,jde.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),Ede,Lde,Ode,Rde,Tde,Ide,Mde,Pde.configure({direction:this.options.textDirection})].filter(a=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[a.name]!==!1:!0):[],...this.options.extensions].filter(a=>["extension","node","mark"].includes(a?.type));this.extensionManager=new i2(n,this)}createCommandManager(){this.commandManager=new r2({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=LR(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),e=LR(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){const{editorProps:t,enableExtensionDispatchTransaction:r}=this.options,n=t.dispatchTransaction||this.dispatchTransaction.bind(this),a=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new sde(e,{...t,attributes:{role:"textbox",...t?.attributes},dispatchTransaction:a,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.prependClass(),this.injectCSS();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(u=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(u)});return}const{state:t,transactions:r}=this.state.applyTransaction(e),n=!this.state.selection.eq(t.selection),a=r.includes(e),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!a)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),l=i?.getMeta("focus"),c=i?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:i}),c&&this.emit("blur",{editor:this,event:c.event,transaction:i}),!(e.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||s.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:r.slice(1)})}getAttributes(e){return xde(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,n=typeof e=="string"?t:e;return v8e(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return M9(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return d8e(this.state.doc,{blockSeparator:t,textSerializers:{...yde(this.schema),...r}})}get isEmpty(){return s1(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new eFe(t,this)}get $doc(){return this.$pos(0)}};function jg(e){return new s2({find:e.find,handler:({state:t,range:r,match:n})=>{const a=Kr(e.getAttributes,void 0,n);if(a===!1||a===null)return null;const{tr:s}=t,i=n[n.length-1],l=n[0];if(i){const c=l.search(/\S/),u=r.from+l.indexOf(i),d=u+i.length;if(T9(r.from,r.to,t.doc).filter(p=>p.mark.type.excluded.find(b=>b===e.type&&b!==p.mark.type)).filter(p=>p.to>u).length)return null;d<r.to&&s.delete(d,r.to),u>r.from&&s.delete(r.from+c,u);const m=r.from+c+i.length;s.addMark(r.from+c,m,e.type.create(a||{})),s.removeStoredMark(e.type)}},undoable:e.undoable})}function aFe(e){return new s2({find:e.find,handler:({state:t,range:r,match:n})=>{const a=Kr(e.getAttributes,void 0,n)||{},{tr:s}=t,i=r.from;let l=r.to;const c=e.type.create(a);if(n[1]){const u=n[0].lastIndexOf(n[1]);let d=i+u;d>l?d=l:l=d+n[1].length;const f=n[0][n[0].length-1];s.insertText(f,i+n[0].length-1),s.replaceWith(d,l,c)}else if(n[0]){const u=e.type.isInline?i:i-1;s.insert(u,e.type.create(a)).delete(s.mapping.map(i),s.mapping.map(l))}s.scrollIntoView()},undoable:e.undoable})}function ex(e){return new s2({find:e.find,handler:({state:t,range:r,match:n})=>{const a=t.doc.resolve(r.from),s=Kr(e.getAttributes,void 0,n)||{};if(!a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),e.type))return null;t.tr.delete(r.from,r.to).setBlockType(r.from,r.from,e.type,s)},undoable:e.undoable})}function Eg(e){return new s2({find:e.find,handler:({state:t,range:r,match:n,chain:a})=>{const s=Kr(e.getAttributes,void 0,n)||{},i=t.tr.delete(r.from,r.to),c=i.doc.resolve(r.from).blockRange(),u=c&&c9(c,e.type,s);if(!u)return null;if(i.wrap(c,u),e.keepMarks&&e.editor){const{selection:f,storedMarks:m}=t,{splittableMarks:p}=e.editor.extensionManager,v=m||f.$to.parentOffset&&f.$from.marks();if(v){const b=v.filter(y=>p.includes(y.type.name));i.ensureMarks(b)}}if(e.keepAttributes){const f=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";a().updateAttributes(f,s).run()}const d=i.doc.resolve(r.from-1).nodeBefore;d&&d.type===e.type&&Wd(i.doc,r.from-1)&&(!e.joinPredicate||e.joinPredicate(n,d))&&i.join(r.from-1)},undoable:e.undoable})}function sFe(e,t){const{selection:r}=e,{$from:n}=r;if(r instanceof Ft){const s=n.index();return n.parent.canReplaceWith(s,s+1,t)}let a=n.depth;for(;a>=0;){const s=n.index(a);if(n.node(a).contentMatchAt(s).matchType(t))return!0;a-=1}return!1}function iFe(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var oFe={};N9(oFe,{createAtomBlockMarkdownSpec:()=>lFe,createBlockMarkdownSpec:()=>cFe,createInlineMarkdownSpec:()=>fFe,parseAttributes:()=>L9,parseIndentedBlocks:()=>RR,renderNestedMarkdownContent:()=>I9,serializeAttributes:()=>O9});function L9(e){if(!e?.trim())return{};const t={},r=[],n=e.replace(/["']([^"']*)["']/g,u=>(r.push(u),`__QUOTED_${r.length-1}__`)),a=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(a){const u=a.map(d=>d.trim().slice(1));t.class=u.join(" ")}const s=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(t.id=s[1]);const i=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(i)).forEach(([,u,d])=>{var f;const m=parseInt(((f=d.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),p=r[m];p&&(t[u]=p.slice(1,-1))});const c=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return c&&c.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(t[d]=!0)}),t}function O9(e){if(!e||Object.keys(e).length===0)return"";const t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(n=>t.push(`.${n}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?t.push(r):n!==!1&&n!=null&&t.push(`${r}="${String(n)}"`))}),t.join(" ")}function lFe(e){const{nodeName:t,name:r,parseAttributes:n=L9,serializeAttributes:a=O9,defaultAttributes:s={},requiredAttributes:i=[],allowedAttributes:l}=e,c=r||t,u=d=>{if(!l)return d;const f={};return l.forEach(m=>{m in d&&(f[m]=d[m])}),f};return{parseMarkdown:(d,f)=>{const m={...s,...d.attributes};return f.createNode(t,m,[])},markdownTokenizer:{name:t,level:"block",start(d){var f;const m=new RegExp(`^:::${c}(?:\\s|$)`,"m"),p=(f=d.match(m))==null?void 0:f.index;return p!==void 0?p:-1},tokenize(d,f,m){const p=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),v=d.match(p);if(!v)return;const b=v[1]||"",y=n(b);if(!i.find(_=>!(_ in y)))return{type:t,raw:v[0],attributes:y}}},renderMarkdown:d=>{const f=u(d.attrs||{}),m=a(f),p=m?` {${m}}`:"";return`:::${c}${p} :::`}}}function cFe(e){const{nodeName:t,name:r,getContent:n,parseAttributes:a=L9,serializeAttributes:s=O9,defaultAttributes:i={},content:l="block",allowedAttributes:c}=e,u=r||t,d=f=>{if(!c)return f;const m={};return c.forEach(p=>{p in f&&(m[p]=f[p])}),m};return{parseMarkdown:(f,m)=>{let p;if(n){const b=n(f);p=typeof b=="string"?[{type:"text",text:b}]:b}else l==="block"?p=m.parseChildren(f.tokens||[]):p=m.parseInline(f.tokens||[]);const v={...i,...f.attributes};return m.createNode(t,v,p)},markdownTokenizer:{name:t,level:"block",start(f){var m;const p=new RegExp(`^:::${u}`,"m"),v=(m=f.match(p))==null?void 0:m.index;return v!==void 0?v:-1},tokenize(f,m,p){var v;const b=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),y=f.match(b);if(!y)return;const[S,_=""]=y,N=a(_);let k=1;const j=S.length;let E="";const T=/^:::([\w-]*)(\s.*)?/gm,O=f.slice(j);for(T.lastIndex=0;;){const R=T.exec(O);if(R===null)break;const H=R.index,$=R[1];if(!((v=R[2])!=null&&v.endsWith(":::"))){if($)k+=1;else if(k-=1,k===0){const L=O.slice(0,H);E=L.trim();const A=f.slice(0,j+H+R[0].length);let M=[];if(E)if(l==="block")for(M=p.blockTokens(L),M.forEach(P=>{P.text&&(!P.tokens||P.tokens.length===0)&&(P.tokens=p.inlineTokens(P.text))});M.length>0;){const P=M[M.length-1];if(P.type==="paragraph"&&(!P.text||P.text.trim()===""))M.pop();else break}else M=p.inlineTokens(E);return{type:t,raw:A,attributes:N,content:E,tokens:M}}}}}},renderMarkdown:(f,m)=>{const p=d(f.attrs||{}),v=s(p),b=v?` {${v}}`:"",y=m.renderChildren(f.content||[],`

`);return`:::${u}${b}

${y}

:::`}}}function uFe(e){if(!e.trim())return{};const t={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(e);for(;n!==null;){const[,a,s,i]=n;t[a]=s||i,n=r.exec(e)}return t}function dFe(e){return Object.entries(e).filter(([,t])=>t!=null).map(([t,r])=>`${t}="${r}"`).join(" ")}function fFe(e){const{nodeName:t,name:r,getContent:n,parseAttributes:a=uFe,serializeAttributes:s=dFe,defaultAttributes:i={},selfClosing:l=!1,allowedAttributes:c}=e,u=r||t,d=m=>{if(!c)return m;const p={};return c.forEach(v=>{const b=typeof v=="string"?v:v.name,y=typeof v=="string"?void 0:v.skipIfDefault;if(b in m){const S=m[b];if(y!==void 0&&S===y)return;p[b]=S}}),p},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(m,p)=>{const v={...i,...m.attributes};if(l)return p.createNode(t,v);const b=n?n(m):m.content||"";return b?p.createNode(t,v,[p.createTextNode(b)]):p.createNode(t,v,[])},markdownTokenizer:{name:t,level:"inline",start(m){const p=l?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),v=m.match(p),b=v?.index;return b!==void 0?b:-1},tokenize(m,p,v){const b=l?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),y=m.match(b);if(!y)return;let S="",_="";if(l){const[,k]=y;_=k}else{const[,k,j]=y;_=k,S=j||""}const N=a(_.trim());return{type:t,raw:y[0],content:S.trim(),attributes:N}}},renderMarkdown:m=>{let p="";n?p=n(m):m.content&&m.content.length>0&&(p=m.content.filter(S=>S.type==="text").map(S=>S.text).join(""));const v=d(m.attrs||{}),b=s(v),y=b?` ${b}`:"";return l?`[${u}${y}]`:`[${u}${y}]${p}[/${u}]`}}}function RR(e,t,r){var n,a,s,i;const l=e.split(`
`),c=[];let u="",d=0;const f=t.baseIndentSize||2;for(;d<l.length;){const m=l[d],p=m.match(t.itemPattern);if(!p){if(c.length>0)break;if(m.trim()===""){d+=1,u=`${u}${m}
`;continue}else return}const v=t.extractItemData(p),{indentLevel:b,mainContent:y}=v;u=`${u}${m}
`;const S=[y];for(d+=1;d<l.length;){const j=l[d];if(j.trim()===""){const T=l.slice(d+1).findIndex(H=>H.trim()!=="");if(T===-1)break;if((((a=(n=l[d+1+T].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:a.length)||0)>b){S.push(j),u=`${u}${j}
`,d+=1;continue}else break}if((((i=(s=j.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:i.length)||0)>b)S.push(j),u=`${u}${j}
`,d+=1;else break}let _;const N=S.slice(1);if(N.length>0){const j=N.map(E=>E.slice(b+f)).join(`
`);j.trim()&&(t.customNestedParser?_=t.customNestedParser(j):_=r.blockTokens(j))}const k=t.createToken(v,_);c.push(k)}if(c.length!==0)return{items:c,raw:u}}function I9(e,t,r,n){if(!e||!Array.isArray(e.content))return"";const a=typeof r=="function"?r(n):r,[s,...i]=e.content,l=t.renderChildren([s]),c=[`${a}${l}`];return i&&i.length>0&&i.forEach(u=>{const d=t.renderChildren([u]);if(d){const f=d.split(`
`).map(m=>m?t.indent(m):"").join(`
`);c.push(f)}}),c.join(`
`)}function hFe(e,t,r={}){const{state:n}=t,{doc:a,tr:s}=n,i=e;a.descendants((l,c)=>{const u=s.mapping.map(c),d=s.mapping.map(c)+l.nodeSize;let f=null;if(l.marks.forEach(p=>{if(p!==i)return!1;f=p}),!f)return;let m=!1;if(Object.keys(r).forEach(p=>{r[p]!==f.attrs[p]&&(m=!0)}),m){const p=e.type.create({...e.attrs,...r});s.removeMark(u,d,e.type),s.addMark(u,d,p)}}),s.docChanged&&t.view.dispatch(s)}var Fs=class zde extends D9{constructor(){super(...arguments),this.type="node"}static create(t={}){const r=typeof t=="function"?t():t;return new zde(r)}configure(t){return super.configure(t)}extend(t){const r=typeof t=="function"?t():t;return super.extend(r)}};function Mh(e){return new V8e({find:e.find,handler:({state:t,range:r,match:n,pasteEvent:a})=>{const s=Kr(e.getAttributes,void 0,n,a);if(s===!1||s===null)return null;const{tr:i}=t,l=n[n.length-1],c=n[0];let u=r.to;if(l){const d=c.search(/\S/),f=r.from+c.indexOf(l),m=f+l.length;if(T9(r.from,r.to,t.doc).filter(v=>v.mark.type.excluded.find(y=>y===e.type&&y!==v.mark.type)).filter(v=>v.to>f).length)return null;m<r.to&&i.delete(m,r.to),f>r.from&&i.delete(r.from+d,f),u=r.from+d+l.length,i.addMark(r.from+d,u,e.type.create(s||{})),i.removeStoredMark(e.type)}}})}var mFe=(...e)=>t=>{e.forEach(r=>{typeof r=="function"?r(t):r&&(r.current=t)})},pFe=({contentComponent:e})=>{const t=i9.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return o.jsx(o.Fragment,{children:Object.values(t)})};function gFe(){const e=new Set;let t={};return{subscribe(r){return e.add(r),()=>{e.delete(r)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(r,n){t={...t,[r]:rwe.createPortal(n.reactElement,n.element,r)},e.forEach(a=>a())},removeRenderer(r){const n={...t};delete n[r],t=n,e.forEach(a=>a())}}}var vFe=class extends ce.Component{constructor(e){var t;super(e),this.editorContentRef=ce.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((t=e.editor)!=null&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var e;const t=this.props.editor;if(t&&!t.isDestroyed&&((e=t.view.dom)!=null&&e.parentNode)){if(t.contentComponent)return;const r=this.editorContentRef.current;r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r}),t.contentComponent=gFe(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!((e=t.view.dom)!=null&&e.parentNode))return;const r=document.createElement("div");r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r})}catch{}}}render(){const{editor:e,innerRef:t,...r}=this.props;return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:mFe(t,this.editorContentRef),...r}),e?.contentComponent&&o.jsx(pFe,{contentComponent:e.contentComponent})]})}},bFe=w.forwardRef((e,t)=>{const r=ce.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return ce.createElement(vFe,{key:r,innerRef:t,...e})}),yFe=ce.memo(bFe),xFe=typeof window<"u"?w.useLayoutEffect:w.useEffect,wFe=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}};function SFe(e){var t;const[r]=w.useState(()=>new wFe(e.editor)),n=twe.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,e.selector,(t=e.equalityFn)!=null?t:yle);return xFe(()=>r.watch(e.editor),[e.editor,r]),w.useDebugValue(n),n}var kFe=!1,PR=typeof window>"u",_Fe=PR||!!(typeof window<"u"&&window.next),NFe=class Bde{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?PR||_Fe?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...n)=>{var a,s;return(s=(a=this.options.current).onBeforeCreate)==null?void 0:s.call(a,...n)},onBlur:(...n)=>{var a,s;return(s=(a=this.options.current).onBlur)==null?void 0:s.call(a,...n)},onCreate:(...n)=>{var a,s;return(s=(a=this.options.current).onCreate)==null?void 0:s.call(a,...n)},onDestroy:(...n)=>{var a,s;return(s=(a=this.options.current).onDestroy)==null?void 0:s.call(a,...n)},onFocus:(...n)=>{var a,s;return(s=(a=this.options.current).onFocus)==null?void 0:s.call(a,...n)},onSelectionUpdate:(...n)=>{var a,s;return(s=(a=this.options.current).onSelectionUpdate)==null?void 0:s.call(a,...n)},onTransaction:(...n)=>{var a,s;return(s=(a=this.options.current).onTransaction)==null?void 0:s.call(a,...n)},onUpdate:(...n)=>{var a,s;return(s=(a=this.options.current).onUpdate)==null?void 0:s.call(a,...n)},onContentError:(...n)=>{var a,s;return(s=(a=this.options.current).onContentError)==null?void 0:s.call(a,...n)},onDrop:(...n)=>{var a,s;return(s=(a=this.options.current).onDrop)==null?void 0:s.call(a,...n)},onPaste:(...n)=>{var a,s;return(s=(a=this.options.current).onPaste)==null?void 0:s.call(a,...n)},onDelete:(...n)=>{var a,s;return(s=(a=this.options.current).onDelete)==null?void 0:s.call(a,...n)}};return new nFe(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,r){return Object.keys(t).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&t.extensions&&r.extensions?t.extensions.length!==r.extensions.length?!1:t.extensions.every((a,s)=>{var i;return a===((i=r.extensions)==null?void 0:i[s])}):t[n]===r[n])}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?Bde.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((n,a)=>n===t[a]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===t&&this.setEditor(null))},1)}};function CFe(e={},t=[]){const r=w.useRef(e);r.current=e;const[n]=w.useState(()=>new NFe(r)),a=i9.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return w.useDebugValue(a),w.useEffect(n.onRender(t)),SFe({editor:a,selector:({transactionNumber:s})=>e.shouldRerenderOnTransaction===!1||e.shouldRerenderOnTransaction===void 0?null:e.immediatelyRender&&s===0?0:s+1}),a}var jFe=w.createContext({editor:null});jFe.Consumer;var EFe=w.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),MFe=()=>w.useContext(EFe);ce.forwardRef((e,t)=>{const{onDragStart:r}=MFe(),n=e.as||"div";return o.jsx(n,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...e.style}})});function fJ(e){return!!(typeof e=="function"&&e.prototype&&e.prototype.isReactComponent)}function hJ(e){return!!(typeof e=="object"&&e.$$typeof&&(e.$$typeof.toString()==="Symbol(react.forward_ref)"||e.$$typeof.description==="react.forward_ref"))}function TFe(e){return!!(typeof e=="object"&&e.$$typeof&&(e.$$typeof.toString()==="Symbol(react.memo)"||e.$$typeof.description==="react.memo"))}function AFe(e){if(fJ(e)||hJ(e))return!0;if(TFe(e)){const t=e.type;if(t)return fJ(t)||hJ(t)}return!1}function DFe(){try{if(w.version)return parseInt(w.version.split(".")[0],10)>=19}catch{}return!1}var R9=class{constructor(e,{editor:t,props:r={},as:n="div",className:a=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=e,this.editor=t,this.props=r,this.element=document.createElement(n),this.element.classList.add("react-renderer"),a&&this.element.classList.add(...a.split(" ")),this.editor.isInitialized?pd.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var e;if(this.destroyed)return;const t=this.component,r=this.props,n=this.editor,a=DFe(),s=AFe(t),i={...r};i.ref&&!(a||s)&&delete i.ref,!i.ref&&(a||s)&&(i.ref=l=>{this.ref=l}),this.reactElement=o.jsx(t,{...i}),(e=n?.contentComponent)==null||e.setRenderer(this.id,this)}updateProps(e={}){this.destroyed||(this.props={...this.props,...e},this.render())}destroy(){var e;this.destroyed=!0;const t=this.editor;(e=t?.contentComponent)==null||e.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}};ce.createContext({markViewContentRef:()=>{}});var wN=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);const{children:r,...n}=t??{};if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,n,r]},LFe=/^\s*>\s$/,OFe=Fs.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return wN("blockquote",{...Jn(this.options.HTMLAttributes,e),children:wN("slot",{})})},parseMarkdown:(e,t)=>t.createNode("blockquote",void 0,t.parseChildren(e.tokens||[])),renderMarkdown:(e,t)=>{if(!e.content)return"";const r=">",n=[];return e.content.forEach(a=>{const l=t.renderChildren([a]).split(`
`).map(c=>c.trim()===""?r:`${r} ${c}`);n.push(l.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Eg({find:LFe,type:this.type})]}}),IFe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,RFe=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,PFe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,zFe=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,BFe=Xh.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return wN("strong",{...Jn(this.options.HTMLAttributes,e),children:wN("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[jg({find:IFe,type:this.type}),jg({find:PFe,type:this.type})]},addPasteRules(){return[Mh({find:RFe,type:this.type}),Mh({find:zFe,type:this.type})]}}),$Fe=/(^|[^`])`([^`]+)`(?!`)$/,FFe=/(^|[^`])`([^`]+)`(?!`)/g,UFe=Xh.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[jg({find:$Fe,type:this.type})]},addPasteRules(){return[Mh({find:FFe,type:this.type})]}}),KD=4,HFe=/^```([a-z]+)?[\s\n]$/,qFe=/^~~~([a-z]+)?[\s\n]$/,WFe=Fs.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:KD,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:r}=this.options;if(!r)return null;const s=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(i=>i.startsWith(r)).map(i=>i.replace(r,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",Jn(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var r;return((r=e.raw)==null?void 0:r.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var r;let n="";const a=((r=e.attrs)==null?void 0:r.language)||"";return e.content?n=[`\`\`\`${a}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${a}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,r=t.pos===1;return!e||t.parent.type.name!==this.name?!1:r||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:KD,{state:n}=e,{selection:a}=n,{$from:s,empty:i}=a;if(s.parent.type!==this.type)return!1;const l=" ".repeat(r);return i?e.commands.insertContent(l):e.commands.command(({tr:c})=>{const{from:u,to:d}=a,p=n.doc.textBetween(u,d,`
`,`
`).split(`
`).map(v=>l+v).join(`
`);return c.replaceWith(u,d,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:KD,{state:n}=e,{selection:a}=n,{$from:s,empty:i}=a;return s.parent.type!==this.type?!1:i?e.commands.command(({tr:l})=>{var c;const{pos:u}=s,d=s.start(),f=s.end(),p=n.doc.textBetween(d,f,`
`,`
`).split(`
`);let v=0,b=0;const y=u-d;for(let E=0;E<p.length;E+=1){if(b+p[E].length>=y){v=E;break}b+=p[E].length+1}const _=((c=p[v].match(/^ */))==null?void 0:c[0])||"",N=Math.min(_.length,r);if(N===0)return!0;let k=d;for(let E=0;E<v;E+=1)k+=p[E].length+1;return l.delete(k,k+N),u-k<=N&&l.setSelection(Jt.create(l.doc,k)),!0}):e.commands.command(({tr:l})=>{const{from:c,to:u}=a,m=n.doc.textBetween(c,u,`
`,`
`).split(`
`).map(p=>{var v;const b=((v=p.match(/^ */))==null?void 0:v[0])||"",y=Math.min(b.length,r);return p.slice(y)}).join(`
`);return l.replaceWith(c,u,n.schema.text(m)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:r}=t,{$from:n,empty:a}=r;if(!a||n.parent.type!==this.type)return!1;const s=n.parentOffset===n.parent.nodeSize-2,i=n.parent.textContent.endsWith(`

`);return!s||!i?!1:e.chain().command(({tr:l})=>(l.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:r,doc:n}=t,{$from:a,empty:s}=r;if(!s||a.parent.type!==this.type||!(a.parentOffset===a.parent.nodeSize-2))return!1;const l=a.after();return l===void 0?!1:n.nodeAt(l)?e.commands.command(({tr:u})=>(u.setSelection(cr.near(n.resolve(l))),!0)):e.commands.exitCode()}}},addInputRules(){return[ex({find:HFe,type:this.type,getAttributes:e=>({language:e[1]})}),ex({find:qFe,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Hr({key:new Qr("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const r=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),a=n?JSON.parse(n):void 0,s=a?.mode;if(!r||!s)return!1;const{tr:i,schema:l}=e.state,c=l.text(r.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:s},c)),i.selection.$from.parent.type!==this.type&&i.setSelection(Jt.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),KFe=Fs.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`

`):""}),GFe=Fs.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",Jn(this.options.HTMLAttributes,e)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:r,editor:n})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:a,storedMarks:s}=r;if(a.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:l}=n.extensionManager,c=s||a.$to.parentOffset&&a.$from.marks();return t().insertContent({type:this.name}).command(({tr:u,dispatch:d})=>{if(d&&c&&i){const f=c.filter(m=>l.includes(m.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),VFe=Fs.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,Jn(this.options.HTMLAttributes,t),0]},parseMarkdown:(e,t)=>t.createNode("heading",{level:e.depth||1},t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>{var r;const n=(r=e.attrs)!=null&&r.level?parseInt(e.attrs.level,10):1,a="#".repeat(n);return e.content?`${a} ${t.renderChildren(e.content)}`:""},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>ex({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),YFe=Fs.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",Jn(this.options.HTMLAttributes,e)]},markdownTokenName:"hr",parseMarkdown:(e,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!sFe(t,t.schema.nodes[this.name]))return!1;const{selection:r}=t,{$to:n}=r,a=e();return A9(r)?a.insertContentAt(n.pos,{type:this.name}):a.insertContent({type:this.name}),a.command(({state:s,tr:i,dispatch:l})=>{if(l){const{$to:c}=i.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?i.setSelection(Jt.create(i.doc,c.pos+1)):c.nodeAfter.isBlock?i.setSelection(Ft.create(i.doc,c.pos)):i.setSelection(Jt.create(i.doc,c.pos));else{const d=s.schema.nodes[this.options.nextNodeType]||c.parent.type.contentMatch.defaultType,f=d?.create();f&&(i.insert(u,f),i.setSelection(Jt.create(i.doc,u+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[aFe({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),QFe=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,JFe=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,ZFe=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,XFe=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,eUe=Xh.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",Jn(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[jg({find:QFe,type:this.type}),jg({find:ZFe,type:this.type})]},addPasteRules(){return[Mh({find:JFe,type:this.type}),Mh({find:XFe,type:this.type})]}});const tUe="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",rUe="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",zR="numeric",BR="ascii",$R="alpha",Bb="asciinumeric",gb="alphanumeric",FR="domain",$de="emoji",nUe="scheme",aUe="slashscheme",GD="whitespace";function sUe(e,t){return e in t||(t[e]=[]),t[e]}function Zf(e,t,r){t[zR]&&(t[Bb]=!0,t[gb]=!0),t[BR]&&(t[Bb]=!0,t[$R]=!0),t[Bb]&&(t[gb]=!0),t[$R]&&(t[gb]=!0),t[gb]&&(t[FR]=!0),t[$de]&&(t[FR]=!0);for(const n in t){const a=sUe(n,r);a.indexOf(e)<0&&a.push(e)}}function iUe(e,t){const r={};for(const n in t)t[n].indexOf(e)>=0&&(r[n]=!0);return r}function Xs(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}Xs.groups={};Xs.prototype={accepts(){return!!this.t},go(e){const t=this,r=t.j[e];if(r)return r;for(let n=0;n<t.jr.length;n++){const a=t.jr[n][0],s=t.jr[n][1];if(s&&a.test(e))return s}return t.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,r,n){for(let a=0;a<e.length;a++)this.tt(e[a],t,r,n)},tr(e,t,r,n){n=n||Xs.groups;let a;return t&&t.j?a=t:(a=new Xs(t),r&&n&&Zf(t,r,n)),this.jr.push([e,a]),a},ts(e,t,r,n){let a=this;const s=e.length;if(!s)return a;for(let i=0;i<s-1;i++)a=a.tt(e[i]);return a.tt(e[s-1],t,r,n)},tt(e,t,r,n){n=n||Xs.groups;const a=this;if(t&&t.j)return a.j[e]=t,t;const s=t;let i,l=a.go(e);if(l?(i=new Xs,Object.assign(i.j,l.j),i.jr.push.apply(i.jr,l.jr),i.jd=l.jd,i.t=l.t):i=new Xs,s){if(n)if(i.t&&typeof i.t=="string"){const c=Object.assign(iUe(i.t,n),r);Zf(s,c,n)}else r&&Zf(s,r,n);i.t=s}return a.j[e]=i,i}};const hr=(e,t,r,n,a)=>e.ta(t,r,n,a),Hn=(e,t,r,n,a)=>e.tr(t,r,n,a),mJ=(e,t,r,n,a)=>e.ts(t,r,n,a),Ze=(e,t,r,n,a)=>e.tt(t,r,n,a),Lc="WORD",UR="UWORD",Fde="ASCIINUMERICAL",Ude="ALPHANUMERICAL",tx="LOCALHOST",HR="TLD",qR="UTLD",kk="SCHEME",bp="SLASH_SCHEME",P9="NUM",WR="WS",z9="NL",$b="OPENBRACE",Fb="CLOSEBRACE",SN="OPENBRACKET",kN="CLOSEBRACKET",_N="OPENPAREN",NN="CLOSEPAREN",CN="OPENANGLEBRACKET",jN="CLOSEANGLEBRACKET",EN="FULLWIDTHLEFTPAREN",MN="FULLWIDTHRIGHTPAREN",TN="LEFTCORNERBRACKET",AN="RIGHTCORNERBRACKET",DN="LEFTWHITECORNERBRACKET",LN="RIGHTWHITECORNERBRACKET",ON="FULLWIDTHLESSTHAN",IN="FULLWIDTHGREATERTHAN",RN="AMPERSAND",PN="APOSTROPHE",zN="ASTERISK",id="AT",BN="BACKSLASH",$N="BACKTICK",FN="CARET",fd="COLON",B9="COMMA",UN="DOLLAR",ml="DOT",HN="EQUALS",$9="EXCLAMATION",co="HYPHEN",Ub="PERCENT",qN="PIPE",WN="PLUS",KN="POUND",Hb="QUERY",F9="QUOTE",Hde="FULLWIDTHMIDDLEDOT",U9="SEMI",pl="SLASH",qb="TILDE",GN="UNDERSCORE",qde="EMOJI",VN="SYM";var Wde=Object.freeze({__proto__:null,ALPHANUMERICAL:Ude,AMPERSAND:RN,APOSTROPHE:PN,ASCIINUMERICAL:Fde,ASTERISK:zN,AT:id,BACKSLASH:BN,BACKTICK:$N,CARET:FN,CLOSEANGLEBRACKET:jN,CLOSEBRACE:Fb,CLOSEBRACKET:kN,CLOSEPAREN:NN,COLON:fd,COMMA:B9,DOLLAR:UN,DOT:ml,EMOJI:qde,EQUALS:HN,EXCLAMATION:$9,FULLWIDTHGREATERTHAN:IN,FULLWIDTHLEFTPAREN:EN,FULLWIDTHLESSTHAN:ON,FULLWIDTHMIDDLEDOT:Hde,FULLWIDTHRIGHTPAREN:MN,HYPHEN:co,LEFTCORNERBRACKET:TN,LEFTWHITECORNERBRACKET:DN,LOCALHOST:tx,NL:z9,NUM:P9,OPENANGLEBRACKET:CN,OPENBRACE:$b,OPENBRACKET:SN,OPENPAREN:_N,PERCENT:Ub,PIPE:qN,PLUS:WN,POUND:KN,QUERY:Hb,QUOTE:F9,RIGHTCORNERBRACKET:AN,RIGHTWHITECORNERBRACKET:LN,SCHEME:kk,SEMI:U9,SLASH:pl,SLASH_SCHEME:bp,SYM:VN,TILDE:qb,TLD:HR,UNDERSCORE:GN,UTLD:qR,UWORD:UR,WORD:Lc,WS:WR});const vc=/[a-z]/,Ev=/\p{L}/u,VD=/\p{Emoji}/u,bc=/\d/,YD=/\s/,pJ="\r",QD=`
`,oUe="",lUe="",JD="";let bS=null,yS=null;function cUe(e=[]){const t={};Xs.groups=t;const r=new Xs;bS==null&&(bS=gJ(tUe)),yS==null&&(yS=gJ(rUe)),Ze(r,"'",PN),Ze(r,"{",$b),Ze(r,"}",Fb),Ze(r,"[",SN),Ze(r,"]",kN),Ze(r,"(",_N),Ze(r,")",NN),Ze(r,"<",CN),Ze(r,">",jN),Ze(r,"",EN),Ze(r,"",MN),Ze(r,"",TN),Ze(r,"",AN),Ze(r,"",DN),Ze(r,"",LN),Ze(r,"",ON),Ze(r,"",IN),Ze(r,"&",RN),Ze(r,"*",zN),Ze(r,"@",id),Ze(r,"`",$N),Ze(r,"^",FN),Ze(r,":",fd),Ze(r,",",B9),Ze(r,"$",UN),Ze(r,".",ml),Ze(r,"=",HN),Ze(r,"!",$9),Ze(r,"-",co),Ze(r,"%",Ub),Ze(r,"|",qN),Ze(r,"+",WN),Ze(r,"#",KN),Ze(r,"?",Hb),Ze(r,'"',F9),Ze(r,"/",pl),Ze(r,";",U9),Ze(r,"~",qb),Ze(r,"_",GN),Ze(r,"\\",BN),Ze(r,"",Hde);const n=Hn(r,bc,P9,{[zR]:!0});Hn(n,bc,n);const a=Hn(n,vc,Fde,{[Bb]:!0}),s=Hn(n,Ev,Ude,{[gb]:!0}),i=Hn(r,vc,Lc,{[BR]:!0});Hn(i,bc,a),Hn(i,vc,i),Hn(a,bc,a),Hn(a,vc,a);const l=Hn(r,Ev,UR,{[$R]:!0});Hn(l,vc),Hn(l,bc,s),Hn(l,Ev,l),Hn(s,bc,s),Hn(s,vc),Hn(s,Ev,s);const c=Ze(r,QD,z9,{[GD]:!0}),u=Ze(r,pJ,WR,{[GD]:!0}),d=Hn(r,YD,WR,{[GD]:!0});Ze(r,JD,d),Ze(u,QD,c),Ze(u,JD,d),Hn(u,YD,d),Ze(d,pJ),Ze(d,QD),Hn(d,YD,d),Ze(d,JD,d);const f=Hn(r,VD,qde,{[$de]:!0});Ze(f,"#"),Hn(f,VD,f),Ze(f,oUe,f);const m=Ze(f,lUe);Ze(m,"#"),Hn(m,VD,f);const p=[[vc,i],[bc,a]],v=[[vc,null],[Ev,l],[bc,s]];for(let b=0;b<bS.length;b++)Gu(r,bS[b],HR,Lc,p);for(let b=0;b<yS.length;b++)Gu(r,yS[b],qR,UR,v);Zf(HR,{tld:!0,ascii:!0},t),Zf(qR,{utld:!0,alpha:!0},t),Gu(r,"file",kk,Lc,p),Gu(r,"mailto",kk,Lc,p),Gu(r,"http",bp,Lc,p),Gu(r,"https",bp,Lc,p),Gu(r,"ftp",bp,Lc,p),Gu(r,"ftps",bp,Lc,p),Zf(kk,{scheme:!0,ascii:!0},t),Zf(bp,{slashscheme:!0,ascii:!0},t),e=e.sort((b,y)=>b[0]>y[0]?1:-1);for(let b=0;b<e.length;b++){const y=e[b][0],_=e[b][1]?{[nUe]:!0}:{[aUe]:!0};y.indexOf("-")>=0?_[FR]=!0:vc.test(y)?bc.test(y)?_[Bb]=!0:_[BR]=!0:_[zR]=!0,mJ(r,y,y,_)}return mJ(r,"localhost",tx,{ascii:!0}),r.jd=new Xs(VN),{start:r,tokens:Object.assign({groups:t},Wde)}}function Kde(e,t){const r=uUe(t.replace(/[A-Z]/g,l=>l.toLowerCase())),n=r.length,a=[];let s=0,i=0;for(;i<n;){let l=e,c=null,u=0,d=null,f=-1,m=-1;for(;i<n&&(c=l.go(r[i]));)l=c,l.accepts()?(f=0,m=0,d=l):f>=0&&(f+=r[i].length,m++),u+=r[i].length,s+=r[i].length,i++;s-=f,i-=m,u-=f,a.push({t:d.t,v:t.slice(s-u,s),s:s-u,e:s})}return a}function uUe(e){const t=[],r=e.length;let n=0;for(;n<r;){let a=e.charCodeAt(n),s,i=a<55296||a>56319||n+1===r||(s=e.charCodeAt(n+1))<56320||s>57343?e[n]:e.slice(n,n+2);t.push(i),n+=i.length}return t}function Gu(e,t,r,n,a){let s;const i=t.length;for(let l=0;l<i-1;l++){const c=t[l];e.j[c]?s=e.j[c]:(s=new Xs(n),s.jr=a.slice(),e.j[c]=s),e=s}return s=new Xs(r),s.jr=a.slice(),e.j[t[i-1]]=s,s}function gJ(e){const t=[],r=[];let n=0,a="0123456789";for(;n<e.length;){let s=0;for(;a.indexOf(e[n+s])>=0;)s++;if(s>0){t.push(r.join(""));for(let i=parseInt(e.substring(n,n+s),10);i>0;i--)r.pop();n+=s}else r.push(e[n]),n++}return t}const rx={defaultProtocol:"http",events:null,format:vJ,formatHref:vJ,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function H9(e,t=null){let r=Object.assign({},rx);e&&(r=Object.assign(r,e instanceof H9?e.o:e));const n=r.ignoreTags,a=[];for(let s=0;s<n.length;s++)a.push(n[s].toUpperCase());this.o=r,t&&(this.defaultRender=t),this.ignoreTags=a}H9.prototype={o:rx,ignoreTags:[],defaultRender(e){return e},check(e){return this.get("validate",e.toString(),e)},get(e,t,r){const n=t!=null;let a=this.o[e];return a&&(typeof a=="object"?(a=r.t in a?a[r.t]:rx[e],typeof a=="function"&&n&&(a=a(t,r))):typeof a=="function"&&n&&(a=a(t,r.t,r)),a)},getObj(e,t,r){let n=this.o[e];return typeof n=="function"&&t!=null&&(n=n(t,r.t,r)),n},render(e){const t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}};function vJ(e){return e}function Gde(e,t){this.t="token",this.v=e,this.tk=t}Gde.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){const t=this.toString(),r=e.get("truncate",t,this),n=e.get("format",t,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=rx.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){const t=this,r=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",r,this),a=e.get("tagName",r,t),s=this.toFormattedString(e),i={},l=e.get("className",r,t),c=e.get("target",r,t),u=e.get("rel",r,t),d=e.getObj("attributes",r,t),f=e.getObj("events",r,t);return i.href=n,l&&(i.class=l),c&&(i.target=c),u&&(i.rel=u),d&&Object.assign(i,d),{tagName:a,attributes:i,content:s,eventListeners:f}}};function o2(e,t){class r extends Gde{constructor(a,s){super(a,s),this.t=e}}for(const n in t)r.prototype[n]=t[n];return r.t=e,r}const bJ=o2("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),yJ=o2("text"),dUe=o2("nl"),xS=o2("url",{isLink:!0,toHref(e=rx.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){const e=this.tk;return e.length>=2&&e[0].t!==tx&&e[1].t===fd}}),ro=e=>new Xs(e);function fUe({groups:e}){const t=e.domain.concat([RN,zN,id,BN,$N,FN,UN,HN,co,P9,Ub,qN,WN,KN,pl,VN,qb,GN]),r=[PN,fd,B9,ml,$9,Ub,Hb,F9,U9,CN,jN,$b,Fb,kN,SN,_N,NN,EN,MN,TN,AN,DN,LN,ON,IN],n=[RN,PN,zN,BN,$N,FN,UN,HN,co,$b,Fb,Ub,qN,WN,KN,Hb,pl,VN,qb,GN],a=ro(),s=Ze(a,qb);hr(s,n,s),hr(s,e.domain,s);const i=ro(),l=ro(),c=ro();hr(a,e.domain,i),hr(a,e.scheme,l),hr(a,e.slashscheme,c),hr(i,n,s),hr(i,e.domain,i);const u=Ze(i,id);Ze(s,id,u),Ze(l,id,u),Ze(c,id,u);const d=Ze(s,ml);hr(d,n,s),hr(d,e.domain,s);const f=ro();hr(u,e.domain,f),hr(f,e.domain,f);const m=Ze(f,ml);hr(m,e.domain,f);const p=ro(bJ);hr(m,e.tld,p),hr(m,e.utld,p),Ze(u,tx,p);const v=Ze(f,co);Ze(v,co,v),hr(v,e.domain,f),hr(p,e.domain,f),Ze(p,ml,m),Ze(p,co,v);const b=Ze(p,fd);hr(b,e.numeric,bJ);const y=Ze(i,co),S=Ze(i,ml);Ze(y,co,y),hr(y,e.domain,i),hr(S,n,s),hr(S,e.domain,i);const _=ro(xS);hr(S,e.tld,_),hr(S,e.utld,_),hr(_,e.domain,i),hr(_,n,s),Ze(_,ml,S),Ze(_,co,y),Ze(_,id,u);const N=Ze(_,fd),k=ro(xS);hr(N,e.numeric,k);const j=ro(xS),E=ro();hr(j,t,j),hr(j,r,E),hr(E,t,j),hr(E,r,E),Ze(_,pl,j),Ze(k,pl,j);const T=Ze(l,fd),O=Ze(c,fd),R=Ze(O,pl),H=Ze(R,pl);hr(l,e.domain,i),Ze(l,ml,S),Ze(l,co,y),hr(c,e.domain,i),Ze(c,ml,S),Ze(c,co,y),hr(T,e.domain,j),Ze(T,pl,j),Ze(T,Hb,j),hr(H,e.domain,j),hr(H,t,j),Ze(H,pl,j);const $=[[$b,Fb],[SN,kN],[_N,NN],[CN,jN],[EN,MN],[TN,AN],[DN,LN],[ON,IN]];for(let L=0;L<$.length;L++){const[A,M]=$[L],P=Ze(j,A);Ze(E,A,P),Ze(P,M,j);const I=ro(xS);hr(P,t,I);const B=ro();hr(P,r),hr(I,t,I),hr(I,r,B),hr(B,t,I),hr(B,r,B),Ze(I,M,j),Ze(B,M,j)}return Ze(a,tx,_),Ze(a,z9,dUe),{start:a,tokens:Wde}}function hUe(e,t,r){let n=r.length,a=0,s=[],i=[];for(;a<n;){let l=e,c=null,u=null,d=0,f=null,m=-1;for(;a<n&&!(c=l.go(r[a].t));)i.push(r[a++]);for(;a<n&&(u=c||l.go(r[a].t));)c=null,l=u,l.accepts()?(m=0,f=l):m>=0&&m++,a++,d++;if(m<0)a-=d,a<n&&(i.push(r[a]),a++);else{i.length>0&&(s.push(ZD(yJ,t,i)),i=[]),a-=m,d-=m;const p=f.t,v=r.slice(a-d,a);s.push(ZD(p,t,v))}}return i.length>0&&s.push(ZD(yJ,t,i)),s}function ZD(e,t,r){const n=r[0].s,a=r[r.length-1].e,s=t.slice(n,a);return new e(s,r)}const mUe=typeof console<"u"&&console&&console.warn||(()=>{}),pUe="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",_n={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function gUe(){return Xs.groups={},_n.scanner=null,_n.parser=null,_n.tokenQueue=[],_n.pluginQueue=[],_n.customSchemes=[],_n.initialized=!1,_n}function xJ(e,t=!1){if(_n.initialized&&mUe(`linkifyjs: already initialized - will not register custom scheme "${e}" ${pUe}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);_n.customSchemes.push([e,t])}function vUe(){_n.scanner=cUe(_n.customSchemes);for(let e=0;e<_n.tokenQueue.length;e++)_n.tokenQueue[e][1]({scanner:_n.scanner});_n.parser=fUe(_n.scanner.tokens);for(let e=0;e<_n.pluginQueue.length;e++)_n.pluginQueue[e][1]({scanner:_n.scanner,parser:_n.parser});return _n.initialized=!0,_n}function q9(e){return _n.initialized||vUe(),hUe(_n.parser.start,e,Kde(_n.scanner.start,e))}q9.scan=Kde;function Vde(e,t=null,r=null){if(t&&typeof t=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);r=t,t=null}const n=new H9(r),a=q9(e),s=[];for(let i=0;i<a.length;i++){const l=a[i];l.isLink&&(!t||l.t===t)&&n.check(l)&&s.push(l.toFormattedObject(n))}return s}var W9="[\0- -\u2029]",bUe=new RegExp(W9),yUe=new RegExp(`${W9}$`),xUe=new RegExp(W9,"g");function wUe(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function SUe(e){return new Hr({key:new Qr("autolink"),appendTransaction:(t,r,n)=>{const a=t.some(u=>u.docChanged)&&!r.doc.eq(n.doc),s=t.some(u=>u.getMeta("preventAutolink"));if(!a||s)return;const{tr:i}=n,l=mde(r.doc,[...t]);if(wde(l).forEach(({newRange:u})=>{const d=s8e(n.doc,u,p=>p.isTextblock);let f,m;if(d.length>1)f=d[0],m=n.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(d.length){const p=n.doc.textBetween(u.from,u.to," "," ");if(!yUe.test(p))return;f=d[0],m=n.doc.textBetween(f.pos,u.to,void 0," ")}if(f&&m){const p=m.split(bUe).filter(Boolean);if(p.length<=0)return!1;const v=p[p.length-1],b=f.pos+m.lastIndexOf(v);if(!v)return!1;const y=q9(v).map(S=>S.toObject(e.defaultProtocol));if(!wUe(y))return!1;y.filter(S=>S.isLink).map(S=>({...S,from:b+S.start+1,to:b+S.end+1})).filter(S=>n.schema.marks.code?!n.doc.rangeHasMark(S.from,S.to,n.schema.marks.code):!0).filter(S=>e.validate(S.value)).filter(S=>e.shouldAutoLink(S.value)).forEach(S=>{T9(S.from,S.to,n.doc).some(_=>_.mark.type===e.type)||i.addMark(S.from,S.to,e.type.create({href:S.href}))})}}),!!i.steps.length)return i}})}function kUe(e){return new Hr({key:new Qr("handleClickLink"),props:{handleClick:(t,r,n)=>{var a,s;if(n.button!==0||!t.editable)return!1;let i=null;if(n.target instanceof HTMLAnchorElement)i=n.target;else{const c=n.target;if(!c)return!1;const u=e.editor.view.dom;i=c.closest("a"),i&&!u.contains(i)&&(i=null)}if(!i)return!1;let l=!1;if(e.enableClickSelection&&(l=e.editor.commands.extendMarkRange(e.type.name)),e.openOnClick){const c=xde(t.state,e.type.name),u=(a=i.href)!=null?a:c.href,d=(s=i.target)!=null?s:c.target;u&&(window.open(u,d),l=!0)}return l}}})}function _Ue(e){return new Hr({key:new Qr("handlePasteLink"),props:{handlePaste:(t,r,n)=>{const{shouldAutoLink:a}=e,{state:s}=t,{selection:i}=s,{empty:l}=i;if(l)return!1;let c="";n.content.forEach(d=>{c+=d.textContent});const u=Vde(c,{defaultProtocol:e.defaultProtocol}).find(d=>d.isLink&&d.value===c);return!c||!u||a!==void 0&&!a(u.value)?!1:e.editor.commands.setMark(e.type,{href:u.href})}}})}function vf(e,t){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(n=>{const a=typeof n=="string"?n:n.scheme;a&&r.push(a)}),!e||e.replace(xUe,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var Yde=Xh.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){xJ(e);return}xJ(e.scheme,e.optionalSlashes)})},onDestroy(){gUe()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!vf(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(e),r=/^[a-z][a-z0-9+.-]*:/i.test(e);if(t||r&&!e.includes("@"))return!0;const a=(e.includes("@")?e.split("@").pop():e).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(a)||!/\./.test(a))}}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:r=>!!vf(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!vf(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Jn(this.options.HTMLAttributes,e),0]:["a",Jn(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var r;const n=((r=e.attrs)==null?void 0:r.href)||"";return`[${t.renderChildren(e)}](${n})`},addCommands(){return{setLink:e=>({chain:t})=>{const{href:r}=e;return this.options.isAllowedUri(r,{defaultValidate:n=>!!vf(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:r}=e||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!vf(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Mh({find:e=>{const t=[];if(e){const{protocols:r,defaultProtocol:n}=this.options,a=Vde(e).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:i=>!!vf(i,r),protocols:r,defaultProtocol:n}));a.length&&a.forEach(s=>{this.options.shouldAutoLink(s.value)&&t.push({text:s.value,data:{href:s.href},index:s.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:r}=this.options;return this.options.autolink&&e.push(SUe({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:a=>!!vf(a,t),protocols:t,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),e.push(kUe({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(_Ue({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),e}}),NUe=Yde,CUe=Object.defineProperty,jUe=(e,t)=>{for(var r in t)CUe(e,r,{get:t[r],enumerable:!0})},EUe="listItem",wJ="textStyle",SJ=/^\s*([-+*])\s$/,Qde=Fs.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>e.type!=="list"||e.ordered?[]:{type:"bulletList",content:e.items?t.parseChildren(e.items):[]},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(EUe,this.editor.getAttributes(wJ)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=Eg({find:SJ,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Eg({find:SJ,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(wJ),editor:this.editor})),[e]}}),Jde=Fs.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list_item",parseMarkdown:(e,t)=>{if(e.type!=="list_item")return[];let r=[];if(e.tokens&&e.tokens.length>0)if(e.tokens.some(a=>a.type==="paragraph"))r=t.parseChildren(e.tokens);else{const a=e.tokens[0];if(a&&a.type==="text"&&a.tokens&&a.tokens.length>0){if(r=[{type:"paragraph",content:t.parseInline(a.tokens)}],e.tokens.length>1){const i=e.tokens.slice(1),l=t.parseChildren(i);r.push(...l)}}else r=t.parseChildren(e.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(e,t,r)=>I9(e,t,n=>{var a,s;return n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${(((s=(a=n.meta)==null?void 0:a.parentAttrs)==null?void 0:s.start)||1)+n.index}. `:"- "},r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),MUe={};jUe(MUe,{findListItemPos:()=>i1,getNextListDepth:()=>K9,handleBackspace:()=>KR,handleDelete:()=>GR,hasListBefore:()=>Zde,hasListItemAfter:()=>TUe,hasListItemBefore:()=>Xde,listItemHasSubList:()=>efe,nextListIsDeeper:()=>tfe,nextListIsHigher:()=>rfe});var i1=(e,t)=>{const{$from:r}=t.selection,n=ba(e,t.schema);let a=null,s=r.depth,i=r.pos,l=null;for(;s>0&&l===null;)a=r.node(s),a.type===n?l=s:(s-=1,i-=1);return l===null?null:{$pos:t.doc.resolve(i),depth:l}},K9=(e,t)=>{const r=i1(e,t);if(!r)return!1;const[,n]=p8e(t,e,r.$pos.pos+4);return n},Zde=(e,t,r)=>{const{$anchor:n}=e.selection,a=Math.max(0,n.pos-2),s=e.doc.resolve(a).node();return!(!s||!r.includes(s.type.name))},Xde=(e,t)=>{var r;const{$anchor:n}=t.selection,a=t.doc.resolve(n.pos-2);return!(a.index()===0||((r=a.nodeBefore)==null?void 0:r.type.name)!==e)},efe=(e,t,r)=>{if(!r)return!1;const n=ba(e,t.schema);let a=!1;return r.descendants(s=>{s.type===n&&(a=!0)}),a},KR=(e,t,r)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!Pd(e.state,t)&&Zde(e.state,t,r)){const{$anchor:l}=e.state.selection,c=e.state.doc.resolve(l.before()-1),u=[];c.node().descendants((m,p)=>{m.type.name===t&&u.push({node:m,pos:p})});const d=u.at(-1);if(!d)return!1;const f=e.state.doc.resolve(c.start()+d.pos+1);return e.chain().cut({from:l.start()-1,to:l.end()+1},f.end()).joinForward().run()}if(!Pd(e.state,t)||!y8e(e.state))return!1;const n=i1(t,e.state);if(!n)return!1;const s=e.state.doc.resolve(n.$pos.pos-2).node(n.depth),i=efe(t,e.state,s);return Xde(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},tfe=(e,t)=>{const r=K9(e,t),n=i1(e,t);return!n||!r?!1:r>n.depth},rfe=(e,t)=>{const r=K9(e,t),n=i1(e,t);return!n||!r?!1:r<n.depth},GR=(e,t)=>{if(!Pd(e.state,t)||!b8e(e.state,t))return!1;const{selection:r}=e.state,{$from:n,$to:a}=r;return!r.empty&&n.sameParent(a)?!1:tfe(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():rfe(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},TUe=(e,t)=>{var r;const{$anchor:n}=t.selection,a=t.doc.resolve(n.pos-n.parentOffset-2);return!(a.index()===a.parent.childCount-1||((r=a.nodeAfter)==null?void 0:r.type.name)!==e)},nfe=Br.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&GR(e,r)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r})=>{e.state.schema.nodes[r]!==void 0&&GR(e,r)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&KR(e,r,n)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{e.state.schema.nodes[r]!==void 0&&KR(e,r,n)&&(t=!0)}),t}}}}),kJ=/^(\s*)(\d+)\.\s+(.*)$/,AUe=/^\s/;function DUe(e){const t=[];let r=0,n=0;for(;r<e.length;){const a=e[r],s=a.match(kJ);if(!s)break;const[,i,l,c]=s,u=i.length;let d=c,f=r+1;const m=[a];for(;f<e.length;){const p=e[f];if(p.match(kJ))break;if(p.trim()==="")m.push(p),d+=`
`,f+=1;else if(p.match(AUe))m.push(p),d+=`
${p.slice(u+2)}`,f+=1;else break}t.push({indent:u,number:parseInt(l,10),content:d.trim(),raw:m.join(`
`)}),n=f,r=f}return[t,n]}function afe(e,t,r){var n;const a=[];let s=0;for(;s<e.length;){const i=e[s];if(i.indent===t){const l=i.content.split(`
`),c=((n=l[0])==null?void 0:n.trim())||"",u=[];c&&u.push({type:"paragraph",raw:c,tokens:r.inlineTokens(c)});const d=l.slice(1).join(`
`).trim();if(d){const p=r.blockTokens(d);u.push(...p)}let f=s+1;const m=[];for(;f<e.length&&e[f].indent>t;)m.push(e[f]),f+=1;if(m.length>0){const p=Math.min(...m.map(b=>b.indent)),v=afe(m,p,r);u.push({type:"list",ordered:!0,start:m[0].number,items:v,raw:m.map(b=>b.raw).join(`
`)})}a.push({type:"list_item",raw:i.raw,tokens:u}),s=f}else s+=1}return a}function LUe(e,t){return e.map(r=>{if(r.type!=="list_item")return t.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(a=>{if(a.type==="paragraph"||a.type==="list"||a.type==="blockquote"||a.type==="code")n.push(...t.parseChildren([a]));else if(a.type==="text"&&a.tokens){const s=t.parseChildren([a]);n.push({type:"paragraph",content:s})}else{const s=t.parseChildren([a]);s.length>0&&n.push(...s)}}),{type:"listItem",content:n}})}var OUe="listItem",_J="textStyle",NJ=/^(\d+)\.\s$/,sfe=Fs.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...r}=e;return t===1?["ol",Jn(this.options.HTMLAttributes,r),0]:["ol",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"list",parseMarkdown:(e,t)=>{if(e.type!=="list"||!e.ordered)return[];const r=e.start||1,n=e.items?LUe(e.items,t):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:e=>{const t=e.match(/^(\s*)(\d+)\.\s+/),r=t?.index;return r!==void 0?r:-1},tokenize:(e,t,r)=>{var n;const a=e.split(`
`),[s,i]=DUe(a);if(s.length===0)return;const l=afe(s,0,r);return l.length===0?void 0:{type:"list",ordered:!0,start:((n=s[0])==null?void 0:n.number)||1,items:l,raw:a.slice(0,i).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(OUe,this.editor.getAttributes(_J)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=Eg({find:NJ,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Eg({find:NJ,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(_J)}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1],editor:this.editor})),[e]}}),IUe=/^\s*(\[([( |x])?\])\s$/,RUe=Fs.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",Jn(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(e,t)=>{const r=[];if(e.tokens&&e.tokens.length>0?r.push(t.createNode("paragraph",{},t.parseInline(e.tokens))):e.text?r.push(t.createNode("paragraph",{},[t.createNode("text",{text:e.text})])):r.push(t.createNode("paragraph",{},[])),e.nestedTokens&&e.nestedTokens.length>0){const n=t.parseChildren(e.nestedTokens);r.push(...n)}return t.createNode("taskItem",{checked:e.checked||!1},r)},renderMarkdown:(e,t)=>{var r;const a=`- [${(r=e.attrs)!=null&&r.checked?"x":" "}] `;return I9(e,t,a)},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:r,editor:n})=>{const a=document.createElement("li"),s=document.createElement("label"),i=document.createElement("span"),l=document.createElement("input"),c=document.createElement("div"),u=f=>{var m,p;l.ariaLabel=((p=(m=this.options.a11y)==null?void 0:m.checkboxLabel)==null?void 0:p.call(m,f,l.checked))||`Task item checkbox for ${f.textContent||"empty task item"}`};u(e),s.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",f=>f.preventDefault()),l.addEventListener("change",f=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:m}=f.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:p})=>{const v=r();if(typeof v!="number")return!1;const b=p.doc.nodeAt(v);return p.setNodeMarkup(v,void 0,{...b?.attrs,checked:m}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,m)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([f,m])=>{a.setAttribute(f,m)}),a.dataset.checked=e.attrs.checked,l.checked=e.attrs.checked,s.append(l,i),a.append(s,c),Object.entries(t).forEach(([f,m])=>{a.setAttribute(f,m)});let d=new Set(Object.keys(t));return{dom:a,contentDOM:c,update:f=>{if(f.type!==this.type)return!1;a.dataset.checked=f.attrs.checked,l.checked=f.attrs.checked,u(f);const m=n.extensionManager.attributes,p=Xy(f,m),v=new Set(Object.keys(p)),b=this.options.HTMLAttributes;return d.forEach(y=>{v.has(y)||(y in b?a.setAttribute(y,b[y]):a.removeAttribute(y))}),Object.entries(p).forEach(([y,S])=>{S==null?y in b?a.setAttribute(y,b[y]):a.removeAttribute(y):a.setAttribute(y,S)}),d=v,!0}}}},addInputRules(){return[Eg({find:IUe,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),PUe=Fs.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",Jn(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},parseMarkdown:(e,t)=>t.createNode("taskList",{},t.parseChildren(e.items||[])),renderMarkdown:(e,t)=>e.content?t.renderChildren(e.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(e){var t;const r=(t=e.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return r!==void 0?r:-1},tokenize(e,t,r){const n=s=>{const i=RR(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,c)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:r.inlineTokens(l.mainContent),nestedTokens:c}),customNestedParser:n},r);return i?[{type:"taskList",raw:i.raw,items:i.items}]:r.blockTokens(s)},a=RR(e,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,i)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:r.inlineTokens(s.mainContent),nestedTokens:i}),customNestedParser:n},r);if(a)return{type:"taskList",raw:a.raw,items:a.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Br.create({name:"listKit",addExtensions(){const e=[];return this.options.bulletList!==!1&&e.push(Qde.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(Jde.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(nfe.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(sfe.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(RUe.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(PUe.configure(this.options.taskList)),e}});var CJ="&nbsp;",zUe="",BUe=Fs.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",Jn(this.options.HTMLAttributes,e),0]},parseMarkdown:(e,t)=>{const r=e.tokens||[];if(r.length===1&&r[0].type==="image")return t.parseChildren([r[0]]);const n=t.parseInline(r);return n.length===1&&n[0].type==="text"&&(n[0].text===CJ||n[0].text===zUe)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,n)},renderMarkdown:(e,t)=>{if(!e)return"";const r=Array.isArray(e.content)?e.content:[];return r.length===0?CJ:t.renderChildren(r)},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),$Ue=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,FUe=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,UUe=Xh.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",Jn(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[jg({find:$Ue,type:this.type})]},addPasteRules(){return[Mh({find:FUe,type:this.type})]}}),HUe=Fs.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""}),ife=Xh.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",Jn(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown(e,t){return`++${t.renderChildren(e)}++`},markdownTokenizer:{name:"underline",level:"inline",start(e){return e.indexOf("++")},tokenize(e,t,r){const a=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!a)return;const s=a[2].trim();return{type:"underline",raw:a[0],text:s,tokens:r.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),qUe=ife;function ofe(e={}){return new Hr({view(t){return new WUe(t,e)}})}class WUe{constructor(t,r){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(a=>{let s=i=>{this[a](i)};return t.dom.addEventListener(a,s),{name:a,handler:s}})}destroy(){this.handlers.forEach(({name:t,handler:r})=>this.editorView.dom.removeEventListener(t,r))}update(t,r){this.cursorPos!=null&&r.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),r=!t.parent.inlineContent,n,a=this.editorView.dom,s=a.getBoundingClientRect(),i=s.width/a.offsetWidth,l=s.height/a.offsetHeight;if(r){let f=t.nodeBefore,m=t.nodeAfter;if(f||m){let p=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(p){let v=p.getBoundingClientRect(),b=f?v.bottom:v.top;f&&m&&(b=(b+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let y=this.width/2*l;n={left:v.left,right:v.right,top:b-y,bottom:b+y}}}}if(!n){let f=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*i;n={left:f.left-m,right:f.left+m,top:f.top,bottom:f.bottom}}let c=this.editorView.dom.offsetParent;this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,d;if(!c||c==document.body&&getComputedStyle(c).position=="static")u=-pageXOffset,d=-pageYOffset;else{let f=c.getBoundingClientRect(),m=f.width/c.offsetWidth,p=f.height/c.offsetHeight;u=f.left-c.scrollLeft*m,d=f.top-c.scrollTop*p}this.element.style.left=(n.left-u)/i+"px",this.element.style.top=(n.top-d)/l+"px",this.element.style.width=(n.right-n.left)/i+"px",this.element.style.height=(n.bottom-n.top)/l+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),a=n&&n.type.spec.disableDropCursor,s=typeof a=="function"?a(this.editorView,r,t):a;if(r&&!s){let i=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=sue(this.editorView.state.doc,i,this.editorView.dragging.slice);l!=null&&(i=l)}this.setCursor(i),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class Gn extends cr{constructor(t){super(t,t)}map(t,r){let n=t.resolve(r.map(this.head));return Gn.valid(n)?new Gn(n):cr.near(n)}content(){return vt.empty}eq(t){return t instanceof Gn&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Gn(t.resolve(r.pos))}getBookmark(){return new G9(this.anchor)}static valid(t){let r=t.parent;if(r.isTextblock||!KUe(t)||!GUe(t))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let a=r.contentMatchAt(t.index()).defaultType;return a&&a.isTextblock}static findGapCursorFrom(t,r,n=!1){e:for(;;){if(!n&&Gn.valid(t))return t;let a=t.pos,s=null;for(let i=t.depth;;i--){let l=t.node(i);if(r>0?t.indexAfter(i)<l.childCount:t.index(i)>0){s=l.child(r>0?t.indexAfter(i):t.index(i)-1);break}else if(i==0)return null;a+=r;let c=t.doc.resolve(a);if(Gn.valid(c))return c}for(;;){let i=r>0?s.firstChild:s.lastChild;if(!i){if(s.isAtom&&!s.isText&&!Ft.isSelectable(s)){t=t.doc.resolve(a+s.nodeSize*r),n=!1;continue e}break}s=i,a+=r;let l=t.doc.resolve(a);if(Gn.valid(l))return l}return null}}}Gn.prototype.visible=!1;Gn.findFrom=Gn.findGapCursorFrom;cr.jsonID("gapcursor",Gn);class G9{constructor(t){this.pos=t}map(t){return new G9(t.map(this.pos))}resolve(t){let r=t.resolve(this.pos);return Gn.valid(r)?new Gn(r):cr.near(r)}}function lfe(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}function KUe(e){for(let t=e.depth;t>=0;t--){let r=e.index(t),n=e.node(t);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let a=n.child(r-1);;a=a.lastChild){if(a.childCount==0&&!a.inlineContent||lfe(a.type))return!0;if(a.inlineContent)return!1}}return!0}function GUe(e){for(let t=e.depth;t>=0;t--){let r=e.indexAfter(t),n=e.node(t);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let a=n.child(r);;a=a.firstChild){if(a.childCount==0&&!a.inlineContent||lfe(a.type))return!0;if(a.inlineContent)return!1}}return!0}function cfe(){return new Hr({props:{decorations:JUe,createSelectionBetween(e,t,r){return t.pos==r.pos&&Gn.valid(r)?new Gn(r):null},handleClick:YUe,handleKeyDown:VUe,handleDOMEvents:{beforeinput:QUe}}})}const VUe=ide({ArrowLeft:wS("horiz",-1),ArrowRight:wS("horiz",1),ArrowUp:wS("vert",-1),ArrowDown:wS("vert",1)});function wS(e,t){const r=e=="vert"?t>0?"down":"up":t>0?"right":"left";return function(n,a,s){let i=n.selection,l=t>0?i.$to:i.$from,c=i.empty;if(i instanceof Jt){if(!s.endOfTextblock(r)||l.depth==0)return!1;c=!1,l=n.doc.resolve(t>0?l.after():l.before())}let u=Gn.findGapCursorFrom(l,t,c);return u?(a&&a(n.tr.setSelection(new Gn(u))),!0):!1}}function YUe(e,t,r){if(!e||!e.editable)return!1;let n=e.state.doc.resolve(t);if(!Gn.valid(n))return!1;let a=e.posAtCoords({left:r.clientX,top:r.clientY});return a&&a.inside>-1&&Ft.isSelectable(e.state.doc.nodeAt(a.inside))?!1:(e.dispatch(e.state.tr.setSelection(new Gn(n))),!0)}function QUe(e,t){if(t.inputType!="insertCompositionText"||!(e.state.selection instanceof Gn))return!1;let{$from:r}=e.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(e.state.schema.nodes.text);if(!n)return!1;let a=Ge.empty;for(let i=n.length-1;i>=0;i--)a=Ge.from(n[i].createAndFill(null,a));let s=e.state.tr.replace(r.pos,r.pos,new vt(a,0,0));return s.setSelection(Jt.near(s.doc.resolve(r.pos+1))),e.dispatch(s),!1}function JUe(e){if(!(e.selection instanceof Gn))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",en.create(e.doc,[ga.widget(e.selection.head,t,{key:"gapcursor"})])}var YN=200,qa=function(){};qa.prototype.append=function(t){return t.length?(t=qa.from(t),!this.length&&t||t.length<YN&&this.leafAppend(t)||this.length<YN&&t.leafPrepend(this)||this.appendInner(t)):this};qa.prototype.prepend=function(t){return t.length?qa.from(t).append(this):this};qa.prototype.appendInner=function(t){return new ZUe(this,t)};qa.prototype.slice=function(t,r){return t===void 0&&(t=0),r===void 0&&(r=this.length),t>=r?qa.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,r))};qa.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};qa.prototype.forEach=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(t,r,n,0):this.forEachInvertedInner(t,r,n,0)};qa.prototype.map=function(t,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var a=[];return this.forEach(function(s,i){return a.push(t(s,i))},r,n),a};qa.from=function(t){return t instanceof qa?t:t&&t.length?new ufe(t):qa.empty};var ufe=(function(e){function t(n){e.call(this),this.values=n}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(a,s){return a==0&&s==this.length?this:new t(this.values.slice(a,s))},t.prototype.getInner=function(a){return this.values[a]},t.prototype.forEachInner=function(a,s,i,l){for(var c=s;c<i;c++)if(a(this.values[c],l+c)===!1)return!1},t.prototype.forEachInvertedInner=function(a,s,i,l){for(var c=s-1;c>=i;c--)if(a(this.values[c],l+c)===!1)return!1},t.prototype.leafAppend=function(a){if(this.length+a.length<=YN)return new t(this.values.concat(a.flatten()))},t.prototype.leafPrepend=function(a){if(this.length+a.length<=YN)return new t(a.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(t.prototype,r),t})(qa);qa.empty=new ufe([]);var ZUe=(function(e){function t(r,n){e.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,a,s,i){var l=this.left.length;if(a<l&&this.left.forEachInner(n,a,Math.min(s,l),i)===!1||s>l&&this.right.forEachInner(n,Math.max(a-l,0),Math.min(this.length,s)-l,i+l)===!1)return!1},t.prototype.forEachInvertedInner=function(n,a,s,i){var l=this.left.length;if(a>l&&this.right.forEachInvertedInner(n,a-l,Math.max(s,l)-l,i+l)===!1||s<l&&this.left.forEachInvertedInner(n,Math.min(a,l),s,i)===!1)return!1},t.prototype.sliceInner=function(n,a){if(n==0&&a==this.length)return this;var s=this.left.length;return a<=s?this.left.slice(n,a):n>=s?this.right.slice(n-s,a-s):this.left.slice(n,s).append(this.right.slice(0,a-s))},t.prototype.leafAppend=function(n){var a=this.right.leafAppend(n);if(a)return new t(this.left,a)},t.prototype.leafPrepend=function(n){var a=this.left.leafPrepend(n);if(a)return new t(a,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t})(qa);const XUe=500;class qo{constructor(t,r){this.items=t,this.eventCount=r}popEvent(t,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let a,s;r&&(a=this.remapping(n,this.items.length),s=a.maps.length);let i=t.tr,l,c,u=[],d=[];return this.items.forEach((f,m)=>{if(!f.step){a||(a=this.remapping(n,m+1),s=a.maps.length),s--,d.push(f);return}if(a){d.push(new gl(f.map));let p=f.step.map(a.slice(s)),v;p&&i.maybeStep(p).doc&&(v=i.mapping.maps[i.mapping.maps.length-1],u.push(new gl(v,void 0,void 0,u.length+d.length))),s--,v&&a.appendMap(v,s)}else i.maybeStep(f.step);if(f.selection)return l=a?f.selection.map(a.slice(s)):f.selection,c=new qo(this.items.slice(0,n).append(d.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:c,transform:i,selection:l}}addTransform(t,r,n,a){let s=[],i=this.eventCount,l=this.items,c=!a&&l.length?l.get(l.length-1):null;for(let d=0;d<t.steps.length;d++){let f=t.steps[d].invert(t.docs[d]),m=new gl(t.mapping.maps[d],f,r),p;(p=c&&c.merge(m))&&(m=p,d?s.pop():l=l.slice(0,l.length-1)),s.push(m),r&&(i++,r=void 0),a||(c=m)}let u=i-n.depth;return u>tHe&&(l=eHe(l,u),i-=u),new qo(l.append(s),i)}remapping(t,r){let n=new Gy;return this.items.forEach((a,s)=>{let i=a.mirrorOffset!=null&&s-a.mirrorOffset>=t?n.maps.length-a.mirrorOffset:void 0;n.appendMap(a.map,i)},t,r),n}addMaps(t){return this.eventCount==0?this:new qo(this.items.append(t.map(r=>new gl(r))),this.eventCount)}rebased(t,r){if(!this.eventCount)return this;let n=[],a=Math.max(0,this.items.length-r),s=t.mapping,i=t.steps.length,l=this.eventCount;this.items.forEach(m=>{m.selection&&l--},a);let c=r;this.items.forEach(m=>{let p=s.getMirror(--c);if(p==null)return;i=Math.min(i,p);let v=s.maps[p];if(m.step){let b=t.steps[p].invert(t.docs[p]),y=m.selection&&m.selection.map(s.slice(c+1,p));y&&l++,n.push(new gl(v,b,y))}else n.push(new gl(v))},a);let u=[];for(let m=r;m<i;m++)u.push(new gl(s.maps[m]));let d=this.items.slice(0,a).append(u).append(n),f=new qo(d,l);return f.emptyItemCount()>XUe&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let t=0;return this.items.forEach(r=>{r.step||t++}),t}compress(t=this.items.length){let r=this.remapping(0,t),n=r.maps.length,a=[],s=0;return this.items.forEach((i,l)=>{if(l>=t)a.push(i),i.selection&&s++;else if(i.step){let c=i.step.map(r.slice(n)),u=c&&c.getMap();if(n--,u&&r.appendMap(u,n),c){let d=i.selection&&i.selection.map(r.slice(n));d&&s++;let f=new gl(u.invert(),c,d),m,p=a.length-1;(m=a.length&&a[p].merge(f))?a[p]=m:a.push(f)}}else i.map&&n--},this.items.length,0),new qo(qa.from(a.reverse()),s)}}qo.empty=new qo(qa.empty,0);function eHe(e,t){let r;return e.forEach((n,a)=>{if(n.selection&&t--==0)return r=a,!1}),e.slice(r)}class gl{constructor(t,r,n,a){this.map=t,this.step=r,this.selection=n,this.mirrorOffset=a}merge(t){if(this.step&&t.step&&!t.selection){let r=t.step.merge(this.step);if(r)return new gl(r.getMap().invert(),r,this.selection)}}}class od{constructor(t,r,n,a,s){this.done=t,this.undone=r,this.prevRanges=n,this.prevTime=a,this.prevComposition=s}}const tHe=20;function rHe(e,t,r,n){let a=r.getMeta(lh),s;if(a)return a.historyState;r.getMeta(sHe)&&(e=new od(e.done,e.undone,null,0,-1));let i=r.getMeta("appendedTransaction");if(r.steps.length==0)return e;if(i&&i.getMeta(lh))return i.getMeta(lh).redo?new od(e.done.addTransform(r,void 0,n,_k(t)),e.undone,jJ(r.mapping.maps),e.prevTime,e.prevComposition):new od(e.done,e.undone.addTransform(r,void 0,n,_k(t)),null,e.prevTime,e.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let l=r.getMeta("composition"),c=e.prevTime==0||!i&&e.prevComposition!=l&&(e.prevTime<(r.time||0)-n.newGroupDelay||!nHe(r,e.prevRanges)),u=i?XD(e.prevRanges,r.mapping):jJ(r.mapping.maps);return new od(e.done.addTransform(r,c?t.selection.getBookmark():void 0,n,_k(t)),qo.empty,u,r.time,l??e.prevComposition)}else return(s=r.getMeta("rebased"))?new od(e.done.rebased(r,s),e.undone.rebased(r,s),XD(e.prevRanges,r.mapping),e.prevTime,e.prevComposition):new od(e.done.addMaps(r.mapping.maps),e.undone.addMaps(r.mapping.maps),XD(e.prevRanges,r.mapping),e.prevTime,e.prevComposition)}function nHe(e,t){if(!t)return!1;if(!e.docChanged)return!0;let r=!1;return e.mapping.maps[0].forEach((n,a)=>{for(let s=0;s<t.length;s+=2)n<=t[s+1]&&a>=t[s]&&(r=!0)}),r}function jJ(e){let t=[];for(let r=e.length-1;r>=0&&t.length==0;r--)e[r].forEach((n,a,s,i)=>t.push(s,i));return t}function XD(e,t){if(!e)return null;let r=[];for(let n=0;n<e.length;n+=2){let a=t.map(e[n],1),s=t.map(e[n+1],-1);a<=s&&r.push(a,s)}return r}function aHe(e,t,r){let n=_k(t),a=lh.get(t).spec.config,s=(r?e.undone:e.done).popEvent(t,n);if(!s)return null;let i=s.selection.resolve(s.transform.doc),l=(r?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),a,n),c=new od(r?l:s.remaining,r?s.remaining:l,null,0,-1);return s.transform.setSelection(i).setMeta(lh,{redo:r,historyState:c})}let eL=!1,EJ=null;function _k(e){let t=e.plugins;if(EJ!=t){eL=!1,EJ=t;for(let r=0;r<t.length;r++)if(t[r].spec.historyPreserveItems){eL=!0;break}}return eL}const lh=new Qr("history"),sHe=new Qr("closeHistory");function dfe(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new Hr({key:lh,state:{init(){return new od(qo.empty,qo.empty,null,0,-1)},apply(t,r,n){return rHe(r,n,t,e)}},config:e,props:{handleDOMEvents:{beforeinput(t,r){let n=r.inputType,a=n=="historyUndo"?V9:n=="historyRedo"?Y9:null;return!a||!t.editable?!1:(r.preventDefault(),a(t.state,t.dispatch))}}}})}function ffe(e,t){return(r,n)=>{let a=lh.getState(r);if(!a||(e?a.undone:a.done).eventCount==0)return!1;if(n){let s=aHe(a,r,e);s&&n(t?s.scrollIntoView():s)}return!0}}const V9=ffe(!1,!0),Y9=ffe(!0,!0);Br.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){const n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{const t=e?.node||this.editor.state.doc,r=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let e=!1;return[new Hr({key:new Qr("characterCount"),appendTransaction:(t,r,n)=>{if(e)return;const a=this.options.limit;if(a==null||a===0){e=!0;return}const s=this.storage.characters({node:n.doc});if(s>a){const i=s-a,l=0,c=i;console.warn(`[CharacterCount] Initial content exceeded limit of ${a} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(l,c);return e=!0,u}e=!0},filterTransaction:(t,r)=>{const n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;const a=this.storage.characters({node:r.doc}),s=this.storage.characters({node:t.doc});if(s<=n||a>n&&s>n&&s<=a)return!0;if(a>n&&s>n&&s>a||!t.getMeta("paste"))return!1;const l=t.selection.$head.pos,c=s-n,u=l-c,d=l;return t.deleteRange(u,d),!(this.storage.characters({node:t.doc})>n)}})]}});var iHe=Br.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[ofe(this.options)]}});Br.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Hr({key:new Qr("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:a}=t,s=[];if(!r||!n)return en.create(e,[]);let i=0;this.options.mode==="deepest"&&e.descendants((c,u)=>{if(c.isText)return;if(!(a>=u&&a<=u+c.nodeSize-1))return!1;i+=1});let l=0;return e.descendants((c,u)=>{if(c.isText||!(a>=u&&a<=u+c.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&i-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";s.push(ga.node(u,u+c.nodeSize,{class:this.options.className}))}),en.create(e,s)}}})]}});var oHe=Br.create({name:"gapCursor",addProseMirrorPlugins(){return[cfe()]},extendNodeSchema(e){var t;const r={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=Kr(It(e,"allowGapCursor",r)))!=null?t:null}}});Br.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Hr({key:new Qr("placeholder"),props:{decorations:({doc:e,selection:t})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=t,a=[];if(!r)return null;const s=this.editor.isEmpty;return e.descendants((i,l)=>{const c=n>=l&&n<=l+i.nodeSize,u=!i.isLeaf&&s1(i);if((c||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];s&&d.push(this.options.emptyEditorClass);const f=ga.node(l,l+i.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:i,pos:l,hasAnchor:c}):this.options.placeholder});a.push(f)}return this.options.includeChildren}),en.create(e,a)}}})]}});Br.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Hr({key:new Qr("selection"),props:{decorations(r){return r.selection.empty||e.isFocused||!e.isEditable||A9(r.selection)||e.view.dragging?null:en.create(r.doc,[ga.inline(r.selection.from,r.selection.to,{class:t.className})])}}})]}});function MJ({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}var lHe=Br.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;const t=new Qr(this.name),r=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,a])=>a).filter(a=>(this.options.notAfter||[]).concat(r).includes(a.name));return[new Hr({key:t,appendTransaction:(a,s,i)=>{const{doc:l,tr:c,schema:u}=i,d=t.getState(i),f=l.content.size,m=u.nodes[r];if(d)return c.insert(f,m.create())},state:{init:(a,s)=>{const i=s.tr.doc.lastChild;return!MJ({node:i,types:n})},apply:(a,s)=>{if(!a.docChanged||a.getMeta("__uniqueIDTransaction"))return s;const i=a.doc.lastChild;return!MJ({node:i,types:n})}}})]}}),cHe=Br.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>V9(e,t),redo:()=>({state:e,dispatch:t})=>Y9(e,t)}},addProseMirrorPlugins(){return[dfe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),uHe=Br.create({name:"starterKit",addExtensions(){var e,t,r,n;const a=[];return this.options.bold!==!1&&a.push(BFe.configure(this.options.bold)),this.options.blockquote!==!1&&a.push(OFe.configure(this.options.blockquote)),this.options.bulletList!==!1&&a.push(Qde.configure(this.options.bulletList)),this.options.code!==!1&&a.push(UFe.configure(this.options.code)),this.options.codeBlock!==!1&&a.push(WFe.configure(this.options.codeBlock)),this.options.document!==!1&&a.push(KFe.configure(this.options.document)),this.options.dropcursor!==!1&&a.push(iHe.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&a.push(oHe.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&a.push(GFe.configure(this.options.hardBreak)),this.options.heading!==!1&&a.push(VFe.configure(this.options.heading)),this.options.undoRedo!==!1&&a.push(cHe.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&a.push(YFe.configure(this.options.horizontalRule)),this.options.italic!==!1&&a.push(eUe.configure(this.options.italic)),this.options.listItem!==!1&&a.push(Jde.configure(this.options.listItem)),this.options.listKeymap!==!1&&a.push(nfe.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&a.push(Yde.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&a.push(sfe.configure(this.options.orderedList)),this.options.paragraph!==!1&&a.push(BUe.configure(this.options.paragraph)),this.options.strike!==!1&&a.push(UUe.configure(this.options.strike)),this.options.text!==!1&&a.push(HUe.configure(this.options.text)),this.options.underline!==!1&&a.push(ife.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&a.push(lHe.configure((n=this.options)==null?void 0:n.trailingNode)),a}}),dHe=uHe;Br.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=e?.node||this.editor.state.doc;if((e?.mode||this.options.mode)==="textSize"){const n=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(n)}return t.nodeSize},this.storage.words=e=>{const t=e?.node||this.editor.state.doc,r=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let e=!1;return[new Hr({key:new Qr("characterCount"),appendTransaction:(t,r,n)=>{if(e)return;const a=this.options.limit;if(a==null||a===0){e=!0;return}const s=this.storage.characters({node:n.doc});if(s>a){const i=s-a,l=0,c=i;console.warn(`[CharacterCount] Initial content exceeded limit of ${a} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(l,c);return e=!0,u}e=!0},filterTransaction:(t,r)=>{const n=this.options.limit;if(!t.docChanged||n===0||n===null||n===void 0)return!0;const a=this.storage.characters({node:r.doc}),s=this.storage.characters({node:t.doc});if(s<=n||a>n&&s>n&&s<=a)return!0;if(a>n&&s>n&&s>a||!t.getMeta("paste"))return!1;const l=t.selection.$head.pos,c=s-n,u=l-c,d=l;return t.deleteRange(u,d),!(this.storage.characters({node:t.doc})>n)}})]}});Br.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[ofe(this.options)]}});Br.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Hr({key:new Qr("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:a}=t,s=[];if(!r||!n)return en.create(e,[]);let i=0;this.options.mode==="deepest"&&e.descendants((c,u)=>{if(c.isText)return;if(!(a>=u&&a<=u+c.nodeSize-1))return!1;i+=1});let l=0;return e.descendants((c,u)=>{if(c.isText||!(a>=u&&a<=u+c.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&i-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";s.push(ga.node(u,u+c.nodeSize,{class:this.options.className}))}),en.create(e,s)}}})]}});Br.create({name:"gapCursor",addProseMirrorPlugins(){return[cfe()]},extendNodeSchema(e){var t;const r={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=Kr(It(e,"allowGapCursor",r)))!=null?t:null}}});var TJ="placeholder";function fHe(e){return e.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}var hHe=Br.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:TJ,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const e=this.options.dataAttribute?`data-${fHe(this.options.dataAttribute)}`:`data-${TJ}`;return[new Hr({key:new Qr("placeholder"),props:{decorations:({doc:t,selection:r})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:a}=r,s=[];if(!n)return null;const i=this.editor.isEmpty;return t.descendants((l,c)=>{const u=a>=c&&a<=c+l.nodeSize,d=!l.isLeaf&&s1(l);if((u||!this.options.showOnlyCurrent)&&d){const f=[this.options.emptyNodeClass];i&&f.push(this.options.emptyEditorClass);const m=ga.node(c,c+l.nodeSize,{class:f.join(" "),[e]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:l,pos:c,hasAnchor:u}):this.options.placeholder});s.push(m)}return this.options.includeChildren}),en.create(t,s)}}})]}});Br.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new Hr({key:new Qr("selection"),props:{decorations(r){return r.selection.empty||e.isFocused||!e.isEditable||A9(r.selection)||e.view.dragging?null:en.create(r.doc,[ga.inline(r.selection.from,r.selection.to,{class:t.className})])}}})]}});function AJ({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||t?.type===e}Br.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var e;const t=new Qr(this.name),r=this.options.node||((e=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:e.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,a])=>a).filter(a=>(this.options.notAfter||[]).concat(r).includes(a.name));return[new Hr({key:t,appendTransaction:(a,s,i)=>{const{doc:l,tr:c,schema:u}=i,d=t.getState(i),f=l.content.size,m=u.nodes[r];if(d)return c.insert(f,m.create())},state:{init:(a,s)=>{const i=s.tr.doc.lastChild;return!AJ({node:i,types:n})},apply:(a,s)=>{if(!a.docChanged||a.getMeta("__uniqueIDTransaction"))return s;const i=a.doc.lastChild;return!AJ({node:i,types:n})}}})]}});Br.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>V9(e,t),redo:()=>({state:e,dispatch:t})=>Y9(e,t)}},addProseMirrorPlugins(){return[dfe(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}});var mHe=hHe,tL=4,pHe=/^```([a-z]+)?[\s\n]$/,gHe=/^~~~([a-z]+)?[\s\n]$/,vHe=Fs.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:tL,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:r}=this.options;if(!r)return null;const s=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(i=>i.startsWith(r)).map(i=>i.replace(r,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",Jn(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(e,t)=>{var r;return((r=e.raw)==null?void 0:r.startsWith("```"))===!1&&e.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:e.lang||null},e.text?[t.createTextNode(e.text)]:[])},renderMarkdown:(e,t)=>{var r;let n="";const a=((r=e.attrs)==null?void 0:r.language)||"";return e.content?n=[`\`\`\`${a}`,t.renderChildren(e.content),"```"].join(`
`):n=`\`\`\`${a}

\`\`\``,n},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,r=t.pos===1;return!e||t.parent.type.name!==this.name?!1:r||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:tL,{state:n}=e,{selection:a}=n,{$from:s,empty:i}=a;if(s.parent.type!==this.type)return!1;const l=" ".repeat(r);return i?e.commands.insertContent(l):e.commands.command(({tr:c})=>{const{from:u,to:d}=a,p=n.doc.textBetween(u,d,`
`,`
`).split(`
`).map(v=>l+v).join(`
`);return c.replaceWith(u,d,n.schema.text(p)),!0})},"Shift-Tab":({editor:e})=>{var t;if(!this.options.enableTabIndentation)return!1;const r=(t=this.options.tabSize)!=null?t:tL,{state:n}=e,{selection:a}=n,{$from:s,empty:i}=a;return s.parent.type!==this.type?!1:i?e.commands.command(({tr:l})=>{var c;const{pos:u}=s,d=s.start(),f=s.end(),p=n.doc.textBetween(d,f,`
`,`
`).split(`
`);let v=0,b=0;const y=u-d;for(let E=0;E<p.length;E+=1){if(b+p[E].length>=y){v=E;break}b+=p[E].length+1}const _=((c=p[v].match(/^ */))==null?void 0:c[0])||"",N=Math.min(_.length,r);if(N===0)return!0;let k=d;for(let E=0;E<v;E+=1)k+=p[E].length+1;return l.delete(k,k+N),u-k<=N&&l.setSelection(Jt.create(l.doc,k)),!0}):e.commands.command(({tr:l})=>{const{from:c,to:u}=a,m=n.doc.textBetween(c,u,`
`,`
`).split(`
`).map(p=>{var v;const b=((v=p.match(/^ */))==null?void 0:v[0])||"",y=Math.min(b.length,r);return p.slice(y)}).join(`
`);return l.replaceWith(c,u,n.schema.text(m)),!0})},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:r}=t,{$from:n,empty:a}=r;if(!a||n.parent.type!==this.type)return!1;const s=n.parentOffset===n.parent.nodeSize-2,i=n.parent.textContent.endsWith(`

`);return!s||!i?!1:e.chain().command(({tr:l})=>(l.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:r,doc:n}=t,{$from:a,empty:s}=r;if(!s||a.parent.type!==this.type||!(a.parentOffset===a.parent.nodeSize-2))return!1;const l=a.after();return l===void 0?!1:n.nodeAt(l)?e.commands.command(({tr:u})=>(u.setSelection(cr.near(n.resolve(l))),!0)):e.commands.exitCode()}}},addInputRules(){return[ex({find:pHe,type:this.type,getAttributes:e=>({language:e[1]})}),ex({find:gHe,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new Hr({key:new Qr("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const r=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),a=n?JSON.parse(n):void 0,s=a?.mode;if(!r||!s)return!1;const{tr:i,schema:l}=e.state,c=l.text(r.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:s},c)),i.selection.$from.parent.type!==this.type&&i.setSelection(Jt.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),bHe=vHe,rL,DJ;function yHe(){if(DJ)return rL;DJ=1;function e(fe){return fe instanceof Map?fe.clear=fe.delete=fe.set=function(){throw new Error("map is read-only")}:fe instanceof Set&&(fe.add=fe.clear=fe.delete=function(){throw new Error("set is read-only")}),Object.freeze(fe),Object.getOwnPropertyNames(fe).forEach(De=>{const Ue=fe[De],dt=typeof Ue;(dt==="object"||dt==="function")&&!Object.isFrozen(Ue)&&e(Ue)}),fe}class t{constructor(De){De.data===void 0&&(De.data={}),this.data=De.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function r(fe){return fe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function n(fe,...De){const Ue=Object.create(null);for(const dt in fe)Ue[dt]=fe[dt];return De.forEach(function(dt){for(const Nt in dt)Ue[Nt]=dt[Nt]}),Ue}const a="</span>",s=fe=>!!fe.scope,i=(fe,{prefix:De})=>{if(fe.startsWith("language:"))return fe.replace("language:","language-");if(fe.includes(".")){const Ue=fe.split(".");return[`${De}${Ue.shift()}`,...Ue.map((dt,Nt)=>`${dt}${"_".repeat(Nt+1)}`)].join(" ")}return`${De}${fe}`};class l{constructor(De,Ue){this.buffer="",this.classPrefix=Ue.classPrefix,De.walk(this)}addText(De){this.buffer+=r(De)}openNode(De){if(!s(De))return;const Ue=i(De.scope,{prefix:this.classPrefix});this.span(Ue)}closeNode(De){s(De)&&(this.buffer+=a)}value(){return this.buffer}span(De){this.buffer+=`<span class="${De}">`}}const c=(fe={})=>{const De={children:[]};return Object.assign(De,fe),De};class u{constructor(){this.rootNode=c(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(De){this.top.children.push(De)}openNode(De){const Ue=c({scope:De});this.add(Ue),this.stack.push(Ue)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(De){return this.constructor._walk(De,this.rootNode)}static _walk(De,Ue){return typeof Ue=="string"?De.addText(Ue):Ue.children&&(De.openNode(Ue),Ue.children.forEach(dt=>this._walk(De,dt)),De.closeNode(Ue)),De}static _collapse(De){typeof De!="string"&&De.children&&(De.children.every(Ue=>typeof Ue=="string")?De.children=[De.children.join("")]:De.children.forEach(Ue=>{u._collapse(Ue)}))}}class d extends u{constructor(De){super(),this.options=De}addText(De){De!==""&&this.add(De)}startScope(De){this.openNode(De)}endScope(){this.closeNode()}__addSublanguage(De,Ue){const dt=De.root;Ue&&(dt.scope=`language:${Ue}`),this.add(dt)}toHTML(){return new l(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function f(fe){return fe?typeof fe=="string"?fe:fe.source:null}function m(fe){return b("(?=",fe,")")}function p(fe){return b("(?:",fe,")*")}function v(fe){return b("(?:",fe,")?")}function b(...fe){return fe.map(Ue=>f(Ue)).join("")}function y(fe){const De=fe[fe.length-1];return typeof De=="object"&&De.constructor===Object?(fe.splice(fe.length-1,1),De):{}}function S(...fe){return"("+(y(fe).capture?"":"?:")+fe.map(dt=>f(dt)).join("|")+")"}function _(fe){return new RegExp(fe.toString()+"|").exec("").length-1}function N(fe,De){const Ue=fe&&fe.exec(De);return Ue&&Ue.index===0}const k=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function j(fe,{joinWith:De}){let Ue=0;return fe.map(dt=>{Ue+=1;const Nt=Ue;let Mt=f(dt),Je="";for(;Mt.length>0;){const et=k.exec(Mt);if(!et){Je+=Mt;break}Je+=Mt.substring(0,et.index),Mt=Mt.substring(et.index+et[0].length),et[0][0]==="\\"&&et[1]?Je+="\\"+String(Number(et[1])+Nt):(Je+=et[0],et[0]==="("&&Ue++)}return Je}).map(dt=>`(${dt})`).join(De)}const E=/\b\B/,T="[a-zA-Z]\\w*",O="[a-zA-Z_]\\w*",R="\\b\\d+(\\.\\d+)?",H="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",$="\\b(0b[01]+)",L="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",A=(fe={})=>{const De=/^#![ ]*\//;return fe.binary&&(fe.begin=b(De,/.*\b/,fe.binary,/\b.*/)),n({scope:"meta",begin:De,end:/$/,relevance:0,"on:begin":(Ue,dt)=>{Ue.index!==0&&dt.ignoreMatch()}},fe)},M={begin:"\\\\[\\s\\S]",relevance:0},P={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[M]},I={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[M]},B={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},F=function(fe,De,Ue={}){const dt=n({scope:"comment",begin:fe,end:De,contains:[]},Ue);dt.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const Nt=S("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return dt.contains.push({begin:b(/[ ]+/,"(",Nt,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),dt},q=F("//","$"),Q=F("/\\*","\\*/"),W=F("#","$"),G={scope:"number",begin:R,relevance:0},J={scope:"number",begin:H,relevance:0},X={scope:"number",begin:$,relevance:0},V={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[M,{begin:/\[/,end:/\]/,relevance:0,contains:[M]}]},se={scope:"title",begin:T,relevance:0},de={scope:"title",begin:O,relevance:0},he={begin:"\\.\\s*"+O,relevance:0};var le=Object.freeze({__proto__:null,APOS_STRING_MODE:P,BACKSLASH_ESCAPE:M,BINARY_NUMBER_MODE:X,BINARY_NUMBER_RE:$,COMMENT:F,C_BLOCK_COMMENT_MODE:Q,C_LINE_COMMENT_MODE:q,C_NUMBER_MODE:J,C_NUMBER_RE:H,END_SAME_AS_BEGIN:function(fe){return Object.assign(fe,{"on:begin":(De,Ue)=>{Ue.data._beginMatch=De[1]},"on:end":(De,Ue)=>{Ue.data._beginMatch!==De[1]&&Ue.ignoreMatch()}})},HASH_COMMENT_MODE:W,IDENT_RE:T,MATCH_NOTHING_RE:E,METHOD_GUARD:he,NUMBER_MODE:G,NUMBER_RE:R,PHRASAL_WORDS_MODE:B,QUOTE_STRING_MODE:I,REGEXP_MODE:V,RE_STARTERS_RE:L,SHEBANG:A,TITLE_MODE:se,UNDERSCORE_IDENT_RE:O,UNDERSCORE_TITLE_MODE:de});function oe(fe,De){fe.input[fe.index-1]==="."&&De.ignoreMatch()}function Z(fe,De){fe.className!==void 0&&(fe.scope=fe.className,delete fe.className)}function ve(fe,De){De&&fe.beginKeywords&&(fe.begin="\\b("+fe.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",fe.__beforeBegin=oe,fe.keywords=fe.keywords||fe.beginKeywords,delete fe.beginKeywords,fe.relevance===void 0&&(fe.relevance=0))}function U(fe,De){Array.isArray(fe.illegal)&&(fe.illegal=S(...fe.illegal))}function ge(fe,De){if(fe.match){if(fe.begin||fe.end)throw new Error("begin & end are not supported with match");fe.begin=fe.match,delete fe.match}}function ue(fe,De){fe.relevance===void 0&&(fe.relevance=1)}const re=(fe,De)=>{if(!fe.beforeMatch)return;if(fe.starts)throw new Error("beforeMatch cannot be used with starts");const Ue=Object.assign({},fe);Object.keys(fe).forEach(dt=>{delete fe[dt]}),fe.keywords=Ue.keywords,fe.begin=b(Ue.beforeMatch,m(Ue.begin)),fe.starts={relevance:0,contains:[Object.assign(Ue,{endsParent:!0})]},fe.relevance=0,delete Ue.beforeMatch},ne=["of","and","for","in","not","or","if","then","parent","list","value"],me="keyword";function ke(fe,De,Ue=me){const dt=Object.create(null);return typeof fe=="string"?Nt(Ue,fe.split(" ")):Array.isArray(fe)?Nt(Ue,fe):Object.keys(fe).forEach(function(Mt){Object.assign(dt,ke(fe[Mt],De,Mt))}),dt;function Nt(Mt,Je){De&&(Je=Je.map(et=>et.toLowerCase())),Je.forEach(function(et){const it=et.split("|");dt[it[0]]=[Mt,we(it[0],it[1])]})}}function we(fe,De){return De?Number(De):pe(fe)?0:1}function pe(fe){return ne.includes(fe.toLowerCase())}const Oe={},Ae=fe=>{console.error(fe)},Re=(fe,...De)=>{console.log(`WARN: ${fe}`,...De)},Ve=(fe,De)=>{Oe[`${fe}/${De}`]||(console.log(`Deprecated as of ${fe}. ${De}`),Oe[`${fe}/${De}`]=!0)},gt=new Error;function lt(fe,De,{key:Ue}){let dt=0;const Nt=fe[Ue],Mt={},Je={};for(let et=1;et<=De.length;et++)Je[et+dt]=Nt[et],Mt[et+dt]=!0,dt+=_(De[et-1]);fe[Ue]=Je,fe[Ue]._emit=Mt,fe[Ue]._multi=!0}function Pt(fe){if(Array.isArray(fe.begin)){if(fe.skip||fe.excludeBegin||fe.returnBegin)throw Ae("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),gt;if(typeof fe.beginScope!="object"||fe.beginScope===null)throw Ae("beginScope must be object"),gt;lt(fe,fe.begin,{key:"beginScope"}),fe.begin=j(fe.begin,{joinWith:""})}}function fr(fe){if(Array.isArray(fe.end)){if(fe.skip||fe.excludeEnd||fe.returnEnd)throw Ae("skip, excludeEnd, returnEnd not compatible with endScope: {}"),gt;if(typeof fe.endScope!="object"||fe.endScope===null)throw Ae("endScope must be object"),gt;lt(fe,fe.end,{key:"endScope"}),fe.end=j(fe.end,{joinWith:""})}}function Qe(fe){fe.scope&&typeof fe.scope=="object"&&fe.scope!==null&&(fe.beginScope=fe.scope,delete fe.scope)}function Vt(fe){Qe(fe),typeof fe.beginScope=="string"&&(fe.beginScope={_wrap:fe.beginScope}),typeof fe.endScope=="string"&&(fe.endScope={_wrap:fe.endScope}),Pt(fe),fr(fe)}function at(fe){function De(Je,et){return new RegExp(f(Je),"m"+(fe.case_insensitive?"i":"")+(fe.unicodeRegex?"u":"")+(et?"g":""))}class Ue{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(et,it){it.position=this.position++,this.matchIndexes[this.matchAt]=it,this.regexes.push([it,et]),this.matchAt+=_(et)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const et=this.regexes.map(it=>it[1]);this.matcherRe=De(j(et,{joinWith:"|"}),!0),this.lastIndex=0}exec(et){this.matcherRe.lastIndex=this.lastIndex;const it=this.matcherRe.exec(et);if(!it)return null;const tr=it.findIndex((Le,We)=>We>0&&Le!==void 0),ee=this.matchIndexes[tr];return it.splice(0,tr),Object.assign(it,ee)}}class dt{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(et){if(this.multiRegexes[et])return this.multiRegexes[et];const it=new Ue;return this.rules.slice(et).forEach(([tr,ee])=>it.addRule(tr,ee)),it.compile(),this.multiRegexes[et]=it,it}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(et,it){this.rules.push([et,it]),it.type==="begin"&&this.count++}exec(et){const it=this.getMatcher(this.regexIndex);it.lastIndex=this.lastIndex;let tr=it.exec(et);if(this.resumingScanAtSamePosition()&&!(tr&&tr.index===this.lastIndex)){const ee=this.getMatcher(0);ee.lastIndex=this.lastIndex+1,tr=ee.exec(et)}return tr&&(this.regexIndex+=tr.position+1,this.regexIndex===this.count&&this.considerAll()),tr}}function Nt(Je){const et=new dt;return Je.contains.forEach(it=>et.addRule(it.begin,{rule:it,type:"begin"})),Je.terminatorEnd&&et.addRule(Je.terminatorEnd,{type:"end"}),Je.illegal&&et.addRule(Je.illegal,{type:"illegal"}),et}function Mt(Je,et){const it=Je;if(Je.isCompiled)return it;[Z,ge,Vt,re].forEach(ee=>ee(Je,et)),fe.compilerExtensions.forEach(ee=>ee(Je,et)),Je.__beforeBegin=null,[ve,U,ue].forEach(ee=>ee(Je,et)),Je.isCompiled=!0;let tr=null;return typeof Je.keywords=="object"&&Je.keywords.$pattern&&(Je.keywords=Object.assign({},Je.keywords),tr=Je.keywords.$pattern,delete Je.keywords.$pattern),tr=tr||/\w+/,Je.keywords&&(Je.keywords=ke(Je.keywords,fe.case_insensitive)),it.keywordPatternRe=De(tr,!0),et&&(Je.begin||(Je.begin=/\B|\b/),it.beginRe=De(it.begin),!Je.end&&!Je.endsWithParent&&(Je.end=/\B|\b/),Je.end&&(it.endRe=De(it.end)),it.terminatorEnd=f(it.end)||"",Je.endsWithParent&&et.terminatorEnd&&(it.terminatorEnd+=(Je.end?"|":"")+et.terminatorEnd)),Je.illegal&&(it.illegalRe=De(Je.illegal)),Je.contains||(Je.contains=[]),Je.contains=[].concat(...Je.contains.map(function(ee){return Fe(ee==="self"?Je:ee)})),Je.contains.forEach(function(ee){Mt(ee,it)}),Je.starts&&Mt(Je.starts,et),it.matcher=Nt(it),it}if(fe.compilerExtensions||(fe.compilerExtensions=[]),fe.contains&&fe.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return fe.classNameAliases=n(fe.classNameAliases||{}),Mt(fe)}function Ne(fe){return fe?fe.endsWithParent||Ne(fe.starts):!1}function Fe(fe){return fe.variants&&!fe.cachedVariants&&(fe.cachedVariants=fe.variants.map(function(De){return n(fe,{variants:null},De)})),fe.cachedVariants?fe.cachedVariants:Ne(fe)?n(fe,{starts:fe.starts?n(fe.starts):null}):Object.isFrozen(fe)?n(fe):fe}var Ke="11.11.1";class Tt extends Error{constructor(De,Ue){super(De),this.name="HTMLInjectionError",this.html=Ue}}const wt=r,Zt=n,Xe=Symbol("nomatch"),nt=7,bt=function(fe){const De=Object.create(null),Ue=Object.create(null),dt=[];let Nt=!0;const Mt="Could not find the language '{}', did you forget to load/include a language module?",Je={disableAutodetect:!0,name:"Plain text",contains:[]};let et={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:d};function it(Ye){return et.noHighlightRe.test(Ye)}function tr(Ye){let At=Ye.className+" ";At+=Ye.parentNode?Ye.parentNode.className:"";const or=et.languageDetectRe.exec(At);if(or){const $r=ut(or[1]);return $r||(Re(Mt.replace("{}",or[1])),Re("Falling back to no-highlight mode for this block.",Ye)),$r?or[1]:"no-highlight"}return At.split(/\s+/).find($r=>it($r)||ut($r))}function ee(Ye,At,or){let $r="",On="";typeof At=="object"?($r=Ye,or=At.ignoreIllegals,On=At.language):(Ve("10.7.0","highlight(lang, code, ...args) has been deprecated."),Ve("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),On=Ye,$r=At),or===void 0&&(or=!0);const Aa={code:$r,language:On};Gl("before:highlight",Aa);const Ns=Aa.result?Aa.result:Le(Aa.language,Aa.code,or);return Ns.code=Aa.code,Gl("after:highlight",Ns),Ns}function Le(Ye,At,or,$r){const On=Object.create(null);function Aa(st,jt){return st.keywords[jt]}function Ns(){if(!Kt.keywords){sa.addText(Jr);return}let st=0;Kt.keywordPatternRe.lastIndex=0;let jt=Kt.keywordPatternRe.exec(Jr),ar="";for(;jt;){ar+=Jr.substring(st,jt.index);const wr=aa.case_insensitive?jt[0].toLowerCase():jt[0],In=Aa(Kt,wr);if(In){const[qi,E0]=In;if(sa.addText(ar),ar="",On[wr]=(On[wr]||0)+1,On[wr]<=nt&&(Su+=E0),qi.startsWith("_"))ar+=jt[0];else{const $1=aa.classNameAliases[qi]||qi;Cs(jt[0],$1)}}else ar+=jt[0];st=Kt.keywordPatternRe.lastIndex,jt=Kt.keywordPatternRe.exec(Jr)}ar+=Jr.substring(st),sa.addText(ar)}function hs(){if(Jr==="")return;let st=null;if(typeof Kt.subLanguage=="string"){if(!De[Kt.subLanguage]){sa.addText(Jr);return}st=Le(Kt.subLanguage,Jr,!0,B1[Kt.subLanguage]),B1[Kt.subLanguage]=st._top}else st=be(Jr,Kt.subLanguage.length?Kt.subLanguage:null);Kt.relevance>0&&(Su+=st.relevance),sa.__addSublanguage(st._emitter,st.language)}function nn(){Kt.subLanguage!=null?hs():Ns(),Jr=""}function Cs(st,jt){st!==""&&(sa.startScope(jt),sa.addText(st),sa.endScope())}function vm(st,jt){let ar=1;const wr=jt.length-1;for(;ar<=wr;){if(!st._emit[ar]){ar++;continue}const In=aa.classNameAliases[st[ar]]||st[ar],qi=jt[ar];In?Cs(qi,In):(Jr=qi,Ns(),Jr=""),ar++}}function Vl(st,jt){return st.scope&&typeof st.scope=="string"&&sa.openNode(aa.classNameAliases[st.scope]||st.scope),st.beginScope&&(st.beginScope._wrap?(Cs(Jr,aa.classNameAliases[st.beginScope._wrap]||st.beginScope._wrap),Jr=""):st.beginScope._multi&&(vm(st.beginScope,jt),Jr="")),Kt=Object.create(st,{parent:{value:Kt}}),Kt}function Qd(st,jt,ar){let wr=N(st.endRe,ar);if(wr){if(st["on:end"]){const In=new t(st);st["on:end"](jt,In),In.isMatchIgnored&&(wr=!1)}if(wr){for(;st.endsParent&&st.parent;)st=st.parent;return st}}if(st.endsWithParent)return Qd(st.parent,jt,ar)}function Yl(st){return Kt.matcher.regexIndex===0?(Jr+=st[0],1):(ku=!0,0)}function C0(st){const jt=st[0],ar=st.rule,wr=new t(ar),In=[ar.__beforeBegin,ar["on:begin"]];for(const qi of In)if(qi&&(qi(st,wr),wr.isMatchIgnored))return Yl(jt);return ar.skip?Jr+=jt:(ar.excludeBegin&&(Jr+=jt),nn(),!ar.returnBegin&&!ar.excludeBegin&&(Jr=jt)),Vl(ar,st),ar.returnBegin?0:jt.length}function ms(st){const jt=st[0],ar=At.substring(st.index),wr=Qd(Kt,st,ar);if(!wr)return Xe;const In=Kt;Kt.endScope&&Kt.endScope._wrap?(nn(),Cs(jt,Kt.endScope._wrap)):Kt.endScope&&Kt.endScope._multi?(nn(),vm(Kt.endScope,st)):In.skip?Jr+=jt:(In.returnEnd||In.excludeEnd||(Jr+=jt),nn(),In.excludeEnd&&(Jr=jt));do Kt.scope&&sa.closeNode(),!Kt.skip&&!Kt.subLanguage&&(Su+=Kt.relevance),Kt=Kt.parent;while(Kt!==wr.parent);return wr.starts&&Vl(wr.starts,st),In.returnEnd?0:jt.length}function Ql(){const st=[];for(let jt=Kt;jt!==aa;jt=jt.parent)jt.scope&&st.unshift(jt.scope);st.forEach(jt=>sa.openNode(jt))}let Jl={};function wu(st,jt){const ar=jt&&jt[0];if(Jr+=st,ar==null)return nn(),0;if(Jl.type==="begin"&&jt.type==="end"&&Jl.index===jt.index&&ar===""){if(Jr+=At.slice(jt.index,jt.index+1),!Nt){const wr=new Error(`0 width match regex (${Ye})`);throw wr.languageName=Ye,wr.badRule=Jl.rule,wr}return 1}if(Jl=jt,jt.type==="begin")return C0(jt);if(jt.type==="illegal"&&!or){const wr=new Error('Illegal lexeme "'+ar+'" for mode "'+(Kt.scope||"<unnamed>")+'"');throw wr.mode=Kt,wr}else if(jt.type==="end"){const wr=ms(jt);if(wr!==Xe)return wr}if(jt.type==="illegal"&&ar==="")return Jr+=`
`,1;if(j0>1e5&&j0>jt.index*3)throw new Error("potential infinite loop, way more iterations than matches");return Jr+=ar,ar.length}const aa=ut(Ye);if(!aa)throw Ae(Mt.replace("{}",Ye)),new Error('Unknown language: "'+Ye+'"');const z1=at(aa);let bm="",Kt=$r||z1;const B1={},sa=new et.__emitter(et);Ql();let Jr="",Su=0,Zl=0,j0=0,ku=!1;try{if(aa.__emitTokens)aa.__emitTokens(At,sa);else{for(Kt.matcher.considerAll();;){j0++,ku?ku=!1:Kt.matcher.considerAll(),Kt.matcher.lastIndex=Zl;const st=Kt.matcher.exec(At);if(!st)break;const jt=At.substring(Zl,st.index),ar=wu(jt,st);Zl=st.index+ar}wu(At.substring(Zl))}return sa.finalize(),bm=sa.toHTML(),{language:Ye,value:bm,relevance:Su,illegal:!1,_emitter:sa,_top:Kt}}catch(st){if(st.message&&st.message.includes("Illegal"))return{language:Ye,value:wt(At),illegal:!0,relevance:0,_illegalBy:{message:st.message,index:Zl,context:At.slice(Zl-100,Zl+100),mode:st.mode,resultSoFar:bm},_emitter:sa};if(Nt)return{language:Ye,value:wt(At),illegal:!1,relevance:0,errorRaised:st,_emitter:sa,_top:Kt};throw st}}function We(Ye){const At={value:wt(Ye),illegal:!1,relevance:0,_top:Je,_emitter:new et.__emitter(et)};return At._emitter.addText(Ye),At}function be(Ye,At){At=At||et.languages||Object.keys(De);const or=We(Ye),$r=At.filter(ut).filter(nr).map(nn=>Le(nn,Ye,!1));$r.unshift(or);const On=$r.sort((nn,Cs)=>{if(nn.relevance!==Cs.relevance)return Cs.relevance-nn.relevance;if(nn.language&&Cs.language){if(ut(nn.language).supersetOf===Cs.language)return 1;if(ut(Cs.language).supersetOf===nn.language)return-1}return 0}),[Aa,Ns]=On,hs=Aa;return hs.secondBest=Ns,hs}function K(Ye,At,or){const $r=At&&Ue[At]||or;Ye.classList.add("hljs"),Ye.classList.add(`language-${$r}`)}function ie(Ye){let At=null;const or=tr(Ye);if(it(or))return;if(Gl("before:highlightElement",{el:Ye,language:or}),Ye.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",Ye);return}if(Ye.children.length>0&&(et.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(Ye)),et.throwUnescapedHTML))throw new Tt("One of your code blocks includes unescaped HTML.",Ye.innerHTML);At=Ye;const $r=At.textContent,On=or?ee($r,{language:or,ignoreIllegals:!0}):be($r);Ye.innerHTML=On.value,Ye.dataset.highlighted="yes",K(Ye,or,On.language),Ye.result={language:On.language,re:On.relevance,relevance:On.relevance},On.secondBest&&(Ye.secondBest={language:On.secondBest.language,relevance:On.secondBest.relevance}),Gl("after:highlightElement",{el:Ye,result:On,text:$r})}function xe(Ye){et=Zt(et,Ye)}const Ce=()=>{Dt(),Ve("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function ht(){Dt(),Ve("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let ot=!1;function Dt(){function Ye(){Dt()}if(document.readyState==="loading"){ot||window.addEventListener("DOMContentLoaded",Ye,!1),ot=!0;return}document.querySelectorAll(et.cssSelector).forEach(ie)}function Ut(Ye,At){let or=null;try{or=At(fe)}catch($r){if(Ae("Language definition for '{}' could not be registered.".replace("{}",Ye)),Nt)Ae($r);else throw $r;or=Je}or.name||(or.name=Ye),De[Ye]=or,or.rawDefinition=At.bind(null,fe),or.aliases&&qt(or.aliases,{languageName:Ye})}function ct(Ye){delete De[Ye];for(const At of Object.keys(Ue))Ue[At]===Ye&&delete Ue[At]}function Bt(){return Object.keys(De)}function ut(Ye){return Ye=(Ye||"").toLowerCase(),De[Ye]||De[Ue[Ye]]}function qt(Ye,{languageName:At}){typeof Ye=="string"&&(Ye=[Ye]),Ye.forEach(or=>{Ue[or.toLowerCase()]=At})}function nr(Ye){const At=ut(Ye);return At&&!At.disableAutodetect}function Dr(Ye){Ye["before:highlightBlock"]&&!Ye["before:highlightElement"]&&(Ye["before:highlightElement"]=At=>{Ye["before:highlightBlock"](Object.assign({block:At.el},At))}),Ye["after:highlightBlock"]&&!Ye["after:highlightElement"]&&(Ye["after:highlightElement"]=At=>{Ye["after:highlightBlock"](Object.assign({block:At.el},At))})}function vn(Ye){Dr(Ye),dt.push(Ye)}function gm(Ye){const At=dt.indexOf(Ye);At!==-1&&dt.splice(At,1)}function Gl(Ye,At){const or=Ye;dt.forEach(function($r){$r[or]&&$r[or](At)})}function Mo(Ye){return Ve("10.7.0","highlightBlock will be removed entirely in v12.0"),Ve("10.7.0","Please use highlightElement now."),ie(Ye)}Object.assign(fe,{highlight:ee,highlightAuto:be,highlightAll:Dt,highlightElement:ie,highlightBlock:Mo,configure:xe,initHighlighting:Ce,initHighlightingOnLoad:ht,registerLanguage:Ut,unregisterLanguage:ct,listLanguages:Bt,getLanguage:ut,registerAliases:qt,autoDetection:nr,inherit:Zt,addPlugin:vn,removePlugin:gm}),fe.debugMode=function(){Nt=!1},fe.safeMode=function(){Nt=!0},fe.versionString=Ke,fe.regex={concat:b,lookahead:m,either:S,optional:v,anyNumberOfTimes:p};for(const Ye in le)typeof le[Ye]=="object"&&e(le[Ye]);return Object.assign(fe,le),fe},Ct=bt({});return Ct.newInstance=()=>bt({}),rL=Ct,Ct.HighlightJS=Ct,Ct.default=Ct,rL}var xHe=yHe();const hfe=Ur(xHe);function mfe(e,t=[]){return e.flatMap(r=>{const n=[...t,...r.properties?r.properties.className:[]];return r.children?mfe(r.children,n):{text:r.value,classes:n}})}function LJ(e){return e.value||e.children||[]}function wHe(e){return!!hfe.getLanguage(e)}function OJ({doc:e,name:t,lowlight:r,defaultLanguage:n}){const a=[];return OR(e,s=>s.type.name===t).forEach(s=>{var i;let l=s.pos+1;const c=s.node.attrs.language||n,u=r.listLanguages(),d=c&&(u.includes(c)||wHe(c)||(i=r.registered)!=null&&i.call(r,c))?LJ(r.highlight(c,s.node.textContent)):LJ(r.highlightAuto(s.node.textContent));mfe(d).forEach(f=>{const m=l+f.text.length;if(f.classes.length){const p=ga.inline(l,m,{class:f.classes.join(" ")});a.push(p)}l=m})}),en.create(e,a)}function SHe(e){return typeof e=="function"}function kHe({name:e,lowlight:t,defaultLanguage:r}){if(!["highlight","highlightAuto","listLanguages"].every(a=>SHe(t[a])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const n=new Hr({key:new Qr("lowlight"),state:{init:(a,{doc:s})=>OJ({doc:s,name:e,lowlight:t,defaultLanguage:r}),apply:(a,s,i,l)=>{const c=i.selection.$head.parent.type.name,u=l.selection.$head.parent.type.name,d=OR(i.doc,m=>m.type.name===e),f=OR(l.doc,m=>m.type.name===e);return a.docChanged&&([c,u].includes(e)||f.length!==d.length||a.steps.some(m=>m.from!==void 0&&m.to!==void 0&&d.some(p=>p.pos>=m.from&&p.pos+p.node.nodeSize<=m.to)))?OJ({doc:a.doc,name:e,lowlight:t,defaultLanguage:r}):s.map(a.mapping,a.doc)}},props:{decorations(a){return n.getState(a)}}});return n}var _He=bHe.extend({addOptions(){var e;return{...(e=this.parent)==null?void 0:e.call(this),lowlight:{},languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:4,HTMLAttributes:{}}},addProseMirrorPlugins(){var e;return[...((e=this.parent)==null?void 0:e.call(this))||[],kHe({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}}),NHe=_He;function CHe(e){const t=e.regex,r=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",i="(?!struct)("+n+"|"+t.optional(a)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",l={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},d={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},f={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},r,e.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:t.optional(a)+e.IDENT_RE,relevance:0},p=t.optional(a)+e.IDENT_RE+"\\s*\\(",v=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],b=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],y=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],S=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],k={type:b,keyword:v,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:y},j={className:"function.dispatch",relevance:0,keywords:{_hint:S},begin:t.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,e.IDENT_RE,t.lookahead(/(<[^<>]+>|)\s*\(/))},E=[j,f,l,r,e.C_BLOCK_COMMENT_MODE,d,u],T={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:k,contains:E.concat([{begin:/\(/,end:/\)/,keywords:k,contains:E.concat(["self"]),relevance:0}]),relevance:0},O={className:"function",begin:"("+i+"[\\*&\\s]+)+"+p,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:k,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:k,relevance:0},{begin:p,returnBegin:!0,contains:[m],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[u,d]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:[r,e.C_BLOCK_COMMENT_MODE,u,d,l,{begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:["self",r,e.C_BLOCK_COMMENT_MODE,u,d,l]}]},l,r,e.C_BLOCK_COMMENT_MODE,f]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:k,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(T,O,j,E,[f,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:k,contains:["self",l]},{begin:e.IDENT_RE+"::",keywords:k},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function jHe(e){const t={type:["boolean","byte","word","String"],built_in:["KeyboardController","MouseController","SoftwareSerial","EthernetServer","EthernetClient","LiquidCrystal","RobotControl","GSMVoiceCall","EthernetUDP","EsploraTFT","HttpClient","RobotMotor","WiFiClient","GSMScanner","FileSystem","Scheduler","GSMServer","YunClient","YunServer","IPAddress","GSMClient","GSMModem","Keyboard","Ethernet","Console","GSMBand","Esplora","Stepper","Process","WiFiUDP","GSM_SMS","Mailbox","USBHost","Firmata","PImage","Client","Server","GSMPIN","FileIO","Bridge","Serial","EEPROM","Stream","Mouse","Audio","Servo","File","Task","GPRS","WiFi","Wire","TFT","GSM","SPI","SD"],_hints:["setup","loop","runShellCommandAsynchronously","analogWriteResolution","retrieveCallingNumber","printFirmwareVersion","analogReadResolution","sendDigitalPortPair","noListenOnLocalhost","readJoystickButton","setFirmwareVersion","readJoystickSwitch","scrollDisplayRight","getVoiceCallStatus","scrollDisplayLeft","writeMicroseconds","delayMicroseconds","beginTransmission","getSignalStrength","runAsynchronously","getAsynchronously","listenOnLocalhost","getCurrentCarrier","readAccelerometer","messageAvailable","sendDigitalPorts","lineFollowConfig","countryNameWrite","runShellCommand","readStringUntil","rewindDirectory","readTemperature","setClockDivider","readLightSensor","endTransmission","analogReference","detachInterrupt","countryNameRead","attachInterrupt","encryptionType","readBytesUntil","robotNameWrite","readMicrophone","robotNameRead","cityNameWrite","userNameWrite","readJoystickY","readJoystickX","mouseReleased","openNextFile","scanNetworks","noInterrupts","digitalWrite","beginSpeaker","mousePressed","isActionDone","mouseDragged","displayLogos","noAutoscroll","addParameter","remoteNumber","getModifiers","keyboardRead","userNameRead","waitContinue","processInput","parseCommand","printVersion","readNetworks","writeMessage","blinkVersion","cityNameRead","readMessage","setDataMode","parsePacket","isListening","setBitOrder","beginPacket","isDirectory","motorsWrite","drawCompass","digitalRead","clearScreen","serialEvent","rightToLeft","setTextSize","leftToRight","requestFrom","keyReleased","compassRead","analogWrite","interrupts","WiFiServer","disconnect","playMelody","parseFloat","autoscroll","getPINUsed","setPINUsed","setTimeout","sendAnalog","readSlider","analogRead","beginWrite","createChar","motorsStop","keyPressed","tempoWrite","readButton","subnetMask","debugPrint","macAddress","writeGreen","randomSeed","attachGPRS","readString","sendString","remotePort","releaseAll","mouseMoved","background","getXChange","getYChange","answerCall","getResult","voiceCall","endPacket","constrain","getSocket","writeJSON","getButton","available","connected","findUntil","readBytes","exitValue","readGreen","writeBlue","startLoop","IPAddress","isPressed","sendSysex","pauseMode","gatewayIP","setCursor","getOemKey","tuneWrite","noDisplay","loadImage","switchPIN","onRequest","onReceive","changePIN","playFile","noBuffer","parseInt","overflow","checkPIN","knobRead","beginTFT","bitClear","updateIR","bitWrite","position","writeRGB","highByte","writeRed","setSpeed","readBlue","noStroke","remoteIP","transfer","shutdown","hangCall","beginSMS","endWrite","attached","maintain","noCursor","checkReg","checkPUK","shiftOut","isValid","shiftIn","pulseIn","connect","println","localIP","pinMode","getIMEI","display","noBlink","process","getBand","running","beginSD","drawBMP","lowByte","setBand","release","bitRead","prepare","pointTo","readRed","setMode","noFill","remove","listen","stroke","detach","attach","noTone","exists","buffer","height","bitSet","circle","config","cursor","random","IRread","setDNS","endSMS","getKey","micros","millis","begin","print","write","ready","flush","width","isPIN","blink","clear","press","mkdir","rmdir","close","point","yield","image","BSSID","click","delay","read","text","move","peek","beep","rect","line","open","seek","fill","size","turn","stop","home","find","step","tone","sqrt","RSSI","SSID","end","bit","tan","cos","sin","pow","map","abs","max","min","get","run","put"],literal:["DIGITAL_MESSAGE","FIRMATA_STRING","ANALOG_MESSAGE","REPORT_DIGITAL","REPORT_ANALOG","INPUT_PULLUP","SET_PIN_MODE","INTERNAL2V56","SYSTEM_RESET","LED_BUILTIN","INTERNAL1V1","SYSEX_START","INTERNAL","EXTERNAL","DEFAULT","OUTPUT","INPUT","HIGH","LOW"]},r=CHe(e),n=r.keywords;return n.type=[...n.type,...t.type],n.literal=[...n.literal,...t.literal],n.built_in=[...n.built_in,...t.built_in],n._hints=t._hints,r.name="Arduino",r.aliases=["ino"],r.supersetOf="cpp",r}function EHe(e){const t=e.regex,r={},n={begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[r]}]};Object.assign(r,{className:"variable",variants:[{begin:t.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},n]});const a={className:"subst",begin:/\$\(/,end:/\)/,contains:[e.BACKSLASH_ESCAPE]},s=e.inherit(e.COMMENT(),{match:[/(^|\s)/,/#.*$/],scope:{2:"comment"}}),i={begin:/<<-?\s*(?=\w+)/,starts:{contains:[e.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},l={className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,r,a]};a.contains.push(l);const c={match:/\\"/},u={className:"string",begin:/'/,end:/'/},d={match:/\\'/},f={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},e.NUMBER_MODE,r]},m=["fish","bash","zsh","sh","csh","ksh","tcsh","dash","scsh"],p=e.SHEBANG({binary:`(${m.join("|")})`,relevance:10}),v={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:!0,contains:[e.inherit(e.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0},b=["if","then","else","elif","fi","time","for","while","until","in","do","done","case","esac","coproc","function","select"],y=["true","false"],S={match:/(\/[a-z._-]+)+/},_=["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset"],N=["alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","sudo","type","typeset","ulimit","unalias"],k=["autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp"],j=["chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"];return{name:"Bash",aliases:["sh","zsh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:b,literal:y,built_in:[..._,...N,"set","shopt",...k,...j]},contains:[p,e.SHEBANG(),v,f,s,i,S,l,c,u,d,r]}}function MHe(e){const t=e.regex,r=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",i="("+n+"|"+t.optional(a)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",l={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},d={className:"number",variants:[{match:/\b(0b[01']+)/},{match:/(-?)\b([\d']+(\.[\d']*)?|\.[\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)/},{match:/(-?)\b(0[xX][a-fA-F0-9]+(?:'[a-fA-F0-9]+)*(?:\.[a-fA-F0-9]*(?:'[a-fA-F0-9]*)*)?(?:[pP][-+]?[0-9]+)?(l|L)?(u|U)?)/},{match:/(-?)\b\d+(?:'\d+)*(?:\.\d*(?:'\d*)*)?(?:[eE][-+]?\d+)?/}],relevance:0},f={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef elifdef elifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},r,e.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:t.optional(a)+e.IDENT_RE,relevance:0},p=t.optional(a)+e.IDENT_RE+"\\s*\\(",y={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","typeof","typeof_unqual","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_BitInt","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal96","_Decimal128","_Decimal64x","_Decimal128x","_Float16","_Float32","_Float64","_Float128","_Float32x","_Float64x","_Float128x","const","static","constexpr","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},S=[f,l,r,e.C_BLOCK_COMMENT_MODE,d,u],_={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:y,contains:S.concat([{begin:/\(/,end:/\)/,keywords:y,contains:S.concat(["self"]),relevance:0}]),relevance:0},N={begin:"("+i+"[\\*&\\s]+)+"+p,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:y,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:y,relevance:0},{begin:p,returnBegin:!0,contains:[e.inherit(m,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:y,relevance:0,contains:[r,e.C_BLOCK_COMMENT_MODE,u,d,l,{begin:/\(/,end:/\)/,keywords:y,relevance:0,contains:["self",r,e.C_BLOCK_COMMENT_MODE,u,d,l]}]},l,r,e.C_BLOCK_COMMENT_MODE,f]};return{name:"C",aliases:["h"],keywords:y,disableAutodetect:!0,illegal:"</",contains:[].concat(_,N,S,[f,{begin:e.IDENT_RE+"::",keywords:y},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},e.TITLE_MODE]}]),exports:{preprocessor:f,strings:u,keywords:y}}}function THe(e){const t=e.regex,r=e.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",i="(?!struct)("+n+"|"+t.optional(a)+"[a-zA-Z_]\\w*"+t.optional("<[^<>]+>")+")",l={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},u={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},e.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},d={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},f={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(u,{className:"string"}),{className:"string",begin:/<.*?>/},r,e.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:t.optional(a)+e.IDENT_RE,relevance:0},p=t.optional(a)+e.IDENT_RE+"\\s*\\(",v=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],b=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],y=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],S=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],k={type:b,keyword:v,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:y},j={className:"function.dispatch",relevance:0,keywords:{_hint:S},begin:t.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,e.IDENT_RE,t.lookahead(/(<[^<>]+>|)\s*\(/))},E=[j,f,l,r,e.C_BLOCK_COMMENT_MODE,d,u],T={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:k,contains:E.concat([{begin:/\(/,end:/\)/,keywords:k,contains:E.concat(["self"]),relevance:0}]),relevance:0},O={className:"function",begin:"("+i+"[\\*&\\s]+)+"+p,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:k,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:k,relevance:0},{begin:p,returnBegin:!0,contains:[m],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[u,d]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:[r,e.C_BLOCK_COMMENT_MODE,u,d,l,{begin:/\(/,end:/\)/,keywords:k,relevance:0,contains:["self",r,e.C_BLOCK_COMMENT_MODE,u,d,l]}]},l,r,e.C_BLOCK_COMMENT_MODE,f]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:k,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(T,O,j,E,[f,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:k,contains:["self",l]},{begin:e.IDENT_RE+"::",keywords:k},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function AHe(e){const t=["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],r=["public","private","protected","static","internal","protected","abstract","async","extern","override","unsafe","virtual","new","sealed","partial"],n=["default","false","null","true"],a=["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"],s=["add","alias","and","ascending","args","async","await","by","descending","dynamic","equals","file","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","record","remove","required","scoped","select","set","unmanaged","value|0","var","when","where","with","yield"],i={keyword:a.concat(s),built_in:t,literal:n},l=e.inherit(e.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),c={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},u={className:"string",begin:/"""("*)(?!")(.|\n)*?"""\1/,relevance:1},d={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},f=e.inherit(d,{illegal:/\n/}),m={className:"subst",begin:/\{/,end:/\}/,keywords:i},p=e.inherit(m,{illegal:/\n/}),v={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},e.BACKSLASH_ESCAPE,p]},b={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},m]},y=e.inherit(b,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},p]});m.contains=[b,v,d,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,c,e.C_BLOCK_COMMENT_MODE],p.contains=[y,v,f,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,c,e.inherit(e.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];const S={variants:[u,b,v,d,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},_={begin:"<",end:">",contains:[{beginKeywords:"in out"},l]},N=e.IDENT_RE+"(<"+e.IDENT_RE+"(\\s*,\\s*"+e.IDENT_RE+")*>)?(\\[\\])?",k={begin:"@"+e.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:i,illegal:/::/,contains:[e.COMMENT("///","$",{returnBegin:!0,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},S,c,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},l,_,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[l,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[l,_,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:!0,end:"\\]",excludeEnd:!0,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+N+"\\s+)+"+e.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,end:/\s*[{;=]/,excludeEnd:!0,keywords:i,contains:[{beginKeywords:r.join(" "),relevance:0},{begin:e.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,contains:[e.TITLE_MODE,_],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:i,relevance:0,contains:[S,c,e.C_BLOCK_COMMENT_MODE]},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},k]}}const DHe=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),LHe=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],OHe=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],IHe=[...LHe,...OHe],RHe=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),PHe=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),zHe=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),BHe=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function $He(e){const t=e.regex,r=DHe(e),n={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},a="and or not only",s=/@-?\w[\w]*(-\w+)*/,i="[a-zA-Z-][a-zA-Z0-9_-]*",l=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:!0,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[r.BLOCK_COMMENT,n,r.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+i,relevance:0},r.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+PHe.join("|")+")"},{begin:":(:)?("+zHe.join("|")+")"}]},r.CSS_VARIABLE,{className:"attribute",begin:"\\b("+BHe.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[r.BLOCK_COMMENT,r.HEXCOLOR,r.IMPORTANT,r.CSS_NUMBER_MODE,...l,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...l,{className:"string",begin:/[^)]/,endsWithParent:!0,excludeEnd:!0}]},r.FUNCTION_DISPATCH]},{begin:t.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:s},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:a,attribute:RHe.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...l,r.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+IHe.join("|")+")\\b"}]}}function FHe(e){const t=e.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:t.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:t.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}function UHe(e){const s={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:s,illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"string",variants:[e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{match:/-?\b0[xX]\.[a-fA-F0-9](_?[a-fA-F0-9])*[pP][+-]?\d(_?\d)*i?/,relevance:0},{match:/-?\b0[xX](_?[a-fA-F0-9])+((\.([a-fA-F0-9](_?[a-fA-F0-9])*)?)?[pP][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b0[oO](_?[0-7])*i?/,relevance:0},{match:/-?\.\d(_?\d)*([eE][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b\d(_?\d)*(\.(\d(_?\d)*)?)?([eE][+-]?\d(_?\d)*)?i?/,relevance:0}]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:!0,contains:[e.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:s,illegal:/["']/}]}]}}function HHe(e){const t=e.regex,r=/[_A-Za-z][_0-9A-Za-z]*/;return{name:"GraphQL",aliases:["gql"],case_insensitive:!0,disableAutodetect:!1,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[e.HASH_COMMENT_MODE,e.QUOTE_STRING_MODE,e.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:!0,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:!0},{scope:"symbol",begin:t.concat(r,t.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}function qHe(e){const t=e.regex,r={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:e.NUMBER_RE}]},n=e.COMMENT();n.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];const a={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},s={className:"literal",begin:/\bon|off|true|false|yes|no\b/},i={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},l={begin:/\[/,end:/\]/,contains:[n,s,a,i,r,"self"],relevance:0},c=/[A-Za-z0-9_-]+/,u=/"(\\"|[^"])*"/,d=/'[^']*'/,f=t.either(c,u,d),m=t.concat(f,"(\\s*\\.\\s*",f,")*",t.lookahead(/\s*=\s*[^#\s]/));return{name:"TOML, also INI",aliases:["toml"],case_insensitive:!0,illegal:/\S/,contains:[n,{className:"section",begin:/\[+/,end:/\]+/},{begin:m,className:"attr",starts:{end:/$/,contains:[n,l,s,a,i,r]}}]}}var yp="[0-9](_*[0-9])*",SS=`\\.(${yp})`,kS="[0-9a-fA-F](_*[0-9a-fA-F])*",IJ={className:"number",variants:[{begin:`(\\b(${yp})((${SS})|\\.)?|(${SS}))[eE][+-]?(${yp})[fFdD]?\\b`},{begin:`\\b(${yp})((${SS})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${SS})[fFdD]?\\b`},{begin:`\\b(${yp})[fFdD]\\b`},{begin:`\\b0[xX]((${kS})\\.?|(${kS})?\\.(${kS}))[pP][+-]?(${yp})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${kS})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function pfe(e,t,r){return r===-1?"":e.replace(t,n=>pfe(e,t,r-1))}function WHe(e){const t=e.regex,r="[-a-zA-Z_$][-a-zA-Z_$0-9]*",n=r+pfe("(?:<"+r+"~~~(?:\\s*,\\s*"+r+"~~~)*>)?",/~~~/g,2),c={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits","goto","when"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},u={className:"meta",begin:"@"+r,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},d={className:"params",begin:/\(/,end:/\)/,keywords:c,relevance:0,contains:[e.C_BLOCK_COMMENT_MODE],endsParent:!0};return{name:"Java",aliases:["jsp"],keywords:c,illegal:/<\/|#/,contains:[e.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[e.BACKSLASH_ESCAPE]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,r],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[t.concat(/(?!else)/,r),/\s+/,r,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,r],className:{1:"keyword",3:"title.class"},contains:[d,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+n+"\\s+)",e.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:c,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:c,relevance:0,contains:[u,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,IJ,e.C_BLOCK_COMMENT_MODE]},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},IJ,u]}}const RJ="[A-Za-z$_][0-9A-Za-z$_]*",KHe=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],GHe=["true","false","null","undefined","NaN","Infinity"],gfe=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],vfe=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],bfe=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],VHe=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],YHe=[].concat(bfe,gfe,vfe);function QHe(e){const t=e.regex,r=(F,{after:q})=>{const Q="</"+F[0].slice(1);return F.input.indexOf(Q,q)!==-1},n=RJ,a={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,i={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(F,q)=>{const Q=F[0].length+F.index,W=F.input[Q];if(W==="<"||W===","){q.ignoreMatch();return}W===">"&&(r(F,{after:Q})||q.ignoreMatch());let G;const J=F.input.substring(Q);if(G=J.match(/^\s*=/)){q.ignoreMatch();return}if((G=J.match(/^\s+extends\s+/))&&G.index===0){q.ignoreMatch();return}}},l={$pattern:RJ,keyword:KHe,literal:GHe,built_in:YHe,"variable.language":VHe},c="[0-9](_?[0-9])*",u=`\\.(${c})`,d="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",f={className:"number",variants:[{begin:`(\\b(${d})((${u})|\\.)?|(${u}))[eE][+-]?(${c})\\b`},{begin:`\\b(${d})\\b((${u})\\b|\\.)?|(${u})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},m={className:"subst",begin:"\\$\\{",end:"\\}",keywords:l,contains:[]},p={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"xml"}},v={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"css"}},b={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"graphql"}},y={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,m]},_={className:"comment",variants:[e.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:n+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]},N=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,{match:/\$\d+/},f];m.contains=N.concat({begin:/\{/,end:/\}/,keywords:l,contains:["self"].concat(N)});const k=[].concat(_,m.contains),j=k.concat([{begin:/(\s*)\(/,end:/\)/,keywords:l,contains:["self"].concat(k)}]),E={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j},T={variants:[{match:[/class/,/\s+/,n,/\s+/,/extends/,/\s+/,t.concat(n,"(",t.concat(/\./,n),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,n],scope:{1:"keyword",3:"title.class"}}]},O={relevance:0,match:t.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...gfe,...vfe]}},R={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},H={variants:[{match:[/function/,/\s+/,n,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[E],illegal:/%/},$={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function L(F){return t.concat("(?!",F.join("|"),")")}const A={match:t.concat(/\b/,L([...bfe,"super","import"].map(F=>`${F}\\s*\\(`)),n,t.lookahead(/\s*\(/)),className:"title.function",relevance:0},M={begin:t.concat(/\./,t.lookahead(t.concat(n,/(?![0-9A-Za-z$_(])/))),end:n,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},P={match:[/get|set/,/\s+/,n,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},E]},I="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+e.UNDERSCORE_IDENT_RE+")\\s*=>",B={match:[/const|var|let/,/\s+/,n,/\s*/,/=\s*/,/(async\s*)?/,t.lookahead(I)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[E]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:l,exports:{PARAMS_CONTAINS:j,CLASS_REFERENCE:O},illegal:/#(?![$_A-z])/,contains:[e.SHEBANG({label:"shebang",binary:"node",relevance:5}),R,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,_,{match:/\$\d+/},f,O,{scope:"attr",match:n+t.lookahead(":"),relevance:0},B,{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[_,e.REGEXP_MODE,{className:"function",begin:I,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:e.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:a.begin,end:a.end},{match:s},{begin:i.begin,"on:begin":i.isTrulyOpeningTag,end:i.end}],subLanguage:"xml",contains:[{begin:i.begin,end:i.end,skip:!0,contains:["self"]}]}]},H,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+e.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[E,e.inherit(e.TITLE_MODE,{begin:n,className:"title.function"})]},{match:/\.\.\./,relevance:0},M,{match:"\\$"+n,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[E]},A,$,T,P,{match:/\$[(.]/}]}}function JHe(e){const t={className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},r={match:/[{}[\],:]/,className:"punctuation",relevance:0},n=["true","false","null"],a={scope:"literal",beginKeywords:n.join(" ")};return{name:"JSON",aliases:["jsonc"],keywords:{literal:n},contains:[t,r,e.QUOTE_STRING_MODE,a,e.C_NUMBER_MODE,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}var xp="[0-9](_*[0-9])*",_S=`\\.(${xp})`,NS="[0-9a-fA-F](_*[0-9a-fA-F])*",ZHe={className:"number",variants:[{begin:`(\\b(${xp})((${_S})|\\.)?|(${_S}))[eE][+-]?(${xp})[fFdD]?\\b`},{begin:`\\b(${xp})((${_S})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${_S})[fFdD]?\\b`},{begin:`\\b(${xp})[fFdD]\\b`},{begin:`\\b0[xX]((${NS})\\.?|(${NS})?\\.(${NS}))[pP][+-]?(${xp})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${NS})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function XHe(e){const t={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},r={className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},n={className:"symbol",begin:e.UNDERSCORE_IDENT_RE+"@"},a={className:"subst",begin:/\$\{/,end:/\}/,contains:[e.C_NUMBER_MODE]},s={className:"variable",begin:"\\$"+e.UNDERSCORE_IDENT_RE},i={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[s,a]},{begin:"'",end:"'",illegal:/\n/,contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[e.BACKSLASH_ESCAPE,s,a]}]};a.contains.push(i);const l={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+e.UNDERSCORE_IDENT_RE+")?"},c={className:"meta",begin:"@"+e.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[e.inherit(i,{className:"string"}),"self"]}]},u=ZHe,d=e.COMMENT("/\\*","\\*/",{contains:[e.C_BLOCK_COMMENT_MODE]}),f={variants:[{className:"type",begin:e.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]},m=f;return m.variants[1].contains=[f],f.variants[1].contains=[m],{name:"Kotlin",aliases:["kt","kts"],keywords:t,contains:[e.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),e.C_LINE_COMMENT_MODE,d,r,n,l,c,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:!0,excludeEnd:!0,keywords:t,relevance:5,contains:[{begin:e.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:!0,relevance:0,contains:[e.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:t,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:!0,contains:[f,e.C_LINE_COMMENT_MODE,d],relevance:0},e.C_LINE_COMMENT_MODE,d,l,c,i,e.C_NUMBER_MODE]},d]},{begin:[/class|interface|trait/,/\s+/,e.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:!0,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},e.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:!0,returnEnd:!0},l,c]},i,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:`
`},u]}}const eqe=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),tqe=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],rqe=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],nqe=[...tqe,...rqe],aqe=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),yfe=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),xfe=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),sqe=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse(),iqe=yfe.concat(xfe).sort().reverse();function oqe(e){const t=eqe(e),r=iqe,n="and or not only",a="[\\w-]+",s="("+a+"|@\\{"+a+"\\})",i=[],l=[],c=function(N){return{className:"string",begin:"~?"+N+".*?"+N}},u=function(N,k,j){return{className:N,begin:k,relevance:j}},d={$pattern:/[a-z-]+/,keyword:n,attribute:aqe.join(" ")},f={begin:"\\(",end:"\\)",contains:l,keywords:d,relevance:0};l.push(e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,c("'"),c('"'),t.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:!0}},t.HEXCOLOR,f,u("variable","@@?"+a,10),u("variable","@\\{"+a+"\\}"),u("built_in","~?`[^`]*?`"),{className:"attribute",begin:a+"\\s*:",end:":",returnBegin:!0,excludeEnd:!0},t.IMPORTANT,{beginKeywords:"and not"},t.FUNCTION_DISPATCH);const m=l.concat({begin:/\{/,end:/\}/,contains:i}),p={beginKeywords:"when",endsWithParent:!0,contains:[{beginKeywords:"and not"}].concat(l)},v={begin:s+"\\s*:",returnBegin:!0,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},t.CSS_VARIABLE,{className:"attribute",begin:"\\b("+sqe.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:!0,illegal:"[<=$]",relevance:0,contains:l}}]},b={className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:d,returnEnd:!0,contains:l,relevance:0}},y={className:"variable",variants:[{begin:"@"+a+"\\s*:",relevance:15},{begin:"@"+a}],starts:{end:"[;}]",returnEnd:!0,contains:m}},S={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:s,end:/\{/}],returnBegin:!0,returnEnd:!0,illegal:`[<='$"]`,relevance:0,contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,p,u("keyword","all\\b"),u("variable","@\\{"+a+"\\}"),{begin:"\\b("+nqe.join("|")+")\\b",className:"selector-tag"},t.CSS_NUMBER_MODE,u("selector-tag",s,0),u("selector-id","#"+s),u("selector-class","\\."+s,0),u("selector-tag","&",0),t.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+yfe.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+xfe.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:m},{begin:"!important"},t.FUNCTION_DISPATCH]},_={begin:a+`:(:)?(${r.join("|")})`,returnBegin:!0,contains:[S]};return i.push(e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,b,y,_,v,S,p,t.FUNCTION_DISPATCH),{name:"Less",case_insensitive:!0,illegal:`[=>'/<($"]`,contains:i}}function lqe(e){const t="\\[=*\\[",r="\\]=*\\]",n={begin:t,end:r,contains:["self"]},a=[e.COMMENT("--(?!"+t+")","$"),e.COMMENT("--"+t,r,{contains:[n],relevance:10})];return{name:"Lua",aliases:["pluto"],keywords:{$pattern:e.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:a.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[e.inherit(e.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:!0,contains:a}].concat(a)},e.C_NUMBER_MODE,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,{className:"string",begin:t,end:r,contains:[n],relevance:5}])}}function cqe(e){const t={className:"variable",variants:[{begin:"\\$\\("+e.UNDERSCORE_IDENT_RE+"\\)",contains:[e.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},r={className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,t]},n={className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[t,r]},a={begin:"^"+e.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"},s={className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},i={className:"section",begin:/^[^\s]+:/,end:/$/,contains:[t]};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[e.HASH_COMMENT_MODE,t,r,n,a,s,i]}}function uqe(e){const t=e.regex,r={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},n={begin:"^[-\\*]{3,}",end:"$"},a={className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},s={className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:!0},i={begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]},l=/[A-Za-z][A-Za-z0-9+.-]*/,c={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:t.concat(/\[.+?\]\(/,l,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:!0,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}]},u={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},d={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},f=e.inherit(u,{contains:[]}),m=e.inherit(d,{contains:[]});u.contains.push(m),d.contains.push(f);let p=[r,c];return[u,d,f,m].forEach(S=>{S.contains=S.contains.concat(p)}),p=p.concat(u,d),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:p},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:p}]}]},r,s,u,d,{className:"quote",begin:"^>\\s+",contains:p,end:"$"},a,n,c,i,{scope:"literal",match:/&([a-zA-Z0-9]+|#[0-9]{1,7}|#[Xx][0-9a-fA-F]{1,6});/}]}}function dqe(e){const t={className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},r=/[a-zA-Z@][a-zA-Z0-9_]*/,l={"variable.language":["this","super"],$pattern:r,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},c={$pattern:r,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:l,illegal:"</",contains:[t,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,e.C_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},e.inherit(e.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+c.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:!0,keywords:c,contains:[e.UNDERSCORE_TITLE_MODE]},{begin:"\\."+e.UNDERSCORE_IDENT_RE,relevance:0}]}}function fqe(e){const t=e.regex,r=["abs","accept","alarm","and","atan2","bind","binmode","bless","break","caller","chdir","chmod","chomp","chop","chown","chr","chroot","class","close","closedir","connect","continue","cos","crypt","dbmclose","dbmopen","defined","delete","die","do","dump","each","else","elsif","endgrent","endhostent","endnetent","endprotoent","endpwent","endservent","eof","eval","exec","exists","exit","exp","fcntl","field","fileno","flock","for","foreach","fork","format","formline","getc","getgrent","getgrgid","getgrnam","gethostbyaddr","gethostbyname","gethostent","getlogin","getnetbyaddr","getnetbyname","getnetent","getpeername","getpgrp","getpriority","getprotobyname","getprotobynumber","getprotoent","getpwent","getpwnam","getpwuid","getservbyname","getservbyport","getservent","getsockname","getsockopt","given","glob","gmtime","goto","grep","gt","hex","if","index","int","ioctl","join","keys","kill","last","lc","lcfirst","length","link","listen","local","localtime","log","lstat","lt","ma","map","method","mkdir","msgctl","msgget","msgrcv","msgsnd","my","ne","next","no","not","oct","open","opendir","or","ord","our","pack","package","pipe","pop","pos","print","printf","prototype","push","q|0","qq","quotemeta","qw","qx","rand","read","readdir","readline","readlink","readpipe","recv","redo","ref","rename","require","reset","return","reverse","rewinddir","rindex","rmdir","say","scalar","seek","seekdir","select","semctl","semget","semop","send","setgrent","sethostent","setnetent","setpgrp","setpriority","setprotoent","setpwent","setservent","setsockopt","shift","shmctl","shmget","shmread","shmwrite","shutdown","sin","sleep","socket","socketpair","sort","splice","split","sprintf","sqrt","srand","stat","state","study","sub","substr","symlink","syscall","sysopen","sysread","sysseek","system","syswrite","tell","telldir","tie","tied","time","times","tr","truncate","uc","ucfirst","umask","undef","unless","unlink","unpack","unshift","untie","until","use","utime","values","vec","wait","waitpid","wantarray","warn","when","while","write","x|0","xor","y|0"],n=/[dualxmsipngr]{0,12}/,a={$pattern:/[\w.]+/,keyword:r.join(" ")},s={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:a},i={begin:/->\{/,end:/\}/},l={scope:"attr",match:/\s+:\s*\w+(\s*\(.*?\))?/},c={scope:"variable",variants:[{begin:/\$\d/},{begin:t.concat(/[$%@](?!")(\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@](?!")[^\s\w{=]|\$=/,relevance:0}],contains:[l]},u={className:"number",variants:[{match:/0?\.[0-9][0-9_]+\b/},{match:/\bv?(0|[1-9][0-9_]*(\.[0-9_]+)?|[1-9][0-9_]*)\b/},{match:/\b0[0-7][0-7_]*\b/},{match:/\b0x[0-9a-fA-F][0-9a-fA-F_]*\b/},{match:/\b0b[0-1][0-1_]*\b/}],relevance:0},d=[e.BACKSLASH_ESCAPE,s,c],f=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],m=(b,y,S="\\1")=>{const _=S==="\\1"?S:t.concat(S,y);return t.concat(t.concat("(?:",b,")"),y,/(?:\\.|[^\\\/])*?/,_,/(?:\\.|[^\\\/])*?/,S,n)},p=(b,y,S)=>t.concat(t.concat("(?:",b,")"),y,/(?:\\.|[^\\\/])*?/,S,n),v=[c,e.HASH_COMMENT_MODE,e.COMMENT(/^=\w/,/=cut/,{endsWithParent:!0}),i,{className:"string",contains:d,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},u,{begin:"(\\/\\/|"+e.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[e.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:m("s|tr|y",t.either(...f,{capture:!0}))},{begin:m("s|tr|y","\\(","\\)")},{begin:m("s|tr|y","\\[","\\]")},{begin:m("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:p("(?:m|qr)?",/\//,/\//)},{begin:p("m|qr",t.either(...f,{capture:!0}),/\1/)},{begin:p("m|qr",/\(/,/\)/)},{begin:p("m|qr",/\[/,/\]/)},{begin:p("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub method",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE,l]},{className:"class",beginKeywords:"class",end:"[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE,l,u]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return s.contains=v,i.contains=v,{name:"Perl",aliases:["pl","pm"],keywords:a,contains:v}}function hqe(e){const t=e.regex,r=/(?![A-Za-z0-9])(?![$])/,n=t.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,r),a=t.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,r),s=t.concat(/[A-Z]+/,r),i={scope:"variable",match:"\\$+"+n},l={scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},c={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},u=e.inherit(e.APOS_STRING_MODE,{illegal:null}),d=e.inherit(e.QUOTE_STRING_MODE,{illegal:null,contains:e.QUOTE_STRING_MODE.contains.concat(c)}),f={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:e.QUOTE_STRING_MODE.contains.concat(c),"on:begin":(M,P)=>{P.data._beginMatch=M[1]||M[2]},"on:end":(M,P)=>{P.data._beginMatch!==M[1]&&P.ignoreMatch()}},m=e.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),p=`[ 	
]`,v={scope:"string",variants:[d,u,f,m]},b={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},y=["false","null","true"],S=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],_=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],k={keyword:S,literal:(M=>{const P=[];return M.forEach(I=>{P.push(I),I.toLowerCase()===I?P.push(I.toUpperCase()):P.push(I.toLowerCase())}),P})(y),built_in:_},j=M=>M.map(P=>P.replace(/\|\d+$/,"")),E={variants:[{match:[/new/,t.concat(p,"+"),t.concat("(?!",j(_).join("\\b|"),"\\b)"),a],scope:{1:"keyword",4:"title.class"}}]},T=t.concat(n,"\\b(?!\\()"),O={variants:[{match:[t.concat(/::/,t.lookahead(/(?!class\b)/)),T],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[a,t.concat(/::/,t.lookahead(/(?!class\b)/)),T],scope:{1:"title.class",3:"variable.constant"}},{match:[a,t.concat("::",t.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[a,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},R={scope:"attr",match:t.concat(n,t.lookahead(":"),t.lookahead(/(?!::)/))},H={relevance:0,begin:/\(/,end:/\)/,keywords:k,contains:[R,i,O,e.C_BLOCK_COMMENT_MODE,v,b,E]},$={relevance:0,match:[/\b/,t.concat("(?!fn\\b|function\\b|",j(S).join("\\b|"),"|",j(_).join("\\b|"),"\\b)"),n,t.concat(p,"*"),t.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[H]};H.contains.push($);const L=[R,O,e.C_BLOCK_COMMENT_MODE,v,b,E],A={begin:t.concat(/#\[\s*\\?/,t.either(a,s)),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:y,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:y,keyword:["new","array"]},contains:["self",...L]},...L,{scope:"meta",variants:[{match:a},{match:s}]}]};return{case_insensitive:!1,keywords:k,contains:[A,e.HASH_COMMENT_MODE,e.COMMENT("//","$"),e.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:e.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:!0}]}},l,{scope:"variable.language",match:/\$this\b/},i,$,O,{match:[/const/,/\s/,n],scope:{1:"keyword",3:"variable.constant"}},E,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:!0,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},e.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:!0},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0,keywords:k,contains:["self",A,i,O,e.C_BLOCK_COMMENT_MODE,v,b]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:!0,contains:[{beginKeywords:"extends implements"},e.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[e.inherit(e.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},e.UNDERSCORE_TITLE_MODE]},v,b]}}function mqe(e){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},e.inherit(e.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),e.inherit(e.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]}]}}function pqe(e){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:!0}}function gqe(e){const t=e.regex,r=/[\p{XID_Start}_]\p{XID_Continue}*/u,n=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],l={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:n,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},u={className:"subst",begin:/\{/,end:/\}/,keywords:l,illegal:/#/},d={begin:/\{\{/,relevance:0},f={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,c,d,u]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,c,d,u]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[e.BACKSLASH_ESCAPE,d,u]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,d,u]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},m="[0-9](_?[0-9])*",p=`(\\b(${m}))?\\.(${m})|\\b(${m})\\.`,v=`\\b|${n.join("|")}`,b={className:"number",relevance:0,variants:[{begin:`(\\b(${m})|(${p}))[eE][+-]?(${m})[jJ]?(?=${v})`},{begin:`(${p})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${v})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${v})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${v})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${v})`},{begin:`\\b(${m})[jJ](?=${v})`}]},y={className:"comment",begin:t.lookahead(/# type:/),end:/$/,keywords:l,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},S={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:["self",c,b,f,e.HASH_COMMENT_MODE]}]};return u.contains=[f,b,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:l,illegal:/(<\/|\?)|=>/,contains:[c,b,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},f,y,e.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,r],scope:{1:"keyword",3:"title.function"},contains:[S]},{variants:[{match:[/\bclass/,/\s+/,r,/\s*/,/\(\s*/,r,/\s*\)/]},{match:[/\bclass/,/\s+/,r]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[b,S,f]}]}}function vqe(e){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}function bqe(e){const t=e.regex,r=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,n=t.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),a=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,s=t.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:r,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[e.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:t.lookahead(t.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:!0}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:r},{match:/`(?:\\.|[^`\\])+`/}],endsParent:!0}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),e.HASH_COMMENT_MODE,{scope:"string",contains:[e.BACKSLASH_ESCAPE],variants:[e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),e.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[a,n]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,n]},{scope:{1:"punctuation",2:"number"},match:[s,n]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,n]}]},{scope:{3:"operator"},match:[r,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:a},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:s},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}function yqe(e){const t=e.regex,r="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",n=t.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),a=t.concat(n,/(::\w+)*/),i={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield",...["include","extend","prepend","public","private","protected","raise","throw"]],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},l={className:"doctag",begin:"@[A-Za-z]+"},c={begin:"#<",end:">"},u=[e.COMMENT("#","$",{contains:[l]}),e.COMMENT("^=begin","^=end",{contains:[l],relevance:10}),e.COMMENT("^__END__",e.MATCH_NOTHING_RE)],d={className:"subst",begin:/#\{/,end:/\}/,keywords:i},f={className:"string",contains:[e.BACKSLASH_ESCAPE,d],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:t.concat(/<<[-~]?'?/,t.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[e.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[e.BACKSLASH_ESCAPE,d]})]}]},m="[1-9](_?[0-9])*|0",p="[0-9](_?[0-9])*",v={className:"number",relevance:0,variants:[{begin:`\\b(${m})(\\.(${p}))?([eE][+-]?(${p})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},b={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:!0,endsParent:!0,keywords:i}]},E=[f,{variants:[{match:[/class\s+/,a,/\s+<\s+/,a]},{match:[/\b(class|module)\s+/,a]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:i},{match:[/(include|extend)\s+/,a],scope:{2:"title.class"},keywords:i},{relevance:0,match:[a,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:n,scope:"title.class"},{match:[/def/,/\s+/,r],scope:{1:"keyword",3:"title.function"},contains:[b]},{begin:e.IDENT_RE+"::"},{className:"symbol",begin:e.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[f,{begin:r}],relevance:0},v,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|(?!=)/,end:/\|/,excludeBegin:!0,excludeEnd:!0,relevance:0,keywords:i},{begin:"("+e.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[e.BACKSLASH_ESCAPE,d],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(c,u),relevance:0}].concat(c,u);d.contains=E,b.contains=E;const H=[{begin:/^\s*=>/,starts:{end:"$",contains:E}},{className:"meta.prompt",begin:"^("+"[>?]>"+"|"+"[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]"+"|"+"(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>"+")(?=[ ])",starts:{end:"$",keywords:i,contains:E}}];return u.unshift(c),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:i,illegal:/\/\*/,contains:[e.SHEBANG({binary:"ruby"})].concat(H).concat(u).concat(E)}}function xqe(e){const t=e.regex,r=/(r#)?/,n=t.concat(r,e.UNDERSCORE_IDENT_RE),a=t.concat(r,e.IDENT_RE),s={className:"title.function.invoke",relevance:0,begin:t.concat(/\b/,/(?!let|for|while|if|else|match\b)/,a,t.lookahead(/\s*\(/))},i="([ui](8|16|32|64|128|size)|f(32|64))?",l=["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","union","unsafe","unsized","use","virtual","where","while","yield"],c=["true","false","Some","None","Ok","Err"],u=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","eprintln!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],d=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:e.IDENT_RE+"!?",type:d,keyword:l,literal:c,built_in:u},illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.COMMENT("/\\*","\\*/",{contains:["self"]}),e.inherit(e.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*(?!')/},{scope:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'/,end:/'/,contains:[{scope:"char.escape",match:/\\('|\w|x\w{2}|u\w{4}|U\w{8})/}]}]},{className:"number",variants:[{begin:"\\b0b([01_]+)"+i},{begin:"\\b0o([0-7_]+)"+i},{begin:"\\b0x([A-Fa-f0-9_]+)"+i},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+i}],relevance:0},{begin:[/fn/,/\s+/,n],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/,contains:[e.BACKSLASH_ESCAPE]}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,n],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,n,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,n],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,n],className:{1:"keyword",3:"title.class"}},{begin:e.IDENT_RE+"::",keywords:{keyword:"Self",built_in:u,type:d}},{className:"punctuation",begin:"->"},s]}}const wqe=e=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:e.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),Sqe=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],kqe=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],_qe=[...Sqe,...kqe],Nqe=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),Cqe=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),jqe=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),Eqe=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function Mqe(e){const t=wqe(e),r=jqe,n=Cqe,a="@[a-z-]+",s="and or not only",l={className:"variable",begin:"(\\$"+"[a-zA-Z-][a-zA-Z0-9_-]*"+")\\b",relevance:0};return{name:"SCSS",case_insensitive:!0,illegal:"[=/|']",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,t.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},t.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+_qe.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+n.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+r.join("|")+")"},l,{begin:/\(/,end:/\)/,contains:[t.CSS_NUMBER_MODE]},t.CSS_VARIABLE,{className:"attribute",begin:"\\b("+Eqe.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[t.BLOCK_COMMENT,l,t.HEXCOLOR,t.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t.IMPORTANT,t.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:a,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:!0,keywords:{$pattern:/[a-z-]+/,keyword:s,attribute:Nqe.join(" ")},contains:[{begin:a,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},l,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,t.HEXCOLOR,t.CSS_NUMBER_MODE]},t.FUNCTION_DISPATCH]}}function Tqe(e){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}function Aqe(e){const t=e.regex,r=e.COMMENT("--","$"),n={scope:"string",variants:[{begin:/'/,end:/'/,contains:[{match:/''/}]}]},a={begin:/"/,end:/"/,contains:[{match:/""/}]},s=["true","false","unknown"],i=["double precision","large object","with timezone","without timezone"],l=["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],c=["add","asc","collation","desc","final","first","last","view"],u=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year"],d=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],f=["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"],m=["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"],p=d,v=[...u,...c].filter(j=>!d.includes(j)),b={scope:"variable",match:/@[a-z0-9][a-z0-9_]*/},y={scope:"operator",match:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0},S={match:t.concat(/\b/,t.either(...p),/\s*\(/),relevance:0,keywords:{built_in:p}};function _(j){return t.concat(/\b/,t.either(...j.map(E=>E.replace(/\s+/,"\\s+"))),/\b/)}const N={scope:"keyword",match:_(m),relevance:0};function k(j,{exceptions:E,when:T}={}){const O=T;return E=E||[],j.map(R=>R.match(/\|\d+$/)||E.includes(R)?R:O(R)?`${R}|0`:R)}return{name:"SQL",case_insensitive:!0,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:k(v,{when:j=>j.length<3}),literal:s,type:l,built_in:f},contains:[{scope:"type",match:_(i)},N,S,b,n,a,e.C_NUMBER_MODE,e.C_BLOCK_COMMENT_MODE,r,y]}}function wfe(e){return e?typeof e=="string"?e:e.source:null}function Mv(e){return cn("(?=",e,")")}function cn(...e){return e.map(r=>wfe(r)).join("")}function Dqe(e){const t=e[e.length-1];return typeof t=="object"&&t.constructor===Object?(e.splice(e.length-1,1),t):{}}function As(...e){return"("+(Dqe(e).capture?"":"?:")+e.map(n=>wfe(n)).join("|")+")"}const Q9=e=>cn(/\b/,e,/\w$/.test(e)?/\b/:/\B/),Lqe=["Protocol","Type"].map(Q9),PJ=["init","self"].map(Q9),Oqe=["Any","Self"],nL=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","borrowing","break","case","catch","class","consume","consuming","continue","convenience","copy","default","defer","deinit","didSet","distributed","do","dynamic","each","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","macro","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","package","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],zJ=["false","nil","true"],Iqe=["assignment","associativity","higherThan","left","lowerThan","none","right"],Rqe=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warning"],BJ=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],Sfe=As(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),kfe=As(Sfe,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),aL=cn(Sfe,kfe,"*"),_fe=As(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),QN=As(_fe,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),fl=cn(_fe,QN,"*"),CS=cn(/[A-Z]/,QN,"*"),Pqe=["attached","autoclosure",cn(/convention\(/,As("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","freestanding","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",cn(/objc\(/,fl,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","Sendable","testable","UIApplicationMain","unchecked","unknown","usableFromInline","warn_unqualified_access"],zqe=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];function Bqe(e){const t={match:/\s+/,relevance:0},r=e.COMMENT("/\\*","\\*/",{contains:["self"]}),n=[e.C_LINE_COMMENT_MODE,r],a={match:[/\./,As(...Lqe,...PJ)],className:{2:"keyword"}},s={match:cn(/\./,As(...nL)),relevance:0},i=nL.filter(ue=>typeof ue=="string").concat(["_|0"]),l=nL.filter(ue=>typeof ue!="string").concat(Oqe).map(Q9),c={variants:[{className:"keyword",match:As(...l,...PJ)}]},u={$pattern:As(/\b\w+/,/#\w+/),keyword:i.concat(Rqe),literal:zJ},d=[a,s,c],f={match:cn(/\./,As(...BJ)),relevance:0},m={className:"built_in",match:cn(/\b/,As(...BJ),/(?=\()/)},p=[f,m],v={match:/->/,relevance:0},b={className:"operator",relevance:0,variants:[{match:aL},{match:`\\.(\\.|${kfe})+`}]},y=[v,b],S="([0-9]_*)+",_="([0-9a-fA-F]_*)+",N={className:"number",relevance:0,variants:[{match:`\\b(${S})(\\.(${S}))?([eE][+-]?(${S}))?\\b`},{match:`\\b0x(${_})(\\.(${_}))?([pP][+-]?(${S}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},k=(ue="")=>({className:"subst",variants:[{match:cn(/\\/,ue,/[0\\tnr"']/)},{match:cn(/\\/,ue,/u\{[0-9a-fA-F]{1,8}\}/)}]}),j=(ue="")=>({className:"subst",match:cn(/\\/,ue,/[\t ]*(?:[\r\n]|\r\n)/)}),E=(ue="")=>({className:"subst",label:"interpol",begin:cn(/\\/,ue,/\(/),end:/\)/}),T=(ue="")=>({begin:cn(ue,/"""/),end:cn(/"""/,ue),contains:[k(ue),j(ue),E(ue)]}),O=(ue="")=>({begin:cn(ue,/"/),end:cn(/"/,ue),contains:[k(ue),E(ue)]}),R={className:"string",variants:[T(),T("#"),T("##"),T("###"),O(),O("#"),O("##"),O("###")]},H=[e.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[e.BACKSLASH_ESCAPE]}],$={begin:/\/[^\s](?=[^/\n]*\/)/,end:/\//,contains:H},L=ue=>{const re=cn(ue,/\//),ne=cn(/\//,ue);return{begin:re,end:ne,contains:[...H,{scope:"comment",begin:`#(?!.*${ne})`,end:/$/}]}},A={scope:"regexp",variants:[L("###"),L("##"),L("#"),$]},M={match:cn(/`/,fl,/`/)},P={className:"variable",match:/\$\d+/},I={className:"variable",match:`\\$${QN}+`},B=[M,P,I],F={match:/(@|#(un)?)available/,scope:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:zqe,contains:[...y,N,R]}]}},q={scope:"keyword",match:cn(/@/,As(...Pqe),Mv(As(/\(/,/\s+/)))},Q={scope:"meta",match:cn(/@/,fl)},W=[F,q,Q],G={match:Mv(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:cn(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,QN,"+")},{className:"type",match:CS,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:cn(/\s+&\s+/,Mv(CS)),relevance:0}]},J={begin:/</,end:/>/,keywords:u,contains:[...n,...d,...W,v,G]};G.contains.push(J);const X={match:cn(fl,/\s*:/),keywords:"_|0",relevance:0},V={begin:/\(/,end:/\)/,relevance:0,keywords:u,contains:["self",X,...n,A,...d,...p,...y,N,R,...B,...W,G]},se={begin:/</,end:/>/,keywords:"repeat each",contains:[...n,G]},de={begin:As(Mv(cn(fl,/\s*:/)),Mv(cn(fl,/\s+/,fl,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:fl}]},he={begin:/\(/,end:/\)/,keywords:u,contains:[de,...n,...d,...y,N,R,...W,G,V],endsParent:!0,illegal:/["']/},te={match:[/(func|macro)/,/\s+/,As(M.match,fl,aL)],className:{1:"keyword",3:"title.function"},contains:[se,he,t],illegal:[/\[/,/%/]},le={match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[se,he,t],illegal:/\[|%/},oe={match:[/operator/,/\s+/,aL],className:{1:"keyword",3:"title"}},Z={begin:[/precedencegroup/,/\s+/,CS],className:{1:"keyword",3:"title"},contains:[G],keywords:[...Iqe,...zJ],end:/}/},ve={match:[/class\b/,/\s+/,/func\b/,/\s+/,/\b[A-Za-z_][A-Za-z0-9_]*\b/],scope:{1:"keyword",3:"keyword",5:"title.function"}},U={match:[/class\b/,/\s+/,/var\b/],scope:{1:"keyword",3:"keyword"}},ge={begin:[/(struct|protocol|class|extension|enum|actor)/,/\s+/,fl,/\s*/],beginScope:{1:"keyword",3:"title.class"},keywords:u,contains:[se,...d,{begin:/:/,end:/\{/,keywords:u,contains:[{scope:"title.class.inherited",match:CS},...d],relevance:0}]};for(const ue of R.variants){const re=ue.contains.find(me=>me.label==="interpol");re.keywords=u;const ne=[...d,...p,...y,N,R,...B];re.contains=[...ne,{begin:/\(/,end:/\)/,contains:["self",...ne]}]}return{name:"Swift",keywords:u,contains:[...n,te,le,ve,U,ge,oe,Z,{beginKeywords:"import",end:/$/,contains:[...n],relevance:0},A,...d,...p,...y,N,R,...B,...W,G,V]}}const JN="[A-Za-z$_][0-9A-Za-z$_]*",Nfe=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],Cfe=["true","false","null","undefined","NaN","Infinity"],jfe=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],Efe=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],Mfe=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],Tfe=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],Afe=[].concat(Mfe,jfe,Efe);function $qe(e){const t=e.regex,r=(F,{after:q})=>{const Q="</"+F[0].slice(1);return F.input.indexOf(Q,q)!==-1},n=JN,a={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,i={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(F,q)=>{const Q=F[0].length+F.index,W=F.input[Q];if(W==="<"||W===","){q.ignoreMatch();return}W===">"&&(r(F,{after:Q})||q.ignoreMatch());let G;const J=F.input.substring(Q);if(G=J.match(/^\s*=/)){q.ignoreMatch();return}if((G=J.match(/^\s+extends\s+/))&&G.index===0){q.ignoreMatch();return}}},l={$pattern:JN,keyword:Nfe,literal:Cfe,built_in:Afe,"variable.language":Tfe},c="[0-9](_?[0-9])*",u=`\\.(${c})`,d="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",f={className:"number",variants:[{begin:`(\\b(${d})((${u})|\\.)?|(${u}))[eE][+-]?(${c})\\b`},{begin:`\\b(${d})\\b((${u})\\b|\\.)?|(${u})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},m={className:"subst",begin:"\\$\\{",end:"\\}",keywords:l,contains:[]},p={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"xml"}},v={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"css"}},b={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,m],subLanguage:"graphql"}},y={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,m]},_={className:"comment",variants:[e.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:n+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]},N=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,{match:/\$\d+/},f];m.contains=N.concat({begin:/\{/,end:/\}/,keywords:l,contains:["self"].concat(N)});const k=[].concat(_,m.contains),j=k.concat([{begin:/(\s*)\(/,end:/\)/,keywords:l,contains:["self"].concat(k)}]),E={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j},T={variants:[{match:[/class/,/\s+/,n,/\s+/,/extends/,/\s+/,t.concat(n,"(",t.concat(/\./,n),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,n],scope:{1:"keyword",3:"title.class"}}]},O={relevance:0,match:t.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...jfe,...Efe]}},R={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},H={variants:[{match:[/function/,/\s+/,n,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[E],illegal:/%/},$={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function L(F){return t.concat("(?!",F.join("|"),")")}const A={match:t.concat(/\b/,L([...Mfe,"super","import"].map(F=>`${F}\\s*\\(`)),n,t.lookahead(/\s*\(/)),className:"title.function",relevance:0},M={begin:t.concat(/\./,t.lookahead(t.concat(n,/(?![0-9A-Za-z$_(])/))),end:n,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},P={match:[/get|set/,/\s+/,n,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},E]},I="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+e.UNDERSCORE_IDENT_RE+")\\s*=>",B={match:[/const|var|let/,/\s+/,n,/\s*/,/=\s*/,/(async\s*)?/,t.lookahead(I)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[E]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:l,exports:{PARAMS_CONTAINS:j,CLASS_REFERENCE:O},illegal:/#(?![$_A-z])/,contains:[e.SHEBANG({label:"shebang",binary:"node",relevance:5}),R,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,p,v,b,y,_,{match:/\$\d+/},f,O,{scope:"attr",match:n+t.lookahead(":"),relevance:0},B,{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[_,e.REGEXP_MODE,{className:"function",begin:I,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:e.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:j}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:a.begin,end:a.end},{match:s},{begin:i.begin,"on:begin":i.isTrulyOpeningTag,end:i.end}],subLanguage:"xml",contains:[{begin:i.begin,end:i.end,skip:!0,contains:["self"]}]}]},H,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+e.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[E,e.inherit(e.TITLE_MODE,{begin:n,className:"title.function"})]},{match:/\.\.\./,relevance:0},M,{match:"\\$"+n,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[E]},A,$,T,P,{match:/\$[(.]/}]}}function Fqe(e){const t=e.regex,r=$qe(e),n=JN,a=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],s={begin:[/namespace/,/\s+/,e.IDENT_RE],beginScope:{1:"keyword",3:"title.class"}},i={beginKeywords:"interface",end:/\{/,excludeEnd:!0,keywords:{keyword:"interface extends",built_in:a},contains:[r.exports.CLASS_REFERENCE]},l={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},c=["type","interface","public","private","protected","implements","declare","abstract","readonly","enum","override","satisfies"],u={$pattern:JN,keyword:Nfe.concat(c),literal:Cfe,built_in:Afe.concat(a),"variable.language":Tfe},d={className:"meta",begin:"@"+n},f=(b,y,S)=>{const _=b.contains.findIndex(N=>N.label===y);if(_===-1)throw new Error("can not find mode to replace");b.contains.splice(_,1,S)};Object.assign(r.keywords,u),r.exports.PARAMS_CONTAINS.push(d);const m=r.contains.find(b=>b.scope==="attr"),p=Object.assign({},m,{match:t.concat(n,t.lookahead(/\s*\?:/))});r.exports.PARAMS_CONTAINS.push([r.exports.CLASS_REFERENCE,m,p]),r.contains=r.contains.concat([d,s,i,p]),f(r,"shebang",e.SHEBANG()),f(r,"use_strict",l);const v=r.contains.find(b=>b.label==="func.def");return v.relevance=0,Object.assign(r,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),r}function Uqe(e){const t=e.regex,r={className:"string",begin:/"(""|[^/n])"C\b/},n={className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},a=/\d{1,2}\/\d{1,2}\/\d{4}/,s=/\d{4}-\d{1,2}-\d{1,2}/,i=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,l=/\d{1,2}(:\d{1,2}){1,2}/,c={className:"literal",variants:[{begin:t.concat(/# */,t.either(s,a),/ *#/)},{begin:t.concat(/# */,l,/ *#/)},{begin:t.concat(/# */,i,/ *#/)},{begin:t.concat(/# */,t.either(s,a),/ +/,t.either(i,l),/ *#/)}]},u={className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},d={className:"label",begin:/^\w+:/},f=e.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),m=e.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:!0,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[r,n,c,u,d,f,m,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[m]}]}}function Hqe(e){e.regex;const t=e.COMMENT(/\(;/,/;\)/);t.contains.push("self");const r=e.COMMENT(/;;/,/$/),n=["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"],a={begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},s={className:"variable",begin:/\$[\w_]+/},i={match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},l={className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/},c={match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},u={className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/};return{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:n},contains:[r,t,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},s,i,a,e.QUOTE_STRING_MODE,c,u,l]}}function qqe(e){const t=e.regex,r=t.concat(/[\p{L}_]/u,t.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),n=/[\p{L}0-9._:-]+/u,a={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},s={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},i=e.inherit(s,{begin:/\(/,end:/\)/}),l=e.inherit(e.APOS_STRING_MODE,{className:"string"}),c=e.inherit(e.QUOTE_STRING_MODE,{className:"string"}),u={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:n,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/,contains:[a]},{begin:/'/,end:/'/,contains:[a]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,unicodeRegex:!0,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[s,c,l,i,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[s,i,c,l]}]}]},e.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},a,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[c]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[u],starts:{end:/<\/style>/,returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[u],starts:{end:/<\/script>/,returnEnd:!0,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:t.concat(/</,t.lookahead(t.concat(r,t.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:r,relevance:0,starts:u}]},{className:"tag",begin:t.concat(/<\//,t.lookahead(t.concat(r,/>/))),contains:[{className:"name",begin:r,relevance:0},{begin:/>/,relevance:0,endsParent:!0}]}]}}function Wqe(e){const t="true false yes no null",r="[\\w#;/?:@&=+$,.~*'()[\\]]+",n={className:"attr",variants:[{begin:/[\w*@][\w*@ :()\./-]*:(?=[ \t]|$)/},{begin:/"[\w*@][\w*@ :()\./-]*":(?=[ \t]|$)/},{begin:/'[\w*@][\w*@ :()\./-]*':(?=[ \t]|$)/}]},a={className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]},s={className:"string",relevance:0,begin:/'/,end:/'/,contains:[{match:/''/,scope:"char.escape",relevance:0}]},i={className:"string",relevance:0,variants:[{begin:/"/,end:/"/},{begin:/\S+/}],contains:[e.BACKSLASH_ESCAPE,a]},l=e.inherit(i,{variants:[{begin:/'/,end:/'/,contains:[{begin:/''/,relevance:0}]},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),m={className:"number",begin:"\\b"+"[0-9]{4}(-[0-9][0-9]){0,2}"+"([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?"+"(\\.[0-9]*)?"+"([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?"+"\\b"},p={end:",",endsWithParent:!0,excludeEnd:!0,keywords:t,relevance:0},v={begin:/\{/,end:/\}/,contains:[p],illegal:"\\n",relevance:0},b={begin:"\\[",end:"\\]",contains:[p],illegal:"\\n",relevance:0},y=[n,{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!\\w+!"+r},{className:"type",begin:"!<"+r+">"},{className:"type",begin:"!"+r},{className:"type",begin:"!!"+r},{className:"meta",begin:"&"+e.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+e.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},e.HASH_COMMENT_MODE,{beginKeywords:t,keywords:{literal:t}},m,{className:"number",begin:e.C_NUMBER_RE+"\\b",relevance:0},v,b,s,i],S=[...y];return S.pop(),S.push(l),p.contains=S,{name:"YAML",case_insensitive:!0,aliases:["yml"],contains:y}}const Kqe={arduino:jHe,bash:EHe,c:MHe,cpp:THe,csharp:AHe,css:$He,diff:FHe,go:UHe,graphql:HHe,ini:qHe,java:WHe,javascript:QHe,json:JHe,kotlin:XHe,less:oqe,lua:lqe,makefile:cqe,markdown:uqe,objectivec:dqe,perl:fqe,php:hqe,"php-template":mqe,plaintext:pqe,python:gqe,"python-repl":vqe,r:bqe,ruby:yqe,rust:xqe,scss:Mqe,shell:Tqe,sql:Aqe,swift:Bqe,typescript:Fqe,vbnet:Uqe,wasm:Hqe,xml:qqe,yaml:Wqe},$J={},Gqe="hljs-";function Vqe(e){const t=hfe.newInstance();return e&&s(e),{highlight:r,highlightAuto:n,listLanguages:a,register:s,registerAlias:i,registered:l};function r(c,u,d){const f=d||$J,m=typeof f.prefix=="string"?f.prefix:Gqe;if(!t.getLanguage(c))throw new Error("Unknown language: `"+c+"` is not registered");t.configure({__emitter:Yqe,classPrefix:m});const p=t.highlight(u,{ignoreIllegals:!0,language:c});if(p.errorRaised)throw new Error("Could not highlight with `Highlight.js`",{cause:p.errorRaised});const v=p._emitter.root,b=v.data;return b.language=p.language,b.relevance=p.relevance,v}function n(c,u){const f=(u||$J).subset||a();let m=-1,p=0,v;for(;++m<f.length;){const b=f[m];if(!t.getLanguage(b))continue;const y=r(b,c,u);y.data&&y.data.relevance!==void 0&&y.data.relevance>p&&(p=y.data.relevance,v=y)}return v||{type:"root",children:[],data:{language:void 0,relevance:p}}}function a(){return t.listLanguages()}function s(c,u){if(typeof c=="string")t.registerLanguage(c,u);else{let d;for(d in c)Object.hasOwn(c,d)&&t.registerLanguage(d,c[d])}}function i(c,u){if(typeof c=="string")t.registerAliases(typeof u=="string"?u:[...u],{languageName:c});else{let d;for(d in c)if(Object.hasOwn(c,d)){const f=c[d];t.registerAliases(typeof f=="string"?f:[...f],{languageName:d})}}}function l(c){return!!t.getLanguage(c)}}class Yqe{constructor(t){this.options=t,this.root={type:"root",children:[],data:{language:void 0,relevance:0}},this.stack=[this.root]}addText(t){if(t==="")return;const r=this.stack[this.stack.length-1],n=r.children[r.children.length-1];n&&n.type==="text"?n.value+=t:r.children.push({type:"text",value:t})}startScope(t){this.openNode(String(t))}endScope(){this.closeNode()}__addSublanguage(t,r){const n=this.stack[this.stack.length-1],a=t.root.children;r?n.children.push({type:"element",tagName:"span",properties:{className:[r]},children:a}):n.children.push(...a)}openNode(t){const r=this,n=t.split(".").map(function(i,l){return l?i+"_".repeat(l):r.options.classPrefix+i}),a=this.stack[this.stack.length-1],s={type:"element",tagName:"span",properties:{className:n},children:[]};a.children.push(s),this.stack.push(s)}closeNode(){this.stack.pop()}finalize(){}toHTML(){return""}}function Qqe(e){var t;const{char:r,allowSpaces:n,allowToIncludeChar:a,allowedPrefixes:s,startOfLine:i,$position:l}=e,c=n&&!a,u=iFe(r),d=new RegExp(`\\s${u}$`),f=i?"^":"",m=a?"":u,p=c?new RegExp(`${f}${u}.*?(?=\\s${m}|$)`,"gm"):new RegExp(`${f}(?:^)?${u}[^\\s${m}]*`,"gm"),v=((t=l.nodeBefore)==null?void 0:t.isText)&&l.nodeBefore.text;if(!v)return null;const b=l.pos-v.length,y=Array.from(v.matchAll(p)).pop();if(!y||y.input===void 0||y.index===void 0)return null;const S=y.input.slice(Math.max(0,y.index-1),y.index),_=new RegExp(`^[${s?.join("")}\0]?$`).test(S);if(s!==null&&!_)return null;const N=b+y.index;let k=N+y[0].length;return c&&d.test(v.slice(k-1,k+1))&&(y[0]+=" ",k+=1),N<l.pos&&k>=l.pos?{range:{from:N,to:k},query:y[0].slice(r.length),text:y[0]}:null}var Jqe=new Qr("suggestion");function Zqe({pluginKey:e=Jqe,editor:t,char:r="@",allowSpaces:n=!1,allowToIncludeChar:a=!1,allowedPrefixes:s=[" "],startOfLine:i=!1,decorationTag:l="span",decorationClass:c="suggestion",decorationContent:u="",decorationEmptyClass:d="is-empty",command:f=()=>null,items:m=()=>[],render:p=()=>({}),allow:v=()=>!0,findSuggestionMatch:b=Qqe,shouldShow:y}){let S;const _=p?.(),N=()=>{const T=t.state.selection.$anchor.pos,O=t.view.coordsAtPos(T),{top:R,right:H,bottom:$,left:L}=O;try{return new DOMRect(L,R,H-L,$-R)}catch{return null}},k=(T,O)=>O?()=>{const R=e.getState(t.state),H=R?.decorationId,$=T.dom.querySelector(`[data-decoration-id="${H}"]`);return $?.getBoundingClientRect()||null}:N;function j(T,O){var R;try{const $=e.getState(T.state),L=$?.decorationId?T.dom.querySelector(`[data-decoration-id="${$.decorationId}"]`):null,A={editor:t,range:$?.range||{from:0,to:0},query:$?.query||null,text:$?.text||null,items:[],command:M=>f({editor:t,range:$?.range||{from:0,to:0},props:M}),decorationNode:L,clientRect:k(T,L)};(R=_?.onExit)==null||R.call(_,A)}catch{}const H=T.state.tr.setMeta(O,{exit:!0});T.dispatch(H)}const E=new Hr({key:e,view(){return{update:async(T,O)=>{var R,H,$,L,A,M,P;const I=(R=this.key)==null?void 0:R.getState(O),B=(H=this.key)==null?void 0:H.getState(T.state),F=I.active&&B.active&&I.range.from!==B.range.from,q=!I.active&&B.active,Q=I.active&&!B.active,W=!q&&!Q&&I.query!==B.query,G=q||F&&W,J=W||F,X=Q||F&&W;if(!G&&!J&&!X)return;const V=X&&!G?I:B,se=T.dom.querySelector(`[data-decoration-id="${V.decorationId}"]`);S={editor:t,range:V.range,query:V.query,text:V.text,items:[],command:de=>f({editor:t,range:V.range,props:de}),decorationNode:se,clientRect:k(T,se)},G&&(($=_?.onBeforeStart)==null||$.call(_,S)),J&&((L=_?.onBeforeUpdate)==null||L.call(_,S)),(J||G)&&(S.items=await m({editor:t,query:V.query})),X&&((A=_?.onExit)==null||A.call(_,S)),J&&((M=_?.onUpdate)==null||M.call(_,S)),G&&((P=_?.onStart)==null||P.call(_,S))},destroy:()=>{var T;S&&((T=_?.onExit)==null||T.call(_,S))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(T,O,R,H){const{isEditable:$}=t,{composing:L}=t.view,{selection:A}=T,{empty:M,from:P}=A,I={...O},B=T.getMeta(e);if(B&&B.exit)return I.active=!1,I.decorationId=null,I.range={from:0,to:0},I.query=null,I.text=null,I;if(I.composing=L,$&&(M||t.view.composing)){(P<O.range.from||P>O.range.to)&&!L&&!O.composing&&(I.active=!1);const F=b({char:r,allowSpaces:n,allowToIncludeChar:a,allowedPrefixes:s,startOfLine:i,$position:A.$from}),q=`id_${Math.floor(Math.random()*4294967295)}`;F&&v({editor:t,state:H,range:F.range,isActive:O.active})&&(!y||y({editor:t,range:F.range,query:F.query,text:F.text,transaction:T}))?(I.active=!0,I.decorationId=O.decorationId?O.decorationId:q,I.range=F.range,I.query=F.query,I.text=F.text):I.active=!1}else I.active=!1;return I.active||(I.decorationId=null,I.range={from:0,to:0},I.query=null,I.text=null),I}},props:{handleKeyDown(T,O){var R,H,$,L;const{active:A,range:M}=E.getState(T.state);if(!A)return!1;if(O.key==="Escape"||O.key==="Esc"){const I=E.getState(T.state),B=(R=S?.decorationNode)!=null?R:null,F=B??(I?.decorationId?T.dom.querySelector(`[data-decoration-id="${I.decorationId}"]`):null);if(((H=_?.onKeyDown)==null?void 0:H.call(_,{view:T,event:O,range:I.range}))||!1)return!0;const Q={editor:t,range:I.range,query:I.query,text:I.text,items:[],command:W=>f({editor:t,range:I.range,props:W}),decorationNode:F,clientRect:F?()=>F.getBoundingClientRect()||null:null};return($=_?.onExit)==null||$.call(_,Q),j(T,e),!0}return((L=_?.onKeyDown)==null?void 0:L.call(_,{view:T,event:O,range:M}))||!1},decorations(T){const{active:O,range:R,decorationId:H,query:$}=E.getState(T);if(!O)return null;const L=!$?.length,A=[c];return L&&A.push(d),en.create(T.doc,[ga.inline(R.from,R.to,{nodeName:l,class:A.join(" "),"data-decoration-id":H,"data-decoration-content":u})])}}});return E}var J9=Zqe,si="top",_o="bottom",No="right",ii="left",Z9="auto",o1=[si,_o,No,ii],Mg="start",nx="end",Xqe="clippingParents",Dfe="viewport",Tv="popper",e7e="reference",FJ=o1.reduce(function(e,t){return e.concat([t+"-"+Mg,t+"-"+nx])},[]),Lfe=[].concat(o1,[Z9]).reduce(function(e,t){return e.concat([t,t+"-"+Mg,t+"-"+nx])},[]),t7e="beforeRead",r7e="read",n7e="afterRead",a7e="beforeMain",s7e="main",i7e="afterMain",o7e="beforeWrite",l7e="write",c7e="afterWrite",u7e=[t7e,r7e,n7e,a7e,s7e,i7e,o7e,l7e,c7e];function Pl(e){return e?(e.nodeName||"").toLowerCase():null}function Pi(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Th(e){var t=Pi(e).Element;return e instanceof t||e instanceof Element}function wo(e){var t=Pi(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function X9(e){if(typeof ShadowRoot>"u")return!1;var t=Pi(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function d7e(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var n=t.styles[r]||{},a=t.attributes[r]||{},s=t.elements[r];!wo(s)||!Pl(s)||(Object.assign(s.style,n),Object.keys(a).forEach(function(i){var l=a[i];l===!1?s.removeAttribute(i):s.setAttribute(i,l===!0?"":l)}))})}function f7e(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(n){var a=t.elements[n],s=t.attributes[n]||{},i=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:r[n]),l=i.reduce(function(c,u){return c[u]="",c},{});!wo(a)||!Pl(a)||(Object.assign(a.style,l),Object.keys(s).forEach(function(c){a.removeAttribute(c)}))})}}const Ofe={name:"applyStyles",enabled:!0,phase:"write",fn:d7e,effect:f7e,requires:["computeStyles"]};function Nl(e){return e.split("-")[0]}var ch=Math.max,ZN=Math.min,Tg=Math.round;function VR(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Ife(){return!/^((?!chrome|android).)*safari/i.test(VR())}function Ag(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,s=1;t&&wo(e)&&(a=e.offsetWidth>0&&Tg(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&Tg(n.height)/e.offsetHeight||1);var i=Th(e)?Pi(e):window,l=i.visualViewport,c=!Ife()&&r,u=(n.left+(c&&l?l.offsetLeft:0))/a,d=(n.top+(c&&l?l.offsetTop:0))/s,f=n.width/a,m=n.height/s;return{width:f,height:m,top:d,right:u+f,bottom:d+m,left:u,x:u,y:d}}function eB(e){var t=Ag(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Rfe(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&X9(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ou(e){return Pi(e).getComputedStyle(e)}function h7e(e){return["table","td","th"].indexOf(Pl(e))>=0}function Gd(e){return((Th(e)?e.ownerDocument:e.document)||window.document).documentElement}function l2(e){return Pl(e)==="html"?e:e.assignedSlot||e.parentNode||(X9(e)?e.host:null)||Gd(e)}function UJ(e){return!wo(e)||ou(e).position==="fixed"?null:e.offsetParent}function m7e(e){var t=/firefox/i.test(VR()),r=/Trident/i.test(VR());if(r&&wo(e)){var n=ou(e);if(n.position==="fixed")return null}var a=l2(e);for(X9(a)&&(a=a.host);wo(a)&&["html","body"].indexOf(Pl(a))<0;){var s=ou(a);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return a;a=a.parentNode}return null}function l1(e){for(var t=Pi(e),r=UJ(e);r&&h7e(r)&&ou(r).position==="static";)r=UJ(r);return r&&(Pl(r)==="html"||Pl(r)==="body"&&ou(r).position==="static")?t:r||m7e(e)||t}function tB(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Wb(e,t,r){return ch(e,ZN(t,r))}function p7e(e,t,r){var n=Wb(e,t,r);return n>r?r:n}function Pfe(){return{top:0,right:0,bottom:0,left:0}}function zfe(e){return Object.assign({},Pfe(),e)}function Bfe(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var g7e=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,zfe(typeof t!="number"?t:Bfe(t,o1))};function v7e(e){var t,r=e.state,n=e.name,a=e.options,s=r.elements.arrow,i=r.modifiersData.popperOffsets,l=Nl(r.placement),c=tB(l),u=[ii,No].indexOf(l)>=0,d=u?"height":"width";if(!(!s||!i)){var f=g7e(a.padding,r),m=eB(s),p=c==="y"?si:ii,v=c==="y"?_o:No,b=r.rects.reference[d]+r.rects.reference[c]-i[c]-r.rects.popper[d],y=i[c]-r.rects.reference[c],S=l1(s),_=S?c==="y"?S.clientHeight||0:S.clientWidth||0:0,N=b/2-y/2,k=f[p],j=_-m[d]-f[v],E=_/2-m[d]/2+N,T=Wb(k,E,j),O=c;r.modifiersData[n]=(t={},t[O]=T,t.centerOffset=T-E,t)}}function b7e(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||Rfe(t.elements.popper,a)&&(t.elements.arrow=a))}const y7e={name:"arrow",enabled:!0,phase:"main",fn:v7e,effect:b7e,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Dg(e){return e.split("-")[1]}var x7e={top:"auto",right:"auto",bottom:"auto",left:"auto"};function w7e(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:Tg(r*a)/a||0,y:Tg(n*a)/a||0}}function HJ(e){var t,r=e.popper,n=e.popperRect,a=e.placement,s=e.variation,i=e.offsets,l=e.position,c=e.gpuAcceleration,u=e.adaptive,d=e.roundOffsets,f=e.isFixed,m=i.x,p=m===void 0?0:m,v=i.y,b=v===void 0?0:v,y=typeof d=="function"?d({x:p,y:b}):{x:p,y:b};p=y.x,b=y.y;var S=i.hasOwnProperty("x"),_=i.hasOwnProperty("y"),N=ii,k=si,j=window;if(u){var E=l1(r),T="clientHeight",O="clientWidth";if(E===Pi(r)&&(E=Gd(r),ou(E).position!=="static"&&l==="absolute"&&(T="scrollHeight",O="scrollWidth")),E=E,a===si||(a===ii||a===No)&&s===nx){k=_o;var R=f&&E===j&&j.visualViewport?j.visualViewport.height:E[T];b-=R-n.height,b*=c?1:-1}if(a===ii||(a===si||a===_o)&&s===nx){N=No;var H=f&&E===j&&j.visualViewport?j.visualViewport.width:E[O];p-=H-n.width,p*=c?1:-1}}var $=Object.assign({position:l},u&&x7e),L=d===!0?w7e({x:p,y:b},Pi(r)):{x:p,y:b};if(p=L.x,b=L.y,c){var A;return Object.assign({},$,(A={},A[k]=_?"0":"",A[N]=S?"0":"",A.transform=(j.devicePixelRatio||1)<=1?"translate("+p+"px, "+b+"px)":"translate3d("+p+"px, "+b+"px, 0)",A))}return Object.assign({},$,(t={},t[k]=_?b+"px":"",t[N]=S?p+"px":"",t.transform="",t))}function S7e(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,s=r.adaptive,i=s===void 0?!0:s,l=r.roundOffsets,c=l===void 0?!0:l,u={placement:Nl(t.placement),variation:Dg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,HJ(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,HJ(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const k7e={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:S7e,data:{}};var jS={passive:!0};function _7e(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,s=a===void 0?!0:a,i=n.resize,l=i===void 0?!0:i,c=Pi(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&u.forEach(function(d){d.addEventListener("scroll",r.update,jS)}),l&&c.addEventListener("resize",r.update,jS),function(){s&&u.forEach(function(d){d.removeEventListener("scroll",r.update,jS)}),l&&c.removeEventListener("resize",r.update,jS)}}const N7e={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:_7e,data:{}};var C7e={left:"right",right:"left",bottom:"top",top:"bottom"};function Nk(e){return e.replace(/left|right|bottom|top/g,function(t){return C7e[t]})}var j7e={start:"end",end:"start"};function qJ(e){return e.replace(/start|end/g,function(t){return j7e[t]})}function rB(e){var t=Pi(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function nB(e){return Ag(Gd(e)).left+rB(e).scrollLeft}function E7e(e,t){var r=Pi(e),n=Gd(e),a=r.visualViewport,s=n.clientWidth,i=n.clientHeight,l=0,c=0;if(a){s=a.width,i=a.height;var u=Ife();(u||!u&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:s,height:i,x:l+nB(e),y:c}}function M7e(e){var t,r=Gd(e),n=rB(e),a=(t=e.ownerDocument)==null?void 0:t.body,s=ch(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),i=ch(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-n.scrollLeft+nB(e),c=-n.scrollTop;return ou(a||r).direction==="rtl"&&(l+=ch(r.clientWidth,a?a.clientWidth:0)-s),{width:s,height:i,x:l,y:c}}function aB(e){var t=ou(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function $fe(e){return["html","body","#document"].indexOf(Pl(e))>=0?e.ownerDocument.body:wo(e)&&aB(e)?e:$fe(l2(e))}function Kb(e,t){var r;t===void 0&&(t=[]);var n=$fe(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),s=Pi(n),i=a?[s].concat(s.visualViewport||[],aB(n)?n:[]):n,l=t.concat(i);return a?l:l.concat(Kb(l2(i)))}function YR(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function T7e(e,t){var r=Ag(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function WJ(e,t,r){return t===Dfe?YR(E7e(e,r)):Th(t)?T7e(t,r):YR(M7e(Gd(e)))}function A7e(e){var t=Kb(l2(e)),r=["absolute","fixed"].indexOf(ou(e).position)>=0,n=r&&wo(e)?l1(e):e;return Th(n)?t.filter(function(a){return Th(a)&&Rfe(a,n)&&Pl(a)!=="body"}):[]}function D7e(e,t,r,n){var a=t==="clippingParents"?A7e(e):[].concat(t),s=[].concat(a,[r]),i=s[0],l=s.reduce(function(c,u){var d=WJ(e,u,n);return c.top=ch(d.top,c.top),c.right=ZN(d.right,c.right),c.bottom=ZN(d.bottom,c.bottom),c.left=ch(d.left,c.left),c},WJ(e,i,n));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Ffe(e){var t=e.reference,r=e.element,n=e.placement,a=n?Nl(n):null,s=n?Dg(n):null,i=t.x+t.width/2-r.width/2,l=t.y+t.height/2-r.height/2,c;switch(a){case si:c={x:i,y:t.y-r.height};break;case _o:c={x:i,y:t.y+t.height};break;case No:c={x:t.x+t.width,y:l};break;case ii:c={x:t.x-r.width,y:l};break;default:c={x:t.x,y:t.y}}var u=a?tB(a):null;if(u!=null){var d=u==="y"?"height":"width";switch(s){case Mg:c[u]=c[u]-(t[d]/2-r[d]/2);break;case nx:c[u]=c[u]+(t[d]/2-r[d]/2);break}}return c}function ax(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,s=r.strategy,i=s===void 0?e.strategy:s,l=r.boundary,c=l===void 0?Xqe:l,u=r.rootBoundary,d=u===void 0?Dfe:u,f=r.elementContext,m=f===void 0?Tv:f,p=r.altBoundary,v=p===void 0?!1:p,b=r.padding,y=b===void 0?0:b,S=zfe(typeof y!="number"?y:Bfe(y,o1)),_=m===Tv?e7e:Tv,N=e.rects.popper,k=e.elements[v?_:m],j=D7e(Th(k)?k:k.contextElement||Gd(e.elements.popper),c,d,i),E=Ag(e.elements.reference),T=Ffe({reference:E,element:N,placement:a}),O=YR(Object.assign({},N,T)),R=m===Tv?O:E,H={top:j.top-R.top+S.top,bottom:R.bottom-j.bottom+S.bottom,left:j.left-R.left+S.left,right:R.right-j.right+S.right},$=e.modifiersData.offset;if(m===Tv&&$){var L=$[a];Object.keys(H).forEach(function(A){var M=[No,_o].indexOf(A)>=0?1:-1,P=[si,_o].indexOf(A)>=0?"y":"x";H[A]+=L[P]*M})}return H}function L7e(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,s=r.rootBoundary,i=r.padding,l=r.flipVariations,c=r.allowedAutoPlacements,u=c===void 0?Lfe:c,d=Dg(n),f=d?l?FJ:FJ.filter(function(v){return Dg(v)===d}):o1,m=f.filter(function(v){return u.indexOf(v)>=0});m.length===0&&(m=f);var p=m.reduce(function(v,b){return v[b]=ax(e,{placement:b,boundary:a,rootBoundary:s,padding:i})[Nl(b)],v},{});return Object.keys(p).sort(function(v,b){return p[v]-p[b]})}function O7e(e){if(Nl(e)===Z9)return[];var t=Nk(e);return[qJ(e),t,qJ(t)]}function I7e(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,l=i===void 0?!0:i,c=r.fallbackPlacements,u=r.padding,d=r.boundary,f=r.rootBoundary,m=r.altBoundary,p=r.flipVariations,v=p===void 0?!0:p,b=r.allowedAutoPlacements,y=t.options.placement,S=Nl(y),_=S===y,N=c||(_||!v?[Nk(y)]:O7e(y)),k=[y].concat(N).reduce(function(X,V){return X.concat(Nl(V)===Z9?L7e(t,{placement:V,boundary:d,rootBoundary:f,padding:u,flipVariations:v,allowedAutoPlacements:b}):V)},[]),j=t.rects.reference,E=t.rects.popper,T=new Map,O=!0,R=k[0],H=0;H<k.length;H++){var $=k[H],L=Nl($),A=Dg($)===Mg,M=[si,_o].indexOf(L)>=0,P=M?"width":"height",I=ax(t,{placement:$,boundary:d,rootBoundary:f,altBoundary:m,padding:u}),B=M?A?No:ii:A?_o:si;j[P]>E[P]&&(B=Nk(B));var F=Nk(B),q=[];if(s&&q.push(I[L]<=0),l&&q.push(I[B]<=0,I[F]<=0),q.every(function(X){return X})){R=$,O=!1;break}T.set($,q)}if(O)for(var Q=v?3:1,W=function(V){var se=k.find(function(de){var he=T.get(de);if(he)return he.slice(0,V).every(function(te){return te})});if(se)return R=se,"break"},G=Q;G>0;G--){var J=W(G);if(J==="break")break}t.placement!==R&&(t.modifiersData[n]._skip=!0,t.placement=R,t.reset=!0)}}const R7e={name:"flip",enabled:!0,phase:"main",fn:I7e,requiresIfExists:["offset"],data:{_skip:!1}};function KJ(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function GJ(e){return[si,No,_o,ii].some(function(t){return e[t]>=0})}function P7e(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,s=t.modifiersData.preventOverflow,i=ax(t,{elementContext:"reference"}),l=ax(t,{altBoundary:!0}),c=KJ(i,n),u=KJ(l,a,s),d=GJ(c),f=GJ(u);t.modifiersData[r]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:d,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":f})}const z7e={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:P7e};function B7e(e,t,r){var n=Nl(e),a=[ii,si].indexOf(n)>=0?-1:1,s=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,i=s[0],l=s[1];return i=i||0,l=(l||0)*a,[ii,No].indexOf(n)>=0?{x:l,y:i}:{x:i,y:l}}function $7e(e){var t=e.state,r=e.options,n=e.name,a=r.offset,s=a===void 0?[0,0]:a,i=Lfe.reduce(function(d,f){return d[f]=B7e(f,t.rects,s),d},{}),l=i[t.placement],c=l.x,u=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[n]=i}const F7e={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:$7e};function U7e(e){var t=e.state,r=e.name;t.modifiersData[r]=Ffe({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const H7e={name:"popperOffsets",enabled:!0,phase:"read",fn:U7e,data:{}};function q7e(e){return e==="x"?"y":"x"}function W7e(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,l=i===void 0?!1:i,c=r.boundary,u=r.rootBoundary,d=r.altBoundary,f=r.padding,m=r.tether,p=m===void 0?!0:m,v=r.tetherOffset,b=v===void 0?0:v,y=ax(t,{boundary:c,rootBoundary:u,padding:f,altBoundary:d}),S=Nl(t.placement),_=Dg(t.placement),N=!_,k=tB(S),j=q7e(k),E=t.modifiersData.popperOffsets,T=t.rects.reference,O=t.rects.popper,R=typeof b=="function"?b(Object.assign({},t.rects,{placement:t.placement})):b,H=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),$=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,L={x:0,y:0};if(E){if(s){var A,M=k==="y"?si:ii,P=k==="y"?_o:No,I=k==="y"?"height":"width",B=E[k],F=B+y[M],q=B-y[P],Q=p?-O[I]/2:0,W=_===Mg?T[I]:O[I],G=_===Mg?-O[I]:-T[I],J=t.elements.arrow,X=p&&J?eB(J):{width:0,height:0},V=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Pfe(),se=V[M],de=V[P],he=Wb(0,T[I],X[I]),te=N?T[I]/2-Q-he-se-H.mainAxis:W-he-se-H.mainAxis,le=N?-T[I]/2+Q+he+de+H.mainAxis:G+he+de+H.mainAxis,oe=t.elements.arrow&&l1(t.elements.arrow),Z=oe?k==="y"?oe.clientTop||0:oe.clientLeft||0:0,ve=(A=$?.[k])!=null?A:0,U=B+te-ve-Z,ge=B+le-ve,ue=Wb(p?ZN(F,U):F,B,p?ch(q,ge):q);E[k]=ue,L[k]=ue-B}if(l){var re,ne=k==="x"?si:ii,me=k==="x"?_o:No,ke=E[j],we=j==="y"?"height":"width",pe=ke+y[ne],Oe=ke-y[me],Ae=[si,ii].indexOf(S)!==-1,Re=(re=$?.[j])!=null?re:0,Ve=Ae?pe:ke-T[we]-O[we]-Re+H.altAxis,gt=Ae?ke+T[we]+O[we]-Re-H.altAxis:Oe,lt=p&&Ae?p7e(Ve,ke,gt):Wb(p?Ve:pe,ke,p?gt:Oe);E[j]=lt,L[j]=lt-ke}t.modifiersData[n]=L}}const K7e={name:"preventOverflow",enabled:!0,phase:"main",fn:W7e,requiresIfExists:["offset"]};function G7e(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function V7e(e){return e===Pi(e)||!wo(e)?rB(e):G7e(e)}function Y7e(e){var t=e.getBoundingClientRect(),r=Tg(t.width)/e.offsetWidth||1,n=Tg(t.height)/e.offsetHeight||1;return r!==1||n!==1}function Q7e(e,t,r){r===void 0&&(r=!1);var n=wo(t),a=wo(t)&&Y7e(t),s=Gd(t),i=Ag(e,a,r),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(n||!n&&!r)&&((Pl(t)!=="body"||aB(s))&&(l=V7e(t)),wo(t)?(c=Ag(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):s&&(c.x=nB(s))),{x:i.left+l.scrollLeft-c.x,y:i.top+l.scrollTop-c.y,width:i.width,height:i.height}}function J7e(e){var t=new Map,r=new Set,n=[];e.forEach(function(s){t.set(s.name,s)});function a(s){r.add(s.name);var i=[].concat(s.requires||[],s.requiresIfExists||[]);i.forEach(function(l){if(!r.has(l)){var c=t.get(l);c&&a(c)}}),n.push(s)}return e.forEach(function(s){r.has(s.name)||a(s)}),n}function Z7e(e){var t=J7e(e);return u7e.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function X7e(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function eWe(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var VJ={placement:"bottom",modifiers:[],strategy:"absolute"};function YJ(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function tWe(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,s=a===void 0?VJ:a;return function(l,c,u){u===void 0&&(u=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},VJ,s),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},f=[],m=!1,p={state:d,setOptions:function(S){var _=typeof S=="function"?S(d.options):S;b(),d.options=Object.assign({},s,d.options,_),d.scrollParents={reference:Th(l)?Kb(l):l.contextElement?Kb(l.contextElement):[],popper:Kb(c)};var N=Z7e(eWe([].concat(n,d.options.modifiers)));return d.orderedModifiers=N.filter(function(k){return k.enabled}),v(),p.update()},forceUpdate:function(){if(!m){var S=d.elements,_=S.reference,N=S.popper;if(YJ(_,N)){d.rects={reference:Q7e(_,l1(N),d.options.strategy==="fixed"),popper:eB(N)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(H){return d.modifiersData[H.name]=Object.assign({},H.data)});for(var k=0;k<d.orderedModifiers.length;k++){if(d.reset===!0){d.reset=!1,k=-1;continue}var j=d.orderedModifiers[k],E=j.fn,T=j.options,O=T===void 0?{}:T,R=j.name;typeof E=="function"&&(d=E({state:d,options:O,name:R,instance:p})||d)}}}},update:X7e(function(){return new Promise(function(y){p.forceUpdate(),y(d)})}),destroy:function(){b(),m=!0}};if(!YJ(l,c))return p;p.setOptions(u).then(function(y){!m&&u.onFirstUpdate&&u.onFirstUpdate(y)});function v(){d.orderedModifiers.forEach(function(y){var S=y.name,_=y.options,N=_===void 0?{}:_,k=y.effect;if(typeof k=="function"){var j=k({state:d,name:S,instance:p,options:N}),E=function(){};f.push(j||E)}})}function b(){f.forEach(function(y){return y()}),f=[]}return p}}var rWe=[N7e,H7e,k7e,Ofe,F7e,R7e,K7e,y7e,z7e],nWe=tWe({defaultModifiers:rWe}),aWe="tippy-box",Ufe="tippy-content",sWe="tippy-backdrop",Hfe="tippy-arrow",qfe="tippy-svg-arrow",zf={passive:!0,capture:!0},Wfe=function(){return document.body};function sL(e,t,r){if(Array.isArray(e)){var n=e[t];return n??(Array.isArray(r)?r[t]:r)}return e}function sB(e,t){var r={}.toString.call(e);return r.indexOf("[object")===0&&r.indexOf(t+"]")>-1}function Kfe(e,t){return typeof e=="function"?e.apply(void 0,t):e}function QJ(e,t){if(t===0)return e;var r;return function(n){clearTimeout(r),r=setTimeout(function(){e(n)},t)}}function iWe(e){return e.split(/\s+/).filter(Boolean)}function wp(e){return[].concat(e)}function JJ(e,t){e.indexOf(t)===-1&&e.push(t)}function oWe(e){return e.filter(function(t,r){return e.indexOf(t)===r})}function lWe(e){return e.split("-")[0]}function XN(e){return[].slice.call(e)}function ZJ(e){return Object.keys(e).reduce(function(t,r){return e[r]!==void 0&&(t[r]=e[r]),t},{})}function Gb(){return document.createElement("div")}function c2(e){return["Element","Fragment"].some(function(t){return sB(e,t)})}function cWe(e){return sB(e,"NodeList")}function uWe(e){return sB(e,"MouseEvent")}function dWe(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function fWe(e){return c2(e)?[e]:cWe(e)?XN(e):Array.isArray(e)?e:XN(document.querySelectorAll(e))}function iL(e,t){e.forEach(function(r){r&&(r.style.transitionDuration=t+"ms")})}function XJ(e,t){e.forEach(function(r){r&&r.setAttribute("data-state",t)})}function hWe(e){var t,r=wp(e),n=r[0];return n!=null&&(t=n.ownerDocument)!=null&&t.body?n.ownerDocument:document}function mWe(e,t){var r=t.clientX,n=t.clientY;return e.every(function(a){var s=a.popperRect,i=a.popperState,l=a.props,c=l.interactiveBorder,u=lWe(i.placement),d=i.modifiersData.offset;if(!d)return!0;var f=u==="bottom"?d.top.y:0,m=u==="top"?d.bottom.y:0,p=u==="right"?d.left.x:0,v=u==="left"?d.right.x:0,b=s.top-n+f>c,y=n-s.bottom-m>c,S=s.left-r+p>c,_=r-s.right-v>c;return b||y||S||_})}function oL(e,t,r){var n=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(a){e[n](a,r)})}function eZ(e,t){for(var r=t;r;){var n;if(e.contains(r))return!0;r=r.getRootNode==null||(n=r.getRootNode())==null?void 0:n.host}return!1}var vl={isTouch:!1},tZ=0;function pWe(){vl.isTouch||(vl.isTouch=!0,window.performance&&document.addEventListener("mousemove",Gfe))}function Gfe(){var e=performance.now();e-tZ<20&&(vl.isTouch=!1,document.removeEventListener("mousemove",Gfe)),tZ=e}function gWe(){var e=document.activeElement;if(dWe(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function vWe(){document.addEventListener("touchstart",pWe,zf),window.addEventListener("blur",gWe)}var bWe=typeof window<"u"&&typeof document<"u",yWe=bWe?!!window.msCrypto:!1,xWe={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},wWe={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Ko=Object.assign({appendTo:Wfe,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},xWe,wWe),SWe=Object.keys(Ko),kWe=function(t){var r=Object.keys(t);r.forEach(function(n){Ko[n]=t[n]})};function Vfe(e){var t=e.plugins||[],r=t.reduce(function(n,a){var s=a.name,i=a.defaultValue;if(s){var l;n[s]=e[s]!==void 0?e[s]:(l=Ko[s])!=null?l:i}return n},{});return Object.assign({},e,r)}function _We(e,t){var r=t?Object.keys(Vfe(Object.assign({},Ko,{plugins:t}))):SWe,n=r.reduce(function(a,s){var i=(e.getAttribute("data-tippy-"+s)||"").trim();if(!i)return a;if(s==="content")a[s]=i;else try{a[s]=JSON.parse(i)}catch{a[s]=i}return a},{});return n}function rZ(e,t){var r=Object.assign({},t,{content:Kfe(t.content,[e])},t.ignoreAttributes?{}:_We(e,t.plugins));return r.aria=Object.assign({},Ko.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?t.interactive:r.aria.expanded,content:r.aria.content==="auto"?t.interactive?null:"describedby":r.aria.content},r}var NWe=function(){return"innerHTML"};function QR(e,t){e[NWe()]=t}function nZ(e){var t=Gb();return e===!0?t.className=Hfe:(t.className=qfe,c2(e)?t.appendChild(e):QR(t,e)),t}function aZ(e,t){c2(t.content)?(QR(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?QR(e,t.content):e.textContent=t.content)}function JR(e){var t=e.firstElementChild,r=XN(t.children);return{box:t,content:r.find(function(n){return n.classList.contains(Ufe)}),arrow:r.find(function(n){return n.classList.contains(Hfe)||n.classList.contains(qfe)}),backdrop:r.find(function(n){return n.classList.contains(sWe)})}}function Yfe(e){var t=Gb(),r=Gb();r.className=aWe,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Gb();n.className=Ufe,n.setAttribute("data-state","hidden"),aZ(n,e.props),t.appendChild(r),r.appendChild(n),a(e.props,e.props);function a(s,i){var l=JR(t),c=l.box,u=l.content,d=l.arrow;i.theme?c.setAttribute("data-theme",i.theme):c.removeAttribute("data-theme"),typeof i.animation=="string"?c.setAttribute("data-animation",i.animation):c.removeAttribute("data-animation"),i.inertia?c.setAttribute("data-inertia",""):c.removeAttribute("data-inertia"),c.style.maxWidth=typeof i.maxWidth=="number"?i.maxWidth+"px":i.maxWidth,i.role?c.setAttribute("role",i.role):c.removeAttribute("role"),(s.content!==i.content||s.allowHTML!==i.allowHTML)&&aZ(u,e.props),i.arrow?d?s.arrow!==i.arrow&&(c.removeChild(d),c.appendChild(nZ(i.arrow))):c.appendChild(nZ(i.arrow)):d&&c.removeChild(d)}return{popper:t,onUpdate:a}}Yfe.$$tippy=!0;var CWe=1,ES=[],lL=[];function jWe(e,t){var r=rZ(e,Object.assign({},Ko,Vfe(ZJ(t)))),n,a,s,i=!1,l=!1,c=!1,u=!1,d,f,m,p=[],v=QJ(U,r.interactiveDebounce),b,y=CWe++,S=null,_=oWe(r.plugins),N={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},k={id:y,reference:e,popper:Gb(),popperInstance:S,props:r,state:N,plugins:_,clearDelayTimeouts:Ve,setProps:gt,setContent:lt,show:Pt,hide:fr,hideWithInteractivity:Qe,enable:Ae,disable:Re,unmount:Vt,destroy:at};if(!r.render)return k;var j=r.render(k),E=j.popper,T=j.onUpdate;E.setAttribute("data-tippy-root",""),E.id="tippy-"+k.id,k.popper=E,e._tippy=k,E._tippy=k;var O=_.map(function(Ne){return Ne.fn(k)}),R=e.hasAttribute("aria-expanded");return oe(),Q(),B(),F("onCreate",[k]),r.showOnCreate&&pe(),E.addEventListener("mouseenter",function(){k.props.interactive&&k.state.isVisible&&k.clearDelayTimeouts()}),E.addEventListener("mouseleave",function(){k.props.interactive&&k.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",v)}),k;function H(){var Ne=k.props.touch;return Array.isArray(Ne)?Ne:[Ne,0]}function $(){return H()[0]==="hold"}function L(){var Ne;return!!((Ne=k.props.render)!=null&&Ne.$$tippy)}function A(){return b||e}function M(){var Ne=A().parentNode;return Ne?hWe(Ne):document}function P(){return JR(E)}function I(Ne){return k.state.isMounted&&!k.state.isVisible||vl.isTouch||d&&d.type==="focus"?0:sL(k.props.delay,Ne?0:1,Ko.delay)}function B(Ne){Ne===void 0&&(Ne=!1),E.style.pointerEvents=k.props.interactive&&!Ne?"":"none",E.style.zIndex=""+k.props.zIndex}function F(Ne,Fe,Ke){if(Ke===void 0&&(Ke=!0),O.forEach(function(wt){wt[Ne]&&wt[Ne].apply(wt,Fe)}),Ke){var Tt;(Tt=k.props)[Ne].apply(Tt,Fe)}}function q(){var Ne=k.props.aria;if(Ne.content){var Fe="aria-"+Ne.content,Ke=E.id,Tt=wp(k.props.triggerTarget||e);Tt.forEach(function(wt){var Zt=wt.getAttribute(Fe);if(k.state.isVisible)wt.setAttribute(Fe,Zt?Zt+" "+Ke:Ke);else{var Xe=Zt&&Zt.replace(Ke,"").trim();Xe?wt.setAttribute(Fe,Xe):wt.removeAttribute(Fe)}})}}function Q(){if(!(R||!k.props.aria.expanded)){var Ne=wp(k.props.triggerTarget||e);Ne.forEach(function(Fe){k.props.interactive?Fe.setAttribute("aria-expanded",k.state.isVisible&&Fe===A()?"true":"false"):Fe.removeAttribute("aria-expanded")})}}function W(){M().removeEventListener("mousemove",v),ES=ES.filter(function(Ne){return Ne!==v})}function G(Ne){if(!(vl.isTouch&&(c||Ne.type==="mousedown"))){var Fe=Ne.composedPath&&Ne.composedPath()[0]||Ne.target;if(!(k.props.interactive&&eZ(E,Fe))){if(wp(k.props.triggerTarget||e).some(function(Ke){return eZ(Ke,Fe)})){if(vl.isTouch||k.state.isVisible&&k.props.trigger.indexOf("click")>=0)return}else F("onClickOutside",[k,Ne]);k.props.hideOnClick===!0&&(k.clearDelayTimeouts(),k.hide(),l=!0,setTimeout(function(){l=!1}),k.state.isMounted||se())}}}function J(){c=!0}function X(){c=!1}function V(){var Ne=M();Ne.addEventListener("mousedown",G,!0),Ne.addEventListener("touchend",G,zf),Ne.addEventListener("touchstart",X,zf),Ne.addEventListener("touchmove",J,zf)}function se(){var Ne=M();Ne.removeEventListener("mousedown",G,!0),Ne.removeEventListener("touchend",G,zf),Ne.removeEventListener("touchstart",X,zf),Ne.removeEventListener("touchmove",J,zf)}function de(Ne,Fe){te(Ne,function(){!k.state.isVisible&&E.parentNode&&E.parentNode.contains(E)&&Fe()})}function he(Ne,Fe){te(Ne,Fe)}function te(Ne,Fe){var Ke=P().box;function Tt(wt){wt.target===Ke&&(oL(Ke,"remove",Tt),Fe())}if(Ne===0)return Fe();oL(Ke,"remove",f),oL(Ke,"add",Tt),f=Tt}function le(Ne,Fe,Ke){Ke===void 0&&(Ke=!1);var Tt=wp(k.props.triggerTarget||e);Tt.forEach(function(wt){wt.addEventListener(Ne,Fe,Ke),p.push({node:wt,eventType:Ne,handler:Fe,options:Ke})})}function oe(){$()&&(le("touchstart",ve,{passive:!0}),le("touchend",ge,{passive:!0})),iWe(k.props.trigger).forEach(function(Ne){if(Ne!=="manual")switch(le(Ne,ve),Ne){case"mouseenter":le("mouseleave",ge);break;case"focus":le(yWe?"focusout":"blur",ue);break;case"focusin":le("focusout",ue);break}})}function Z(){p.forEach(function(Ne){var Fe=Ne.node,Ke=Ne.eventType,Tt=Ne.handler,wt=Ne.options;Fe.removeEventListener(Ke,Tt,wt)}),p=[]}function ve(Ne){var Fe,Ke=!1;if(!(!k.state.isEnabled||re(Ne)||l)){var Tt=((Fe=d)==null?void 0:Fe.type)==="focus";d=Ne,b=Ne.currentTarget,Q(),!k.state.isVisible&&uWe(Ne)&&ES.forEach(function(wt){return wt(Ne)}),Ne.type==="click"&&(k.props.trigger.indexOf("mouseenter")<0||i)&&k.props.hideOnClick!==!1&&k.state.isVisible?Ke=!0:pe(Ne),Ne.type==="click"&&(i=!Ke),Ke&&!Tt&&Oe(Ne)}}function U(Ne){var Fe=Ne.target,Ke=A().contains(Fe)||E.contains(Fe);if(!(Ne.type==="mousemove"&&Ke)){var Tt=we().concat(E).map(function(wt){var Zt,Xe=wt._tippy,nt=(Zt=Xe.popperInstance)==null?void 0:Zt.state;return nt?{popperRect:wt.getBoundingClientRect(),popperState:nt,props:r}:null}).filter(Boolean);mWe(Tt,Ne)&&(W(),Oe(Ne))}}function ge(Ne){var Fe=re(Ne)||k.props.trigger.indexOf("click")>=0&&i;if(!Fe){if(k.props.interactive){k.hideWithInteractivity(Ne);return}Oe(Ne)}}function ue(Ne){k.props.trigger.indexOf("focusin")<0&&Ne.target!==A()||k.props.interactive&&Ne.relatedTarget&&E.contains(Ne.relatedTarget)||Oe(Ne)}function re(Ne){return vl.isTouch?$()!==Ne.type.indexOf("touch")>=0:!1}function ne(){me();var Ne=k.props,Fe=Ne.popperOptions,Ke=Ne.placement,Tt=Ne.offset,wt=Ne.getReferenceClientRect,Zt=Ne.moveTransition,Xe=L()?JR(E).arrow:null,nt=wt?{getBoundingClientRect:wt,contextElement:wt.contextElement||A()}:e,bt={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(De){var Ue=De.state;if(L()){var dt=P(),Nt=dt.box;["placement","reference-hidden","escaped"].forEach(function(Mt){Mt==="placement"?Nt.setAttribute("data-placement",Ue.placement):Ue.attributes.popper["data-popper-"+Mt]?Nt.setAttribute("data-"+Mt,""):Nt.removeAttribute("data-"+Mt)}),Ue.attributes.popper={}}}},Ct=[{name:"offset",options:{offset:Tt}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Zt}},bt];L()&&Xe&&Ct.push({name:"arrow",options:{element:Xe,padding:3}}),Ct.push.apply(Ct,Fe?.modifiers||[]),k.popperInstance=nWe(nt,E,Object.assign({},Fe,{placement:Ke,onFirstUpdate:m,modifiers:Ct}))}function me(){k.popperInstance&&(k.popperInstance.destroy(),k.popperInstance=null)}function ke(){var Ne=k.props.appendTo,Fe,Ke=A();k.props.interactive&&Ne===Wfe||Ne==="parent"?Fe=Ke.parentNode:Fe=Kfe(Ne,[Ke]),Fe.contains(E)||Fe.appendChild(E),k.state.isMounted=!0,ne()}function we(){return XN(E.querySelectorAll("[data-tippy-root]"))}function pe(Ne){k.clearDelayTimeouts(),Ne&&F("onTrigger",[k,Ne]),V();var Fe=I(!0),Ke=H(),Tt=Ke[0],wt=Ke[1];vl.isTouch&&Tt==="hold"&&wt&&(Fe=wt),Fe?n=setTimeout(function(){k.show()},Fe):k.show()}function Oe(Ne){if(k.clearDelayTimeouts(),F("onUntrigger",[k,Ne]),!k.state.isVisible){se();return}if(!(k.props.trigger.indexOf("mouseenter")>=0&&k.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(Ne.type)>=0&&i)){var Fe=I(!1);Fe?a=setTimeout(function(){k.state.isVisible&&k.hide()},Fe):s=requestAnimationFrame(function(){k.hide()})}}function Ae(){k.state.isEnabled=!0}function Re(){k.hide(),k.state.isEnabled=!1}function Ve(){clearTimeout(n),clearTimeout(a),cancelAnimationFrame(s)}function gt(Ne){if(!k.state.isDestroyed){F("onBeforeUpdate",[k,Ne]),Z();var Fe=k.props,Ke=rZ(e,Object.assign({},Fe,ZJ(Ne),{ignoreAttributes:!0}));k.props=Ke,oe(),Fe.interactiveDebounce!==Ke.interactiveDebounce&&(W(),v=QJ(U,Ke.interactiveDebounce)),Fe.triggerTarget&&!Ke.triggerTarget?wp(Fe.triggerTarget).forEach(function(Tt){Tt.removeAttribute("aria-expanded")}):Ke.triggerTarget&&e.removeAttribute("aria-expanded"),Q(),B(),T&&T(Fe,Ke),k.popperInstance&&(ne(),we().forEach(function(Tt){requestAnimationFrame(Tt._tippy.popperInstance.forceUpdate)})),F("onAfterUpdate",[k,Ne])}}function lt(Ne){k.setProps({content:Ne})}function Pt(){var Ne=k.state.isVisible,Fe=k.state.isDestroyed,Ke=!k.state.isEnabled,Tt=vl.isTouch&&!k.props.touch,wt=sL(k.props.duration,0,Ko.duration);if(!(Ne||Fe||Ke||Tt)&&!A().hasAttribute("disabled")&&(F("onShow",[k],!1),k.props.onShow(k)!==!1)){if(k.state.isVisible=!0,L()&&(E.style.visibility="visible"),B(),V(),k.state.isMounted||(E.style.transition="none"),L()){var Zt=P(),Xe=Zt.box,nt=Zt.content;iL([Xe,nt],0)}m=function(){var Ct;if(!(!k.state.isVisible||u)){if(u=!0,E.offsetHeight,E.style.transition=k.props.moveTransition,L()&&k.props.animation){var fe=P(),De=fe.box,Ue=fe.content;iL([De,Ue],wt),XJ([De,Ue],"visible")}q(),Q(),JJ(lL,k),(Ct=k.popperInstance)==null||Ct.forceUpdate(),F("onMount",[k]),k.props.animation&&L()&&he(wt,function(){k.state.isShown=!0,F("onShown",[k])})}},ke()}}function fr(){var Ne=!k.state.isVisible,Fe=k.state.isDestroyed,Ke=!k.state.isEnabled,Tt=sL(k.props.duration,1,Ko.duration);if(!(Ne||Fe||Ke)&&(F("onHide",[k],!1),k.props.onHide(k)!==!1)){if(k.state.isVisible=!1,k.state.isShown=!1,u=!1,i=!1,L()&&(E.style.visibility="hidden"),W(),se(),B(!0),L()){var wt=P(),Zt=wt.box,Xe=wt.content;k.props.animation&&(iL([Zt,Xe],Tt),XJ([Zt,Xe],"hidden"))}q(),Q(),k.props.animation?L()&&de(Tt,k.unmount):k.unmount()}}function Qe(Ne){M().addEventListener("mousemove",v),JJ(ES,v),v(Ne)}function Vt(){k.state.isVisible&&k.hide(),k.state.isMounted&&(me(),we().forEach(function(Ne){Ne._tippy.unmount()}),E.parentNode&&E.parentNode.removeChild(E),lL=lL.filter(function(Ne){return Ne!==k}),k.state.isMounted=!1,F("onHidden",[k]))}function at(){k.state.isDestroyed||(k.clearDelayTimeouts(),k.unmount(),Z(),delete e._tippy,k.state.isDestroyed=!0,F("onDestroy",[k]))}}function em(e,t){t===void 0&&(t={});var r=Ko.plugins.concat(t.plugins||[]);vWe();var n=Object.assign({},t,{plugins:r}),a=fWe(e),s=a.reduce(function(i,l){var c=l&&jWe(l,n);return c&&i.push(c),i},[]);return c2(e)?s[0]:s}em.defaultProps=Ko;em.setDefaultProps=kWe;em.currentInput=vl;Object.assign({},Ofe,{effect:function(t){var r=t.state,n={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,n.popper),r.styles=n,r.elements.arrow&&Object.assign(r.elements.arrow.style,n.arrow)}});em.setDefaultProps({render:Yfe});const EWe=e=>[{id:"bold",title:"Bold",description:"Make text bold",icon:o.jsx(TO,{className:"w-4 h-4"}),category:"formatting",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleBold().run()}},{id:"italic",title:"Italic",description:"Make text italic",icon:o.jsx(AO,{className:"w-4 h-4"}),category:"formatting",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleItalic().run()}},{id:"code",title:"Inline Code",description:"Format as inline code",icon:o.jsx(Kp,{className:"w-4 h-4"}),category:"formatting",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleCode().run()}},{id:"codeblock",title:"Code Block",description:"Insert a code block",icon:o.jsx(Bi,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleCodeBlock().run()}},{id:"quote",title:"Quote",description:"Insert a block quote",icon:o.jsx(qae,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleBlockquote().run()}},{id:"bullet",title:"Bullet List",description:"Create a simple bullet list",icon:o.jsx(Wp,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleBulletList().run()}},{id:"numbered",title:"Numbered List",description:"Create a numbered list",icon:o.jsx(Wae,{className:"w-4 h-4"}),category:"blocks",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).toggleOrderedList().run()}},{id:"emoji",title:"Emoji",description:"Insert an emoji",icon:o.jsx(gwe,{className:"w-4 h-4"}),category:"media",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).run(),e?.onEmojiInsert&&e.onEmojiInsert()}},{id:"task",title:"Task",description:"Reference a task",icon:o.jsx(Tl,{className:"w-4 h-4"}),category:"embeds",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).run(),e?.onTaskEmbed&&e.onTaskEmbed()}},{id:"doc",title:"Document",description:"Reference a document",icon:o.jsx(rn,{className:"w-4 h-4"}),category:"embeds",action:({editor:t,range:r})=>{t.chain().focus().deleteRange(r).run(),e?.onDocumentEmbed&&e.onDocumentEmbed()}}];function MWe(e,t){if(!e)return t;const r=e.toLowerCase();return t.filter(n=>{const a=n.title.toLowerCase().includes(r),s=n.description.toLowerCase().includes(r),i=n.id.toLowerCase().includes(r);return a||s||i})}function TWe(e){const t={formatting:[],blocks:[],media:[],embeds:[]};for(const r of e)t[r.category]&&t[r.category].push(r);return t}const AWe={formatting:"Formatting",blocks:"Blocks",media:"Media",embeds:"Embeds"},Qfe=w.forwardRef(({items:e,command:t},r)=>{const[n,a]=w.useState(0);w.useEffect(()=>{a(0)},[e]);const s=w.useCallback(c=>{const u=e[c];u&&t(u)},[e,t]);if(w.useImperativeHandle(r,()=>({onKeyDown:({event:c})=>c.key==="ArrowUp"?(a(u=>u<=0?e.length-1:u-1),!0):c.key==="ArrowDown"?(a(u=>u>=e.length-1?0:u+1),!0):c.key==="Enter"?(s(n),!0):c.key==="Escape"})),!e.length)return o.jsx("div",{"data-testid":"message-slash-command-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[240px]",children:o.jsx("div",{className:"text-sm text-gray-500",children:"No matching commands"})});const i=TWe(e);let l=0;return o.jsx("div",{"data-testid":"message-slash-command-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-1 min-w-[240px] max-h-[300px] overflow-y-auto",children:Object.entries(i).map(([c,u])=>u.length===0?null:o.jsxs("div",{"data-testid":`message-slash-category-${c}`,children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:AWe[c]}),u.map(d=>{const f=l++,m=f===n;return o.jsxs("button",{"data-testid":`message-slash-item-${d.id}`,className:`w-full flex items-start gap-3 px-3 py-2 rounded text-left transition-colors ${m?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,onClick:p=>{p.preventDefault(),p.stopPropagation(),s(f)},onMouseDown:p=>{p.preventDefault()},onMouseEnter:()=>a(f),children:[o.jsx("div",{className:`mt-0.5 flex-shrink-0 ${m?"text-blue-600":"text-gray-400"}`,children:d.icon}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium",children:d.title}),o.jsx("div",{className:"text-xs text-gray-500 truncate",children:d.description})]})]},d.id)})]},c))})});Qfe.displayName="MessageSlashCommandMenu";function DWe(e){return{char:"/",startOfLine:!1,items:({query:t})=>{const r=EWe(e);return MWe(t,r)},render:()=>{let t=null,r=null;return{onStart:n=>{t=new R9(Qfe,{props:{items:n.items,command:n.command},editor:n.editor}),n.clientRect&&(r=em(document.body,{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"top-start",animation:"fade",zIndex:9999}))},onUpdate:n=>{t&&t.updateProps({items:n.items,command:n.command}),r&&n.clientRect&&r.setProps({getReferenceClientRect:n.clientRect})},onKeyDown:n=>n.event.key==="Escape"?(r?.hide(),!0):t?.ref?t.ref.onKeyDown(n):!1,onExit:()=>{r?.destroy(),t?.destroy()}}},command:({editor:t,range:r,props:n})=>{n.action({editor:t,range:r})}}}const LWe=new Qr("messageSlashCommands"),OWe=Br.create({name:"messageSlashCommands",addOptions(){return{embedCallbacks:void 0}},addProseMirrorPlugins(){return[J9({editor:this.editor,pluginKey:LWe,...DWe(this.options.embedCallbacks)})]}}),Jfe=w.forwardRef(({items:e,command:t,isLoading:r=!1,query:n=""},a)=>{const[s,i]=w.useState(0);w.useEffect(()=>{i(0)},[e]);const l=w.useCallback(f=>{const m=e[f];m&&t(m)},[e,t]);if(w.useImperativeHandle(a,()=>({onKeyDown:({event:f})=>f.key==="ArrowUp"?(i(m=>m<=0?e.length-1:m-1),!0):f.key==="ArrowDown"?(i(m=>m>=e.length-1?0:m+1),!0):f.key==="Enter"?(e.length>0&&l(s),!0):f.key==="Escape"})),r)return o.jsx("div",{"data-testid":"hash-autocomplete-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[280px]",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),o.jsx("span",{children:"Searching..."})]})});if(!e.length)return o.jsx("div",{"data-testid":"hash-autocomplete-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[280px]",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[o.jsx(xr,{className:"w-4 h-4"}),o.jsx("span",{children:n?`No results for "${n}"`:"Type to search tasks and documents"})]})});const c=e.filter(f=>f.type==="task"),u=e.filter(f=>f.type==="document");let d=0;return o.jsxs("div",{"data-testid":"hash-autocomplete-menu",className:"bg-white rounded-lg shadow-lg border border-gray-200 p-1 min-w-[280px] max-h-[300px] overflow-y-auto",children:[c.length>0&&o.jsxs("div",{"data-testid":"hash-autocomplete-tasks",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Tasks"}),c.map(f=>{const m=d++,p=m===s;return o.jsxs("button",{"data-testid":`hash-item-task-${f.id}`,className:`w-full flex items-start gap-3 px-3 py-2 rounded text-left transition-colors ${p?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,onClick:v=>{v.preventDefault(),v.stopPropagation(),l(m)},onMouseDown:v=>{v.preventDefault()},onMouseEnter:()=>i(m),children:[o.jsx("div",{className:`mt-0.5 flex-shrink-0 ${p?"text-blue-600":"text-gray-400"}`,children:f.icon}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:f.title}),f.subtitle&&o.jsx("div",{className:"text-xs text-gray-500 truncate",children:f.subtitle})]})]},`task-${f.id}`)})]}),u.length>0&&o.jsxs("div",{"data-testid":"hash-autocomplete-documents",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Documents"}),u.map(f=>{const m=d++,p=m===s;return o.jsxs("button",{"data-testid":`hash-item-doc-${f.id}`,className:`w-full flex items-start gap-3 px-3 py-2 rounded text-left transition-colors ${p?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,onClick:v=>{v.preventDefault(),v.stopPropagation(),l(m)},onMouseDown:v=>{v.preventDefault()},onMouseEnter:()=>i(m),children:[o.jsx("div",{className:`mt-0.5 flex-shrink-0 ${p?"text-blue-600":"text-gray-400"}`,children:f.icon}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:f.title}),f.subtitle&&o.jsx("div",{className:"text-xs text-gray-500 truncate",children:f.subtitle})]})]},`doc-${f.id}`)})]})]})});Jfe.displayName="HashAutocompleteMenu";async function sZ(e){return[]}function IWe(e){let t=[],r=!1,n="",a=null;return{char:"#",startOfLine:!1,allowSpaces:!1,items:async({query:s})=>{n=s,a&&a.abort(),a=new AbortController,r=!0;try{if(await new Promise(l=>setTimeout(l,150)),a.signal.aborted)return t;const i=await e(s);return t=i,r=!1,i}catch{return r=!1,t=[],[]}},render:()=>{let s=null,i=null;return{onStart:l=>{s=new R9(Jfe,{props:{items:l.items,command:l.command,isLoading:r,query:n},editor:l.editor}),l.clientRect&&(i=em(document.body,{getReferenceClientRect:l.clientRect,appendTo:()=>document.body,content:s.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"top-start",animation:"fade",zIndex:9999}))},onUpdate:l=>{s&&s.updateProps({items:l.items,command:l.command,isLoading:r,query:n}),i&&l.clientRect&&i.setProps({getReferenceClientRect:l.clientRect})},onKeyDown:l=>l.event.key==="Escape"?(i?.hide(),!0):s?.ref?s.ref.onKeyDown(l):!1,onExit:()=>{i?.destroy(),s?.destroy(),a?.abort()}}},command:({editor:s,range:i,props:l})=>{const c=`![[${l.type}:${l.id}]]`;s.chain().focus().deleteRange(i).insertContent(c+" ").run()}}}const RWe=new Qr("hashAutocomplete"),PWe=Br.create({name:"hashAutocomplete",addOptions(){return{fetchElements:sZ}},addProseMirrorPlugins(){return[J9({editor:this.editor,pluginKey:RWe,...IWe(this.options.fetchElements||sZ)})]}});function zWe(e="/api"){return async t=>{const r=[];try{const[n,a]=await Promise.all([fetch(`${e}/tasks?search=${encodeURIComponent(t)}&limit=5`),fetch(`${e}/documents?search=${encodeURIComponent(t)}&limit=5`)]);if(n.ok){const s=await n.json(),i=s.items||s;for(const l of i.slice(0,5))r.push({id:l.id,type:"task",title:l.title,subtitle:l.status?`Status: ${l.status}`:void 0,icon:o.jsx(Tl,{className:"w-4 h-4"})})}if(a.ok){const s=await a.json(),i=s.items||s;for(const l of i.slice(0,5))r.push({id:l.id,type:"document",title:l.title,subtitle:l.contentType||"Document",icon:o.jsx(rn,{className:"w-4 h-4"})})}}catch(n){console.error("Error fetching elements for autocomplete:",n)}return r}}const BWe=Fs.create({name:"mention",group:"inline",inline:!0,selectable:!0,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-mention-id"),renderHTML:e=>e.id?{"data-mention-id":e.id}:{}},name:{default:null,parseHTML:e=>e.getAttribute("data-mention-name"),renderHTML:e=>e.name?{"data-mention-name":e.name}:{}},entityType:{default:"human",parseHTML:e=>e.getAttribute("data-entity-type"),renderHTML:e=>e.entityType?{"data-entity-type":e.entityType}:{}}}},parseHTML(){return[{tag:"span[data-mention-id]"}]},renderHTML({node:e,HTMLAttributes:t}){return["a",Jn(t,{class:"mention-chip",href:`/entities?selected=${e.attrs.id}`}),`@${e.attrs.name}`]},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:t})=>{let r=!1;const{selection:n}=t,{empty:a,anchor:s}=n;return a?(t.doc.nodesBetween(s-1,s,(i,l)=>{if(i.type.name===this.name)return r=!0,e.insertText("",l,l+i.nodeSize),!1}),r):!1})}}});function $We(e,t){if(!e)return t.slice(0,10);const r=e.toLowerCase(),n=[],a=new Set;for(const s of t)s.name.toLowerCase()===r&&!a.has(s.id)&&(a.add(s.id),n.push(s));for(const s of t)s.name.toLowerCase().startsWith(r)&&!a.has(s.id)&&(a.add(s.id),n.push(s));for(const s of t)s.name.toLowerCase().includes(r)&&!a.has(s.id)&&(a.add(s.id),n.push(s));return n.slice(0,10)}function FWe(e){switch(e){case"agent":return o.jsx(Vr,{className:"w-4 h-4"});case"system":return o.jsx(Wa,{className:"w-4 h-4"});case"human":default:return o.jsx(tn,{className:"w-4 h-4"})}}function UWe(e){switch(e){case"agent":return"Agent";case"system":return"System";case"human":default:return"Human"}}const Zfe=w.forwardRef(({items:e,command:t},r)=>{const[n,a]=w.useState(0);w.useEffect(()=>{a(0)},[e]);const s=w.useCallback(i=>{const l=e[i];l&&t(l)},[e,t]);return w.useImperativeHandle(r,()=>({onKeyDown:({event:i})=>i.key==="ArrowUp"?(a(l=>l<=0?e.length-1:l-1),!0):i.key==="ArrowDown"?(a(l=>l>=e.length-1?0:l+1),!0):i.key==="Enter"?(s(n),!0):i.key==="Escape"})),e.length?o.jsx("div",{"data-testid":"mention-autocomplete-menu",className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-1 min-w-[220px] max-h-[280px] overflow-y-auto",children:e.map((i,l)=>{const c=l===n;return o.jsxs("button",{"data-testid":`mention-item-${i.name}`,className:`w-full flex items-center gap-3 px-3 py-2 rounded text-left transition-colors ${c?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),s(l)},onMouseDown:u=>{u.preventDefault()},onMouseEnter:()=>a(l),children:[o.jsx("span",{className:`flex items-center justify-center w-8 h-8 rounded-full ${i.entityType==="agent"?"bg-purple-100 text-purple-600 dark:bg-purple-900/50 dark:text-purple-400":i.entityType==="system"?"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400":"bg-blue-100 text-blue-600 dark:bg-blue-900/50 dark:text-blue-400"}`,children:FWe(i.entityType)}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"font-medium truncate",children:["@",i.name]}),o.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:UWe(i.entityType)})]})]},i.id)})}):o.jsx("div",{"data-testid":"mention-autocomplete-menu",className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-3 min-w-[200px]",children:o.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No matching entities"})})});Zfe.displayName="MentionMenu";function HWe(e){return{char:"@",startOfLine:!1,allowSpaces:!1,items:({query:t})=>{const r=e.getEntities();return $We(t,r)},render:()=>{let t=null,r=null;return{onStart:n=>{t=new R9(Zfe,{props:{items:n.items,command:n.command},editor:n.editor}),n.clientRect&&(r=em(document.body,{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start",animation:"fade",zIndex:9999}))},onUpdate:n=>{t&&t.updateProps({items:n.items,command:n.command}),r&&n.clientRect&&r.setProps({getReferenceClientRect:n.clientRect})},onKeyDown:n=>n.event.key==="Escape"?(r?.hide(),!0):t?.ref?t.ref.onKeyDown(n):!1,onExit:()=>{r?.destroy(),t?.destroy()}}},command:({editor:t,range:r,props:n})=>{t.chain().focus().deleteRange(r).insertContent([{type:"mention",attrs:{id:n.id,name:n.name,entityType:n.entityType}},{type:"text",text:" "}]).run()}}}const qWe=new Qr("mentionSuggestion"),WWe=Br.create({name:"mentionAutocomplete",addOptions(){return{getEntities:()=>[]}},addProseMirrorPlugins(){return[J9({editor:this.editor,pluginKey:qWe,...HWe(this.options)})]}});function Xfe(e){const t=e.trim();return t?/^https?:\/\//i.test(t)||/^mailto:/i.test(t)?t:`https://${t}`:""}function KWe(e){try{const t=Xfe(e);return t?(new URL(t),!0):!1}catch{return!1}}function GWe({editor:e,onClose:t,anchorRect:r}){const n=e.isActive("link"),a=n&&e.getAttributes("link").href||"",[s,i]=w.useState(a),l=w.useRef(null),c=w.useRef(null);w.useEffect(()=>{const p=setTimeout(()=>{l.current?.focus(),l.current?.select()},50);return()=>clearTimeout(p)},[]),w.useEffect(()=>{function p(v){c.current&&!c.current.contains(v.target)&&t()}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[t]);const u=w.useCallback(()=>{const p=Xfe(s);if(!p||!KWe(s)){n&&e.chain().focus().unsetLink().run(),t();return}e.chain().focus().setLink({href:p}).run(),t()},[e,s,n,t]),d=w.useCallback(()=>{e.chain().focus().unsetLink().run(),t()},[e,t]),f=w.useCallback(p=>{p.key==="Enter"?(p.preventDefault(),u()):p.key==="Escape"&&(p.preventDefault(),t())},[u,t]),m={};return r&&(m.position="fixed",m.top=`${r.bottom+4}px`,m.left=`${r.left}px`,m.zIndex=50),o.jsxs("div",{ref:c,"data-testid":"link-popover",className:"bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex items-center gap-2 min-w-[320px]",style:m,children:[o.jsx("input",{ref:l,type:"text",value:s,onChange:p=>i(p.target.value),onKeyDown:f,placeholder:"Enter URL (e.g., https://example.com)","data-testid":"link-popover-input",className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("button",{type:"button",onClick:u,disabled:!s.trim(),"data-testid":"link-popover-apply",title:"Apply link",className:"px-2 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:n?"Update":"Apply"}),n&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",onClick:d,"data-testid":"link-popover-remove",title:"Remove link",className:"p-1 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",children:o.jsx(vwe,{className:"w-4 h-4"})}),o.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",title:"Open link in new tab","data-testid":"link-popover-open",className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:o.jsx(wl,{className:"w-4 h-4"})})]})]})}function VWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e}function ZR(e,t){return Array(t+1).join(e)}function ehe(e){return e.replace(/^\n*/,"")}function the(e){for(var t=e.length;t>0&&e[t-1]===`
`;)t--;return e.substring(0,t)}function rhe(e){return the(ehe(e))}var YWe=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function iB(e){return oB(e,YWe)}var nhe=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function ahe(e){return oB(e,nhe)}function QWe(e){return ihe(e,nhe)}var she=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function JWe(e){return oB(e,she)}function ZWe(e){return ihe(e,she)}function oB(e,t){return t.indexOf(e.nodeName)>=0}function ihe(e,t){return e.getElementsByTagName&&t.some(function(r){return e.getElementsByTagName(r).length})}var ks={};ks.paragraph={filter:"p",replacement:function(e){return`

`+e+`

`}};ks.lineBreak={filter:"br",replacement:function(e,t,r){return r.br+`
`}};ks.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,r){var n=Number(t.nodeName.charAt(1));if(r.headingStyle==="setext"&&n<3){var a=ZR(n===1?"=":"-",e.length);return`

`+e+`
`+a+`

`}else return`

`+ZR("#",n)+" "+e+`

`}};ks.blockquote={filter:"blockquote",replacement:function(e){return e=rhe(e).replace(/^/gm,"> "),`

`+e+`

`}};ks.list={filter:["ul","ol"],replacement:function(e,t){var r=t.parentNode;return r.nodeName==="LI"&&r.lastElementChild===t?`
`+e:`

`+e+`

`}};ks.listItem={filter:"li",replacement:function(e,t,r){var n=r.bulletListMarker+"   ",a=t.parentNode;if(a.nodeName==="OL"){var s=a.getAttribute("start"),i=Array.prototype.indexOf.call(a.children,t);n=(s?Number(s)+i:i+1)+".  "}var l=/\n$/.test(e);return e=rhe(e)+(l?`
`:""),e=e.replace(/\n/gm,`
`+" ".repeat(n.length)),n+e+(t.nextSibling?`
`:"")}};ks.indentedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="indented"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};ks.fencedCodeBlock={filter:function(e,t){return t.codeBlockStyle==="fenced"&&e.nodeName==="PRE"&&e.firstChild&&e.firstChild.nodeName==="CODE"},replacement:function(e,t,r){for(var n=t.firstChild.getAttribute("class")||"",a=(n.match(/language-(\S+)/)||[null,""])[1],s=t.firstChild.textContent,i=r.fence.charAt(0),l=3,c=new RegExp("^"+i+"{3,}","gm"),u;u=c.exec(s);)u[0].length>=l&&(l=u[0].length+1);var d=ZR(i,l);return`

`+d+a+`
`+s.replace(/\n$/,"")+`
`+d+`

`}};ks.horizontalRule={filter:"hr",replacement:function(e,t,r){return`

`+r.hr+`

`}};ks.inlineLink={filter:function(e,t){return t.linkStyle==="inlined"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t){var r=t.getAttribute("href");r&&(r=r.replace(/([()])/g,"\\$1"));var n=eC(t.getAttribute("title"));return n&&(n=' "'+n.replace(/"/g,'\\"')+'"'),"["+e+"]("+r+n+")"}};ks.referenceLink={filter:function(e,t){return t.linkStyle==="referenced"&&e.nodeName==="A"&&e.getAttribute("href")},replacement:function(e,t,r){var n=t.getAttribute("href"),a=eC(t.getAttribute("title"));a&&(a=' "'+a+'"');var s,i;switch(r.linkReferenceStyle){case"collapsed":s="["+e+"][]",i="["+e+"]: "+n+a;break;case"shortcut":s="["+e+"]",i="["+e+"]: "+n+a;break;default:var l=this.references.length+1;s="["+e+"]["+l+"]",i="["+l+"]: "+n+a}return this.references.push(i),s},references:[],append:function(e){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};ks.emphasis={filter:["em","i"],replacement:function(e,t,r){return e.trim()?r.emDelimiter+e+r.emDelimiter:""}};ks.strong={filter:["strong","b"],replacement:function(e,t,r){return e.trim()?r.strongDelimiter+e+r.strongDelimiter:""}};ks.code={filter:function(e){var t=e.previousSibling||e.nextSibling,r=e.parentNode.nodeName==="PRE"&&!t;return e.nodeName==="CODE"&&!r},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",r="`",n=e.match(/`+/gm)||[];n.indexOf(r)!==-1;)r=r+"`";return r+t+e+t+r}};ks.image={filter:"img",replacement:function(e,t){var r=eC(t.getAttribute("alt")),n=t.getAttribute("src")||"",a=eC(t.getAttribute("title")),s=a?' "'+a+'"':"";return n?"!["+r+"]("+n+s+")":""}};function eC(e){return e?e.replace(/(\n+\s*)+/g,`
`):""}function ohe(e){this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[];for(var t in e.rules)this.array.push(e.rules[t])}ohe.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){if(e.isBlank)return this.blankRule;var t;return(t=cL(this.array,e,this.options))||(t=cL(this._keep,e,this.options))||(t=cL(this._remove,e,this.options))?t:this.defaultRule},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};function cL(e,t,r){for(var n=0;n<e.length;n++){var a=e[n];if(XWe(a,t,r))return a}}function XWe(e,t,r){var n=e.filter;if(typeof n=="string"){if(n===t.nodeName.toLowerCase())return!0}else if(Array.isArray(n)){if(n.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof n=="function"){if(n.call(e,t,r))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function eKe(e){var t=e.element,r=e.isBlock,n=e.isVoid,a=e.isPre||function(f){return f.nodeName==="PRE"};if(!(!t.firstChild||a(t))){for(var s=null,i=!1,l=null,c=iZ(l,t,a);c!==t;){if(c.nodeType===3||c.nodeType===4){var u=c.data.replace(/[ \r\n\t]+/g," ");if((!s||/ $/.test(s.data))&&!i&&u[0]===" "&&(u=u.substr(1)),!u){c=uL(c);continue}c.data=u,s=c}else if(c.nodeType===1)r(c)||c.nodeName==="BR"?(s&&(s.data=s.data.replace(/ $/,"")),s=null,i=!1):n(c)||a(c)?(s=null,i=!0):s&&(i=!1);else{c=uL(c);continue}var d=iZ(l,c,a);l=c,c=d}s&&(s.data=s.data.replace(/ $/,""),s.data||uL(s))}}function uL(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function iZ(e,t,r){return e&&e.parentNode===t||r(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var lB=typeof window<"u"?window:{};function tKe(){var e=lB.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0)}catch{}return t}function rKe(){var e=function(){};return nKe()?e.prototype.parseFromString=function(t){var r=new window.ActiveXObject("htmlfile");return r.designMode="on",r.open(),r.write(t),r.close(),r}:e.prototype.parseFromString=function(t){var r=document.implementation.createHTMLDocument("");return r.open(),r.write(t),r.close(),r},e}function nKe(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch{lB.ActiveXObject&&(e=!0)}return e}var aKe=tKe()?lB.DOMParser:rKe();function sKe(e,t){var r;if(typeof e=="string"){var n=iKe().parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html");r=n.getElementById("turndown-root")}else r=e.cloneNode(!0);return eKe({element:r,isBlock:iB,isVoid:ahe,isPre:t.preformattedCode?oKe:null}),r}var dL;function iKe(){return dL=dL||new aKe,dL}function oKe(e){return e.nodeName==="PRE"||e.nodeName==="CODE"}function lKe(e,t){return e.isBlock=iB(e),e.isCode=e.nodeName==="CODE"||e.parentNode.isCode,e.isBlank=cKe(e),e.flankingWhitespace=uKe(e,t),e}function cKe(e){return!ahe(e)&&!JWe(e)&&/^\s*$/i.test(e.textContent)&&!QWe(e)&&!ZWe(e)}function uKe(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var r=dKe(e.textContent);return r.leadingAscii&&oZ("left",e,t)&&(r.leading=r.leadingNonAscii),r.trailingAscii&&oZ("right",e,t)&&(r.trailing=r.trailingNonAscii),{leading:r.leading,trailing:r.trailing}}function dKe(e){var t=e.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function oZ(e,t,r){var n,a,s;return e==="left"?(n=t.previousSibling,a=/ $/):(n=t.nextSibling,a=/^ /),n&&(n.nodeType===3?s=a.test(n.nodeValue):r.preformattedCode&&n.nodeName==="CODE"?s=!1:n.nodeType===1&&!iB(n)&&(s=a.test(n.textContent))),s}var fKe=Array.prototype.reduce,hKe=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function sx(e){if(!(this instanceof sx))return new sx(e);var t={rules:ks,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(r,n){return n.isBlock?`

`:""},keepReplacement:function(r,n){return n.isBlock?`

`+n.outerHTML+`

`:n.outerHTML},defaultReplacement:function(r,n){return n.isBlock?`

`+r+`

`:r}};this.options=VWe({},t,e),this.rules=new ohe(this.options)}sx.prototype={turndown:function(e){if(!gKe(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(e==="")return"";var t=lhe.call(this,new sKe(e,this.options));return mKe.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else if(typeof e=="function")e(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return hKe.reduce(function(t,r){return t.replace(r[0],r[1])},e)}};function lhe(e){var t=this;return fKe.call(e.childNodes,function(r,n){n=new lKe(n,t.options);var a="";return n.nodeType===3?a=n.isCode?n.nodeValue:t.escape(n.nodeValue):n.nodeType===1&&(a=pKe.call(t,n)),che(r,a)},"")}function mKe(e){var t=this;return this.rules.forEach(function(r){typeof r.append=="function"&&(e=che(e,r.append(t.options)))}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function pKe(e){var t=this.rules.forNode(e),r=lhe.call(this,e),n=e.flankingWhitespace;return(n.leading||n.trailing)&&(r=r.trim()),n.leading+t.replacement(r,e,this.options)+n.trailing}function che(e,t){var r=the(e),n=ehe(t),a=Math.max(e.length-r.length,t.length-n.length),s=`

`.substring(0,a);return r+s+n}function gKe(e){return e!=null&&(typeof e=="string"||e.nodeType&&(e.nodeType===1||e.nodeType===9||e.nodeType===11))}function cB(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var tm=cB();function uhe(e){tm=e}var Vb={exec:()=>null};function zr(e,t=""){let r=typeof e=="string"?e:e.source,n={replace:(a,s)=>{let i=typeof s=="string"?s:s.source;return i=i.replace(Rs.caret,"$1"),r=r.replace(a,i),n},getRegex:()=>new RegExp(r,t)};return n}var vKe=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Rs={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},bKe=/^(?:[ \t]*(?:\n|$))+/,yKe=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,xKe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,c1=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,wKe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,uB=/(?:[*+-]|\d{1,9}[.)])/,dhe=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,fhe=zr(dhe).replace(/bull/g,uB).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),SKe=zr(dhe).replace(/bull/g,uB).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),dB=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,kKe=/^[^\n]+/,fB=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,_Ke=zr(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",fB).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),NKe=zr(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,uB).getRegex(),u2="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",hB=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,CKe=zr("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",hB).replace("tag",u2).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),hhe=zr(dB).replace("hr",c1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",u2).getRegex(),jKe=zr(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",hhe).getRegex(),mB={blockquote:jKe,code:yKe,def:_Ke,fences:xKe,heading:wKe,hr:c1,html:CKe,lheading:fhe,list:NKe,newline:bKe,paragraph:hhe,table:Vb,text:kKe},lZ=zr("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",c1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",u2).getRegex(),EKe={...mB,lheading:SKe,table:lZ,paragraph:zr(dB).replace("hr",c1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",lZ).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",u2).getRegex()},MKe={...mB,html:zr(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",hB).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Vb,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:zr(dB).replace("hr",c1).replace("heading",` *#{1,6} *[^
]`).replace("lheading",fhe).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},TKe=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,AKe=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,mhe=/^( {2,}|\\)\n(?!\s*$)/,DKe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,d2=/[\p{P}\p{S}]/u,pB=/[\s\p{P}\p{S}]/u,phe=/[^\s\p{P}\p{S}]/u,LKe=zr(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,pB).getRegex(),ghe=/(?!~)[\p{P}\p{S}]/u,OKe=/(?!~)[\s\p{P}\p{S}]/u,IKe=/(?:[^\s\p{P}\p{S}]|~)/u,RKe=zr(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",vKe?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),vhe=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,PKe=zr(vhe,"u").replace(/punct/g,d2).getRegex(),zKe=zr(vhe,"u").replace(/punct/g,ghe).getRegex(),bhe="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",BKe=zr(bhe,"gu").replace(/notPunctSpace/g,phe).replace(/punctSpace/g,pB).replace(/punct/g,d2).getRegex(),$Ke=zr(bhe,"gu").replace(/notPunctSpace/g,IKe).replace(/punctSpace/g,OKe).replace(/punct/g,ghe).getRegex(),FKe=zr("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,phe).replace(/punctSpace/g,pB).replace(/punct/g,d2).getRegex(),UKe=zr(/\\(punct)/,"gu").replace(/punct/g,d2).getRegex(),HKe=zr(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),qKe=zr(hB).replace("(?:-->|$)","-->").getRegex(),WKe=zr("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",qKe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),tC=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,KKe=zr(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",tC).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),yhe=zr(/^!?\[(label)\]\[(ref)\]/).replace("label",tC).replace("ref",fB).getRegex(),xhe=zr(/^!?\[(ref)\](?:\[\])?/).replace("ref",fB).getRegex(),GKe=zr("reflink|nolink(?!\\()","g").replace("reflink",yhe).replace("nolink",xhe).getRegex(),cZ=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,gB={_backpedal:Vb,anyPunctuation:UKe,autolink:HKe,blockSkip:RKe,br:mhe,code:AKe,del:Vb,emStrongLDelim:PKe,emStrongRDelimAst:BKe,emStrongRDelimUnd:FKe,escape:TKe,link:KKe,nolink:xhe,punctuation:LKe,reflink:yhe,reflinkSearch:GKe,tag:WKe,text:DKe,url:Vb},VKe={...gB,link:zr(/^!?\[(label)\]\((.*?)\)/).replace("label",tC).getRegex(),reflink:zr(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",tC).getRegex()},XR={...gB,emStrongRDelimAst:$Ke,emStrongLDelim:zKe,url:zr(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",cZ).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:zr(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",cZ).getRegex()},YKe={...XR,br:zr(mhe).replace("{2,}","*").getRegex(),text:zr(XR.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},MS={normal:mB,gfm:EKe,pedantic:MKe},Av={normal:gB,gfm:XR,breaks:YKe,pedantic:VKe},QKe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},uZ=e=>QKe[e];function Oc(e,t){if(t){if(Rs.escapeTest.test(e))return e.replace(Rs.escapeReplace,uZ)}else if(Rs.escapeTestNoEncode.test(e))return e.replace(Rs.escapeReplaceNoEncode,uZ);return e}function dZ(e){try{e=encodeURI(e).replace(Rs.percentDecode,"%")}catch{return null}return e}function fZ(e,t){let r=e.replace(Rs.findPipe,(s,i,l)=>{let c=!1,u=i;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),n=r.split(Rs.splitPipe),a=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;a<n.length;a++)n[a]=n[a].trim().replace(Rs.slashPipe,"|");return n}function Dv(e,t,r){let n=e.length;if(n===0)return"";let a=0;for(;a<n&&e.charAt(n-a-1)===t;)a++;return e.slice(0,n-a)}function JKe(e,t){if(e.indexOf(t[1])===-1)return-1;let r=0;for(let n=0;n<e.length;n++)if(e[n]==="\\")n++;else if(e[n]===t[0])r++;else if(e[n]===t[1]&&(r--,r<0))return n;return r>0?-2:-1}function hZ(e,t,r,n,a){let s=t.href,i=t.title||null,l=e[1].replace(a.other.outputLinkReplace,"$1");n.state.inLink=!0;let c={type:e[0].charAt(0)==="!"?"image":"link",raw:r,href:s,title:i,text:l,tokens:n.inlineTokens(l)};return n.state.inLink=!1,c}function ZKe(e,t,r){let n=e.match(r.other.indentCodeCompensation);if(n===null)return t;let a=n[1];return t.split(`
`).map(s=>{let i=s.match(r.other.beginningSpace);if(i===null)return s;let[l]=i;return l.length>=a.length?s.slice(a.length):s}).join(`
`)}var rC=class{constructor(e){_t(this,"options");_t(this,"rules");_t(this,"lexer");this.options=e||tm}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let r=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?r:Dv(r,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let r=t[0],n=ZKe(r,t[3]||"",this.rules);return{type:"code",raw:r,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let r=t[2].trim();if(this.rules.other.endingHash.test(r)){let n=Dv(r,"#");(this.options.pedantic||!n||this.rules.other.endingSpaceChar.test(n))&&(r=n.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:r,tokens:this.lexer.inline(r)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Dv(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let r=Dv(t[0],`
`).split(`
`),n="",a="",s=[];for(;r.length>0;){let i=!1,l=[],c;for(c=0;c<r.length;c++)if(this.rules.other.blockquoteStart.test(r[c]))l.push(r[c]),i=!0;else if(!i)l.push(r[c]);else break;r=r.slice(c);let u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}
${u}`:u,a=a?`${a}
${d}`:d;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,s,!0),this.lexer.state.top=f,r.length===0)break;let m=s.at(-1);if(m?.type==="code")break;if(m?.type==="blockquote"){let p=m,v=p.raw+`
`+r.join(`
`),b=this.blockquote(v);s[s.length-1]=b,n=n.substring(0,n.length-p.raw.length)+b.raw,a=a.substring(0,a.length-p.text.length)+b.text;break}else if(m?.type==="list"){let p=m,v=p.raw+`
`+r.join(`
`),b=this.list(v);s[s.length-1]=b,n=n.substring(0,n.length-m.raw.length)+b.raw,a=a.substring(0,a.length-p.raw.length)+b.raw,r=v.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:n,tokens:s,text:a}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim(),n=r.length>1,a={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=n?r:"[*+-]");let s=this.rules.other.listItemRegex(r),i=!1;for(;e;){let c=!1,u="",d="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,b=>" ".repeat(3*b.length)),m=e.split(`
`,1)[0],p=!f.trim(),v=0;if(this.options.pedantic?(v=2,d=f.trimStart()):p?v=t[1].length+1:(v=t[2].search(this.rules.other.nonSpaceChar),v=v>4?1:v,d=f.slice(v),v+=t[1].length),p&&this.rules.other.blankLine.test(m)&&(u+=m+`
`,e=e.substring(m.length+1),c=!0),!c){let b=this.rules.other.nextBulletRegex(v),y=this.rules.other.hrRegex(v),S=this.rules.other.fencesBeginRegex(v),_=this.rules.other.headingBeginRegex(v),N=this.rules.other.htmlBeginRegex(v);for(;e;){let k=e.split(`
`,1)[0],j;if(m=k,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),j=m):j=m.replace(this.rules.other.tabCharGlobal,"    "),S.test(m)||_.test(m)||N.test(m)||b.test(m)||y.test(m))break;if(j.search(this.rules.other.nonSpaceChar)>=v||!m.trim())d+=`
`+j.slice(v);else{if(p||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(f)||_.test(f)||y.test(f))break;d+=`
`+m}!p&&!m.trim()&&(p=!0),u+=k+`
`,e=e.substring(k.length+1),f=j.slice(v)}}a.loose||(i?a.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(i=!0)),a.items.push({type:"list_item",raw:u,task:!!this.options.gfm&&this.rules.other.listIsTask.test(d),loose:!1,text:d,tokens:[]}),a.raw+=u}let l=a.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let c of a.items){if(this.lexer.state.top=!1,c.tokens=this.lexer.blockTokens(c.text,[]),c.task){if(c.text=c.text.replace(this.rules.other.listReplaceTask,""),c.tokens[0]?.type==="text"||c.tokens[0]?.type==="paragraph"){c.tokens[0].raw=c.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),c.tokens[0].text=c.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let d=this.lexer.inlineQueue.length-1;d>=0;d--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[d].src)){this.lexer.inlineQueue[d].src=this.lexer.inlineQueue[d].src.replace(this.rules.other.listReplaceTask,"");break}}let u=this.rules.other.listTaskCheckbox.exec(c.raw);if(u){let d={type:"checkbox",raw:u[0]+" ",checked:u[0]!=="[ ]"};c.checked=d.checked,a.loose?c.tokens[0]&&["paragraph","text"].includes(c.tokens[0].type)&&"tokens"in c.tokens[0]&&c.tokens[0].tokens?(c.tokens[0].raw=d.raw+c.tokens[0].raw,c.tokens[0].text=d.raw+c.tokens[0].text,c.tokens[0].tokens.unshift(d)):c.tokens.unshift({type:"paragraph",raw:d.raw,text:d.raw,tokens:[d]}):c.tokens.unshift(d)}}if(!a.loose){let u=c.tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));a.loose=d}}if(a.loose)for(let c of a.items){c.loose=!0;for(let u of c.tokens)u.type==="text"&&(u.type="paragraph")}return a}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let r=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:r,raw:t[0],href:n,title:a}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let r=fZ(t[1]),n=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),a=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===n.length){for(let i of n)this.rules.other.tableAlignRight.test(i)?s.align.push("right"):this.rules.other.tableAlignCenter.test(i)?s.align.push("center"):this.rules.other.tableAlignLeft.test(i)?s.align.push("left"):s.align.push(null);for(let i=0;i<r.length;i++)s.header.push({text:r[i],tokens:this.lexer.inline(r[i]),header:!0,align:s.align[i]});for(let i of a)s.rows.push(fZ(i,s.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:s.align[c]})));return s}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let r=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:r,tokens:this.lexer.inline(r)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let r=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(r)){if(!this.rules.other.endAngleBracket.test(r))return;let s=Dv(r.slice(0,-1),"\\");if((r.length-s.length)%2===0)return}else{let s=JKe(t[2],"()");if(s===-2)return;if(s>-1){let i=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let n=t[2],a="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(n);s&&(n=s[1],a=s[3])}else a=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(r)?n=n.slice(1):n=n.slice(1,-1)),hZ(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let n=(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," "),a=t[n.toLowerCase()];if(!a){let s=r[0].charAt(0);return{type:"text",raw:s,text:s}}return hZ(r,a,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!(!n||n[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(n[1]||n[2])||!r||this.rules.inline.punctuation.exec(r))){let a=[...n[0]].length-1,s,i,l=a,c=0,u=n[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+a);(n=u.exec(t))!=null;){if(s=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!s)continue;if(i=[...s].length,n[3]||n[4]){l+=i;continue}else if((n[5]||n[6])&&a%3&&!((a+i)%3)){c+=i;continue}if(l-=i,l>0)continue;i=Math.min(i,i+l+c);let d=[...n[0]][0].length,f=e.slice(0,a+n.index+d+i);if(Math.min(a,i)%2){let p=f.slice(1,-1);return{type:"em",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}let m=f.slice(2,-2);return{type:"strong",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let r=t[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(r),a=this.rules.other.startingSpaceChar.test(r)&&this.rules.other.endingSpaceChar.test(r);return n&&a&&(r=r.substring(1,r.length-1)),{type:"codespan",raw:t[0],text:r}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let r,n;return t[2]==="@"?(r=t[1],n="mailto:"+r):(r=t[1],n=r),{type:"link",raw:t[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let r,n;if(t[2]==="@")r=t[0],n="mailto:"+r;else{let a;do a=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(a!==t[0]);r=t[0],t[1]==="www."?n="http://"+t[0]:n=t[0]}return{type:"link",raw:t[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let r=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:r}}}},$o=class eP{constructor(t){_t(this,"tokens");_t(this,"options");_t(this,"state");_t(this,"inlineQueue");_t(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||tm,this.options.tokenizer=this.options.tokenizer||new rC,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Rs,block:MS.normal,inline:Av.normal};this.options.pedantic?(r.block=MS.pedantic,r.inline=Av.pedantic):this.options.gfm&&(r.block=MS.gfm,this.options.breaks?r.inline=Av.breaks:r.inline=Av.gfm),this.tokenizer.rules=r}static get rules(){return{block:MS,inline:Av}}static lex(t,r){return new eP(r).lex(t)}static lexInline(t,r){return new eP(r).inlineTokens(t)}lex(t){t=t.replace(Rs.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let n=this.inlineQueue[r];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,r=[],n=!1){for(this.options.pedantic&&(t=t.replace(Rs.tabCharGlobal,"    ").replace(Rs.spaceLine,""));t;){let a;if(this.options.extensions?.block?.some(i=>(a=i.call({lexer:this},t,r))?(t=t.substring(a.raw.length),r.push(a),!0):!1))continue;if(a=this.tokenizer.space(t)){t=t.substring(a.raw.length);let i=r.at(-1);a.raw.length===1&&i!==void 0?i.raw+=`
`:r.push(a);continue}if(a=this.tokenizer.code(t)){t=t.substring(a.raw.length);let i=r.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.text,this.inlineQueue.at(-1).src=i.text):r.push(a);continue}if(a=this.tokenizer.fences(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.heading(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.hr(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.blockquote(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.list(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.html(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.def(t)){t=t.substring(a.raw.length);let i=r.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title},r.push(a));continue}if(a=this.tokenizer.table(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.lheading(t)){t=t.substring(a.raw.length),r.push(a);continue}let s=t;if(this.options.extensions?.startBlock){let i=1/0,l=t.slice(1),c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(i=Math.min(i,c))}),i<1/0&&i>=0&&(s=t.substring(0,i+1))}if(this.state.top&&(a=this.tokenizer.paragraph(s))){let i=r.at(-1);n&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):r.push(a),n=s.length!==t.length,t=t.substring(a.raw.length);continue}if(a=this.tokenizer.text(t)){t=t.substring(a.raw.length);let i=r.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):r.push(a);continue}if(t){let i="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,r}inline(t,r=[]){return this.inlineQueue.push({src:t,tokens:r}),r}inlineTokens(t,r=[]){let n=t,a=null;if(this.tokens.links){let c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,a.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s;for(;(a=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)s=a[2]?a[2].length:0,n=n.slice(0,a.index+s)+"["+"a".repeat(a[0].length-s-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);n=this.options.hooks?.emStrongMask?.call({lexer:this},n)??n;let i=!1,l="";for(;t;){i||(l=""),i=!1;let c;if(this.options.extensions?.inline?.some(d=>(c=d.call({lexer:this},t,r))?(t=t.substring(c.raw.length),r.push(c),!0):!1))continue;if(c=this.tokenizer.escape(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.tag(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.link(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(c.raw.length);let d=r.at(-1);c.type==="text"&&d?.type==="text"?(d.raw+=c.raw,d.text+=c.text):r.push(c);continue}if(c=this.tokenizer.emStrong(t,n,l)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.codespan(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.br(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.del(t)){t=t.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.autolink(t)){t=t.substring(c.raw.length),r.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(t))){t=t.substring(c.raw.length),r.push(c);continue}let u=t;if(this.options.extensions?.startInline){let d=1/0,f=t.slice(1),m;this.options.extensions.startInline.forEach(p=>{m=p.call({lexer:this},f),typeof m=="number"&&m>=0&&(d=Math.min(d,m))}),d<1/0&&d>=0&&(u=t.substring(0,d+1))}if(c=this.tokenizer.inlineText(u)){t=t.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(l=c.raw.slice(-1)),i=!0;let d=r.at(-1);d?.type==="text"?(d.raw+=c.raw,d.text+=c.text):r.push(c);continue}if(t){let d="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return r}},nC=class{constructor(e){_t(this,"options");_t(this,"parser");this.options=e||tm}space(e){return""}code({text:e,lang:t,escaped:r}){let n=(t||"").match(Rs.notSpaceStart)?.[0],a=e.replace(Rs.endingNewline,"")+`
`;return n?'<pre><code class="language-'+Oc(n)+'">'+(r?a:Oc(a,!0))+`</code></pre>
`:"<pre><code>"+(r?a:Oc(a,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,r=e.start,n="";for(let i=0;i<e.items.length;i++){let l=e.items[i];n+=this.listitem(l)}let a=t?"ol":"ul",s=t&&r!==1?' start="'+r+'"':"";return"<"+a+s+`>
`+n+"</"+a+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let a=0;a<e.header.length;a++)r+=this.tablecell(e.header[a]);t+=this.tablerow({text:r});let n="";for(let a=0;a<e.rows.length;a++){let s=e.rows[a];r="";for(let i=0;i<s.length;i++)r+=this.tablecell(s[i]);n+=this.tablerow({text:r})}return n&&(n=`<tbody>${n}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+n+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Oc(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){let n=this.parser.parseInline(r),a=dZ(e);if(a===null)return n;e=a;let s='<a href="'+e+'"';return t&&(s+=' title="'+Oc(t)+'"'),s+=">"+n+"</a>",s}image({href:e,title:t,text:r,tokens:n}){n&&(r=this.parser.parseInline(n,this.parser.textRenderer));let a=dZ(e);if(a===null)return Oc(r);e=a;let s=`<img src="${e}" alt="${r}"`;return t&&(s+=` title="${Oc(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Oc(e.text)}},vB=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},Fo=class tP{constructor(t){_t(this,"options");_t(this,"renderer");_t(this,"textRenderer");this.options=t||tm,this.options.renderer=this.options.renderer||new nC,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new vB}static parse(t,r){return new tP(r).parse(t)}static parseInline(t,r){return new tP(r).parseInline(t)}parse(t){let r="";for(let n=0;n<t.length;n++){let a=t[n];if(this.options.extensions?.renderers?.[a.type]){let i=a,l=this.options.extensions.renderers[i.type].call({parser:this},i);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){r+=l||"";continue}}let s=a;switch(s.type){case"space":{r+=this.renderer.space(s);break}case"hr":{r+=this.renderer.hr(s);break}case"heading":{r+=this.renderer.heading(s);break}case"code":{r+=this.renderer.code(s);break}case"table":{r+=this.renderer.table(s);break}case"blockquote":{r+=this.renderer.blockquote(s);break}case"list":{r+=this.renderer.list(s);break}case"checkbox":{r+=this.renderer.checkbox(s);break}case"html":{r+=this.renderer.html(s);break}case"def":{r+=this.renderer.def(s);break}case"paragraph":{r+=this.renderer.paragraph(s);break}case"text":{r+=this.renderer.text(s);break}default:{let i='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return r}parseInline(t,r=this.renderer){let n="";for(let a=0;a<t.length;a++){let s=t[a];if(this.options.extensions?.renderers?.[s.type]){let l=this.options.extensions.renderers[s.type].call({parser:this},s);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=l||"";continue}}let i=s;switch(i.type){case"escape":{n+=r.text(i);break}case"html":{n+=r.html(i);break}case"link":{n+=r.link(i);break}case"image":{n+=r.image(i);break}case"checkbox":{n+=r.checkbox(i);break}case"strong":{n+=r.strong(i);break}case"em":{n+=r.em(i);break}case"codespan":{n+=r.codespan(i);break}case"br":{n+=r.br(i);break}case"del":{n+=r.del(i);break}case"text":{n+=r.text(i);break}default:{let l='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}},pk,vb=(pk=class{constructor(t){_t(this,"options");_t(this,"block");this.options=t||tm}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?$o.lex:$o.lexInline}provideParser(){return this.block?Fo.parse:Fo.parseInline}},_t(pk,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),_t(pk,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),pk),XKe=class{constructor(...t){_t(this,"defaults",cB());_t(this,"options",this.setOptions);_t(this,"parse",this.parseMarkdown(!0));_t(this,"parseInline",this.parseMarkdown(!1));_t(this,"Parser",Fo);_t(this,"Renderer",nC);_t(this,"TextRenderer",vB);_t(this,"Lexer",$o);_t(this,"Tokenizer",rC);_t(this,"Hooks",vb);this.use(...t)}walkTokens(t,r){let n=[];for(let a of t)switch(n=n.concat(r.call(this,a)),a.type){case"table":{let s=a;for(let i of s.header)n=n.concat(this.walkTokens(i.tokens,r));for(let i of s.rows)for(let l of i)n=n.concat(this.walkTokens(l.tokens,r));break}case"list":{let s=a;n=n.concat(this.walkTokens(s.items,r));break}default:{let s=a;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(i=>{let l=s[i].flat(1/0);n=n.concat(this.walkTokens(l,r))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,r)))}}return n}use(...t){let r=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let a={...n};if(a.async=this.defaults.async||a.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let i=r.renderers[s.name];i?r.renderers[s.name]=function(...l){let c=s.renderer.apply(this,l);return c===!1&&(c=i.apply(this,l)),c}:r.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=r[s.level];i?i.unshift(s.tokenizer):r[s.level]=[s.tokenizer],s.start&&(s.level==="block"?r.startBlock?r.startBlock.push(s.start):r.startBlock=[s.start]:s.level==="inline"&&(r.startInline?r.startInline.push(s.start):r.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(r.childTokens[s.name]=s.childTokens)}),a.extensions=r),n.renderer){let s=this.defaults.renderer||new nC(this.defaults);for(let i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let l=i,c=n.renderer[l],u=s[l];s[l]=(...d)=>{let f=c.apply(s,d);return f===!1&&(f=u.apply(s,d)),f||""}}a.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new rC(this.defaults);for(let i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let l=i,c=n.tokenizer[l],u=s[l];s[l]=(...d)=>{let f=c.apply(s,d);return f===!1&&(f=u.apply(s,d)),f}}a.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new vb;for(let i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let l=i,c=n.hooks[l],u=s[l];vb.passThroughHooks.has(i)?s[l]=d=>{if(this.defaults.async&&vb.passThroughHooksRespectAsync.has(i))return(async()=>{let m=await c.call(s,d);return u.call(s,m)})();let f=c.call(s,d);return u.call(s,f)}:s[l]=(...d)=>{if(this.defaults.async)return(async()=>{let m=await c.apply(s,d);return m===!1&&(m=await u.apply(s,d)),m})();let f=c.apply(s,d);return f===!1&&(f=u.apply(s,d)),f}}a.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,i=n.walkTokens;a.walkTokens=function(l){let c=[];return c.push(i.call(this,l)),s&&(c=c.concat(s.call(this,l))),c}}this.defaults={...this.defaults,...a}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,r){return $o.lex(t,r??this.defaults)}parser(t,r){return Fo.parse(t,r??this.defaults)}parseMarkdown(t){return(r,n)=>{let a={...n},s={...this.defaults,...a},i=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&a.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=t),s.async)return(async()=>{let l=s.hooks?await s.hooks.preprocess(r):r,c=await(s.hooks?await s.hooks.provideLexer():t?$o.lex:$o.lexInline)(l,s),u=s.hooks?await s.hooks.processAllTokens(c):c;s.walkTokens&&await Promise.all(this.walkTokens(u,s.walkTokens));let d=await(s.hooks?await s.hooks.provideParser():t?Fo.parse:Fo.parseInline)(u,s);return s.hooks?await s.hooks.postprocess(d):d})().catch(i);try{s.hooks&&(r=s.hooks.preprocess(r));let l=(s.hooks?s.hooks.provideLexer():t?$o.lex:$o.lexInline)(r,s);s.hooks&&(l=s.hooks.processAllTokens(l)),s.walkTokens&&this.walkTokens(l,s.walkTokens);let c=(s.hooks?s.hooks.provideParser():t?Fo.parse:Fo.parseInline)(l,s);return s.hooks&&(c=s.hooks.postprocess(c)),c}catch(l){return i(l)}}}onError(t,r){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let a="<p>An error occurred:</p><pre>"+Oc(n.message+"",!0)+"</pre>";return r?Promise.resolve(a):a}if(r)return Promise.reject(n);throw n}}},Ah=new XKe;function Ar(e,t){return Ah.parse(e,t)}Ar.options=Ar.setOptions=function(e){return Ah.setOptions(e),Ar.defaults=Ah.defaults,uhe(Ar.defaults),Ar};Ar.getDefaults=cB;Ar.defaults=tm;Ar.use=function(...e){return Ah.use(...e),Ar.defaults=Ah.defaults,uhe(Ar.defaults),Ar};Ar.walkTokens=function(e,t){return Ah.walkTokens(e,t)};Ar.parseInline=Ah.parseInline;Ar.Parser=Fo;Ar.parser=Fo.parse;Ar.Renderer=nC;Ar.TextRenderer=vB;Ar.Lexer=$o;Ar.lexer=$o.lex;Ar.Tokenizer=rC;Ar.Hooks=vb;Ar.parse=Ar;Ar.options;Ar.setOptions;Ar.use;Ar.walkTokens;Ar.parseInline;Fo.parse;$o.lex;const rm=new sx({headingStyle:"atx",codeBlockStyle:"fenced",bulletListMarker:"-",emDelimiter:"_",strongDelimiter:"**"});rm.addRule("highlight",{filter:"mark",replacement:function(e){return"=="+e+"=="}});rm.addRule("strikethrough",{filter:function(e){return e.nodeName==="S"||e.nodeName==="DEL"},replacement:function(e){return"~~"+e+"~~"}});rm.addRule("taskEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="taskEmbed"},replacement:function(e,t){const r=t.getAttribute("data-task-id");return r?`![[task:${r}]]`:""}});rm.addRule("documentEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="documentEmbed"},replacement:function(e,t){const r=t.getAttribute("data-document-id");return r?`![[doc:${r}]]`:""}});rm.addRule("mention",{filter:function(e){return e.nodeName==="A"&&e.hasAttribute("data-mention-id")},replacement:function(e,t){const r=t.getAttribute("data-mention-name");return r?`@${r}`:""}});rm.addRule("textAlign",{filter:function(e){if(!["P","H1","H2","H3","H4","H5","H6"].includes(e.nodeName))return!1;const t=e.getAttribute("style")||"";return/text-align:\s*(center|right|justify)/i.test(t)},replacement:function(e,t){const n=(t.getAttribute("style")||"").match(/text-align:\s*(center|right|justify)/i);if(!n)return e;const a=n[1].toLowerCase(),s=t.nodeName.toLowerCase();return s.startsWith("h")?`<${s} style="text-align: ${a}">${e}</${s}>

`:`<p style="text-align: ${a}">${e}</p>

`}});Ar.setOptions({gfm:!0,breaks:!0});function eGe(e){if(!e||e==="<p></p>")return"";let t=rm.turndown(e);return t=t.replace(/\n{3,}/g,`

`),t}function tGe(e){if(!e)return"<p></p>";let t=e;return t=t.replace(/!\[\[task:([\w-]+)\]\]/g,'<div data-type="taskEmbed" data-task-id="$1"></div>'),t=t.replace(/!\[\[doc:([\w-]+)\]\]/g,'<div data-type="documentEmbed" data-document-id="$1"></div>'),t=t.replace(/==([^=]+)==/g,"<mark>$1</mark>"),t=t.replace(/~~([^~]+)~~/g,"<s>$1</s>"),Ar.parse(t,{async:!1})}function rGe(e,t){return e?tGe(e):"<p></p>"}function nGe(e,t){return!e||e==="<p></p>"?"":eGe(e)}const aGe=Vqe(Kqe),sGe=typeof navigator<"u"&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Vu=sGe?"":"Ctrl";function TS({onClick:e,isActive:t=!1,disabled:r=!1,title:n,children:a,testId:s,buttonRef:i}){return o.jsx("button",{ref:i,type:"button",onClick:e,disabled:r,title:n,"data-testid":s,className:`p-1.5 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${t?"bg-gray-200 text-blue-600":"text-gray-500"}`,children:a})}function iGe(){return o.jsx("div",{className:"w-px h-5 bg-gray-200 mx-0.5"})}const whe=w.forwardRef(function({content:t,onChange:r,onSubmit:n,placeholder:a="Message...",disabled:s=!1,maxHeight:i=200,minHeight:l=60,channelName:c,onImagePaste:u,embedCallbacks:d,mentionEntities:f=[]},m){const[p,v]=w.useState(!1),[b,y]=w.useState(!1),[S,_]=w.useState(null),N=w.useRef(null),k=w.useRef(null),j=w.useRef(f);j.current=f;const E=w.useCallback(()=>j.current,[]),T=w.useCallback(()=>t?rGe(t):"<p></p>",[t]),O=w.useCallback(()=>{N.current?_(N.current.getBoundingClientRect()):k.current&&_(k.current.getBoundingClientRect()),v(!0),y(!0)},[]),R=CFe({extensions:[dHe.configure({codeBlock:!1,heading:!1,dropcursor:!1,gapcursor:!1}),qUe,NUe.configure({openOnClick:!1,autolink:!0,linkOnPaste:!0,HTMLAttributes:{class:"message-link",rel:"noopener noreferrer",target:"_blank"}}),mHe.configure({placeholder:c?`Message ${c}...`:a}),NHe.configure({lowlight:aGe}),OWe.configure({embedCallbacks:d}),PWe.configure({fetchElements:zWe()}),BWe,WWe.configure({getEntities:E})],content:T(),editable:!s,onUpdate:({editor:$})=>{const L=$.getHTML(),A=nGe(L);r(A)},editorProps:{attributes:{class:"prose prose-sm max-w-none focus:outline-none min-h-[40px] px-3 py-2","data-testid":"message-input",style:`max-height: ${i-40}px; overflow-y: auto;`},handleKeyDown:($,L)=>{if(L.key==="k"&&(L.metaKey||L.ctrlKey)&&!L.shiftKey)return L.preventDefault(),O(),!0;if(L.key==="Enter"&&!L.shiftKey&&!L.metaKey&&!L.ctrlKey){const A=R?.isActive("bulletList")||R?.isActive("orderedList"),M=R?.isActive("codeBlock"),P=document.querySelector('[data-testid="message-slash-command-menu"]'),I=document.querySelector('[data-testid="hash-autocomplete-menu"]'),B=document.querySelector('[data-testid="mention-autocomplete-menu"]');if(P||I||B)return!1;if(!A&&!M)return L.preventDefault(),n(),!0}return!1},handlePaste:($,L)=>{const A=L.clipboardData?.items;if(!A||!u)return!1;for(const M of A)if(M.type.startsWith("image/")){const P=M.getAsFile();if(P)return L.preventDefault(),u(P),!0}return!1}}});if(w.useImperativeHandle(m,()=>({focus:()=>R?.commands.focus(),clear:()=>{R?.commands.clearContent(),R?.commands.focus()},isEmpty:()=>R?R.getText().trim().length===0:!0})),w.useEffect(()=>{if(R&&!R.isFocused){const $=R.getText().trim();t===""&&$!==""&&R.commands.clearContent()}},[R,t]),w.useEffect(()=>{R&&R.setEditable(!s)},[R,s]),w.useEffect(()=>{R&&c&&R.commands.focus()},[R,c]),!R)return o.jsx("div",{"data-testid":"message-rich-composer-loading",className:"px-3 py-2 text-gray-400 text-sm",children:"Loading editor..."});const H=[{id:"bold",icon:o.jsx(TO,{className:"w-4 h-4"}),title:`Bold (${Vu}B)`,action:()=>R.chain().focus().toggleBold().run(),isActive:R.isActive("bold")},{id:"italic",icon:o.jsx(AO,{className:"w-4 h-4"}),title:`Italic (${Vu}I)`,action:()=>R.chain().focus().toggleItalic().run(),isActive:R.isActive("italic")},{id:"underline",icon:o.jsx(bwe,{className:"w-4 h-4"}),title:`Underline (${Vu}U)`,action:()=>R.chain().focus().toggleUnderline().run(),isActive:R.isActive("underline")},{id:"strike",icon:o.jsx(ywe,{className:"w-4 h-4"}),title:"Strikethrough",action:()=>R.chain().focus().toggleStrike().run(),isActive:R.isActive("strike")},{id:"divider1",type:"divider"},{id:"code",icon:o.jsx(Kp,{className:"w-4 h-4"}),title:`Inline Code (${Vu}E)`,action:()=>R.chain().focus().toggleCode().run(),isActive:R.isActive("code")},{id:"codeBlock",icon:o.jsx(Bi,{className:"w-4 h-4"}),title:"Code Block",action:()=>R.chain().focus().toggleCodeBlock().run(),isActive:R.isActive("codeBlock")},{id:"divider2",type:"divider"},{id:"bulletList",icon:o.jsx(Wp,{className:"w-4 h-4"}),title:"Bullet List",action:()=>R.chain().focus().toggleBulletList().run(),isActive:R.isActive("bulletList")},{id:"orderedList",icon:o.jsx(Wae,{className:"w-4 h-4"}),title:"Numbered List",action:()=>R.chain().focus().toggleOrderedList().run(),isActive:R.isActive("orderedList")},{id:"divider3",type:"divider"},{id:"blockquote",icon:o.jsx(qae,{className:"w-4 h-4"}),title:"Block Quote",action:()=>R.chain().focus().toggleBlockquote().run(),isActive:R.isActive("blockquote")},{id:"divider4",type:"divider"},{id:"link",icon:o.jsx(Ix,{className:"w-4 h-4"}),title:`Link (${Vu}K)`,action:()=>O(),isActive:R.isActive("link"),ref:N}];return o.jsxs("div",{ref:k,"data-testid":"message-rich-composer",className:`border border-gray-300 rounded-lg bg-white transition-all ${s?"opacity-50":""}`,style:{minHeight:`${l}px`},children:[o.jsx("div",{className:"message-rich-editor",style:{maxHeight:`${i-(p?40:0)}px`,overflow:"auto"},children:o.jsx(yFe,{editor:R})}),o.jsxs("div",{className:"flex items-center justify-between border-t border-gray-100 px-2 py-1 bg-gray-50 rounded-b-lg",children:[o.jsx("div",{className:"flex items-center gap-0.5",children:p?o.jsx(o.Fragment,{children:H.map($=>$.type==="divider"?o.jsx(iGe,{},$.id):o.jsx(TS,{onClick:$.action,isActive:$.isActive,disabled:s,title:$.title,testId:`message-toolbar-${$.id}`,buttonRef:$.ref,children:$.icon},$.id))}):o.jsxs(o.Fragment,{children:[o.jsx(TS,{onClick:()=>R.chain().focus().toggleBold().run(),isActive:R.isActive("bold"),disabled:s,title:`Bold (${Vu}B)`,testId:"message-toolbar-bold",children:o.jsx(TO,{className:"w-4 h-4"})}),o.jsx(TS,{onClick:()=>R.chain().focus().toggleItalic().run(),isActive:R.isActive("italic"),disabled:s,title:`Italic (${Vu}I)`,testId:"message-toolbar-italic",children:o.jsx(AO,{className:"w-4 h-4"})}),o.jsx(TS,{onClick:()=>R.chain().focus().toggleCode().run(),isActive:R.isActive("code"),disabled:s,title:`Inline Code (${Vu}E)`,testId:"message-toolbar-code",children:o.jsx(Kp,{className:"w-4 h-4"})})]})}),o.jsx("button",{type:"button",onClick:()=>v(!p),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:p?"Hide formatting options":"Show more formatting options","data-testid":"message-toolbar-toggle",children:p?o.jsx(Yt,{className:"w-4 h-4"}):o.jsx(e0,{className:"w-4 h-4"})})]}),b&&o.jsx(GWe,{editor:R,onClose:()=>y(!1),anchorRect:S})]})});function oGe({isOpen:e,onClose:t,onAttach:r}){const[n,a]=w.useState("upload"),[s,i]=w.useState(!1),[l,c]=w.useState(!1),[u,d]=w.useState(null),[f,m]=w.useState(null),p=w.useRef(null),[v,b]=w.useState([]),[y,S]=w.useState(!1),[_,N]=w.useState(""),[k,j]=w.useState(null),E=w.useCallback(()=>{a("upload"),i(!1),c(!1),d(null),m(null),N(""),j(null)},[]),T=w.useCallback(()=>{E(),t()},[t,E]),O=w.useCallback(async()=>{S(!0),d(null);try{const F=await fetch("/api/uploads");if(!F.ok)throw new Error("Failed to load images");const q=await F.json();b(q.files||[])}catch(F){d(F.message)}finally{S(!1)}},[]);w.useEffect(()=>{e&&n==="library"&&O()},[e,n,O]);const R=w.useMemo(()=>{if(!_.trim())return v;const F=_.toLowerCase();return v.filter(q=>q.filename.toLowerCase().includes(F))},[v,_]),H=async F=>{if(!["image/jpeg","image/png","image/gif","image/webp"].includes(F.type))return d(`Invalid file type: ${F.type}. Allowed: JPEG, PNG, GIF, WebP`),null;if(F.size>10*1024*1024)return d(`File too large: ${(F.size/(1024*1024)).toFixed(2)}MB. Maximum: 10MB`),null;c(!0),d(null);try{const Q=new FormData;Q.append("file",F);const W=await fetch("/api/uploads",{method:"POST",body:Q});if(!W.ok){const J=await W.json().catch(()=>({}));throw new Error(J.error?.message||`Upload failed: ${W.status}`)}return(await W.json()).url}catch(Q){return d(Q.message),null}finally{c(!1)}},$=w.useCallback(async F=>{if(!["image/jpeg","image/png","image/gif","image/webp"].includes(F.type)){d(`Invalid file type: ${F.type}. Allowed: JPEG, PNG, GIF, WebP`);return}const Q=URL.createObjectURL(F);m({url:Q,file:F}),d(null)},[]),L=w.useCallback(F=>{const q=F.target.files?.[0];q&&$(q)},[$]),A=w.useCallback(F=>{F.preventDefault(),i(!1);const q=F.dataTransfer.files[0];q&&q.type.startsWith("image/")?$(q):d("Please drop an image file")},[$]),M=w.useCallback(F=>{F.preventDefault(),i(!0)},[]),P=w.useCallback(F=>{F.preventDefault(),i(!1)},[]),I=w.useCallback(async()=>{if(n==="library"){if(!k){d("Please select an image");return}r(k.url),T()}else if(f?.file){const F=await H(f.file);F&&(r(F),T())}},[n,f,k,r,T]),B=F=>F<1024?`${F} B`:F<1024*1024?`${(F/1024).toFixed(1)} KB`:`${(F/(1024*1024)).toFixed(2)} MB`;return o.jsx(Mse,{open:e,onOpenChange:F=>!F&&T(),children:o.jsxs(V6,{children:[o.jsx(nj,{className:"fixed inset-0 bg-black/50 z-50"}),o.jsxs(aj,{className:`fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-900 rounded-lg shadow-xl p-6 z-50 ${n==="library"?"w-full max-w-3xl max-h-[80vh] overflow-hidden flex flex-col":"w-full max-w-md"}`,"data-testid":"message-image-attachment-modal",children:[o.jsx(sj,{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Attach Image"}),o.jsxs("div",{className:"flex gap-2 mb-4",children:[o.jsxs("button",{onClick:()=>{a("upload"),d(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="upload"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,"data-testid":"message-image-upload-tab",children:[o.jsx(Kae,{className:"w-4 h-4"}),"Upload"]}),o.jsxs("button",{onClick:()=>{a("library"),d(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${n==="library"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700"}`,"data-testid":"message-image-library-tab",children:[o.jsx(Gae,{className:"w-4 h-4"}),"Library"]})]}),n==="upload"&&o.jsxs("div",{className:"space-y-4",children:[f?o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:f.url,alt:"Preview",className:"w-full h-48 object-contain bg-gray-100 dark:bg-gray-800 rounded-lg","data-testid":"message-image-preview"}),o.jsx("button",{onClick:()=>m(null),className:"absolute top-2 right-2 p-1 bg-white dark:bg-gray-700 rounded-full shadow hover:bg-gray-100 dark:hover:bg-gray-600",title:"Remove","data-testid":"message-image-preview-remove",children:o.jsx(yt,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})})]}):o.jsxs("div",{onClick:()=>p.current?.click(),onDrop:A,onDragOver:M,onDragLeave:P,className:`flex flex-col items-center justify-center h-48 border-2 border-dashed rounded-lg cursor-pointer transition-colors ${s?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,"data-testid":"message-image-drop-zone",children:[o.jsx(iy,{className:"w-12 h-12 text-gray-400 mb-3"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Drop an image here or click to browse"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"JPEG, PNG, GIF, WebP up to 10MB"})]}),o.jsx("input",{ref:p,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:L,className:"hidden","data-testid":"message-image-file-input"})]}),n==="library"&&o.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[o.jsxs("div",{className:"relative mb-4",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:_,onChange:F=>N(F.target.value),placeholder:"Search images...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500","data-testid":"message-library-search-input"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto min-h-[200px] max-h-[300px]",children:y?o.jsx("div",{className:"flex items-center justify-center h-48",children:o.jsx(Pe,{className:"w-8 h-8 animate-spin text-gray-400"})}):R.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-48 text-gray-500 dark:text-gray-400",children:[o.jsx(iy,{className:"w-12 h-12 mb-3 opacity-50"}),v.length===0?o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-sm font-medium",children:"No images uploaded yet"}),o.jsx("p",{className:"text-xs mt-1",children:"Upload images to see them here"})]}):o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-sm font-medium",children:"No images match your search"}),o.jsx("p",{className:"text-xs mt-1",children:"Try a different search term"})]})]}):o.jsx("div",{className:"grid grid-cols-3 gap-3","data-testid":"message-library-image-grid",children:R.map(F=>o.jsxs("div",{className:`relative group rounded-lg overflow-hidden border-2 transition-all cursor-pointer ${k?.filename===F.filename?"border-blue-500 ring-2 ring-blue-500/30":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>j(F),"data-testid":`message-library-image-${F.filename}`,children:[o.jsx("img",{src:F.url,alt:F.filename,className:"w-full h-24 object-cover bg-gray-100 dark:bg-gray-800"}),k?.filename===F.filename&&o.jsx("div",{className:"absolute top-2 left-2 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:o.jsx(Vn,{className:"w-3 h-3 text-white"})}),o.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-2",children:[o.jsx("p",{className:"text-white text-xs truncate",children:F.filename}),o.jsx("p",{className:"text-white/75 text-[10px]",children:B(F.size)})]})]},F.filename))})}),k&&o.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:k.url,alt:k.filename,className:"w-12 h-12 object-cover rounded bg-gray-100 dark:bg-gray-800"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:k.filename}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:B(k.size)})]})]})})]}),u&&o.jsxs("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-600 dark:text-red-400 flex items-center gap-2","data-testid":"message-image-error",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),u]}),o.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[o.jsx("button",{onClick:T,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors","data-testid":"message-image-cancel-button",children:"Cancel"}),o.jsx("button",{onClick:I,disabled:l||n==="upload"&&!f||n==="library"&&!k,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors","data-testid":"message-image-insert-button",children:l?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):"Attach Image"})]}),o.jsx(Y6,{asChild:!0,children:o.jsx("button",{className:"absolute top-4 right-4 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded","aria-label":"Close",children:o.jsx(yt,{className:"w-5 h-5"})})})]})]})})}function lGe(){const e=ft();return kt({mutationFn:async({channelId:t,actor:r})=>{const n=await fetch(`/api/channels/${t}?actor=${encodeURIComponent(r)}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to delete channel")}return n.json()},onSuccess:(t,{channelId:r})=>{e.invalidateQueries({queryKey:["channels"]}),e.invalidateQueries({queryKey:["channels",r]}),e.invalidateQueries({queryKey:["channels",r,"messages"]}),e.invalidateQueries({queryKey:["channels",r,"members"]})}})}const fL={agent:{icon:Vr,text:"text-purple-700",darkText:"dark:text-purple-300"},human:{icon:tn,text:"text-blue-700",darkText:"dark:text-blue-300"},system:{icon:Id,text:"text-gray-700",darkText:"dark:text-gray-300"}};function cGe(e){const t=e?.startsWith("el-");return pt({queryKey:["entities","byRef",e],queryFn:async()=>{if(!e)return null;if(t){const r=await fetch(`/api/entities/${e}`);if(!r.ok){if(r.status===404)return null;throw new Error("Failed to fetch entity")}return r.json()}else{const r=await fetch(`/api/entities?search=${encodeURIComponent(e)}&limit=100`);if(!r.ok)throw new Error("Failed to fetch entity");return(await r.json()).items.find(s=>s.name.toLowerCase()===e.toLowerCase())??null}},enabled:!!e,staleTime:3e4})}function uGe({entityRef:e,children:t,className:r="",showPreview:n=!0,showIcon:a=!1,"data-testid":s}){const{data:i,isLoading:l}=cGe(e),c=t??i?.name??e,u=i&&fL[i.entityType]||fL.system,d=u.icon;return l?o.jsxs("span",{className:`inline-flex items-center gap-1 text-gray-400 ${r}`,children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),e]}):o.jsxs("span",{className:`inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 font-medium ${r}`,"data-testid":s||`entity-link-${e}`,title:i?`${i.name} (${i.entityType})`:e,children:[a&&o.jsx(d,{className:`w-3.5 h-3.5 ${u.text} ${u.darkText}`}),c]})}function dGe(e){return pt({queryKey:["channels",e,"members"],queryFn:async()=>{const t=await fetch(`/api/channels/${e}/members?hydrate=true`);if(!t.ok)throw new Error("Failed to fetch channel members");return t.json()}})}function fGe(){return pt({queryKey:["entities"],queryFn:async()=>{const e=await fetch("/api/entities");if(!e.ok)throw new Error("Failed to fetch entities");const t=await e.json();return t.items||t}})}function hGe(){const e=ft();return kt({mutationFn:async({channelId:t,entityId:r,actor:n})=>{const a=await fetch(`/api/channels/${t}/members`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entityId:r,actor:n})});if(!a.ok){const s=await a.json();throw new Error(s.error?.message||"Failed to add member")}return a.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"members"]}),e.invalidateQueries({queryKey:["channels",r.channelId]}),e.invalidateQueries({queryKey:["channels"]})}})}function mGe(){const e=ft();return kt({mutationFn:async({channelId:t,entityId:r,actor:n})=>{const a=await fetch(`/api/channels/${t}/members/${r}?actor=${encodeURIComponent(n)}`,{method:"DELETE"});if(!a.ok){const s=await a.json();throw new Error(s.error?.message||"Failed to remove member")}return a.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"members"]}),e.invalidateQueries({queryKey:["channels",r.channelId]}),e.invalidateQueries({queryKey:["channels"]})}})}function pGe(){const e=ft();return kt({mutationFn:async({channelId:t,actor:r})=>{const n=await fetch(`/api/channels/${t}/leave`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({actor:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to leave channel")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"members"]}),e.invalidateQueries({queryKey:["channels",r.channelId]}),e.invalidateQueries({queryKey:["channels"]})}})}function gGe({name:e,entityType:t}){const r={human:"bg-blue-100 text-blue-600",agent:"bg-purple-100 text-purple-600",system:"bg-gray-100 text-gray-600"},n=r[t||"system"]||r.system;return o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${n}`,children:o.jsx("span",{className:"text-sm font-medium",children:e.slice(0,2).toUpperCase()})})}function vGe({member:e,isCreator:t,canModify:r,canRemove:n,onRemove:a,isRemoving:s}){const[i,l]=w.useState(!1),c="entityType"in e?e.entityType:void 0,u="notFound"in e&&e.notFound,d=()=>{l(!0)},f=()=>{l(!1),a()};return o.jsxs("div",{"data-testid":`member-${e.id}`,className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-800 group relative transition-colors",children:[o.jsx(gGe,{name:e.name,entityType:c}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[u?o.jsx("span",{className:"text-sm font-medium truncate text-gray-400 dark:text-gray-500 italic",children:e.name}):o.jsx(uGe,{entityRef:e.id,className:"text-sm font-medium truncate","data-testid":`member-link-${e.id}`,children:e.name}),t&&o.jsx("span",{title:"Channel creator",children:o.jsx(zx,{className:"w-4 h-4 text-amber-500 flex-shrink-0"})})]}),c&&!u&&o.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:c}),u&&o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Entity not found"})]}),r&&n&&!i&&o.jsx("button",{onClick:d,disabled:s,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",title:"Remove member","data-testid":`remove-member-${e.id}`,children:s?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(Vae,{className:"w-4 h-4"})}),i&&o.jsxs("div",{className:"flex items-center gap-1","data-testid":`confirm-remove-${e.id}`,children:[o.jsx("button",{onClick:f,disabled:s,className:"px-2 py-1 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded disabled:opacity-50","data-testid":`confirm-remove-yes-${e.id}`,children:s?o.jsx(Pe,{className:"w-3 h-3 animate-spin"}):"Remove"}),o.jsx("button",{onClick:()=>l(!1),className:"px-2 py-1 text-xs font-medium text-gray-600 hover:bg-gray-100 rounded","data-testid":`confirm-remove-cancel-${e.id}`,children:"Cancel"})]})]})}function bGe({channelId:e,currentMembers:t,currentOperator:r,onSuccess:n}){const[a,s]=w.useState(""),{data:i}=fGe(),l=hGe(),c=i?.filter(d=>!t.includes(d.id)),u=async()=>{if(a)try{await l.mutateAsync({channelId:e,entityId:a,actor:r}),s(""),n()}catch{}};return o.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Member"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{value:a,onChange:d=>s(d.target.value),className:"flex-1 min-w-0 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","data-testid":"add-member-select",children:[o.jsx("option",{value:"",children:"Select entity..."}),c?.map(d=>o.jsxs("option",{value:d.id,children:[d.name," (",d.entityType,")"]},d.id))]}),o.jsxs("button",{onClick:u,disabled:!a||l.isPending,className:"px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1","data-testid":"add-member-button",children:[l.isPending?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(Yae,{className:"w-4 h-4"}),"Add"]})]}),l.isError&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[o.jsx(Rt,{className:"w-4 h-4"}),l.error.message]}),c?.length===0&&o.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"No more entities available to add"})]})}function yGe({channel:e,currentOperator:t,onClose:r,onChannelDeleted:n}){const[a,s]=w.useState(null),[i,l]=w.useState(!1),{data:c,isLoading:u,error:d}=dGe(e.id),f=mGe(),m=pGe(),p=lGe(),v=e.channelType==="direct",b=!v&&c?.permissions.modifyMembers.includes(t),y=e.members.includes(t),S=!v&&(e.createdBy===t||b),_=async j=>{s(j);try{await f.mutateAsync({channelId:e.id,entityId:j,actor:t})}catch{}finally{s(null)}},N=async()=>{if(confirm("Are you sure you want to leave this channel?"))try{await m.mutateAsync({channelId:e.id,actor:t}),r()}catch{}},k=async()=>{try{await p.mutateAsync({channelId:e.id,actor:t}),l(!1),r(),n?.()}catch{}};return o.jsxs("div",{"data-testid":"channel-members-panel",className:"fixed inset-y-0 right-0 w-80 bg-white dark:bg-[var(--color-bg-secondary)] shadow-xl border-l border-gray-200 dark:border-[var(--color-border)] flex flex-col z-50 animate-slide-in-right",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ds,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),o.jsx("h3",{className:"font-medium text-gray-900 dark:text-[var(--color-text)]",children:"Members"}),c&&o.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",c.members.length,")"]})]}),o.jsx("button",{onClick:r,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors","data-testid":"close-members-panel",children:o.jsx(yt,{className:"w-5 h-5"})})]}),v&&o.jsx("div",{className:"px-4 py-3 bg-amber-50 border-b border-amber-100",children:o.jsx("p",{className:"text-sm text-amber-800",children:"Direct message channels have fixed membership and cannot be modified."})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:u?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500",children:[o.jsx(Pe,{className:"w-5 h-5 animate-spin mr-2"}),"Loading members..."]}):d?o.jsxs("div",{className:"flex items-center justify-center py-8 text-red-500",children:[o.jsx(Rt,{className:"w-5 h-5 mr-2"}),"Failed to load members"]}):o.jsx("div",{"data-testid":"members-list",children:c?.members.map(j=>o.jsx(vGe,{member:j,isCreator:j.id===e.createdBy,canModify:!!b,canRemove:j.id!==t&&j.id!==e.createdBy,onRemove:()=>_(j.id),isRemoving:a===j.id},j.id))})}),b&&o.jsx(bGe,{channelId:e.id,currentMembers:e.members,currentOperator:t,onSuccess:()=>{}}),!v&&y&&o.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-[var(--color-border)]",children:[o.jsxs("button",{onClick:N,disabled:m.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors disabled:opacity-50","data-testid":"leave-channel-button",children:[m.isPending?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(xwe,{className:"w-4 h-4"}),"Leave Channel"]}),m.isError&&o.jsx("p",{className:"mt-2 text-sm text-red-600 text-center",children:m.error.message})]}),S&&o.jsx("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-[var(--color-border)]",children:o.jsxs("button",{onClick:()=>l(!0),disabled:p.isPending,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors disabled:opacity-50","data-testid":"delete-channel-button",children:[p.isPending?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(pr,{className:"w-4 h-4"}),"Delete Channel"]})}),i&&o.jsxs("div",{className:"fixed inset-0 z-[60]",onClick:()=>l(!1),"data-testid":"delete-channel-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm mx-4",onClick:j=>j.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Channel"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsxs("div",{className:"px-5 py-4",children:[o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-3",children:"All messages and data in this channel will be permanently deleted."}),o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-md border border-[var(--color-border)]",children:[o.jsxs("p",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.name,children:["#",e.name]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono mt-1",children:e.id})]})]}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>l(!1),disabled:p.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"delete-channel-cancel",children:"Cancel"}),o.jsxs("button",{onClick:k,disabled:p.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"delete-channel-confirm",children:[p.isPending&&o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Delete"]})]}),p.isError&&o.jsx("div",{className:"px-5 py-3 border-t border-[var(--color-border)]",children:o.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[o.jsx(Rt,{className:"w-4 h-4"}),p.error.message]})})]})})]})]})}function xGe(){return pt({queryKey:["entities"],queryFn:async()=>{const e=await fetch("/api/entities");if(!e.ok)throw new Error("Failed to fetch entities");const t=await e.json();return t.items||t}})}function wGe(){const e=ft();return kt({mutationFn:async t=>{const r=await fetch("/api/channels",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to create channel")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["channels"]}),e.invalidateQueries({queryKey:["stats"]})}})}function mZ({isOpen:e,onClose:t,onSuccess:r}){const[n,a]=w.useState("group"),[s,i]=w.useState(""),[l,c]=w.useState("private"),[u,d]=w.useState("invite-only"),[f,m]=w.useState([]),[p,v]=w.useState(""),[b,y]=w.useState(""),[S,_]=w.useState([]),N=w.useRef(null),k=wGe(),{data:j}=xGe(),{currentUser:E}=rl();w.useEffect(()=>{e&&N.current&&N.current.focus()},[e]),w.useEffect(()=>{e||(a("group"),i(""),c("private"),d("invite-only"),m([]),v(""),y(""),_([]),k.reset())},[e]);const T=async M=>{if(M.preventDefault(),!E)return;let P;if(n==="group"){if(!s.trim())return;P={channelType:"group",name:s.trim().replace(/\s+/g,"-").toLowerCase(),createdBy:E.id,visibility:l,joinPolicy:u,...f.length>0&&{members:f},...S.length>0&&{tags:S}}}else{if(!p||!b||p===b)return;P={channelType:"direct",createdBy:E.id,entityA:p,entityB:b,...S.length>0&&{tags:S}}}try{const I=await k.mutateAsync(P);r?.(I),t()}catch{}},O=M=>{M.key==="Escape"&&t()},R=M=>{m(P=>P.includes(M)?P.filter(I=>I!==M):[...P,M])},H=s.trim()&&E,L=n==="group"?H:p&&b&&p!==b&&E,A=o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors touch-target","data-testid":"create-channel-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:T,disabled:k.isPending||!L,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"create-channel-submit-button",children:k.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(dr,{className:"w-4 h-4"}),"Create"]})})]});return o.jsx(Ux,{open:e,onClose:t,title:"Create Channel",icon:o.jsx(qp,{className:"w-5 h-5 text-blue-500"}),size:"md","data-testid":"create-channel-modal",footer:A,children:o.jsxs("form",{onSubmit:T,className:"p-4",onKeyDown:O,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Channel Type"}),o.jsxs("div",{className:"flex gap-2","data-testid":"create-channel-type-toggle",children:[o.jsxs("button",{type:"button",onClick:()=>a("group"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg border transition-colors touch-target ${n==="group"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,"data-testid":"create-channel-type-group",children:[o.jsx(qp,{className:"w-4 h-4"}),"Group"]}),o.jsxs("button",{type:"button",onClick:()=>a("direct"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg border transition-colors touch-target ${n==="direct"?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800"}`,"data-testid":"create-channel-type-direct",children:[o.jsx(ds,{className:"w-4 h-4"}),"Direct"]})]})]}),n==="group"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"channel-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:N,id:"channel-name",type:"text",value:s,onChange:M=>i(M.target.value),placeholder:"Enter channel name...",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-name-input",required:!0,maxLength:100}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Alphanumeric, hyphens, underscores only"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"channel-visibility",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Visibility"}),o.jsxs("select",{id:"channel-visibility",value:l,onChange:M=>c(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-visibility-select",children:[o.jsx("option",{value:"private",children:"Private - Only members can see"}),o.jsx("option",{value:"public",children:"Public - Anyone can see"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"channel-join-policy",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Join Policy"}),o.jsxs("select",{id:"channel-join-policy",value:u,onChange:M=>d(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-join-policy-select",children:[o.jsx("option",{value:"invite-only",children:"Invite Only"}),o.jsx("option",{value:"open",children:"Open - Anyone can join"}),o.jsx("option",{value:"request",children:"Request - Approval required"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Members ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsxs("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg max-h-32 overflow-y-auto bg-white dark:bg-gray-800","data-testid":"create-channel-members-list",children:[j?.filter(M=>M.id!==E?.id).map(M=>o.jsxs("label",{className:"flex items-center gap-2 px-3 py-2.5 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer touch-target",children:[o.jsx("input",{type:"checkbox",checked:f.includes(M.id),onChange:()=>R(M.id),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 w-5 h-5"}),o.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[M.name," (",M.entityType,")"]})]},M.id)),(!j||j.length<=1)&&o.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No other entities available"})]}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Creator is automatically added"})]})]}),n==="direct"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"channel-entity-a",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["First Entity ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{id:"channel-entity-a",value:p,onChange:M=>v(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-entity-a-select",required:!0,children:[o.jsx("option",{value:"",children:"Select entity..."}),j?.map(M=>o.jsxs("option",{value:M.id,children:[M.name," (",M.entityType,")"]},M.id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"channel-entity-b",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Second Entity ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{id:"channel-entity-b",value:b,onChange:M=>y(M.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"create-channel-entity-b-select",required:!0,children:[o.jsx("option",{value:"",children:"Select entity..."}),j?.filter(M=>M.id!==p).map(M=>o.jsxs("option",{value:M.id,children:[M.name," (",M.entityType,")"]},M.id))]}),p&&b&&p===b&&o.jsx("p",{className:"mt-1 text-xs text-red-500",children:"Entities must be different"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tags ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsx(ij,{tags:S,onChange:_,placeholder:"Type and press comma to add tags","data-testid":"create-channel-tags-input"})]}),k.isError&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-400","data-testid":"create-channel-error",children:k.error?.message||"Failed to create channel"})]})})}const ix={"nav.activity":{keys:"G A",path:"/activity",description:"Go to Activity",category:"navigation"},"nav.tasks":{keys:"G T",path:"/tasks",description:"Go to Tasks",category:"navigation"},"nav.agents":{keys:"G E",path:"/agents",description:"Go to Agents",category:"navigation"},"nav.workspaces":{keys:"G W",path:"/workspaces",description:"Go to Workspaces",category:"navigation"},"nav.workflows":{keys:"G F",path:"/workflows",description:"Go to Workflows",category:"navigation"},"nav.metrics":{keys:"G M",path:"/metrics",description:"Go to Metrics",category:"navigation"},"nav.settings":{keys:"G S",path:"/settings",description:"Go to Settings",category:"navigation"},"nav.inbox":{keys:"G I",path:"/inbox",description:"Go to Inbox",category:"navigation"},"nav.messages":{keys:"G C",path:"/messages",description:"Go to Messages",category:"navigation"},"nav.documents":{keys:"G D",path:"/documents",description:"Go to Documents",category:"navigation"},"nav.plans":{keys:"G P",path:"/plans",description:"Go to Plans",category:"navigation"},"nav.mergeRequests":{keys:"G R",path:"/merge-requests",description:"Go to Merge Requests",category:"navigation"},"action.commandPalette":{keys:"Cmd+K",description:"Open Command Palette",category:"actions"},"action.toggleSidebar":{keys:"Cmd+B",description:"Toggle Sidebar",category:"actions"},"action.toggleDirector":{keys:"Cmd+D",description:"Toggle Director Panel",category:"actions"},"action.toggleDirectorMaximize":{keys:"Cmd+Shift+D",description:"Maximize/Restore Director Panel",category:"actions"},"action.createTask":{keys:"C T",path:"/tasks?action=create",description:"Create Task",category:"actions"},"action.createBacklogTask":{keys:"C B",path:"/tasks?backlog=true",description:"Create Backlog Task",category:"actions"},"action.createAgent":{keys:"C A",path:"/agents?action=create",description:"Create Agent",category:"actions"},"action.createPlan":{keys:"C P",path:"/plans?action=create",description:"Create Plan",category:"actions"},"action.createDocument":{keys:"C D",path:"/documents?action=create",description:"Create Document",category:"actions"},"action.createWorkflow":{keys:"C W",path:"/workflows?action=create",description:"Create Template",category:"actions"},"action.addPane":{keys:"A P",path:"/workspaces?action=addPane",description:"Add Pane",category:"actions"},"action.refreshActivity":{keys:"R A",description:"Refresh Activity",category:"actions"},"action.quickFileOpen":{keys:"Cmd+P",description:"Quick File Open",category:"actions"}};function zl(e){return s9(e,ix)}function nm(e){return e.replace(/Cmd\+/gi,"").replace(/Ctrl\+/gi,"").replace(/Alt\+/gi,"").replace(/Shift\+/gi,"").replace(/\s+/g," ")}const pZ=[{id:"overview",label:"Overview",defaultExpanded:!0,items:[{to:"/activity",icon:Hh,label:"Activity",testId:"nav-activity",actionId:"nav.activity"},{to:"/inbox",icon:ni,label:"Inbox",testId:"nav-inbox",search:{message:void 0},actionId:"nav.inbox"},{to:"/editor",icon:Bi,label:"Editor",testId:"nav-editor",actionId:"nav.editor"}]},{id:"work",label:"Work",defaultExpanded:!0,items:[{to:"/tasks",icon:Tl,label:"Tasks",testId:"nav-tasks",actionId:"nav.tasks"},{to:"/merge-requests",icon:Ps,label:"Merge Requests",testId:"nav-merge-requests",actionId:"nav.mergeRequests"},{to:"/plans",icon:tu,label:"Plans",testId:"nav-plans",actionId:"nav.plans"},{to:"/workflows",icon:vh,label:"Workflows",testId:"nav-workflows",actionId:"nav.workflows"}]},{id:"orchestration",label:"Orchestration",defaultExpanded:!0,items:[{to:"/agents",icon:ds,label:"Agents",testId:"nav-agents",actionId:"nav.agents"},{to:"/workspaces",icon:bh,label:"Workspaces",testId:"nav-workspaces",actionId:"nav.workspaces"}]},{id:"collaborate",label:"Collaborate",defaultExpanded:!0,items:[{to:"/messages",icon:oi,label:"Messages",testId:"nav-messages",search:{channel:void 0,message:void 0},actionId:"nav.messages"},{to:"/documents",icon:rn,label:"Documents",testId:"nav-documents",search:{selected:void 0,library:void 0},actionId:"nav.documents"}]},{id:"analytics",label:"Analytics",defaultExpanded:!0,items:[{to:"/metrics",icon:QC,label:"Metrics",testId:"nav-metrics",actionId:"nav.metrics"}]}],SGe=[{to:"/settings",icon:Wa,label:"Settings",testId:"nav-settings",actionId:"nav.settings"}];function gZ({collapsed:e=!1,onToggle:t,isMobileDrawer:r=!1}){const a=WC().location.pathname;e1();const[s,i]=w.useState(()=>new Set(pZ.filter(p=>p.defaultExpanded).map(p=>p.id))),l=w.useCallback(p=>{i(v=>{const b=new Set(v);return b.has(p)?b.delete(p):b.add(p),b})},[]),c=p=>a===p||a.startsWith(p+"/"),u=(p,v=!1)=>{const b=c(p.to),y=p.icon;return o.jsxs(I6,{to:p.to,search:p.search,"data-testid":p.testId,className:`
          group relative flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md
          transition-all duration-150 ease-out
          ${v&&!e?"ml-3":""}
          ${b?"bg-[var(--color-sidebar-item-active)] text-[var(--color-sidebar-item-text-active)]":"text-[var(--color-sidebar-item-text)] hover:bg-[var(--color-sidebar-item-hover)] hover:text-[var(--color-text)]"}
          ${e?"justify-center px-2":""}
        `,title:e?p.label:void 0,children:[b&&!e&&o.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-5 bg-[var(--color-primary)] rounded-r-full","data-testid":"active-indicator"}),o.jsx("div",{className:"relative flex-shrink-0",children:o.jsx(y,{className:`w-4 h-4 ${b?"text-[var(--color-sidebar-item-text-active)]":"text-[var(--color-text-tertiary)] group-hover:text-[var(--color-text-secondary)]"}`})}),!e&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"flex-1 truncate",children:p.label}),p.actionId&&o.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)] font-mono tracking-wide opacity-0 group-hover:opacity-100 transition-opacity",children:nm(zl(p.actionId))})]})]},p.to)},d=p=>{const v=s.has(p.id),b=p.items.some(S=>c(S.to)),y=p.icon;return e?o.jsx("div",{className:"space-y-0.5",children:p.items.map(S=>u(S,!1))},p.id):o.jsxs("div",{className:"mb-2","data-testid":`nav-section-${p.id}`,children:[o.jsxs("button",{onClick:()=>l(p.id),className:`
            w-full flex items-center gap-2 px-3 py-1.5 text-xs font-semibold uppercase tracking-wider
            text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]
            transition-colors duration-150 rounded-md hover:bg-[var(--color-sidebar-item-hover)]
            ${b?"text-[var(--color-text-secondary)]":""}
          `,"data-testid":`section-toggle-${p.id}`,children:[y&&o.jsx(y,{className:"w-3.5 h-3.5"}),o.jsx("span",{className:"flex-1 text-left",children:p.label}),o.jsx(Yt,{className:`w-3.5 h-3.5 transition-transform duration-200 ${v?"":"-rotate-90"}`})]}),o.jsx("div",{className:`
            mt-1 space-y-0.5 overflow-hidden transition-all duration-200 ease-out
            ${v?"max-h-96 opacity-100":"max-h-0 opacity-0"}
          `,children:p.items.map(S=>u(S,!0))})]},p.id)},f=e&&!r,m=!e||r;return o.jsxs("aside",{className:`
        flex flex-col bg-[var(--color-sidebar-bg)]
        transition-all duration-200 ease-out
        ${r?"w-full h-full border-none":"border-r border-[var(--color-sidebar-border)]"}
        ${!r&&e?"w-16":r?"":"w-60"}
      `,"data-testid":"sidebar",children:[o.jsxs("div",{className:`flex items-center justify-between h-14 px-4 border-b border-[var(--color-sidebar-border)] ${r?"pr-12":""}`,children:[m&&o.jsxs("div",{className:"flex items-center gap-2.5 ml-1",children:[o.jsx("img",{src:"/logo.png",alt:"",className:"w-7 h-7 object-contain"}),o.jsx("span",{className:"text-xl font-semibold tracking-wide text-[var(--color-text)]",style:{fontFamily:"'Space Grotesk', ui-sans-serif, system-ui, sans-serif"},children:"stoneforge"})]}),f&&o.jsx("img",{src:"/logo.png",alt:"Stoneforge",className:"w-7 h-7 object-contain mx-auto"}),m&&!r&&o.jsx("button",{onClick:t,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-sidebar-item-hover)] transition-colors duration-150","aria-label":"Collapse sidebar","aria-expanded":"true","data-testid":"sidebar-toggle",children:o.jsx(Ul,{className:"w-4 h-4"})})]}),o.jsx("nav",{className:"flex-1 px-2 py-3 overflow-y-auto scrollbar-thin scrollbar-thumb-[var(--color-border)] scrollbar-track-transparent",children:pZ.map(d)}),o.jsx("div",{className:"px-2 py-3 border-t border-[var(--color-sidebar-border)] space-y-0.5",children:SGe.map(p=>u(p,!1))}),f&&!r&&o.jsx("div",{className:"px-2 py-3 border-t border-[var(--color-sidebar-border)]",children:o.jsx(Cn,{content:"Expand sidebar",shortcut:"B",side:"right",children:o.jsx("button",{onClick:t,className:"w-full flex items-center justify-center p-2 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-sidebar-item-hover)] transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:ring-offset-1 focus:ring-offset-[var(--color-sidebar-bg)]","aria-label":"Expand sidebar","aria-expanded":"false","data-testid":"sidebar-expand-button",children:o.jsx(wwe,{className:"w-5 h-5"})})})}),m&&!r&&o.jsxs("div",{className:"px-4 py-2 text-[10px] text-[var(--color-text-muted)] border-t border-[var(--color-sidebar-border)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded bg-[var(--color-surface-hover)] text-[var(--color-text-tertiary)] font-mono",children:"K"})," ","for commands"]})]})}/**
 * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * @license MIT
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 */var She=Object.defineProperty,kGe=Object.getOwnPropertyDescriptor,_Ge=(e,t)=>{for(var r in t)She(e,r,{get:t[r],enumerable:!0})},Zn=(e,t,r,n)=>{for(var a=n>1?void 0:n?kGe(t,r):t,s=e.length-1,i;s>=0;s--)(i=e[s])&&(a=(n?i(t,r,a):i(a))||a);return n&&a&&She(t,r,a),a},mt=(e,t)=>(r,n)=>t(r,n,e),vZ="Terminal input",rP={get:()=>vZ,set:e=>vZ=e},bZ="Too much output to announce, navigate to rows manually to read",nP={get:()=>bZ,set:e=>bZ=e};function NGe(e){return e.replace(/\r?\n/g,"\r")}function CGe(e,t){return t?"\x1B[200~"+e+"\x1B[201~":e}function jGe(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()}function EGe(e,t,r,n){if(e.stopPropagation(),e.clipboardData){let a=e.clipboardData.getData("text/plain");khe(a,t,r,n)}}function khe(e,t,r,n){e=NGe(e),e=CGe(e,r.decPrivateModes.bracketedPasteMode&&n.rawOptions.ignoreBracketedPasteMode!==!0),r.triggerDataEvent(e,!0),t.value=""}function _he(e,t,r){let n=r.getBoundingClientRect(),a=e.clientX-n.left-10,s=e.clientY-n.top-10;t.style.width="20px",t.style.height="20px",t.style.left=`${a}px`,t.style.top=`${s}px`,t.style.zIndex="1000",t.focus()}function yZ(e,t,r,n,a){_he(e,t,r),a&&n.rightClickSelect(e),t.value=n.selectionText,t.select()}function ld(e){return e>65535?(e-=65536,String.fromCharCode((e>>10)+55296)+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)}function f2(e,t=0,r=e.length){let n="";for(let a=t;a<r;++a){let s=e[a];s>65535?(s-=65536,n+=String.fromCharCode((s>>10)+55296)+String.fromCharCode(s%1024+56320)):n+=String.fromCharCode(s)}return n}var MGe=class{constructor(){this._interim=0}clear(){this._interim=0}decode(e,t){let r=e.length;if(!r)return 0;let n=0,a=0;if(this._interim){let s=e.charCodeAt(a++);56320<=s&&s<=57343?t[n++]=(this._interim-55296)*1024+s-56320+65536:(t[n++]=this._interim,t[n++]=s),this._interim=0}for(let s=a;s<r;++s){let i=e.charCodeAt(s);if(55296<=i&&i<=56319){if(++s>=r)return this._interim=i,n;let l=e.charCodeAt(s);56320<=l&&l<=57343?t[n++]=(i-55296)*1024+l-56320+65536:(t[n++]=i,t[n++]=l);continue}i!==65279&&(t[n++]=i)}return n}},TGe=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(e,t){let r=e.length;if(!r)return 0;let n=0,a,s,i,l,c=0,u=0;if(this.interim[0]){let m=!1,p=this.interim[0];p&=(p&224)===192?31:(p&240)===224?15:7;let v=0,b;for(;(b=this.interim[++v]&63)&&v<4;)p<<=6,p|=b;let y=(this.interim[0]&224)===192?2:(this.interim[0]&240)===224?3:4,S=y-v;for(;u<S;){if(u>=r)return 0;if(b=e[u++],(b&192)!==128){u--,m=!0;break}else this.interim[v++]=b,p<<=6,p|=b&63}m||(y===2?p<128?u--:t[n++]=p:y===3?p<2048||p>=55296&&p<=57343||p===65279||(t[n++]=p):p<65536||p>1114111||(t[n++]=p)),this.interim.fill(0)}let d=r-4,f=u;for(;f<r;){for(;f<d&&!((a=e[f])&128)&&!((s=e[f+1])&128)&&!((i=e[f+2])&128)&&!((l=e[f+3])&128);)t[n++]=a,t[n++]=s,t[n++]=i,t[n++]=l,f+=4;if(a=e[f++],a<128)t[n++]=a;else if((a&224)===192){if(f>=r)return this.interim[0]=a,n;if(s=e[f++],(s&192)!==128){f--;continue}if(c=(a&31)<<6|s&63,c<128){f--;continue}t[n++]=c}else if((a&240)===224){if(f>=r)return this.interim[0]=a,n;if(s=e[f++],(s&192)!==128){f--;continue}if(f>=r)return this.interim[0]=a,this.interim[1]=s,n;if(i=e[f++],(i&192)!==128){f--;continue}if(c=(a&15)<<12|(s&63)<<6|i&63,c<2048||c>=55296&&c<=57343||c===65279)continue;t[n++]=c}else if((a&248)===240){if(f>=r)return this.interim[0]=a,n;if(s=e[f++],(s&192)!==128){f--;continue}if(f>=r)return this.interim[0]=a,this.interim[1]=s,n;if(i=e[f++],(i&192)!==128){f--;continue}if(f>=r)return this.interim[0]=a,this.interim[1]=s,this.interim[2]=i,n;if(l=e[f++],(l&192)!==128){f--;continue}if(c=(a&7)<<18|(s&63)<<12|(i&63)<<6|l&63,c<65536||c>1114111)continue;t[n++]=c}}return n}},Nhe="",wd=" ",u1=class Che{constructor(){this.fg=0,this.bg=0,this.extended=new aC}static toColorRGB(t){return[t>>>16&255,t>>>8&255,t&255]}static fromColorRGB(t){return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255}clone(){let t=new Che;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}isInverse(){return this.fg&67108864}isBold(){return this.fg&134217728}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:this.fg&268435456}isBlink(){return this.fg&536870912}isInvisible(){return this.fg&1073741824}isItalic(){return this.bg&67108864}isDim(){return this.bg&134217728}isStrikethrough(){return this.fg&2147483648}isProtected(){return this.bg&536870912}isOverline(){return this.bg&1073741824}getFgColorMode(){return this.fg&50331648}getBgColorMode(){return this.bg&50331648}isFgRGB(){return(this.fg&50331648)===50331648}isBgRGB(){return(this.bg&50331648)===50331648}isFgPalette(){return(this.fg&50331648)===16777216||(this.fg&50331648)===33554432}isBgPalette(){return(this.bg&50331648)===16777216||(this.bg&50331648)===33554432}isFgDefault(){return(this.fg&50331648)===0}isBgDefault(){return(this.bg&50331648)===0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(this.fg&50331648){case 16777216:case 33554432:return this.fg&255;case 50331648:return this.fg&16777215;default:return-1}}getBgColor(){switch(this.bg&50331648){case 16777216:case 33554432:return this.bg&255;case 50331648:return this.bg&16777215;default:return-1}}hasExtendedAttrs(){return this.bg&268435456}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(this.bg&268435456&&~this.extended.underlineColor)switch(this.extended.underlineColor&50331648){case 16777216:case 33554432:return this.extended.underlineColor&255;case 50331648:return this.extended.underlineColor&16777215;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return this.bg&268435456&&~this.extended.underlineColor?this.extended.underlineColor&50331648:this.getFgColorMode()}isUnderlineColorRGB(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===50331648:this.isFgRGB()}isUnderlineColorPalette(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===16777216||(this.extended.underlineColor&50331648)===33554432:this.isFgPalette()}isUnderlineColorDefault(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===0:this.isFgDefault()}getUnderlineStyle(){return this.fg&268435456?this.bg&268435456?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}},aC=class jhe{constructor(t=0,r=0){this._ext=0,this._urlId=0,this._ext=t,this._urlId=r}get ext(){return this._urlId?this._ext&-469762049|this.underlineStyle<<26:this._ext}set ext(t){this._ext=t}get underlineStyle(){return this._urlId?5:(this._ext&469762048)>>26}set underlineStyle(t){this._ext&=-469762049,this._ext|=t<<26&469762048}get underlineColor(){return this._ext&67108863}set underlineColor(t){this._ext&=-67108864,this._ext|=t&67108863}get urlId(){return this._urlId}set urlId(t){this._urlId=t}get underlineVariantOffset(){let t=(this._ext&3758096384)>>29;return t<0?t^4294967288:t}set underlineVariantOffset(t){this._ext&=536870911,this._ext|=t<<29&3758096384}clone(){return new jhe(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}},So=class Ehe extends u1{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new aC,this.combinedData=""}static fromCharData(t){let r=new Ehe;return r.setFromCharData(t),r}isCombined(){return this.content&2097152}getWidth(){return this.content>>22}getChars(){return this.content&2097152?this.combinedData:this.content&2097151?ld(this.content&2097151):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):this.content&2097151}setFromCharData(t){this.fg=t[0],this.bg=0;let r=!1;if(t[1].length>2)r=!0;else if(t[1].length===2){let n=t[1].charCodeAt(0);if(55296<=n&&n<=56319){let a=t[1].charCodeAt(1);56320<=a&&a<=57343?this.content=(n-55296)*1024+a-56320+65536|t[2]<<22:r=!0}else r=!0}else this.content=t[1].charCodeAt(0)|t[2]<<22;r&&(this.combinedData=t[1],this.content=2097152|t[2]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},xZ="di$target",aP="di$dependencies",hL=new Map;function AGe(e){return e[aP]||[]}function Ga(e){if(hL.has(e))return hL.get(e);let t=function(r,n,a){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");DGe(t,r,a)};return t._id=e,hL.set(e,t),t}function DGe(e,t,r){t[xZ]===t?t[aP].push({id:e,index:r}):(t[aP]=[{id:e,index:r}],t[xZ]=t)}var Us=Ga("BufferService"),Mhe=Ga("CoreMouseService"),am=Ga("CoreService"),LGe=Ga("CharsetService"),bB=Ga("InstantiationService"),The=Ga("LogService"),Hs=Ga("OptionsService"),Ahe=Ga("OscLinkService"),OGe=Ga("UnicodeService"),d1=Ga("DecorationService"),sP=class{constructor(t,r,n){this._bufferService=t,this._optionsService=r,this._oscLinkService=n}provideLinks(t,r){let n=this._bufferService.buffer.lines.get(t-1);if(!n){r(void 0);return}let a=[],s=this._optionsService.rawOptions.linkHandler,i=new So,l=n.getTrimmedLength(),c=-1,u=-1,d=!1;for(let f=0;f<l;f++)if(!(u===-1&&!n.hasContent(f))){if(n.loadCell(f,i),i.hasExtendedAttrs()&&i.extended.urlId)if(u===-1){u=f,c=i.extended.urlId;continue}else d=i.extended.urlId!==c;else u!==-1&&(d=!0);if(d||u!==-1&&f===l-1){let m=this._oscLinkService.getLinkData(c)?.uri;if(m){let p={start:{x:u+1,y:t},end:{x:f+(!d&&f===l-1?1:0),y:t}},v=!1;if(!s?.allowNonHttpProtocols)try{let b=new URL(m);["http:","https:"].includes(b.protocol)||(v=!0)}catch{v=!0}v||a.push({text:m,range:p,activate:(b,y)=>s?s.activate(b,y,p):IGe(b,y),hover:(b,y)=>s?.hover?.(b,y,p),leave:(b,y)=>s?.leave?.(b,y,p)})}d=!1,i.hasExtendedAttrs()&&i.extended.urlId?(u=f,c=i.extended.urlId):(u=-1,c=-1)}}r(a)}};sP=Zn([mt(0,Us),mt(1,Hs),mt(2,Ahe)],sP);function IGe(e,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){let r=window.open();if(r){try{r.opener=null}catch{}r.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}var h2=Ga("CharSizeService"),vu=Ga("CoreBrowserService"),yB=Ga("MouseService"),bu=Ga("RenderService"),RGe=Ga("SelectionService"),Dhe=Ga("CharacterJoinerService"),m0=Ga("ThemeService"),Lhe=Ga("LinkProviderService"),PGe=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?wZ.isErrorNoTelemetry(e)?new wZ(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},zGe=new PGe;function Ck(e){BGe(e)||zGe.onUnexpectedError(e)}var iP="Canceled";function BGe(e){return e instanceof $Ge?!0:e instanceof Error&&e.name===iP&&e.message===iP}var $Ge=class extends Error{constructor(){super(iP),this.name=this.message}};function FGe(e){return new Error(`Illegal argument: ${e}`)}var wZ=class oP extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof oP)return t;let r=new oP;return r.message=t.message,r.stack=t.stack,r}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},lP=class Ohe extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,Ohe.prototype)}};function gi(e,t=0){return e[e.length-(1+t)]}var UGe;(e=>{function t(s){return s<0}e.isLessThan=t;function r(s){return s<=0}e.isLessThanOrEqual=r;function n(s){return s>0}e.isGreaterThan=n;function a(s){return s===0}e.isNeitherLessOrGreaterThan=a,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(UGe||(UGe={}));function HGe(e,t){let r=this,n=!1,a;return function(){return n||(n=!0,t||(a=e.apply(r,arguments))),a}}var Ihe;(e=>{function t(k){return k&&typeof k=="object"&&typeof k[Symbol.iterator]=="function"}e.is=t;let r=Object.freeze([]);function n(){return r}e.empty=n;function*a(k){yield k}e.single=a;function s(k){return t(k)?k:a(k)}e.wrap=s;function i(k){return k||r}e.from=i;function*l(k){for(let j=k.length-1;j>=0;j--)yield k[j]}e.reverse=l;function c(k){return!k||k[Symbol.iterator]().next().done===!0}e.isEmpty=c;function u(k){return k[Symbol.iterator]().next().value}e.first=u;function d(k,j){let E=0;for(let T of k)if(j(T,E++))return!0;return!1}e.some=d;function f(k,j){for(let E of k)if(j(E))return E}e.find=f;function*m(k,j){for(let E of k)j(E)&&(yield E)}e.filter=m;function*p(k,j){let E=0;for(let T of k)yield j(T,E++)}e.map=p;function*v(k,j){let E=0;for(let T of k)yield*j(T,E++)}e.flatMap=v;function*b(...k){for(let j of k)yield*j}e.concat=b;function y(k,j,E){let T=E;for(let O of k)T=j(T,O);return T}e.reduce=y;function*S(k,j,E=k.length){for(j<0&&(j+=k.length),E<0?E+=k.length:E>k.length&&(E=k.length);j<E;j++)yield k[j]}e.slice=S;function _(k,j=Number.POSITIVE_INFINITY){let E=[];if(j===0)return[E,k];let T=k[Symbol.iterator]();for(let O=0;O<j;O++){let R=T.next();if(R.done)return[E,e.empty()];E.push(R.value)}return[E,{[Symbol.iterator](){return T}}]}e.consume=_;async function N(k){let j=[];for await(let E of k)j.push(E);return Promise.resolve(j)}e.asyncToArray=N})(Ihe||(Ihe={}));function Dh(e){if(Ihe.is(e)){let t=[];for(let r of e)if(r)try{r.dispose()}catch(n){t.push(n)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function qGe(...e){return Mn(()=>Dh(e))}function Mn(e){return{dispose:HGe(()=>{e()})}}var Rhe=class Phe{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Dh(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Phe.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(t),t.dispose()}}deleteAndLeak(t){t&&this._toDispose.has(t)&&(this._toDispose.delete(t),void 0)}};Rhe.DISABLE_DISPOSED_WARNING=!1;var Ad=Rhe,gr=class{constructor(){this._store=new Ad,this._store}dispose(){this._store.dispose()}_register(t){if(t===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(t)}};gr.None=Object.freeze({dispose(){}});var Lg=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(t){this._isDisposed||t===this._value||(this._value?.dispose(),this._value=t)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}clearAndLeak(){let t=this._value;return this._value=void 0,t}},Wc=typeof window=="object"?window:globalThis,cP=class uP{constructor(t){this.element=t,this.next=uP.Undefined,this.prev=uP.Undefined}};cP.Undefined=new cP(void 0);var Rn=cP,SZ=class{constructor(){this._first=Rn.Undefined,this._last=Rn.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Rn.Undefined}clear(){let t=this._first;for(;t!==Rn.Undefined;){let r=t.next;t.prev=Rn.Undefined,t.next=Rn.Undefined,t=r}this._first=Rn.Undefined,this._last=Rn.Undefined,this._size=0}unshift(t){return this._insert(t,!1)}push(t){return this._insert(t,!0)}_insert(t,r){let n=new Rn(t);if(this._first===Rn.Undefined)this._first=n,this._last=n;else if(r){let s=this._last;this._last=n,n.prev=s,s.next=n}else{let s=this._first;this._first=n,n.next=s,s.prev=n}this._size+=1;let a=!1;return()=>{a||(a=!0,this._remove(n))}}shift(){if(this._first!==Rn.Undefined){let t=this._first.element;return this._remove(this._first),t}}pop(){if(this._last!==Rn.Undefined){let t=this._last.element;return this._remove(this._last),t}}_remove(t){if(t.prev!==Rn.Undefined&&t.next!==Rn.Undefined){let r=t.prev;r.next=t.next,t.next.prev=r}else t.prev===Rn.Undefined&&t.next===Rn.Undefined?(this._first=Rn.Undefined,this._last=Rn.Undefined):t.next===Rn.Undefined?(this._last=this._last.prev,this._last.next=Rn.Undefined):t.prev===Rn.Undefined&&(this._first=this._first.next,this._first.prev=Rn.Undefined);this._size-=1}*[Symbol.iterator](){let t=this._first;for(;t!==Rn.Undefined;)yield t.element,t=t.next}},WGe=globalThis.performance&&typeof globalThis.performance.now=="function",KGe=class zhe{static create(t){return new zhe(t)}constructor(t){this._now=WGe&&t===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},ls;(e=>{e.None=()=>gr.None;function t(L,A){return f(L,()=>{},0,void 0,!0,void 0,A)}e.defer=t;function r(L){return(A,M=null,P)=>{let I=!1,B;return B=L(F=>{if(!I)return B?B.dispose():I=!0,A.call(M,F)},null,P),I&&B.dispose(),B}}e.once=r;function n(L,A,M){return u((P,I=null,B)=>L(F=>P.call(I,A(F)),null,B),M)}e.map=n;function a(L,A,M){return u((P,I=null,B)=>L(F=>{A(F),P.call(I,F)},null,B),M)}e.forEach=a;function s(L,A,M){return u((P,I=null,B)=>L(F=>A(F)&&P.call(I,F),null,B),M)}e.filter=s;function i(L){return L}e.signal=i;function l(...L){return(A,M=null,P)=>{let I=qGe(...L.map(B=>B(F=>A.call(M,F))));return d(I,P)}}e.any=l;function c(L,A,M,P){let I=M;return n(L,B=>(I=A(I,B),I),P)}e.reduce=c;function u(L,A){let M,P={onWillAddFirstListener(){M=L(I.fire,I)},onDidRemoveLastListener(){M?.dispose()}},I=new rt(P);return A?.add(I),I.event}function d(L,A){return A instanceof Array?A.push(L):A&&A.add(L),L}function f(L,A,M=100,P=!1,I=!1,B,F){let q,Q,W,G=0,J,X={leakWarningThreshold:B,onWillAddFirstListener(){q=L(se=>{G++,Q=A(Q,se),P&&!W&&(V.fire(Q),Q=void 0),J=()=>{let de=Q;Q=void 0,W=void 0,(!P||G>1)&&V.fire(de),G=0},typeof M=="number"?(clearTimeout(W),W=setTimeout(J,M)):W===void 0&&(W=0,queueMicrotask(J))})},onWillRemoveListener(){I&&G>0&&J?.()},onDidRemoveLastListener(){J=void 0,q.dispose()}},V=new rt(X);return F?.add(V),V.event}e.debounce=f;function m(L,A=0,M){return e.debounce(L,(P,I)=>P?(P.push(I),P):[I],A,void 0,!0,void 0,M)}e.accumulate=m;function p(L,A=(P,I)=>P===I,M){let P=!0,I;return s(L,B=>{let F=P||!A(B,I);return P=!1,I=B,F},M)}e.latch=p;function v(L,A,M){return[e.filter(L,A,M),e.filter(L,P=>!A(P),M)]}e.split=v;function b(L,A=!1,M=[],P){let I=M.slice(),B=L(Q=>{I?I.push(Q):q.fire(Q)});P&&P.add(B);let F=()=>{I?.forEach(Q=>q.fire(Q)),I=null},q=new rt({onWillAddFirstListener(){B||(B=L(Q=>q.fire(Q)),P&&P.add(B))},onDidAddFirstListener(){I&&(A?setTimeout(F):F())},onDidRemoveLastListener(){B&&B.dispose(),B=null}});return P&&P.add(q),q.event}e.buffer=b;function y(L,A){return(M,P,I)=>{let B=A(new _);return L(function(F){let q=B.evaluate(F);q!==S&&M.call(P,q)},void 0,I)}}e.chain=y;let S=Symbol("HaltChainable");class _{constructor(){this.steps=[]}map(A){return this.steps.push(A),this}forEach(A){return this.steps.push(M=>(A(M),M)),this}filter(A){return this.steps.push(M=>A(M)?M:S),this}reduce(A,M){let P=M;return this.steps.push(I=>(P=A(P,I),P)),this}latch(A=(M,P)=>M===P){let M=!0,P;return this.steps.push(I=>{let B=M||!A(I,P);return M=!1,P=I,B?I:S}),this}evaluate(A){for(let M of this.steps)if(A=M(A),A===S)break;return A}}function N(L,A,M=P=>P){let P=(...q)=>F.fire(M(...q)),I=()=>L.on(A,P),B=()=>L.removeListener(A,P),F=new rt({onWillAddFirstListener:I,onDidRemoveLastListener:B});return F.event}e.fromNodeEventEmitter=N;function k(L,A,M=P=>P){let P=(...q)=>F.fire(M(...q)),I=()=>L.addEventListener(A,P),B=()=>L.removeEventListener(A,P),F=new rt({onWillAddFirstListener:I,onDidRemoveLastListener:B});return F.event}e.fromDOMEventEmitter=k;function j(L){return new Promise(A=>r(L)(A))}e.toPromise=j;function E(L){let A=new rt;return L.then(M=>{A.fire(M)},()=>{A.fire(void 0)}).finally(()=>{A.dispose()}),A.event}e.fromPromise=E;function T(L,A){return L(M=>A.fire(M))}e.forward=T;function O(L,A,M){return A(M),L(P=>A(P))}e.runAndSubscribe=O;class R{constructor(A,M){this._observable=A,this._counter=0,this._hasChanged=!1;let P={onWillAddFirstListener:()=>{A.addObserver(this)},onDidRemoveLastListener:()=>{A.removeObserver(this)}};this.emitter=new rt(P),M&&M.add(this.emitter)}beginUpdate(A){this._counter++}handlePossibleChange(A){}handleChange(A,M){this._hasChanged=!0}endUpdate(A){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function H(L,A){return new R(L,A).emitter.event}e.fromObservable=H;function $(L){return(A,M,P)=>{let I=0,B=!1,F={beginUpdate(){I++},endUpdate(){I--,I===0&&(L.reportChanges(),B&&(B=!1,A.call(M)))},handlePossibleChange(){},handleChange(){B=!0}};L.addObserver(F),L.reportChanges();let q={dispose(){L.removeObserver(F)}};return P instanceof Ad?P.add(q):Array.isArray(P)&&P.push(q),q}}e.fromObservableLight=$})(ls||(ls={}));var dP=class fP{constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${fP._idPool++}`,fP.all.add(this)}start(t){this._stopWatch=new KGe,this.listenerCount=t}stop(){if(this._stopWatch){let t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}};dP.all=new Set,dP._idPool=0;var GGe=dP,VGe=-1,Bhe=class $he{constructor(t,r,n=($he._idPool++).toString(16).padStart(3,"0")){this._errorHandler=t,this.threshold=r,this.name=n,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(t,r){let n=this.threshold;if(n<=0||r<n)return;this._stacks||(this._stacks=new Map);let a=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,a+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[s,i]=this.getMostFrequentStack(),l=`[${this.name}] potential listener LEAK detected, having ${r} listeners already. MOST frequent listener (${i}):`;console.warn(l),console.warn(s);let c=new JGe(l,s);this._errorHandler(c)}return()=>{let s=this._stacks.get(t.value)||0;this._stacks.set(t.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let t,r=0;for(let[n,a]of this._stacks)(!t||r<a)&&(t=[n,a],r=a);return t}};Bhe._idPool=1;var YGe=Bhe,QGe=class Fhe{constructor(t){this.value=t}static create(){let t=new Error;return new Fhe(t.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},JGe=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},ZGe=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},XGe=0,mL=class{constructor(t){this.value=t,this.id=XGe++}},eVe=2,tVe,rt=class{constructor(t){this._size=0,this._options=t,this._leakageMon=this._options?.leakWarningThreshold?new YGe(t?.onListenerError??Ck,this._options?.leakWarningThreshold??VGe):void 0,this._perfMon=this._options?._profName?new GGe(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??(this._event=(t,r,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let c=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],u=new ZGe(`${l}. HINT: Stack shows most frequent listener (${c[1]}-times)`,c[0]);return(this._options?.onListenerError||Ck)(u),gr.None}if(this._disposed)return gr.None;r&&(t=t.bind(r));let a=new mL(t),s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(a.stack=QGe.create(),s=this._leakageMon.check(a.stack,this._size+1)),this._listeners?this._listeners instanceof mL?(this._deliveryQueue??(this._deliveryQueue=new rVe),this._listeners=[this._listeners,a]):this._listeners.push(a):(this._options?.onWillAddFirstListener?.(this),this._listeners=a,this._options?.onDidAddFirstListener?.(this)),this._size++;let i=Mn(()=>{s?.(),this._removeListener(a)});return n instanceof Ad?n.add(i):Array.isArray(n)&&n.push(i),i}),this._event}_removeListener(t){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let r=this._listeners,n=r.indexOf(t);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[n]=void 0;let a=this._deliveryQueue.current===this;if(this._size*eVe<=r.length){let s=0;for(let i=0;i<r.length;i++)r[i]?r[s++]=r[i]:a&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=s}}_deliver(t,r){if(!t)return;let n=this._options?.onListenerError||Ck;if(!n){t.value(r);return}try{t.value(r)}catch(a){n(a)}}_deliverQueue(t){let r=t.current._listeners;for(;t.i<t.end;)this._deliver(r[t.i++],t.value);t.reset()}fire(t){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof mL)this._deliver(this._listeners,t);else{let r=this._deliveryQueue;r.enqueue(this,t,this._listeners.length),this._deliverQueue(r)}this._perfMon?.stop()}hasListeners(){return this._size>0}},rVe=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,r){this.i=0,this.end=r,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},hP=class{constructor(){this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new rt,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new rt,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}getZoomLevel(t){return this.mapWindowIdToZoomLevel.get(this.getWindowId(t))??0}setZoomLevel(t,r){if(this.getZoomLevel(r)===t)return;let n=this.getWindowId(r);this.mapWindowIdToZoomLevel.set(n,t),this._onDidChangeZoomLevel.fire(n)}getZoomFactor(t){return this.mapWindowIdToZoomFactor.get(this.getWindowId(t))??1}setZoomFactor(t,r){this.mapWindowIdToZoomFactor.set(this.getWindowId(r),t)}setFullscreen(t,r){if(this.isFullscreen(r)===t)return;let n=this.getWindowId(r);this.mapWindowIdToFullScreen.set(n,t),this._onDidChangeFullscreen.fire(n)}isFullscreen(t){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(t))}getWindowId(t){return t.vscodeWindowId}};hP.INSTANCE=new hP;var xB=hP;function nVe(e,t,r){typeof t=="string"&&(t=e.matchMedia(t)),t.addEventListener("change",r)}xB.INSTANCE.onDidChangeZoomLevel;function aVe(e){return xB.INSTANCE.getZoomFactor(e)}xB.INSTANCE.onDidChangeFullscreen;var p0=typeof navigator=="object"?navigator.userAgent:"",mP=p0.indexOf("Firefox")>=0,sVe=p0.indexOf("AppleWebKit")>=0,wB=p0.indexOf("Chrome")>=0,iVe=!wB&&p0.indexOf("Safari")>=0;p0.indexOf("Electron/")>=0;p0.indexOf("Android")>=0;var pL=!1;if(typeof Wc.matchMedia=="function"){let e=Wc.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),t=Wc.matchMedia("(display-mode: fullscreen)");pL=e.matches,nVe(Wc,e,({matches:r})=>{pL&&t.matches||(pL=r)})}var Tp="en",pP=!1,gP=!1,jk=!1,Uhe=!1,AS,Ek=Tp,kZ=Tp,oVe,Ic,uh=globalThis,ki;typeof uh.vscode<"u"&&typeof uh.vscode.process<"u"?ki=uh.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(ki=process);var lVe=typeof ki?.versions?.electron=="string",cVe=lVe&&ki?.type==="renderer";if(typeof ki=="object"){pP=ki.platform==="win32",gP=ki.platform==="darwin",jk=ki.platform==="linux",jk&&ki.env.SNAP&&ki.env.SNAP_REVISION,ki.env.CI||ki.env.BUILD_ARTIFACTSTAGINGDIRECTORY,AS=Tp,Ek=Tp;let e=ki.env.VSCODE_NLS_CONFIG;if(e)try{let t=JSON.parse(e);AS=t.userLocale,kZ=t.osLocale,Ek=t.resolvedLanguage||Tp,oVe=t.languagePack?.translationsConfigFile}catch{}Uhe=!0}else typeof navigator=="object"&&!cVe?(Ic=navigator.userAgent,pP=Ic.indexOf("Windows")>=0,gP=Ic.indexOf("Macintosh")>=0,(Ic.indexOf("Macintosh")>=0||Ic.indexOf("iPad")>=0||Ic.indexOf("iPhone")>=0)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0,jk=Ic.indexOf("Linux")>=0,Ic?.indexOf("Mobi")>=0,Ek=globalThis._VSCODE_NLS_LANGUAGE||Tp,AS=navigator.language.toLowerCase(),kZ=AS):console.error("Unable to resolve platform.");var Hhe=pP,Cl=gP,uVe=jk,_Z=Uhe,Bl=Ic,Yu=Ek,dVe;(e=>{function t(){return Yu}e.value=t;function r(){return Yu.length===2?Yu==="en":Yu.length>=3?Yu[0]==="e"&&Yu[1]==="n"&&Yu[2]==="-":!1}e.isDefaultVariant=r;function n(){return Yu==="en"}e.isDefault=n})(dVe||(dVe={}));var fVe=typeof uh.postMessage=="function"&&!uh.importScripts;(()=>{if(fVe){let e=[];uh.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,a=e.length;n<a;n++){let s=e[n];if(s.id===r.data.vscodeScheduleAsyncWork){e.splice(n,1),s.callback();return}}});let t=0;return r=>{let n=++t;e.push({id:n,callback:r}),uh.postMessage({vscodeScheduleAsyncWork:n},"*")}}return e=>setTimeout(e)})();var hVe=!!(Bl&&Bl.indexOf("Chrome")>=0);Bl&&Bl.indexOf("Firefox")>=0;!hVe&&Bl&&Bl.indexOf("Safari")>=0;Bl&&Bl.indexOf("Edg/")>=0;Bl&&Bl.indexOf("Android")>=0;var tp=typeof navigator=="object"?navigator:{};_Z||document.queryCommandSupported&&document.queryCommandSupported("copy")||tp&&tp.clipboard&&tp.clipboard.writeText,_Z||tp&&tp.clipboard&&tp.clipboard.readText;var SB=class{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},gL=new SB,NZ=new SB,CZ=new SB,mVe=new Array(230),qhe;(e=>{function t(l){return gL.keyCodeToStr(l)}e.toString=t;function r(l){return gL.strToKeyCode(l)}e.fromString=r;function n(l){return NZ.keyCodeToStr(l)}e.toUserSettingsUS=n;function a(l){return CZ.keyCodeToStr(l)}e.toUserSettingsGeneral=a;function s(l){return NZ.strToKeyCode(l)||CZ.strToKeyCode(l)}e.fromUserSettings=s;function i(l){if(l>=98&&l<=113)return null;switch(l){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return gL.keyCodeToStr(l)}e.toElectronAccelerator=i})(qhe||(qhe={}));var pVe=class Whe{constructor(t,r,n,a,s){this.ctrlKey=t,this.shiftKey=r,this.altKey=n,this.metaKey=a,this.keyCode=s}equals(t){return t instanceof Whe&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){let t=this.ctrlKey?"1":"0",r=this.shiftKey?"1":"0",n=this.altKey?"1":"0",a=this.metaKey?"1":"0";return`K${t}${r}${n}${a}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new gVe([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},gVe=class{constructor(e){if(e.length===0)throw FGe("chords");this.chords=e}getHashCode(){let e="";for(let t=0,r=this.chords.length;t<r;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};function vVe(e){if(e.charCode){let r=String.fromCharCode(e.charCode).toUpperCase();return qhe.fromString(r)}let t=e.keyCode;if(t===3)return 7;if(mP)switch(t){case 59:return 85;case 60:if(uVe)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Cl)return 57;break}else if(sVe&&(Cl&&t===93||!Cl&&t===92))return 57;return mVe[t]||0}var bVe=Cl?256:2048,yVe=512,xVe=1024,wVe=Cl?2048:256,jZ=class{constructor(t){this._standardKeyboardEventBrand=!0;let r=t;this.browserEvent=r,this.target=r.target,this.ctrlKey=r.ctrlKey,this.shiftKey=r.shiftKey,this.altKey=r.altKey,this.metaKey=r.metaKey,this.altGraphKey=r.getModifierState?.("AltGraph"),this.keyCode=vVe(r),this.code=r.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(t){return this._asKeybinding===t}_computeKeybinding(){let t=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode);let r=0;return this.ctrlKey&&(r|=bVe),this.altKey&&(r|=yVe),this.shiftKey&&(r|=xVe),this.metaKey&&(r|=wVe),r|=t,r}_computeKeyCodeChord(){let t=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(t=this.keyCode),new pVe(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,t)}},EZ=new WeakMap;function SVe(e){if(!e.parent||e.parent===e)return null;try{let t=e.location,r=e.parent.location;if(t.origin!=="null"&&r.origin!=="null"&&t.origin!==r.origin)return null}catch{return null}return e.parent}var kVe=class{static getSameOriginWindowChain(e){let t=EZ.get(e);if(!t){t=[],EZ.set(e,t);let r=e,n;do n=SVe(r),n?t.push({window:new WeakRef(r),iframeElement:r.frameElement||null}):t.push({window:new WeakRef(r),iframeElement:null}),r=n;while(r)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let r=0,n=0,a=this.getSameOriginWindowChain(e);for(let s of a){let i=s.window.deref();if(r+=i?.scrollY??0,n+=i?.scrollX??0,i===t||!s.iframeElement)break;let l=s.iframeElement.getBoundingClientRect();r+=l.top,n+=l.left}return{top:r,left:n}}},DS=class{constructor(t,r){this.timestamp=Date.now(),this.browserEvent=r,this.leftButton=r.button===0,this.middleButton=r.button===1,this.rightButton=r.button===2,this.buttons=r.buttons,this.target=r.target,this.detail=r.detail||1,r.type==="dblclick"&&(this.detail=2),this.ctrlKey=r.ctrlKey,this.shiftKey=r.shiftKey,this.altKey=r.altKey,this.metaKey=r.metaKey,typeof r.pageX=="number"?(this.posx=r.pageX,this.posy=r.pageY):(this.posx=r.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=r.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let n=kVe.getPositionOfChildWindowRelativeToAncestorWindow(t,r.view);this.posx-=n.left,this.posy-=n.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}},MZ=class{constructor(e,t=0,r=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=r,this.deltaX=t;let n=!1;if(wB){let a=navigator.userAgent.match(/Chrome\/(\d+)/);n=(a?parseInt(a[1]):123)<=122}if(e){let a=e,s=e,i=e.view?.devicePixelRatio||1;if(typeof a.wheelDeltaY<"u")n?this.deltaY=a.wheelDeltaY/(120*i):this.deltaY=a.wheelDeltaY/120;else if(typeof s.VERTICAL_AXIS<"u"&&s.axis===s.VERTICAL_AXIS)this.deltaY=-s.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?mP&&!Cl?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof a.wheelDeltaX<"u")iVe&&Hhe?this.deltaX=-(a.wheelDeltaX/120):n?this.deltaX=a.wheelDeltaX/(120*i):this.deltaX=a.wheelDeltaX/120;else if(typeof s.HORIZONTAL_AXIS<"u"&&s.axis===s.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let l=e;l.deltaMode===l.DOM_DELTA_LINE?mP&&!Cl?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*i):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}},Khe=Object.freeze(function(e,t){let r=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(r)}}}),_Ve;(e=>{function t(r){return r===e.None||r===e.Cancelled||r instanceof NVe?!0:!r||typeof r!="object"?!1:typeof r.isCancellationRequested=="boolean"&&typeof r.onCancellationRequested=="function"}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:ls.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Khe})})(_Ve||(_Ve={}));var NVe=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Khe:(this._emitter||(this._emitter=new rt),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},kB=class{constructor(t,r){this._isDisposed=!1,this._token=-1,typeof t=="function"&&typeof r=="number"&&this.setIfNotSet(t,r)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,r){if(this._isDisposed)throw new lP("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},r)}setIfNotSet(t,r){if(this._isDisposed)throw new lP("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},r))}},CVe=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,r=globalThis){if(this.isDisposed)throw new lP("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let n=r.setInterval(()=>{e()},t);this.disposable=Mn(()=>{r.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},jVe;(e=>{async function t(n){let a,s=await Promise.all(n.map(i=>i.then(l=>l,l=>{a||(a=l)})));if(typeof a<"u")throw a;return s}e.settled=t;function r(n){return new Promise(async(a,s)=>{try{await n(a,s)}catch(i){s(i)}})}e.withAsyncBody=r})(jVe||(jVe={}));var TZ=class oo{static fromArray(t){return new oo(r=>{r.emitMany(t)})}static fromPromise(t){return new oo(async r=>{r.emitMany(await t)})}static fromPromises(t){return new oo(async r=>{await Promise.all(t.map(async n=>r.emitOne(await n)))})}static merge(t){return new oo(async r=>{await Promise.all(t.map(async n=>{for await(let a of n)r.emitOne(a)}))})}constructor(t,r){this._state=0,this._results=[],this._error=null,this._onReturn=r,this._onStateChanged=new rt,queueMicrotask(async()=>{let n={emitOne:a=>this.emitOne(a),emitMany:a=>this.emitMany(a),reject:a=>this.reject(a)};try{await Promise.resolve(t(n)),this.resolve()}catch(a){this.reject(a)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await ls.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,r){return new oo(async n=>{for await(let a of t)n.emitOne(r(a))})}map(t){return oo.map(this,t)}static filter(t,r){return new oo(async n=>{for await(let a of t)r(a)&&n.emitOne(a)})}filter(t){return oo.filter(this,t)}static coalesce(t){return oo.filter(t,r=>!!r)}coalesce(){return oo.coalesce(this)}static async toPromise(t){let r=[];for await(let n of t)r.push(n);return r}toPromise(){return oo.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}};TZ.EMPTY=TZ.fromArray([]);var{getWindow:xl,getWindowId:EVe,onDidRegisterWindow:MVe}=(function(){let e=new Map,t={window:Wc,disposables:new Ad};e.set(Wc.vscodeWindowId,t);let r=new rt,n=new rt,a=new rt;function s(i,l){return(typeof i=="number"?e.get(i):void 0)??(l?t:void 0)}return{onDidRegisterWindow:r.event,onWillUnregisterWindow:a.event,onDidUnregisterWindow:n.event,registerWindow(i){if(e.has(i.vscodeWindowId))return gr.None;let l=new Ad,c={window:i,disposables:l.add(new Ad)};return e.set(i.vscodeWindowId,c),l.add(Mn(()=>{e.delete(i.vscodeWindowId),n.fire(i)})),l.add(Xt(i,Oa.BEFORE_UNLOAD,()=>{a.fire(i)})),r.fire(c),l},getWindows(){return e.values()},getWindowsCount(){return e.size},getWindowId(i){return i.vscodeWindowId},hasWindow(i){return e.has(i)},getWindowById:s,getWindow(i){let l=i;if(l?.ownerDocument?.defaultView)return l.ownerDocument.defaultView.window;let c=i;return c?.view?c.view.window:Wc},getDocument(i){return xl(i).document}}})(),TVe=class{constructor(e,t,r,n){this._node=e,this._type=t,this._handler=r,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function Xt(e,t,r,n){return new TVe(e,t,r,n)}var AZ=function(e,t,r,n){return Xt(e,t,r,n)},_B,AVe=class extends CVe{constructor(e){super(),this.defaultTarget=e&&xl(e)}cancelAndSet(e,t,r){return super.cancelAndSet(e,t,r??this.defaultTarget)}},DZ=class{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Ck(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let e=new Map,t=new Map,r=new Map,n=new Map,a=s=>{r.set(s,!1);let i=e.get(s)??[];for(t.set(s,i),e.set(s,[]),n.set(s,!0);i.length>0;)i.sort(DZ.sort),i.shift().execute();n.set(s,!1)};_B=(s,i,l=0)=>{let c=EVe(s),u=new DZ(i,l),d=e.get(c);return d||(d=[],e.set(c,d)),d.push(u),r.get(c)||(r.set(c,!0),s.requestAnimationFrame(()=>a(c))),u}})();function DVe(e){let t=e.getBoundingClientRect(),r=xl(e);return{left:t.left+r.scrollX,top:t.top+r.scrollY,width:t.width,height:t.height}}var Oa={CLICK:"click",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",BLUR:"blur",INPUT:"input"},LVe=class{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingTop="",this._paddingLeft="",this._paddingBottom="",this._paddingRight="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){let t=Zs(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=Zs(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=Zs(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=Zs(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=Zs(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=Zs(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=Zs(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=Zs(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=Zs(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=Zs(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=Zs(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=Zs(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=Zs(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=Zs(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function Zs(e){return typeof e=="number"?`${e}px`:e}function Yb(e){return new LVe(e)}var Ghe=class{constructor(){this._hooks=new Ad,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let r=this._onStopCallback;this._onStopCallback=null,e&&r&&r(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,r,n,a){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=a;let s=e;try{e.setPointerCapture(t),this._hooks.add(Mn(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{s=xl(e)}this._hooks.add(Xt(s,Oa.POINTER_MOVE,i=>{if(i.buttons!==r){this.stopMonitoring(!0);return}i.preventDefault(),this._pointerMoveCallback(i)})),this._hooks.add(Xt(s,Oa.POINTER_UP,i=>this.stopMonitoring(!0)))}};function OVe(e,t,r){let n=null,a=null;if(typeof r.value=="function"?(n="value",a=r.value,a.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof r.get=="function"&&(n="get",a=r.get),!a)throw new Error("not supported");let s=`$memoize$${t}`;r[n]=function(...i){return this.hasOwnProperty(s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!1,value:a.apply(this,i)}),this[s]}}var hl;(e=>(e.Tap="-xterm-gesturetap",e.Change="-xterm-gesturechange",e.Start="-xterm-gesturestart",e.End="-xterm-gesturesend",e.Contextmenu="-xterm-gesturecontextmenu"))(hl||(hl={}));var bb=class gs extends gr{constructor(){super(),this.dispatched=!1,this.targets=new SZ,this.ignoreTargets=new SZ,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(ls.runAndSubscribe(MVe,({window:t,disposables:r})=>{r.add(Xt(t.document,"touchstart",n=>this.onTouchStart(n),{passive:!1})),r.add(Xt(t.document,"touchend",n=>this.onTouchEnd(t,n))),r.add(Xt(t.document,"touchmove",n=>this.onTouchMove(n),{passive:!1}))},{window:Wc,disposables:this._store}))}static addTarget(t){if(!gs.isTouchDevice())return gr.None;gs.INSTANCE||(gs.INSTANCE=new gs);let r=gs.INSTANCE.targets.push(t);return Mn(r)}static ignoreTarget(t){if(!gs.isTouchDevice())return gr.None;gs.INSTANCE||(gs.INSTANCE=new gs);let r=gs.INSTANCE.ignoreTargets.push(t);return Mn(r)}static isTouchDevice(){return"ontouchstart"in Wc||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(t){let r=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let n=0,a=t.targetTouches.length;n<a;n++){let s=t.targetTouches.item(n);this.activeTouches[s.identifier]={id:s.identifier,initialTarget:s.target,initialTimeStamp:r,initialPageX:s.pageX,initialPageY:s.pageY,rollingTimestamps:[r],rollingPageX:[s.pageX],rollingPageY:[s.pageY]};let i=this.newGestureEvent(hl.Start,s.target);i.pageX=s.pageX,i.pageY=s.pageY,this.dispatchEvent(i)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}onTouchEnd(t,r){let n=Date.now(),a=Object.keys(this.activeTouches).length;for(let s=0,i=r.changedTouches.length;s<i;s++){let l=r.changedTouches.item(s);if(!this.activeTouches.hasOwnProperty(String(l.identifier))){console.warn("move of an UNKNOWN touch",l);continue}let c=this.activeTouches[l.identifier],u=Date.now()-c.initialTimeStamp;if(u<gs.HOLD_DELAY&&Math.abs(c.initialPageX-gi(c.rollingPageX))<30&&Math.abs(c.initialPageY-gi(c.rollingPageY))<30){let d=this.newGestureEvent(hl.Tap,c.initialTarget);d.pageX=gi(c.rollingPageX),d.pageY=gi(c.rollingPageY),this.dispatchEvent(d)}else if(u>=gs.HOLD_DELAY&&Math.abs(c.initialPageX-gi(c.rollingPageX))<30&&Math.abs(c.initialPageY-gi(c.rollingPageY))<30){let d=this.newGestureEvent(hl.Contextmenu,c.initialTarget);d.pageX=gi(c.rollingPageX),d.pageY=gi(c.rollingPageY),this.dispatchEvent(d)}else if(a===1){let d=gi(c.rollingPageX),f=gi(c.rollingPageY),m=gi(c.rollingTimestamps)-c.rollingTimestamps[0],p=d-c.rollingPageX[0],v=f-c.rollingPageY[0],b=[...this.targets].filter(y=>c.initialTarget instanceof Node&&y.contains(c.initialTarget));this.inertia(t,b,n,Math.abs(p)/m,p>0?1:-1,d,Math.abs(v)/m,v>0?1:-1,f)}this.dispatchEvent(this.newGestureEvent(hl.End,c.initialTarget)),delete this.activeTouches[l.identifier]}this.dispatched&&(r.preventDefault(),r.stopPropagation(),this.dispatched=!1)}newGestureEvent(t,r){let n=document.createEvent("CustomEvent");return n.initEvent(t,!1,!0),n.initialTarget=r,n.tapCount=0,n}dispatchEvent(t){if(t.type===hl.Tap){let r=new Date().getTime(),n=0;r-this._lastSetTapCountTime>gs.CLEAR_TAP_COUNT_TIME?n=1:n=2,this._lastSetTapCountTime=r,t.tapCount=n}else(t.type===hl.Change||t.type===hl.Contextmenu)&&(this._lastSetTapCountTime=0);if(t.initialTarget instanceof Node){for(let n of this.ignoreTargets)if(n.contains(t.initialTarget))return;let r=[];for(let n of this.targets)if(n.contains(t.initialTarget)){let a=0,s=t.initialTarget;for(;s&&s!==n;)a++,s=s.parentElement;r.push([a,n])}r.sort((n,a)=>n[0]-a[0]);for(let[n,a]of r)a.dispatchEvent(t),this.dispatched=!0}}inertia(t,r,n,a,s,i,l,c,u){this.handle=_B(t,()=>{let d=Date.now(),f=d-n,m=0,p=0,v=!0;a+=gs.SCROLL_FRICTION*f,l+=gs.SCROLL_FRICTION*f,a>0&&(v=!1,m=s*a*f),l>0&&(v=!1,p=c*l*f);let b=this.newGestureEvent(hl.Change);b.translationX=m,b.translationY=p,r.forEach(y=>y.dispatchEvent(b)),v||this.inertia(t,r,d,a,s,i+m,l,c,u+p)})}onTouchMove(t){let r=Date.now();for(let n=0,a=t.changedTouches.length;n<a;n++){let s=t.changedTouches.item(n);if(!this.activeTouches.hasOwnProperty(String(s.identifier))){console.warn("end of an UNKNOWN touch",s);continue}let i=this.activeTouches[s.identifier],l=this.newGestureEvent(hl.Change,i.initialTarget);l.translationX=s.pageX-gi(i.rollingPageX),l.translationY=s.pageY-gi(i.rollingPageY),l.pageX=s.pageX,l.pageY=s.pageY,this.dispatchEvent(l),i.rollingPageX.length>3&&(i.rollingPageX.shift(),i.rollingPageY.shift(),i.rollingTimestamps.shift()),i.rollingPageX.push(s.pageX),i.rollingPageY.push(s.pageY),i.rollingTimestamps.push(r)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}};bb.SCROLL_FRICTION=-.005,bb.HOLD_DELAY=700,bb.CLEAR_TAP_COUNT_TIME=400,Zn([OVe],bb,"isTouchDevice",1);var IVe=bb,NB=class extends gr{onclick(t,r){this._register(Xt(t,Oa.CLICK,n=>r(new DS(xl(t),n))))}onmousedown(t,r){this._register(Xt(t,Oa.MOUSE_DOWN,n=>r(new DS(xl(t),n))))}onmouseover(t,r){this._register(Xt(t,Oa.MOUSE_OVER,n=>r(new DS(xl(t),n))))}onmouseleave(t,r){this._register(Xt(t,Oa.MOUSE_LEAVE,n=>r(new DS(xl(t),n))))}onkeydown(t,r){this._register(Xt(t,Oa.KEY_DOWN,n=>r(new jZ(n))))}onkeyup(t,r){this._register(Xt(t,Oa.KEY_UP,n=>r(new jZ(n))))}oninput(t,r){this._register(Xt(t,Oa.INPUT,r))}onblur(t,r){this._register(Xt(t,Oa.BLUR,r))}onfocus(t,r){this._register(Xt(t,Oa.FOCUS,r))}onchange(t,r){this._register(Xt(t,Oa.CHANGE,r))}ignoreGesture(t){return IVe.ignoreTarget(t)}},LZ=11,RVe=class extends NB{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.style.position="absolute",this.domNode.style.width=LZ+"px",this.domNode.style.height=LZ+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new Ghe),this._register(AZ(this.bgDomNode,Oa.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(AZ(this.domNode,Oa.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new AVe),this._pointerdownScheduleRepeatTimer=this._register(new kB)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,xl(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}},PVe=class vP{constructor(t,r,n,a,s,i,l){this._forceIntegerValues=t,this._scrollStateBrand=void 0,this._forceIntegerValues&&(r=r|0,n=n|0,a=a|0,s=s|0,i=i|0,l=l|0),this.rawScrollLeft=a,this.rawScrollTop=l,r<0&&(r=0),a+r>n&&(a=n-r),a<0&&(a=0),s<0&&(s=0),l+s>i&&(l=i-s),l<0&&(l=0),this.width=r,this.scrollWidth=n,this.scrollLeft=a,this.height=s,this.scrollHeight=i,this.scrollTop=l}equals(t){return this.rawScrollLeft===t.rawScrollLeft&&this.rawScrollTop===t.rawScrollTop&&this.width===t.width&&this.scrollWidth===t.scrollWidth&&this.scrollLeft===t.scrollLeft&&this.height===t.height&&this.scrollHeight===t.scrollHeight&&this.scrollTop===t.scrollTop}withScrollDimensions(t,r){return new vP(this._forceIntegerValues,typeof t.width<"u"?t.width:this.width,typeof t.scrollWidth<"u"?t.scrollWidth:this.scrollWidth,r?this.rawScrollLeft:this.scrollLeft,typeof t.height<"u"?t.height:this.height,typeof t.scrollHeight<"u"?t.scrollHeight:this.scrollHeight,r?this.rawScrollTop:this.scrollTop)}withScrollPosition(t){return new vP(this._forceIntegerValues,this.width,this.scrollWidth,typeof t.scrollLeft<"u"?t.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof t.scrollTop<"u"?t.scrollTop:this.rawScrollTop)}createScrollEvent(t,r){let n=this.width!==t.width,a=this.scrollWidth!==t.scrollWidth,s=this.scrollLeft!==t.scrollLeft,i=this.height!==t.height,l=this.scrollHeight!==t.scrollHeight,c=this.scrollTop!==t.scrollTop;return{inSmoothScrolling:r,oldWidth:t.width,oldScrollWidth:t.scrollWidth,oldScrollLeft:t.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:t.height,oldScrollHeight:t.scrollHeight,oldScrollTop:t.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:n,scrollWidthChanged:a,scrollLeftChanged:s,heightChanged:i,scrollHeightChanged:l,scrollTopChanged:c}}},zVe=class extends gr{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new rt),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new PVe(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let r=this._state.withScrollDimensions(e,t);this._setState(r,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let r=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===r.scrollLeft&&this._smoothScrolling.to.scrollTop===r.scrollTop)return;let n;t?n=new IZ(this._smoothScrolling.from,r,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,r,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{let r=this._state.withScrollPosition(e);this._smoothScrolling=IZ.start(this._state,r,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let r=this._state;r.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(r,t)))}},OZ=class{constructor(e,t,r){this.scrollLeft=e,this.scrollTop=t,this.isDone=r}};function vL(e,t){let r=t-e;return function(n){return e+r*FVe(n)}}function BVe(e,t,r){return function(n){return n<r?e(n/r):t((n-r)/(1-r))}}var IZ=class bP{constructor(t,r,n,a){this.from=t,this.to=r,this.duration=a,this.startTime=n,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(t,r,n){if(Math.abs(t-r)>2.5*n){let a,s;return t<r?(a=t+.75*n,s=r-.75*n):(a=t-.75*n,s=r+.75*n),BVe(vL(t,a),vL(s,r),.33)}return vL(t,r)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(t){this.to=t.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(t){let r=(t-this.startTime)/this.duration;if(r<1){let n=this.scrollLeft(r),a=this.scrollTop(r);return new OZ(n,a,!1)}return new OZ(this.to.scrollLeft,this.to.scrollTop,!0)}combine(t,r,n){return bP.start(t,r,n)}static start(t,r,n){n=n+10;let a=Date.now()-10;return new bP(t,r,a,n)}};function $Ve(e){return Math.pow(e,3)}function FVe(e){return 1-$Ve(1-e)}var UVe=class extends gr{constructor(e,t,r){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=r,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new kB)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}},HVe=140,Vhe=class extends NB{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new UVe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new Ghe),this._shouldRender=!0,this.domNode=Yb(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(Xt(this.domNode.domNode,Oa.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new RVe(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,r,n){this.slider=Yb(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof r=="number"&&this.slider.setWidth(r),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(Xt(this.slider.domNode,Oa.POINTER_DOWN,a=>{a.button===0&&(a.preventDefault(),this._sliderPointerDown(a))})),this.onclick(this.slider.domNode,a=>{a.leftButton&&a.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,r=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),a=this._sliderPointerPosition(e);r<=a&&a<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,r;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,r=e.offsetY;else{let a=DVe(this.domNode.domNode);t=e.pageX-a.left,r=e.pageY-a.top}let n=this._pointerDownRelativePosition(t,r);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),r=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,a=>{let s=this._sliderOrthogonalPointerPosition(a),i=Math.abs(s-r);if(Hhe&&i>HVe){this._setDesiredScrollPositionNow(n.getScrollPosition());return}let l=this._sliderPointerPosition(a)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(l))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}},Yhe=class yP{constructor(t,r,n,a,s,i){this._scrollbarSize=Math.round(r),this._oppositeScrollbarSize=Math.round(n),this._arrowSize=Math.round(t),this._visibleSize=a,this._scrollSize=s,this._scrollPosition=i,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new yP(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(t){let r=Math.round(t);return this._visibleSize!==r?(this._visibleSize=r,this._refreshComputedValues(),!0):!1}setScrollSize(t){let r=Math.round(t);return this._scrollSize!==r?(this._scrollSize=r,this._refreshComputedValues(),!0):!1}setScrollPosition(t){let r=Math.round(t);return this._scrollPosition!==r?(this._scrollPosition=r,this._refreshComputedValues(),!0):!1}setScrollbarSize(t){this._scrollbarSize=Math.round(t)}setOppositeScrollbarSize(t){this._oppositeScrollbarSize=Math.round(t)}static _computeValues(t,r,n,a,s){let i=Math.max(0,n-t),l=Math.max(0,i-2*r),c=a>0&&a>n;if(!c)return{computedAvailableSize:Math.round(i),computedIsNeeded:c,computedSliderSize:Math.round(l),computedSliderRatio:0,computedSliderPosition:0};let u=Math.round(Math.max(20,Math.floor(n*l/a))),d=(l-u)/(a-n),f=s*d;return{computedAvailableSize:Math.round(i),computedIsNeeded:c,computedSliderSize:Math.round(u),computedSliderRatio:d,computedSliderPosition:Math.round(f)}}_refreshComputedValues(){let t=yP._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=t.computedAvailableSize,this._computedIsNeeded=t.computedIsNeeded,this._computedSliderSize=t.computedSliderSize,this._computedSliderRatio=t.computedSliderRatio,this._computedSliderPosition=t.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(t){if(!this._computedIsNeeded)return 0;let r=t-this._arrowSize-this._computedSliderSize/2;return Math.round(r/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(t){if(!this._computedIsNeeded)return 0;let r=t-this._arrowSize,n=this._scrollPosition;return r<this._computedSliderPosition?n-=this._visibleSize:n+=this._visibleSize,n}getDesiredScrollPositionFromDelta(t){if(!this._computedIsNeeded)return 0;let r=this._computedSliderPosition+t;return Math.round(r/this._computedSliderRatio)}},qVe=class extends Vhe{constructor(e,t,r){let n=e.getScrollDimensions(),a=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:r,scrollbarState:new Yhe(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,a.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}},WVe=class extends Vhe{constructor(e,t,r){let n=e.getScrollDimensions(),a=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:r,scrollbarState:new Yhe(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,a.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}},KVe=500,RZ=50,GVe=class{constructor(e,t,r){this.timestamp=e,this.deltaX=t,this.deltaY=r,this.score=0}},xP=class{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let t=1,r=0,n=1,a=this._rear;do{let s=a===this._front?t:Math.pow(2,-n);if(t-=s,r+=this._memory[a].score*s,a===this._front)break;a=(this._capacity+a-1)%this._capacity,n++}while(!0);return r<=.5}acceptStandardWheelEvent(t){if(wB){let r=xl(t.browserEvent),n=aVe(r);this.accept(Date.now(),t.deltaX*n,t.deltaY*n)}else this.accept(Date.now(),t.deltaX,t.deltaY)}accept(t,r,n){let a=null,s=new GVe(t,r,n);this._front===-1&&this._rear===-1?(this._memory[0]=s,this._front=0,this._rear=0):(a=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=s),s.score=this._computeScore(s,a)}_computeScore(t,r){if(Math.abs(t.deltaX)>0&&Math.abs(t.deltaY)>0)return 1;let n=.5;if((!this._isAlmostInt(t.deltaX)||!this._isAlmostInt(t.deltaY))&&(n+=.25),r){let a=Math.abs(t.deltaX),s=Math.abs(t.deltaY),i=Math.abs(r.deltaX),l=Math.abs(r.deltaY),c=Math.max(Math.min(a,i),1),u=Math.max(Math.min(s,l),1),d=Math.max(a,i),f=Math.max(s,l);d%c===0&&f%u===0&&(n-=.5)}return Math.min(Math.max(n,0),1)}_isAlmostInt(t){return Math.abs(Math.round(t)-t)<.01}};xP.INSTANCE=new xP;var VVe=xP,YVe=class extends NB{constructor(e,t,r){super(),this._onScroll=this._register(new rt),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new rt),this.onWillScroll=this._onWillScroll.event,this._options=JVe(t),this._scrollable=r,this._register(this._scrollable.onScroll(a=>{this._onWillScroll.fire(a),this._onDidScroll(a),this._onScroll.fire(a)}));let n={onMouseWheel:a=>this._onMouseWheel(a),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new WVe(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new qVe(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="xterm-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Yb(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Yb(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Yb(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,a=>this._onMouseOver(a)),this.onmouseleave(this._listenOnDomNode,a=>this._onMouseLeave(a)),this._hideTimeout=this._register(new kB),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=Dh(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Cl&&(this._options.className+=" mac"),this._domNode.className="xterm-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new MZ(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Dh(this._mouseWheelToDispose),e)){let t=r=>{this._onMouseWheel(new MZ(r))};this._mouseWheelToDispose.push(Xt(this._listenOnDomNode,Oa.MOUSE_WHEEL,t,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=VVe.INSTANCE;t.acceptStandardWheelEvent(e);let r=!1;if(e.deltaY||e.deltaX){let a=e.deltaY*this._options.mouseWheelScrollSensitivity,s=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&s+a===0?s=a=0:Math.abs(a)>=Math.abs(s)?s=0:a=0),this._options.flipAxes&&([a,s]=[s,a]);let i=!Cl&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||i)&&!s&&(s=a,a=0),e.browserEvent&&e.browserEvent.altKey&&(s=s*this._options.fastScrollSensitivity,a=a*this._options.fastScrollSensitivity);let l=this._scrollable.getFutureScrollPosition(),c={};if(a){let u=RZ*a,d=l.scrollTop-(u<0?Math.floor(u):Math.ceil(u));this._verticalScrollbar.writeScrollPosition(c,d)}if(s){let u=RZ*s,d=l.scrollLeft-(u<0?Math.floor(u):Math.ceil(u));this._horizontalScrollbar.writeScrollPosition(c,d)}c=this._scrollable.validateScrollPosition(c),(l.scrollLeft!==c.scrollLeft||l.scrollTop!==c.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(c):this._scrollable.setScrollPositionNow(c),r=!0)}let n=r;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,r=e.scrollLeft>0,n=r?" left":"",a=t?" top":"",s=r||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${a}`),this._topLeftShadowDomNode.setClassName(`shadow${s}${a}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),KVe)}},QVe=class extends YVe{constructor(e,t,r){super(e,t,r)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function JVe(e){let t={lazyRender:typeof e.lazyRender<"u"?e.lazyRender:!1,className:typeof e.className<"u"?e.className:"",useShadows:typeof e.useShadows<"u"?e.useShadows:!0,handleMouseWheel:typeof e.handleMouseWheel<"u"?e.handleMouseWheel:!0,flipAxes:typeof e.flipAxes<"u"?e.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof e.consumeMouseWheelIfScrollbarIsNeeded<"u"?e.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof e.alwaysConsumeMouseWheel<"u"?e.alwaysConsumeMouseWheel:!1,scrollYToX:typeof e.scrollYToX<"u"?e.scrollYToX:!1,mouseWheelScrollSensitivity:typeof e.mouseWheelScrollSensitivity<"u"?e.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof e.fastScrollSensitivity<"u"?e.fastScrollSensitivity:5,scrollPredominantAxis:typeof e.scrollPredominantAxis<"u"?e.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof e.mouseWheelSmoothScroll<"u"?e.mouseWheelSmoothScroll:!0,arrowSize:typeof e.arrowSize<"u"?e.arrowSize:11,listenOnDomNode:typeof e.listenOnDomNode<"u"?e.listenOnDomNode:null,horizontal:typeof e.horizontal<"u"?e.horizontal:1,horizontalScrollbarSize:typeof e.horizontalScrollbarSize<"u"?e.horizontalScrollbarSize:10,horizontalSliderSize:typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:0,horizontalHasArrows:typeof e.horizontalHasArrows<"u"?e.horizontalHasArrows:!1,vertical:typeof e.vertical<"u"?e.vertical:1,verticalScrollbarSize:typeof e.verticalScrollbarSize<"u"?e.verticalScrollbarSize:10,verticalHasArrows:typeof e.verticalHasArrows<"u"?e.verticalHasArrows:!1,verticalSliderSize:typeof e.verticalSliderSize<"u"?e.verticalSliderSize:0,scrollByPage:typeof e.scrollByPage<"u"?e.scrollByPage:!1};return t.horizontalSliderSize=typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=typeof e.verticalSliderSize<"u"?e.verticalSliderSize:t.verticalScrollbarSize,Cl&&(t.className+=" mac"),t}var wP=class extends gr{constructor(t,r,n,a,s,i,l,c){super(),this._bufferService=n,this._optionsService=l,this._renderService=c,this._onRequestScrollLines=this._register(new rt),this.onRequestScrollLines=this._onRequestScrollLines.event,this._isSyncing=!1,this._isHandlingScroll=!1,this._suppressOnScrollHandler=!1;let u=this._register(new zVe({forceIntegerValues:!1,smoothScrollDuration:this._optionsService.rawOptions.smoothScrollDuration,scheduleAtNextAnimationFrame:d=>_B(a.window,d)}));this._register(this._optionsService.onSpecificOptionChange("smoothScrollDuration",()=>{u.setSmoothScrollDuration(this._optionsService.rawOptions.smoothScrollDuration)})),this._scrollableElement=this._register(new QVe(r,{vertical:1,horizontal:2,useShadows:!1,mouseWheelSmoothScroll:!0,...this._getChangeOptions()},u)),this._register(this._optionsService.onMultipleOptionChange(["scrollSensitivity","fastScrollSensitivity","overviewRuler"],()=>this._scrollableElement.updateOptions(this._getChangeOptions()))),this._register(s.onProtocolChange(d=>{this._scrollableElement.updateOptions({handleMouseWheel:!(d&16)})})),this._scrollableElement.setScrollDimensions({height:0,scrollHeight:0}),this._register(ls.runAndSubscribe(i.onChangeColors,()=>{this._scrollableElement.getDomNode().style.backgroundColor=i.colors.background.css})),t.appendChild(this._scrollableElement.getDomNode()),this._register(Mn(()=>this._scrollableElement.getDomNode().remove())),this._styleElement=a.mainDocument.createElement("style"),r.appendChild(this._styleElement),this._register(Mn(()=>this._styleElement.remove())),this._register(ls.runAndSubscribe(i.onChangeColors,()=>{this._styleElement.textContent=[".xterm .xterm-scrollable-element > .scrollbar > .slider {",`  background: ${i.colors.scrollbarSliderBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider:hover {",`  background: ${i.colors.scrollbarSliderHoverBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider.active {",`  background: ${i.colors.scrollbarSliderActiveBackground.css};`,"}"].join(`
`)})),this._register(this._bufferService.onResize(()=>this.queueSync())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._latestYDisp=void 0,this.queueSync()})),this._register(this._bufferService.onScroll(()=>this._sync())),this._register(this._scrollableElement.onScroll(d=>this._handleScroll(d)))}scrollLines(t){let r=this._scrollableElement.getScrollPosition();this._scrollableElement.setScrollPosition({reuseAnimation:!0,scrollTop:r.scrollTop+t*this._renderService.dimensions.css.cell.height})}scrollToLine(t,r){r&&(this._latestYDisp=t),this._scrollableElement.setScrollPosition({reuseAnimation:!r,scrollTop:t*this._renderService.dimensions.css.cell.height})}_getChangeOptions(){return{mouseWheelScrollSensitivity:this._optionsService.rawOptions.scrollSensitivity,fastScrollSensitivity:this._optionsService.rawOptions.fastScrollSensitivity,verticalScrollbarSize:this._optionsService.rawOptions.overviewRuler?.width||14}}queueSync(t){t!==void 0&&(this._latestYDisp=t),this._queuedAnimationFrame===void 0&&(this._queuedAnimationFrame=this._renderService.addRefreshCallback(()=>{this._queuedAnimationFrame=void 0,this._sync(this._latestYDisp)}))}_sync(t=this._bufferService.buffer.ydisp){!this._renderService||this._isSyncing||(this._isSyncing=!0,this._suppressOnScrollHandler=!0,this._scrollableElement.setScrollDimensions({height:this._renderService.dimensions.css.canvas.height,scrollHeight:this._renderService.dimensions.css.cell.height*this._bufferService.buffer.lines.length}),this._suppressOnScrollHandler=!1,t!==this._latestYDisp&&this._scrollableElement.setScrollPosition({scrollTop:t*this._renderService.dimensions.css.cell.height}),this._isSyncing=!1)}_handleScroll(t){if(!this._renderService||this._isHandlingScroll||this._suppressOnScrollHandler)return;this._isHandlingScroll=!0;let r=Math.round(t.scrollTop/this._renderService.dimensions.css.cell.height),n=r-this._bufferService.buffer.ydisp;n!==0&&(this._latestYDisp=r,this._onRequestScrollLines.fire(n)),this._isHandlingScroll=!1}};wP=Zn([mt(2,Us),mt(3,vu),mt(4,Mhe),mt(5,m0),mt(6,Hs),mt(7,bu)],wP);var SP=class extends gr{constructor(t,r,n,a,s){super(),this._screenElement=t,this._bufferService=r,this._coreBrowserService=n,this._decorationService=a,this._renderService=s,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this._register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this._register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this._register(this._decorationService.onDecorationRemoved(i=>this._removeDecoration(i))),this._register(Mn(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let t of this._decorationService.decorations)this._renderDecoration(t);this._dimensionsChanged=!1}_renderDecoration(t){this._refreshStyle(t),this._dimensionsChanged&&this._refreshXPosition(t)}_createElement(t){let r=this._coreBrowserService.mainDocument.createElement("div");r.classList.add("xterm-decoration"),r.classList.toggle("xterm-decoration-top-layer",t?.options?.layer==="top"),r.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,r.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,r.style.top=`${(t.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height}px`,r.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let n=t.options.x??0;return n&&n>this._bufferService.cols&&(r.style.display="none"),this._refreshXPosition(t,r),r}_refreshStyle(t){let r=t.marker.line-this._bufferService.buffers.active.ydisp;if(r<0||r>=this._bufferService.rows)t.element&&(t.element.style.display="none",t.onRenderEmitter.fire(t.element));else{let n=this._decorationElements.get(t);n||(n=this._createElement(t),t.element=n,this._decorationElements.set(t,n),this._container.appendChild(n),t.onDispose(()=>{this._decorationElements.delete(t),n.remove()})),n.style.display=this._altBufferIsActive?"none":"block",this._altBufferIsActive||(n.style.width=`${Math.round((t.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,n.style.height=`${(t.options.height||1)*this._renderService.dimensions.css.cell.height}px`,n.style.top=`${r*this._renderService.dimensions.css.cell.height}px`,n.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`),t.onRenderEmitter.fire(n)}}_refreshXPosition(t,r=t.element){if(!r)return;let n=t.options.x??0;(t.options.anchor||"left")==="right"?r.style.right=n?`${n*this._renderService.dimensions.css.cell.width}px`:"":r.style.left=n?`${n*this._renderService.dimensions.css.cell.width}px`:""}_removeDecoration(t){this._decorationElements.get(t)?.remove(),this._decorationElements.delete(t),t.dispose()}};SP=Zn([mt(1,Us),mt(2,vu),mt(3,d1),mt(4,bu)],SP);var ZVe=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(e){if(e.options.overviewRulerOptions){for(let t of this._zones)if(t.color===e.options.overviewRulerOptions.color&&t.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(t,e.marker.line))return;if(this._lineAdjacentToZone(t,e.marker.line,e.options.overviewRulerOptions.position)){this._addLineToZone(t,e.marker.line);return}}if(this._zonePoolIndex<this._zonePool.length){this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,this._zones.push(this._zonePool[this._zonePoolIndex++]);return}this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(e){this._linePadding=e}_lineIntersectsZone(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}_lineAdjacentToZone(e,t,r){return t>=e.startBufferLine-this._linePadding[r||"full"]&&t<=e.endBufferLine+this._linePadding[r||"full"]}_addLineToZone(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}},cl={full:0,left:0,center:0,right:0},Qu={full:0,left:0,center:0,right:0},Lv={full:0,left:0,center:0,right:0},sC=class extends gr{constructor(t,r,n,a,s,i,l,c){super(),this._viewportElement=t,this._screenElement=r,this._bufferService=n,this._decorationService=a,this._renderService=s,this._optionsService=i,this._themeService=l,this._coreBrowserService=c,this._colorZoneStore=new ZVe,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement),this._register(Mn(()=>this._canvas?.remove()));let u=this._canvas.getContext("2d");if(u)this._ctx=u;else throw new Error("Ctx cannot be null");this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this._register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0))),this._register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this._register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})),this._register(this._renderService.onRender(()=>{(!this._containerHeight||this._containerHeight!==this._screenElement.clientHeight)&&(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._register(this._optionsService.onSpecificOptionChange("overviewRuler",()=>this._queueRefresh(!0))),this._register(this._themeService.onChangeColors(()=>this._queueRefresh())),this._queueRefresh(!0)}get _width(){return this._optionsService.options.overviewRuler?.width||0}_refreshDrawConstants(){let t=Math.floor((this._canvas.width-1)/3),r=Math.ceil((this._canvas.width-1)/3);Qu.full=this._canvas.width,Qu.left=t,Qu.center=r,Qu.right=t,this._refreshDrawHeightConstants(),Lv.full=1,Lv.left=1,Lv.center=1+Qu.left,Lv.right=1+Qu.left+Qu.center}_refreshDrawHeightConstants(){cl.full=Math.round(2*this._coreBrowserService.dpr);let t=this._canvas.height/this._bufferService.buffer.lines.length,r=Math.round(Math.max(Math.min(t,12),6)*this._coreBrowserService.dpr);cl.left=r,cl.center=r,cl.right=r}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*cl.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*cl.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*cl.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*cl.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let r of this._decorationService.decorations)this._colorZoneStore.addDecoration(r);this._ctx.lineWidth=1,this._renderRulerOutline();let t=this._colorZoneStore.zones;for(let r of t)r.position!=="full"&&this._renderColorZone(r);for(let r of t)r.position==="full"&&this._renderColorZone(r);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderRulerOutline(){this._ctx.fillStyle=this._themeService.colors.overviewRulerBorder.css,this._ctx.fillRect(0,0,1,this._canvas.height),this._optionsService.rawOptions.overviewRuler.showTopBorder&&this._ctx.fillRect(1,0,this._canvas.width-1,1),this._optionsService.rawOptions.overviewRuler.showBottomBorder&&this._ctx.fillRect(1,this._canvas.height-1,this._canvas.width-1,this._canvas.height)}_renderColorZone(t){this._ctx.fillStyle=t.color,this._ctx.fillRect(Lv[t.position||"full"],Math.round((this._canvas.height-1)*(t.startBufferLine/this._bufferService.buffers.active.lines.length)-cl[t.position||"full"]/2),Qu[t.position||"full"],Math.round((this._canvas.height-1)*((t.endBufferLine-t.startBufferLine)/this._bufferService.buffers.active.lines.length)+cl[t.position||"full"]))}_queueRefresh(t,r){this._shouldUpdateDimensions=t||this._shouldUpdateDimensions,this._shouldUpdateAnchor=r||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};sC=Zn([mt(2,Us),mt(3,d1),mt(4,bu),mt(5,Hs),mt(6,m0),mt(7,vu)],sC);var qe;(e=>(e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="\x07",e.BS="\b",e.HT="	",e.LF=`
`,e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="\x1B",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""))(qe||(qe={}));var Mk;(e=>(e.PAD="",e.HOP="",e.BPH="",e.NBH="",e.IND="",e.NEL="",e.SSA="",e.ESA="",e.HTS="",e.HTJ="",e.VTS="",e.PLD="",e.PLU="",e.RI="",e.SS2="",e.SS3="",e.DCS="",e.PU1="",e.PU2="",e.STS="",e.CCH="",e.MW="",e.SPA="",e.EPA="",e.SOS="",e.SGCI="",e.SCI="",e.CSI="",e.ST="",e.OSC="",e.PM="",e.APC=""))(Mk||(Mk={}));var Qhe;(e=>e.ST=`${qe.ESC}\\`)(Qhe||(Qhe={}));var kP=class{constructor(e,t,r,n,a,s){this._textarea=e,this._compositionView=t,this._bufferService=r,this._optionsService=n,this._coreService=a,this._renderService=s,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(e){this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(e){if(this._isComposing||this._isSendingComposition){if(e.keyCode===20||e.keyCode===229||e.keyCode===16||e.keyCode===17||e.keyCode===18)return!1;this._finalizeComposition(!1)}return e.keyCode===229?(this._handleAnyTextareaChanges(),!1):!0}_finalizeComposition(e){if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){let t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){this._isSendingComposition=!1;let r;t.start+=this._dataAlreadySent.length,this._isComposing?r=this._textarea.value.substring(t.start,this._compositionPosition.start):r=this._textarea.value.substring(t.start),r.length>0&&this._coreService.triggerDataEvent(r,!0)}},0)}else{this._isSendingComposition=!1;let t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){let e=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let t=this._textarea.value,r=t.replace(e,"");this._dataAlreadySent=r,t.length>e.length?this._coreService.triggerDataEvent(r,!0):t.length<e.length?this._coreService.triggerDataEvent(`${qe.DEL}`,!0):t.length===e.length&&t!==e&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(e){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),r=this._renderService.dimensions.css.cell.height,n=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,a=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=a+"px",this._compositionView.style.top=n+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let s=this._compositionView.getBoundingClientRect();this._textarea.style.left=a+"px",this._textarea.style.top=n+"px",this._textarea.style.width=Math.max(s.width,1)+"px",this._textarea.style.height=Math.max(s.height,1)+"px",this._textarea.style.lineHeight=s.height+"px"}e||setTimeout(()=>this.updateCompositionElements(!0),0)}}};kP=Zn([mt(2,Us),mt(3,Hs),mt(4,am),mt(5,bu)],kP);var Ra=0,Pa=0,za=0,qn=0,PZ={css:"#00000000",rgba:0},ha;(e=>{function t(a,s,i,l){return l!==void 0?`#${bf(a)}${bf(s)}${bf(i)}${bf(l)}`:`#${bf(a)}${bf(s)}${bf(i)}`}e.toCss=t;function r(a,s,i,l=255){return(a<<24|s<<16|i<<8|l)>>>0}e.toRgba=r;function n(a,s,i,l){return{css:e.toCss(a,s,i,l),rgba:e.toRgba(a,s,i,l)}}e.toColor=n})(ha||(ha={}));var kn;(e=>{function t(c,u){if(qn=(u.rgba&255)/255,qn===1)return{css:u.css,rgba:u.rgba};let d=u.rgba>>24&255,f=u.rgba>>16&255,m=u.rgba>>8&255,p=c.rgba>>24&255,v=c.rgba>>16&255,b=c.rgba>>8&255;Ra=p+Math.round((d-p)*qn),Pa=v+Math.round((f-v)*qn),za=b+Math.round((m-b)*qn);let y=ha.toCss(Ra,Pa,za),S=ha.toRgba(Ra,Pa,za);return{css:y,rgba:S}}e.blend=t;function r(c){return(c.rgba&255)===255}e.isOpaque=r;function n(c,u,d){let f=Tk.ensureContrastRatio(c.rgba,u.rgba,d);if(f)return ha.toColor(f>>24&255,f>>16&255,f>>8&255)}e.ensureContrastRatio=n;function a(c){let u=(c.rgba|255)>>>0;return[Ra,Pa,za]=Tk.toChannels(u),{css:ha.toCss(Ra,Pa,za),rgba:u}}e.opaque=a;function s(c,u){return qn=Math.round(u*255),[Ra,Pa,za]=Tk.toChannels(c.rgba),{css:ha.toCss(Ra,Pa,za,qn),rgba:ha.toRgba(Ra,Pa,za,qn)}}e.opacity=s;function i(c,u){return qn=c.rgba&255,s(c,qn*u/255)}e.multiplyOpacity=i;function l(c){return[c.rgba>>24&255,c.rgba>>16&255,c.rgba>>8&255]}e.toColorRGB=l})(kn||(kn={}));var zn;(e=>{let t,r;try{let a=document.createElement("canvas");a.width=1,a.height=1;let s=a.getContext("2d",{willReadFrequently:!0});s&&(t=s,t.globalCompositeOperation="copy",r=t.createLinearGradient(0,0,1,1))}catch{}function n(a){if(a.match(/#[\da-f]{3,8}/i))switch(a.length){case 4:return Ra=parseInt(a.slice(1,2).repeat(2),16),Pa=parseInt(a.slice(2,3).repeat(2),16),za=parseInt(a.slice(3,4).repeat(2),16),ha.toColor(Ra,Pa,za);case 5:return Ra=parseInt(a.slice(1,2).repeat(2),16),Pa=parseInt(a.slice(2,3).repeat(2),16),za=parseInt(a.slice(3,4).repeat(2),16),qn=parseInt(a.slice(4,5).repeat(2),16),ha.toColor(Ra,Pa,za,qn);case 7:return{css:a,rgba:(parseInt(a.slice(1),16)<<8|255)>>>0};case 9:return{css:a,rgba:parseInt(a.slice(1),16)>>>0}}let s=a.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(s)return Ra=parseInt(s[1]),Pa=parseInt(s[2]),za=parseInt(s[3]),qn=Math.round((s[5]===void 0?1:parseFloat(s[5]))*255),ha.toColor(Ra,Pa,za,qn);if(!t||!r)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=r,t.fillStyle=a,typeof t.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),[Ra,Pa,za,qn]=t.getImageData(0,0,1,1).data,qn!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:ha.toRgba(Ra,Pa,za,qn),css:a}}e.toColor=n})(zn||(zn={}));var Ts;(e=>{function t(n){return r(n>>16&255,n>>8&255,n&255)}e.relativeLuminance=t;function r(n,a,s){let i=n/255,l=a/255,c=s/255,u=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),d=l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4),f=c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4);return u*.2126+d*.7152+f*.0722}e.relativeLuminance2=r})(Ts||(Ts={}));var Tk;(e=>{function t(i,l){if(qn=(l&255)/255,qn===1)return l;let c=l>>24&255,u=l>>16&255,d=l>>8&255,f=i>>24&255,m=i>>16&255,p=i>>8&255;return Ra=f+Math.round((c-f)*qn),Pa=m+Math.round((u-m)*qn),za=p+Math.round((d-p)*qn),ha.toRgba(Ra,Pa,za)}e.blend=t;function r(i,l,c){let u=Ts.relativeLuminance(i>>8),d=Ts.relativeLuminance(l>>8);if(yc(u,d)<c){if(d<u){let p=n(i,l,c),v=yc(u,Ts.relativeLuminance(p>>8));if(v<c){let b=a(i,l,c),y=yc(u,Ts.relativeLuminance(b>>8));return v>y?p:b}return p}let f=a(i,l,c),m=yc(u,Ts.relativeLuminance(f>>8));if(m<c){let p=n(i,l,c),v=yc(u,Ts.relativeLuminance(p>>8));return m>v?f:p}return f}}e.ensureContrastRatio=r;function n(i,l,c){let u=i>>24&255,d=i>>16&255,f=i>>8&255,m=l>>24&255,p=l>>16&255,v=l>>8&255,b=yc(Ts.relativeLuminance2(m,p,v),Ts.relativeLuminance2(u,d,f));for(;b<c&&(m>0||p>0||v>0);)m-=Math.max(0,Math.ceil(m*.1)),p-=Math.max(0,Math.ceil(p*.1)),v-=Math.max(0,Math.ceil(v*.1)),b=yc(Ts.relativeLuminance2(m,p,v),Ts.relativeLuminance2(u,d,f));return(m<<24|p<<16|v<<8|255)>>>0}e.reduceLuminance=n;function a(i,l,c){let u=i>>24&255,d=i>>16&255,f=i>>8&255,m=l>>24&255,p=l>>16&255,v=l>>8&255,b=yc(Ts.relativeLuminance2(m,p,v),Ts.relativeLuminance2(u,d,f));for(;b<c&&(m<255||p<255||v<255);)m=Math.min(255,m+Math.ceil((255-m)*.1)),p=Math.min(255,p+Math.ceil((255-p)*.1)),v=Math.min(255,v+Math.ceil((255-v)*.1)),b=yc(Ts.relativeLuminance2(m,p,v),Ts.relativeLuminance2(u,d,f));return(m<<24|p<<16|v<<8|255)>>>0}e.increaseLuminance=a;function s(i){return[i>>24&255,i>>16&255,i>>8&255,i&255]}e.toChannels=s})(Tk||(Tk={}));function bf(e){let t=e.toString(16);return t.length<2?"0"+t:t}function yc(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}var XVe=class extends u1{constructor(e,t,r){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=t,this._width=r}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},iC=class{constructor(t){this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new So}register(t){let r={id:this._nextCharacterJoinerId++,handler:t};return this._characterJoiners.push(r),r.id}deregister(t){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===t)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(t){if(this._characterJoiners.length===0)return[];let r=this._bufferService.buffer.lines.get(t);if(!r||r.length===0)return[];let n=[],a=r.translateToString(!0),s=0,i=0,l=0,c=r.getFg(0),u=r.getBg(0);for(let d=0;d<r.getTrimmedLength();d++)if(r.loadCell(d,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==c||this._workCell.bg!==u){if(d-s>1){let f=this._getJoinedRanges(a,l,i,r,s);for(let m=0;m<f.length;m++)n.push(f[m])}s=d,l=i,c=this._workCell.fg,u=this._workCell.bg}i+=this._workCell.getChars().length||wd.length}if(this._bufferService.cols-s>1){let d=this._getJoinedRanges(a,l,i,r,s);for(let f=0;f<d.length;f++)n.push(d[f])}return n}_getJoinedRanges(t,r,n,a,s){let i=t.substring(r,n),l=[];try{l=this._characterJoiners[0].handler(i)}catch(c){console.error(c)}for(let c=1;c<this._characterJoiners.length;c++)try{let u=this._characterJoiners[c].handler(i);for(let d=0;d<u.length;d++)iC._mergeRanges(l,u[d])}catch(u){console.error(u)}return this._stringRangesToCellRanges(l,a,s),l}_stringRangesToCellRanges(t,r,n){let a=0,s=!1,i=0,l=t[a];if(l){for(let c=n;c<this._bufferService.cols;c++){let u=r.getWidth(c),d=r.getString(c).length||wd.length;if(u!==0){if(!s&&l[0]<=i&&(l[0]=c,s=!0),l[1]<=i){if(l[1]=c,l=t[++a],!l)break;l[0]<=i?(l[0]=c,s=!0):s=!1}i+=d}}l&&(l[1]=this._bufferService.cols)}}static _mergeRanges(t,r){let n=!1;for(let a=0;a<t.length;a++){let s=t[a];if(n){if(r[1]<=s[0])return t[a-1][1]=r[1],t;if(r[1]<=s[1])return t[a-1][1]=Math.max(r[1],s[1]),t.splice(a,1),t;t.splice(a,1),a--}else{if(r[1]<=s[0])return t.splice(a,0,r),t;if(r[1]<=s[1])return s[0]=Math.min(r[0],s[0]),t;r[0]<s[1]&&(s[0]=Math.min(r[0],s[0]),n=!0);continue}}return n?t[t.length-1][1]=r[1]:t.push(r),t}};iC=Zn([mt(0,Us)],iC);function eYe(e){return 57508<=e&&e<=57558}function tYe(e){return 9472<=e&&e<=9631}function rYe(e){return eYe(e)||tYe(e)}function nYe(){return{css:{canvas:LS(),cell:LS()},device:{canvas:LS(),cell:LS(),char:{width:0,height:0,left:0,top:0}}}}function LS(){return{width:0,height:0}}var _P=class{constructor(e,t,r,n,a,s,i){this._document=e,this._characterJoinerService=t,this._optionsService=r,this._coreBrowserService=n,this._coreService=a,this._decorationService=s,this._themeService=i,this._workCell=new So,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(e,t,r){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=r}createRow(e,t,r,n,a,s,i,l,c,u,d){let f=[],m=this._characterJoinerService.getJoinedCharacters(t),p=this._themeService.colors,v=e.getNoBgTrimmedLength();r&&v<s+1&&(v=s+1);let b,y=0,S="",_=0,N=0,k=0,j=0,E=!1,T=0,O=!1,R=0,H=0,$=[],L=u!==-1&&d!==-1;for(let A=0;A<v;A++){e.loadCell(A,this._workCell);let M=this._workCell.getWidth();if(M===0)continue;let P=!1,I=A>=H,B=A,F=this._workCell;if(m.length>0&&A===m[0][0]&&I){let ve=m.shift(),U=this._isCellInSelection(ve[0],t);for(_=ve[0]+1;_<ve[1];_++)I&&(I=U===this._isCellInSelection(_,t));I&&(I=!r||s<ve[0]||s>=ve[1]),I?(P=!0,F=new XVe(this._workCell,e.translateToString(!0,ve[0],ve[1]),ve[1]-ve[0]),B=ve[1]-1,M=F.getWidth()):H=ve[1]}let q=this._isCellInSelection(A,t),Q=r&&A===s,W=L&&A>=u&&A<=d,G=!1;this._decorationService.forEachDecorationAtCell(A,t,void 0,ve=>{G=!0});let J=F.getChars()||wd;if(J===" "&&(F.isUnderline()||F.isOverline())&&(J=""),R=M*l-c.get(J,F.isBold(),F.isItalic()),!b)b=this._document.createElement("span");else if(y&&(q&&O||!q&&!O&&F.bg===N)&&(q&&O&&p.selectionForeground||F.fg===k)&&F.extended.ext===j&&W===E&&R===T&&!Q&&!P&&!G&&I){F.isInvisible()?S+=wd:S+=J,y++;continue}else y&&(b.textContent=S),b=this._document.createElement("span"),y=0,S="";if(N=F.bg,k=F.fg,j=F.extended.ext,E=W,T=R,O=q,P&&s>=A&&s<=B&&(s=A),!this._coreService.isCursorHidden&&Q&&this._coreService.isCursorInitialized){if($.push("xterm-cursor"),this._coreBrowserService.isFocused)i&&$.push("xterm-cursor-blink"),$.push(n==="bar"?"xterm-cursor-bar":n==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(a)switch(a){case"outline":$.push("xterm-cursor-outline");break;case"block":$.push("xterm-cursor-block");break;case"bar":$.push("xterm-cursor-bar");break;case"underline":$.push("xterm-cursor-underline");break}}if(F.isBold()&&$.push("xterm-bold"),F.isItalic()&&$.push("xterm-italic"),F.isDim()&&$.push("xterm-dim"),F.isInvisible()?S=wd:S=F.getChars()||wd,F.isUnderline()&&($.push(`xterm-underline-${F.extended.underlineStyle}`),S===" "&&(S=""),!F.isUnderlineColorDefault()))if(F.isUnderlineColorRGB())b.style.textDecorationColor=`rgb(${u1.toColorRGB(F.getUnderlineColor()).join(",")})`;else{let ve=F.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&F.isBold()&&ve<8&&(ve+=8),b.style.textDecorationColor=p.ansi[ve].css}F.isOverline()&&($.push("xterm-overline"),S===" "&&(S="")),F.isStrikethrough()&&$.push("xterm-strikethrough"),W&&(b.style.textDecoration="underline");let X=F.getFgColor(),V=F.getFgColorMode(),se=F.getBgColor(),de=F.getBgColorMode(),he=!!F.isInverse();if(he){let ve=X;X=se,se=ve;let U=V;V=de,de=U}let te,le,oe=!1;this._decorationService.forEachDecorationAtCell(A,t,void 0,ve=>{ve.options.layer!=="top"&&oe||(ve.backgroundColorRGB&&(de=50331648,se=ve.backgroundColorRGB.rgba>>8&16777215,te=ve.backgroundColorRGB),ve.foregroundColorRGB&&(V=50331648,X=ve.foregroundColorRGB.rgba>>8&16777215,le=ve.foregroundColorRGB),oe=ve.options.layer==="top")}),!oe&&q&&(te=this._coreBrowserService.isFocused?p.selectionBackgroundOpaque:p.selectionInactiveBackgroundOpaque,se=te.rgba>>8&16777215,de=50331648,oe=!0,p.selectionForeground&&(V=50331648,X=p.selectionForeground.rgba>>8&16777215,le=p.selectionForeground)),oe&&$.push("xterm-decoration-top");let Z;switch(de){case 16777216:case 33554432:Z=p.ansi[se],$.push(`xterm-bg-${se}`);break;case 50331648:Z=ha.toColor(se>>16,se>>8&255,se&255),this._addStyle(b,`background-color:#${zZ((se>>>0).toString(16),"0",6)}`);break;case 0:default:he?(Z=p.foreground,$.push("xterm-bg-257")):Z=p.background}switch(te||F.isDim()&&(te=kn.multiplyOpacity(Z,.5)),V){case 16777216:case 33554432:F.isBold()&&X<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(X+=8),this._applyMinimumContrast(b,Z,p.ansi[X],F,te,void 0)||$.push(`xterm-fg-${X}`);break;case 50331648:let ve=ha.toColor(X>>16&255,X>>8&255,X&255);this._applyMinimumContrast(b,Z,ve,F,te,le)||this._addStyle(b,`color:#${zZ(X.toString(16),"0",6)}`);break;case 0:default:this._applyMinimumContrast(b,Z,p.foreground,F,te,le)||he&&$.push("xterm-fg-257")}$.length&&(b.className=$.join(" "),$.length=0),!Q&&!P&&!G&&I?y++:b.textContent=S,R!==this.defaultSpacing&&(b.style.letterSpacing=`${R}px`),f.push(b),A=B}return b&&y&&(b.textContent=S),f}_applyMinimumContrast(e,t,r,n,a,s){if(this._optionsService.rawOptions.minimumContrastRatio===1||rYe(n.getCode()))return!1;let i=this._getContrastCache(n),l;if(!a&&!s&&(l=i.getColor(t.rgba,r.rgba)),l===void 0){let c=this._optionsService.rawOptions.minimumContrastRatio/(n.isDim()?2:1);l=kn.ensureContrastRatio(a||t,s||r,c),i.setColor((a||t).rgba,(s||r).rgba,l??null)}return l?(this._addStyle(e,`color:${l.css}`),!0):!1}_getContrastCache(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(e,t){e.setAttribute("style",`${e.getAttribute("style")||""}${t};`)}_isCellInSelection(e,t){let r=this._selectionStart,n=this._selectionEnd;return!r||!n?!1:this._columnSelectMode?r[0]<=n[0]?e>=r[0]&&t>=r[1]&&e<n[0]&&t<=n[1]:e<r[0]&&t>=r[1]&&e>=n[0]&&t<=n[1]:t>r[1]&&t<n[1]||r[1]===n[1]&&t===r[1]&&e>=r[0]&&e<n[0]||r[1]<n[1]&&t===n[1]&&e<n[0]||r[1]<n[1]&&t===r[1]&&e>=r[0]}};_P=Zn([mt(1,Dhe),mt(2,Hs),mt(3,vu),mt(4,am),mt(5,d1),mt(6,m0)],_P);function zZ(e,t,r){for(;e.length<r;)e=t+e;return e}var aYe=class{constructor(e,t){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=e.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let r=e.createElement("span");r.classList.add("xterm-char-measure-element");let n=e.createElement("span");n.classList.add("xterm-char-measure-element"),n.style.fontWeight="bold";let a=e.createElement("span");a.classList.add("xterm-char-measure-element"),a.style.fontStyle="italic";let s=e.createElement("span");s.classList.add("xterm-char-measure-element"),s.style.fontWeight="bold",s.style.fontStyle="italic",this._measureElements=[r,n,a,s],this._container.appendChild(r),this._container.appendChild(n),this._container.appendChild(a),this._container.appendChild(s),t.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(e,t,r,n){e===this._font&&t===this._fontSize&&r===this._weight&&n===this._weightBold||(this._font=e,this._fontSize=t,this._weight=r,this._weightBold=n,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${r}`,this._measureElements[1].style.fontWeight=`${n}`,this._measureElements[2].style.fontWeight=`${r}`,this._measureElements[3].style.fontWeight=`${n}`,this.clear())}get(e,t,r){let n=0;if(!t&&!r&&e.length===1&&(n=e.charCodeAt(0))<256){if(this._flat[n]!==-9999)return this._flat[n];let i=this._measure(e,0);return i>0&&(this._flat[n]=i),i}let a=e;t&&(a+="B"),r&&(a+="I");let s=this._holey.get(a);if(s===void 0){let i=0;t&&(i|=1),r&&(i|=2),s=this._measure(e,i),s>0&&this._holey.set(a,s)}return s}_measure(e,t){let r=this._measureElements[t];return r.textContent=e.repeat(32),r.offsetWidth/32}},sYe=class{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(e,t,r,n=!1){if(this.selectionStart=t,this.selectionEnd=r,!t||!r||t[0]===r[0]&&t[1]===r[1]){this.clear();return}let a=e.buffers.active.ydisp,s=t[1]-a,i=r[1]-a,l=Math.max(s,0),c=Math.min(i,e.rows-1);if(l>=e.rows||c<0){this.clear();return}this.hasSelection=!0,this.columnSelectMode=n,this.viewportStartRow=s,this.viewportEndRow=i,this.viewportCappedStartRow=l,this.viewportCappedEndRow=c,this.startCol=t[0],this.endCol=r[0]}isCellSelected(e,t,r){return this.hasSelection?(r-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&r>=this.viewportCappedStartRow&&t<this.endCol&&r<=this.viewportCappedEndRow:t<this.startCol&&r>=this.viewportCappedStartRow&&t>=this.endCol&&r<=this.viewportCappedEndRow:r>this.viewportStartRow&&r<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&r===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&r===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&r===this.viewportStartRow&&t>=this.startCol):!1}};function iYe(){return new sYe}var bL="xterm-dom-renderer-owner-",no="xterm-rows",OS="xterm-fg-",BZ="xterm-bg-",Ov="xterm-focus",IS="xterm-selection",oYe=1,NP=class extends gr{constructor(e,t,r,n,a,s,i,l,c,u,d,f,m,p){super(),this._terminal=e,this._document=t,this._element=r,this._screenElement=n,this._viewportElement=a,this._helperContainer=s,this._linkifier2=i,this._charSizeService=c,this._optionsService=u,this._bufferService=d,this._coreService=f,this._coreBrowserService=m,this._themeService=p,this._terminalClass=oYe++,this._rowElements=[],this._selectionRenderModel=iYe(),this.onRequestRedraw=this._register(new rt).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(no),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(IS),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=nYe(),this._updateDimensions(),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._themeService.onChangeColors(v=>this._injectCss(v))),this._injectCss(this._themeService.colors),this._rowFactory=l.createInstance(_P,document),this._element.classList.add(bL+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this._register(this._linkifier2.onShowLinkUnderline(v=>this._handleLinkHover(v))),this._register(this._linkifier2.onHideLinkUnderline(v=>this._handleLinkLeave(v))),this._register(Mn(()=>{this._element.classList.remove(bL+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new aYe(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let r of this._rowElements)r.style.width=`${this.dimensions.css.canvas.width}px`,r.style.height=`${this.dimensions.css.cell.height}px`,r.style.lineHeight=`${this.dimensions.css.cell.height}px`,r.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let t=`${this._terminalSelector} .${no} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=t,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(e){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let t=`${this._terminalSelector} .${no} { pointer-events: none; color: ${e.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;t+=`${this._terminalSelector} .${no} .xterm-dim { color: ${kn.multiplyOpacity(e.foreground,.5).css};}`,t+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;let r=`blink_underline_${this._terminalClass}`,n=`blink_bar_${this._terminalClass}`,a=`blink_block_${this._terminalClass}`;t+=`@keyframes ${r} { 50% {  border-bottom-style: hidden; }}`,t+=`@keyframes ${n} { 50% {  box-shadow: none; }}`,t+=`@keyframes ${a} { 0% {  background-color: ${e.cursor.css};  color: ${e.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${e.cursor.css}; }}`,t+=`${this._terminalSelector} .${no}.${Ov} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${r} 1s step-end infinite;}${this._terminalSelector} .${no}.${Ov} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${n} 1s step-end infinite;}${this._terminalSelector} .${no}.${Ov} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${a} 1s step-end infinite;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-block { background-color: ${e.cursor.css}; color: ${e.cursorAccent.css};}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${e.cursor.css} !important; color: ${e.cursorAccent.css} !important;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${e.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${e.cursor.css} inset;}${this._terminalSelector} .${no} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${e.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,t+=`${this._terminalSelector} .${IS} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${IS} div { position: absolute; background-color: ${e.selectionBackgroundOpaque.css};}${this._terminalSelector} .${IS} div { position: absolute; background-color: ${e.selectionInactiveBackgroundOpaque.css};}`;for(let[s,i]of e.ansi.entries())t+=`${this._terminalSelector} .${OS}${s} { color: ${i.css}; }${this._terminalSelector} .${OS}${s}.xterm-dim { color: ${kn.multiplyOpacity(i,.5).css}; }${this._terminalSelector} .${BZ}${s} { background-color: ${i.css}; }`;t+=`${this._terminalSelector} .${OS}257 { color: ${kn.opaque(e.background).css}; }${this._terminalSelector} .${OS}257.xterm-dim { color: ${kn.multiplyOpacity(kn.opaque(e.background),.5).css}; }${this._terminalSelector} .${BZ}257 { background-color: ${e.foreground.css}; }`,this._themeStyleElement.textContent=t}_setDefaultSpacing(){let e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${e}px`,this._rowFactory.defaultSpacing=e}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(e,t){for(let r=this._rowElements.length;r<=t;r++){let n=this._document.createElement("div");this._rowContainer.appendChild(n),this._rowElements.push(n)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(e,t){this._refreshRowElements(e,t),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(Ov),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(Ov),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(e,t,r){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,t,r),this.renderRows(0,this._bufferService.rows-1),!e||!t||(this._selectionRenderModel.update(this._terminal,e,t,r),!this._selectionRenderModel.hasSelection))return;let n=this._selectionRenderModel.viewportStartRow,a=this._selectionRenderModel.viewportEndRow,s=this._selectionRenderModel.viewportCappedStartRow,i=this._selectionRenderModel.viewportCappedEndRow,l=this._document.createDocumentFragment();if(r){let c=e[0]>t[0];l.appendChild(this._createSelectionElement(s,c?t[0]:e[0],c?e[0]:t[0],i-s+1))}else{let c=n===s?e[0]:0,u=s===a?t[0]:this._bufferService.cols;l.appendChild(this._createSelectionElement(s,c,u));let d=i-s-1;if(l.appendChild(this._createSelectionElement(s+1,0,this._bufferService.cols,d)),s!==i){let f=a===i?t[0]:this._bufferService.cols;l.appendChild(this._createSelectionElement(i,0,f))}}this._selectionContainer.appendChild(l)}_createSelectionElement(e,t,r,n=1){let a=this._document.createElement("div"),s=t*this.dimensions.css.cell.width,i=this.dimensions.css.cell.width*(r-t);return s+i>this.dimensions.css.canvas.width&&(i=this.dimensions.css.canvas.width-s),a.style.height=`${n*this.dimensions.css.cell.height}px`,a.style.top=`${e*this.dimensions.css.cell.height}px`,a.style.left=`${s}px`,a.style.width=`${i}px`,a}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let e of this._rowElements)e.replaceChildren()}renderRows(e,t){let r=this._bufferService.buffer,n=r.ybase+r.y,a=Math.min(r.x,this._bufferService.cols-1),s=this._coreService.decPrivateModes.cursorBlink??this._optionsService.rawOptions.cursorBlink,i=this._coreService.decPrivateModes.cursorStyle??this._optionsService.rawOptions.cursorStyle,l=this._optionsService.rawOptions.cursorInactiveStyle;for(let c=e;c<=t;c++){let u=c+r.ydisp,d=this._rowElements[c],f=r.lines.get(u);if(!d||!f)break;d.replaceChildren(...this._rowFactory.createRow(f,u,u===n,i,l,a,s,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${bL}${this._terminalClass}`}_handleLinkHover(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}_handleLinkLeave(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}_setCellUnderline(e,t,r,n,a,s){r<0&&(e=0),n<0&&(t=0);let i=this._bufferService.rows-1;r=Math.max(Math.min(r,i),0),n=Math.max(Math.min(n,i),0),a=Math.min(a,this._bufferService.cols);let l=this._bufferService.buffer,c=l.ybase+l.y,u=Math.min(l.x,a-1),d=this._optionsService.rawOptions.cursorBlink,f=this._optionsService.rawOptions.cursorStyle,m=this._optionsService.rawOptions.cursorInactiveStyle;for(let p=r;p<=n;++p){let v=p+l.ydisp,b=this._rowElements[p],y=l.lines.get(v);if(!b||!y)break;b.replaceChildren(...this._rowFactory.createRow(y,v,v===c,f,m,u,d,this.dimensions.css.cell.width,this._widthCache,s?p===r?e:0:-1,s?(p===n?t:a)-1:-1))}}};NP=Zn([mt(7,bB),mt(8,h2),mt(9,Hs),mt(10,Us),mt(11,am),mt(12,vu),mt(13,m0)],NP);var CP=class extends gr{constructor(e,t,r){super(),this._optionsService=r,this.width=0,this.height=0,this._onCharSizeChange=this._register(new rt),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this._register(new cYe(this._optionsService))}catch{this._measureStrategy=this._register(new lYe(e,t,this._optionsService))}this._register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let e=this._measureStrategy.measure();(e.width!==this.width||e.height!==this.height)&&(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};CP=Zn([mt(2,Hs)],CP);var Jhe=class extends gr{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(e,t){e!==void 0&&e>0&&t!==void 0&&t>0&&(this._result.width=e,this._result.height=t)}},lYe=class extends Jhe{constructor(e,t,r){super(),this._document=e,this._parentElement=t,this._optionsService=r,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}},cYe=class extends Jhe{constructor(e){super(),this._optionsService=e,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");let t=this._ctx.measureText("W");if(!("width"in t&&"fontBoundingBoxAscent"in t&&"fontBoundingBoxDescent"in t))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;let e=this._ctx.measureText("W");return this._validateAndSet(e.width,e.fontBoundingBoxAscent+e.fontBoundingBoxDescent),this._result}},uYe=class extends gr{constructor(e,t,r){super(),this._textarea=e,this._window=t,this.mainDocument=r,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=this._register(new dYe(this._window)),this._onDprChange=this._register(new rt),this.onDprChange=this._onDprChange.event,this._onWindowChange=this._register(new rt),this.onWindowChange=this._onWindowChange.event,this._register(this.onWindowChange(n=>this._screenDprMonitor.setWindow(n))),this._register(ls.forward(this._screenDprMonitor.onDprChange,this._onDprChange)),this._register(Xt(this._textarea,"focus",()=>this._isFocused=!0)),this._register(Xt(this._textarea,"blur",()=>this._isFocused=!1))}get window(){return this._window}set window(e){this._window!==e&&(this._window=e,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}},dYe=class extends gr{constructor(e){super(),this._parentWindow=e,this._windowResizeListener=this._register(new Lg),this._onDprChange=this._register(new rt),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this._register(Mn(()=>this.clearListener()))}setWindow(e){this._parentWindow=e,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=Xt(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){!this._resolutionMediaMatchList||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}},fYe=class extends gr{constructor(){super(),this.linkProviders=[],this._register(Mn(()=>this.linkProviders.length=0))}registerLinkProvider(e){return this.linkProviders.push(e),{dispose:()=>{let t=this.linkProviders.indexOf(e);t!==-1&&this.linkProviders.splice(t,1)}}}};function CB(e,t,r){let n=r.getBoundingClientRect(),a=e.getComputedStyle(r),s=parseInt(a.getPropertyValue("padding-left")),i=parseInt(a.getPropertyValue("padding-top"));return[t.clientX-n.left-s,t.clientY-n.top-i]}function hYe(e,t,r,n,a,s,i,l,c){if(!s)return;let u=CB(e,t,r);if(u)return u[0]=Math.ceil((u[0]+(c?i/2:0))/i),u[1]=Math.ceil(u[1]/l),u[0]=Math.min(Math.max(u[0],1),n+(c?1:0)),u[1]=Math.min(Math.max(u[1],1),a),u}var jP=class{constructor(e,t){this._renderService=e,this._charSizeService=t}getCoords(e,t,r,n,a){return hYe(window,e,t,r,n,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,a)}getMouseReportCoords(e,t){let r=CB(window,e,t);if(this._charSizeService.hasValidSize)return r[0]=Math.min(Math.max(r[0],0),this._renderService.dimensions.css.canvas.width-1),r[1]=Math.min(Math.max(r[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(r[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(r[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(r[0]),y:Math.floor(r[1])}}};jP=Zn([mt(0,bu),mt(1,h2)],jP);var mYe=class{constructor(e,t){this._renderCallback=e,this._coreBrowserService=t,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(e){return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(e,t,r){this._rowCount=r,e=e!==void 0?e:0,t=t!==void 0?t:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,t):t,!this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0){this._runRefreshCallbacks();return}let e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let e of this._refreshCallbacks)e(0);this._refreshCallbacks=[]}},Zhe={};_Ge(Zhe,{getSafariVersion:()=>gYe,isChromeOS:()=>rme,isFirefox:()=>Xhe,isIpad:()=>vYe,isIphone:()=>bYe,isLegacyEdge:()=>pYe,isLinux:()=>jB,isMac:()=>oC,isNode:()=>m2,isSafari:()=>eme,isWindows:()=>tme});var m2=typeof process<"u"&&"title"in process,f1=m2?"node":navigator.userAgent,h1=m2?"node":navigator.platform,Xhe=f1.includes("Firefox"),pYe=f1.includes("Edge"),eme=/^((?!chrome|android).)*safari/i.test(f1);function gYe(){if(!eme)return 0;let e=f1.match(/Version\/(\d+)/);return e===null||e.length<2?0:parseInt(e[1])}var oC=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h1),vYe=h1==="iPad",bYe=h1==="iPhone",tme=["Windows","Win16","Win32","WinCE"].includes(h1),jB=h1.indexOf("Linux")>=0,rme=/\bCrOS\b/.test(f1),nme=class{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,r=0,n=e.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(t=performance.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,performance.now()-t),r=Math.max(t,r),a=e.timeRemaining(),r*1.5>a){n-t<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-t))}ms`),this._start();return}n=a}this.clear()}},yYe=class extends nme{_requestCallback(t){return setTimeout(()=>t(this._createDeadline(16)))}_cancelCallback(t){clearTimeout(t)}_createDeadline(t){let r=performance.now()+t;return{timeRemaining:()=>Math.max(0,r-performance.now())}}},xYe=class extends nme{_requestCallback(e){return requestIdleCallback(e)}_cancelCallback(e){cancelIdleCallback(e)}},lC=!m2&&"requestIdleCallback"in window?xYe:yYe,wYe=class{constructor(){this._queue=new lC}set(e){this._queue.clear(),this._queue.enqueue(e)}flush(){this._queue.flush()}},EP=class extends gr{constructor(e,t,r,n,a,s,i,l,c){super(),this._rowCount=e,this._optionsService=r,this._charSizeService=n,this._coreService=a,this._coreBrowserService=l,this._renderer=this._register(new Lg),this._pausedResizeTask=new wYe,this._observerDisposable=this._register(new Lg),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this._register(new rt),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this._register(new rt),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this._register(new rt),this.onRender=this._onRender.event,this._onRefreshRequest=this._register(new rt),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new mYe((u,d)=>this._renderRows(u,d),this._coreBrowserService),this._register(this._renderDebouncer),this._syncOutputHandler=new SYe(this._coreBrowserService,this._coreService,()=>this._fullRefresh()),this._register(Mn(()=>this._syncOutputHandler.dispose())),this._register(this._coreBrowserService.onDprChange(()=>this.handleDevicePixelRatioChange())),this._register(i.onResize(()=>this._fullRefresh())),this._register(i.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this._register(s.onDecorationRegistered(()=>this._fullRefresh())),this._register(s.onDecorationRemoved(()=>this._fullRefresh())),this._register(this._optionsService.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(i.cols,i.rows),this._fullRefresh()})),this._register(this._optionsService.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(i.buffer.y,i.buffer.y,!0))),this._register(c.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(this._coreBrowserService.window,t),this._register(this._coreBrowserService.onWindowChange(u=>this._registerIntersectionObserver(u,t)))}get dimensions(){return this._renderer.value.dimensions}_registerIntersectionObserver(e,t){if("IntersectionObserver"in e){let r=new e.IntersectionObserver(n=>this._handleIntersectionChange(n[n.length-1]),{threshold:0});r.observe(t),this._observerDisposable.value=Mn(()=>r.disconnect())}}_handleIntersectionChange(e){this._isPaused=e.isIntersecting===void 0?e.intersectionRatio===0:!e.isIntersecting,!this._isPaused&&!this._charSizeService.hasValidSize&&this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,t,r=!1){if(this._isPaused){this._needsFullRefresh=!0;return}if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,t);return}let n=this._syncOutputHandler.flush();n&&(e=Math.min(e,n.start),t=Math.max(t,n.end)),r||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount)}_renderRows(e,t){if(this._renderer.value){if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,t);return}e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.value.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0}}resize(e,t){this._rowCount=t,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(e){this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw(t=>this.refreshRows(t.start,t.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,t){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(e,t)):this._renderer.value.handleResize(e,t),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(e,t,r){this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=r,this._renderer.value?.handleSelectionChanged(e,t,r)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};EP=Zn([mt(2,Hs),mt(3,h2),mt(4,am),mt(5,d1),mt(6,Us),mt(7,vu),mt(8,m0)],EP);var SYe=class{constructor(e,t,r){this._coreBrowserService=e,this._coreService=t,this._onTimeout=r,this._start=0,this._end=0,this._isBuffering=!1}bufferRows(e,t){this._isBuffering?(this._start=Math.min(this._start,e),this._end=Math.max(this._end,t)):(this._start=e,this._end=t,this._isBuffering=!0),this._timeout===void 0&&(this._timeout=this._coreBrowserService.window.setTimeout(()=>{this._timeout=void 0,this._coreService.decPrivateModes.synchronizedOutput=!1,this._onTimeout()},1e3))}flush(){if(this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0),!this._isBuffering)return;let e={start:this._start,end:this._end};return this._isBuffering=!1,e}dispose(){this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0)}};function kYe(e,t,r,n){let a=r.buffer.x,s=r.buffer.y;if(!r.buffer.hasScrollback)return CYe(a,s,e,t,r,n)+p2(s,t,r,n)+jYe(a,s,e,t,r,n);let i;if(s===t)return i=a>e?"D":"C",lx(Math.abs(a-e),ox(i,n));i=s>t?"D":"C";let l=Math.abs(s-t),c=NYe(s>t?e:a,r)+(l-1)*r.cols+1+_Ye(s>t?a:e);return lx(c,ox(i,n))}function _Ye(e,t){return e-1}function NYe(e,t){return t.cols-e}function CYe(e,t,r,n,a,s){return p2(t,n,a,s).length===0?"":lx(sme(e,t,e,t-Lh(t,a),!1,a).length,ox("D",s))}function p2(e,t,r,n){let a=e-Lh(e,r),s=t-Lh(t,r),i=Math.abs(a-s)-EYe(e,t,r);return lx(i,ox(ame(e,t),n))}function jYe(e,t,r,n,a,s){let i;p2(t,n,a,s).length>0?i=n-Lh(n,a):i=t;let l=n,c=MYe(e,t,r,n,a,s);return lx(sme(e,i,r,l,c==="C",a).length,ox(c,s))}function EYe(e,t,r){let n=0,a=e-Lh(e,r),s=t-Lh(t,r);for(let i=0;i<Math.abs(a-s);i++){let l=ame(e,t)==="A"?-1:1;r.buffer.lines.get(a+l*i)?.isWrapped&&n++}return n}function Lh(e,t){let r=0,n=t.buffer.lines.get(e),a=n?.isWrapped;for(;a&&e>=0&&e<t.rows;)r++,n=t.buffer.lines.get(--e),a=n?.isWrapped;return r}function MYe(e,t,r,n,a,s){let i;return p2(r,n,a,s).length>0?i=n-Lh(n,a):i=t,e<r&&i<=n||e>=r&&i<n?"C":"D"}function ame(e,t){return e>t?"A":"B"}function sme(e,t,r,n,a,s){let i=e,l=t,c="";for(;(i!==r||l!==n)&&l>=0&&l<s.buffer.lines.length;)i+=a?1:-1,a&&i>s.cols-1?(c+=s.buffer.translateBufferLineToString(l,!1,e,i),i=0,e=0,l++):!a&&i<0&&(c+=s.buffer.translateBufferLineToString(l,!1,0,e+1),i=s.cols-1,e=i,l--);return c+s.buffer.translateBufferLineToString(l,!1,e,i)}function ox(e,t){let r=t?"O":"[";return qe.ESC+r+e}function lx(e,t){e=Math.floor(e);let r="";for(let n=0;n<e;n++)r+=t;return r}var TYe=class{constructor(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:!this.selectionEnd||!this.selectionStart?this.selectionStart:this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols===0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let e=this.selectionStart,t=this.selectionEnd;return!e||!t?!1:e[1]>t[1]||e[1]===t[1]&&e[0]>t[0]}handleTrim(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}};function $Z(e,t){if(e.start.y>e.end.y)throw new Error(`Buffer range end (${e.end.x}, ${e.end.y}) cannot be before start (${e.start.x}, ${e.start.y})`);return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}var yL=50,AYe=15,DYe=50,LYe=500,OYe="",IYe=new RegExp(OYe,"g"),MP=class extends gr{constructor(e,t,r,n,a,s,i,l,c){super(),this._element=e,this._screenElement=t,this._linkifier=r,this._bufferService=n,this._coreService=a,this._mouseService=s,this._optionsService=i,this._renderService=l,this._coreBrowserService=c,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new So,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this._register(new rt),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this._register(new rt),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this._register(new rt),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this._register(new rt),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=u=>this._handleMouseMove(u),this._mouseUpListener=u=>this._handleMouseUp(u),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(u=>this._handleTrim(u)),this._register(this._bufferService.buffers.onBufferActivate(u=>this._handleBufferActivate(u))),this.enable(),this._model=new TYe(this._bufferService),this._activeSelectionMode=0,this._register(Mn(()=>{this._removeMouseDownListeners()})),this._register(this._bufferService.onResize(u=>{u.rowsChanged&&this.clearSelection()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!e||!t?!1:e[0]!==t[0]||e[1]!==t[1]}get selectionText(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";let r=this._bufferService.buffer,n=[];if(this._activeSelectionMode===3){if(e[0]===t[0])return"";let a=e[0]<t[0]?e[0]:t[0],s=e[0]<t[0]?t[0]:e[0];for(let i=e[1];i<=t[1];i++){let l=r.translateBufferLineToString(i,!0,a,s);n.push(l)}}else{let a=e[1]===t[1]?t[0]:void 0;n.push(r.translateBufferLineToString(e[1],!0,e[0],a));for(let s=e[1]+1;s<=t[1]-1;s++){let i=r.lines.get(s),l=r.translateBufferLineToString(s,!0);i?.isWrapped?n[n.length-1]+=l:n.push(l)}if(e[1]!==t[1]){let s=r.lines.get(t[1]),i=r.translateBufferLineToString(t[1],!0,0,t[0]);s&&s.isWrapped?n[n.length-1]+=i:n.push(i)}}return n.map(a=>a.replace(IYe," ")).join(tme?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(e){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),jB&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(e){let t=this._getMouseBufferCoords(e),r=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!r||!n||!t?!1:this._areCoordsInSelection(t,r,n)}isCellInSelection(e,t){let r=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!r||!n?!1:this._areCoordsInSelection([e,t],r,n)}_areCoordsInSelection(e,t,r){return e[1]>t[1]&&e[1]<r[1]||t[1]===r[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<r[0]||t[1]<r[1]&&e[1]===r[1]&&e[0]<r[0]||t[1]<r[1]&&e[1]===t[1]&&e[0]>=t[0]}_selectWordAtCursor(e,t){let r=this._linkifier.currentLink?.link?.range;if(r)return this._model.selectionStart=[r.start.x-1,r.start.y-1],this._model.selectionStartLength=$Z(r,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let n=this._getMouseBufferCoords(e);return n?(this._selectWordAt(n,t),this._model.selectionEnd=void 0,!0):!1}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}_handleTrim(e){this._model.handleTrim(e)&&this.refresh()}_getMouseBufferCoords(e){let t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}_getMouseEventScrollAmount(e){let t=CB(this._coreBrowserService.window,e,this._screenElement)[1],r=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=r?0:(t>r&&(t-=r),t=Math.min(Math.max(t,-yL),yL),t/=yL,t/Math.abs(t)+Math.round(t*(AYe-1)))}shouldForceSelection(e){return oC?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}handleMouseDown(e){if(this._mouseDownTimeStamp=e.timeStamp,!(e.button===2&&this.hasSelection)&&e.button===0){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):e.detail===1?this._handleSingleClick(e):e.detail===2?this._handleDoubleClick(e):e.detail===3&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),DYe)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}_handleSingleClick(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&t.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(e){let t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}shouldColumnSelect(e){return e.altKey&&!(oC&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(e){if(e.stopImmediatePropagation(),!this._model.selectionStart)return;let t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),!this._model.selectionEnd){this.refresh(!0);return}this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let r=this._bufferService.buffer;if(this._model.selectionEnd[1]<r.lines.length){let n=r.lines.get(this._model.selectionEnd[1]);n&&n.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}(!t||t[0]!==this._model.selectionEnd[0]||t[1]!==this._model.selectionEnd[1])&&this.refresh(!0)}_dragScroll(){if(!(!this._model.selectionEnd||!this._model.selectionStart)&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let e=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}_handleMouseUp(e){let t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<LYe&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let r=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(r&&r[0]!==void 0&&r[1]!==void 0){let n=kYe(r[0]-1,r[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(n,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,r=!!e&&!!t&&(e[0]!==t[0]||e[1]!==t[1]);if(!r){this._oldHasSelection&&this._fireOnSelectionChange(e,t,r);return}!e||!t||(!this._oldSelectionStart||!this._oldSelectionEnd||e[0]!==this._oldSelectionStart[0]||e[1]!==this._oldSelectionStart[1]||t[0]!==this._oldSelectionEnd[0]||t[1]!==this._oldSelectionEnd[1])&&this._fireOnSelectionChange(e,t,r)}_fireOnSelectionChange(e,t,r){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=r,this._onSelectionChange.fire()}_handleBufferActivate(e){this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim(t=>this._handleTrim(t))}_convertViewportColToCharacterIndex(e,t){let r=t;for(let n=0;t>=n;n++){let a=e.loadCell(n,this._workCell).getChars().length;this._workCell.getWidth()===0?r--:a>1&&t!==n&&(r+=a-1)}return r}setSelection(e,t,r){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=r,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(e,t,r=!0,n=!0){if(e[0]>=this._bufferService.cols)return;let a=this._bufferService.buffer,s=a.lines.get(e[1]);if(!s)return;let i=a.translateBufferLineToString(e[1],!1),l=this._convertViewportColToCharacterIndex(s,e[0]),c=l,u=e[0]-l,d=0,f=0,m=0,p=0;if(i.charAt(l)===" "){for(;l>0&&i.charAt(l-1)===" ";)l--;for(;c<i.length&&i.charAt(c+1)===" ";)c++}else{let y=e[0],S=e[0];s.getWidth(y)===0&&(d++,y--),s.getWidth(S)===2&&(f++,S++);let _=s.getString(S).length;for(_>1&&(p+=_-1,c+=_-1);y>0&&l>0&&!this._isCharWordSeparator(s.loadCell(y-1,this._workCell));){s.loadCell(y-1,this._workCell);let N=this._workCell.getChars().length;this._workCell.getWidth()===0?(d++,y--):N>1&&(m+=N-1,l-=N-1),l--,y--}for(;S<s.length&&c+1<i.length&&!this._isCharWordSeparator(s.loadCell(S+1,this._workCell));){s.loadCell(S+1,this._workCell);let N=this._workCell.getChars().length;this._workCell.getWidth()===2?(f++,S++):N>1&&(p+=N-1,c+=N-1),c++,S++}}c++;let v=l+u-d+m,b=Math.min(this._bufferService.cols,c-l+d+f-m-p);if(!(!t&&i.slice(l,c).trim()==="")){if(r&&v===0&&s.getCodePoint(0)!==32){let y=a.lines.get(e[1]-1);if(y&&s.isWrapped&&y.getCodePoint(this._bufferService.cols-1)!==32){let S=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(S){let _=this._bufferService.cols-S.start;v-=_,b+=_}}}if(n&&v+b===this._bufferService.cols&&s.getCodePoint(this._bufferService.cols-1)!==32){let y=a.lines.get(e[1]+1);if(y?.isWrapped&&y.getCodePoint(0)!==32){let S=this._getWordAt([0,e[1]+1],!1,!1,!0);S&&(b+=S.length)}}return{start:v,length:b}}}_selectWordAt(e,t){let r=this._getWordAt(e,t);if(r){for(;r.start<0;)r.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[r.start,e[1]],this._model.selectionStartLength=r.length}}_selectToWordAt(e){let t=this._getWordAt(e,!0);if(t){let r=e[1];for(;t.start<0;)t.start+=this._bufferService.cols,r--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,r++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,r]}}_isCharWordSeparator(e){return e.getWidth()===0?!1:this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}_selectLineAt(e){let t=this._bufferService.buffer.getWrappedRangeForLine(e),r={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=$Z(r,this._bufferService.cols)}};MP=Zn([mt(3,Us),mt(4,am),mt(5,yB),mt(6,Hs),mt(7,bu),mt(8,vu)],MP);var FZ=class{constructor(){this._data={}}set(e,t,r){this._data[e]||(this._data[e]={}),this._data[e][t]=r}get(e,t){return this._data[e]?this._data[e][t]:void 0}clear(){this._data={}}},UZ=class{constructor(){this._color=new FZ,this._css=new FZ}setCss(e,t,r){this._css.set(e,t,r)}getCss(e,t){return this._css.get(e,t)}setColor(e,t,r){this._color.set(e,t,r)}getColor(e,t){return this._color.get(e,t)}clear(){this._color.clear(),this._css.clear()}},Sa=Object.freeze((()=>{let e=[zn.toColor("#2e3436"),zn.toColor("#cc0000"),zn.toColor("#4e9a06"),zn.toColor("#c4a000"),zn.toColor("#3465a4"),zn.toColor("#75507b"),zn.toColor("#06989a"),zn.toColor("#d3d7cf"),zn.toColor("#555753"),zn.toColor("#ef2929"),zn.toColor("#8ae234"),zn.toColor("#fce94f"),zn.toColor("#729fcf"),zn.toColor("#ad7fa8"),zn.toColor("#34e2e2"),zn.toColor("#eeeeec")],t=[0,95,135,175,215,255];for(let r=0;r<216;r++){let n=t[r/36%6|0],a=t[r/6%6|0],s=t[r%6];e.push({css:ha.toCss(n,a,s),rgba:ha.toRgba(n,a,s)})}for(let r=0;r<24;r++){let n=8+r*10;e.push({css:ha.toCss(n,n,n),rgba:ha.toRgba(n,n,n)})}return e})()),Bf=zn.toColor("#ffffff"),yb=zn.toColor("#000000"),HZ=zn.toColor("#ffffff"),qZ=yb,Iv={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117},RYe=Bf,TP=class extends gr{constructor(e){super(),this._optionsService=e,this._contrastCache=new UZ,this._halfContrastCache=new UZ,this._onChangeColors=this._register(new rt),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:Bf,background:yb,cursor:HZ,cursorAccent:qZ,selectionForeground:void 0,selectionBackgroundTransparent:Iv,selectionBackgroundOpaque:kn.blend(yb,Iv),selectionInactiveBackgroundTransparent:Iv,selectionInactiveBackgroundOpaque:kn.blend(yb,Iv),scrollbarSliderBackground:kn.opacity(Bf,.2),scrollbarSliderHoverBackground:kn.opacity(Bf,.4),scrollbarSliderActiveBackground:kn.opacity(Bf,.5),overviewRulerBorder:Bf,ansi:Sa.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this._register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this._register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(e={}){let t=this._colors;if(t.foreground=ln(e.foreground,Bf),t.background=ln(e.background,yb),t.cursor=kn.blend(t.background,ln(e.cursor,HZ)),t.cursorAccent=kn.blend(t.background,ln(e.cursorAccent,qZ)),t.selectionBackgroundTransparent=ln(e.selectionBackground,Iv),t.selectionBackgroundOpaque=kn.blend(t.background,t.selectionBackgroundTransparent),t.selectionInactiveBackgroundTransparent=ln(e.selectionInactiveBackground,t.selectionBackgroundTransparent),t.selectionInactiveBackgroundOpaque=kn.blend(t.background,t.selectionInactiveBackgroundTransparent),t.selectionForeground=e.selectionForeground?ln(e.selectionForeground,PZ):void 0,t.selectionForeground===PZ&&(t.selectionForeground=void 0),kn.isOpaque(t.selectionBackgroundTransparent)&&(t.selectionBackgroundTransparent=kn.opacity(t.selectionBackgroundTransparent,.3)),kn.isOpaque(t.selectionInactiveBackgroundTransparent)&&(t.selectionInactiveBackgroundTransparent=kn.opacity(t.selectionInactiveBackgroundTransparent,.3)),t.scrollbarSliderBackground=ln(e.scrollbarSliderBackground,kn.opacity(t.foreground,.2)),t.scrollbarSliderHoverBackground=ln(e.scrollbarSliderHoverBackground,kn.opacity(t.foreground,.4)),t.scrollbarSliderActiveBackground=ln(e.scrollbarSliderActiveBackground,kn.opacity(t.foreground,.5)),t.overviewRulerBorder=ln(e.overviewRulerBorder,RYe),t.ansi=Sa.slice(),t.ansi[0]=ln(e.black,Sa[0]),t.ansi[1]=ln(e.red,Sa[1]),t.ansi[2]=ln(e.green,Sa[2]),t.ansi[3]=ln(e.yellow,Sa[3]),t.ansi[4]=ln(e.blue,Sa[4]),t.ansi[5]=ln(e.magenta,Sa[5]),t.ansi[6]=ln(e.cyan,Sa[6]),t.ansi[7]=ln(e.white,Sa[7]),t.ansi[8]=ln(e.brightBlack,Sa[8]),t.ansi[9]=ln(e.brightRed,Sa[9]),t.ansi[10]=ln(e.brightGreen,Sa[10]),t.ansi[11]=ln(e.brightYellow,Sa[11]),t.ansi[12]=ln(e.brightBlue,Sa[12]),t.ansi[13]=ln(e.brightMagenta,Sa[13]),t.ansi[14]=ln(e.brightCyan,Sa[14]),t.ansi[15]=ln(e.brightWhite,Sa[15]),e.extendedAnsi){let r=Math.min(t.ansi.length-16,e.extendedAnsi.length);for(let n=0;n<r;n++)t.ansi[n+16]=ln(e.extendedAnsi[n],Sa[n+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}_restoreColor(e){if(e===void 0){for(let t=0;t<this._restoreColors.ansi.length;++t)this._colors.ansi[t]=this._restoreColors.ansi[t];return}switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}}modifyColors(e){e(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};TP=Zn([mt(0,Hs)],TP);function ln(e,t){if(e!==void 0)try{return zn.toColor(e)}catch{}return t}var PYe=class{constructor(...e){this._entries=new Map;for(let[t,r]of e)this.set(t,r)}set(e,t){let r=this._entries.get(e);return this._entries.set(e,t),r}forEach(e){for(let[t,r]of this._entries.entries())e(t,r)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}},zYe=class{constructor(){this._services=new PYe,this._services.set(bB,this)}setService(e,t){this._services.set(e,t)}getService(e){return this._services.get(e)}createInstance(e,...t){let r=AGe(e).sort((s,i)=>s.index-i.index),n=[];for(let s of r){let i=this._services.get(s.id);if(!i)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${s.id._id}.`);n.push(i)}let a=r.length>0?r[0].index:t.length;if(t.length!==a)throw new Error(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${t.length} static arguments`);return new e(...t,...n)}},BYe={trace:0,debug:1,info:2,warn:3,error:4,off:5},$Ye="xterm.js: ",AP=class extends gr{constructor(e){super(),this._optionsService=e,this._logLevel=5,this._updateLogLevel(),this._register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}get logLevel(){return this._logLevel}_updateLogLevel(){this._logLevel=BYe[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let t=0;t<e.length;t++)typeof e[t]=="function"&&(e[t]=e[t]())}_log(e,t,r){this._evalLazyOptionalParams(r),e.call(console,(this._optionsService.options.logger?"":$Ye)+t,...r)}trace(e,...t){this._logLevel<=0&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,e,t)}debug(e,...t){this._logLevel<=1&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,e,t)}info(e,...t){this._logLevel<=2&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,e,t)}warn(e,...t){this._logLevel<=3&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,e,t)}error(e,...t){this._logLevel<=4&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,e,t)}};AP=Zn([mt(0,Hs)],AP);var WZ=class extends gr{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this._register(new rt),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this._register(new rt),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this._register(new rt),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;let t=new Array(e);for(let r=0;r<Math.min(e,this.length);r++)t[r]=this._array[this._getCyclicIndex(r)];this._array=t,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,t){this._array[this._getCyclicIndex(e)]=t}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,t,...r){if(t){for(let n=e;n<this._length-t;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(let n=this._length-1;n>=e;n--)this._array[this._getCyclicIndex(n+r.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<r.length;n++)this._array[this._getCyclicIndex(e+n)]=r[n];if(r.length&&this.onInsertEmitter.fire({index:e,amount:r.length}),this._length+r.length>this._maxLength){let n=this._length+r.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=r.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,t,r){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+r<0)throw new Error("Cannot shift elements in list beyond index 0");if(r>0){for(let a=t-1;a>=0;a--)this.set(e+a+r,this.get(e+a));let n=e+t+r-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<t;n++)this.set(e+n+r,this.get(e+n))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}},mr=3,fa=Object.freeze(new u1),RS=0,xL=2,xb=class ime{constructor(t,r,n=!1){this.isWrapped=n,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(t*mr);let a=r||So.fromCharData([0,Nhe,1,0]);for(let s=0;s<t;++s)this.setCell(s,a);this.length=t}get(t){let r=this._data[t*mr+0],n=r&2097151;return[this._data[t*mr+1],r&2097152?this._combined[t]:n?ld(n):"",r>>22,r&2097152?this._combined[t].charCodeAt(this._combined[t].length-1):n]}set(t,r){this._data[t*mr+1]=r[0],r[1].length>1?(this._combined[t]=r[1],this._data[t*mr+0]=t|2097152|r[2]<<22):this._data[t*mr+0]=r[1].charCodeAt(0)|r[2]<<22}getWidth(t){return this._data[t*mr+0]>>22}hasWidth(t){return this._data[t*mr+0]&12582912}getFg(t){return this._data[t*mr+1]}getBg(t){return this._data[t*mr+2]}hasContent(t){return this._data[t*mr+0]&4194303}getCodePoint(t){let r=this._data[t*mr+0];return r&2097152?this._combined[t].charCodeAt(this._combined[t].length-1):r&2097151}isCombined(t){return this._data[t*mr+0]&2097152}getString(t){let r=this._data[t*mr+0];return r&2097152?this._combined[t]:r&2097151?ld(r&2097151):""}isProtected(t){return this._data[t*mr+2]&536870912}loadCell(t,r){return RS=t*mr,r.content=this._data[RS+0],r.fg=this._data[RS+1],r.bg=this._data[RS+2],r.content&2097152&&(r.combinedData=this._combined[t]),r.bg&268435456&&(r.extended=this._extendedAttrs[t]),r}setCell(t,r){r.content&2097152&&(this._combined[t]=r.combinedData),r.bg&268435456&&(this._extendedAttrs[t]=r.extended),this._data[t*mr+0]=r.content,this._data[t*mr+1]=r.fg,this._data[t*mr+2]=r.bg}setCellFromCodepoint(t,r,n,a){a.bg&268435456&&(this._extendedAttrs[t]=a.extended),this._data[t*mr+0]=r|n<<22,this._data[t*mr+1]=a.fg,this._data[t*mr+2]=a.bg}addCodepointToCell(t,r,n){let a=this._data[t*mr+0];a&2097152?this._combined[t]+=ld(r):a&2097151?(this._combined[t]=ld(a&2097151)+ld(r),a&=-2097152,a|=2097152):a=r|1<<22,n&&(a&=-12582913,a|=n<<22),this._data[t*mr+0]=a}insertCells(t,r,n){if(t%=this.length,t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,n),r<this.length-t){let a=new So;for(let s=this.length-t-r-1;s>=0;--s)this.setCell(t+r+s,this.loadCell(t+s,a));for(let s=0;s<r;++s)this.setCell(t+s,n)}else for(let a=t;a<this.length;++a)this.setCell(a,n);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,n)}deleteCells(t,r,n){if(t%=this.length,r<this.length-t){let a=new So;for(let s=0;s<this.length-t-r;++s)this.setCell(t+s,this.loadCell(t+r+s,a));for(let s=this.length-r;s<this.length;++s)this.setCell(s,n)}else for(let a=t;a<this.length;++a)this.setCell(a,n);t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,n),this.getWidth(t)===0&&!this.hasContent(t)&&this.setCellFromCodepoint(t,0,1,n)}replaceCells(t,r,n,a=!1){if(a){for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodepoint(t-1,0,1,n),r<this.length&&this.getWidth(r-1)===2&&!this.isProtected(r)&&this.setCellFromCodepoint(r,0,1,n);t<r&&t<this.length;)this.isProtected(t)||this.setCell(t,n),t++;return}for(t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,n),r<this.length&&this.getWidth(r-1)===2&&this.setCellFromCodepoint(r,0,1,n);t<r&&t<this.length;)this.setCell(t++,n)}resize(t,r){if(t===this.length)return this._data.length*4*xL<this._data.buffer.byteLength;let n=t*mr;if(t>this.length){if(this._data.buffer.byteLength>=n*4)this._data=new Uint32Array(this._data.buffer,0,n);else{let a=new Uint32Array(n);a.set(this._data),this._data=a}for(let a=this.length;a<t;++a)this.setCell(a,r)}else{this._data=this._data.subarray(0,n);let a=Object.keys(this._combined);for(let i=0;i<a.length;i++){let l=parseInt(a[i],10);l>=t&&delete this._combined[l]}let s=Object.keys(this._extendedAttrs);for(let i=0;i<s.length;i++){let l=parseInt(s[i],10);l>=t&&delete this._extendedAttrs[l]}}return this.length=t,n*4*xL<this._data.buffer.byteLength}cleanupMemory(){if(this._data.length*4*xL<this._data.buffer.byteLength){let t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,r=!1){if(r){for(let n=0;n<this.length;++n)this.isProtected(n)||this.setCell(n,t);return}this._combined={},this._extendedAttrs={};for(let n=0;n<this.length;++n)this.setCell(n,t)}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(let r in t._combined)this._combined[r]=t._combined[r];this._extendedAttrs={};for(let r in t._extendedAttrs)this._extendedAttrs[r]=t._extendedAttrs[r];this.isWrapped=t.isWrapped}clone(){let t=new ime(0);t._data=new Uint32Array(this._data),t.length=this.length;for(let r in this._combined)t._combined[r]=this._combined[r];for(let r in this._extendedAttrs)t._extendedAttrs[r]=this._extendedAttrs[r];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(this._data[t*mr+0]&4194303)return t+(this._data[t*mr+0]>>22);return 0}getNoBgTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(this._data[t*mr+0]&4194303||this._data[t*mr+2]&50331648)return t+(this._data[t*mr+0]>>22);return 0}copyCellsFrom(t,r,n,a,s){let i=t._data;if(s)for(let c=a-1;c>=0;c--){for(let u=0;u<mr;u++)this._data[(n+c)*mr+u]=i[(r+c)*mr+u];i[(r+c)*mr+2]&268435456&&(this._extendedAttrs[n+c]=t._extendedAttrs[r+c])}else for(let c=0;c<a;c++){for(let u=0;u<mr;u++)this._data[(n+c)*mr+u]=i[(r+c)*mr+u];i[(r+c)*mr+2]&268435456&&(this._extendedAttrs[n+c]=t._extendedAttrs[r+c])}let l=Object.keys(t._combined);for(let c=0;c<l.length;c++){let u=parseInt(l[c],10);u>=r&&(this._combined[u-r+n]=t._combined[u])}}translateToString(t,r,n,a){r=r??0,n=n??this.length,t&&(n=Math.min(n,this.getTrimmedLength())),a&&(a.length=0);let s="";for(;r<n;){let i=this._data[r*mr+0],l=i&2097151,c=i&2097152?this._combined[r]:l?ld(l):wd;if(s+=c,a)for(let u=0;u<c.length;++u)a.push(r);r+=i>>22||1}return a&&a.push(r),s}};function FYe(e,t,r,n,a,s){let i=[];for(let l=0;l<e.length-1;l++){let c=l,u=e.get(++c);if(!u.isWrapped)continue;let d=[e.get(l)];for(;c<e.length&&u.isWrapped;)d.push(u),u=e.get(++c);if(!s&&n>=l&&n<c){l+=d.length-1;continue}let f=0,m=cx(d,f,t),p=1,v=0;for(;p<d.length;){let y=cx(d,p,t),S=y-v,_=r-m,N=Math.min(S,_);d[f].copyCellsFrom(d[p],v,m,N,!1),m+=N,m===r&&(f++,m=0),v+=N,v===y&&(p++,v=0),m===0&&f!==0&&d[f-1].getWidth(r-1)===2&&(d[f].copyCellsFrom(d[f-1],r-1,m++,1,!1),d[f-1].setCell(r-1,a))}d[f].replaceCells(m,r,a);let b=0;for(let y=d.length-1;y>0&&(y>f||d[y].getTrimmedLength()===0);y--)b++;b>0&&(i.push(l+d.length-b),i.push(b)),l+=d.length-1}return i}function UYe(e,t){let r=[],n=0,a=t[n],s=0;for(let i=0;i<e.length;i++)if(a===i){let l=t[++n];e.onDeleteEmitter.fire({index:i-s,amount:l}),i+=l-1,s+=l,a=t[++n]}else r.push(i);return{layout:r,countRemoved:s}}function HYe(e,t){let r=[];for(let n=0;n<t.length;n++)r.push(e.get(t[n]));for(let n=0;n<r.length;n++)e.set(n,r[n]);e.length=t.length}function qYe(e,t,r){let n=[],a=e.map((c,u)=>cx(e,u,t)).reduce((c,u)=>c+u),s=0,i=0,l=0;for(;l<a;){if(a-l<r){n.push(a-l);break}s+=r;let c=cx(e,i,t);s>c&&(s-=c,i++);let u=e[i].getWidth(s-1)===2;u&&s--;let d=u?r-1:r;n.push(d),l+=d}return n}function cx(e,t,r){if(t===e.length-1)return e[t].getTrimmedLength();let n=!e[t].hasContent(r-1)&&e[t].getWidth(r-1)===1,a=e[t+1].getWidth(0)===2;return n&&a?r-1:r}var ome=class lme{constructor(t){this.line=t,this.isDisposed=!1,this._disposables=[],this._id=lme._nextId++,this._onDispose=this.register(new rt),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),Dh(this._disposables),this._disposables.length=0)}register(t){return this._disposables.push(t),t}};ome._nextId=1;var WYe=ome,Ea={},$f=Ea.B;Ea[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""};Ea.A={"#":""};Ea.B=void 0;Ea[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""};Ea.C=Ea[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};Ea.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};Ea.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""};Ea.E=Ea[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""};Ea.H=Ea[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Ea["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""};var KZ=4294967295,GZ=class{constructor(e,t,r){this._hasScrollback=e,this._optionsService=t,this._bufferService=r,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=fa.clone(),this.savedCharset=$f,this.markers=[],this._nullCell=So.fromCharData([0,Nhe,1,0]),this._whitespaceCell=So.fromCharData([0,wd,1,32]),this._isClearing=!1,this._memoryCleanupQueue=new lC,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new WZ(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new aC),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new aC),this._whitespaceCell}getBlankLine(e,t){return new xb(this._bufferService.cols,this.getNullCell(e),t)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;let t=e+this._optionsService.rawOptions.scrollback;return t>KZ?KZ:t}fillViewportRows(e){if(this.lines.length===0){e===void 0&&(e=fa);let t=this._rows;for(;t--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new WZ(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,t){let r=this.getNullCell(fa),n=0,a=this._getCorrectBufferLength(t);if(a>this.lines.maxLength&&(this.lines.maxLength=a),this.lines.length>0){if(this._cols<e)for(let i=0;i<this.lines.length;i++)n+=+this.lines.get(i).resize(e,r);let s=0;if(this._rows<t)for(let i=this._rows;i<t;i++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new xb(e,r)):this.ybase>0&&this.lines.length<=this.ybase+this.y+s+1?(this.ybase--,s++,this.ydisp>0&&this.ydisp--):this.lines.push(new xb(e,r)));else for(let i=this._rows;i>t;i--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(a<this.lines.maxLength){let i=this.lines.length-a;i>0&&(this.lines.trimStart(i),this.ybase=Math.max(this.ybase-i,0),this.ydisp=Math.max(this.ydisp-i,0),this.savedY=Math.max(this.savedY-i,0)),this.lines.maxLength=a}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),s&&(this.y+=s),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(let s=0;s<this.lines.length;s++)n+=+this.lines.get(s).resize(e,r);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),n>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let t=0;for(;this._memoryCleanupPosition<this.lines.length;)if(t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),t>100)return!0;return e}get _isReflowEnabled(){let e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&e.backend==="conpty"&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}_reflowLarger(e,t){let r=this._optionsService.rawOptions.reflowCursorLine,n=FYe(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(fa),r);if(n.length>0){let a=UYe(this.lines,n);HYe(this.lines,a.layout),this._reflowLargerAdjustViewport(e,t,a.countRemoved)}}_reflowLargerAdjustViewport(e,t,r){let n=this.getNullCell(fa),a=r;for(;a-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new xb(e,n))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-r,0)}_reflowSmaller(e,t){let r=this._optionsService.rawOptions.reflowCursorLine,n=this.getNullCell(fa),a=[],s=0;for(let i=this.lines.length-1;i>=0;i--){let l=this.lines.get(i);if(!l||!l.isWrapped&&l.getTrimmedLength()<=e)continue;let c=[l];for(;l.isWrapped&&i>0;)l=this.lines.get(--i),c.unshift(l);if(!r){let N=this.ybase+this.y;if(N>=i&&N<i+c.length)continue}let u=c[c.length-1].getTrimmedLength(),d=qYe(c,this._cols,e),f=d.length-c.length,m;this.ybase===0&&this.y!==this.lines.length-1?m=Math.max(0,this.y-this.lines.maxLength+f):m=Math.max(0,this.lines.length-this.lines.maxLength+f);let p=[];for(let N=0;N<f;N++){let k=this.getBlankLine(fa,!0);p.push(k)}p.length>0&&(a.push({start:i+c.length+s,newLines:p}),s+=p.length),c.push(...p);let v=d.length-1,b=d[v];b===0&&(v--,b=d[v]);let y=c.length-f-1,S=u;for(;y>=0;){let N=Math.min(S,b);if(c[v]===void 0)break;if(c[v].copyCellsFrom(c[y],S-N,b-N,N,!0),b-=N,b===0&&(v--,b=d[v]),S-=N,S===0){y--;let k=Math.max(y,0);S=cx(c,k,this._cols)}}for(let N=0;N<c.length;N++)d[N]<e&&c[N].setCell(d[N],n);let _=f-m;for(;_-- >0;)this.ybase===0?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+s)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+f,this.ybase+t-1)}if(a.length>0){let i=[],l=[];for(let b=0;b<this.lines.length;b++)l.push(this.lines.get(b));let c=this.lines.length,u=c-1,d=0,f=a[d];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+s);let m=0;for(let b=Math.min(this.lines.maxLength-1,c+s-1);b>=0;b--)if(f&&f.start>u+m){for(let y=f.newLines.length-1;y>=0;y--)this.lines.set(b--,f.newLines[y]);b++,i.push({index:u+1,amount:f.newLines.length}),m+=f.newLines.length,f=a[++d]}else this.lines.set(b,l[u--]);let p=0;for(let b=i.length-1;b>=0;b--)i[b].index+=p,this.lines.onInsertEmitter.fire(i[b]),p+=i[b].amount;let v=Math.max(0,c+s-this.lines.maxLength);v>0&&this.lines.onTrimEmitter.fire(v)}}translateBufferLineToString(e,t,r=0,n){let a=this.lines.get(e);return a?a.translateToString(t,r,n):""}getWrappedRangeForLine(e){let t=e,r=e;for(;t>0&&this.lines.get(t).isWrapped;)t--;for(;r+1<this.lines.length&&this.lines.get(r+1).isWrapped;)r++;return{first:t,last:r}}setupTabStops(e){for(e!=null?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(e==null&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(e==null&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose();this.markers.length=0,this._isClearing=!1}addMarker(e){let t=new WYe(e);return this.markers.push(t),t.register(this.lines.onTrim(r=>{t.line-=r,t.line<0&&t.dispose()})),t.register(this.lines.onInsert(r=>{t.line>=r.index&&(t.line+=r.amount)})),t.register(this.lines.onDelete(r=>{t.line>=r.index&&t.line<r.index+r.amount&&t.dispose(),t.line>r.index&&(t.line-=r.amount)})),t.register(t.onDispose(()=>this._removeMarker(t))),t}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}},KYe=class extends gr{constructor(e,t){super(),this._optionsService=e,this._bufferService=t,this._onBufferActivate=this._register(new rt),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this._register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this._register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new GZ(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new GZ(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}setupTabStops(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}},cme=2,ume=1,DP=class extends gr{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this._register(new rt),this.onResize=this._onResize.event,this._onScroll=this._register(new rt),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,cme),this.rows=Math.max(e.rawOptions.rows||0,ume),this.buffers=this._register(new KYe(e,this)),this._register(this.buffers.onBufferActivate(t=>{this._onScroll.fire(t.activeBuffer.ydisp)}))}get buffer(){return this.buffers.active}resize(e,t){let r=this.cols!==e,n=this.rows!==t;this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t,colsChanged:r,rowsChanged:n})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,t=!1){let r=this.buffer,n;n=this._cachedBlankLine,(!n||n.length!==this.cols||n.getFg(0)!==e.fg||n.getBg(0)!==e.bg)&&(n=r.getBlankLine(e,t),this._cachedBlankLine=n),n.isWrapped=t;let a=r.ybase+r.scrollTop,s=r.ybase+r.scrollBottom;if(r.scrollTop===0){let i=r.lines.isFull;s===r.lines.length-1?i?r.lines.recycle().copyFrom(n):r.lines.push(n.clone()):r.lines.splice(s+1,0,n.clone()),i?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{let i=s-a+1;r.lines.shiftElements(a+1,i-1,-1),r.lines.set(s,n.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}scrollLines(e,t){let r=this.buffer;if(e<0){if(r.ydisp===0)return;this.isUserScrolling=!0}else e+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);let n=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+e,r.ybase),0),n!==r.ydisp&&(t||this._onScroll.fire(r.ydisp))}};DP=Zn([mt(0,Hs)],DP);var rp={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnEraseInDisplay:!1,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},reflowCursorLine:!1,rescaleOverlappingGlyphs:!1,rightClickSelectsWord:oC,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRuler:{}},GYe=["normal","bold","100","200","300","400","500","600","700","800","900"],VYe=class extends gr{constructor(e){super(),this._onOptionChange=this._register(new rt),this.onOptionChange=this._onOptionChange.event;let t={...rp};for(let r in e)if(r in t)try{let n=e[r];t[r]=this._sanitizeAndValidateOption(r,n)}catch(n){console.error(n)}this.rawOptions=t,this.options={...t},this._setupOptions(),this._register(Mn(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(e,t){return this.onOptionChange(r=>{r===e&&t(this.rawOptions[e])})}onMultipleOptionChange(e,t){return this.onOptionChange(r=>{e.indexOf(r)!==-1&&t()})}_setupOptions(){let e=r=>{if(!(r in rp))throw new Error(`No option with key "${r}"`);return this.rawOptions[r]},t=(r,n)=>{if(!(r in rp))throw new Error(`No option with key "${r}"`);n=this._sanitizeAndValidateOption(r,n),this.rawOptions[r]!==n&&(this.rawOptions[r]=n,this._onOptionChange.fire(r))};for(let r in this.rawOptions){let n={get:e.bind(this,r),set:t.bind(this,r)};Object.defineProperty(this.options,r,n)}}_sanitizeAndValidateOption(e,t){switch(e){case"cursorStyle":if(t||(t=rp[e]),!YYe(t))throw new Error(`"${t}" is not a valid value for ${e}`);break;case"wordSeparator":t||(t=rp[e]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=GYe.includes(t)?t:rp[e];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${e} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(t*10)/10));break;case"scrollback":if(t=Math.min(t,4294967295),t<0)throw new Error(`${e} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${e} cannot be less than or equal to 0, value: ${t}`);break;case"rows":case"cols":if(!t&&t!==0)throw new Error(`${e} must be numeric, value: ${t}`);break;case"windowsPty":t=t??{};break}return t}};function YYe(e){return e==="block"||e==="underline"||e==="bar"}function wb(e,t=5){if(typeof e!="object")return e;let r=Array.isArray(e)?[]:{};for(let n in e)r[n]=t<=1?e[n]:e[n]&&wb(e[n],t-1);return r}var VZ=Object.freeze({insertMode:!1}),YZ=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,cursorBlink:void 0,cursorStyle:void 0,origin:!1,reverseWraparound:!1,sendFocus:!1,synchronizedOutput:!1,wraparound:!0}),LP=class extends gr{constructor(e,t,r){super(),this._bufferService=e,this._logService=t,this._optionsService=r,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this._register(new rt),this.onData=this._onData.event,this._onUserInput=this._register(new rt),this.onUserInput=this._onUserInput.event,this._onBinary=this._register(new rt),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this._register(new rt),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=wb(VZ),this.decPrivateModes=wb(YZ)}reset(){this.modes=wb(VZ),this.decPrivateModes=wb(YZ)}triggerDataEvent(e,t=!1){if(this._optionsService.rawOptions.disableStdin)return;let r=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&r.ybase!==r.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`),this._logService.trace("sending data (codes)",()=>e.split("").map(n=>n.charCodeAt(0))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`),this._logService.trace("sending binary (codes)",()=>e.split("").map(t=>t.charCodeAt(0))),this._onBinary.fire(e))}};LP=Zn([mt(0,Us),mt(1,The),mt(2,Hs)],LP);var QZ={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>e.button===4||e.action!==1?!1:(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>e.action!==32},DRAG:{events:23,restrict:e=>!(e.action===32&&e.button===3)},ANY:{events:31,restrict:e=>!0}};function wL(e,t){let r=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return e.button===4?(r|=64,r|=e.action):(r|=e.button&3,e.button&4&&(r|=64),e.button&8&&(r|=128),e.action===32?r|=32:e.action===0&&!t&&(r|=3)),r}var SL=String.fromCharCode,JZ={DEFAULT:e=>{let t=[wL(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":`\x1B[M${SL(t[0])}${SL(t[1])}${SL(t[2])}`},SGR:e=>{let t=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${wL(e,!0)};${e.col};${e.row}${t}`},SGR_PIXELS:e=>{let t=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${wL(e,!0)};${e.x};${e.y}${t}`}},OP=class extends gr{constructor(e,t,r){super(),this._bufferService=e,this._coreService=t,this._optionsService=r,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._wheelPartialScroll=0,this._onProtocolChange=this._register(new rt),this.onProtocolChange=this._onProtocolChange.event;for(let n of Object.keys(QZ))this.addProtocol(n,QZ[n]);for(let n of Object.keys(JZ))this.addEncoding(n,JZ[n]);this.reset()}addProtocol(e,t){this._protocols[e]=t}addEncoding(e,t){this._encodings[e]=t}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null,this._wheelPartialScroll=0}consumeWheelEvent(e,t,r){if(e.deltaY===0||e.shiftKey||t===void 0||r===void 0)return 0;let n=t/r,a=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(a/=n+0,Math.abs(e.deltaY)<50&&(a*=.3),this._wheelPartialScroll+=a,a=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(a*=this._bufferService.rows),a}_applyScrollModifier(e,t){return t.altKey||t.ctrlKey||t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows||e.button===4&&e.action===32||e.button===3&&e.action!==32||e.button!==4&&(e.action===2||e.action===3)||(e.col++,e.row++,e.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,e,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(e))return!1;let t=this._encodings[this._activeEncoding](e);return t&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(e&1),up:!!(e&2),drag:!!(e&4),move:!!(e&8),wheel:!!(e&16)}}_equalEvents(e,t,r){if(r){if(e.x!==t.x||e.y!==t.y)return!1}else if(e.col!==t.col||e.row!==t.row)return!1;return!(e.button!==t.button||e.action!==t.action||e.ctrl!==t.ctrl||e.alt!==t.alt||e.shift!==t.shift)}};OP=Zn([mt(0,Us),mt(1,am),mt(2,Hs)],OP);var kL=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],QYe=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],ka;function JYe(e,t){let r=0,n=t.length-1,a;if(e<t[0][0]||e>t[n][1])return!1;for(;n>=r;)if(a=r+n>>1,e>t[a][1])r=a+1;else if(e<t[a][0])n=a-1;else return!0;return!1}var ZYe=class{constructor(){if(this.version="6",!ka){ka=new Uint8Array(65536),ka.fill(1),ka[0]=0,ka.fill(0,1,32),ka.fill(0,127,160),ka.fill(2,4352,4448),ka[9001]=2,ka[9002]=2,ka.fill(2,11904,42192),ka[12351]=1,ka.fill(2,44032,55204),ka.fill(2,63744,64256),ka.fill(2,65040,65050),ka.fill(2,65072,65136),ka.fill(2,65280,65377),ka.fill(2,65504,65511);for(let e=0;e<kL.length;++e)ka.fill(0,kL[e][0],kL[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?ka[e]:JYe(e,QYe)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,t){let r=this.wcwidth(e),n=r===0&&t!==0;if(n){let a=Xf.extractWidth(t);a===0?n=!1:a>r&&(r=a)}return Xf.createPropertyValue(0,r,n)}},Xf=class Ak{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new rt,this.onChange=this._onChange.event;let t=new ZYe;this.register(t),this._active=t.version,this._activeProvider=t}static extractShouldJoin(t){return(t&1)!==0}static extractWidth(t){return t>>1&3}static extractCharKind(t){return t>>3}static createPropertyValue(t,r,n=!1){return(t&16777215)<<3|(r&3)<<1|(n?1:0)}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(t){if(!this._providers[t])throw new Error(`unknown Unicode version "${t}"`);this._active=t,this._activeProvider=this._providers[t],this._onChange.fire(t)}register(t){this._providers[t.version]=t}wcwidth(t){return this._activeProvider.wcwidth(t)}getStringCellWidth(t){let r=0,n=0,a=t.length;for(let s=0;s<a;++s){let i=t.charCodeAt(s);if(55296<=i&&i<=56319){if(++s>=a)return r+this.wcwidth(i);let u=t.charCodeAt(s);56320<=u&&u<=57343?i=(i-55296)*1024+u-56320+65536:r+=this.wcwidth(u)}let l=this.charProperties(i,n),c=Ak.extractWidth(l);Ak.extractShouldJoin(l)&&(c-=Ak.extractWidth(n)),r+=c,n=l}return r}charProperties(t,r){return this._activeProvider.charProperties(t,r)}},XYe=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(e){this.glevel=e,this.charset=this._charsets[e]}setgCharset(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}};function ZZ(e){let t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1)?.get(e.cols-1),r=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);r&&t&&(r.isWrapped=t[3]!==0&&t[3]!==32)}var Rv=2147483647,eQe=256,dme=class IP{constructor(t=32,r=32){if(this.maxLength=t,this.maxSubParamsLength=r,r>eQe)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(t),this.length=0,this._subParams=new Int32Array(r),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(t),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(t){let r=new IP;if(!t.length)return r;for(let n=Array.isArray(t[0])?1:0;n<t.length;++n){let a=t[n];if(Array.isArray(a))for(let s=0;s<a.length;++s)r.addSubParam(a[s]);else r.addParam(a)}return r}clone(){let t=new IP(this.maxLength,this.maxSubParamsLength);return t.params.set(this.params),t.length=this.length,t._subParams.set(this._subParams),t._subParamsLength=this._subParamsLength,t._subParamsIdx.set(this._subParamsIdx),t._rejectDigits=this._rejectDigits,t._rejectSubDigits=this._rejectSubDigits,t._digitIsSub=this._digitIsSub,t}toArray(){let t=[];for(let r=0;r<this.length;++r){t.push(this.params[r]);let n=this._subParamsIdx[r]>>8,a=this._subParamsIdx[r]&255;a-n>0&&t.push(Array.prototype.slice.call(this._subParams,n,a))}return t}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(t){if(this._digitIsSub=!1,this.length>=this.maxLength){this._rejectDigits=!0;return}if(t<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=t>Rv?Rv:t}addSubParam(t){if(this._digitIsSub=!0,!!this.length){if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength){this._rejectSubDigits=!0;return}if(t<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=t>Rv?Rv:t,this._subParamsIdx[this.length-1]++}}hasSubParams(t){return(this._subParamsIdx[t]&255)-(this._subParamsIdx[t]>>8)>0}getSubParams(t){let r=this._subParamsIdx[t]>>8,n=this._subParamsIdx[t]&255;return n-r>0?this._subParams.subarray(r,n):null}getSubParamsAll(){let t={};for(let r=0;r<this.length;++r){let n=this._subParamsIdx[r]>>8,a=this._subParamsIdx[r]&255;a-n>0&&(t[r]=this._subParams.slice(n,a))}return t}addDigit(t){let r;if(this._rejectDigits||!(r=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let n=this._digitIsSub?this._subParams:this.params,a=n[r-1];n[r-1]=~a?Math.min(a*10+t,Rv):t}},Pv=[],tQe=class{constructor(){this._state=0,this._active=Pv,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(e,t){this._handlers[e]===void 0&&(this._handlers[e]=[]);let r=this._handlers[e];return r.push(t),{dispose:()=>{let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=Pv}reset(){if(this._state===2)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=Pv,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||Pv,!this._active.length)this._handlerFb(this._id,"START");else for(let e=this._active.length-1;e>=0;e--)this._active[e].start()}_put(e,t,r){if(!this._active.length)this._handlerFb(this._id,"PUT",f2(e,t,r));else for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,r)}start(){this.reset(),this._state=1}put(e,t,r){if(this._state!==3){if(this._state===1)for(;t<r;){let n=e[t++];if(n===59){this._state=2,this._start();break}if(n<48||57<n){this._state=3;return}this._id===-1&&(this._id=0),this._id=this._id*10+n-48}this._state===2&&r-t>0&&this._put(e,t,r)}}end(e,t=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),!this._active.length)this._handlerFb(this._id,"END",e);else{let r=!1,n=this._active.length-1,a=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,r=t,a=this._stack.fallThrough,this._stack.paused=!1),!a&&r===!1){for(;n>=0&&(r=this._active[n].end(e),r!==!0);n--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,r;n--}for(;n>=0;n--)if(r=this._active[n].end(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,r}this._active=Pv,this._id=-1,this._state=0}}},vi=class{constructor(t){this._handler=t,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(t,r,n){this._hitLimit||(this._data+=f2(t,r,n),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}end(t){let r=!1;if(this._hitLimit)r=!1;else if(t&&(r=this._handler(this._data),r instanceof Promise))return r.then(n=>(this._data="",this._hitLimit=!1,n));return this._data="",this._hitLimit=!1,r}},zv=[],rQe=class{constructor(){this._handlers=Object.create(null),this._active=zv,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=zv}registerHandler(e,t){this._handlers[e]===void 0&&(this._handlers[e]=[]);let r=this._handlers[e];return r.push(t),{dispose:()=>{let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}reset(){if(this._active.length)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=zv,this._ident=0}hook(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||zv,!this._active.length)this._handlerFb(this._ident,"HOOK",t);else for(let r=this._active.length-1;r>=0;r--)this._active[r].hook(t)}put(e,t,r){if(!this._active.length)this._handlerFb(this._ident,"PUT",f2(e,t,r));else for(let n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,r)}unhook(e,t=!0){if(!this._active.length)this._handlerFb(this._ident,"UNHOOK",e);else{let r=!1,n=this._active.length-1,a=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,r=t,a=this._stack.fallThrough,this._stack.paused=!1),!a&&r===!1){for(;n>=0&&(r=this._active[n].unhook(e),r!==!0);n--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,r;n--}for(;n>=0;n--)if(r=this._active[n].unhook(!1),r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,r}this._active=zv,this._ident=0}},Sb=new dme;Sb.addParam(0);var XZ=class{constructor(e){this._handler=e,this._data="",this._params=Sb,this._hitLimit=!1}hook(e){this._params=e.length>1||e.params[0]?e.clone():Sb,this._data="",this._hitLimit=!1}put(e,t,r){this._hitLimit||(this._data+=f2(e,t,r),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}unhook(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data,this._params),t instanceof Promise))return t.then(r=>(this._params=Sb,this._data="",this._hitLimit=!1,r));return this._params=Sb,this._data="",this._hitLimit=!1,t}},nQe=class{constructor(e){this.table=new Uint8Array(e)}setDefault(e,t){this.table.fill(e<<4|t)}add(e,t,r,n){this.table[t<<8|e]=r<<4|n}addMany(e,t,r,n){for(let a=0;a<e.length;a++)this.table[t<<8|e[a]]=r<<4|n}},fo=160,aQe=(function(){let e=new nQe(4095),t=Array.apply(null,Array(256)).map((l,c)=>c),r=(l,c)=>t.slice(l,c),n=r(32,127),a=r(0,24);a.push(25),a.push.apply(a,r(28,32));let s=r(0,14),i;e.setDefault(1,0),e.addMany(n,0,2,0);for(i in s)e.addMany([24,26,153,154],i,3,0),e.addMany(r(128,144),i,3,0),e.addMany(r(144,152),i,3,0),e.add(156,i,0,0),e.add(27,i,11,1),e.add(157,i,4,8),e.addMany([152,158,159],i,0,7),e.add(155,i,11,3),e.add(144,i,11,9);return e.addMany(a,0,3,0),e.addMany(a,1,3,1),e.add(127,1,0,1),e.addMany(a,8,0,8),e.addMany(a,3,3,3),e.add(127,3,0,3),e.addMany(a,4,3,4),e.add(127,4,0,4),e.addMany(a,6,3,6),e.addMany(a,5,3,5),e.add(127,5,0,5),e.addMany(a,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(n,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(r(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(n,7,0,7),e.addMany(a,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(r(64,127),3,7,0),e.addMany(r(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(r(48,60),4,8,4),e.addMany(r(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(r(32,64),6,0,6),e.add(127,6,0,6),e.addMany(r(64,127),6,0,0),e.addMany(r(32,48),3,9,5),e.addMany(r(32,48),5,9,5),e.addMany(r(48,64),5,0,6),e.addMany(r(64,127),5,7,0),e.addMany(r(32,48),4,9,5),e.addMany(r(32,48),1,9,2),e.addMany(r(32,48),2,9,2),e.addMany(r(48,127),2,10,0),e.addMany(r(48,80),1,10,0),e.addMany(r(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(r(96,127),1,10,0),e.add(80,1,11,9),e.addMany(a,9,0,9),e.add(127,9,0,9),e.addMany(r(28,32),9,0,9),e.addMany(r(32,48),9,9,12),e.addMany(r(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(a,11,0,11),e.addMany(r(32,128),11,0,11),e.addMany(r(28,32),11,0,11),e.addMany(a,10,0,10),e.add(127,10,0,10),e.addMany(r(28,32),10,0,10),e.addMany(r(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(r(32,48),10,9,12),e.addMany(a,12,0,12),e.add(127,12,0,12),e.addMany(r(28,32),12,0,12),e.addMany(r(32,48),12,9,12),e.addMany(r(48,64),12,0,11),e.addMany(r(64,127),12,12,13),e.addMany(r(64,127),10,12,13),e.addMany(r(64,127),9,12,13),e.addMany(a,13,13,13),e.addMany(n,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(fo,0,2,0),e.add(fo,8,5,8),e.add(fo,6,0,6),e.add(fo,11,0,11),e.add(fo,13,13,13),e})(),sQe=class extends gr{constructor(e=aQe){super(),this._transitions=e,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new dme,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(t,r,n)=>{},this._executeHandlerFb=t=>{},this._csiHandlerFb=(t,r)=>{},this._escHandlerFb=t=>{},this._errorHandlerFb=t=>t,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this._register(Mn(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this._register(new tQe),this._dcsParser=this._register(new rQe),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(e,t=[64,126]){let r=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=e.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let a=0;a<e.intermediates.length;++a){let s=e.intermediates.charCodeAt(a);if(32>s||s>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=s}}if(e.final.length!==1)throw new Error("final must be a single byte");let n=e.final.charCodeAt(0);if(t[0]>n||n>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return r<<=8,r|=n,r}identToString(e){let t=[];for(;e;)t.push(String.fromCharCode(e&255)),e>>=8;return t.reverse().join("")}setPrintHandler(e){this._printHandler=e}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(e,t){let r=this._identifier(e,[48,126]);this._escHandlers[r]===void 0&&(this._escHandlers[r]=[]);let n=this._escHandlers[r];return n.push(t),{dispose:()=>{let a=n.indexOf(t);a!==-1&&n.splice(a,1)}}}clearEscHandler(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}setEscHandlerFallback(e){this._escHandlerFb=e}setExecuteHandler(e,t){this._executeHandlers[e.charCodeAt(0)]=t}clearExecuteHandler(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}setExecuteHandlerFallback(e){this._executeHandlerFb=e}registerCsiHandler(e,t){let r=this._identifier(e);this._csiHandlers[r]===void 0&&(this._csiHandlers[r]=[]);let n=this._csiHandlers[r];return n.push(t),{dispose:()=>{let a=n.indexOf(t);a!==-1&&n.splice(a,1)}}}clearCsiHandler(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}setCsiHandlerFallback(e){this._csiHandlerFb=e}registerDcsHandler(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}clearDcsHandler(e){this._dcsParser.clearHandler(this._identifier(e))}setDcsHandlerFallback(e){this._dcsParser.setHandlerFallback(e)}registerOscHandler(e,t){return this._oscParser.registerHandler(e,t)}clearOscHandler(e){this._oscParser.clearHandler(e)}setOscHandlerFallback(e){this._oscParser.setHandlerFallback(e)}setErrorHandler(e){this._errorHandler=e}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(e,t,r,n,a){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=r,this._parseStack.transition=n,this._parseStack.chunkPos=a}parse(e,t,r){let n=0,a=0,s=0,i;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,s=this._parseStack.chunkPos+1;else{if(r===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let l=this._parseStack.handlers,c=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(r===!1&&c>-1){for(;c>=0&&(i=l[c](this._params),i!==!0);c--)if(i instanceof Promise)return this._parseStack.handlerPos=c,i}this._parseStack.handlers=[];break;case 4:if(r===!1&&c>-1){for(;c>=0&&(i=l[c](),i!==!0);c--)if(i instanceof Promise)return this._parseStack.handlerPos=c,i}this._parseStack.handlers=[];break;case 6:if(n=e[this._parseStack.chunkPos],i=this._dcsParser.unhook(n!==24&&n!==26,r),i)return i;n===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(n=e[this._parseStack.chunkPos],i=this._oscParser.end(n!==24&&n!==26,r),i)return i;n===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break}this._parseStack.state=0,s=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=this._parseStack.transition&15}for(let l=s;l<t;++l){switch(n=e[l],a=this._transitions.table[this.currentState<<8|(n<160?n:fo)],a>>4){case 2:for(let m=l+1;;++m){if(m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}if(++m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}if(++m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}if(++m>=t||(n=e[m])<32||n>126&&n<fo){this._printHandler(e,l,m),l=m-1;break}}break;case 3:this._executeHandlers[n]?this._executeHandlers[n]():this._executeHandlerFb(n),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:l,code:n,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let c=this._csiHandlers[this._collect<<8|n],u=c?c.length-1:-1;for(;u>=0&&(i=c[u](this._params),i!==!0);u--)if(i instanceof Promise)return this._preserveStack(3,c,u,a,l),i;u<0&&this._csiHandlerFb(this._collect<<8|n,this._params),this.precedingJoinState=0;break;case 8:do switch(n){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(n-48)}while(++l<t&&(n=e[l])>47&&n<60);l--;break;case 9:this._collect<<=8,this._collect|=n;break;case 10:let d=this._escHandlers[this._collect<<8|n],f=d?d.length-1:-1;for(;f>=0&&(i=d[f](),i!==!0);f--)if(i instanceof Promise)return this._preserveStack(4,d,f,a,l),i;f<0&&this._escHandlerFb(this._collect<<8|n),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|n,this._params);break;case 13:for(let m=l+1;;++m)if(m>=t||(n=e[m])===24||n===26||n===27||n>127&&n<fo){this._dcsParser.put(e,l,m),l=m-1;break}break;case 14:if(i=this._dcsParser.unhook(n!==24&&n!==26),i)return this._preserveStack(6,[],0,a,l),i;n===27&&(a|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let m=l+1;;m++)if(m>=t||(n=e[m])<32||n>127&&n<fo){this._oscParser.put(e,l,m),l=m-1;break}break;case 6:if(i=this._oscParser.end(n!==24&&n!==26),i)return this._preserveStack(5,[],0,a,l),i;n===27&&(a|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break}this.currentState=a&15}}},iQe=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,oQe=/^[\da-f]+$/;function eX(e){if(!e)return;let t=e.toLowerCase();if(t.indexOf("rgb:")===0){t=t.slice(4);let r=iQe.exec(t);if(r){let n=r[1]?15:r[4]?255:r[7]?4095:65535;return[Math.round(parseInt(r[1]||r[4]||r[7]||r[10],16)/n*255),Math.round(parseInt(r[2]||r[5]||r[8]||r[11],16)/n*255),Math.round(parseInt(r[3]||r[6]||r[9]||r[12],16)/n*255)]}}else if(t.indexOf("#")===0&&(t=t.slice(1),oQe.exec(t)&&[3,6,9,12].includes(t.length))){let r=t.length/3,n=[0,0,0];for(let a=0;a<3;++a){let s=parseInt(t.slice(r*a,r*a+r),16);n[a]=r===1?s<<4:r===2?s:r===3?s>>4:s>>8}return n}}function _L(e,t){let r=e.toString(16),n=r.length<2?"0"+r:r;switch(t){case 4:return r[0];case 8:return n;case 12:return(n+n).slice(0,3);default:return n+n}}function lQe(e,t=16){let[r,n,a]=e;return`rgb:${_L(r,t)}/${_L(n,t)}/${_L(a,t)}`}var cQe={"(":0,")":1,"*":2,"+":3,"-":1,".":2},Ju=131072,tX=10;function rX(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}var nX=5e3,aX=0,uQe=class extends gr{constructor(e,t,r,n,a,s,i,l,c=new sQe){super(),this._bufferService=e,this._charsetService=t,this._coreService=r,this._logService=n,this._optionsService=a,this._oscLinkService=s,this._coreMouseService=i,this._unicodeService=l,this._parser=c,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new MGe,this._utf8Decoder=new TGe,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=fa.clone(),this._eraseAttrDataInternal=fa.clone(),this._onRequestBell=this._register(new rt),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this._register(new rt),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this._register(new rt),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this._register(new rt),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this._register(new rt),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this._register(new rt),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this._register(new rt),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this._register(new rt),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this._register(new rt),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this._register(new rt),this.onLineFeed=this._onLineFeed.event,this._onScroll=this._register(new rt),this.onScroll=this._onScroll.event,this._onTitleChange=this._register(new rt),this.onTitleChange=this._onTitleChange.event,this._onColor=this._register(new rt),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this._register(this._parser),this._dirtyRowTracker=new RP(this._bufferService),this._activeBuffer=this._bufferService.buffer,this._register(this._bufferService.buffers.onBufferActivate(u=>this._activeBuffer=u.activeBuffer)),this._parser.setCsiHandlerFallback((u,d)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(u),params:d.toArray()})}),this._parser.setEscHandlerFallback(u=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(u)})}),this._parser.setExecuteHandlerFallback(u=>{this._logService.debug("Unknown EXECUTE code: ",{code:u})}),this._parser.setOscHandlerFallback((u,d,f)=>{this._logService.debug("Unknown OSC code: ",{identifier:u,action:d,data:f})}),this._parser.setDcsHandlerFallback((u,d,f)=>{d==="HOOK"&&(f=f.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(u),action:d,payload:f})}),this._parser.setPrintHandler((u,d,f)=>this.print(u,d,f)),this._parser.registerCsiHandler({final:"@"},u=>this.insertChars(u)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},u=>this.scrollLeft(u)),this._parser.registerCsiHandler({final:"A"},u=>this.cursorUp(u)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},u=>this.scrollRight(u)),this._parser.registerCsiHandler({final:"B"},u=>this.cursorDown(u)),this._parser.registerCsiHandler({final:"C"},u=>this.cursorForward(u)),this._parser.registerCsiHandler({final:"D"},u=>this.cursorBackward(u)),this._parser.registerCsiHandler({final:"E"},u=>this.cursorNextLine(u)),this._parser.registerCsiHandler({final:"F"},u=>this.cursorPrecedingLine(u)),this._parser.registerCsiHandler({final:"G"},u=>this.cursorCharAbsolute(u)),this._parser.registerCsiHandler({final:"H"},u=>this.cursorPosition(u)),this._parser.registerCsiHandler({final:"I"},u=>this.cursorForwardTab(u)),this._parser.registerCsiHandler({final:"J"},u=>this.eraseInDisplay(u,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},u=>this.eraseInDisplay(u,!0)),this._parser.registerCsiHandler({final:"K"},u=>this.eraseInLine(u,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},u=>this.eraseInLine(u,!0)),this._parser.registerCsiHandler({final:"L"},u=>this.insertLines(u)),this._parser.registerCsiHandler({final:"M"},u=>this.deleteLines(u)),this._parser.registerCsiHandler({final:"P"},u=>this.deleteChars(u)),this._parser.registerCsiHandler({final:"S"},u=>this.scrollUp(u)),this._parser.registerCsiHandler({final:"T"},u=>this.scrollDown(u)),this._parser.registerCsiHandler({final:"X"},u=>this.eraseChars(u)),this._parser.registerCsiHandler({final:"Z"},u=>this.cursorBackwardTab(u)),this._parser.registerCsiHandler({final:"`"},u=>this.charPosAbsolute(u)),this._parser.registerCsiHandler({final:"a"},u=>this.hPositionRelative(u)),this._parser.registerCsiHandler({final:"b"},u=>this.repeatPrecedingCharacter(u)),this._parser.registerCsiHandler({final:"c"},u=>this.sendDeviceAttributesPrimary(u)),this._parser.registerCsiHandler({prefix:">",final:"c"},u=>this.sendDeviceAttributesSecondary(u)),this._parser.registerCsiHandler({final:"d"},u=>this.linePosAbsolute(u)),this._parser.registerCsiHandler({final:"e"},u=>this.vPositionRelative(u)),this._parser.registerCsiHandler({final:"f"},u=>this.hVPosition(u)),this._parser.registerCsiHandler({final:"g"},u=>this.tabClear(u)),this._parser.registerCsiHandler({final:"h"},u=>this.setMode(u)),this._parser.registerCsiHandler({prefix:"?",final:"h"},u=>this.setModePrivate(u)),this._parser.registerCsiHandler({final:"l"},u=>this.resetMode(u)),this._parser.registerCsiHandler({prefix:"?",final:"l"},u=>this.resetModePrivate(u)),this._parser.registerCsiHandler({final:"m"},u=>this.charAttributes(u)),this._parser.registerCsiHandler({final:"n"},u=>this.deviceStatus(u)),this._parser.registerCsiHandler({prefix:"?",final:"n"},u=>this.deviceStatusPrivate(u)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},u=>this.softReset(u)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},u=>this.setCursorStyle(u)),this._parser.registerCsiHandler({final:"r"},u=>this.setScrollRegion(u)),this._parser.registerCsiHandler({final:"s"},u=>this.saveCursor(u)),this._parser.registerCsiHandler({final:"t"},u=>this.windowOptions(u)),this._parser.registerCsiHandler({final:"u"},u=>this.restoreCursor(u)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},u=>this.insertColumns(u)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},u=>this.deleteColumns(u)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},u=>this.selectProtected(u)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},u=>this.requestMode(u,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},u=>this.requestMode(u,!1)),this._parser.setExecuteHandler(qe.BEL,()=>this.bell()),this._parser.setExecuteHandler(qe.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(qe.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(qe.BS,()=>this.backspace()),this._parser.setExecuteHandler(qe.HT,()=>this.tab()),this._parser.setExecuteHandler(qe.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(qe.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(Mk.IND,()=>this.index()),this._parser.setExecuteHandler(Mk.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(Mk.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new vi(u=>(this.setTitle(u),this.setIconName(u),!0))),this._parser.registerOscHandler(1,new vi(u=>this.setIconName(u))),this._parser.registerOscHandler(2,new vi(u=>this.setTitle(u))),this._parser.registerOscHandler(4,new vi(u=>this.setOrReportIndexedColor(u))),this._parser.registerOscHandler(8,new vi(u=>this.setHyperlink(u))),this._parser.registerOscHandler(10,new vi(u=>this.setOrReportFgColor(u))),this._parser.registerOscHandler(11,new vi(u=>this.setOrReportBgColor(u))),this._parser.registerOscHandler(12,new vi(u=>this.setOrReportCursorColor(u))),this._parser.registerOscHandler(104,new vi(u=>this.restoreIndexedColor(u))),this._parser.registerOscHandler(110,new vi(u=>this.restoreFgColor(u))),this._parser.registerOscHandler(111,new vi(u=>this.restoreBgColor(u))),this._parser.registerOscHandler(112,new vi(u=>this.restoreCursorColor(u))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let u in Ea)this._parser.registerEscHandler({intermediates:"(",final:u},()=>this.selectCharset("("+u)),this._parser.registerEscHandler({intermediates:")",final:u},()=>this.selectCharset(")"+u)),this._parser.registerEscHandler({intermediates:"*",final:u},()=>this.selectCharset("*"+u)),this._parser.registerEscHandler({intermediates:"+",final:u},()=>this.selectCharset("+"+u)),this._parser.registerEscHandler({intermediates:"-",final:u},()=>this.selectCharset("-"+u)),this._parser.registerEscHandler({intermediates:".",final:u},()=>this.selectCharset("."+u)),this._parser.registerEscHandler({intermediates:"/",final:u},()=>this.selectCharset("/"+u));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(u=>(this._logService.error("Parsing error: ",u),u)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new XZ((u,d)=>this.requestStatusString(u,d)))}getAttrData(){return this._curAttrData}_preserveStack(e,t,r,n){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=r,this._parseStack.position=n}_logSlowResolvingAsync(e){this._logService.logLevel<=3&&Promise.race([e,new Promise((t,r)=>setTimeout(()=>r("#SLOW_TIMEOUT"),nX))]).catch(t=>{if(t!=="#SLOW_TIMEOUT")throw t;console.warn(`async parser handler taking longer than ${nX} ms`)})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(e,t){let r,n=this._activeBuffer.x,a=this._activeBuffer.y,s=0,i=this._parseStack.paused;if(i){if(r=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(r),r;n=this._parseStack.cursorStartX,a=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>Ju&&(s=this._parseStack.position+Ju)}if(this._logService.logLevel<=1&&this._logService.debug(`parsing data ${typeof e=="string"?` "${e}"`:` "${Array.prototype.map.call(e,u=>String.fromCharCode(u)).join("")}"`}`),this._logService.logLevel===0&&this._logService.trace("parsing data (codes)",typeof e=="string"?e.split("").map(u=>u.charCodeAt(0)):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<Ju&&(this._parseBuffer=new Uint32Array(Math.min(e.length,Ju))),i||this._dirtyRowTracker.clearRange(),e.length>Ju)for(let u=s;u<e.length;u+=Ju){let d=u+Ju<e.length?u+Ju:e.length,f=typeof e=="string"?this._stringDecoder.decode(e.substring(u,d),this._parseBuffer):this._utf8Decoder.decode(e.subarray(u,d),this._parseBuffer);if(r=this._parser.parse(this._parseBuffer,f))return this._preserveStack(n,a,f,u),this._logSlowResolvingAsync(r),r}else if(!i){let u=typeof e=="string"?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(r=this._parser.parse(this._parseBuffer,u))return this._preserveStack(n,a,u,0),this._logSlowResolvingAsync(r),r}(this._activeBuffer.x!==n||this._activeBuffer.y!==a)&&this._onCursorMove.fire();let l=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),c=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);c<this._bufferService.rows&&this._onRequestRefreshRows.fire({start:Math.min(c,this._bufferService.rows-1),end:Math.min(l,this._bufferService.rows-1)})}print(e,t,r){let n,a,s=this._charsetService.charset,i=this._optionsService.rawOptions.screenReaderMode,l=this._bufferService.cols,c=this._coreService.decPrivateModes.wraparound,u=this._coreService.modes.insertMode,d=this._curAttrData,f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&r-t>0&&f.getWidth(this._activeBuffer.x-1)===2&&f.setCellFromCodepoint(this._activeBuffer.x-1,0,1,d);let m=this._parser.precedingJoinState;for(let p=t;p<r;++p){if(n=e[p],n<127&&s){let S=s[String.fromCharCode(n)];S&&(n=S.charCodeAt(0))}let v=this._unicodeService.charProperties(n,m);a=Xf.extractWidth(v);let b=Xf.extractShouldJoin(v),y=b?Xf.extractWidth(m):0;if(m=v,i&&this._onA11yChar.fire(ld(n)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+a-y>l){if(c){let S=f,_=this._activeBuffer.x-y;for(this._activeBuffer.x=y,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),y>0&&f instanceof xb&&f.copyCellsFrom(S,_,0,y,!1);_<l;)S.setCellFromCodepoint(_++,0,1,d)}else if(this._activeBuffer.x=l-1,a===2)continue}if(b&&this._activeBuffer.x){let S=f.getWidth(this._activeBuffer.x-1)?1:2;f.addCodepointToCell(this._activeBuffer.x-S,n,a);for(let _=a-y;--_>=0;)f.setCellFromCodepoint(this._activeBuffer.x++,0,0,d);continue}if(u&&(f.insertCells(this._activeBuffer.x,a-y,this._activeBuffer.getNullCell(d)),f.getWidth(l-1)===2&&f.setCellFromCodepoint(l-1,0,1,d)),f.setCellFromCodepoint(this._activeBuffer.x++,n,a,d),a>0)for(;--a;)f.setCellFromCodepoint(this._activeBuffer.x++,0,0,d)}this._parser.precedingJoinState=m,this._activeBuffer.x<l&&r-t>0&&f.getWidth(this._activeBuffer.x)===0&&!f.hasContent(this._activeBuffer.x)&&f.setCellFromCodepoint(this._activeBuffer.x,0,1,d),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(e,t){return e.final==="t"&&!e.prefix&&!e.intermediates?this._parser.registerCsiHandler(e,r=>rX(r.params[0],this._optionsService.rawOptions.windowOptions)?t(r):!0):this._parser.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._parser.registerDcsHandler(e,new XZ(t))}registerEscHandler(e,t){return this._parser.registerEscHandler(e,t)}registerOscHandler(e,t){return this._parser.registerOscHandler(e,new vi(t))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);e.hasWidth(this._activeBuffer.x)&&!e.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(e=this._bufferService.cols-1){this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}cursorUp(e){let t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}cursorDown(e){let t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}cursorForward(e){return this._moveCursor(e.params[0]||1,0),!0}cursorBackward(e){return this._moveCursor(-(e.params[0]||1),0),!0}cursorNextLine(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}cursorPrecedingLine(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}cursorCharAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}charPosAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(e){return this._moveCursor(e.params[0]||1,0),!0}linePosAbsolute(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}vPositionRelative(e){return this._moveCursor(0,e.params[0]||1),!0}hVPosition(e){return this.cursorPosition(e),!0}tabClear(e){let t=e.params[0];return t===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:t===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(e){let t=e.params[0];return t===1&&(this._curAttrData.bg|=536870912),(t===2||t===0)&&(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(e,t,r,n=!1,a=!1){let s=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);s.replaceCells(t,r,this._activeBuffer.getNullCell(this._eraseAttrData()),a),n&&(s.isWrapped=!1)}_resetBufferLine(e,t=!1){let r=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);r&&(r.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),r.isWrapped=!1)}eraseInDisplay(e,t=!1){this._restrictCursor(this._bufferService.cols);let r;switch(e.params[0]){case 0:for(r=this._activeBuffer.y,this._dirtyRowTracker.markDirty(r),this._eraseInBufferLine(r++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,t);r<this._bufferService.rows;r++)this._resetBufferLine(r,t);this._dirtyRowTracker.markDirty(r);break;case 1:for(r=this._activeBuffer.y,this._dirtyRowTracker.markDirty(r),this._eraseInBufferLine(r,0,this._activeBuffer.x+1,!0,t),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(r+1).isWrapped=!1);r--;)this._resetBufferLine(r,t);this._dirtyRowTracker.markDirty(0);break;case 2:if(this._optionsService.rawOptions.scrollOnEraseInDisplay){for(r=this._bufferService.rows,this._dirtyRowTracker.markRangeDirty(0,r-1);r--&&!this._activeBuffer.lines.get(this._activeBuffer.ybase+r)?.getTrimmedLength(););for(;r>=0;r--)this._bufferService.scroll(this._eraseAttrData())}else{for(r=this._bufferService.rows,this._dirtyRowTracker.markDirty(r-1);r--;)this._resetBufferLine(r,t);this._dirtyRowTracker.markDirty(0)}break;case 3:let n=this._activeBuffer.lines.length-this._bufferService.rows;n>0&&(this._activeBuffer.lines.trimStart(n),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-n,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-n,0),this._onScroll.fire(0));break}return!0}eraseInLine(e,t=!1){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t);break}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let r=this._activeBuffer.ybase+this._activeBuffer.y,n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,a=this._bufferService.rows-1+this._activeBuffer.ybase-n+1;for(;t--;)this._activeBuffer.lines.splice(a-1,1),this._activeBuffer.lines.splice(r,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let r=this._activeBuffer.ybase+this._activeBuffer.y,n;for(n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-n;t--;)this._activeBuffer.lines.splice(r,1),this._activeBuffer.lines.splice(n,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(fa));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){let n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(e){let t=this._parser.precedingJoinState;if(!t)return!0;let r=e.params[0]||1,n=Xf.extractWidth(t),a=this._activeBuffer.x-n,s=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(a),i=new Uint32Array(s.length*r),l=0;for(let u=0;u<s.length;){let d=s.codePointAt(u)||0;i[l++]=d,u+=d>65535?2:1}let c=l;for(let u=1;u<r;++u)i.copyWithin(c,0,l),c+=l;return this.print(i,0,c),!0}sendDeviceAttributesPrimary(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(qe.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(qe.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(qe.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(qe.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(qe.ESC+"[>83;40003;0c")),!0}_is(e){return(this._optionsService.rawOptions.termName+"").indexOf(e)===0}setMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0;break}return!0}setModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,$f),this._charsetService.setgCharset(1,$f),this._charsetService.setgCharset(2,$f),this._charsetService.setgCharset(3,$f);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!0;break}return!0}resetMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1;break}return!0}resetModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),e.params[t]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!1,this._onRequestRefreshRows.fire(void 0);break}return!0}requestMode(e,t){(b=>(b[b.NOT_RECOGNIZED=0]="NOT_RECOGNIZED",b[b.SET=1]="SET",b[b.RESET=2]="RESET",b[b.PERMANENTLY_SET=3]="PERMANENTLY_SET",b[b.PERMANENTLY_RESET=4]="PERMANENTLY_RESET"))(void 0||(r={}));let n=this._coreService.decPrivateModes,{activeProtocol:a,activeEncoding:s}=this._coreMouseService,i=this._coreService,{buffers:l,cols:c}=this._bufferService,{active:u,alt:d}=l,f=this._optionsService.rawOptions,m=(b,y)=>(i.triggerDataEvent(`${qe.ESC}[${t?"":"?"}${b};${y}$y`),!0),p=b=>b?1:2,v=e.params[0];return t?v===2?m(v,4):v===4?m(v,p(i.modes.insertMode)):v===12?m(v,3):v===20?m(v,p(f.convertEol)):m(v,0):v===1?m(v,p(n.applicationCursorKeys)):v===3?m(v,f.windowOptions.setWinLines?c===80?2:c===132?1:0:0):v===6?m(v,p(n.origin)):v===7?m(v,p(n.wraparound)):v===8?m(v,3):v===9?m(v,p(a==="X10")):v===12?m(v,p(f.cursorBlink)):v===25?m(v,p(!i.isCursorHidden)):v===45?m(v,p(n.reverseWraparound)):v===66?m(v,p(n.applicationKeypad)):v===67?m(v,4):v===1e3?m(v,p(a==="VT200")):v===1002?m(v,p(a==="DRAG")):v===1003?m(v,p(a==="ANY")):v===1004?m(v,p(n.sendFocus)):v===1005?m(v,4):v===1006?m(v,p(s==="SGR")):v===1015?m(v,4):v===1016?m(v,p(s==="SGR_PIXELS")):v===1048?m(v,1):v===47||v===1047||v===1049?m(v,p(u===d)):v===2004?m(v,p(n.bracketedPasteMode)):v===2026?m(v,p(n.synchronizedOutput)):m(v,0)}_updateAttrColor(e,t,r,n,a){return t===2?(e|=50331648,e&=-16777216,e|=u1.fromColorRGB([r,n,a])):t===5&&(e&=-50331904,e|=33554432|r&255),e}_extractColor(e,t,r){let n=[0,0,-1,0,0,0],a=0,s=0;do{if(n[s+a]=e.params[t+s],e.hasSubParams(t+s)){let i=e.getSubParams(t+s),l=0;do n[1]===5&&(a=1),n[s+l+1+a]=i[l];while(++l<i.length&&l+s+1+a<n.length);break}if(n[1]===5&&s+a>=2||n[1]===2&&s+a>=5)break;n[1]&&(a=1)}while(++s+t<e.length&&s+a<n.length);for(let i=2;i<n.length;++i)n[i]===-1&&(n[i]=0);switch(n[0]){case 38:r.fg=this._updateAttrColor(r.fg,n[1],n[3],n[4],n[5]);break;case 48:r.bg=this._updateAttrColor(r.bg,n[1],n[3],n[4],n[5]);break;case 58:r.extended=r.extended.clone(),r.extended.underlineColor=this._updateAttrColor(r.extended.underlineColor,n[1],n[3],n[4],n[5])}return s}_processUnderline(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,e===0&&(t.fg&=-268435457),t.updateExtended()}_processSGR0(e){e.fg=fa.fg,e.bg=fa.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}charAttributes(e){if(e.length===1&&e.params[0]===0)return this._processSGR0(this._curAttrData),!0;let t=e.length,r,n=this._curAttrData;for(let a=0;a<t;a++)r=e.params[a],r>=30&&r<=37?(n.fg&=-50331904,n.fg|=16777216|r-30):r>=40&&r<=47?(n.bg&=-50331904,n.bg|=16777216|r-40):r>=90&&r<=97?(n.fg&=-50331904,n.fg|=16777216|r-90|8):r>=100&&r<=107?(n.bg&=-50331904,n.bg|=16777216|r-100|8):r===0?this._processSGR0(n):r===1?n.fg|=134217728:r===3?n.bg|=67108864:r===4?(n.fg|=268435456,this._processUnderline(e.hasSubParams(a)?e.getSubParams(a)[0]:1,n)):r===5?n.fg|=536870912:r===7?n.fg|=67108864:r===8?n.fg|=1073741824:r===9?n.fg|=2147483648:r===2?n.bg|=134217728:r===21?this._processUnderline(2,n):r===22?(n.fg&=-134217729,n.bg&=-134217729):r===23?n.bg&=-67108865:r===24?(n.fg&=-268435457,this._processUnderline(0,n)):r===25?n.fg&=-536870913:r===27?n.fg&=-67108865:r===28?n.fg&=-1073741825:r===29?n.fg&=2147483647:r===39?(n.fg&=-67108864,n.fg|=fa.fg&16777215):r===49?(n.bg&=-67108864,n.bg|=fa.bg&16777215):r===38||r===48||r===58?a+=this._extractColor(e,a,n):r===53?n.bg|=1073741824:r===55?n.bg&=-1073741825:r===59?(n.extended=n.extended.clone(),n.extended.underlineColor=-1,n.updateExtended()):r===100?(n.fg&=-67108864,n.fg|=fa.fg&16777215,n.bg&=-67108864,n.bg|=fa.bg&16777215):this._logService.debug("Unknown SGR attribute: %d.",r);return!0}deviceStatus(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(`${qe.ESC}[0n`);break;case 6:let t=this._activeBuffer.y+1,r=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${qe.ESC}[${t};${r}R`);break}return!0}deviceStatusPrivate(e){switch(e.params[0]){case 6:let t=this._activeBuffer.y+1,r=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${qe.ESC}[?${t};${r}R`);break}return!0}softReset(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=fa.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(e){let t=e.length===0?1:e.params[0];if(t===0)this._coreService.decPrivateModes.cursorStyle=void 0,this._coreService.decPrivateModes.cursorBlink=void 0;else{switch(t){case 1:case 2:this._coreService.decPrivateModes.cursorStyle="block";break;case 3:case 4:this._coreService.decPrivateModes.cursorStyle="underline";break;case 5:case 6:this._coreService.decPrivateModes.cursorStyle="bar";break}let r=t%2===1;this._coreService.decPrivateModes.cursorBlink=r}return!0}setScrollRegion(e){let t=e.params[0]||1,r;return(e.length<2||(r=e.params[1])>this._bufferService.rows||r===0)&&(r=this._bufferService.rows),r>t&&(this._activeBuffer.scrollTop=t-1,this._activeBuffer.scrollBottom=r-1,this._setCursor(0,0)),!0}windowOptions(e){if(!rX(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;let t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:t!==2&&this._onRequestWindowsOptionsReport.fire(0);break;case 16:this._onRequestWindowsOptionsReport.fire(1);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${qe.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:(t===0||t===2)&&(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>tX&&this._windowTitleStack.shift()),(t===0||t===1)&&(this._iconNameStack.push(this._iconName),this._iconNameStack.length>tX&&this._iconNameStack.shift());break;case 23:(t===0||t===2)&&this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),(t===0||t===1)&&this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop());break}return!0}saveCursor(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}setIconName(e){return this._iconName=e,!0}setOrReportIndexedColor(e){let t=[],r=e.split(";");for(;r.length>1;){let n=r.shift(),a=r.shift();if(/^\d+$/.exec(n)){let s=parseInt(n);if(sX(s))if(a==="?")t.push({type:0,index:s});else{let i=eX(a);i&&t.push({type:1,index:s,color:i})}}}return t.length&&this._onColor.fire(t),!0}setHyperlink(e){let t=e.indexOf(";");if(t===-1)return!0;let r=e.slice(0,t).trim(),n=e.slice(t+1);return n?this._createHyperlink(r,n):r.trim()?!1:this._finishHyperlink()}_createHyperlink(e,t){this._getCurrentLinkId()&&this._finishHyperlink();let r=e.split(":"),n,a=r.findIndex(s=>s.startsWith("id="));return a!==-1&&(n=r[a].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:n,uri:t}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(e,t){let r=e.split(";");for(let n=0;n<r.length&&!(t>=this._specialColors.length);++n,++t)if(r[n]==="?")this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{let a=eX(r[n]);a&&this._onColor.fire([{type:1,index:this._specialColors[t],color:a}])}return!0}setOrReportFgColor(e){return this._setOrReportSpecialColor(e,0)}setOrReportBgColor(e){return this._setOrReportSpecialColor(e,1)}setOrReportCursorColor(e){return this._setOrReportSpecialColor(e,2)}restoreIndexedColor(e){if(!e)return this._onColor.fire([{type:2}]),!0;let t=[],r=e.split(";");for(let n=0;n<r.length;++n)if(/^\d+$/.exec(r[n])){let a=parseInt(r[n]);sX(a)&&t.push({type:2,index:a})}return t.length&&this._onColor.fire(t),!0}restoreFgColor(e){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(e){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(e){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,$f),!0}selectCharset(e){return e.length!==2?(this.selectDefaultCharset(),!0):(e[0]==="/"||this._charsetService.setgCharset(cQe[e[0]],Ea[e[1]]||$f),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=fa.clone(),this._eraseAttrDataInternal=fa.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=this._curAttrData.bg&67108863,this._eraseAttrDataInternal}setgLevel(e){return this._charsetService.setgLevel(e),!0}screenAlignmentPattern(){let e=new So;e.content=1<<22|69,e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(let t=0;t<this._bufferService.rows;++t){let r=this._activeBuffer.ybase+this._activeBuffer.y+t,n=this._activeBuffer.lines.get(r);n&&(n.fill(e),n.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(e,t){let r=i=>(this._coreService.triggerDataEvent(`${qe.ESC}${i}${qe.ESC}\\`),!0),n=this._bufferService.buffer,a=this._optionsService.rawOptions;return r(e==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:e==='"p'?'P1$r61;1"p':e==="r"?`P1$r${n.scrollTop+1};${n.scrollBottom+1}r`:e==="m"?"P1$r0m":e===" q"?`P1$r${{block:2,underline:4,bar:6}[a.cursorStyle]-(a.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}},RP=class{constructor(e){this._bufferService=e,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}markRangeDirty(e,t){e>t&&(aX=e,e=t,t=aX),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};RP=Zn([mt(0,Us)],RP);function sX(e){return 0<=e&&e<256}var dQe=5e7,iX=12,fQe=50,hQe=class extends gr{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this._register(new rt),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,t){if(t!==void 0&&this._syncCalls>t){this._syncCalls=0;return}if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;this._isSyncWriting=!0;let r;for(;r=this._writeBuffer.shift();){this._action(r);let n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,t){if(this._pendingData>dQe)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput){this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),this._innerWrite();return}setTimeout(()=>this._innerWrite())}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}_innerWrite(e=0,t=!0){let r=e||performance.now();for(;this._writeBuffer.length>this._bufferOffset;){let n=this._writeBuffer[this._bufferOffset],a=this._action(n,t);if(a){let i=l=>performance.now()-r>=iX?setTimeout(()=>this._innerWrite(0,l)):this._innerWrite(r,l);a.catch(l=>(queueMicrotask(()=>{throw l}),Promise.resolve(!1))).then(i);return}let s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=n.length,performance.now()-r>=iX)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>fQe&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}},PP=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){let t=this._bufferService.buffer;if(e.id===void 0){let l=t.addMarker(t.ybase+t.y),c={data:e,id:this._nextId++,lines:[l]};return l.onDispose(()=>this._removeMarkerFromLink(c,l)),this._dataByLinkId.set(c.id,c),c.id}let r=e,n=this._getEntryIdKey(r),a=this._entriesWithId.get(n);if(a)return this.addLineToLink(a.id,t.ybase+t.y),a.id;let s=t.addMarker(t.ybase+t.y),i={id:this._nextId++,key:this._getEntryIdKey(r),data:r,lines:[s]};return s.onDispose(()=>this._removeMarkerFromLink(i,s)),this._entriesWithId.set(i.key,i),this._dataByLinkId.set(i.id,i),i.id}addLineToLink(e,t){let r=this._dataByLinkId.get(e);if(r&&r.lines.every(n=>n.line!==t)){let n=this._bufferService.buffer.addMarker(t);r.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(r,n))}}getLinkData(e){return this._dataByLinkId.get(e)?.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,t){let r=e.lines.indexOf(t);r!==-1&&(e.lines.splice(r,1),e.lines.length===0&&(e.data.id!==void 0&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};PP=Zn([mt(0,Us)],PP);var oX=!1,mQe=class extends gr{constructor(e){super(),this._windowsWrappingHeuristics=this._register(new Lg),this._onBinary=this._register(new rt),this.onBinary=this._onBinary.event,this._onData=this._register(new rt),this.onData=this._onData.event,this._onLineFeed=this._register(new rt),this.onLineFeed=this._onLineFeed.event,this._onResize=this._register(new rt),this.onResize=this._onResize.event,this._onWriteParsed=this._register(new rt),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this._register(new rt),this._instantiationService=new zYe,this.optionsService=this._register(new VYe(e)),this._instantiationService.setService(Hs,this.optionsService),this._bufferService=this._register(this._instantiationService.createInstance(DP)),this._instantiationService.setService(Us,this._bufferService),this._logService=this._register(this._instantiationService.createInstance(AP)),this._instantiationService.setService(The,this._logService),this.coreService=this._register(this._instantiationService.createInstance(LP)),this._instantiationService.setService(am,this.coreService),this.coreMouseService=this._register(this._instantiationService.createInstance(OP)),this._instantiationService.setService(Mhe,this.coreMouseService),this.unicodeService=this._register(this._instantiationService.createInstance(Xf)),this._instantiationService.setService(OGe,this.unicodeService),this._charsetService=this._instantiationService.createInstance(XYe),this._instantiationService.setService(LGe,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(PP),this._instantiationService.setService(Ahe,this._oscLinkService),this._inputHandler=this._register(new uQe(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this._register(ls.forward(this._inputHandler.onLineFeed,this._onLineFeed)),this._register(this._inputHandler),this._register(ls.forward(this._bufferService.onResize,this._onResize)),this._register(ls.forward(this.coreService.onData,this._onData)),this._register(ls.forward(this.coreService.onBinary,this._onBinary)),this._register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom(!0))),this._register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this._register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this._register(this._bufferService.onScroll(()=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this._register(new hQe((t,r)=>this._inputHandler.parse(t,r))),this._register(ls.forward(this._writeBuffer.onWriteParsed,this._onWriteParsed))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this._register(new rt),this._onScroll.event(e=>{this._onScrollApi?.fire(e.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(e){for(let t in e)this.optionsService.options[t]=e[t]}write(e,t){this._writeBuffer.write(e,t)}writeSync(e,t){this._logService.logLevel<=3&&!oX&&(this._logService.warn("writeSync is unreliable and will be removed soon."),oX=!0),this._writeBuffer.writeSync(e,t)}input(e,t=!0){this.coreService.triggerDataEvent(e,t)}resize(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,cme),t=Math.max(t,ume),this._bufferService.resize(e,t))}scroll(e,t=!1){this._bufferService.scroll(e,t)}scrollLines(e,t){this._bufferService.scrollLines(e,t)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let t=e-this._bufferService.buffer.ydisp;t!==0&&this.scrollLines(t)}registerEscHandler(e,t){return this._inputHandler.registerEscHandler(e,t)}registerDcsHandler(e,t){return this._inputHandler.registerDcsHandler(e,t)}registerCsiHandler(e,t){return this._inputHandler.registerCsiHandler(e,t)}registerOscHandler(e,t){return this._inputHandler.registerOscHandler(e,t)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let e=!1,t=this.optionsService.rawOptions.windowsPty;t&&t.buildNumber!==void 0&&t.buildNumber!==void 0?e=t.backend==="conpty"&&t.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let e=[];e.push(this.onLineFeed(ZZ.bind(null,this._bufferService))),e.push(this.registerCsiHandler({final:"H"},()=>(ZZ(this._bufferService),!1))),this._windowsWrappingHeuristics.value=Mn(()=>{for(let t of e)t.dispose()})}}},pQe={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};function gQe(e,t,r,n){let a={type:0,cancel:!1,key:void 0},s=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:e.key==="UIKeyInputUpArrow"?t?a.key=qe.ESC+"OA":a.key=qe.ESC+"[A":e.key==="UIKeyInputLeftArrow"?t?a.key=qe.ESC+"OD":a.key=qe.ESC+"[D":e.key==="UIKeyInputRightArrow"?t?a.key=qe.ESC+"OC":a.key=qe.ESC+"[C":e.key==="UIKeyInputDownArrow"&&(t?a.key=qe.ESC+"OB":a.key=qe.ESC+"[B");break;case 8:a.key=e.ctrlKey?"\b":qe.DEL,e.altKey&&(a.key=qe.ESC+a.key);break;case 9:if(e.shiftKey){a.key=qe.ESC+"[Z";break}a.key=qe.HT,a.cancel=!0;break;case 13:a.key=e.altKey?qe.ESC+qe.CR:qe.CR,a.cancel=!0;break;case 27:a.key=qe.ESC,e.altKey&&(a.key=qe.ESC+qe.ESC),a.cancel=!0;break;case 37:if(e.metaKey)break;s?a.key=qe.ESC+"[1;"+(s+1)+"D":t?a.key=qe.ESC+"OD":a.key=qe.ESC+"[D";break;case 39:if(e.metaKey)break;s?a.key=qe.ESC+"[1;"+(s+1)+"C":t?a.key=qe.ESC+"OC":a.key=qe.ESC+"[C";break;case 38:if(e.metaKey)break;s?a.key=qe.ESC+"[1;"+(s+1)+"A":t?a.key=qe.ESC+"OA":a.key=qe.ESC+"[A";break;case 40:if(e.metaKey)break;s?a.key=qe.ESC+"[1;"+(s+1)+"B":t?a.key=qe.ESC+"OB":a.key=qe.ESC+"[B";break;case 45:!e.shiftKey&&!e.ctrlKey&&(a.key=qe.ESC+"[2~");break;case 46:s?a.key=qe.ESC+"[3;"+(s+1)+"~":a.key=qe.ESC+"[3~";break;case 36:s?a.key=qe.ESC+"[1;"+(s+1)+"H":t?a.key=qe.ESC+"OH":a.key=qe.ESC+"[H";break;case 35:s?a.key=qe.ESC+"[1;"+(s+1)+"F":t?a.key=qe.ESC+"OF":a.key=qe.ESC+"[F";break;case 33:e.shiftKey?a.type=2:e.ctrlKey?a.key=qe.ESC+"[5;"+(s+1)+"~":a.key=qe.ESC+"[5~";break;case 34:e.shiftKey?a.type=3:e.ctrlKey?a.key=qe.ESC+"[6;"+(s+1)+"~":a.key=qe.ESC+"[6~";break;case 112:s?a.key=qe.ESC+"[1;"+(s+1)+"P":a.key=qe.ESC+"OP";break;case 113:s?a.key=qe.ESC+"[1;"+(s+1)+"Q":a.key=qe.ESC+"OQ";break;case 114:s?a.key=qe.ESC+"[1;"+(s+1)+"R":a.key=qe.ESC+"OR";break;case 115:s?a.key=qe.ESC+"[1;"+(s+1)+"S":a.key=qe.ESC+"OS";break;case 116:s?a.key=qe.ESC+"[15;"+(s+1)+"~":a.key=qe.ESC+"[15~";break;case 117:s?a.key=qe.ESC+"[17;"+(s+1)+"~":a.key=qe.ESC+"[17~";break;case 118:s?a.key=qe.ESC+"[18;"+(s+1)+"~":a.key=qe.ESC+"[18~";break;case 119:s?a.key=qe.ESC+"[19;"+(s+1)+"~":a.key=qe.ESC+"[19~";break;case 120:s?a.key=qe.ESC+"[20;"+(s+1)+"~":a.key=qe.ESC+"[20~";break;case 121:s?a.key=qe.ESC+"[21;"+(s+1)+"~":a.key=qe.ESC+"[21~";break;case 122:s?a.key=qe.ESC+"[23;"+(s+1)+"~":a.key=qe.ESC+"[23~";break;case 123:s?a.key=qe.ESC+"[24;"+(s+1)+"~":a.key=qe.ESC+"[24~";break;default:if(e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey)e.keyCode>=65&&e.keyCode<=90?a.key=String.fromCharCode(e.keyCode-64):e.keyCode===32?a.key=qe.NUL:e.keyCode>=51&&e.keyCode<=55?a.key=String.fromCharCode(e.keyCode-51+27):e.keyCode===56?a.key=qe.DEL:e.keyCode===219?a.key=qe.ESC:e.keyCode===220?a.key=qe.FS:e.keyCode===221&&(a.key=qe.GS);else if((!r||n)&&e.altKey&&!e.metaKey){let i=pQe[e.keyCode]?.[e.shiftKey?1:0];if(i)a.key=qe.ESC+i;else if(e.keyCode>=65&&e.keyCode<=90){let l=e.ctrlKey?e.keyCode-64:e.keyCode+32,c=String.fromCharCode(l);e.shiftKey&&(c=c.toUpperCase()),a.key=qe.ESC+c}else if(e.keyCode===32)a.key=qe.ESC+(e.ctrlKey?qe.NUL:" ");else if(e.key==="Dead"&&e.code.startsWith("Key")){let l=e.code.slice(3,4);e.shiftKey||(l=l.toLowerCase()),a.key=qe.ESC+l,a.cancel=!0}}else r&&!e.altKey&&!e.ctrlKey&&!e.shiftKey&&e.metaKey?e.keyCode===65&&(a.type=1):e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&e.key.length===1?a.key=e.key:e.key&&e.ctrlKey&&(e.key==="_"&&(a.key=qe.US),e.key==="@"&&(a.key=qe.NUL));break}return a}var ta=0,vQe=class{constructor(e){this._getKey=e,this._array=[],this._insertedValues=[],this._flushInsertedTask=new lC,this._isFlushingInserted=!1,this._deletedIndices=[],this._flushDeletedTask=new lC,this._isFlushingDeleted=!1}clear(){this._array.length=0,this._insertedValues.length=0,this._flushInsertedTask.clear(),this._isFlushingInserted=!1,this._deletedIndices.length=0,this._flushDeletedTask.clear(),this._isFlushingDeleted=!1}insert(e){this._flushCleanupDeleted(),this._insertedValues.length===0&&this._flushInsertedTask.enqueue(()=>this._flushInserted()),this._insertedValues.push(e)}_flushInserted(){let e=this._insertedValues.sort((a,s)=>this._getKey(a)-this._getKey(s)),t=0,r=0,n=new Array(this._array.length+this._insertedValues.length);for(let a=0;a<n.length;a++)r>=this._array.length||this._getKey(e[t])<=this._getKey(this._array[r])?(n[a]=e[t],t++):n[a]=this._array[r++];this._array=n,this._insertedValues.length=0}_flushCleanupInserted(){!this._isFlushingInserted&&this._insertedValues.length>0&&this._flushInsertedTask.flush()}delete(e){if(this._flushCleanupInserted(),this._array.length===0)return!1;let t=this._getKey(e);if(t===void 0||(ta=this._search(t),ta===-1)||this._getKey(this._array[ta])!==t)return!1;do if(this._array[ta]===e)return this._deletedIndices.length===0&&this._flushDeletedTask.enqueue(()=>this._flushDeleted()),this._deletedIndices.push(ta),!0;while(++ta<this._array.length&&this._getKey(this._array[ta])===t);return!1}_flushDeleted(){this._isFlushingDeleted=!0;let e=this._deletedIndices.sort((a,s)=>a-s),t=0,r=new Array(this._array.length-e.length),n=0;for(let a=0;a<this._array.length;a++)e[t]===a?t++:r[n++]=this._array[a];this._array=r,this._deletedIndices.length=0,this._isFlushingDeleted=!1}_flushCleanupDeleted(){!this._isFlushingDeleted&&this._deletedIndices.length>0&&this._flushDeletedTask.flush()}*getKeyIterator(e){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(ta=this._search(e),!(ta<0||ta>=this._array.length)&&this._getKey(this._array[ta])===e))do yield this._array[ta];while(++ta<this._array.length&&this._getKey(this._array[ta])===e)}forEachByKey(e,t){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(ta=this._search(e),!(ta<0||ta>=this._array.length)&&this._getKey(this._array[ta])===e))do t(this._array[ta]);while(++ta<this._array.length&&this._getKey(this._array[ta])===e)}values(){return this._flushCleanupInserted(),this._flushCleanupDeleted(),[...this._array].values()}_search(e){let t=0,r=this._array.length-1;for(;r>=t;){let n=t+r>>1,a=this._getKey(this._array[n]);if(a>e)r=n-1;else if(a<e)t=n+1;else{for(;n>0&&this._getKey(this._array[n-1])===e;)n--;return n}}return t}},NL=0,lX=0,bQe=class extends gr{constructor(){super(),this._decorations=new vQe(e=>e?.marker.line),this._onDecorationRegistered=this._register(new rt),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this._register(new rt),this.onDecorationRemoved=this._onDecorationRemoved.event,this._register(Mn(()=>this.reset()))}get decorations(){return this._decorations.values()}registerDecoration(e){if(e.marker.isDisposed)return;let t=new yQe(e);if(t){let r=t.marker.onDispose(()=>t.dispose()),n=t.onDispose(()=>{n.dispose(),t&&(this._decorations.delete(t)&&this._onDecorationRemoved.fire(t),r.dispose())});this._decorations.insert(t),this._onDecorationRegistered.fire(t)}return t}reset(){for(let e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,t,r){let n=0,a=0;for(let s of this._decorations.getKeyIterator(t))n=s.options.x??0,a=n+(s.options.width??1),e>=n&&e<a&&(!r||(s.options.layer??"bottom")===r)&&(yield s)}forEachDecorationAtCell(e,t,r,n){this._decorations.forEachByKey(t,a=>{NL=a.options.x??0,lX=NL+(a.options.width??1),e>=NL&&e<lX&&(!r||(a.options.layer??"bottom")===r)&&n(a)})}},yQe=class extends Ad{constructor(e){super(),this.options=e,this.onRenderEmitter=this.add(new rt),this.onRender=this.onRenderEmitter.event,this._onDispose=this.add(new rt),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=zn.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=zn.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}},xQe=1e3,wQe=class{constructor(e,t=xQe){this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(e,t,r){this._rowCount=r,e=e!==void 0?e:0,t=t!==void 0?t:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,t):t;let n=performance.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){let a=n-this._lastRefreshMs,s=this._debounceThresholdMS-a;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=performance.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},s)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}},cX=20,cC=class extends gr{constructor(t,r,n,a){super(),this._terminal=t,this._coreBrowserService=n,this._renderService=a,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="";let s=this._coreBrowserService.mainDocument;this._accessibilityContainer=s.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=s.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let i=0;i<this._terminal.rows;i++)this._rowElements[i]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[i]);if(this._topBoundaryFocusListener=i=>this._handleBoundaryFocus(i,0),this._bottomBoundaryFocusListener=i=>this._handleBoundaryFocus(i,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=s.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this._register(new wQe(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this._register(this._terminal.onResize(i=>this._handleResize(i.rows))),this._register(this._terminal.onRender(i=>this._refreshRows(i.start,i.end))),this._register(this._terminal.onScroll(()=>this._refreshRows())),this._register(this._terminal.onA11yChar(i=>this._handleChar(i))),this._register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this._register(this._terminal.onA11yTab(i=>this._handleTab(i))),this._register(this._terminal.onKey(i=>this._handleKey(i.key))),this._register(this._terminal.onBlur(()=>this._clearLiveRegion())),this._register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._register(Xt(s,"selectionchange",()=>this._handleSelectionChange())),this._register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRowsDimensions(),this._refreshRows(),this._register(Mn(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(t){for(let r=0;r<t;r++)this._handleChar(" ")}_handleChar(t){this._liveRegionLineCount<cX+1&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==t&&(this._charsToAnnounce+=t):this._charsToAnnounce+=t,t===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===cX+1&&(this._liveRegion.textContent+=nP.get())))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(t){this._clearLiveRegion(),/\p{Control}/u.test(t)||this._charsToConsume.push(t)}_refreshRows(t,r){this._liveRegionDebouncer.refresh(t,r,this._terminal.rows)}_renderRows(t,r){let n=this._terminal.buffer,a=n.lines.length.toString();for(let s=t;s<=r;s++){let i=n.lines.get(n.ydisp+s),l=[],c=i?.translateToString(!0,void 0,void 0,l)||"",u=(n.ydisp+s+1).toString(),d=this._rowElements[s];d&&(c.length===0?(d.textContent="",this._rowColumns.set(d,[0,1])):(d.textContent=c,this._rowColumns.set(d,l)),d.setAttribute("aria-posinset",u),d.setAttribute("aria-setsize",a),this._alignRowWidth(d))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(t,r){let n=t.target,a=this._rowElements[r===0?1:this._rowElements.length-2],s=n.getAttribute("aria-posinset"),i=r===0?"1":`${this._terminal.buffer.lines.length}`;if(s===i||t.relatedTarget!==a)return;let l,c;if(r===0?(l=n,c=this._rowElements.pop(),this._rowContainer.removeChild(c)):(l=this._rowElements.shift(),c=n,this._rowContainer.removeChild(l)),l.removeEventListener("focus",this._topBoundaryFocusListener),c.removeEventListener("focus",this._bottomBoundaryFocusListener),r===0){let u=this._createAccessibilityTreeNode();this._rowElements.unshift(u),this._rowContainer.insertAdjacentElement("afterbegin",u)}else{let u=this._createAccessibilityTreeNode();this._rowElements.push(u),this._rowContainer.appendChild(u)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(r===0?-1:1),this._rowElements[r===0?1:this._rowElements.length-2].focus(),t.preventDefault(),t.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;let t=this._coreBrowserService.mainDocument.getSelection();if(!t)return;if(t.isCollapsed){this._rowContainer.contains(t.anchorNode)&&this._terminal.clearSelection();return}if(!t.anchorNode||!t.focusNode){console.error("anchorNode and/or focusNode are null");return}let r={node:t.anchorNode,offset:t.anchorOffset},n={node:t.focusNode,offset:t.focusOffset};if((r.node.compareDocumentPosition(n.node)&Node.DOCUMENT_POSITION_PRECEDING||r.node===n.node&&r.offset>n.offset)&&([r,n]=[n,r]),r.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(r={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(r.node))return;let a=this._rowElements.slice(-1)[0];if(n.node.compareDocumentPosition(a)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(n={node:a,offset:a.textContent?.length??0}),!this._rowContainer.contains(n.node))return;let s=({node:c,offset:u})=>{let d=c instanceof Text?c.parentNode:c,f=parseInt(d?.getAttribute("aria-posinset"),10)-1;if(isNaN(f))return console.warn("row is invalid. Race condition?"),null;let m=this._rowColumns.get(d);if(!m)return console.warn("columns is null. Race condition?"),null;let p=u<m.length?m[u]:m.slice(-1)[0]+1;return p>=this._terminal.cols&&(++f,p=0),{row:f,column:p}},i=s(r),l=s(n);if(!(!i||!l)){if(i.row>l.row||i.row===l.row&&i.column>=l.column)throw new Error("invalid range");this._terminal.select(i.column,i.row,(l.row-i.row)*this._terminal.cols-i.column+l.column)}}_handleResize(t){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let r=this._rowContainer.children.length;r<this._terminal.rows;r++)this._rowElements[r]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[r]);for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let t=this._coreBrowserService.mainDocument.createElement("div");return t.setAttribute("role","listitem"),t.tabIndex=-1,this._refreshRowDimensions(t),t}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){Object.assign(this._accessibilityContainer.style,{width:`${this._renderService.dimensions.css.canvas.width}px`,fontSize:`${this._terminal.options.fontSize}px`}),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let t=0;t<this._terminal.rows;t++)this._refreshRowDimensions(this._rowElements[t]),this._alignRowWidth(this._rowElements[t])}}_refreshRowDimensions(t){t.style.height=`${this._renderService.dimensions.css.cell.height}px`}_alignRowWidth(t){t.style.transform="";let r=t.getBoundingClientRect().width,n=this._rowColumns.get(t)?.slice(-1)?.[0];if(!n)return;let a=n*this._renderService.dimensions.css.cell.width;t.style.transform=`scaleX(${a/r})`}};cC=Zn([mt(1,bB),mt(2,vu),mt(3,bu)],cC);var zP=class extends gr{constructor(e,t,r,n,a){super(),this._element=e,this._mouseService=t,this._renderService=r,this._bufferService=n,this._linkProviderService=a,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this._register(new rt),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this._register(new rt),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this._register(Mn(()=>{Dh(this._linkCacheDisposables),this._linkCacheDisposables.length=0,this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this._register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this._register(Xt(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this._register(Xt(this._element,"mousemove",this._handleMouseMove.bind(this))),this._register(Xt(this._element,"mousedown",this._handleMouseDown.bind(this))),this._register(Xt(this._element,"mouseup",this._handleMouseUp.bind(this)))}get currentLink(){return this._currentLink}_handleMouseMove(e){this._lastMouseEvent=e;let t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;let r=e.composedPath();for(let n=0;n<r.length;n++){let a=r[n];if(a.classList.contains("xterm"))break;if(a.classList.contains("xterm-hover"))return}(!this._lastBufferCell||t.x!==this._lastBufferCell.x||t.y!==this._lastBufferCell.y)&&(this._handleHover(t),this._lastBufferCell=t)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized){this._clearCurrentLink(),this._askForLink(e,!1),this._wasResized=!1;return}this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,t){(!this._activeProviderReplies||!t)&&(this._activeProviderReplies?.forEach(n=>{n?.forEach(a=>{a.link.dispose&&a.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let r=!1;for(let[n,a]of this._linkProviderService.linkProviders.entries())t?this._activeProviderReplies?.get(n)&&(r=this._checkLinkProviderResult(n,e,r)):a.provideLinks(e.y,s=>{if(this._isMouseOut)return;let i=s?.map(l=>({link:l}));this._activeProviderReplies?.set(n,i),r=this._checkLinkProviderResult(n,e,r),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,t){let r=new Set;for(let n=0;n<t.size;n++){let a=t.get(n);if(a)for(let s=0;s<a.length;s++){let i=a[s],l=i.link.range.start.y<e?0:i.link.range.start.x,c=i.link.range.end.y>e?this._bufferService.cols:i.link.range.end.x;for(let u=l;u<=c;u++){if(r.has(u)){a.splice(s--,1);break}r.add(u)}}}}_checkLinkProviderResult(e,t,r){if(!this._activeProviderReplies)return r;let n=this._activeProviderReplies.get(e),a=!1;for(let s=0;s<e;s++)(!this._activeProviderReplies.has(s)||this._activeProviderReplies.get(s))&&(a=!0);if(!a&&n){let s=n.find(i=>this._linkAtPosition(i.link,t));s&&(r=!0,this._handleNewLink(s))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!r)for(let s=0;s<this._activeProviderReplies.size;s++){let i=this._activeProviderReplies.get(s)?.find(l=>this._linkAtPosition(l.link,t));if(i){r=!0,this._handleNewLink(i);break}}return r}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._currentLink)return;let t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink&&SQe(this._mouseDownLink.link,this._currentLink.link)&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,t){!this._currentLink||!this._lastMouseEvent||(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,Dh(this._linkCacheDisposables),this._linkCacheDisposables.length=0)}_handleNewLink(e){if(!this._lastMouseEvent)return;let t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(e.link,t)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0?!0:e.link.decorations.underline,pointerCursor:e.link.decorations===void 0?!0:e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:r=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==r&&(this._currentLink.state.decorations.pointerCursor=r,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",r))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:r=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==r&&(this._currentLink.state.decorations.underline=r,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,r))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(r=>{if(!this._currentLink)return;let n=r.start===0?0:r.start+1+this._bufferService.buffer.ydisp,a=this._bufferService.buffer.ydisp+1+r.end;if(this._currentLink.link.range.start.y>=n&&this._currentLink.link.range.end.y<=a&&(this._clearCurrentLink(n,a),this._lastMouseEvent)){let s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._askForLink(s,!1)}})))}_linkHover(e,t,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(r,t.text)}_fireUnderlineEvent(e,t){let r=e.range,n=this._bufferService.buffer.ydisp,a=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-n-1,r.end.x,r.end.y-n-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(a)}_linkLeave(e,t,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(r,t.text)}_linkAtPosition(e,t){let r=e.range.start.y*this._bufferService.cols+e.range.start.x,n=e.range.end.y*this._bufferService.cols+e.range.end.x,a=t.y*this._bufferService.cols+t.x;return r<=a&&a<=n}_positionFromMouseEvent(e,t,r){let n=r.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(n)return{x:n[0],y:n[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,t,r,n,a){return{x1:e,y1:t,x2:r,y2:n,cols:this._bufferService.cols,fg:a}}};zP=Zn([mt(1,yB),mt(2,bu),mt(3,Us),mt(4,Lhe)],zP);function SQe(e,t){return e.text===t.text&&e.range.start.x===t.range.start.x&&e.range.start.y===t.range.start.y&&e.range.end.x===t.range.end.x&&e.range.end.y===t.range.end.y}var kQe=class extends mQe{constructor(e={}){super(e),this._linkifier=this._register(new Lg),this.browser=Zhe,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this._register(new Lg),this._onCursorMove=this._register(new rt),this.onCursorMove=this._onCursorMove.event,this._onKey=this._register(new rt),this.onKey=this._onKey.event,this._onRender=this._register(new rt),this.onRender=this._onRender.event,this._onSelectionChange=this._register(new rt),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this._register(new rt),this.onTitleChange=this._onTitleChange.event,this._onBell=this._register(new rt),this.onBell=this._onBell.event,this._onFocus=this._register(new rt),this._onBlur=this._register(new rt),this._onA11yCharEmitter=this._register(new rt),this._onA11yTabEmitter=this._register(new rt),this._onWillOpen=this._register(new rt),this._setup(),this._decorationService=this._instantiationService.createInstance(bQe),this._instantiationService.setService(d1,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(fYe),this._instantiationService.setService(Lhe,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(sP)),this._register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this._register(this._inputHandler.onRequestRefreshRows(t=>this.refresh(t?.start??0,t?.end??this.rows-1))),this._register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this._register(this._inputHandler.onRequestReset(()=>this.reset())),this._register(this._inputHandler.onRequestWindowsOptionsReport(t=>this._reportWindowsOptions(t))),this._register(this._inputHandler.onColor(t=>this._handleColorEvent(t))),this._register(ls.forward(this._inputHandler.onCursorMove,this._onCursorMove)),this._register(ls.forward(this._inputHandler.onTitleChange,this._onTitleChange)),this._register(ls.forward(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this._register(ls.forward(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this._register(this._bufferService.onResize(t=>this._afterResize(t.cols,t.rows))),this._register(Mn(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}get linkifier(){return this._linkifier.value}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(e){if(this._themeService)for(let t of e){let r,n="";switch(t.index){case 256:r="foreground",n="10";break;case 257:r="background",n="11";break;case 258:r="cursor",n="12";break;default:r="ansi",n="4;"+t.index}switch(t.type){case 0:let a=kn.toColorRGB(r==="ansi"?this._themeService.colors.ansi[t.index]:this._themeService.colors[r]);this.coreService.triggerDataEvent(`${qe.ESC}]${n};${lQe(a)}${Qhe.ST}`);break;case 1:if(r==="ansi")this._themeService.modifyColors(s=>s.ansi[t.index]=ha.toColor(...t.color));else{let s=r;this._themeService.modifyColors(i=>i[s]=ha.toColor(...t.color))}break;case 2:this._themeService.restoreColor(t.index);break}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(cC,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(qe.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(qe.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(!t)return;let r=Math.min(this.buffer.x,this.cols-1),n=this._renderService.dimensions.css.cell.height,a=t.getWidth(r),s=this._renderService.dimensions.css.cell.width*a,i=this.buffer.y*this._renderService.dimensions.css.cell.height,l=r*this._renderService.dimensions.css.cell.width;this.textarea.style.left=l+"px",this.textarea.style.top=i+"px",this.textarea.style.width=s+"px",this.textarea.style.height=n+"px",this.textarea.style.lineHeight=n+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this._register(Xt(this.element,"copy",t=>{this.hasSelection()&&jGe(t,this._selectionService)}));let e=t=>EGe(t,this.textarea,this.coreService,this.optionsService);this._register(Xt(this.textarea,"paste",e)),this._register(Xt(this.element,"paste",e)),Xhe?this._register(Xt(this.element,"mousedown",t=>{t.button===2&&yZ(t,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this._register(Xt(this.element,"contextmenu",t=>{yZ(t,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),jB&&this._register(Xt(this.element,"auxclick",t=>{t.button===1&&_he(t,this.textarea,this.screenElement)}))}_bindKeys(){this._register(Xt(this.textarea,"keyup",e=>this._keyUp(e),!0)),this._register(Xt(this.textarea,"keydown",e=>this._keyDown(e),!0)),this._register(Xt(this.textarea,"keypress",e=>this._keyPress(e),!0)),this._register(Xt(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this._register(Xt(this.textarea,"compositionupdate",e=>this._compositionHelper.compositionupdate(e))),this._register(Xt(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this._register(Xt(this.textarea,"input",e=>this._inputEvent(e),!0)),this._register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(e){if(!e)throw new Error("Terminal requires a parent element.");if(e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService){this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView);return}this._document=e.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);let t=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),t.appendChild(this._viewportElement),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._register(Xt(this.screenElement,"mousemove",a=>this.updateCursorStyle(a))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),t.appendChild(this.screenElement);let r=this.textarea=this._document.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",rP.get()),rme||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._register(this.optionsService.onSpecificOptionChange("disableStdin",()=>r.readOnly=this.optionsService.rawOptions.disableStdin)),this.textarea.readOnly=this.optionsService.rawOptions.disableStdin,this._coreBrowserService=this._register(this._instantiationService.createInstance(uYe,this.textarea,e.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(vu,this._coreBrowserService),this._register(Xt(this.textarea,"focus",a=>this._handleTextAreaFocus(a))),this._register(Xt(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(CP,this._document,this._helperContainer),this._instantiationService.setService(h2,this._charSizeService),this._themeService=this._instantiationService.createInstance(TP),this._instantiationService.setService(m0,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(iC),this._instantiationService.setService(Dhe,this._characterJoinerService),this._renderService=this._register(this._instantiationService.createInstance(EP,this.rows,this.screenElement)),this._instantiationService.setService(bu,this._renderService),this._register(this._renderService.onRenderedViewportChange(a=>this._onRender.fire(a))),this.onResize(a=>this._renderService.resize(a.cols,a.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(kP,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(jP),this._instantiationService.setService(yB,this._mouseService);let n=this._linkifier.value=this._register(this._instantiationService.createInstance(zP,this.screenElement));this.element.appendChild(t);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this._register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this._register(this.onBlur(()=>this._renderService.handleBlur())),this._register(this.onFocus(()=>this._renderService.handleFocus())),this._viewport=this._register(this._instantiationService.createInstance(wP,this.element,this.screenElement)),this._register(this._viewport.onRequestScrollLines(a=>{super.scrollLines(a,!1),this.refresh(0,this.rows-1)})),this._selectionService=this._register(this._instantiationService.createInstance(MP,this.element,this.screenElement,n)),this._instantiationService.setService(RGe,this._selectionService),this._register(this._selectionService.onRequestScrollLines(a=>this.scrollLines(a.amount,a.suppressScrollEvent))),this._register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this._register(this._selectionService.onRequestRedraw(a=>this._renderService.handleSelectionChanged(a.start,a.end,a.columnSelectMode))),this._register(this._selectionService.onLinuxMouseSelection(a=>{this.textarea.value=a,this.textarea.focus(),this.textarea.select()})),this._register(ls.any(this._onScroll.event,this._inputHandler.onScroll)(()=>{this._selectionService.refresh(),this._viewport?.queueSync()})),this._register(this._instantiationService.createInstance(SP,this.screenElement)),this._register(Xt(this.element,"mousedown",a=>this._selectionService.handleMouseDown(a))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(cC,this)),this._register(this.optionsService.onSpecificOptionChange("screenReaderMode",a=>this._handleScreenReaderModeOptionChange(a))),this.options.overviewRuler.width&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(sC,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRuler",a=>{!this._overviewRulerRenderer&&a&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(sC,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(NP,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){let e=this,t=this.element;function r(s){let i=e._mouseService.getMouseReportCoords(s,e.screenElement);if(!i)return!1;let l,c;switch(s.overrideType||s.type){case"mousemove":c=32,s.buttons===void 0?(l=3,s.button!==void 0&&(l=s.button<3?s.button:3)):l=s.buttons&1?0:s.buttons&4?1:s.buttons&2?2:3;break;case"mouseup":c=0,l=s.button<3?s.button:3;break;case"mousedown":c=1,l=s.button<3?s.button:3;break;case"wheel":if(e._customWheelEventHandler&&e._customWheelEventHandler(s)===!1)return!1;let u=s.deltaY;if(u===0||e.coreMouseService.consumeWheelEvent(s,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return!1;c=u<0?0:1,l=4;break;default:return!1}return c===void 0||l===void 0||l>4?!1:e.coreMouseService.triggerMouseEvent({col:i.col,row:i.row,x:i.x,y:i.y,button:l,action:c,ctrl:s.ctrlKey,alt:s.altKey,shift:s.shiftKey})}let n={mouseup:null,wheel:null,mousedrag:null,mousemove:null},a={mouseup:s=>(r(s),s.buttons||(this._document.removeEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.removeEventListener("mousemove",n.mousedrag)),this.cancel(s)),wheel:s=>(r(s),this.cancel(s,!0)),mousedrag:s=>{s.buttons&&r(s)},mousemove:s=>{s.buttons||r(s)}};this._register(this.coreMouseService.onProtocolChange(s=>{s?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(s)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),s&8?n.mousemove||(t.addEventListener("mousemove",a.mousemove),n.mousemove=a.mousemove):(t.removeEventListener("mousemove",n.mousemove),n.mousemove=null),s&16?n.wheel||(t.addEventListener("wheel",a.wheel,{passive:!1}),n.wheel=a.wheel):(t.removeEventListener("wheel",n.wheel),n.wheel=null),s&2?n.mouseup||(n.mouseup=a.mouseup):(this._document.removeEventListener("mouseup",n.mouseup),n.mouseup=null),s&4?n.mousedrag||(n.mousedrag=a.mousedrag):(this._document.removeEventListener("mousemove",n.mousedrag),n.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this._register(Xt(t,"mousedown",s=>{if(s.preventDefault(),this.focus(),!(!this.coreMouseService.areMouseEventsActive||this._selectionService.shouldForceSelection(s)))return r(s),n.mouseup&&this._document.addEventListener("mouseup",n.mouseup),n.mousedrag&&this._document.addEventListener("mousemove",n.mousedrag),this.cancel(s)})),this._register(Xt(t,"wheel",s=>{if(!n.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(s)===!1)return!1;if(!this.buffer.hasScrollback){if(s.deltaY===0)return!1;if(e.coreMouseService.consumeWheelEvent(s,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return this.cancel(s,!0);let i=qe.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(s.deltaY<0?"A":"B");return this.coreService.triggerDataEvent(i,!0),this.cancel(s,!0)}}},{passive:!1}))}refresh(e,t){this._renderService?.refreshRows(e,t)}updateCursorStyle(e){this._selectionService?.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(e,t){this._viewport?this._viewport.scrollLines(e):super.scrollLines(e,t),this.refresh(0,this.rows-1)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){e&&this._viewport?this._viewport.scrollToLine(this.buffer.ybase,!0):this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let t=e-this._bufferService.buffer.ydisp;t!==0&&this.scrollLines(t)}paste(e){khe(e,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(e){this._customKeyEventHandler=e}attachCustomWheelEventHandler(e){this._customWheelEventHandler=e}registerLinkProvider(e){return this._linkProviderService.registerLinkProvider(e)}registerCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}deregisterCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}registerDecoration(e){return this._decorationService.registerDecoration(e)}hasSelection(){return this._selectionService?this._selectionService.hasSelection:!1}select(e,t,r){this._selectionService.setSelection(e,t,r)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(!(!this._selectionService||!this._selectionService.hasSelection))return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(e,t){this._selectionService?.selectLines(e,t)}_keyDown(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;let t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(!0),!1;!t&&(e.key==="Dead"||e.key==="AltGraph")&&(this._unprocessedDeadKey=!0);let r=gQe(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),r.type===3||r.type===2){let n=this.rows-1;return this.scrollLines(r.type===2?-n:n),this.cancel(e,!0)}if(r.type===1&&this.selectAll(),this._isThirdLevelShift(this.browser,e)||(r.cancel&&this.cancel(e,!0),!r.key)||e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.key.length===1&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)return!0;if(this._unprocessedDeadKey)return this._unprocessedDeadKey=!1,!0;if((r.key===qe.ETX||r.key===qe.CR)&&(this.textarea.value=""),this._onKey.fire({key:r.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(r.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey)return this.cancel(e,!0);this._keyDownHandled=!0}_isThirdLevelShift(e,t){let r=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return t.type==="keypress"?r:r&&(!t.keyCode||t.keyCode>47)}_keyUp(e){this._keyDownSeen=!1,!(this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)&&(_Qe(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}_keyPress(e){let t;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(e.which===null||e.which===void 0)t=e.keyCode;else if(e.which!==0&&e.charCode!==0)t=e.which;else return!1;return!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)?!1:(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,!0)}_inputEvent(e){if(e.data&&e.inputType==="insertText"&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}resize(e,t){if(e===this.cols&&t===this.rows){this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure();return}super.resize(e,t)}_afterResize(e,t){this._charSizeService?.measure()}clear(){if(!(this.buffer.ybase===0&&this.buffer.y===0)){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(fa));this._onScroll.fire({position:this.buffer.ydisp}),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;let e=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this._customKeyEventHandler=e,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(qe.ESC+"[I"):this.coreService.triggerDataEvent(qe.ESC+"[O")}_reportWindowsOptions(e){if(this._renderService)switch(e){case 0:let t=this._renderService.dimensions.css.canvas.width.toFixed(0),r=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${qe.ESC}[4;${r};${t}t`);break;case 1:let n=this._renderService.dimensions.css.cell.width.toFixed(0),a=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${qe.ESC}[6;${a};${n}t`);break}}cancel(e,t){if(!(!this.options.cancelEvents&&!t))return e.preventDefault(),e.stopPropagation(),!1}};function _Qe(e){return e.keyCode===16||e.keyCode===17||e.keyCode===18}var NQe=class{constructor(){this._addons=[]}dispose(){for(let e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}loadAddon(e,t){let r={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(r),t.dispose=()=>this._wrappedAddonDispose(r),t.activate(e)}_wrappedAddonDispose(e){if(e.isDisposed)return;let t=-1;for(let r=0;r<this._addons.length;r++)if(this._addons[r]===e){t=r;break}if(t===-1)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}},CQe=class{constructor(e){this._line=e}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new So)}translateToString(e,t,r){return this._line.translateToString(e,t,r)}},uX=class{constructor(e,t){this._buffer=e,this.type=t}init(e){return this._buffer=e,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(e){let t=this._buffer.lines.get(e);if(t)return new CQe(t)}getNullCell(){return new So}},jQe=class extends gr{constructor(e){super(),this._core=e,this._onBufferChange=this._register(new rt),this.onBufferChange=this._onBufferChange.event,this._normal=new uX(this._core.buffers.normal,"normal"),this._alternate=new uX(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}},EQe=class{constructor(e){this._core=e}registerCsiHandler(e,t){return this._core.registerCsiHandler(e,r=>t(r.toArray()))}addCsiHandler(e,t){return this.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._core.registerDcsHandler(e,(r,n)=>t(r,n.toArray()))}addDcsHandler(e,t){return this.registerDcsHandler(e,t)}registerEscHandler(e,t){return this._core.registerEscHandler(e,t)}addEscHandler(e,t){return this.registerEscHandler(e,t)}registerOscHandler(e,t){return this._core.registerOscHandler(e,t)}addOscHandler(e,t){return this.registerOscHandler(e,t)}},MQe=class{constructor(e){this._core=e}register(e){this._core.unicodeService.register(e)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(e){this._core.unicodeService.activeVersion=e}},TQe=["cols","rows"],ul=0,AQe=class extends gr{constructor(e){super(),this._core=this._register(new kQe(e)),this._addonManager=this._register(new NQe),this._publicOptions={...this._core.options};let t=n=>this._core.options[n],r=(n,a)=>{this._checkReadonlyOptions(n),this._core.options[n]=a};for(let n in this._core.options){let a={get:t.bind(this,n),set:r.bind(this,n)};Object.defineProperty(this._publicOptions,n,a)}}_checkReadonlyOptions(e){if(TQe.includes(e))throw new Error(`Option "${e}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new EQe(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new MQe(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this._register(new jQe(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let e=this._core.coreService.decPrivateModes,t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any";break}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,synchronizedOutputMode:e.synchronizedOutput,wraparoundMode:e.wraparound}}get options(){return this._publicOptions}set options(e){for(let t in e)this._publicOptions[t]=e[t]}blur(){this._core.blur()}focus(){this._core.focus()}input(e,t=!0){this._core.input(e,t)}resize(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}open(e){this._core.open(e)}attachCustomKeyEventHandler(e){this._core.attachCustomKeyEventHandler(e)}attachCustomWheelEventHandler(e){this._core.attachCustomWheelEventHandler(e)}registerLinkProvider(e){return this._core.registerLinkProvider(e)}registerCharacterJoiner(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}deregisterCharacterJoiner(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}registerMarker(e=0){return this._verifyIntegers(e),this._core.registerMarker(e)}registerDecoration(e){return this._checkProposedApi(),this._verifyPositiveIntegers(e.x??0,e.width??0,e.height??0),this._core.registerDecoration(e)}hasSelection(){return this._core.hasSelection()}select(e,t,r){this._verifyIntegers(e,t,r),this._core.select(e,t,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}dispose(){super.dispose()}scrollLines(e){this._verifyIntegers(e),this._core.scrollLines(e)}scrollPages(e){this._verifyIntegers(e),this._core.scrollPages(e)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(e){this._verifyIntegers(e),this._core.scrollToLine(e)}clear(){this._core.clear()}write(e,t){this._core.write(e,t)}writeln(e,t){this._core.write(e),this._core.write(`\r
`,t)}paste(e){this._core.paste(e)}refresh(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(e){this._addonManager.loadAddon(this,e)}static get strings(){return{get promptLabel(){return rP.get()},set promptLabel(e){rP.set(e)},get tooMuchOutput(){return nP.get()},set tooMuchOutput(e){nP.set(e)}}}_verifyIntegers(...e){for(ul of e)if(ul===1/0||isNaN(ul)||ul%1!==0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...e){for(ul of e)if(ul&&(ul===1/0||isNaN(ul)||ul%1!==0||ul<0))throw new Error("This API only accepts positive integers")}};/**
 * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * @license MIT
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 */var DQe=2,LQe=1,OQe=class{activate(e){this._terminal=e}dispose(){}fit(){let e=this.proposeDimensions();if(!e||!this._terminal||isNaN(e.cols)||isNaN(e.rows))return;let t=this._terminal._core;(this._terminal.rows!==e.rows||this._terminal.cols!==e.cols)&&(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let e=this._terminal._core._renderService.dimensions;if(e.css.cell.width===0||e.css.cell.height===0)return;let t=this._terminal.options.scrollback===0?0:this._terminal.options.overviewRuler?.width||14,r=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(r.getPropertyValue("height")),a=Math.max(0,parseInt(r.getPropertyValue("width"))),s=window.getComputedStyle(this._terminal.element),i={top:parseInt(s.getPropertyValue("padding-top")),bottom:parseInt(s.getPropertyValue("padding-bottom")),right:parseInt(s.getPropertyValue("padding-right")),left:parseInt(s.getPropertyValue("padding-left"))},l=i.top+i.bottom,c=i.right+i.left,u=n-l,d=a-c-t;return{cols:Math.max(DQe,Math.floor(d/e.css.cell.width)),rows:Math.max(LQe,Math.floor(u/e.css.cell.height))}}};/**
 * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * @license MIT
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 */var IQe=class{constructor(e,t,r,n={}){this._terminal=e,this._regex=t,this._handler=r,this._options=n}provideLinks(e,t){let r=PQe.computeLink(e,this._regex,this._terminal,this._handler);t(this._addCallbacks(r))}_addCallbacks(e){return e.map(t=>(t.leave=this._options.leave,t.hover=(r,n)=>{if(this._options.hover){let{range:a}=t;this._options.hover(r,n,a)}},t))}};function RQe(e){try{let t=new URL(e),r=t.password&&t.username?`${t.protocol}//${t.username}:${t.password}@${t.host}`:t.username?`${t.protocol}//${t.username}@${t.host}`:`${t.protocol}//${t.host}`;return e.toLocaleLowerCase().startsWith(r.toLocaleLowerCase())}catch{return!1}}var PQe=class Dk{static computeLink(t,r,n,a){let s=new RegExp(r.source,(r.flags||"")+"g"),[i,l]=Dk._getWindowedLineStrings(t-1,n),c=i.join(""),u,d=[];for(;u=s.exec(c);){let f=u[0];if(!RQe(f))continue;let[m,p]=Dk._mapStrIdx(n,l,0,u.index),[v,b]=Dk._mapStrIdx(n,m,p,f.length);if(m===-1||p===-1||v===-1||b===-1)continue;let y={start:{x:p+1,y:m+1},end:{x:b,y:v+1}};d.push({range:y,text:f,activate:a})}return d}static _getWindowedLineStrings(t,r){let n,a=t,s=t,i=0,l="",c=[];if(n=r.buffer.active.getLine(t)){let u=n.translateToString(!0);if(n.isWrapped&&u[0]!==" "){for(i=0;(n=r.buffer.active.getLine(--a))&&i<2048&&(l=n.translateToString(!0),i+=l.length,c.push(l),!(!n.isWrapped||l.indexOf(" ")!==-1)););c.reverse()}for(c.push(u),i=0;(n=r.buffer.active.getLine(++s))&&n.isWrapped&&i<2048&&(l=n.translateToString(!0),i+=l.length,c.push(l),l.indexOf(" ")===-1););}return[c,a]}static _mapStrIdx(t,r,n,a){let s=t.buffer.active,i=s.getNullCell(),l=n;for(;a;){let c=s.getLine(r);if(!c)return[-1,-1];for(let u=l;u<c.length;++u){c.getCell(u,i);let d=i.getChars();if(i.getWidth()&&(a-=d.length||1,u===c.length-1&&d==="")){let f=s.getLine(r+1);f&&f.isWrapped&&(f.getCell(0,i),i.getWidth()===2&&(a+=1))}if(a<0)return[r,u]}r++,l=0}return[r,l]}},zQe=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function BQe(e,t){let r=window.open();if(r){try{r.opener=null}catch{}r.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}var $Qe=class{constructor(e=BQe,t={}){this._handler=e,this._options=t}activate(e){this._terminal=e;let t=this._options,r=t.urlRegex||zQe;this._linkProvider=this._terminal.registerLinkProvider(new IQe(this._terminal,r,this._handler,t))}dispose(){this._linkProvider?.dispose()}};const FQe={background:"#1a1a1a",foreground:"#e0e0e0",cursor:"#e0e0e0",cursorAccent:"#1a1a1a",selectionBackground:"#404040",selectionForeground:"#ffffff",black:"#1a1a1a",red:"#ff5555",green:"#50fa7b",yellow:"#f1fa8c",blue:"#6272a4",magenta:"#ff79c6",cyan:"#8be9fd",white:"#e0e0e0",brightBlack:"#555555",brightRed:"#ff6e6e",brightGreen:"#69ff94",brightYellow:"#ffffa5",brightBlue:"#d6acff",brightMagenta:"#ff92df",brightCyan:"#a4ffff",brightWhite:"#ffffff"},UQe={background:"#ffffff",foreground:"#333333",cursor:"#333333",cursorAccent:"#ffffff",selectionBackground:"#add6ff",selectionForeground:"#000000",black:"#000000",red:"#cd3131",green:"#00bc00",yellow:"#949800",blue:"#0451a5",magenta:"#bc05bc",cyan:"#0598bc",white:"#555555",brightBlack:"#666666",brightRed:"#cd3131",brightGreen:"#14ce14",brightYellow:"#b5ba00",brightBlue:"#0451a5",brightMagenta:"#bc05bc",brightCyan:"#0598bc",brightWhite:"#a5a5a5"},HQe=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`,qQe=window.location.origin,EB=w.forwardRef(function({agentId:t,wsUrl:r=HQe,apiUrl:n=qQe,onStatusChange:a,onConnected:s,onData:i,theme:l="dark",fontSize:c=13,fontFamily:u='"JetBrains Mono", "Fira Code", Consolas, "Liberation Mono", Menlo, Courier, monospace',autoFit:d=!0,interactive:f=!0,autoFocus:m=!1,controlsResize:p=!0,enableFileDrop:v,"data-testid":b="xterminal"},y){const S=w.useRef(null),_=w.useRef(null),N=w.useRef(null),k=w.useRef(null),[j,E]=w.useState("disconnected"),[T,O]=w.useState(!1),[R,H]=w.useState(!1),$=w.useRef(0),L=5,A=w.useRef(null),M=w.useRef(!1),P=w.useRef(null),I=w.useRef(!1),B=v??f,F=w.useRef(a),q=w.useRef(s);w.useEffect(()=>{F.current=a,q.current=s},[a,s]);const Q=w.useCallback(re=>{E(re),F.current?.(re)},[]),W=w.useCallback(re=>{k.current?.readyState===WebSocket.OPEN&&k.current.send(JSON.stringify({type:"input",input:re}))},[]);w.useEffect(()=>{if(!S.current||_.current)return;const re=new AQe({theme:l==="dark"?FQe:UQe,fontSize:c,fontFamily:u,cursorBlink:!0,cursorStyle:"block",scrollback:1e4,allowProposedApi:!0,convertEol:!0,disableStdin:!f}),ne=new OQe,me=new $Qe;return re.loadAddon(ne),re.loadAddon(me),re.open(S.current),d&&ne.fit(),f&&re.onData(ke=>{W(ke),i?.(ke)}),_.current=re,N.current=ne,m&&f&&setTimeout(()=>re.focus(),100),()=>{re.dispose(),_.current=null,N.current=null}},[l,c,u,d,f,m,W,i]),w.useEffect(()=>{if(!d||!S.current||!N.current)return;let re=null;const ne=()=>{if(p&&k.current?.readyState===WebSocket.OPEN&&N.current){const we=N.current.proposeDimensions();if(we){const pe=P.current;if(pe&&pe.cols===we.cols&&pe.rows===we.rows)return;P.current={cols:we.cols,rows:we.rows},k.current.send(JSON.stringify({type:"resize",cols:we.cols,rows:we.rows}))}}},me=()=>{try{N.current?.fit(),re&&clearTimeout(re),re=setTimeout(ne,150)}catch{}},ke=new ResizeObserver(me);return ke.observe(S.current),()=>{ke.disconnect(),re&&clearTimeout(re)}},[d,p]),w.useEffect(()=>{if(!t){Q("disconnected");return}M.current=!1,A.current=null,P.current=null,I.current=!1;let re=!1;const ne=()=>{Q("connecting");const we=new WebSocket(r);k.current=we,we.onopen=()=>{$.current=0,we.send(JSON.stringify({type:"subscribe",agentId:t}))},we.onmessage=pe=>{try{const Oe=JSON.parse(pe.data);switch(Oe.type){case"subscribed":if(Q("connected"),q.current?.(),M.current=!0,p&&Oe.hasSession&&N.current&&_.current){const Ae=N.current.proposeDimensions();Ae&&k.current?.readyState===WebSocket.OPEN&&(P.current={cols:Ae.cols,rows:Ae.rows},k.current.send(JSON.stringify({type:"resize",cols:Ae.cols,rows:Ae.rows})))}break;case"pty-data":Oe.data&&_.current?.write(Oe.data);break;case"event":Oe.event&&me(Oe.event);break;case"error":_.current?.writeln(`\x1B[31m  Error: ${Oe.error}\x1B[0m`);break;case"exit":_.current?.writeln("\x1B[90m  Session ended\x1B[0m"),A.current=null;break;case"pong":break;case"session-started":{const Ae=Oe.sessionId;if(Ae&&Ae===A.current)break;if(A.current=Ae??null,P.current=null,_.current?.clear(),p&&Oe.isInteractive&&N.current&&_.current){const Re=N.current.proposeDimensions();Re&&k.current?.readyState===WebSocket.OPEN&&(P.current={cols:Re.cols,rows:Re.rows},k.current.send(JSON.stringify({type:"resize",cols:Re.cols,rows:Re.rows})))}break}}}catch(Oe){console.error("[XTerminal] Error parsing message:",Oe)}},we.onerror=()=>{Q("error"),_.current?.writeln("\x1B[31m  WebSocket error\x1B[0m")},we.onclose=()=>{if(I.current){I.current=!1;return}if(!re)if($.current<L){$.current++;const pe=Math.min(1e3*Math.pow(2,$.current),3e4);_.current?.writeln(`\x1B[33m  Reconnecting in ${pe/1e3}s (attempt ${$.current}/${L})...\x1B[0m`),setTimeout(()=>{re||ne()},pe)}else Q("error"),_.current?.writeln("\x1B[31m  Connection lost. Max reconnect attempts reached.\x1B[0m")}},me=we=>{const pe=_.current;if(pe)switch(we.type){case"assistant":we.content&&pe.write(we.content);break;case"tool_use":pe.writeln(`\x1B[36m[Tool: ${we.data?.name??"unknown"}]\x1B[0m`);break;case"tool_result":we.output&&pe.writeln(`\x1B[90m${we.output}\x1B[0m`);break;case"system":we.content&&pe.writeln(`\x1B[33m[System] ${we.content}\x1B[0m`);break;case"error":pe.writeln(`\x1B[31m[Error] ${we.content??"Unknown error"}\x1B[0m`);break}};ne();const ke=setInterval(()=>{k.current?.readyState===WebSocket.OPEN&&k.current.send(JSON.stringify({type:"ping"}))},3e4);return()=>{re=!0,clearInterval(ke),k.current&&(I.current=!0,k.current.close(),k.current=null)}},[t,r,Q]);const G=w.useCallback(re=>{_.current?.write(re)},[]),J=w.useCallback(re=>{_.current?.writeln(re)},[]),X=w.useCallback(()=>{_.current?.clear()},[]),V=w.useCallback(()=>{_.current?.focus()},[]),se=w.useCallback(()=>{N.current?.fit()},[]),de=w.useCallback(()=>{if(!N.current||!_.current)return;const re=_.current;re.clearTextureAtlas();const ne=N.current.proposeDimensions();if(!ne)return;const me=ne.cols,ke=ne.rows;if(p&&k.current?.readyState===WebSocket.OPEN){const we=Math.max(1,me-2),pe=Math.max(1,ke-1);re.resize(we,pe),k.current.send(JSON.stringify({type:"resize",cols:we,rows:pe}))}setTimeout(()=>{if(!_.current||!N.current)return;if(N.current.fit(),p&&k.current?.readyState===WebSocket.OPEN){const pe=N.current.proposeDimensions();pe&&(P.current={cols:pe.cols,rows:pe.rows},k.current.send(JSON.stringify({type:"resize",cols:pe.cols,rows:pe.rows})))}const we=_.current.rows;_.current.refresh(0,we-1)},100)},[p]),he=w.useCallback(re=>{W(re)},[W]),te=w.useCallback(()=>{if(!N.current)return null;const re=N.current.proposeDimensions();return re?{cols:re.cols,rows:re.rows}:null},[]);w.useImperativeHandle(y,()=>({refresh:de,write:G,writeln:J,clear:X,focus:V,fit:se,sendInput:he,getDimensions:te}),[de,G,J,X,V,se,he,te]),w.useEffect(()=>(window.__xterminal={write:G,writeln:J,clear:X,focus:V,fit:se,sendInput:he,getStatus:()=>j},()=>{delete window.__xterminal}),[G,J,X,V,se,he,j]);const le=w.useCallback(()=>{f&&_.current?.focus()},[f]),oe=w.useCallback(async re=>{try{const ne=await re.arrayBuffer(),me=btoa(new Uint8Array(ne).reduce((pe,Oe)=>pe+String.fromCharCode(Oe),"")),ke=await fetch(`${n}/api/terminal/upload`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:re.name,data:me})});if(!ke.ok){const pe=await ke.json().catch(()=>({}));throw new Error(pe.error?.message||`Upload failed: ${ke.status}`)}return(await ke.json()).path}catch(ne){return console.error("[XTerminal] File upload failed:",ne),_.current?.writeln(`\x1B[31m  File upload failed: ${ne instanceof Error?ne.message:"Unknown error"}\x1B[0m`),null}},[n]),Z=w.useCallback(re=>{const ne=Array.from(re.dataTransfer.types);return ne.includes("application/x-workspace-pane")?!1:ne.includes("Files")&&!ne.includes("text/plain")},[]),ve=w.useCallback(async re=>{if(!Z(re)||(re.preventDefault(),re.stopPropagation(),O(!1),!B||!f))return;const ne=Array.from(re.dataTransfer.files);if(ne.length===0)return;H(!0),_.current?.writeln(`\x1B[90m  Uploading ${ne.length} file(s)...\x1B[0m`);const me=[];for(const ke of ne){const we=await oe(ke);we&&me.push(we)}if(H(!1),me.length>0){const ke=me.join(" ")+" ";W(ke),_.current?.writeln(`\x1B[32m  ${me.length} file(s) uploaded and path(s) inserted\x1B[0m`)}},[B,f,oe,W,Z]),U=w.useCallback(re=>{if(!Z(re)){re.preventDefault();return}re.preventDefault(),re.stopPropagation(),B&&f&&O(!0)},[B,f,Z]),ge=w.useCallback(re=>{if(!Z(re)){re.preventDefault();return}re.preventDefault(),re.stopPropagation(),B&&f&&O(!0)},[B,f,Z]),ue=w.useCallback(re=>{if(!Z(re))return;re.preventDefault(),re.stopPropagation();const ne=S.current?.getBoundingClientRect();if(ne){const{clientX:me,clientY:ke}=re;(me<ne.left||me>=ne.right||ke<ne.top||ke>=ne.bottom)&&O(!1)}},[Z]);return o.jsxs("div",{ref:S,"data-testid":b,"data-status":j,"data-drag-over":T,className:"relative w-full h-full overflow-hidden cursor-text",style:{minHeight:"200px"},onClick:le,onDrop:ve,onDragOver:U,onDragEnter:ge,onDragLeave:ue,children:[T&&B&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-primary)]/20 border-2 border-dashed border-[var(--color-primary)] rounded-lg pointer-events-none","data-testid":"file-drop-overlay",children:o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 rounded-lg bg-[var(--color-bg)]/90 shadow-lg",children:[o.jsx("svg",{className:"w-10 h-10 text-[var(--color-primary)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Drop files to upload"}),o.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"File paths will be inserted at cursor"})]})}),R&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-bg)]/50 pointer-events-none","data-testid":"upload-progress-overlay",children:o.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-[var(--color-bg)] shadow-lg border border-[var(--color-border)]",children:[o.jsxs("svg",{className:"w-5 h-5 text-[var(--color-primary)] animate-spin",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Uploading..."})]})})]})}),WQe="/api";async function Va(e,t){const r=await fetch(`${WQe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function m1(e){return pt({queryKey:["agents",e],queryFn:()=>Va(e?`/agents?role=${e}`:"/agents")})}function g2(){return pt({queryKey:["providers"],queryFn:()=>Va("/providers"),staleTime:6e4})}function v2(e){return pt({queryKey:["provider-models",e],queryFn:()=>Va(`/providers/${e}/models`),enabled:!!e,staleTime:6e4})}function fme(e){return pt({queryKey:["agent",e],queryFn:()=>Va(`/agents/${e}`),enabled:!!e})}function MB(e){return pt({queryKey:["agent-status",e],queryFn:()=>Va(`/agents/${e}/status`),enabled:!!e,refetchInterval:5e3})}function b2(e){const t=new URLSearchParams;e?.agentId&&t.set("agentId",e.agentId),e?.role&&t.set("role",e.role),e?.status&&t.set("status",e.status);const r=t.toString(),n=r?`/sessions?${r}`:"/sessions";return pt({queryKey:["sessions",e],queryFn:()=>Va(n),refetchInterval:1e4})}async function hme(e){return Va(`/sessions/${e}/messages`)}function g0(){const{data:e,isLoading:t,error:r,refetch:n}=m1();return{...w.useMemo(()=>{const s=e?.agents??[],i=s.find(f=>f.metadata?.agent?.agentRole==="director"),l=s.filter(f=>f.metadata?.agent?.agentRole==="worker"),c=s.filter(f=>f.metadata?.agent?.agentRole==="steward"),u=l.filter(f=>{const m=f.metadata?.agent;return m?.agentRole==="worker"&&m?.workerMode==="ephemeral"}),d=l.filter(f=>{const m=f.metadata?.agent;return m?.agentRole==="worker"&&m?.workerMode==="persistent"});return{director:i,workers:l,ephemeralWorkers:u,persistentWorkers:d,stewards:c,allAgents:s}},[e?.agents]),isLoading:t,error:r,refetch:n}}function mme(){const{director:e,isLoading:t,error:r,refetch:n}=g0(),{data:a,isLoading:s,error:i}=MB(e?.id),l=w.useMemo(()=>(a?.recentHistory??[]).find(d=>!!d.providerSessionId)??null,[a?.recentHistory]),c=l!==null;return{director:e,hasActiveSession:a?.hasActiveSession??!1,activeSession:a?.activeSession??null,recentHistory:a?.recentHistory??[],lastResumableSession:l,hasResumableSession:c,isLoading:t||s,error:r||i,refetch:n}}function KQe(){const e=ft();return kt({mutationFn:async t=>Va("/agents",{method:"POST",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["agents"]})}})}function y2(){const e=ft();return kt({mutationFn:async({agentId:t,taskId:r,initialPrompt:n,initialMessage:a,interactive:s,cols:i,rows:l})=>Va(`/agents/${t}/start`,{method:"POST",body:JSON.stringify({taskId:r,initialPrompt:n,initialMessage:a,interactive:s,cols:i,rows:l})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function p1(){const e=ft();return kt({mutationFn:async({agentId:t,graceful:r})=>Va(`/agents/${t}/stop`,{method:"POST",body:JSON.stringify({graceful:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]})}})}function GQe(){const e=ft();return kt({mutationFn:async({agentId:t})=>Va(`/agents/${t}/interrupt`,{method:"POST"}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]})}})}function TB(){const e=ft();return kt({mutationFn:async({agentId:t,providerSessionId:r,resumePrompt:n})=>Va(`/agents/${t}/resume`,{method:"POST",body:JSON.stringify({providerSessionId:r,resumePrompt:n})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent-status",r]}),e.invalidateQueries({queryKey:["sessions"]})}})}function VQe(){const e=ft();return kt({mutationFn:async({agentId:t,name:r})=>Va(`/agents/${t}`,{method:"PATCH",body:JSON.stringify({name:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent",r]})}})}function YQe(){const e=ft();return kt({mutationFn:async({agentId:t,provider:r})=>Va(`/agents/${t}`,{method:"PATCH",body:JSON.stringify({provider:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent",r]})}})}function QQe(){const e=ft();return kt({mutationFn:async({agentId:t,model:r})=>Va(`/agents/${t}`,{method:"PATCH",body:JSON.stringify({model:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent",r]})}})}function JQe(){const e=ft();return kt({mutationFn:async({agentId:t,triggers:r})=>Va(`/agents/${t}`,{method:"PATCH",body:JSON.stringify({triggers:r})}),onSuccess:(t,{agentId:r})=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["agent",r]})}})}function ZQe(){const e=ft();return kt({mutationFn:async({agentId:t})=>Va(`/agents/${t}`,{method:"DELETE"}),onSuccess:()=>{e.invalidateQueries({queryKey:["agents"]})}})}function pme(){return pt({queryKey:["operators"],queryFn:()=>Va("/entities?entityType=human&limit=100")})}const XQe="/api";async function x2(e,t){const r=await fetch(`${XQe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function gme(e,t="all"){const r=()=>{switch(t){case"unread":return"unread";case"archived":return"archived";case"all":default:return"unread,read"}};return pt({queryKey:["agent-inbox",e,t],queryFn:()=>x2(`/entities/${e}/inbox?limit=50&hydrate=true&status=${r()}`),enabled:!!e,staleTime:3e4,refetchInterval:3e4})}function AB(e){return pt({queryKey:["agent-inbox-count",e],queryFn:()=>x2(`/entities/${e}/inbox/count`),enabled:!!e,refetchInterval:3e4,staleTime:15e3})}function eJe(e){const t=ft();return kt({mutationFn:async({itemId:r,status:n})=>x2(`/inbox/${r}`,{method:"PATCH",body:JSON.stringify({status:n})}),onSuccess:()=>{t.invalidateQueries({queryKey:["agent-inbox",e]}),t.invalidateQueries({queryKey:["agent-inbox-count",e]})}})}function vme(e){const t=ft();return kt({mutationFn:async()=>x2(`/entities/${e}/inbox/mark-all-read`,{method:"POST"}),onSuccess:()=>{t.invalidateQueries({queryKey:["agent-inbox",e]}),t.invalidateQueries({queryKey:["agent-inbox-count",e]})}})}function bme(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"now":a<60?`${a}m`:s<24?`${s}h`:i<7?`${i}d`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function tJe(e){return new Date(e).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}function rJe(){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/events`}function w2(e={}){const{channels:t=["*"],onEvent:r,onStateChange:n,autoInvalidate:a=!0}=e,s=ft(),l={url:w.useMemo(()=>rJe(),[]),channels:t,onEvent:r,onStateChange:n,autoInvalidate:a,queryClient:s,getQueryKeysForEvent:_ce},c=m6e(l);return{connectionState:c.connectionState,lastEvent:c.lastEvent}}const nJe=/(?<![a-zA-Z0-9])@(?:\*\*|__)?(?:_|\*)?(`)?([a-zA-Z][a-zA-Z0-9_-]*)(`)?(?:\*|_)?(?:\*\*|__)?/g,aJe=/!\[([^\]]*)\]\(([^)]+)\)/g,sJe=/\\?\[([^\]\\]+)\\?\]\(([^)]+)\)/g;function iJe(e){return e[2]}function yme(e){return e.replace(/\\([[\](){}*_`~#>+\-.!|])/g,"$1")}function CL(e){let t=yme(e);return t=t.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),t=t.replace(/__([^_]+)__/g,"<strong>$1</strong>"),t=t.replace(/(?<![a-zA-Z0-9])\*([^*]+)\*(?![a-zA-Z0-9])/g,"<em>$1</em>"),t=t.replace(/(?<![a-zA-Z0-9])_([^_]+)_(?![a-zA-Z0-9])/g,"<em>$1</em>"),t=t.replace(/`([^`]+)`/g,'<code class="bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-sm font-mono">$1</code>'),t=t.replace(/~~([^~]+)~~/g,"<del>$1</del>"),t}function jL(e,t){const r=[];let n=0;const a=new RegExp(nJe.source,"g");let s;for(;(s=a.exec(e))!==null;){if(s.index>n){const l=e.slice(n,s.index),c=CL(l);r.push(o.jsx("span",{dangerouslySetInnerHTML:{__html:c}},`${t}-text-${n}`))}const i=iJe(s);r.push(o.jsxs("span",{className:"text-blue-600 font-medium","data-mention":i,title:`@${i}`,children:["@",i]},`${t}-mention-${s.index}`)),n=s.index+s[0].length}if(n<e.length){const i=e.slice(n),l=CL(i);r.push(o.jsx("span",{dangerouslySetInnerHTML:{__html:l}},`${t}-text-${n}`))}if(r.length===0){const i=CL(e);return[o.jsx("span",{dangerouslySetInnerHTML:{__html:i}},`${t}-text-0`)]}return r}function EL(e,t){const r=yme(e),n=[];let a=0;const s=new RegExp(sJe.source,"g");let i;for(;(i=s.exec(r))!==null;){if(i.index>a){const u=r.slice(a,i.index);n.push(...jL(u,`${t}-before-${i.index}`))}const l=i[1],c=i[2];n.push(o.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:l},`${t}-link-${i.index}`)),a=i.index+i[0].length}if(a<r.length){const l=r.slice(a);n.push(...jL(l,`${t}-after-${a}`))}return n.length>0?n:jL(r,t)}function xme(e){if(!e)return null;const t=[];let r=0;const n=new RegExp(aJe.source,"g");let a;for(;(a=n.exec(e))!==null;){if(a.index>r){const l=e.slice(r,a.index);t.push(o.jsx("span",{children:EL(l,`text-${r}`)},`text-${r}`))}const s=a[1]||"Image",i=a[2];t.push(o.jsx("div",{className:"my-2 block clear-both",children:o.jsx("img",{src:i,alt:s,className:"max-w-full max-h-80 rounded-lg border border-gray-200 dark:border-gray-700 cursor-pointer hover:opacity-90 transition-opacity block",onClick:()=>window.open(i,"_blank"),onLoad:l=>{const c=l.currentTarget;c.style.display="block"},"data-testid":`message-image-${a.index}`})},`image-${a.index}`)),r=a.index+a[0].length}if(r<e.length){const s=e.slice(r);t.push(o.jsx("span",{children:EL(s,`text-${r}`)},`text-${r}`))}return t.length===0?o.jsx("span",{children:EL(e,"content")}):o.jsx(o.Fragment,{children:t})}function oJe(e,t){if(!t.trim())return o.jsx(o.Fragment,{children:e});const r=e.toLowerCase(),n=t.toLowerCase(),a=r.indexOf(n);if(a===-1)return o.jsx(o.Fragment,{children:e});const s=e.slice(0,a),i=e.slice(a,a+t.length),l=e.slice(a+t.length);return o.jsxs(o.Fragment,{children:[s,o.jsx("mark",{className:"bg-yellow-200 text-gray-900 rounded-sm px-0.5","data-testid":"search-highlight",children:i}),l]})}function lJe({directorId:e,hasActiveSession:t,onSendCommand:r,"data-testid":n="pending-messages-queue"}){w2({channels:e?[`inbox:${e}`]:[],autoInvalidate:!0});const{data:a,isLoading:s,error:i,refetch:l}=gme(e,"unread"),c=vme(e??""),u=w.useMemo(()=>a?.items?a.items.filter(p=>p.status==="unread"):[],[a?.items]),d=w.useCallback(()=>{if(!t){console.warn("Cannot process messages: Director has no active session");return}r?.("Check your inbox and process the pending messages"),setTimeout(()=>{r?.("\r")},200)},[t,r]),f=w.useCallback(p=>{if(!t){console.warn("Cannot process message: Director has no active session");return}const v=`Process inbox item ${p}  read it with \`sf show ${p}\` and handle it. Do not process other inbox messages.`;r?.(v),setTimeout(()=>{r?.("\r")},200)},[t,r]),m=w.useCallback(async()=>{if(e)try{await c.mutateAsync()}catch(p){console.error("Failed to mark all messages as read:",p)}},[e,c]);return e?s?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4","data-testid":n,children:[o.jsx(jr,{className:"w-6 h-6 text-[var(--color-text-muted)] animate-spin"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-2",children:"Loading messages..."})]}):i?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center","data-testid":n,children:[o.jsx("p",{className:"text-sm text-[var(--color-danger)]",children:"Failed to load messages"}),o.jsx("button",{onClick:()=>l(),className:"mt-2 text-xs text-[var(--color-primary)] hover:underline",children:"Retry"})]}):o.jsxs("div",{className:"flex flex-col h-full","data-testid":n,children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-bg-secondary)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(JC,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Pending Messages"}),u.length>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded-full bg-[var(--color-primary)] text-white",children:u.length})]}),o.jsx("div",{className:"flex items-center gap-1",children:u.length>0&&o.jsxs(o.Fragment,{children:[o.jsx(Cn,{content:"Mark all as read",side:"bottom",children:o.jsx("button",{onClick:m,disabled:c.isPending,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Mark all as read","data-testid":"mark-all-read-btn",children:c.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(ZC,{className:"w-4 h-4"})})}),o.jsx(Cn,{content:t?"Process messages":"Start director session first",side:"bottom",children:o.jsxs("button",{onClick:d,disabled:!t,className:"flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-medium bg-[var(--color-primary)] text-white hover:bg-[var(--color-primary-hover)] transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Process messages","data-testid":"process-messages-btn",children:[o.jsx(XC,{className:"w-3.5 h-3.5"}),"Process"]})})]})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:u.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[o.jsx(ni,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No pending messages"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:"Messages will appear here when received"})]}):o.jsx("ul",{className:"divide-y divide-[var(--color-border)]","data-testid":"messages-list",children:u.map(p=>o.jsx(cJe,{item:p,hasActiveSession:t,onProcessSingle:f},p.id))})})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center","data-testid":n,children:[o.jsx(ni,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No Director agent"})]})}function cJe({item:e,hasActiveSession:t,onProcessSingle:r}){const n=e.sender?.name??e.message?.sender??"Unknown",a=e.message?.contentPreview??e.message?.fullContent??"",s=e.createdAt,i=e.channel?.name,l=e.sourceType,c=w.useCallback(()=>{r(e.id)},[e.id,r]);return o.jsx("li",{className:"px-3 py-2.5 hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":"message-item",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("div",{className:"flex-shrink-0 w-7 h-7 rounded-full bg-[var(--color-primary)]/10 flex items-center justify-center",children:o.jsx(tn,{className:"w-4 h-4 text-[var(--color-primary)]"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:n}),i&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)] truncate",children:["#",i]}),l==="mention"&&o.jsx("span",{className:"px-1 py-0.5 text-[10px] font-medium rounded bg-blue-500/20 text-blue-400",children:"@mention"}),o.jsxs("div",{className:"flex items-center gap-1 ml-auto flex-shrink-0",children:[o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)] flex items-center gap-1",children:[o.jsx(Rr,{className:"w-3 h-3"}),bme(s)]}),o.jsx(Cn,{content:t?"Process this message":"Start director session first",side:"left",children:o.jsx("button",{onClick:c,disabled:!t,className:"flex items-center gap-1 ml-1 px-1.5 py-0.5 rounded-md text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary)]/10 transition-colors duration-150 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":`Process message ${e.id}`,"data-testid":"process-single-message-btn",children:o.jsx(Yr,{className:"w-3 h-3"})})})]})]}),o.jsx("div",{className:"text-sm text-[var(--color-text-secondary)] line-clamp-2",children:xme(a)})]})]})})}const dX=280,fX=800,hX=384,mX="orchestrator-director-panel-width";function uJe({collapsed:e=!1,onToggle:t,isMaximized:r=!1,onToggleMaximize:n}){const[a,s]=w.useState("disconnected"),[i,l]=w.useState(!1),{director:c,hasActiveSession:u,hasResumableSession:d,lastResumableSession:f,isLoading:m,error:p}=mme(),v=y2(),b=p1(),y=TB(),[S,_]=w.useState(null),N=w.useRef(null),{data:k}=AB(c?.id??null),[j,E]=w.useState(()=>{if(typeof window>"u")return hX;const V=localStorage.getItem(mX);if(V){const se=parseInt(V,10);if(!isNaN(se)&&se>=dX&&se<=fX)return se}return hX}),[T,O]=w.useState(!1),R=w.useRef(null);w.useEffect(()=>{localStorage.setItem(mX,String(j))},[j]);const H=w.useCallback(V=>{V.preventDefault(),O(!0),R.current={startX:V.clientX,startWidth:j}},[j]);w.useEffect(()=>{if(!T)return;document.body.style.cursor="col-resize",document.body.style.userSelect="none";const V=de=>{if(!R.current)return;const he=R.current.startX-de.clientX,te=Math.min(fX,Math.max(dX,R.current.startWidth+he));E(te)},se=()=>{O(!1),R.current=null};return document.addEventListener("mousemove",V),document.addEventListener("mouseup",se),()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",se),document.body.style.cursor="",document.body.style.userSelect=""}},[T]);const L=p||a==="error"?"error":m||a==="connecting"?"connecting":c?u&&a==="connected"?"running":"idle":"no-director",A={idle:"text-[var(--color-text-tertiary)]",running:"text-[var(--color-success)]",error:"text-[var(--color-danger)]",connecting:"text-[var(--color-warning)]","no-director":"text-[var(--color-text-muted)]"}[L],M={idle:"Idle",running:"Running",error:"Error",connecting:"Connecting...","no-director":"No Director"}[L],P=w.useCallback(async()=>{if(c?.id){_(null);try{const V=N.current?.getDimensions();await v.mutateAsync({agentId:c.id,...V&&{cols:V.cols,rows:V.rows}})}catch(V){console.error("Failed to start director session:",V)}}},[c?.id,v]),I=w.useCallback(async()=>{if(!(!c?.id||!f?.providerSessionId)){_(null);try{await y.mutateAsync({agentId:c.id,providerSessionId:f.providerSessionId})}catch(V){console.error("Failed to resume director session:",V),_(V instanceof Error?V.message:"Resume failed")}}},[c?.id,f?.providerSessionId,y]),B=w.useCallback(async()=>{if(c?.id)try{await b.mutateAsync({agentId:c.id,graceful:!0})}catch(V){console.error("Failed to stop director session:",V)}},[c?.id,b]),F=w.useCallback(async()=>{if(c?.id)try{await b.mutateAsync({agentId:c.id,graceful:!0});const V=N.current?.getDimensions();await v.mutateAsync({agentId:c.id,...V&&{cols:V.cols,rows:V.rows}})}catch(V){console.error("Failed to restart director session:",V)}},[c?.id,b,v]),q=w.useCallback(V=>{s(V)},[]);w.useEffect(()=>{if(a==="connected"){const V=setTimeout(()=>{N.current?.refresh()},300);return()=>clearTimeout(V)}},[a]),w.useEffect(()=>{if(a==="connected"){const V=setTimeout(()=>{N.current?.refresh()},100);return()=>clearTimeout(V)}},[r,a]);const Q=w.useCallback(()=>{N.current&&(N.current.sendInput("Use your sift-backlog skill"),setTimeout(()=>{N.current?.sendInput("\r")},200))},[]),W=w.useCallback(()=>{l(V=>!V)},[]),G=w.useCallback(V=>{N.current?.sendInput(V)},[]),J=k?.count??0,X=w.useCallback(()=>{r&&n&&n(),t?.()},[r,n,t]);return e?o.jsx("aside",{className:"flex flex-col items-center py-3 w-12 border-l border-[var(--color-border)] bg-[var(--color-bg-secondary)]","data-testid":"director-panel-collapsed",children:o.jsx(Cn,{content:"Open Director Panel",side:"left",children:o.jsxs("button",{onClick:t,className:"relative p-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":"Open Director Panel","data-testid":"director-panel-expand",children:[o.jsx(na,{className:"w-5 h-5"}),o.jsx(nu,{className:`absolute -top-0.5 -right-0.5 w-2.5 h-2.5 fill-current ${A}`}),J>0&&o.jsx("span",{className:"absolute -bottom-1 -right-1 flex items-center justify-center min-w-[16px] h-4 px-1 text-[10px] font-bold rounded-full bg-[var(--color-primary)] text-white","data-testid":"director-panel-collapsed-unread-badge",children:J>99?"99+":J})]})})}):o.jsxs("aside",{className:`
        relative flex flex-col bg-[var(--color-bg-secondary)]
        ${r?"flex-1":"border-l border-[var(--color-border)]"}
      `,style:r?void 0:{width:`${j}px`},"data-testid":"director-panel",children:[!r&&o.jsx("div",{className:`
            absolute left-0 top-0 bottom-0 w-1 cursor-col-resize z-10
            hover:bg-[var(--color-primary)] hover:opacity-50
            transition-colors duration-150
            ${T?"bg-[var(--color-primary)] opacity-50":""}
          `,onMouseDown:H,"data-testid":"director-panel-resize-handle"}),o.jsxs("div",{className:"flex items-center justify-between h-14 px-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(na,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Director"}),o.jsxs("span",{className:`flex items-center gap-1 text-xs ${A}`,children:[o.jsx(nu,{className:"w-2 h-2 fill-current"}),M]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[u&&o.jsx(Cn,{content:"Sift Backlog",side:"bottom",children:o.jsx("button",{onClick:Q,className:"p-1.5 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":"Sift Backlog","data-testid":"director-sift-backlog",children:o.jsx(Swe,{className:"w-4 h-4"})})}),c&&o.jsx(Cn,{content:i?"Hide pending messages":"Show pending messages",side:"bottom",children:o.jsxs("button",{onClick:W,className:`relative p-1.5 rounded-md transition-colors duration-150 ${i?"text-[var(--color-primary)] bg-[var(--color-primary)]/10":"text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,"aria-label":i?"Hide pending messages":"Show pending messages","data-testid":"toggle-messages-queue",children:[o.jsx(JC,{className:"w-4 h-4"}),J>0&&o.jsx("span",{className:"absolute -top-1 -right-1 flex items-center justify-center min-w-[16px] h-4 px-1 text-[10px] font-bold rounded-full bg-[var(--color-primary)] text-white",children:J>99?"99+":J})]})}),c&&o.jsx(o.Fragment,{children:u?o.jsxs(o.Fragment,{children:[o.jsx(Cn,{content:"Restart Director Session",side:"bottom",children:o.jsx("button",{onClick:F,disabled:b.isPending||v.isPending,className:"p-1.5 rounded-md text-[var(--color-warning)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Restart Director Session","data-testid":"director-restart-session",children:b.isPending||v.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(Ri,{className:"w-4 h-4"})})}),o.jsx(Cn,{content:"Stop Director Session",side:"bottom",children:o.jsx("button",{onClick:B,disabled:b.isPending,className:"p-1.5 rounded-md text-[var(--color-danger)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Stop Director Session","data-testid":"director-stop-session",children:b.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(uu,{className:"w-4 h-4"})})})]}):o.jsx(Cn,{content:"Start Director Session",side:"bottom",children:o.jsx("button",{onClick:P,disabled:v.isPending,className:"p-1.5 rounded-md text-[var(--color-success)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 disabled:opacity-50","aria-label":"Start Director Session","data-testid":"director-start-session",children:v.isPending?o.jsx(jr,{className:"w-4 h-4 animate-spin"}):o.jsx(Yr,{className:"w-4 h-4"})})})}),o.jsx(Cn,{content:r?"Restore Panel":"Maximize Panel",side:"bottom",children:o.jsx("button",{onClick:n,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":r?"Restore Panel":"Maximize Panel","data-testid":"director-panel-maximize",children:r?o.jsx($6,{className:"w-4 h-4"}):o.jsx(ej,{className:"w-4 h-4"})})}),o.jsx(Cn,{content:"Collapse Panel",side:"left",children:o.jsx("button",{onClick:X,className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","aria-label":"Collapse Director Panel","data-testid":"director-panel-collapse",children:o.jsx(kwe,{className:"w-4 h-4"})})})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[i&&o.jsx("div",{className:"border-b border-[var(--color-border)] bg-[var(--color-bg)] overflow-hidden",style:{height:"280px",minHeight:"200px"},"data-testid":"pending-messages-container",children:o.jsx(lJe,{directorId:c?.id??null,hasActiveSession:u,onSendCommand:G})}),o.jsx("div",{className:"flex-1 p-2 overflow-hidden","data-testid":"director-terminal-container",children:o.jsxs("div",{className:"h-full rounded-lg bg-[#1a1a1a] border border-[var(--color-border)] flex flex-col overflow-hidden",children:[o.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b border-[var(--color-border)] bg-[#252525]",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${u?"bg-green-500":"bg-red-500 opacity-50"}`}),o.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-500 opacity-50"}),o.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500 opacity-50"})]}),o.jsx("span",{className:"text-xs text-gray-400 font-mono",children:c?.name??"director"})]})}),o.jsx("div",{className:"flex-1 overflow-hidden relative",children:L==="no-director"||m&&!c?o.jsx("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:m?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2 animate-spin"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Loading..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No Director agent found"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:"Register a Director agent to use this terminal"})]})}):L==="error"&&p?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-danger)]",children:"Connection Error"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:p.message})]}):o.jsxs(o.Fragment,{children:[o.jsx(EB,{ref:N,agentId:c?.id,onStatusChange:q,theme:"dark",fontSize:12,autoFit:!0,interactive:!0,autoFocus:!0,controlsResize:!0,"data-testid":"director-xterminal"}),c&&(!u||b.isPending)&&o.jsx("div",{className:`
                      absolute inset-0 z-10
                      flex flex-col items-center justify-center
                      bg-[#1a1a1a]/95 backdrop-blur-sm
                    `,"data-testid":"director-idle-overlay",children:b.isPending?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-5",children:[o.jsx("div",{className:"absolute inset-0 bg-amber-500/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                            relative p-3 rounded-xl
                            bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                            border border-[#333]
                            shadow-lg
                          `,children:o.jsx(jr,{className:"w-8 h-8 text-amber-400 animate-spin"})})]}),o.jsxs("div",{className:"text-center mb-5",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-1",children:"Shutting Down"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-xs px-4",children:"Gracefully stopping the session..."})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"0ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"150ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"300ms"}})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-5",children:[o.jsx("div",{className:"absolute inset-0 bg-[var(--color-primary)]/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                            relative p-3 rounded-xl
                            bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                            border border-[#333]
                            shadow-lg
                          `,children:o.jsx(Qae,{className:"w-8 h-8 text-[var(--color-text-muted)]"})})]}),o.jsxs("div",{className:"text-center mb-5",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-1",children:"Director Idle"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-xs px-4",children:d?"Resume your previous session or start fresh.":"Start a session to interact with the Director agent."})]}),S&&o.jsx("div",{className:"mb-3 px-3 py-2 rounded-md bg-red-500/10 border border-red-500/20 text-xs text-red-400 max-w-xs text-center",children:S}),d?o.jsxs("div",{className:"flex flex-col items-center gap-3",children:[o.jsx("button",{onClick:I,disabled:y.isPending||v.isPending,className:`
                                inline-flex items-center gap-2
                                px-5 py-2 rounded-lg
                                bg-gradient-to-r from-green-600 to-green-500
                                hover:from-green-500 hover:to-green-400
                                text-white font-medium text-sm
                                shadow-lg shadow-green-500/25
                                transition-all duration-200
                                hover:scale-105 hover:shadow-green-500/40
                                disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                                focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                              `,"data-testid":"director-overlay-resume-btn",children:y.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-4 h-4 animate-spin"}),"Resuming..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ri,{className:"w-4 h-4"}),"Resume Session"]})}),o.jsx("button",{onClick:P,disabled:v.isPending||y.isPending,className:`
                                inline-flex items-center gap-2
                                px-4 py-1.5 rounded-md
                                border border-[#444] hover:border-[#555]
                                text-[var(--color-text-secondary)] text-xs
                                hover:text-[var(--color-text)]
                                transition-all duration-200
                                disabled:opacity-50 disabled:cursor-not-allowed
                                focus:outline-none focus:ring-2 focus:ring-[#444]/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                              `,"data-testid":"director-overlay-new-session-btn",children:v.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3 h-3 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-3 h-3"}),"New Session"]})}),o.jsx("p",{className:"text-[10px] text-[var(--color-text-tertiary)] mt-1",children:"Resume picks up where your last session left off"})]}):o.jsx("button",{onClick:P,disabled:v.isPending,className:`
                              inline-flex items-center gap-2
                              px-5 py-2 rounded-lg
                              bg-gradient-to-r from-green-600 to-green-500
                              hover:from-green-500 hover:to-green-400
                              text-white font-medium text-sm
                              shadow-lg shadow-green-500/25
                              transition-all duration-200
                              hover:scale-105 hover:shadow-green-500/40
                              disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                              focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                            `,"data-testid":"director-overlay-start-btn",children:v.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-4 h-4 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-4 h-4"}),"Start Session"]})})]})})]})})]})})]})]})}const dJe="/api";async function qs(e,t){const r=await fetch(`${dJe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function S2(e){const t=new URLSearchParams;e?.status&&e.status!=="all"&&t.set("status",e.status),e?.assignment&&e.assignment!=="all"&&t.set("assignment",e.assignment),e?.assignee&&t.set("assignee",e.assignee),e?.priority&&t.set("priority",String(e.priority)),e?.taskType&&t.set("taskType",e.taskType),e?.ephemeral!==void 0&&t.set("ephemeral",String(e.ephemeral)),e?.page&&t.set("page",String(e.page)),e?.limit&&t.set("limit",String(e.limit));const r=t.toString(),n=r?`/tasks?${r}`:"/tasks";return pt({queryKey:["tasks",e],queryFn:()=>qs(n),refetchInterval:1e4})}function fJe(e){return pt({queryKey:["task",e],queryFn:()=>qs(`/tasks/${e}`),enabled:!!e})}function g1(){const{data:e,isLoading:t,error:r,refetch:n}=S2(),a=e?.tasks??[],s=a.filter(p=>p.status==="backlog"),i=a.filter(p=>!p.assignee&&(p.status==="open"||p.status==="blocked"||p.status==="deferred")),l=a.filter(p=>p.assignee&&p.status!=="backlog"&&p.status!=="closed"&&p.status!=="tombstone"),c=a.filter(p=>p.status==="in_progress"),u=a.filter(p=>p.status==="blocked"),d=a.filter(p=>p.status==="closed"),f=a.filter(p=>{if(p.status==="review")return!0;const v=p.metadata?.orchestrator;return p.status==="closed"&&v?.mergeStatus&&v.mergeStatus!=="merged"}),m=a.filter(p=>{const v=p.metadata?.orchestrator;return p.status==="closed"&&v?.mergeStatus==="merged"});return{backlog:s,unassigned:i,assigned:l,inProgress:c,blocked:u,closed:d,awaitingMerge:f,merged:m,allTasks:a,total:e?.total??a.length,isLoading:t,error:r,refetch:n}}function wme(){const e=ft();return kt({mutationFn:async t=>qs("/tasks",{method:"POST",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}})}function Sme(){const e=ft();return kt({mutationFn:async({taskId:t,...r})=>qs(`/tasks/${t}`,{method:"PATCH",body:JSON.stringify(r)}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function kme(){const e=ft();return kt({mutationFn:async({taskId:t})=>qs(`/tasks/${t}/start`,{method:"POST"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function _me(){const e=ft();return kt({mutationFn:async({taskId:t,closeReason:r})=>qs(`/tasks/${t}/complete`,{method:"POST",body:JSON.stringify({closeReason:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function Nme(){const e=ft();return kt({mutationFn:async({taskId:t,message:r})=>qs(`/tasks/${t}/reopen`,{method:"POST",body:JSON.stringify({message:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function hJe(){const e=ft();return kt({mutationFn:async({taskId:t})=>qs(`/tasks/${t}/reset`,{method:"POST"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function mJe(){const e=ft();return kt({mutationFn:async({taskId:t,mergeStatus:r})=>qs(`/tasks/${t}/merge-status`,{method:"PATCH",body:JSON.stringify({mergeStatus:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks"]}),e.invalidateQueries({queryKey:["task",r]})}})}function Cme(){const e=ft();return kt({mutationFn:async({taskId:t,reason:r})=>qs(`/tasks/${t}`,{method:"DELETE",body:JSON.stringify({reason:r})}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}})}function pJe(){const e=ft();return kt({mutationFn:async({ids:t})=>qs("/tasks/bulk-delete",{method:"POST",body:JSON.stringify({ids:t})}),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}})}function gJe(e){return pt({queryKey:["tasks",e,"attachments"],queryFn:()=>qs(`/tasks/${e}/attachments`),enabled:!!e})}function vJe(){const e=ft();return kt({mutationFn:async({taskId:t,documentId:r})=>qs(`/tasks/${t}/attachments`,{method:"POST",body:JSON.stringify({documentId:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"attachments"]})}})}function bJe(){const e=ft();return kt({mutationFn:async({taskId:t,documentId:r})=>qs(`/tasks/${t}/attachments/${r}`,{method:"DELETE"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"attachments"]})}})}function yJe(e){return pt({queryKey:["documents","search",e],queryFn:async()=>{const r=(await qs("/documents")).items||[];if(e?.trim()){const n=e.toLowerCase();return r.filter(a=>a.title?.toLowerCase().includes(n)||a.id.toLowerCase().includes(n))}return r}})}const xJe="/api";async function DB(e,t){const r=await fetch(`${xJe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function wJe(e){return pt({queryKey:["tasks",e,"dependency-tasks"],queryFn:()=>DB(`/tasks/${e}/dependency-tasks`),enabled:!!e})}function SJe(){const e=ft();return kt({mutationFn:async({taskId:t,blockerId:r,type:n})=>DB(`/tasks/${t}/dependencies`,{method:"POST",body:JSON.stringify({blockerId:r,type:n})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"dependency-tasks"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function kJe(){const e=ft();return kt({mutationFn:async({taskId:t,blockerId:r})=>DB(`/tasks/${t}/dependencies/${r}`,{method:"DELETE"}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["tasks",r,"dependency-tasks"]}),e.invalidateQueries({queryKey:["tasks"]})}})}const jme="",Lk={all:["activity"],list:e=>[...Lk.all,"list",e],infinite:e=>[...Lk.all,"infinite",e],detail:e=>[...Lk.all,"detail",e]};async function _Je(e){const t=new URLSearchParams;if(e?.category&&e.category!=="all"){const s={tasks:"task",agents:"entity",sessions:"entity",workflows:"workflow"}[e.category];s&&t.set("elementType",s)}e?.elementId&&t.set("elementId",e.elementId),e?.elementType&&t.set("elementType",Array.isArray(e.elementType)?e.elementType.join(","):e.elementType),e?.eventType&&t.set("eventType",Array.isArray(e.eventType)?e.eventType.join(","):e.eventType),e?.actor&&t.set("actor",e.actor),e?.after&&t.set("after",e.after),e?.before&&t.set("before",e.before),e?.limit&&t.set("limit",String(e.limit)),e?.offset&&t.set("offset",String(e.offset));const r=`${jme}/api/events${t.toString()?`?${t}`:""}`,n=await fetch(r);if(!n.ok){const a=await n.json().catch(()=>({error:{message:n.statusText}}));throw new Error(a.error?.message||"Failed to fetch activity")}return n.json()}function NJe(e){const t=e?.limit||20;return nwe({queryKey:Lk.infinite(e),queryFn:async({pageParam:r=0})=>_Je({...e,limit:t,offset:r}),initialPageParam:0,getNextPageParam:(r,n)=>r.hasMore?n.reduce((s,i)=>s+i.events.length,0):void 0})}function LB(e="all"){const[t,r]=w.useState(!1),[n,a]=w.useState([]),s=w.useRef(null),i=w.useRef(null),l=w.useCallback(()=>{s.current&&s.current.close();const u=`${jme}/api/events/stream${e!=="all"?`?category=${e}`:""}`,d=new EventSource(u);s.current=d,d.onopen=()=>{r(!0),i.current&&clearTimeout(i.current)},d.onerror=()=>{r(!1),d.close(),i.current=setTimeout(l,5e3)},d.addEventListener("connected",()=>{r(!0)}),d.addEventListener("session_event",f=>{try{const m=JSON.parse(f.data);a(p=>[m,...p].slice(0,100))}catch{console.error("Failed to parse session event:",f.data)}}),d.addEventListener("heartbeat",()=>{})},[e]),c=w.useCallback(()=>{s.current&&(s.current.close(),s.current=null),i.current&&clearTimeout(i.current),r(!1)},[]);return w.useEffect(()=>(l(),()=>c()),[l,c]),w.useEffect(()=>{a([])},[e]),{isConnected:t,sessionEvents:n,connect:l,disconnect:c,clearSessionEvents:()=>a([])}}function CJe(e){return{created:"var(--color-success)",updated:"var(--color-primary)",closed:"var(--color-text-secondary)",reopened:"var(--color-warning)",deleted:"var(--color-error)",dependency_added:"var(--color-info)",dependency_removed:"var(--color-text-secondary)",tag_added:"var(--color-info)",tag_removed:"var(--color-text-secondary)",member_added:"var(--color-success)",member_removed:"var(--color-warning)",auto_blocked:"var(--color-error)",auto_unblocked:"var(--color-success)"}[e]||"var(--color-text-secondary)"}function OB(e){const t=Date.now(),r=new Date(e).getTime(),n=t-r,a=Math.floor(n/1e3),s=Math.floor(a/60),i=Math.floor(s/60),l=Math.floor(i/24);return a<60?"just now":s<60?`${s}m ago`:i<24?`${i}h ago`:l<7?`${l}d ago`:new Date(e).toLocaleDateString()}const jJe="",pX={sessionEvents:!0,errors:!0,sound:!1,toastDuration:5e3},Eme="orchestrator-notifications",Mme="orchestrator-notification-preferences",EJe=100;function Tme(){return`notif-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}function MJe(e){if(e.type!=="error"&&e.type!=="system")return null;const t=e.type==="error"?"error":"info",r=e.type==="error"?"Agent Error":"System Event",n=e.agentName||e.agentId||"Agent";return{id:Tme(),type:t,title:`${r}: ${n}`,message:e.content?.substring(0,200),timestamp:e.timestamp,read:!1,dismissed:!1,navigateTo:e.sessionId?`/workspaces?session=${e.sessionId}`:void 0,source:{sessionId:e.sessionId,agentId:e.agentId}}}function TJe(e,t){return e.type==="error"?t.errors:t.sessionEvents}function AJe(){try{const e=localStorage.getItem(Eme);if(e){const t=JSON.parse(e),r=Date.now()-1440*60*1e3;return t.filter(a=>new Date(a.timestamp).getTime()>r)}}catch{}return[]}function DJe(e){try{localStorage.setItem(Eme,JSON.stringify(e))}catch{}}function LJe(){try{const e=localStorage.getItem(Mme);if(e)return{...pX,...JSON.parse(e)}}catch{}return pX}function OJe(e){try{localStorage.setItem(Mme,JSON.stringify(e))}catch{}}function IJe(){const[e,t]=w.useState(()=>AJe()),[r,n]=w.useState(()=>LJe()),[a,s]=w.useState(!1),i=w.useRef(null),l=w.useRef(null),c=e.filter(_=>!_.read&&!_.dismissed).length,u=e.filter(_=>!_.dismissed);w.useEffect(()=>{DJe(e)},[e]),w.useEffect(()=>{OJe(r)},[r]);const d=w.useCallback(_=>{const N={..._,id:Tme(),timestamp:new Date().toISOString(),read:!1,dismissed:!1};return t(j=>[N,...j].slice(0,EJe)),(_.type==="error"?Gr.error:_.type==="warning"?Gr.warning:_.type==="success"?Gr.success:Gr.info)(_.title,{description:_.message,duration:r.toastDuration||void 0,action:_.navigateTo?{label:"View",onClick:()=>{window.location.href=_.navigateTo}}:void 0}),N},[r.toastDuration]),f=w.useCallback(_=>{t(N=>N.map(k=>k.id===_?{...k,read:!0}:k))},[]),m=w.useCallback(()=>{t(_=>_.map(N=>({...N,read:!0})))},[]),p=w.useCallback(_=>{t(N=>N.map(k=>k.id===_?{...k,dismissed:!0}:k))},[]),v=w.useCallback(()=>{t([])},[]),b=w.useCallback(_=>{n(N=>({...N,..._}))},[]),y=w.useCallback(()=>{i.current&&i.current.close();const _=`${jJe}/api/events/stream`,N=new EventSource(_);i.current=N,N.onopen=()=>{s(!0),l.current&&clearTimeout(l.current)},N.onerror=()=>{s(!1),N.close(),l.current=setTimeout(y,5e3)},N.addEventListener("connected",()=>{s(!0)}),N.addEventListener("session_event",k=>{try{const j=JSON.parse(k.data);if(TJe(j,r)){const E=MJe(j);E&&d(E)}}catch{console.error("Failed to parse session event:",k.data)}}),N.addEventListener("notification",k=>{try{const j=JSON.parse(k.data);d(j)}catch{console.error("Failed to parse notification event:",k.data)}}),N.addEventListener("heartbeat",()=>{})},[r,d]),S=w.useCallback(()=>{i.current&&(i.current.close(),i.current=null),l.current&&clearTimeout(l.current),s(!1)},[]);return w.useEffect(()=>(y(),()=>S()),[y,S]),{notifications:u,unreadCount:c,isConnected:a,preferences:r,addNotification:d,markAsRead:f,markAllAsRead:m,dismissNotification:p,clearAll:v,setPreferences:b,connect:y,disconnect:S}}const v0=["elements","all"],Wn={tasks:["elements","tasks"],plans:["elements","plans"],workflows:["elements","workflows"],entities:["elements","entities"],documents:["elements","documents"],channels:["elements","channels"],messages:["elements","messages"],teams:["elements","teams"],libraries:["elements","libraries"]};async function RJe(){const e=await fetch("/api/elements/all?includeTaskCounts=true");if(!e.ok)throw new Error(`Failed to fetch all elements: ${e.statusText}`);return e.json()}function PJe(){const e=ft(),t=pt({queryKey:v0,queryFn:RJe,staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1}),r=t.data;return r&&(r.data.task&&e.setQueryData(Wn.tasks,r.data.task.items),r.data.plan&&e.setQueryData(Wn.plans,r.data.plan.items),r.data.workflow&&e.setQueryData(Wn.workflows,r.data.workflow.items),r.data.entity&&e.setQueryData(Wn.entities,r.data.entity.items),r.data.document&&e.setQueryData(Wn.documents,r.data.document.items),r.data.channel&&e.setQueryData(Wn.channels,r.data.channel.items),r.data.message&&e.setQueryData(Wn.messages,r.data.message.items),r.data.team&&e.setQueryData(Wn.teams,r.data.team.items),r.data.library&&e.setQueryData(Wn.libraries,r.data.library.items)),{isLoading:t.isLoading,isError:t.isError,error:t.error,data:t.data,totalElements:r?.totalElements??0,loadedAt:r?.loadedAt,refetch:t.refetch}}function zJe(){const e=ft();return pt({queryKey:Wn.plans,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.plan)return t.data.plan.items;const r=await fetch("/api/plans?limit=10000");if(!r.ok)throw new Error("Failed to fetch plans");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function k2(){const e=ft();return pt({queryKey:Wn.entities,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.entity)return t.data.entity.items;const r=await fetch("/api/entities?limit=10000");if(!r.ok)throw new Error("Failed to fetch entities");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function IB(){const e=ft();return pt({queryKey:Wn.documents,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.document)return t.data.document.items;const r=await fetch("/api/documents?limit=10000");if(!r.ok)throw new Error("Failed to fetch documents");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function BJe(){const e=ft();return pt({queryKey:Wn.channels,queryFn:async()=>{const t=e.getQueryData(v0);if(t?.data.channel)return t.data.channel.items;const r=await fetch("/api/channels?limit=10000");if(!r.ok)throw new Error("Failed to fetch channels");return(await r.json()).items},staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function Ame(e){return{task:Wn.tasks,plan:Wn.plans,workflow:Wn.workflows,entity:Wn.entities,document:Wn.documents,channel:Wn.channels,message:Wn.messages,team:Wn.teams,library:Wn.libraries}[e]}function $Je(e,t,r){const n=Ame(t);e.setQueryData(n,a=>{if(!a)return[r];const s=a.findIndex(i=>i.id===r.id);if(s>=0){const i=[...a];return i[s]=r,i}else return[r,...a]})}function Dme(e,t,r){const n=Ame(t);e.setQueryData(n,a=>a?a.filter(s=>s.id!==r):[]),e.setQueryData(v0,a=>{if(!a)return a;const s=t,i=a.data[s];return i?{...a,data:{...a.data,[s]:{...i,items:i.items.filter(l=>l.id!==r),total:i.total-1}},totalElements:a.totalElements-1}:a})}function FJe(e,t){const r=t.elementType;if(!["task","plan","workflow","entity","document","channel","message","team","library"].includes(r))return!1;const a=t.eventType;return a==="deleted"||a==="soft-deleted"?(Dme(e,r,t.elementId),!0):t.newValue&&(a==="created"||a==="updated"||a.includes("status")||a.includes("assigned"))?($Je(e,r,t.newValue),!0):!1}function UJe(){const e=ft();return w.useCallback(t=>FJe(e,t),[e])}function RB(e,t){const[r,n]=w.useState(e);return w.useEffect(()=>{const a=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}const HJe=300;function qJe(e){return pt({queryKey:["channels",e],queryFn:async()=>{if(!e)throw new Error("No channel selected");const t=await fetch(`/api/channels/${e}`);if(!t.ok)throw new Error("Failed to fetch channel");return t.json()},enabled:!!e})}function WJe(e){return pt({queryKey:["channels",e,"messages"],queryFn:async()=>{if(!e)throw new Error("No channel selected");const t=await fetch(`/api/channels/${e}/messages?limit=10000&hydrate.content=true`);if(!t.ok)throw new Error("Failed to fetch messages");return t.json()},enabled:!!e})}function Lme(){const e=ft();return kt({mutationFn:async({channelId:t,sender:r,content:n,threadId:a,attachmentIds:s})=>{const i=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelId:t,sender:r,content:n,threadId:a,attachmentIds:s})});if(!i.ok){const l=await i.json();throw new Error(l.error?.message||"Failed to send message")}return i.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["channels",r.channelId,"messages"]}),r.threadId&&e.invalidateQueries({queryKey:["messages",r.threadId,"replies"]})}})}function KJe(e){return pt({queryKey:["messages",e,"replies"],queryFn:async()=>{if(!e)throw new Error("No thread selected");const t=await fetch(`/api/messages/${e}/replies?limit=10000&hydrate.content=true`);return t.ok?t.json():[]},enabled:!!e})}function GJe(){const e=ft();return kt({mutationFn:async({channelId:t,actor:r})=>{const n=await fetch(`/api/channels/${t}?actor=${encodeURIComponent(r)}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to delete channel")}return n.json()},onSuccess:(t,{channelId:r})=>{Dme(e,"channel",r),e.invalidateQueries({queryKey:["channels"]}),e.invalidateQueries({queryKey:["channels",r]}),e.invalidateQueries({queryKey:["channels",r,"messages"]}),e.invalidateQueries({queryKey:["channels",r,"members"]})}})}function VJe(e,t){const r=RB(e,HJe);return pt({queryKey:["messages","search",r,t],queryFn:async()=>{if(!r.trim())return{results:[],query:""};const n=new URLSearchParams({q:r,limit:"50"});t&&n.set("channelId",t);const a=await fetch(`/api/messages/search?${n}`);if(!a.ok)throw new Error("Failed to search messages");return a.json()},enabled:r.trim().length>0,staleTime:3e4})}function YJe(e){return pt({queryKey:["documents","search",e],queryFn:async()=>{const t=await fetch("/api/documents");if(!t.ok)throw new Error("Failed to fetch documents");const r=await t.json(),n=r.items||r;if(e.trim()){const a=e.toLowerCase();return n.filter(s=>s.title?.toLowerCase().includes(a)||s.id.toLowerCase().includes(a))}return n}})}function PB(){return pt({queryKey:["entities"],queryFn:async()=>{const e=await fetch("/api/entities");if(!e.ok)throw new Error("Failed to fetch entities");const t=await e.json();return t.items||t}})}const QJe="/api";async function Oh(e,t){const r=await fetch(`${QJe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function Ome(e){const t=e.metadata?.orchestrator;return(e.status==="review"||e.status==="closed")&&!!t?.mergeStatus}function JJe(e,t,r){const n=e.metadata?.orchestrator?.mergeStatus;if(!n||n==="merged"&&!r)return!1;switch(t){case"all":return!0;case"needs_review":return n==="pending"||n==="test_failed";case"testing":return n==="testing"||n==="merging";case"conflicts":return n==="conflict"||n==="failed";case"merged":return n==="merged";default:return!0}}function ZJe(e){return pt({queryKey:["merge-requests",e],queryFn:async()=>{const[t,r]=await Promise.all([Oh("/tasks?status=review"),Oh("/tasks?status=closed")]);let a=[...t.tasks,...r.tasks].filter(Ome);const s=e?.status||"all",i=e?.showMerged??!1;return a=a.filter(l=>JJe(l,s,i)),e?.assignee&&(a=a.filter(l=>l.assignee===e.assignee)),a.sort((l,c)=>new Date(c.updatedAt).getTime()-new Date(l.updatedAt).getTime()),a},refetchInterval:1e4})}function XJe(e){return pt({queryKey:["merge-request",e],queryFn:async()=>(await Oh(`/tasks/${e}`)).task,enabled:!!e})}function Ime(){const{data:e,isLoading:t,error:r}=pt({queryKey:["merge-requests","counts"],queryFn:async()=>{const[s,i]=await Promise.all([Oh("/tasks?status=review"),Oh("/tasks?status=closed")]);return[...s.tasks,...i.tasks].filter(Ome)},refetchInterval:1e4}),n=e??[];return{counts:{all:n.filter(s=>s.metadata?.orchestrator?.mergeStatus!=="merged").length,needsReview:n.filter(s=>{const i=s.metadata?.orchestrator?.mergeStatus;return i==="pending"||i==="test_failed"}).length,testing:n.filter(s=>{const i=s.metadata?.orchestrator?.mergeStatus;return i==="testing"||i==="merging"}).length,conflicts:n.filter(s=>{const i=s.metadata?.orchestrator?.mergeStatus;return i==="conflict"||i==="failed"}).length,merged:n.filter(s=>s.metadata?.orchestrator?.mergeStatus==="merged").length},isLoading:t,error:r}}function Rme(e){switch(e){case"pending":return{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400",border:"border-amber-500"};case"testing":return{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400",border:"border-blue-500"};case"merging":return{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-400",border:"border-blue-600"};case"merged":return{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400",border:"border-green-500"};case"conflict":return{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",border:"border-red-500"};case"test_failed":return{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400",border:"border-orange-500"};case"failed":return{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",border:"border-red-600"};case"not_applicable":return{bg:"bg-gray-100 dark:bg-gray-800/50",text:"text-gray-500 dark:text-gray-400",border:"border-gray-400"};default:return{bg:"bg-gray-100 dark:bg-gray-900/30",text:"text-gray-700 dark:text-gray-400",border:"border-gray-500"}}}function eZe(){const e=ft();return kt({mutationFn:async({taskId:t,mergeStatus:r})=>Oh(`/tasks/${t}`,{method:"PATCH",body:JSON.stringify({mergeStatus:r})}),onSuccess:(t,{taskId:r})=>{e.invalidateQueries({queryKey:["merge-requests"]}),e.invalidateQueries({queryKey:["merge-request",r]}),e.invalidateQueries({queryKey:["tasks"]})}})}function tZe(){const e=ft();return kt({mutationFn:async({taskId:t,reason:r})=>Oh(`/tasks/${t}`,{method:"DELETE",body:JSON.stringify({reason:r})}),onSuccess:()=>{e.invalidateQueries({queryKey:["merge-requests"]}),e.invalidateQueries({queryKey:["tasks"]})}})}function rZe(){return[{value:"pending",label:"Pending Merge"},{value:"testing",label:"Testing"},{value:"merging",label:"Merging"},{value:"merged",label:"Merged"},{value:"conflict",label:"Conflict"},{value:"test_failed",label:"Tests Failed"},{value:"failed",label:"Merge Failed"},{value:"not_applicable",label:"No Merge Needed"}]}const nZe="/api";async function _2(e,t){const r=await fetch(`${nZe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function v1(){return pt({queryKey:["daemon-status"],queryFn:()=>_2("/daemon/status"),refetchInterval:1e4})}function aZe(){const e=ft();return kt({mutationFn:async()=>_2("/daemon/start",{method:"POST"}),onSuccess:()=>{e.invalidateQueries({queryKey:["daemon-status"]})}})}function sZe(){const e=ft();return kt({mutationFn:async()=>_2("/daemon/stop",{method:"POST"}),onSuccess:()=>{e.invalidateQueries({queryKey:["daemon-status"]})}})}function iZe(){const e=ft();return kt({mutationFn:async t=>_2("/daemon/config",{method:"PATCH",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["daemon-status"]})}})}const oZe="/api";async function lZe(e,t){const r=await fetch(`${oZe}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function cZe(){const e=ft();return kt({mutationFn:async()=>lZe("/sessions/stop-all",{method:"POST",body:JSON.stringify({graceful:!0})}),onSuccess:()=>{e.invalidateQueries({queryKey:["agents"]}),e.invalidateQueries({queryKey:["sessions"]})}})}const N2=["pools"],uZe=e=>["pools",e],Og="";async function dZe(e){const t=new URLSearchParams,r=t.toString()?`${Og}/api/pools?${t}`:`${Og}/api/pools`,n=await fetch(r);if(!n.ok)throw new Error("Failed to fetch pools");return(await n.json()).pools}async function fZe(e){const t=await fetch(`${Og}/api/pools`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.json();throw new Error(n.error?.message??"Failed to create pool")}return(await t.json()).pool}async function hZe(e,t){const r=await fetch(`${Og}/api/pools/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const a=await r.json();throw new Error(a.error?.message??"Failed to update pool")}return(await r.json()).pool}async function mZe(e,t){const r=t?`${Og}/api/pools/${e}?force=true`:`${Og}/api/pools/${e}`,n=await fetch(r,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message??"Failed to delete pool")}}function pZe(e){return pt({queryKey:[...N2,e],queryFn:()=>dZe(),refetchInterval:1e4})}function gZe(){const e=ft();return kt({mutationFn:fZe,onSuccess:()=>{e.invalidateQueries({queryKey:N2})}})}function Pme(){const e=ft();return kt({mutationFn:({id:t,...r})=>hZe(t,r),onSuccess:t=>{e.invalidateQueries({queryKey:N2}),e.invalidateQueries({queryKey:uZe(t.id)})}})}function vZe(){const e=ft();return kt({mutationFn:({id:t,force:r})=>mZe(t,r),onSuccess:()=>{e.invalidateQueries({queryKey:N2})}})}const bZe="/api";async function yZe(e){if(e.length===0)return{messages:{}};const t=await fetch(`${bZe}/sessions/latest-messages?sessionIds=${e.join(",")}`);if(!t.ok)throw new Error(`Failed to fetch latest messages: HTTP ${t.status}`);return t.json()}function xZe(e){const t=[...e].sort(),r=["sessions","latest-messages",t],{data:n,isLoading:a,error:s}=pt({queryKey:r,queryFn:()=>yZe(t),enabled:t.length>0,refetchInterval:2e3,staleTime:1e3});return{latestBySession:n?.messages??{},isLoading:a,error:s}}function wZe(){const{data:e,isLoading:t,isError:r}=v1(),n=aZe(),a=sZe(),s=n.isPending||a.isPending,i=()=>{s||(e?.isRunning?a.mutate():n.mutate())};if(t)return o.jsx("div",{className:"flex items-center gap-2 px-2 py-1.5 text-[var(--color-text-tertiary)]",children:o.jsx(Pe,{className:"w-4 h-4 animate-spin"})});if(r||!e?.available)return o.jsx(Cn,{content:e?.reason||"Daemon unavailable",side:"bottom",children:o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 text-[var(--color-text-tertiary)] cursor-not-allowed",children:[o.jsx(Rt,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden lg:inline text-sm",children:"Autopilot"})]})});const l=e.isRunning,c=l?"Stop autopilot":"Start autopilot";return o.jsx(Cn,{content:c,side:"bottom",children:o.jsxs("button",{onClick:i,disabled:s,className:`
          flex items-center gap-2 px-2.5 py-1.5 text-sm font-medium rounded-md
          transition-colors duration-150
          ${l?"text-[var(--color-success-text)] bg-[var(--color-success)]/10 hover:bg-[var(--color-success)]/20":"text-[var(--color-text-secondary)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)]"}
          border border-[var(--color-border)]
          disabled:opacity-50 disabled:cursor-not-allowed
        `,"aria-label":c,"data-testid":"daemon-toggle",children:[s?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):l?o.jsx(uu,{className:"w-4 h-4"}):o.jsx(Yr,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden lg:inline",children:s?l?"Stopping...":"Starting...":"Autopilot"}),o.jsx("div",{className:`w-2 h-2 rounded-full ${l?"bg-[var(--color-success)]":"bg-[var(--color-text-tertiary)]"}`})]})})}function SZe(){const e=cZe(),{data:t}=b2({status:"starting,running"}),r=t?.sessions?.length??0,n=r>0,a=()=>{e.isPending||!n||e.mutate()},s=e.isPending?"Stopping all agents...":n?`Stop all running agents (${r})`:"No running agents";return o.jsx(Cn,{content:s,side:"bottom",children:o.jsxs("button",{onClick:a,disabled:e.isPending||!n,className:`
          flex items-center gap-2 px-2.5 py-1.5 text-sm font-medium rounded-md
          transition-colors duration-150
          ${n?"text-[var(--color-text-secondary)] bg-[var(--color-surface)] hover:bg-[var(--color-danger)]/10 hover:text-[var(--color-danger-text)]":"text-[var(--color-text-tertiary)] bg-[var(--color-surface)]"}
          border border-[var(--color-border)]
          disabled:opacity-50 disabled:cursor-not-allowed
        `,"aria-label":s,"data-testid":"stop-all-agents-button",children:[e.isPending?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(_we,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden lg:inline",children:e.isPending?"Stopping...":"Stop All"}),n&&!e.isPending&&o.jsx("span",{className:"flex items-center justify-center min-w-[1.25rem] h-5 px-1 text-xs font-medium bg-[var(--color-danger)]/10 text-[var(--color-danger-text)] rounded-full",children:r})]})})}function kZe({type:e}){const t="w-2 h-2 rounded-full flex-shrink-0";switch(e){case"success":return o.jsx("div",{className:`${t} bg-[var(--color-success)]`});case"error":return o.jsx("div",{className:`${t} bg-[var(--color-error)]`});case"warning":return o.jsx("div",{className:`${t} bg-[var(--color-warning)]`});default:return o.jsx("div",{className:`${t} bg-[var(--color-primary)]`})}}function _Ze({notification:e,onMarkAsRead:t,onDismiss:r,onNavigate:n}){return o.jsx("div",{className:`
        group relative px-4 py-3 border-b border-[var(--color-border)] last:border-b-0
        hover:bg-[var(--color-surface-hover)] transition-colors duration-150
        ${e.read?"opacity-60":""}
      `,"data-testid":`notification-${e.id}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(kZe,{type:e.type}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("p",{className:`text-sm font-medium text-[var(--color-text)] truncate ${e.read?"":"font-semibold"}`,children:e.title}),!e.read&&o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-[var(--color-primary)] flex-shrink-0"})]}),e.message&&o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] mt-0.5 line-clamp-2",children:e.message}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-1",children:OB(e.timestamp)})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.navigateTo&&n&&o.jsx("button",{onClick:a=>{a.stopPropagation(),n()},className:"p-1 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-active)] transition-colors",title:"View details","aria-label":"View details",children:o.jsx(wl,{className:"w-3.5 h-3.5"})}),!e.read&&o.jsx("button",{onClick:a=>{a.stopPropagation(),t()},className:"p-1 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-active)] transition-colors",title:"Mark as read","aria-label":"Mark as read",children:o.jsx(Vn,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:a=>{a.stopPropagation(),r()},className:"p-1 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-surface-active)] transition-colors",title:"Dismiss","aria-label":"Dismiss notification",children:o.jsx(yt,{className:"w-3.5 h-3.5"})})]})]})})}function NZe({notifications:e,unreadCount:t,isConnected:r,onMarkAsRead:n,onMarkAllAsRead:a,onDismiss:s,onClearAll:i,onOpenSettings:l}){const[c,u]=w.useState(!1),d=w.useRef(null),f=Ma();w.useEffect(()=>{function p(v){d.current&&!d.current.contains(v.target)&&u(!1)}if(c)return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[c]),w.useEffect(()=>{function p(v){v.key==="Escape"&&u(!1)}if(c)return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[c]);const m=w.useCallback(p=>{p.navigateTo&&(n(p.id),u(!1),f({to:p.navigateTo}))},[f,n]);return o.jsxs("div",{ref:d,className:"relative","data-testid":"notification-center",children:[o.jsxs("button",{onClick:()=>u(!c),className:`
          relative p-2 rounded-md transition-colors duration-150
          ${c?"bg-[var(--color-surface-active)] text-[var(--color-text)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
        `,"aria-label":`Notifications ${t>0?`(${t} unread)`:""}`,"aria-expanded":c,"aria-haspopup":"true","data-testid":"notification-bell",children:[r?o.jsx(DO,{className:"w-5 h-5"}):o.jsx(Nwe,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),t>0&&o.jsx("span",{className:"absolute -top-0.5 -right-0.5 flex items-center justify-center min-w-[18px] h-[18px] px-1 text-xs font-bold text-white bg-[var(--color-error)] rounded-full","data-testid":"notification-badge",children:t>99?"99+":t})]}),c&&o.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-[var(--color-surface)] rounded-lg shadow-lg border border-[var(--color-border)] overflow-hidden z-50",role:"menu","aria-label":"Notifications","data-testid":"notification-dropdown",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-[var(--color-surface-elevated)] border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)]",children:"Notifications"}),!r&&o.jsx("span",{className:"text-xs text-[var(--color-warning-text)] bg-[var(--color-warning-muted)] px-1.5 py-0.5 rounded",children:"Offline"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[t>0&&o.jsx("button",{onClick:a,className:"p-1.5 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Mark all as read","aria-label":"Mark all as read",children:o.jsx(ZC,{className:"w-4 h-4"})}),e.length>0&&o.jsx("button",{onClick:i,className:"p-1.5 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Clear all","aria-label":"Clear all notifications",children:o.jsx(pr,{className:"w-4 h-4"})}),l&&o.jsx("button",{onClick:()=>{u(!1),l()},className:"p-1.5 rounded text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Notification settings","aria-label":"Notification settings",children:o.jsx(Wa,{className:"w-4 h-4"})})]})]}),o.jsx("div",{className:"max-h-96 overflow-y-auto","data-testid":"notification-list",children:e.length===0?o.jsxs("div",{className:"px-4 py-8 text-center text-[var(--color-text-secondary)]",children:[o.jsx(DO,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No notifications"}),o.jsx("p",{className:"text-xs mt-1",children:"You're all caught up!"})]}):e.slice(0,20).map(p=>o.jsx(_Ze,{notification:p,onMarkAsRead:()=>n(p.id),onDismiss:()=>s(p.id),onNavigate:p.navigateTo?()=>m(p):void 0},p.id))}),e.length>20&&o.jsx("div",{className:"px-4 py-2 bg-[var(--color-surface-elevated)] border-t border-[var(--color-border)] text-center",children:o.jsxs("span",{className:"text-xs text-[var(--color-text-secondary)]",children:["Showing 20 of ",e.length," notifications"]})})]})]})}const CZe={navigation:{label:"Navigation",icon:qh},tasks:{label:"Tasks",icon:Tl},agents:{label:"Agents",icon:Vr},workflows:{label:"Workflows",icon:vh},actions:{label:"Quick Actions",icon:Yr},settings:{label:"Settings",icon:Wa}};function jZe({open:e,onOpenChange:t}){const r=$ae(),[n,a]=w.useState("");w.useEffect(()=>{e||a("")},[e]);const s=w.useCallback((d,f)=>{r.navigate({to:d,search:f}),t(!1)},[r,t]),i=w.useCallback(d=>{const f=document.documentElement;if(localStorage.setItem("theme",d),d==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches;f.classList.toggle("dark",m)}else f.classList.toggle("dark",d==="dark");t(!1)},[t]),c=[{id:"nav-activity",label:"Go to Activity",description:"View real-time activity feed",category:"navigation",icon:Hh,keywords:["home","feed","events","activity"],action:()=>s("/activity"),shortcut:"G A"},{id:"nav-tasks",label:"Go to Tasks",description:"View and manage tasks",category:"navigation",icon:Tl,keywords:["tasks","todos","work","items"],action:()=>s("/tasks"),shortcut:"G T"},{id:"nav-agents",label:"Go to Agents",description:"View and manage agents",category:"navigation",icon:ds,keywords:["agents","workers","director","steward"],action:()=>s("/agents"),shortcut:"G E"},{id:"nav-stewards",label:"Go to Stewards",description:"View steward agents",category:"navigation",icon:Zo,keywords:["stewards","automation","merge","docs"],action:()=>s("/agents",{tab:"stewards"})},{id:"nav-workspaces",label:"Go to Workspaces",description:"Terminal multiplexer view",category:"navigation",icon:bh,keywords:["workspaces","terminal","multiplexer","panes"],action:()=>s("/workspaces"),shortcut:"G W"},{id:"nav-workflows",label:"Go to Workflows",description:"View workflow templates",category:"navigation",icon:vh,keywords:["workflows","templates","playbooks"],action:()=>s("/workflows"),shortcut:"G F"},{id:"nav-metrics",label:"Go to Metrics",description:"View performance metrics",category:"navigation",icon:QC,keywords:["metrics","analytics","stats","performance","dashboard"],action:()=>s("/metrics"),shortcut:"G M"},{id:"nav-settings",label:"Go to Settings",description:"App preferences and configuration",category:"navigation",icon:Wa,keywords:["settings","preferences","config","options"],action:()=>s("/settings"),shortcut:"G S"},{id:"nav-plans",label:"Go to Plans",description:"View and manage plans",category:"navigation",icon:tu,keywords:["plans","roadmap","milestones","goals"],action:()=>s("/plans"),shortcut:"G P"},{id:"nav-merge-requests",label:"Go to Merge Requests",description:"Review and merge agent work",category:"navigation",icon:Ps,keywords:["merge","requests","pr","pull","review","git"],action:()=>s("/merge-requests"),shortcut:"G R"},{id:"task-create",label:"Create Task",description:"Create a new task",category:"tasks",icon:dr,keywords:["create","new","task","add"],action:()=>s("/tasks",{action:"create"}),shortcut:"C T"},{id:"task-unassigned",label:"View Unassigned Tasks",description:"Tasks waiting for assignment",category:"tasks",icon:Rr,keywords:["unassigned","pending","queue","backlog"],action:()=>s("/tasks",{status:"unassigned"})},{id:"task-in-progress",label:"View In Progress Tasks",description:"Tasks currently being worked on",category:"tasks",icon:Yr,keywords:["progress","active","working","running"],action:()=>s("/tasks",{status:"in_progress"})},{id:"task-awaiting-merge",label:"View Awaiting Merge",description:"Tasks ready for merge review",category:"tasks",icon:cu,keywords:["merge","review","pr","pull request","awaiting"],action:()=>s("/tasks",{status:"awaiting_merge"})},{id:"agent-create",label:"Create Agent",description:"Register a new agent",category:"agents",icon:dr,keywords:["create","new","agent","worker","register"],action:()=>s("/agents",{action:"create"}),shortcut:"C A"},{id:"agent-create-steward",label:"Create Steward",description:"Create a new steward agent",category:"agents",icon:Zo,keywords:["create","steward","automation","merge","docs"],action:()=>s("/agents",{tab:"stewards",action:"create"})},{id:"agent-start-all",label:"Start All Agents",description:"Start all registered agents",category:"agents",icon:Yr,keywords:["start","all","agents","boot"],action:()=>{s("/agents")}},{id:"agent-stop-all",label:"Stop All Agents",description:"Stop all running agents",category:"agents",icon:uu,keywords:["stop","all","agents","halt","shutdown"],action:()=>{s("/agents")}},{id:"workflow-templates",label:"View Templates",description:"Browse workflow templates",category:"workflows",icon:rn,keywords:["templates","playbooks","workflows"],action:()=>s("/workflows",{tab:"templates"})},{id:"workflow-active",label:"View Active Workflows",description:"Running workflow instances",category:"workflows",icon:jr,keywords:["active","running","workflows","instances"],action:()=>s("/workflows",{tab:"active"})},{id:"action-refresh",label:"Refresh Data",description:"Refresh all data from server",category:"actions",icon:jr,keywords:["refresh","reload","sync","update"],action:()=>{window.location.reload()},shortcut:"R"},{id:"action-open-terminal",label:"Open Director Terminal",description:"Open the Director terminal panel",category:"actions",icon:na,keywords:["terminal","director","console","cli"],action:()=>{window.dispatchEvent(new CustomEvent("toggle-director-panel")),t(!1)},shortcut:"T"},{id:"action-maximize-director",label:"Maximize Director Panel",description:"Toggle maximize/restore the Director panel",category:"actions",icon:ej,keywords:["maximize","fullscreen","director","terminal","restore","minimize"],action:()=>{window.dispatchEvent(new CustomEvent("maximize-director-panel")),t(!1)}},{id:"settings-preferences",label:"Preferences",description:"User preferences",category:"settings",icon:Wa,keywords:["preferences","settings","options"],action:()=>s("/settings",{tab:"preferences"})},{id:"settings-workspace",label:"Workspace Settings",description:"Workspace configuration",category:"settings",icon:bh,keywords:["workspace","config","settings"],action:()=>s("/settings",{tab:"workspace"})},{id:"theme-light",label:"Switch to Light Theme",description:"Use light color theme",category:"settings",icon:e_,keywords:["light","theme","bright","day"],action:()=>i("light")},{id:"theme-dark",label:"Switch to Dark Theme",description:"Use dark color theme",category:"settings",icon:Xk,keywords:["dark","theme","night"],action:()=>i("dark")},{id:"theme-system",label:"Use System Theme",description:"Follow system color preference",category:"settings",icon:R6,keywords:["system","theme","auto","automatic"],action:()=>i("system")}].reduce((d,f)=>(d[f.category]||(d[f.category]=[]),d[f.category].push(f),d),{}),u=["navigation","tasks","agents","workflows","actions","settings"];return o.jsxs(ei.Dialog,{open:e,onOpenChange:t,label:"Command Palette",className:"fixed inset-0 z-[var(--z-index-modal)] flex items-start justify-center pt-[20vh]","data-testid":"command-palette",children:[o.jsx("div",{className:"fixed inset-0 bg-[var(--color-bg-overlay)] backdrop-blur-sm",onClick:()=>t(!1),"data-testid":"command-palette-backdrop"}),o.jsxs("div",{className:"relative w-full max-w-lg bg-[var(--color-bg-elevated)] rounded-xl shadow-2xl border border-[var(--color-border)] overflow-hidden","data-testid":"command-palette-dialog",children:[o.jsxs("div",{className:"flex items-center gap-3 px-4 border-b border-[var(--color-border)]",children:[o.jsx(xr,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),o.jsx(ei.Input,{value:n,onValueChange:a,placeholder:"Type a command or search...",className:"flex-1 h-14 bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:outline-none text-base","data-testid":"command-palette-input"}),o.jsx("kbd",{className:"hidden sm:flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:"ESC"})]}),o.jsxs(ei.List,{className:"max-h-[400px] overflow-y-auto p-2","data-testid":"command-palette-list",children:[o.jsx(ei.Empty,{className:"py-6 text-center text-sm text-[var(--color-text-muted)]",children:"No results found."}),u.map(d=>{const f=c[d];if(!f||f.length===0)return null;const m=CZe[d];return o.jsxs(ei.Group,{heading:m.label,className:"mb-2","data-testid":`command-group-${d}`,children:[o.jsx("div",{className:"px-2 py-1.5 text-xs font-medium text-[var(--color-text-muted)] uppercase tracking-wider",children:m.label}),f.map(p=>o.jsx(EZe,{command:p,onSelect:()=>p.action()},p.id))]},d)})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Select"})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:"K"})," ","to open"]})]})]})]})}function EZe({command:e,onSelect:t}){const r=e.icon;return o.jsxs(ei.Item,{value:[e.label,e.description,...e.keywords||[]].join(" "),onSelect:t,className:"flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text)] data-[selected=true]:bg-[var(--color-surface-selected)] data-[selected=true]:text-[var(--color-text)] transition-colors duration-100","data-testid":`command-item-${e.id}`,children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-md bg-[var(--color-surface)] text-[var(--color-text-muted)]",children:o.jsx(r,{className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:e.label}),e.description&&o.jsx("div",{className:"text-xs text-[var(--color-text-muted)] truncate",children:e.description})]}),e.shortcut&&o.jsx("kbd",{className:"hidden sm:block px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:e.shortcut})]})}function MZe(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=n=>{(n.metaKey||n.ctrlKey)&&n.key==="k"&&(n.preventDefault(),t(a=>!a))};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),{open:e,setOpen:t}}function TZe(){const e=pt({queryKey:["entities","humans"],queryFn:async()=>{const t=await fetch("/api/entities?entityType=human&limit=10000");if(!t.ok)throw new Error("Failed to fetch entities");return(await t.json()).items||[]}});return{data:e.data,isLoading:e.isLoading}}function AZe({children:e}){return o.jsx(f_e,{useHumanEntities:TZe,children:e})}const ua={js:{language:"javascript",category:"code",displayName:"JavaScript"},jsx:{language:"javascript",category:"code",displayName:"JavaScript JSX"},mjs:{language:"javascript",category:"code",displayName:"JavaScript Module"},cjs:{language:"javascript",category:"code",displayName:"CommonJS"},ts:{language:"typescript",category:"code",displayName:"TypeScript"},tsx:{language:"typescript",category:"code",displayName:"TypeScript JSX"},mts:{language:"typescript",category:"code",displayName:"TypeScript Module"},cts:{language:"typescript",category:"code",displayName:"CommonJS TypeScript"},html:{language:"html",category:"code",displayName:"HTML"},htm:{language:"html",category:"code",displayName:"HTML"},xhtml:{language:"html",category:"code",displayName:"XHTML"},css:{language:"css",category:"style",displayName:"CSS"},scss:{language:"scss",category:"style",displayName:"SCSS"},sass:{language:"scss",category:"style",displayName:"Sass"},less:{language:"less",category:"style",displayName:"Less"},stylus:{language:"stylus",category:"style",displayName:"Stylus"},json:{language:"json",category:"data",displayName:"JSON"},jsonc:{language:"json",category:"data",displayName:"JSON with Comments"},json5:{language:"json",category:"data",displayName:"JSON5"},yaml:{language:"yaml",category:"data",displayName:"YAML"},yml:{language:"yaml",category:"data",displayName:"YAML"},xml:{language:"xml",category:"data",displayName:"XML"},svg:{language:"xml",category:"data",displayName:"SVG"},toml:{language:"ini",category:"config",displayName:"TOML"},ini:{language:"ini",category:"config",displayName:"INI"},conf:{language:"ini",category:"config",displayName:"Config"},cfg:{language:"ini",category:"config",displayName:"Config"},properties:{language:"ini",category:"config",displayName:"Properties"},env:{language:"shell",category:"config",displayName:"Environment"},md:{language:"markdown",category:"document",displayName:"Markdown"},mdx:{language:"markdown",category:"document",displayName:"MDX"},markdown:{language:"markdown",category:"document",displayName:"Markdown"},rst:{language:"restructuredtext",category:"document",displayName:"reStructuredText"},txt:{language:"plaintext",category:"document",displayName:"Plain Text"},text:{language:"plaintext",category:"document",displayName:"Plain Text"},py:{language:"python",category:"code",displayName:"Python"},pyw:{language:"python",category:"code",displayName:"Python"},pyx:{language:"python",category:"code",displayName:"Cython"},pyi:{language:"python",category:"code",displayName:"Python Stub"},ipynb:{language:"json",category:"code",displayName:"Jupyter Notebook"},rb:{language:"ruby",category:"code",displayName:"Ruby"},rake:{language:"ruby",category:"code",displayName:"Rake"},gemspec:{language:"ruby",category:"code",displayName:"Gemspec"},erb:{language:"html",category:"code",displayName:"ERB"},sh:{language:"shell",category:"script",displayName:"Shell"},bash:{language:"shell",category:"script",displayName:"Bash"},zsh:{language:"shell",category:"script",displayName:"Zsh"},fish:{language:"shell",category:"script",displayName:"Fish"},ksh:{language:"shell",category:"script",displayName:"Ksh"},ps1:{language:"powershell",category:"script",displayName:"PowerShell"},psm1:{language:"powershell",category:"script",displayName:"PowerShell Module"},bat:{language:"bat",category:"script",displayName:"Batch"},cmd:{language:"bat",category:"script",displayName:"Command"},go:{language:"go",category:"code",displayName:"Go"},mod:{language:"go",category:"config",displayName:"Go Module"},rs:{language:"rust",category:"code",displayName:"Rust"},c:{language:"c",category:"code",displayName:"C"},h:{language:"c",category:"code",displayName:"C Header"},cpp:{language:"cpp",category:"code",displayName:"C++"},cc:{language:"cpp",category:"code",displayName:"C++"},cxx:{language:"cpp",category:"code",displayName:"C++"},hpp:{language:"cpp",category:"code",displayName:"C++ Header"},hxx:{language:"cpp",category:"code",displayName:"C++ Header"},hh:{language:"cpp",category:"code",displayName:"C++ Header"},java:{language:"java",category:"code",displayName:"Java"},kt:{language:"kotlin",category:"code",displayName:"Kotlin"},kts:{language:"kotlin",category:"code",displayName:"Kotlin Script"},scala:{language:"scala",category:"code",displayName:"Scala"},sc:{language:"scala",category:"code",displayName:"Scala"},groovy:{language:"groovy",category:"code",displayName:"Groovy"},gradle:{language:"groovy",category:"config",displayName:"Gradle"},cs:{language:"csharp",category:"code",displayName:"C#"},csx:{language:"csharp",category:"code",displayName:"C# Script"},fs:{language:"fsharp",category:"code",displayName:"F#"},fsx:{language:"fsharp",category:"code",displayName:"F# Script"},vb:{language:"vb",category:"code",displayName:"Visual Basic"},php:{language:"php",category:"code",displayName:"PHP"},phtml:{language:"php",category:"code",displayName:"PHP Template"},swift:{language:"swift",category:"code",displayName:"Swift"},m:{language:"objective-c",category:"code",displayName:"Objective-C"},mm:{language:"objective-c",category:"code",displayName:"Objective-C++"},r:{language:"r",category:"code",displayName:"R"},lua:{language:"lua",category:"code",displayName:"Lua"},pl:{language:"perl",category:"code",displayName:"Perl"},pm:{language:"perl",category:"code",displayName:"Perl Module"},ex:{language:"elixir",category:"code",displayName:"Elixir"},exs:{language:"elixir",category:"code",displayName:"Elixir Script"},erl:{language:"erlang",category:"code",displayName:"Erlang"},hrl:{language:"erlang",category:"code",displayName:"Erlang Header"},clj:{language:"clojure",category:"code",displayName:"Clojure"},cljs:{language:"clojure",category:"code",displayName:"ClojureScript"},cljc:{language:"clojure",category:"code",displayName:"Clojure Common"},edn:{language:"clojure",category:"data",displayName:"EDN"},hs:{language:"haskell",category:"code",displayName:"Haskell"},lhs:{language:"haskell",category:"code",displayName:"Literate Haskell"},ml:{language:"fsharp",category:"code",displayName:"OCaml"},mli:{language:"fsharp",category:"code",displayName:"OCaml Interface"},vue:{language:"vue",category:"code",displayName:"Vue"},svelte:{language:"svelte",category:"code",displayName:"Svelte"},astro:{language:"astro",category:"code",displayName:"Astro"},sql:{language:"sql",category:"data",displayName:"SQL"},mysql:{language:"mysql",category:"data",displayName:"MySQL"},pgsql:{language:"pgsql",category:"data",displayName:"PostgreSQL"},graphql:{language:"graphql",category:"data",displayName:"GraphQL"},gql:{language:"graphql",category:"data",displayName:"GraphQL"},dockerfile:{language:"dockerfile",category:"config",displayName:"Dockerfile"},makefile:{language:"makefile",category:"config",displayName:"Makefile"},cmake:{language:"cmake",category:"config",displayName:"CMake"},ninja:{language:"plaintext",category:"config",displayName:"Ninja"},tf:{language:"hcl",category:"config",displayName:"Terraform"},tfvars:{language:"hcl",category:"config",displayName:"Terraform Variables"},hcl:{language:"hcl",category:"config",displayName:"HCL"},prisma:{language:"graphql",category:"config",displayName:"Prisma"},diff:{language:"diff",category:"other",displayName:"Diff"},patch:{language:"diff",category:"other",displayName:"Patch"},log:{language:"log",category:"other",displayName:"Log"},csv:{language:"plaintext",category:"data",displayName:"CSV"},tsv:{language:"plaintext",category:"data",displayName:"TSV"}},gX={dockerfile:{language:"dockerfile",category:"config",displayName:"Dockerfile"},"dockerfile.dev":{language:"dockerfile",category:"config",displayName:"Dockerfile"},"dockerfile.prod":{language:"dockerfile",category:"config",displayName:"Dockerfile"},"dockerfile.test":{language:"dockerfile",category:"config",displayName:"Dockerfile"},makefile:{language:"makefile",category:"config",displayName:"Makefile"},gnumakefile:{language:"makefile",category:"config",displayName:"Makefile"},cmakelists:{language:"cmake",category:"config",displayName:"CMake"},gemfile:{language:"ruby",category:"config",displayName:"Gemfile"},rakefile:{language:"ruby",category:"config",displayName:"Rakefile"},vagrantfile:{language:"ruby",category:"config",displayName:"Vagrantfile"},guardfile:{language:"ruby",category:"config",displayName:"Guardfile"},podfile:{language:"ruby",category:"config",displayName:"Podfile"},fastfile:{language:"ruby",category:"config",displayName:"Fastfile"},appfile:{language:"ruby",category:"config",displayName:"Appfile"},berksfile:{language:"ruby",category:"config",displayName:"Berksfile"},brewfile:{language:"ruby",category:"config",displayName:"Brewfile"},procfile:{language:"yaml",category:"config",displayName:"Procfile"},justfile:{language:"makefile",category:"config",displayName:"Justfile"},jenkinsfile:{language:"groovy",category:"config",displayName:"Jenkinsfile"},"package.json":{language:"json",category:"config",displayName:"package.json"},"tsconfig.json":{language:"json",category:"config",displayName:"tsconfig.json"},"jsconfig.json":{language:"json",category:"config",displayName:"jsconfig.json"},".babelrc":{language:"json",category:"config",displayName:"Babel Config"},".eslintrc":{language:"json",category:"config",displayName:"ESLint Config"},".prettierrc":{language:"json",category:"config",displayName:"Prettier Config"},".editorconfig":{language:"ini",category:"config",displayName:"EditorConfig"},".gitignore":{language:"ignore",category:"config",displayName:"Git Ignore"},".dockerignore":{language:"ignore",category:"config",displayName:"Docker Ignore"},".npmignore":{language:"ignore",category:"config",displayName:"NPM Ignore"},".gitattributes":{language:"properties",category:"config",displayName:"Git Attributes"},".gitmodules":{language:"ini",category:"config",displayName:"Git Modules"},license:{language:"plaintext",category:"document",displayName:"License"},readme:{language:"markdown",category:"document",displayName:"README"},changelog:{language:"markdown",category:"document",displayName:"Changelog"},authors:{language:"plaintext",category:"document",displayName:"Authors"},contributors:{language:"plaintext",category:"document",displayName:"Contributors"},copying:{language:"plaintext",category:"document",displayName:"Copying"}},zme={language:"plaintext",category:"other",displayName:"Plain Text"};function DZe(e){if(e.endsWith(".d.ts")||e.endsWith(".d.mts")||e.endsWith(".d.cts")||e.endsWith(".test.ts")||e.endsWith(".spec.ts"))return"ts";if(e.endsWith(".test.tsx")||e.endsWith(".spec.tsx"))return"tsx";if(e.endsWith(".test.js")||e.endsWith(".spec.js"))return"js";if(e.endsWith(".test.jsx")||e.endsWith(".spec.jsx"))return"jsx";if(e.endsWith(".config.js")||e.endsWith(".config.ts"))return e.endsWith(".ts")?"ts":"js";const t=e.split(".");return t.length<2?"":t[t.length-1].toLowerCase()}function b1(e){const t=e.split("/").pop()||e,r=t.toLowerCase();if(gX[r])return gX[r];if(r.startsWith("dockerfile"))return ua.dockerfile;if(r.endsWith(".d.ts"))return{language:"typescript",category:"code",displayName:"TypeScript Declaration"};const n=DZe(t);return n&&ua[n]?ua[n]:r.startsWith(".")&&ua[r.slice(1)]?ua[r.slice(1)]:zme}function LZe(e){const t=e.toLowerCase();return t.includes("javascript")||t==="js"?ua.js:t.includes("typescript")||t==="ts"?ua.ts:t.includes("json")?ua.json:t.includes("markdown")||t==="md"?ua.md:t.includes("html")?ua.html:t.includes("css")?ua.css:t.includes("python")||t==="py"?ua.py:t.includes("yaml")||t.includes("yml")?ua.yaml:t.includes("xml")?ua.xml:t.includes("sql")?ua.sql:t.includes("shell")||t.includes("bash")||t==="sh"?ua.sh:t.includes("ruby")||t==="rb"?ua.rb:t.includes("go")?ua.go:t.includes("rust")||t==="rs"?ua.rs:t.includes("java")&&!t.includes("javascript")?ua.java:zme}function BP(e){return b1(e).language}function OZe(e,t){if(e){const r=LZe(e);if(r.language!=="plaintext")return r.language}return t?BP(t):"plaintext"}function IZe(e){const t=b1(e);return t.category==="code"||t.category==="script"}function Bme(e){return b1(e).category==="config"}function RZe(e){const t=b1(e).category;return t==="data"||t==="document"}const Bv=["workspace","tree"],PZe=3e4;function $me(e){return{id:e.path,name:e.name,type:e.type,path:e.path,size:e.size,lastModified:e.lastModified,children:e.children?.map($me)}}function zZe(e){return e.length===0?null:"Workspace"}function BZe(){const e=ft(),[t,r]=w.useState(null),{data:n,isLoading:a,isError:s,error:i,refetch:l}=pt({queryKey:Bv,queryFn:async()=>{const j=await fetch("/api/workspace/tree");if(!j.ok){const T=await j.json().catch(()=>({error:{message:"Failed to fetch workspace tree"}}));throw new Error(T.error?.message||`HTTP ${j.status}`)}const E=await j.json();if(E.error)throw new Error(E.error.message);return{entries:E.entries.map($me),root:E.root??null}},staleTime:PZe,retry:2,refetchOnWindowFocus:!1}),c=n?.entries??[],u=n?.root??null,d=c.length>0,f=zZe(c);w.useEffect(()=>{s&&i?r(i instanceof Error?i.message:"Failed to load workspace"):s||r(null)},[s,i]);const m=w.useCallback(async()=>{r(null);try{await l()}catch(j){r(j instanceof Error?j.message:"Failed to open workspace")}},[l]),p=w.useCallback(()=>{e.removeQueries({queryKey:Bv})},[e]),v=w.useCallback(async()=>{r(null);try{await l()}catch(j){r(j instanceof Error?j.message:"Failed to refresh workspace")}},[l]),b=w.useCallback(async j=>{if(j.type!=="file")throw new Error("Cannot read content of a directory");const E=await fetch(`/api/workspace/file?path=${encodeURIComponent(j.path)}`);if(!E.ok){const O=await E.json().catch(()=>({error:{message:"Failed to read file"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();if(T.error)throw new Error(T.error.message);return{content:T.content,name:T.name,path:T.path,size:T.size,lastModified:T.lastModified,language:BP(T.name)}},[]),y=w.useCallback(async j=>{try{const E=await fetch(`/api/workspace/file?path=${encodeURIComponent(j)}`);if(!E.ok){if(E.status===404)return null;const O=await E.json().catch(()=>({error:{message:"Failed to read file"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();return T.error?null:{content:T.content,name:T.name,path:T.path,size:T.size,lastModified:T.lastModified,language:BP(T.name)}}catch{return null}},[]),S=w.useCallback(async(j,E)=>{if(j.type!=="file")throw new Error("Cannot write to a directory");const T=await fetch("/api/workspace/file",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:j.path,content:E})});if(!T.ok){const R=await T.json().catch(()=>({error:{message:"Failed to write file"}}));throw new Error(R.error?.message||`HTTP ${T.status}`)}const O=await T.json();if(O.error)throw new Error(O.error.message);return{success:O.success,path:O.path,bytesWritten:O.bytesWritten}},[]),_=w.useCallback(async j=>{const E=await fetch(`/api/workspace/file?path=${encodeURIComponent(j)}`,{method:"DELETE"});if(!E.ok){const O=await E.json().catch(()=>({error:{message:"Failed to delete file"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();if(T.error)throw new Error(T.error.message);return await e.invalidateQueries({queryKey:Bv}),{success:T.success,path:T.path}},[e]),N=w.useCallback(async(j,E)=>{const T=await fetch("/api/workspace/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldPath:j,newPath:E})});if(!T.ok){const R=await T.json().catch(()=>({error:{message:"Failed to rename file"}}));throw new Error(R.error?.message||`HTTP ${T.status}`)}const O=await T.json();if(O.error)throw new Error(O.error.message);return await e.invalidateQueries({queryKey:Bv}),{success:O.success,oldPath:O.oldPath,newPath:O.newPath}},[e]),k=w.useCallback(async j=>{const E=await fetch("/api/workspace/mkdir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:j})});if(!E.ok){const O=await E.json().catch(()=>({error:{message:"Failed to create folder"}}));throw new Error(O.error?.message||`HTTP ${E.status}`)}const T=await E.json();if(T.error)throw new Error(T.error.message);return await e.invalidateQueries({queryKey:Bv}),{success:T.success,path:T.path}},[e]);return{isSupported:!0,isOpen:d,workspaceName:f,workspaceRoot:u,entries:c,isLoading:a,error:t,openWorkspace:m,closeWorkspace:p,refreshTree:v,readFile:b,readFileByPath:y,writeFile:S,deleteFile:_,renameFile:N,createFolder:k}}const Fme=w.createContext(null);function $Ze({children:e}){const t=BZe();return o.jsx(Fme.Provider,{value:t,children:e})}function y1(){const e=w.useContext(Fme);if(!e)throw new Error("useWorkspace must be used within a WorkspaceProvider");return e}function FZe(e){const t=e.split(".").pop()?.toLowerCase()||"";return new Set(["js","jsx","ts","tsx","mjs","cjs","mts","cts","json","jsonc","json5","py","pyw","pyx","go","rs","java","kt","kts","c","cpp","cc","cxx","h","hpp","hxx","cs","php","rb","swift","r","lua","pl","pm","ex","exs","erl","hrl","clj","cljs","scala","vue","svelte","astro","html","htm","css","scss","sass","less","yaml","yml","toml","xml","svg","sql","graphql","gql","sh","bash","zsh","fish","ps1","dockerfile","makefile","cmake"]).has(t)?Bi:rn}function UZe(e){const t=e.split(".").pop()?.toLowerCase()||"";return{ts:"TypeScript",tsx:"TypeScript React",js:"JavaScript",jsx:"JavaScript React",py:"Python",go:"Go",rs:"Rust",java:"Java",json:"JSON",yaml:"YAML",yml:"YAML",md:"Markdown",html:"HTML",css:"CSS",scss:"SCSS",sql:"SQL",sh:"Shell",toml:"TOML"}[t]||null}function Ume(e,t=0){const r=[];for(const n of e)r.push({id:n.id,name:n.name,path:n.path,type:n.type,depth:t}),n.children&&n.children.length>0&&r.push(...Ume(n.children,t+1));return r}function HZe({open:e,onOpenChange:t}){const r=Ma(),[n,a]=w.useState(""),s=w.useRef(null),{isOpen:i,workspaceName:l,entries:c,isLoading:u,error:d}=y1();w.useEffect(()=>{e||a("")},[e]),w.useEffect(()=>{e&&s.current&&s.current.focus()},[e]);const f=w.useMemo(()=>!i||c.length===0?[]:Ume(c).filter(v=>v.type==="file"),[i,c]),m=w.useCallback(v=>{r({to:"/editor",search:{file:v.path}}),t(!1)},[r,t]),p=v=>{const b=v.split("/");return b.length<=1?"":b.slice(0,-1).join("/")};return e?o.jsxs(ei.Dialog,{open:e,onOpenChange:t,label:"Quick File Open",className:"fixed inset-0 z-[var(--z-index-modal)] flex items-start justify-center pt-[15vh]","data-testid":"quick-file-open",children:[o.jsx("div",{className:"fixed inset-0 bg-[var(--color-bg-overlay)] backdrop-blur-sm",onClick:()=>t(!1),"data-testid":"quick-file-open-backdrop"}),o.jsxs("div",{className:"relative w-full max-w-2xl bg-[var(--color-bg-elevated)] rounded-xl shadow-2xl border border-[var(--color-border)] overflow-hidden","data-testid":"quick-file-open-dialog",children:[o.jsxs("div",{className:"flex items-center gap-3 px-4 border-b border-[var(--color-border)]",children:[o.jsx(xr,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),o.jsx(ei.Input,{ref:s,value:n,onValueChange:a,placeholder:i?"Search files by name...":"Open a workspace to search files...",className:"flex-1 h-14 bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:outline-none text-base","data-testid":"quick-file-open-input",disabled:!i}),o.jsxs("div",{className:"flex items-center gap-2",children:[l&&o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] px-2 py-1 rounded max-w-[120px] truncate",children:l}),o.jsx("kbd",{className:"hidden sm:flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:"ESC"})]})]}),o.jsxs(ei.List,{className:"max-h-[400px] overflow-y-auto","data-testid":"quick-file-open-list",children:[u&&o.jsxs("div",{className:"flex items-center justify-center py-10",children:[o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-text-muted)]"}),o.jsx("span",{className:"ml-2 text-sm text-[var(--color-text-muted)]",children:"Loading workspace..."})]}),d&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:d})]}),!u&&!d&&!i&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(Pe,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4 animate-spin"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Loading Workspace"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"The workspace is loading from the server..."})]}),!u&&!d&&i&&f.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(F6,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"No Files Found"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"The workspace doesn't contain any readable files."})]}),!u&&!d&&i&&f.length>0&&o.jsx(ei.Empty,{className:"py-10 text-center text-sm text-[var(--color-text-muted)]",children:"No files match your search."}),!u&&!d&&i&&f.length>0&&o.jsx("div",{className:"p-2",children:f.map(v=>{const b=FZe(v.name),y=p(v.path),S=UZe(v.name);return o.jsxs(ei.Item,{value:`${v.name} ${v.path}`,onSelect:()=>m(v),className:"flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text)] data-[selected=true]:bg-[var(--color-surface-selected)] data-[selected=true]:text-[var(--color-text)] transition-colors duration-100","data-testid":`quick-file-item-${v.id}`,children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-md bg-[var(--color-surface)] text-[var(--color-text-muted)]",children:o.jsx(b,{className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium truncate",children:v.name}),S&&o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 bg-[var(--color-surface)] text-[var(--color-text-muted)] rounded",children:S})]}),y&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-[var(--color-text-muted)] truncate mt-0.5",children:[o.jsx(gn,{className:"w-3 h-3"}),o.jsx("span",{children:y})]})]})]},v.id)})})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Open file"})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:"P"})," ","to toggle"]})]})]})]}):null}function qZe(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=n=>{(n.metaKey||n.ctrlKey)&&n.key==="p"&&(n.preventDefault(),t(a=>!a))};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),{open:e,setOpen:t}}function WZe(e={}){const{onToggleSidebar:t,onToggleDirector:r,onToggleDirectorMaximize:n,onOpenCommandPalette:a}=e,s=Ma(),i=e1(),l=w.useCallback(c=>()=>{const[u,d]=c.split("?");if(d){const f=new URLSearchParams(d),m={};f.forEach((p,v)=>{m[v]=p}),s({to:u,search:m})}else s({to:c})},[s]);w.useEffect(()=>{const c=zp();c.start();const u=[];for(const[d,f]of Object.entries(ix)){const m=s9(d,ix);if(m){if(d==="action.commandPalette"){a&&(c.register(m,a,f.description),u.push(m));continue}if(d==="action.toggleSidebar"){t&&(c.register(m,t,f.description),u.push(m));continue}if(d==="action.toggleDirector"){r&&(c.register(m,r,f.description),u.push(m));continue}if(d==="action.toggleDirectorMaximize"){n&&(c.register(m,n,f.description),u.push(m));continue}f.path&&(c.register(m,l(f.path),f.description||`Navigate to ${f.path}`),u.push(m))}}return()=>{u.forEach(d=>{c.unregister(d)})}},[l,t,r,n,a,i])}function vX(e){const{data:t,targetId:r,pageSize:n,getId:a}=e,s=t.findIndex(c=>a(c)===r);if(s===-1)return{found:!1,index:-1,page:1,indexOnPage:-1};const i=Math.floor(s/n)+1,l=s%n;return{found:!0,index:s,page:i,indexOnPage:l}}const zB=2e3,bX="deep-link-highlight";function KZe(e,t=zB){e.classList.add(bX),e.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{e.classList.remove(bX)},t)}function GZe(e,t=zB){const r=document.querySelector(`[data-testid="${e}"]`);return r?(KZe(r,t),!0):!1}function VZe(e){const{data:t,selectedId:r,currentPage:n,pageSize:a,getId:s,routePath:i,rowTestIdPrefix:l,autoNavigate:c=!0,highlightDelay:u=100}=e,d=Ma(),[f,m]=w.useState(!1),[p,v]=w.useState(!1),b=w.useRef(null),y=t&&r?vX({data:t,targetId:r,pageSize:a,getId:s}):{found:!1,page:1};w.useEffect(()=>{if(!t||!r){v(!1);return}if(v(!1),!y.found){v(!0);return}c&&y.page!==n?(m(!0),d({to:i,search:_=>({..._,page:y.page,selected:r})})):m(!1)},[t,r,y.found,y.page,n,c,d,i]),w.useEffect(()=>{if(!r||!y.found||f||b.current===r||y.page!==n)return;const _=setTimeout(()=>{const N=`${l}${r}`;GZe(N,zB)&&(b.current=r)},u);return()=>clearTimeout(_)},[r,y.found,y.page,n,f,l,u]),w.useEffect(()=>{r||(b.current=null)},[r]);const S=w.useCallback(_=>{if(!t)return;const N=vX({data:t,targetId:_,pageSize:a,getId:s});N.found?(m(!0),d({to:i,search:k=>({...k,page:N.page,selected:_})})):v(!0)},[t,a,s,d,i]);return{found:y.found,isNavigating:f,notFound:p,targetPage:y.page,navigateToElement:S}}function Hme(e,t,r){if(!t)return e;const n=[...e];return n.sort((a,s)=>{const i=a[t.field],l=s[t.field];let c=0;return i==null?c=1:l==null?c=-1:typeof i=="string"&&typeof l=="string"?c=i.localeCompare(l):typeof i=="number"&&typeof l=="number"?c=i-l:i instanceof Date&&l instanceof Date?c=i.getTime()-l.getTime():c=String(i).localeCompare(String(l)),t.direction==="asc"?c:-c}),n}function YZe(e){if(e.search||e.channelType&&e.channelType!=="all")return r=>{if(e.search){const n=e.search.toLowerCase();if(!r.name.toLowerCase().includes(n))return!1}return!(e.channelType&&e.channelType!=="all"&&r.channelType!==e.channelType)}}const yf=25,qme="orchestrator-tasks.viewMode",Wme="orchestrator-tasks.groupBy",$P="orchestrator-tasks.search",Kme="orchestrator-tasks.sortBy",Gme="orchestrator-tasks.sortDir",FP="orchestrator-tasks.secondarySort",Vme="orchestrator-tasks.columnWidths",uC=[{id:"checkbox",label:"",defaultWidth:40,minWidth:40,resizable:!1},{id:"title",label:"Task",defaultWidth:300,minWidth:120,resizable:!0,sortField:"title"},{id:"status",label:"Status",defaultWidth:140,minWidth:80,resizable:!0,sortField:"status"},{id:"priority",label:"Priority",defaultWidth:100,minWidth:70,resizable:!0,sortField:"priority"},{id:"taskType",label:"Type",defaultWidth:90,minWidth:60,resizable:!0,sortField:"taskType"},{id:"assignee",label:"Assignee",defaultWidth:140,minWidth:80,resizable:!0,sortField:"assignee"},{id:"branch",label:"Branch",defaultWidth:160,minWidth:80,resizable:!0},{id:"updatedAt",label:"Updated",defaultWidth:100,minWidth:70,resizable:!0,sortField:"updated_at"},{id:"actions",label:"Actions",defaultWidth:100,minWidth:60,resizable:!1}],PS=Object.fromEntries(uC.map(e=>[e.id,e.defaultWidth])),yX={status:[],priority:[],assignee:""},UP=[{value:"open",label:"Open",color:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},{value:"in_progress",label:"In Progress",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200"},{value:"blocked",label:"Blocked",color:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200"},{value:"review",label:"Review",color:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-200"},{value:"deferred",label:"Deferred",color:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-200"},{value:"backlog",label:"Backlog",color:"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300"},{value:"closed",label:"Closed",color:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200"}],dC=[{value:1,label:"Critical",color:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200"},{value:2,label:"High",color:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-200"},{value:3,label:"Medium",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200"},{value:4,label:"Low",color:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200"},{value:5,label:"Trivial",color:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}],bl=[{value:"priority",label:"Priority"},{value:"created_at",label:"Created"},{value:"updated_at",label:"Updated"},{value:"deadline",label:"Deadline"},{value:"title",label:"Title"},{value:"complexity",label:"Complexity"}],Ok=[{value:"none",label:"None"},{value:"status",label:"Status"},{value:"priority",label:"Priority"},{value:"assignee",label:"Assignee"},{value:"taskType",label:"Type"},{value:"tags",label:"Tags"}];function QZe(e,t){if(!t)return{matched:!0,indices:[]};const r=e.toLowerCase(),n=t.toLowerCase(),a=[];let s=0;for(let i=0;i<r.length&&s<n.length;i++)r[i]===n[s]&&(a.push(i),s++);return s===n.length?{matched:!0,indices:a}:null}function JZe(e,t){if(t.length===0)return e;const r=[],n=new Set(t);let a=0;for(let s=0;s<e.length;s++)n.has(s)&&(s>a&&r.push(o.jsx("span",{children:e.slice(a,s)},`text-${a}`)),r.push(o.jsx("mark",{className:"bg-yellow-200 text-gray-900 rounded-sm px-0.5",children:e[s]},`match-${s}`)),a=s+1);return a<e.length&&r.push(o.jsx("span",{children:e.slice(a)},`text-${a}`)),o.jsx(o.Fragment,{children:r})}function xX(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function wX(e,t,r,n){if(r==="createdAt"||r==="updatedAt"||r==="created_at"||r==="updated_at"){const l=r==="created_at"?"createdAt":r==="updated_at"?"updatedAt":r,c=new Date(e[l]).getTime(),u=new Date(t[l]).getTime(),d=c-u;return n==="asc"?d:-d}if(r==="deadline"){const l=e.deadline,c=t.deadline;if(!l&&!c)return 0;if(!l)return n==="asc"?1:-1;if(!c)return n==="asc"?-1:1;const u=new Date(l).getTime()-new Date(c).getTime();return n==="asc"?u:-u}if(r==="priority"){const l=(e.priority??5)-(t.priority??5);return n==="asc"?l:-l}if(r==="complexity"){const l=(e.complexity??3)-(t.complexity??3);return n==="asc"?l:-l}const a=e[r],s=t[r];let i=0;return a==null?i=1:s==null?i=-1:typeof a=="string"&&typeof s=="string"?i=a.localeCompare(s):typeof a=="number"&&typeof s=="number"?i=a-s:i=String(a).localeCompare(String(s)),n==="asc"?i:-i}function ZZe(e,t,r){if(t==="none")return[{key:"all",label:"All Tasks",tasks:e}];const n=new Map;for(const s of e){let i;switch(t){case"status":i=[s.status];break;case"priority":i=[String(s.priority)];break;case"assignee":i=[s.assignee||"unassigned"];break;case"taskType":i=[s.taskType||"task"];break;case"tags":i=s.tags.length>0?s.tags:["untagged"];break;default:i=["other"]}for(const l of i)n.has(l)||n.set(l,[]),n.get(l).push(s)}const a=[];if(t==="status"){const s=["open","in_progress","blocked","review","deferred","closed","tombstone"];for(const i of s)if(n.has(i)){const l=UP.find(c=>c.value===i);a.push({key:i,label:l?.label||xX(i),color:l?.color,tasks:n.get(i)})}for(const[i,l]of n)s.includes(i)||a.push({key:i,label:xX(i),tasks:l})}else if(t==="priority"){const s=[1,2,3,4,5];for(const i of s){const l=String(i);if(n.has(l)){const c=dC.find(u=>u.value===i);a.push({key:l,label:c?.label||`Priority ${i}`,color:c?.color,tasks:n.get(l)})}}}else if(t==="assignee"){const s=Array.from(n.keys()).sort((i,l)=>{if(i==="unassigned")return-1;if(l==="unassigned")return 1;const c=r.get(i)||i,u=r.get(l)||l;return c.localeCompare(u)});for(const i of s){const l=i==="unassigned"?"Unassigned":r.get(i)||i;a.push({key:i,label:l,tasks:n.get(i)})}}else if(t==="taskType"){const s=["task","bug","feature","chore"],i=Array.from(n.keys()).sort((l,c)=>{const u=s.indexOf(l),d=s.indexOf(c);return u>=0&&d>=0?u-d:u>=0?-1:d>=0?1:l.localeCompare(c)});for(const l of i)a.push({key:l,label:l.charAt(0).toUpperCase()+l.slice(1),tasks:n.get(l)})}else if(t==="tags"){const s=Array.from(n.keys()).sort((i,l)=>i==="untagged"?-1:l==="untagged"?1:i.localeCompare(l));for(const i of s)a.push({key:i,label:i==="untagged"?"Untagged":i,tasks:n.get(i)})}return a}function XZe(e,t){const r=t.toLowerCase().trim();return n=>{if(e.status.length>0&&!e.status.includes(n.status)||e.priority.length>0&&!e.priority.includes(n.priority)||e.assignee&&n.assignee!==e.assignee)return!1;if(r){const a=n.title.toLowerCase().includes(r),s=n.id.toLowerCase().includes(r),i=n.tags.some(l=>l.toLowerCase().includes(r));if(!a&&!s&&!i)return!1}return!0}}function eXe(){return typeof window>"u"?"":localStorage.getItem($P)||""}function tXe(e){typeof window>"u"||(e?localStorage.setItem($P,e):localStorage.removeItem($P))}function rXe(){return typeof window>"u"?"list":localStorage.getItem(qme)==="kanban"?"kanban":"list"}function nXe(e){typeof window>"u"||localStorage.setItem(qme,e)}function aXe(){if(typeof window>"u")return"none";const e=localStorage.getItem(Wme);return e&&Ok.some(t=>t.value===e)?e:"none"}function sXe(e){typeof window>"u"||localStorage.setItem(Wme,e)}function iXe(){if(typeof window>"u")return"created_at";const e=localStorage.getItem(Kme);return e&&bl.some(t=>t.value===e)?e:"created_at"}function oXe(e){typeof window>"u"||localStorage.setItem(Kme,e)}function lXe(){return typeof window>"u"?"desc":localStorage.getItem(Gme)==="asc"?"asc":"desc"}function cXe(e){typeof window>"u"||localStorage.setItem(Gme,e)}function uXe(){if(typeof window>"u")return null;const e=localStorage.getItem(FP);return e&&bl.some(t=>t.value===e)?e:null}function dXe(e){typeof window>"u"||(e?localStorage.setItem(FP,e):localStorage.removeItem(FP))}function fXe(){if(typeof window>"u")return{...PS};const e=localStorage.getItem(Vme);if(e)try{const t=JSON.parse(e);return{...PS,...t}}catch{return{...PS}}return{...PS}}function SX(e){typeof window>"u"||localStorage.setItem(Vme,JSON.stringify(e))}function hXe(){const[e,t]=w.useState(()=>fXe()),r=w.useRef(null),[n,a]=w.useState(!1),s=w.useCallback(c=>uC.find(d=>d.id===c)?.minWidth??50,[]),i=w.useCallback((c,u)=>{c.preventDefault(),c.stopPropagation();const d=e[u]??100;r.current={columnId:u,startX:c.clientX,startWidth:d},a(!0)},[e]);w.useEffect(()=>{if(!n)return;const c=d=>{const f=r.current;if(!f)return;const m=d.clientX-f.startX,p=s(f.columnId),v=Math.max(p,f.startWidth+m);t(b=>({...b,[f.columnId]:v}))},u=()=>{r.current&&t(d=>(SX(d),d)),r.current=null,a(!1)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",u),document.body.style.userSelect="none",document.body.style.cursor="col-resize",()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u),document.body.style.userSelect="",document.body.style.cursor=""}},[n,s]);const l=w.useCallback(()=>{const c=Object.fromEntries(uC.map(u=>[u.id,u.defaultWidth]));t(c),SX(c)},[]);return{columnWidths:e,isDragging:n,handleMouseDown:i,resetColumnWidths:l}}const Yme=300,kX=200;function mXe(e){const t=e.split("/");return t[t.length-1]||e}function pXe(e){const t=mXe(e.path),r=e.matches.map(n=>({line:n.line,column:n.column,matchedText:n.lineContent.slice(n.column-1,n.column-1+n.length),lineContent:n.lineContent,startIndex:n.column-1,endIndex:n.column-1+n.length}));return{path:e.path,name:t,matches:r,totalMatches:e.matches.length}}const _X={query:"",debouncedQuery:"",isSearching:!1,results:[],filesSearched:0,totalFiles:0,totalMatches:0,progress:0,error:null,isComplete:!1,searchTime:null},gXe={caseSensitive:!1,useRegex:!1,wholeWord:!1,includeExtensions:void 0,excludeExtensions:void 0,debounceDelay:Yme};function Qme(e={}){const{isOpen:t}=y1(),[r,n]=w.useState(_X),[a,s]=w.useState({...gXe,...e}),i=w.useRef(null),l=RB(r.query,a.debounceDelay??Yme);w.useEffect(()=>{n(m=>({...m,debouncedQuery:l}))},[l]);const c=w.useCallback(m=>{n(p=>({...p,query:m,isComplete:!1}))},[]),u=w.useCallback(()=>{i.current&&(i.current.abort(),i.current=null),n(m=>({...m,isSearching:!1,isComplete:!0}))},[]),d=w.useCallback(()=>{u(),n(_X)},[u]),f=w.useCallback(m=>{s(p=>({...p,...m}))},[]);return w.useEffect(()=>{if(i.current&&i.current.abort(),!l.trim()||!t){n(v=>({...v,results:[],isSearching:!1,filesSearched:0,totalFiles:0,totalMatches:0,progress:0,error:null,isComplete:!l.trim(),searchTime:null}));return}const m=new AbortController;return i.current=m,(async()=>{const v=performance.now();n(b=>({...b,isSearching:!0,results:[],filesSearched:0,totalFiles:0,totalMatches:0,progress:0,error:null,isComplete:!1,searchTime:null}));try{let b,y;a.includeExtensions&&a.includeExtensions.length>0&&(b=`*.{${a.includeExtensions.join(",")}}`),a.excludeExtensions&&a.excludeExtensions.length>0&&(y=`*.{${a.excludeExtensions.join(",")}}`);const S=await fetch("/api/workspace/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:l,isRegex:a.useRegex??!1,caseSensitive:a.caseSensitive??!1,wholeWord:a.wholeWord??!1,includePattern:b,excludePattern:y,maxResults:kX}),signal:m.signal});if(!S.ok){const j=await S.json().catch(()=>({error:{message:"Search failed"}}));throw new Error(j.error?.message||`HTTP ${S.status}`)}const _=await S.json();if(_.error)throw new Error(_.error.message);const N=_.results.map(pXe),k=performance.now();n(j=>({...j,results:N,filesSearched:N.length,totalFiles:N.length,totalMatches:_.totalMatches,progress:1,isSearching:!1,isComplete:!0,searchTime:k-v,error:_.truncated?`Search stopped: Maximum ${kX} matches reached`:null}))}catch(b){if(b instanceof Error&&b.name==="AbortError")return;const y=performance.now();n(S=>({...S,isSearching:!1,isComplete:!0,searchTime:y-v,error:b instanceof Error?b.message:"Search failed"}))}})(),()=>{m.abort()}},[l,t,a.caseSensitive,a.useRegex,a.wholeWord,a.includeExtensions,a.excludeExtensions]),{...r,setQuery:c,cancelSearch:u,clearResults:d,options:a,setOptions:f}}function vXe(e){const t=e.split(".").pop()?.toLowerCase()||"";return new Set(["js","jsx","ts","tsx","mjs","cjs","mts","cts","json","jsonc","json5","py","pyw","pyx","go","rs","java","kt","kts","c","cpp","cc","cxx","h","hpp","hxx","cs","php","rb","swift","r","lua","pl","pm","ex","exs","erl","hrl","clj","cljs","scala","vue","svelte","astro","html","htm","css","scss","sass","less","yaml","yml","toml","xml","svg","sql","graphql","gql","sh","bash","zsh","fish","ps1","dockerfile","makefile","cmake"]).has(t)?Bi:rn}function bXe({lineContent:e,startIndex:t,endIndex:r}){const n=e.slice(0,t),a=e.slice(t,r),s=e.slice(r),i=100;let l=n,c=s;n.length>30&&(l="..."+n.slice(-27)),s.length>50&&(c=s.slice(0,47)+"...");const u=l.length+a.length+c.length;if(u>i){const d=u-i;c.length>d&&(c=c.slice(0,c.length-d-3)+"...")}return o.jsxs("span",{className:"font-mono text-xs",children:[o.jsx("span",{className:"text-[var(--color-text-muted)]",children:l}),o.jsx("span",{className:"bg-[var(--color-warning)]/30 text-[var(--color-text)] font-semibold px-0.5 rounded",children:a}),o.jsx("span",{className:"text-[var(--color-text-muted)]",children:c})]})}function yXe({result:e,isExpanded:t,onToggleExpand:r,onSelectMatch:n}){const a=vXe(e.name),s=e.path.includes("/")?e.path.split("/").slice(0,-1).join("/"):"";return o.jsxs("div",{className:"border-b border-[var(--color-border)] last:border-b-0",children:[o.jsxs("button",{onClick:r,className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-[var(--color-surface-hover)] transition-colors text-left",children:[t?o.jsx(Yt,{className:"w-4 h-4 text-[var(--color-text-muted)] flex-shrink-0"}):o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-muted)] flex-shrink-0"}),o.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded bg-[var(--color-surface)] text-[var(--color-text-muted)] flex-shrink-0",children:o.jsx(a,{className:"w-3.5 h-3.5"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.name}),o.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-[var(--color-primary)]/10 text-[var(--color-primary)] rounded",children:[e.totalMatches," ",e.totalMatches===1?"match":"matches"]})]}),s&&o.jsx("div",{className:"text-xs text-[var(--color-text-muted)] truncate",children:s})]})]}),t&&o.jsxs("div",{className:"bg-[var(--color-surface)]/50",children:[e.matches.map((i,l)=>o.jsxs("button",{onClick:()=>n(e,i),className:"w-full flex items-start gap-2 px-3 py-1.5 pl-11 hover:bg-[var(--color-surface-hover)] transition-colors text-left",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] font-mono w-8 text-right flex-shrink-0",children:i.line}),o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] mr-1",children:":"}),o.jsx(bXe,{lineContent:i.lineContent,startIndex:i.startIndex,endIndex:i.endIndex})]},`${i.line}-${i.column}-${l}`)),e.totalMatches>e.matches.length&&o.jsxs("div",{className:"px-3 py-1.5 pl-11 text-xs text-[var(--color-text-muted)] italic",children:["+",e.totalMatches-e.matches.length," more matches..."]})]})]})}function ML({active:e,onClick:t,icon:r,label:n,shortLabel:a}){return o.jsxs("button",{onClick:t,className:`
        flex items-center gap-1 px-2 py-1 rounded text-xs transition-colors
        ${e?"bg-[var(--color-primary)] text-white":"bg-[var(--color-surface)] text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
      `,title:n,children:[o.jsx(r,{className:"w-3.5 h-3.5"}),a&&o.jsx("span",{className:"hidden sm:inline",children:a})]})}function xXe({open:e,onOpenChange:t}){const r=Ma(),n=w.useRef(null),[a,s]=w.useState(new Set),{isOpen:i,workspaceName:l,isLoading:c,error:u}=y1(),{query:d,setQuery:f,isSearching:m,results:p,filesSearched:v,totalFiles:b,totalMatches:y,progress:S,error:_,isComplete:N,searchTime:k,options:j,setOptions:E,clearResults:T}=Qme();w.useEffect(()=>{e||(T(),s(new Set))},[e,T]),w.useEffect(()=>{e&&n.current&&n.current.focus()},[e]),w.useEffect(()=>{p.length>0&&p.length<=5&&s(new Set(p.map(B=>B.path)))},[p]);const O=w.useCallback((B,F)=>{r({to:"/editor",search:{file:B.path,line:F.line,column:F.column}}),t(!1)},[r,t]),R=w.useCallback(B=>{s(F=>{const q=new Set(F);return q.has(B)?q.delete(B):q.add(B),q})},[]),H=w.useCallback(()=>{E({caseSensitive:!j.caseSensitive})},[j.caseSensitive,E]),$=w.useCallback(()=>{E({useRegex:!j.useRegex})},[j.useRegex,E]),L=w.useCallback(()=>{E({wholeWord:!j.wholeWord})},[j.wholeWord,E]);if(!e)return null;const A=d.trim().length>0,M=m&&b>0,P=p.length>0,I=N&&A&&p.length===0&&!_;return o.jsxs(ei.Dialog,{open:e,onOpenChange:t,label:"Search in Files",className:"fixed inset-0 z-[var(--z-index-modal)] flex items-start justify-center pt-[10vh]","data-testid":"file-content-search",shouldFilter:!1,children:[o.jsx("div",{className:"fixed inset-0 bg-[var(--color-bg-overlay)] backdrop-blur-sm",onClick:()=>t(!1),"data-testid":"file-content-search-backdrop"}),o.jsxs("div",{className:"relative w-full max-w-3xl bg-[var(--color-bg-elevated)] rounded-xl shadow-2xl border border-[var(--color-border)] overflow-hidden","data-testid":"file-content-search-dialog",children:[o.jsxs("div",{className:"border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-3 px-4",children:[o.jsx(xr,{className:"w-5 h-5 text-[var(--color-text-muted)]"}),o.jsx(ei.Input,{ref:n,value:d,onValueChange:f,placeholder:i?"Search in files...":"Open a workspace to search...",className:"flex-1 h-14 bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-muted)] focus:outline-none text-base","data-testid":"file-content-search-input",disabled:!i}),m&&o.jsx(Pe,{className:"w-5 h-5 animate-spin text-[var(--color-primary)]"}),o.jsxs("div",{className:"flex items-center gap-2",children:[l&&o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] px-2 py-1 rounded max-w-[120px] truncate",children:l}),o.jsx("kbd",{className:"hidden sm:flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded",children:"ESC"})]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]/50",children:[o.jsx(Cwe,{className:"w-4 h-4 text-[var(--color-text-muted)]"}),o.jsx(ML,{active:j.caseSensitive??!1,onClick:H,icon:Jae,label:"Match Case",shortLabel:"Aa"}),o.jsx(ML,{active:j.wholeWord??!1,onClick:L,icon:Zae,label:"Whole Word",shortLabel:"W"}),o.jsx(ML,{active:j.useRegex??!1,onClick:$,icon:Xae,label:"Use Regular Expression",shortLabel:".*"}),o.jsx("div",{className:"flex-1"}),M&&o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{children:[v,"/",b," files"]}),o.jsx("div",{className:"w-16 h-1.5 bg-[var(--color-surface)] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-[var(--color-primary)] transition-all duration-200",style:{width:`${S*100}%`}})})]}),N&&A&&!m&&o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[y," ",y===1?"result":"results",k!==null&&` in ${Math.round(k)}ms`]})]})]}),o.jsxs(ei.List,{className:"max-h-[60vh] overflow-y-auto","data-testid":"file-content-search-list",children:[c&&o.jsxs("div",{className:"flex items-center justify-center py-10",children:[o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-text-muted)]"}),o.jsx("span",{className:"ml-2 text-sm text-[var(--color-text-muted)]",children:"Loading workspace..."})]}),u&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:u})]}),_&&o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-[var(--color-danger)]/10 text-[var(--color-danger)] text-sm",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{children:_})]}),!c&&!u&&!i&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(Pe,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4 animate-spin"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Loading Workspace"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"The workspace is loading from the server..."})]}),i&&!A&&!m&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(xr,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Search in Files"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"Type to search for text across all files in your workspace."})]}),I&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center px-4",children:[o.jsx(yt,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"No Results Found"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)]",children:['No files contain "',d,'"']})]}),P&&o.jsx("div",{className:"divide-y divide-[var(--color-border)]",children:p.map(B=>o.jsx(yXe,{result:B,isExpanded:a.has(B.path),onToggleExpand:()=>R(B.path),onSelectMatch:O},B.path))})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--color-text-muted)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Navigate"})]}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:""}),o.jsx("span",{children:"Go to line"})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs",children:"F"})," ","to toggle"]})]})]})]})}function wXe(){const[e,t]=w.useState(!1);return w.useEffect(()=>{const r=n=>{if((n.metaKey||n.ctrlKey)&&n.shiftKey&&n.key.toLowerCase()==="f"){if(window.location.pathname==="/editor")return;n.preventDefault(),t(a=>!a)}};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[]),{open:e,setOpen:t}}function SXe(){return pt({queryKey:["health"],queryFn:async()=>{const e=await fetch("/api/health");if(!e.ok)throw new Error("Failed to fetch health");return e.json()},refetchInterval:3e4})}function kXe({health:e}){return e.isLoading?o.jsxs("div",{className:"flex items-center gap-2 text-[var(--color-text-tertiary)]",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--color-text-tertiary)] animate-pulse"}),o.jsx("span",{className:"text-sm",children:"Connecting..."})]}):e.isError?o.jsxs("div",{className:"flex items-center gap-2 text-[var(--color-danger-text)]",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--color-danger)]"}),o.jsx("span",{className:"text-sm font-medium",children:"Disconnected"})]}):o.jsxs("div",{className:"flex items-center gap-2 text-[var(--color-success-text)]",children:[o.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--color-success)]"}),o.jsx("span",{className:"text-sm font-medium",children:"Connected"})]})}const HP={"/activity":{label:"Activity",icon:Hh},"/tasks":{label:"Tasks",icon:Tl},"/merge-requests":{label:"Merge Requests",icon:Ps},"/plans":{label:"Plans",icon:tu},"/agents":{label:"Agents",icon:ds},"/workspaces":{label:"Workspaces",icon:bh},"/workflows":{label:"Workflows",icon:vh},"/metrics":{label:"Metrics",icon:QC},"/settings":{label:"Settings",icon:Wa},"/inbox":{label:"Inbox",icon:ni},"/messages":{label:"Messages",icon:oi},"/documents":{label:"Documents",icon:rn},"/editor":{label:"Editor",icon:Bi}};function Jme(){const t=WC().location.pathname;return w.useMemo(()=>{const r=[];let n=t;const a=[];for(;n;){const s=HP[n];if(s)a.unshift(n),n=s.parent||"";else{const i=n.split("/").filter(Boolean);if(i.length>1)n="/"+i.slice(0,-1).join("/");else break}}return a.forEach((s,i)=>{const l=HP[s];l&&r.push({label:l.label,path:s,icon:l.icon,isLast:i===a.length-1})}),r},[t])}function _Xe(){const e=Jme();return e.length===0?null:o.jsx("nav",{"aria-label":"Breadcrumb","data-testid":"breadcrumbs",children:o.jsx("ol",{className:"flex items-center gap-1 text-sm",children:e.map((t,r)=>{const n=t.icon;return o.jsxs("li",{className:"flex items-center",children:[r>0&&o.jsx(gn,{className:"w-4 h-4 mx-1 text-[var(--color-text-muted)]"}),t.isLast?o.jsxs("span",{className:"flex items-center gap-1.5 px-2 py-1 font-normal text-[var(--color-text)] rounded-md","data-testid":`breadcrumb-${t.label.toLowerCase().replace(/\s/g,"-")}`,children:[n&&o.jsx(n,{className:"w-4 h-4"}),t.label]}):o.jsxs(I6,{to:t.path,className:"flex items-center gap-1.5 px-2 py-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors duration-150","data-testid":`breadcrumb-${t.label.toLowerCase().replace(/\s/g,"-")}`,children:[n&&o.jsx(n,{className:"w-4 h-4"}),t.label]})]},t.path)})})})}function NXe(){const e=Jme(),t=e[e.length-1];if(!t)return null;const r=t.icon;return o.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-sm font-normal text-[var(--color-text)]","data-testid":"breadcrumbs-mobile",children:[r&&o.jsx(r,{className:"w-4 h-4"}),o.jsx("span",{className:"truncate max-w-[150px]",children:t.label})]})}const NX="orchestrator-sidebar-collapsed",CX="orchestrator-director-collapsed",jX="orchestrator-director-maximized";function CXe(){const e=jo(),t=gke(),[r,n]=w.useState(()=>typeof window>"u"?!1:localStorage.getItem(NX)==="true"),[a,s]=w.useState(!1);return w.useEffect(()=>{localStorage.setItem(NX,String(r))},[r]),w.useEffect(()=>{e||s(!1)},[e]),{isMobile:e,isTablet:t,desktopCollapsed:r,setDesktopCollapsed:n,mobileDrawerOpen:a,setMobileDrawerOpen:s}}function jXe(){const e=jo(),[t,r]=w.useState(()=>{if(typeof window>"u")return!0;const i=localStorage.getItem(CX);return i===null?!0:i==="true"}),[n,a]=w.useState(()=>typeof window>"u"?!1:localStorage.getItem(jX)==="true");return w.useEffect(()=>{localStorage.setItem(CX,String(t))},[t]),w.useEffect(()=>{localStorage.setItem(jX,String(n))},[n]),{collapsed:e?!0:t,setCollapsed:r,isMaximized:e?!1:n,setIsMaximized:a,isMobile:e}}function EXe(){const{isMobile:e,isTablet:t,desktopCollapsed:r,setDesktopCollapsed:n,mobileDrawerOpen:a,setMobileDrawerOpen:s}=CXe(),{collapsed:i,setCollapsed:l,isMaximized:c,setIsMaximized:u}=jXe(),d=SXe(),f=$ae(),{notifications:m,unreadCount:p,isConnected:v,markAsRead:b,markAllAsRead:y,dismissNotification:S,clearAll:_}=IJe(),{open:N,setOpen:k}=MZe(),{open:j,setOpen:E}=qZe(),{open:T,setOpen:O}=wXe(),R=w.useCallback(()=>{e?s(B=>!B):n(B=>!B)},[e,s,n]),H=w.useCallback(()=>{l(B=>!B)},[l]),$=w.useCallback(()=>{i&&l(!1),u(B=>!B)},[i,l,u]),L=w.useCallback(()=>{k(!0)},[k]);WZe({onToggleSidebar:R,onToggleDirector:H,onToggleDirectorMaximize:$,onOpenCommandPalette:L});const A=w.useCallback(()=>{s(!0)},[s]),M=w.useCallback(()=>{s(!1)},[s]);w.useEffect(()=>{const B=()=>{l(F=>!F)};return window.addEventListener("toggle-director-panel",B),()=>window.removeEventListener("toggle-director-panel",B)},[l]),w.useEffect(()=>{const B=()=>{$()};return window.addEventListener("maximize-director-panel",B),()=>window.removeEventListener("maximize-director-panel",B)},[$]),w.useEffect(()=>{const B=()=>{l(!1)};return window.addEventListener("open-director-panel",B),()=>window.removeEventListener("open-director-panel",B)},[l]),w.useEffect(()=>{const B=f.subscribe("onResolved",()=>{e&&a&&s(!1)});return()=>B()},[f,e,a,s]);const P=WC();w.useEffect(()=>{const B=P.location.pathname,F=HP[B];document.title=F?`Stoneforge | ${F.label}`:"Stoneforge"},[P.location.pathname]);const I=e||t?!0:r;return o.jsxs("div",{className:"flex h-screen bg-[var(--color-bg)]","data-testid":"app-shell",children:[e&&o.jsx(vke,{open:a,onClose:M,"data-testid":"mobile-drawer",children:o.jsx(gZ,{collapsed:!1,onToggle:M,isMobileDrawer:!0})}),!e&&!(c&&!i)&&o.jsx(gZ,{collapsed:I,onToggle:()=>n(!r)}),o.jsxs("div",{className:`flex flex-col min-w-0 ${c&&!i?"hidden":"flex-1"}`,children:[o.jsx("header",{className:"h-14 bg-[var(--color-header-bg)] border-b border-[var(--color-header-border)] overflow-x-auto scrollbar-hide","data-testid":"header",children:o.jsxs("div",{className:"flex items-center justify-between h-full px-4 md:px-6 min-w-max",children:[e&&o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsx("button",{onClick:A,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target flex-shrink-0","aria-label":"Open navigation menu","aria-expanded":a,"data-testid":"mobile-menu-button",children:o.jsx(jwe,{className:"w-5 h-5"})}),o.jsx("div",{className:"flex-1 text-center whitespace-nowrap",children:o.jsx(NXe,{})}),o.jsx("button",{className:"p-2 -mr-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target flex-shrink-0","aria-label":"Search","data-testid":"mobile-search-button",children:o.jsx(xr,{className:"w-5 h-5"})})]}),!e&&o.jsx("div",{className:"flex-shrink-0 whitespace-nowrap",children:o.jsx(_Xe,{})}),o.jsxs("div",{className:"flex items-center gap-2 md:gap-4 flex-shrink-0",children:[!e&&o.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-muted)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text-secondary)] transition-colors duration-150 whitespace-nowrap","aria-label":"Open command palette","data-testid":"command-palette-trigger",children:[o.jsx(xr,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{className:"hidden lg:inline",children:"Search..."}),o.jsxs("kbd",{className:"hidden md:flex items-center gap-0.5 px-1.5 py-0.5 text-xs bg-[var(--color-bg)] border border-[var(--color-border)] rounded",children:[o.jsx(Ewe,{className:"w-3 h-3"}),"K"]})]}),!e&&o.jsx(m_e,{}),!e&&o.jsx(wZe,{}),!e&&o.jsx(SZe,{}),o.jsx(NZe,{notifications:m,unreadCount:p,isConnected:v,onMarkAsRead:b,onMarkAllAsRead:y,onDismiss:S,onClearAll:_,onOpenSettings:()=>f.navigate({to:"/settings",search:{tab:"preferences"}})}),o.jsx(hke,{}),!e&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-5 w-px bg-[var(--color-border)] flex-shrink-0"}),o.jsx(kXe,{health:d})]})]})]})}),o.jsx("main",{className:"flex-1 overflow-y-auto p-4 @md:p-6 bg-[var(--color-bg)] @container",children:o.jsx(Fae,{})})]}),!e&&o.jsx(uJe,{collapsed:i,onToggle:H,isMaximized:c,onToggleMaximize:$}),o.jsx(jZe,{open:N,onOpenChange:k}),o.jsx(HZe,{open:j,onOpenChange:E}),o.jsx(xXe,{open:T,onOpenChange:O})]})}const MXe={created:dr,updated:Twe,closed:zs,reopened:jr,deleted:pr,dependency_added:tse,dependency_removed:ese,tag_added:Vc,tag_removed:Vc,member_added:Yae,member_removed:Vae,auto_blocked:GC,auto_unblocked:Mwe},TXe={task:"Task",entity:"Entity",document:"Document",channel:"Channel",message:"Message",plan:"Plan",workflow:"Workflow",library:"Library",team:"Team"};function AXe({event:e,onOpenInWorkspace:t}){const[r,n]=w.useState(!1),a=MXe[e.eventType]||Hh,s=CJe(e.eventType),i=e.elementType?TXe[e.elementType]||e.elementType:"item",l=e.oldValue&&Object.keys(e.oldValue).length>0||e.newValue&&Object.keys(e.newValue).length>0;return o.jsx("div",{className:"group bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg p-4 hover:border-[var(--color-border-hover)] transition-colors duration-150","data-testid":"activity-card","data-event-id":e.id,children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:`${s}20`},children:o.jsx(a,{className:"w-4 h-4",style:{color:s}})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm text-[var(--color-text)]","data-testid":"activity-summary",children:e.summary||`${e.eventType} on ${i}`}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-[var(--color-text-tertiary)]",children:[e.actorName&&o.jsxs(o.Fragment,{children:[o.jsx("span",{"data-testid":"activity-actor",children:e.actorName}),o.jsx("span",{children:""})]}),o.jsx("span",{"data-testid":"activity-time",children:OB(e.createdAt)}),e.elementType&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium bg-[var(--color-surface-hover)]","data-testid":"activity-element-type",children:i})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-150",children:[t&&o.jsx("button",{onClick:()=>t(e),className:"p-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors duration-150",title:"Open in Workspace","data-testid":"activity-open-workspace",children:o.jsx(wl,{className:"w-4 h-4"})}),l&&o.jsx("button",{onClick:()=>n(!r),className:"p-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors duration-150",title:r?"Collapse":"Expand","data-testid":"activity-expand",children:r?o.jsx(e0,{className:"w-4 h-4"}):o.jsx(Yt,{className:"w-4 h-4"})})]})]}),e.elementTitle&&o.jsx("div",{className:"mt-2",children:o.jsx("span",{className:"text-sm font-medium text-[var(--color-primary)] hover:underline cursor-pointer","data-testid":"activity-element-title",children:e.elementTitle})}),r&&l&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-[var(--color-border)] space-y-3","data-testid":"activity-details",children:[e.newValue&&Object.keys(e.newValue).length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] mb-1",children:e.eventType==="created"?"Initial Values":"New Values"}),o.jsx("pre",{className:"text-xs bg-[var(--color-surface-hover)] p-2 rounded overflow-x-auto",children:JSON.stringify(e.newValue,null,2)})]}),e.oldValue&&Object.keys(e.oldValue).length>0&&e.eventType!=="created"&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] mb-1",children:"Previous Values"}),o.jsx("pre",{className:"text-xs bg-[var(--color-surface-hover)] p-2 rounded overflow-x-auto",children:JSON.stringify(e.oldValue,null,2)})]})]})]})]})})}function DXe({events:e,isLoading:t,hasMore:r,onLoadMore:n,onOpenInWorkspace:a,emptyMessage:s="No activity to show"}){const i=w.useRef(null),l=w.useRef(null),c=w.useCallback(u=>{i.current&&i.current.disconnect(),u&&r&&n&&(i.current=new IntersectionObserver(d=>{d[0].isIntersecting&&!t&&n()},{threshold:.1}),i.current.observe(u)),l.current=u},[r,t,n]);return w.useEffect(()=>()=>{i.current&&i.current.disconnect()},[]),e.length===0&&!t?o.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center","data-testid":"activity-empty",children:o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:s})}):o.jsxs("div",{className:"space-y-3","data-testid":"activity-list",children:[e.map(u=>o.jsx(AXe,{event:u,onOpenInWorkspace:a},u.id)),r&&o.jsx("div",{ref:c,className:"flex items-center justify-center py-4","data-testid":"activity-load-more",children:t&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Loading more..."]})}),t&&e.length===0&&o.jsx("div",{className:"flex items-center justify-center py-12","data-testid":"activity-loading",children:o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-text-secondary)]"})})]})}const LXe={assistant:Vr,tool_use:Zo,tool_result:zs,error:Rt,system:YC,result:zs},OXe={assistant:"var(--color-primary)",tool_use:"var(--color-warning)",tool_result:"var(--color-success)",error:"var(--color-error)",system:"var(--color-info)",result:"var(--color-success)"};function IXe({event:e,onOpenInWorkspace:t}){const r=LXe[e.type]||Vr,n=OXe[e.type]||"var(--color-text-secondary)",a=e.content?e.content.length>200?`${e.content.slice(0,200)}...`:e.content:null,s=new Date(e.timestamp).toLocaleTimeString();return o.jsx("div",{className:"group bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg p-3 hover:border-[var(--color-border-hover)] transition-colors duration-150","data-testid":"session-activity-card","data-session-id":e.sessionId,children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center",style:{backgroundColor:`${n}20`},children:o.jsx(r,{className:"w-3.5 h-3.5",style:{color:n}})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-secondary)]",children:[e.agentName&&o.jsx("span",{className:"font-medium text-[var(--color-text)]","data-testid":"session-agent-name",children:e.agentName}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium bg-[var(--color-surface-hover)] capitalize","data-testid":"session-event-type",children:e.type.replace("_"," ")}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]","data-testid":"session-time",children:s})]}),t&&o.jsx("button",{onClick:()=>t(e.sessionId),className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] opacity-0 group-hover:opacity-100 transition-all duration-150",title:"Open in Workspace","data-testid":"session-open-workspace",children:o.jsx(na,{className:"w-3.5 h-3.5"})})]}),a&&o.jsx("p",{className:"mt-1.5 text-sm text-[var(--color-text)] whitespace-pre-wrap break-words font-mono text-xs","data-testid":"session-content",children:a})]})]})})}const EX={director:{label:"Director",icon:zx,color:"text-[var(--color-warning)]"},worker:{label:"Worker",icon:Zo,color:"text-[var(--color-primary)]"},steward:{label:"Steward",icon:Al,color:"text-[var(--color-info)]"}};function MX(e){const t=Date.now()-(typeof e=="number"?e:new Date(e).getTime()),r=Math.floor(t/1e3),n=Math.floor(r/3600),a=Math.floor(r%3600/60),s=r%60;return n>0?`${n}h ${a}m ${s.toString().padStart(2,"0")}s`:`${a}m ${s.toString().padStart(2,"0")}s`}function RXe({agent:e,session:t,currentTask:r,lastOutput:n,onOpenTerminal:a,onStop:s,isStopping:i}){const[l,c]=w.useState(""),u=t.startedAt||t.createdAt;w.useEffect(()=>{c(MX(u));const b=setInterval(()=>c(MX(u)),1e3);return()=>clearInterval(b)},[u]);const d=t.agentRole||e.metadata?.agent?.agentRole||"worker",f=EX[d]||EX.worker,m=f.icon,p=t.status==="running",v=t.status==="starting";return o.jsxs("div",{className:"flex flex-col gap-2 p-4 rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":`active-agent-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full flex-shrink-0 ${p?"bg-[var(--color-success)] animate-pulse":v?"bg-[var(--color-warning)] animate-pulse":"bg-[var(--color-text-tertiary)]"}`}),o.jsx("span",{className:"font-semibold text-sm text-[var(--color-text)] truncate",children:e.name}),o.jsxs("span",{className:`flex items-center gap-1 ml-auto text-xs font-medium ${f.color}`,children:[o.jsx(m,{className:"w-3 h-3"}),f.label]})]}),o.jsx("div",{className:"text-xs text-[var(--color-text-secondary)] truncate",children:r?o.jsxs(o.Fragment,{children:["Working on:"," ",o.jsx("span",{className:"font-medium text-[var(--color-text)]",children:r.externalRef||r.id})," ",o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:r.title})]}):o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:"No task assigned"})}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("div",{className:"flex-1 min-w-0 rounded-md border border-[var(--color-border)] bg-[var(--color-surface-hover)] px-3 py-2",children:o.jsx("span",{className:"text-xs font-mono text-[var(--color-text-secondary)] line-clamp-3",children:n?.content?n.content:v?"starting...":p?"working...":"idle..."})}),o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)] font-mono flex-shrink-0 pt-2",children:l})]}),o.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[o.jsxs("button",{onClick:()=>a(e.id),className:"flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded border border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150",children:[o.jsx(na,{className:"w-3 h-3"}),d==="director"?"Open Panel":"Open Terminal"]}),o.jsxs("button",{onClick:()=>s(e.id),disabled:i,className:"flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded border border-[var(--color-border)] text-[var(--color-error)] hover:bg-[var(--color-error-muted)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150",children:[o.jsx(uu,{className:"w-3 h-3"}),i?"Stopping...":"Stop"]})]})]})}const PXe="";function zXe(e){if(e.type==="tool_use"){const t=e.tool;return t?`Using ${t.charAt(0).toUpperCase()+t.slice(1)}...`:"Running tool..."}if(e.type==="tool_result")return"Tool completed"}const BXe=new Set(["tool_use","tool_result","assistant"]);async function $Xe(e){const t=new Map;if(e.length===0)return t;const r=e.map(n=>n.sessionId).join(",");try{const n=await fetch(`${PXe}/api/sessions/latest-messages?sessionIds=${encodeURIComponent(r)}`);if(!n.ok)return t;const a=await n.json();for(const[,s]of Object.entries(a.messages))s.content&&s.agentId&&t.set(s.agentId,{content:s.content,timestamp:s.timestamp,eventType:s.type})}catch{}return t}function FXe(e){const{isConnected:t,sessionEvents:r}=LB("all"),n=w.useRef(new Map),[a,s]=w.useState(0),i=w.useRef(new Set),l=w.useCallback(async c=>{const u=c.filter(m=>!i.current.has(m.sessionId));if(u.length===0)return;const d=await $Xe(u);let f=!1;for(const[m,p]of d)n.current.has(m)||(n.current.set(m,p),f=!0);for(const m of u)i.current.add(m.sessionId);f&&s(m=>m+1)},[]);return w.useEffect(()=>{e&&e.length>0&&l(e)},[e,l]),w.useEffect(()=>{if(r.length===0){n.current.size>0&&(n.current.clear(),s(f=>f+1));return}const c=new Map;for(const f of r){if(!f.agentId||c.has(f.agentId))continue;let m=f.content;!m&&BXe.has(f.type)&&(m=zXe(f)),m&&c.set(f.agentId,{content:m,timestamp:f.timestamp,eventType:f.type})}let u=!1;const d=new Map(c);for(const[f,m]of n.current)d.has(f)||d.set(f,m);if(d.size!==n.current.size)u=!0;else for(const[f,m]of d){const p=n.current.get(f);if(!p||p.content!==m.content||p.timestamp!==m.timestamp){u=!0;break}}u&&(n.current=d,s(f=>f+1))},[r]),{outputByAgent:n.current,isConnected:t,_version:a}}const TX={director:0,worker:1,steward:2};function UXe({onOpenTerminal:e,onOpenDirectorPanel:t,onStopAgent:r}){const{allAgents:n}=g0(),{data:a}=b2({status:"running"}),{inProgress:s,awaitingMerge:i}=g1(),l=a?.sessions??[],c=w.useMemo(()=>l.map(N=>({sessionId:N.id,agentId:N.agentId})),[l]),{outputByAgent:u}=FXe(c),{data:d}=v1(),[f,m]=w.useState(new Set),p=w.useMemo(()=>l.map(N=>N.id),[l]),{latestBySession:v}=xZe(p),b=w.useMemo(()=>{const N=new Map;for(const k of n)N.set(k.id,k);return N},[n]),y=w.useMemo(()=>{const N=new Map;for(const k of i)k.assignee&&N.set(k.assignee,k);for(const k of s)k.assignee&&N.set(k.assignee,k);return N},[s,i]),S=w.useMemo(()=>{const N=[];for(const k of l){const j=b.get(k.agentId);if(!j)continue;const E=y.get(j.id);N.push({agent:j,session:k,task:E})}return N.sort((k,j)=>{const E=TX[k.session.agentRole]??1,T=TX[j.session.agentRole]??1;return E-T}),N},[l,b,y]),_=async N=>{m(k=>new Set(k).add(N));try{await r(N)}finally{m(k=>{const j=new Set(k);return j.delete(N),j})}};return S.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 rounded-lg border border-dashed border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":"active-agents-empty",children:[o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"No agents are currently active"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mt-1",children:d?.isRunning?"The daemon is running and will start agents when tasks are available.":"Start the daemon or launch agents manually from the Agents page."})]}):o.jsx("div",{className:"grid gap-3 grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3","data-testid":"active-agents-dashboard",children:S.map(({agent:N,session:k,task:j})=>{const E=u.get(N.id),T=v[k.id];let O;return E&&T?.content?O=new Date(E.timestamp)>=new Date(T.timestamp)?E:{content:T.content,timestamp:T.timestamp,eventType:T.type}:E?O=E:T?.content&&(O={content:T.content,timestamp:T.timestamp,eventType:T.type}),o.jsx(RXe,{agent:N,session:k,currentTask:j,lastOutput:O,onOpenTerminal:k.agentRole==="director"?()=>t():()=>e(N.id),onStop:_,isStopping:f.has(N.id)},k.id)})})}function HXe(){const{data:e}=b2({status:"running"}),{inProgress:t,awaitingMerge:r,closed:n}=g1(),{data:a}=v1(),s=e?.sessions?.length??0;return o.jsxs("div",{className:"flex items-center gap-3 flex-wrap","data-testid":"system-status-bar",children:[o.jsx(zS,{icon:o.jsx(ds,{className:"w-3.5 h-3.5"}),label:"Active Agents",value:s,color:s>0?"primary":"muted"}),o.jsx(zS,{icon:o.jsx(Hh,{className:"w-3.5 h-3.5"}),label:"In Progress",value:t.length,color:t.length>0?"warning":"muted"}),o.jsx(zS,{icon:o.jsx(Awe,{className:"w-3.5 h-3.5"}),label:"In Review",value:r.length,color:r.length>0?"info":"muted"}),o.jsx(zS,{icon:o.jsx(zs,{className:"w-3.5 h-3.5"}),label:"Completed",value:n.length,color:"muted"}),o.jsxs("div",{className:"ml-auto flex items-center gap-1.5 text-xs",children:[o.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${a?.isRunning?"bg-[var(--color-success)] animate-pulse":"bg-[var(--color-error)]"}`}),o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:a?.isRunning?"Daemon Running":"Daemon Stopped"})]})]})}function zS({icon:e,label:t,value:r,color:n}){const a={primary:"text-[var(--color-primary)] bg-[var(--color-primary-muted)]",warning:"text-[var(--color-warning)] bg-[var(--color-warning-muted)]",info:"text-[var(--color-info)] bg-[var(--color-info-muted)]",muted:"text-[var(--color-text-secondary)] bg-[var(--color-surface)]"};return o.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border border-[var(--color-border)] ${a[n]}`,children:[e,o.jsx("span",{children:r}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:t})]})}const qXe=8,WXe=1440*60*1e3;function KXe(e){const t=e.metadata?.orchestrator;if(!t?.mergeStatus)return null;switch(t.mergeStatus){case"merged":return{label:"Merged",color:"text-[var(--color-success)] bg-[var(--color-success-muted)]"};case"pending":return{label:"Pending merge",color:"text-[var(--color-warning)] bg-[var(--color-warning-muted)]"};case"conflict":return{label:"Conflict",color:"text-[var(--color-error)] bg-[var(--color-error-muted)]"};default:return{label:t.mergeStatus,color:"text-[var(--color-text-secondary)] bg-[var(--color-surface)]"}}}function GXe(){const{closed:e}=g1(),{allAgents:t}=g0(),r=Date.now(),n=e.filter(s=>{const i=s.closedAt?new Date(s.closedAt).getTime():0;return r-i<WXe}).sort((s,i)=>{const l=s.closedAt?new Date(s.closedAt).getTime():0;return(i.closedAt?new Date(i.closedAt).getTime():0)-l}).slice(0,qXe),a=new Map(t.map(s=>[s.id,s.name]));return n.length===0?null:o.jsxs("div",{"data-testid":"recent-completions",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] flex items-center gap-1.5",children:[o.jsx(Rr,{className:"w-3.5 h-3.5"}),"Recent Completions"]}),o.jsxs("a",{href:"/tasks?status=closed",className:"text-xs text-[var(--color-primary)] hover:underline flex items-center gap-1",children:["View all",o.jsx(qh,{className:"w-3 h-3"})]})]}),o.jsx("div",{className:"space-y-1",children:n.map(s=>{const i=s.assignee?a.get(s.assignee):void 0,l=KXe(s),c=s.closedAt||s.updatedAt;return o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md hover:bg-[var(--color-surface-hover)] transition-colors duration-150 text-xs",children:[l?.label==="Merged"?o.jsx(Ps,{className:"w-3.5 h-3.5 text-[var(--color-success)] flex-shrink-0"}):o.jsx(zs,{className:"w-3.5 h-3.5 text-[var(--color-success)] flex-shrink-0"}),o.jsx("span",{className:"font-medium text-[var(--color-text)] flex-shrink-0",children:s.externalRef||s.id}),o.jsx("span",{className:"text-[var(--color-text-secondary)] truncate flex-1",children:s.title}),i&&o.jsx("span",{className:"text-[var(--color-text-tertiary)] flex-shrink-0",children:i}),o.jsx("span",{className:"text-[var(--color-text-tertiary)] flex-shrink-0",children:OB(c)}),l&&o.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-medium flex-shrink-0 ${l.color}`,children:l.label})]},s.id)})})]})}const VXe=[{value:"all",label:"All"},{value:"tasks",label:"Tasks"},{value:"agents",label:"Agents"},{value:"workflows",label:"Workflows"}];function YXe(){const[e,t]=w.useState(!1),[r,n]=w.useState("all"),{data:a,isLoading:s,fetchNextPage:i,hasNextPage:l,isFetchingNextPage:c}=NJe({category:r,limit:20}),{sessionEvents:u,clearSessionEvents:d}=LB(r),f=w.useMemo(()=>a?.pages?a.pages.flatMap(b=>b.events):[],[a]),m=w.useCallback(()=>{l&&!c&&i()},[l,c,i]),p=b=>{console.log("Open in workspace:",b.elementId)},v=b=>{console.log("Open session in workspace:",b)};return o.jsxs("div",{"data-testid":"activity-feed-section",children:[o.jsxs("button",{onClick:()=>t(b=>!b),className:"flex items-center gap-2 w-full text-left text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] py-2 transition-colors duration-150","data-testid":"activity-feed-toggle",children:[o.jsx(gn,{className:`w-4 h-4 transition-transform duration-150 ${e?"rotate-90":""}`}),"Activity Feed",(u.length>0||f.length>0)&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:["(",u.length+f.length," events)"]})]}),e&&o.jsxs("div",{className:"space-y-4 mt-2",children:[o.jsxs("div",{className:"flex items-center gap-1 p-1 bg-[var(--color-surface)] rounded-lg border border-[var(--color-border)]",children:[o.jsx(ru,{className:"w-4 h-4 text-[var(--color-text-tertiary)] ml-2 mr-1"}),VXe.map(b=>o.jsx("button",{onClick:()=>n(b.value),"data-testid":`activity-filter-${b.value}`,className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors duration-150 ${r===b.value?"bg-[var(--color-primary)] text-white":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}`,children:b.label},b.value))]}),u.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Live Activity"}),o.jsx("button",{onClick:d,className:"text-xs text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]",children:"Clear"})]}),o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:u.slice(0,5).map((b,y)=>o.jsx(IXe,{event:b,onOpenInWorkspace:v},`${b.sessionId}-${y}`))})]}),o.jsx(DXe,{events:f,isLoading:s||c,hasMore:l,onLoadMore:m,onOpenInWorkspace:p,emptyMessage:r==="all"?"No activity yet. Activity will appear here when agents start working on tasks.":`No ${r} activity to show.`})]})]})}function QXe(){const e=Ma(),{isConnected:t}=LB("all"),{data:r}=v1(),n=p1(),a=w.useCallback(()=>{window.location.reload()},[]);x6e(zl("action.refreshActivity"),a,"Refresh Activity");const s=w.useCallback(c=>{e({to:"/workspaces",search:{layout:"single",agent:c,resumeSessionId:void 0,resumePrompt:void 0}})},[e]),i=w.useCallback(()=>{window.dispatchEvent(new CustomEvent("open-director-panel"))},[]),l=w.useCallback(async c=>{await n.mutateAsync({agentId:c,graceful:!0})},[n]);return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"activity-page",children:[o.jsxs("div",{className:"flex flex-col gap-3 @sm:flex-row @sm:items-center @sm:justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Hh,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Activity"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Command center for agent orchestration"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium ${t?"bg-[var(--color-success-muted)] text-[var(--color-success)]":"bg-[var(--color-error-muted)] text-[var(--color-error)]"}`,"data-testid":"activity-connection-status",children:t?o.jsxs(o.Fragment,{children:[o.jsx(r0,{className:"w-3 h-3"}),"Live"]}):o.jsxs(o.Fragment,{children:[o.jsx(Dwe,{className:"w-3 h-3"}),"Offline"]})}),o.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium ${r?.isRunning?"bg-[var(--color-success-muted)] text-[var(--color-success)]":"bg-[var(--color-surface)] text-[var(--color-text-tertiary)]"}`,children:[o.jsx("span",{className:`inline-block w-1.5 h-1.5 rounded-full ${r?.isRunning?"bg-[var(--color-success)]":"bg-[var(--color-text-tertiary)]"}`}),"Daemon"]}),o.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-[var(--color-text-secondary)] rounded-md border border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":"activity-refresh",children:[o.jsx(jr,{className:"w-4 h-4"}),"Refresh",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)] px-1 py-0.5 rounded border border-[var(--color-border)]",children:nm(zl("action.refreshActivity"))})]})]})]}),o.jsx(HXe,{}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] mb-3",children:"Active Agents"}),o.jsx(UXe,{onOpenTerminal:s,onOpenDirectorPanel:i,onStopAgent:l})]}),o.jsx(GXe,{}),o.jsx(YXe,{})]})}function JXe({task:e,onDeleted:t}){const[r,n]=w.useState(!1),[a,s]=w.useState(!1),[i,l]=w.useState(null),c=w.useRef(null),u=w.useRef(null),d=Cme();w.useEffect(()=>{function v(b){c.current&&!c.current.contains(b.target)&&n(!1)}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]),w.useEffect(()=>{if(!a)return;const v=b=>{b.key==="Escape"&&s(!1)};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[a]);const f=v=>{v.stopPropagation(),n(!1),s(!0)},m=async v=>{v.stopPropagation();try{await d.mutateAsync({taskId:e.id}),s(!1),t?.()}catch(b){console.error("Failed to delete task:",b)}},p=v=>{v.stopPropagation(),s(!1)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",ref:c,children:[o.jsx("button",{ref:u,onClick:v=>{if(v.stopPropagation(),!r&&u.current){const b=u.current.getBoundingClientRect();l({top:b.bottom,left:b.right})}n(!r)},className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-elevated)] rounded transition-colors","data-testid":"task-row-menu","aria-label":"Task actions",children:o.jsx(rse,{className:"w-4 h-4"})}),r&&i&&o.jsx("div",{className:"fixed z-30 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-36",style:{top:i.top,left:i.left,transform:"translateX(-100%)"},"data-testid":"task-actions-menu",children:o.jsxs("button",{onClick:f,className:"w-full text-left px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2 transition-colors","data-testid":"task-action-delete",children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})})]}),a&&o.jsxs("div",{className:"fixed inset-0 z-50",onClick:p,"data-testid":"delete-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm",onClick:v=>v.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Task"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsx("div",{className:"px-5 py-4",children:o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-md border border-[var(--color-border)]",children:[o.jsx("p",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.title,children:e.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono mt-1",children:e.id})]})}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:p,disabled:d.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"delete-cancel",children:"Cancel"}),o.jsxs("button",{onClick:m,disabled:d.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"delete-confirm",children:[d.isPending&&o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Delete"]})]})]})})]})]})}function ZXe({task:e,assigneeName:t,onStart:r,onComplete:n,onReopen:a,onClick:s,isStarting:i,isCompleting:l,isReopening:c,highlightedTitle:u,isSelected:d,onToggleSelect:f}){const m=e.metadata?.orchestrator,p=e.status==="open"&&e.assignee,v=e.status==="in_progress",b=e.status==="closed";return o.jsxs("tr",{className:"border-b border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] cursor-pointer transition-colors",onClick:s,"data-testid":`task-row-${e.id}`,children:[f&&o.jsx("td",{className:"pl-4 pr-1 py-3 w-10",children:o.jsx("input",{type:"checkbox",checked:d??!1,onChange:y=>{y.stopPropagation(),f(e.id)},onClick:y=>y.stopPropagation(),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)] cursor-pointer","data-testid":`task-row-checkbox-${e.id}`,"aria-label":`Select task ${e.title}`})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:o.jsxs("div",{className:"flex flex-col gap-0.5 min-w-0",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.title,children:u??e.title}),o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)] font-mono truncate",children:e.id})]})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:o.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[o.jsx(Vp,{status:e.status,mergeStatus:m?.mergeStatus}),e.status==="review"&&(m?.mergeStatus==="testing"||m?.mergeStatus==="merging")&&o.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-blue-600 dark:text-blue-400",title:"Steward reviewing",children:[o.jsx(Vr,{className:"w-3.5 h-3.5 animate-pulse"}),"Reviewing"]}),e.status==="closed"&&m?.mergeStatus==="merged"&&o.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-green-600 dark:text-green-400",children:[o.jsx(Ps,{className:"w-3.5 h-3.5"}),"Merged"]}),e.status==="closed"&&m?.mergeStatus&&m.mergeStatus!=="merged"&&o.jsx("span",{className:"inline-flex items-center text-orange-500 dark:text-orange-400",title:"Closed but not merged",children:o.jsx(Bn,{className:"w-3.5 h-3.5"})})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(Yp,{priority:e.priority,showIcon:!1})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx(J6,{taskType:e.taskType})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:e.assignee?o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] min-w-0",children:[o.jsx(tn,{className:"w-4 h-4 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:t||e.assignee})]}):o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"Unassigned"})}),o.jsx("td",{className:"px-4 py-3 overflow-hidden",children:m?.branch?o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-secondary)] min-w-0",children:[o.jsx(cu,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{className:"truncate font-mono",title:m.branch,children:m.branch.split("/").pop()})]}):o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"-"})}),o.jsx("td",{className:"px-4 py-3 text-xs text-[var(--color-text-tertiary)]",children:XXe(e.updatedAt)}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[p&&r&&o.jsx("button",{onClick:y=>{y.stopPropagation(),r()},disabled:i,className:"p-1.5 text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded disabled:opacity-50 transition-colors",title:"Start task","data-testid":"task-row-start",children:o.jsx(Yr,{className:"w-4 h-4"})}),v&&n&&o.jsx("button",{onClick:y=>{y.stopPropagation(),n()},disabled:l,className:"p-1.5 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded disabled:opacity-50 transition-colors",title:"Complete task","data-testid":"task-row-complete",children:o.jsx(Yn,{className:"w-4 h-4"})}),b&&a&&o.jsx("button",{onClick:y=>{y.stopPropagation(),a()},disabled:c,className:"p-1.5 text-amber-600 hover:bg-amber-100 dark:hover:bg-amber-900/30 rounded disabled:opacity-50 transition-colors",title:"Reopen task","data-testid":"task-row-reopen",children:o.jsx(Ri,{className:"w-4 h-4"})}),o.jsx(JXe,{task:e})]})})]})}function XXe(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/(1e3*60*60*24));if(a===0){const s=Math.floor(n/36e5);if(s===0){const i=Math.floor(n/6e4);return i<=1?"Just now":`${i}m ago`}return`${s}h ago`}return a===1?"Yesterday":a<7?`${a}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}function eet({taskId:e,onNavigateToTask:t}){const{data:r,isLoading:n,error:a}=wJe(e),[s,i]=w.useState(!0),[l,c]=w.useState(!0),[u,d]=w.useState(!1),f=SJe(),m=kJe(),p=r?.blockedBy??[],v=r?.blocks??[],b=r?.progress??{resolved:0,total:0},y=p.length===0&&v.length===0,S=k=>{f.mutate({taskId:e,blockerId:k},{onSuccess:()=>d(!1)})},_=k=>{m.mutate({taskId:e,blockerId:k})},N=p.map(k=>k.task.id);return n?o.jsx("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Loading dependencies..."]})}):a?o.jsx("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:o.jsxs("div",{className:"text-sm text-[var(--color-danger)]",children:["Failed to load dependencies: ",a.message]})}):o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]","data-testid":"dependencies-section",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:[o.jsx(Ix,{className:"w-3 h-3"}),"Dependencies"]}),b.total>0&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:[b.resolved,"/",b.total," resolved"]})]}),y&&o.jsx("div",{className:"text-sm text-[var(--color-text-tertiary)] mb-3","data-testid":"dependencies-empty",children:"No dependencies"}),p.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("button",{onClick:()=>i(!s),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] mb-2 hover:text-[var(--color-text)]","data-testid":"blocked-by-toggle",children:[s?o.jsx(Yt,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),"Blocked By (",b.resolved,"/",b.total," resolved)"]}),s&&o.jsx("div",{className:"space-y-2","data-testid":"blocked-by-list",children:p.map(k=>o.jsx(AX,{dependency:k,onClick:t?()=>t(k.task.id):void 0,onRemove:()=>_(k.task.id),isRemoving:m.isPending&&m.variables?.blockerId===k.task.id},k.task.id))})]}),o.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors w-full mb-4","data-testid":"add-blocker-btn",children:[o.jsx(dr,{className:"w-4 h-4"}),"Add Blocker"]}),v.length>0&&o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>c(!l),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] mb-2 hover:text-[var(--color-text)]","data-testid":"blocks-toggle",children:[l?o.jsx(Yt,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),"Blocks (",v.length,")"]}),l&&o.jsx("div",{className:"space-y-2","data-testid":"blocks-list",children:v.map(k=>o.jsx(AX,{dependency:k,onClick:t?()=>t(k.task.id):void 0},k.task.id))})]}),o.jsx(tet,{isOpen:u,onClose:()=>d(!1),onSelect:S,excludeTaskIds:[e,...N],isAdding:f.isPending})]})}function AX({dependency:e,onClick:t,onRemove:r,isRemoving:n}){const{task:a}=e,s=a.status==="closed",i=!!t;return o.jsxs("div",{className:`w-full flex items-center gap-3 p-3 rounded-lg border border-[var(--color-border)] group ${s?"opacity-70":""} ${i?"hover:bg-[var(--color-surface-hover)] hover:border-[var(--color-primary)]":""} transition-colors`,"data-testid":`dependency-card-${a.id}`,children:[o.jsx(Zme,{status:a.status}),i?o.jsx("button",{onClick:t,className:`flex-1 text-sm text-[var(--color-text)] truncate text-left hover:text-[var(--color-primary)] ${s?"line-through":""}`,children:a.title}):o.jsx("span",{className:`flex-1 text-sm text-[var(--color-text)] truncate ${s?"line-through":""}`,children:a.title}),o.jsx(Xme,{priority:a.priority}),r&&o.jsx("button",{onClick:l=>{l.stopPropagation(),r()},disabled:n,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-danger-muted)] rounded opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50","aria-label":"Remove blocker","data-testid":`remove-blocker-${a.id}`,children:n?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(yt,{className:"w-4 h-4"})}),i&&!r&&o.jsx(qh,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]})}function tet({isOpen:e,onClose:t,onSelect:r,excludeTaskIds:n,isAdding:a}){const[s,i]=w.useState(""),{data:l,isLoading:c}=S2(),u=w.useRef(null);if(w.useEffect(()=>{e&&u.current&&u.current.focus()},[e]),w.useEffect(()=>{if(e){const f=m=>{m.key==="Escape"&&!a&&t()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)}},[e,a,t]),w.useEffect(()=>{e&&i("")},[e]),!e)return null;const d=(l?.tasks??[]).filter(f=>n.includes(f.id)||f.status==="closed"?!1:s?f.title.toLowerCase().includes(s.toLowerCase()):!0);return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"add-blocker-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!a&&t()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col border border-[var(--color-border)]",children:[o.jsxs("div",{className:"p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Add Blocking Task"}),o.jsx("button",{onClick:t,disabled:a,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded","data-testid":"add-blocker-modal-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-3",children:"Select a task that must be completed before this task can proceed."}),o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{ref:u,type:"text",placeholder:"Search tasks...",value:s,onChange:f=>i(f.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]","data-testid":"add-blocker-search"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-text-tertiary)]"})}):d.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-tertiary)]","data-testid":"add-blocker-empty",children:s?"No tasks match your search":"No available tasks to add as blockers"}):o.jsx("div",{className:"space-y-2",children:d.map(f=>o.jsxs("button",{onClick:()=>r(f.id),disabled:a,className:"w-full flex items-center gap-3 p-3 text-left bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors disabled:opacity-50","data-testid":`add-blocker-item-${f.id}`,children:[o.jsx(Zme,{status:f.status}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] truncate",children:f.title}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:f.id})]}),o.jsx(Xme,{priority:f.priority}),a&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-primary)]"})]},f.id))})})]})]})}function Zme({status:e}){switch(e){case"open":return o.jsx(nu,{className:"w-4 h-4 text-blue-500"});case"in_progress":return o.jsx(Lwe,{className:"w-4 h-4 text-yellow-500"});case"blocked":return o.jsx(Bn,{className:"w-4 h-4 text-red-500"});case"review":return o.jsx(du,{className:"w-4 h-4 text-purple-500"});case"closed":return o.jsx(Yn,{className:"w-4 h-4 text-green-500"});case"deferred":return o.jsx(Rr,{className:"w-4 h-4 text-gray-500"});default:return o.jsx(nu,{className:"w-4 h-4 text-gray-400"})}}function Xme({priority:e}){const t=ret(e);return o.jsxs("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded ${t.className}`,title:t.label,children:["P",e]})}function ret(e){switch(e){case 1:return{label:"Critical",className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"};case 2:return{label:"High",className:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"};case 3:return{label:"Medium",className:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"};case 4:return{label:"Low",className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"};case 5:return{label:"Minimal",className:"bg-gray-100 text-gray-600 dark:bg-gray-800/50 dark:text-gray-400"};default:return{label:`P${e}`,className:"bg-gray-100 text-gray-600 dark:bg-gray-800/50 dark:text-gray-400"}}}const b0=new sx({headingStyle:"atx",codeBlockStyle:"fenced",bulletListMarker:"-",emDelimiter:"_",strongDelimiter:"**"});b0.addRule("highlight",{filter:"mark",replacement:function(e){return"=="+e+"=="}});b0.addRule("strikethrough",{filter:function(e){return e.nodeName==="S"||e.nodeName==="DEL"},replacement:function(e){return"~~"+e+"~~"}});b0.addRule("taskEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="taskEmbed"},replacement:function(e,t){const r=t.getAttribute("data-task-id");return r?`![[task:${r}]]`:""}});b0.addRule("documentEmbed",{filter:function(e){return e.nodeName==="DIV"&&e.hasAttribute("data-type")&&e.getAttribute("data-type")==="documentEmbed"},replacement:function(e,t){const r=t.getAttribute("data-document-id");return r?`![[doc:${r}]]`:""}});b0.addRule("mention",{filter:function(e){return e.nodeName==="A"&&e.hasAttribute("data-mention-id")},replacement:function(e,t){const r=t.getAttribute("data-mention-name");return r?`@${r}`:""}});b0.addRule("textAlign",{filter:function(e){if(!["P","H1","H2","H3","H4","H5","H6"].includes(e.nodeName))return!1;const t=e.getAttribute("style")||"";return/text-align:\s*(center|right|justify)/i.test(t)},replacement:function(e,t){const n=(t.getAttribute("style")||"").match(/text-align:\s*(center|right|justify)/i);if(!n)return e;const a=n[1].toLowerCase(),s=t.nodeName.toLowerCase();return s.startsWith("h")?`<${s} style="text-align: ${a}">${e}</${s}>

`:`<p style="text-align: ${a}">${e}</p>

`}});Ar.setOptions({gfm:!0,breaks:!0});function epe(e){if(!e)return"<p></p>";let t=e;return t=t.replace(/!\[\[task:([\w-]+)\]\]/g,'<div data-type="taskEmbed" data-task-id="$1"></div>'),t=t.replace(/!\[\[doc:([\w-]+)\]\]/g,'<div data-type="documentEmbed" data-document-id="$1"></div>'),t=t.replace(/==([^=]+)==/g,"<mark>$1</mark>"),t=t.replace(/~~([^~]+)~~/g,"<s>$1</s>"),Ar.parse(t,{async:!1})}function C2({content:e,className:t="","data-testid":r}){const n=w.useMemo(()=>e?epe(e):"",[e]);return e?o.jsx("div",{className:`markdown-content ${t}`,"data-testid":r,dangerouslySetInnerHTML:{__html:n}}):null}function tpe(e){return{id:e.id,type:e.type,timestamp:typeof e.createdAt=="number"?e.createdAt:Date.parse(e.createdAt),content:e.content,toolName:e.toolName,toolInput:e.toolInput?JSON.parse(e.toolInput):void 0,toolOutput:e.toolOutput,isError:e.isError}}function rpe({events:e}){return e.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-[var(--color-text-muted)] p-6",children:[o.jsx(oi,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No transcript available for this session"})]}):o.jsx("div",{className:"p-3 space-y-2 overflow-y-auto h-full",children:e.map(t=>o.jsx(net,{event:t},t.id))})}function net({event:e}){const t={assistant:{bg:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-700 dark:text-blue-300"},user:{bg:"bg-purple-50 dark:bg-purple-900/20",text:"text-purple-700 dark:text-purple-300"},tool_use:{bg:"bg-amber-50 dark:bg-amber-900/20",text:"text-amber-700 dark:text-amber-300"},tool_result:{bg:"bg-green-50 dark:bg-green-900/20",text:"text-green-700 dark:text-green-300"},system:{bg:"bg-gray-50 dark:bg-gray-800/50",text:"text-gray-600 dark:text-gray-400"},error:{bg:"bg-red-50 dark:bg-red-900/20",text:"text-red-700 dark:text-red-300"}},r=t[e.type]||t.system,n=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return o.jsxs("div",{className:`rounded-md border overflow-hidden ${r.bg} border-[var(--color-border)]/30`,children:[o.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 ${r.text}`,children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",children:e.type.replace("_"," ")}),e.toolName&&o.jsx("span",{className:"text-xs font-mono opacity-75",children:e.toolName}),o.jsx("span",{className:"ml-auto text-xs opacity-50",children:n})]}),e.content&&o.jsx("div",{className:"px-3 py-2 border-t border-[var(--color-border)]/30",children:e.type==="assistant"||e.type==="user"?o.jsx(C2,{content:e.content,className:"text-sm text-[var(--color-text)]"}):o.jsx("div",{className:"text-sm whitespace-pre-wrap break-words text-[var(--color-text)]",children:e.content})})]})}const aet=[{value:1,label:"Critical"},{value:2,label:"High"},{value:3,label:"Medium"},{value:4,label:"Low"},{value:5,label:"Minimal"}],set=[{value:"backlog",label:"Backlog"},{value:"open",label:"Open"},{value:"in_progress",label:"In Progress"},{value:"blocked",label:"Blocked"},{value:"review",label:"Review"},{value:"deferred",label:"Deferred"},{value:"closed",label:"Closed"}],DX=[{value:1,label:"Trivial"},{value:2,label:"Simple"},{value:3,label:"Moderate"},{value:4,label:"Complex"},{value:5,label:"Very Complex"}];function iet({taskId:e,onClose:t,onNavigateToTask:r}){const{data:n,isLoading:a,error:s}=fJe(e),{data:i}=m1("worker"),{data:l}=pme(),{data:c}=k2(),u=Sme(),d=Cme(),f=kme(),m=_me(),p=Nme(),v=hJe(),b=mJe(),[y,S]=w.useState(!1),[_,N]=w.useState(!1),[k,j]=w.useState(!1),[E,T]=w.useState(null),O=n?.task,R=i?.agents??[],H=l?.items??[],$=new Map;c&&c.forEach(V=>$.set(V.id,V.name));const L=O?.metadata?.orchestrator,A=O?.description,M=O?.status==="open"&&O?.assignee,P=O?.status==="in_progress",I=O?.status==="closed",B=O?.assignee||O?.status==="in_progress"||O?.status==="review"||O?.status==="closed",F=async V=>{if(O)try{await u.mutateAsync({taskId:O.id,...V}),T(null)}catch{}},q=async V=>{if(O)try{await b.mutateAsync({taskId:O.id,mergeStatus:V})}catch{}},Q=async()=>{if(O)try{await d.mutateAsync({taskId:O.id}),t()}catch{}},W=async()=>{O&&await f.mutateAsync({taskId:O.id})},G=async()=>{O&&await m.mutateAsync({taskId:O.id})},J=async V=>{O&&(await p.mutateAsync({taskId:O.id,message:V||void 0}),N(!1))},X=async()=>{O&&(await v.mutateAsync({taskId:O.id}),j(!1))};return a?o.jsx("div",{className:"h-full flex items-center justify-center bg-[var(--color-surface)]","data-testid":"task-detail-loading",children:o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading task..."})]})}):s||!O?o.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-[var(--color-surface)]","data-testid":"task-detail-error",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:s?.message||"Task not found"}),o.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 text-sm text-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] rounded-md",children:"Close"})]}):o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-surface)]","data-testid":"task-detail-panel",children:[y&&o.jsx(xet,{taskTitle:O.title,onConfirm:Q,onCancel:()=>S(!1),isDeleting:d.isPending}),_&&o.jsx(npe,{taskTitle:O.title,onConfirm:J,onCancel:()=>N(!1),isReopening:p.isPending}),k&&o.jsx(wet,{taskTitle:O.title,onConfirm:X,onCancel:()=>j(!1),isResetting:v.isPending}),o.jsxs("div",{className:"flex items-start justify-between p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(Vp,{status:O.status,mergeStatus:L?.mergeStatus}),O.status==="review"&&(L?.mergeStatus==="testing"||L?.mergeStatus==="merging")&&o.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-blue-600 dark:text-blue-400",title:"Steward reviewing",children:[o.jsx(Vr,{className:"w-3.5 h-3.5 animate-pulse"}),"Reviewing"]}),o.jsx(Yp,{priority:O.priority}),o.jsx(J6,{taskType:O.taskType})]}),o.jsx(cet,{value:O.title,onSave:V=>F({title:V}),isUpdating:u.isPending&&E==="title",onEdit:()=>T("title")}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-[var(--color-text-tertiary)] font-mono",children:[o.jsx("span",{"data-testid":"task-detail-id",children:O.id}),O.ephemeral&&o.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 rounded text-[10px]",children:"Ephemeral"})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[B&&o.jsx("button",{onClick:()=>j(!0),className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-amber-600 hover:bg-amber-100 dark:hover:text-amber-400 dark:hover:bg-amber-900/30 rounded transition-colors","aria-label":"Reset task",title:"Reset task to open, clearing assignee and work data","data-testid":"task-reset-btn",children:o.jsx(LO,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>S(!0),className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-danger-muted)] rounded transition-colors","aria-label":"Delete task","data-testid":"task-delete-btn",children:o.jsx(pr,{className:"w-5 h-5"})}),o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Close panel","data-testid":"task-detail-close",children:o.jsx(yt,{className:"w-5 h-5"})})]})]}),(M||P||I)&&o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface-elevated)]",children:[M&&o.jsxs("button",{onClick:W,disabled:f.isPending,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-primary-muted)] hover:bg-[var(--color-primary-muted)]/80 rounded-md disabled:opacity-50 transition-colors","data-testid":"task-start-btn",children:[o.jsx(Yr,{className:"w-4 h-4"}),f.isPending?"Starting...":"Start Task"]}),P&&o.jsxs("button",{onClick:G,disabled:m.isPending,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-green-700 bg-green-100 hover:bg-green-200 dark:text-green-300 dark:bg-green-900/30 dark:hover:bg-green-900/50 rounded-md disabled:opacity-50 transition-colors","data-testid":"task-complete-btn",children:[o.jsx(Yn,{className:"w-4 h-4"}),m.isPending?"Completing...":"Complete Task"]}),I&&o.jsxs("button",{onClick:()=>N(!0),disabled:p.isPending,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-amber-700 bg-amber-100 hover:bg-amber-200 dark:text-amber-300 dark:bg-amber-900/30 dark:hover:bg-amber-900/50 rounded-md disabled:opacity-50 transition-colors","data-testid":"task-reopen-btn",children:[o.jsx(Ri,{className:"w-4 h-4"}),p.isPending?"Reopening...":"Reopen Task"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[o.jsx($v,{label:"Status",icon:o.jsx(Yn,{className:"w-3 h-3"}),children:o.jsx(det,{value:O.status,onSave:V=>F({status:V}),isUpdating:u.isPending&&E==="status"})}),o.jsx($v,{label:"Priority",children:o.jsx(fet,{value:O.priority,onSave:V=>F({priority:V}),isUpdating:u.isPending&&E==="priority"})}),o.jsx($v,{label:"Assigned To",icon:o.jsx(tn,{className:"w-3 h-3"}),children:o.jsx(het,{value:O.assignee,entityNameMap:$,workers:R,operators:H,onSave:V=>F({assignee:V??null}),isUpdating:u.isPending&&E==="assignee"})}),o.jsx($v,{label:"Complexity",children:o.jsx(met,{value:O.complexity,onSave:V=>F({complexity:V}),isUpdating:u.isPending&&E==="complexity"})}),o.jsx($v,{label:"Deadline",icon:o.jsx(Bx,{className:"w-3 h-3"}),children:o.jsx(vet,{value:O.deadline,onSave:V=>F({deadline:V??null}),isUpdating:u.isPending&&E==="deadline"})})]}),o.jsx(bet,{tags:O.tags,onSave:V=>F({tags:V}),isUpdating:u.isPending&&E==="tags",onEdit:()=>T("tags")}),o.jsx(yet,{value:A,onSave:V=>F({description:V??null}),isUpdating:u.isPending&&E==="description",onEdit:()=>T("description")}),o.jsx(ket,{taskId:O.id}),o.jsx(eet,{taskId:O.id,onNavigateToTask:r}),L?.sessionHistory&&L.sessionHistory.length>0&&o.jsx(Eet,{sessionHistory:L.sessionHistory,entityNameMap:$}),L&&o.jsx(oet,{meta:L,onUpdateMergeStatus:q,isUpdatingMergeStatus:b.isPending}),o.jsx("div",{className:"mt-6 pt-4 border-t border-[var(--color-border)]",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-[var(--color-text-tertiary)]",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Created:"})," ",o.jsx("span",{title:dh(O.createdAt),children:jl(O.createdAt)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Updated:"})," ",o.jsx("span",{title:dh(O.updatedAt),children:jl(O.updatedAt)})]}),O.closedAt&&o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"Closed:"})," ",o.jsx("span",{title:dh(O.closedAt),children:jl(O.closedAt)})]})]})}),u.isError&&o.jsxs("div",{className:"mt-4 p-3 bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-lg text-sm text-[var(--color-danger)]",children:["Failed to update: ",u.error?.message]})]})]})}function oet({meta:e,onUpdateMergeStatus:t,isUpdatingMergeStatus:r}){return e?o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Orchestrator Info"}),o.jsxs("div",{className:"space-y-3",children:[e.branch&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(cu,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"font-mono text-[var(--color-text)]",children:e.branch})]}),e.mergeStatus&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Ps,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),t?o.jsx(get,{value:e.mergeStatus,onSave:t,isUpdating:r??!1}):o.jsx(Qp,{status:e.mergeStatus}),e.mergeFailureReason&&o.jsx("span",{className:"text-xs text-[var(--color-danger)]",children:e.mergeFailureReason})]}),e.lastTestResult&&o.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[o.jsx(U6,{className:"w-4 h-4 text-[var(--color-text-tertiary)] mt-0.5"}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:`font-medium ${e.lastTestResult.passed?"text-green-600 dark:text-green-400":"text-[var(--color-danger)]"}`,children:["Tests: ",e.lastTestResult.passed?"Passed":"Failed"]}),e.testRunCount&&e.testRunCount>1&&o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:["(Run #",e.testRunCount,")"]})]}),e.lastTestResult.totalTests!==void 0&&o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[e.lastTestResult.passedTests??0,"/",e.lastTestResult.totalTests," passed",e.lastTestResult.failedTests?`, ${e.lastTestResult.failedTests} failed`:"",e.lastTestResult.skippedTests?`, ${e.lastTestResult.skippedTests} skipped`:""]}),e.lastTestResult.errorMessage&&o.jsx("div",{className:"mt-1 text-xs text-[var(--color-danger)] font-mono",children:e.lastTestResult.errorMessage})]})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)] pt-2 border-t border-[var(--color-border)]",children:[e.startedAt&&o.jsxs("div",{children:["Started: ",jl(e.startedAt)]}),e.completedAt&&o.jsxs("div",{children:["Completed: ",jl(e.completedAt)]}),e.mergedAt&&o.jsxs("div",{children:["Merged: ",jl(e.mergedAt)]})]})]})]}):null}function $v({label:e,icon:t,children:r}){return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-1",children:[t,e]}),r]})}function cet({value:e,onSave:t,isUpdating:r,onEdit:n}){const[a,s]=w.useState(!1),[i,l]=w.useState(e),c=w.useRef(null);w.useEffect(()=>{a&&c.current&&(c.current.focus(),c.current.select())},[a]),w.useEffect(()=>{l(e)},[e]);const u=()=>{i.trim()&&i!==e&&(n(),t(i.trim())),s(!1)},d=f=>{f.key==="Enter"?u():f.key==="Escape"&&(l(e),s(!1))};return a?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{ref:c,type:"text",value:i,onChange:f=>l(f.target.value),onBlur:u,onKeyDown:d,className:"flex-1 text-lg font-semibold text-[var(--color-text)] border border-[var(--color-primary)] rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)]","data-testid":"task-title-input"}),r&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]}):o.jsxs("div",{className:"flex items-center gap-2 group",children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)] cursor-pointer hover:text-[var(--color-primary)] transition-colors",onClick:()=>s(!0),"data-testid":"task-detail-title",children:e}),o.jsx("button",{onClick:()=>s(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit title",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})}),r&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]})}const uet={backlog:["open","deferred","closed"],open:["in_progress","blocked","deferred","backlog","closed"],in_progress:["open","blocked","deferred","review","closed"],blocked:["open","in_progress","deferred","closed"],deferred:["open","in_progress","backlog"],review:["closed","in_progress"],closed:["open"],tombstone:[]};function det({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),s=w.useRef(null),i=uet[e]||[],l=set.filter(c=>c.value===e||i.includes(c.value));return w.useEffect(()=>{function c(u){s.current&&!s.current.contains(u.target)&&a(!1)}return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),o.jsxs("div",{className:"relative",ref:s,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 hover:ring-2 hover:ring-[var(--color-primary)] rounded transition-all",disabled:r,"data-testid":"task-status-dropdown",children:[o.jsx(Vp,{status:e}),r&&o.jsx(Pe,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[140px]",children:l.map(c=>o.jsxs("button",{onClick:()=>{c.value!==e&&t(c.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${c.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Vp,{status:c.value}),c.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},c.value))})]})}function fet({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),s=w.useRef(null);return w.useEffect(()=>{function i(l){s.current&&!s.current.contains(l.target)&&a(!1)}return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]),o.jsxs("div",{className:"relative",ref:s,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 hover:ring-2 hover:ring-[var(--color-primary)] rounded transition-all",disabled:r,"data-testid":"task-priority-dropdown",children:[o.jsx(Yp,{priority:e}),r&&o.jsx(Pe,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[120px]",children:aet.map(i=>o.jsxs("button",{onClick:()=>{i.value!==e&&t(i.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${i.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Yp,{priority:i.value,showIcon:!1}),i.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},i.value))})]})}function het({value:e,entityNameMap:t,workers:r,operators:n,onSave:a,isUpdating:s}){const[i,l]=w.useState(!1),c=w.useRef(null),u=e?t.get(e):void 0,d=e?n.some(f=>f.id===e):!1;return w.useEffect(()=>{function f(m){c.current&&!c.current.contains(m.target)&&l(!1)}return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),o.jsxs("div",{className:"relative",ref:c,children:[o.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 px-2 py-1 text-sm rounded bg-[var(--color-surface-elevated)] hover:ring-2 hover:ring-[var(--color-primary)] transition-all",disabled:s,"data-testid":"task-assignee-dropdown",children:[d?o.jsx(tn,{className:"w-3.5 h-3.5 text-blue-500"}):e?o.jsx(Vr,{className:"w-3.5 h-3.5 text-purple-500"}):o.jsx(tn,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:u?"text-[var(--color-text)]":"text-[var(--color-text-tertiary)] italic",children:u||"Unassigned"}),s&&o.jsx(Pe,{className:"w-3 h-3 animate-spin"})]}),i&&o.jsxs("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[180px] max-h-[280px] overflow-y-auto",children:[o.jsxs("button",{onClick:()=>{e&&a(null),l(!1)},className:`w-full text-left px-3 py-2 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${e?"":"bg-[var(--color-surface-elevated)]"}`,children:[o.jsx(tn,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"text-[var(--color-text-tertiary)] italic",children:"Unassigned"}),!e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]}),n.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"border-t border-[var(--color-border)] my-1"}),o.jsx("div",{className:"px-3 py-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wider",children:"Operators"}),n.map(f=>o.jsxs("button",{onClick:()=>{f.id!==e&&a(f.id),l(!1)},className:`w-full text-left px-3 py-2 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${f.id===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(tn,{className:"w-3.5 h-3.5 text-blue-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:f.name}),f.id===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},f.id))]}),o.jsx("div",{className:"border-t border-[var(--color-border)] my-1"}),o.jsx("div",{className:"px-3 py-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wider",children:"Worker Agents"}),r.length===0?o.jsx("div",{className:"px-3 py-2 text-xs text-[var(--color-text-tertiary)]",children:"No worker agents available"}):r.map(f=>o.jsxs("button",{onClick:()=>{f.id!==e&&a(f.id),l(!1)},className:`w-full text-left px-3 py-2 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${f.id===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Vr,{className:"w-3.5 h-3.5 text-purple-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:f.name}),f.id===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},f.id))]})]})}function met({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),s=w.useRef(null);w.useEffect(()=>{function l(c){s.current&&!s.current.contains(c.target)&&a(!1)}return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const i=DX.find(l=>l.value===e)?.label??"Unknown";return o.jsxs("div",{className:"relative",ref:s,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 px-2 py-1 text-sm rounded bg-[var(--color-surface-elevated)] hover:ring-2 hover:ring-[var(--color-primary)] transition-all",disabled:r,"data-testid":"task-complexity-dropdown",children:[o.jsx("span",{className:"text-[var(--color-text)]",children:i}),r&&o.jsx(Pe,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[120px]",children:DX.map(l=>o.jsxs("button",{onClick:()=>{l.value!==e&&t(l.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${l.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx("span",{className:"text-[var(--color-text)]",children:l.label}),l.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},l.value))})]})}const pet=[{value:"pending",label:"Pending"},{value:"testing",label:"Testing"},{value:"merging",label:"Merging"},{value:"merged",label:"Merged"},{value:"conflict",label:"Conflict"},{value:"test_failed",label:"Test Failed"},{value:"failed",label:"Failed"},{value:"not_applicable",label:"N/A"}];function get({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),s=w.useRef(null);return w.useEffect(()=>{function i(l){s.current&&!s.current.contains(l.target)&&a(!1)}return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]),o.jsxs("div",{className:"relative",ref:s,children:[o.jsxs("button",{onClick:()=>a(!n),className:"flex items-center gap-1 hover:ring-2 hover:ring-[var(--color-primary)] rounded transition-all",disabled:r,"data-testid":"merge-status-dropdown",children:[o.jsx(Qp,{status:e}),r&&o.jsx(Pe,{className:"w-3 h-3 animate-spin"})]}),n&&o.jsx("div",{className:"absolute z-10 mt-1 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-[140px]",children:pet.map(i=>o.jsxs("button",{onClick:()=>{i.value!==e&&t(i.value),a(!1)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-surface-hover)] flex items-center gap-2 ${i.value===e?"bg-[var(--color-surface-elevated)]":""}`,children:[o.jsx(Qp,{status:i.value}),i.value===e&&o.jsx(Vn,{className:"w-3 h-3 text-[var(--color-primary)] ml-auto"})]},i.value))})]})}function vet({value:e,onSave:t,isUpdating:r}){const[n,a]=w.useState(!1),[s,i]=w.useState(e?e.split("T")[0]:""),l=w.useRef(null);w.useEffect(()=>{n&&l.current&&l.current.focus()},[n]),w.useEffect(()=>{i(e?e.split("T")[0]:"")},[e]);const c=()=>{const f=s?new Date(s).toISOString():null;f!==e&&(f||e)&&t(f),a(!1)},u=f=>{f.key==="Enter"?c():f.key==="Escape"&&(i(e?e.split("T")[0]:""),a(!1))},d=()=>{e&&t(null),a(!1)};return n?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{ref:l,type:"date",value:s,onChange:f=>i(f.target.value),onBlur:c,onKeyDown:u,className:"text-sm text-[var(--color-text)] border border-[var(--color-primary)] rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)]","data-testid":"task-deadline-input"}),e&&o.jsx("button",{onClick:d,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] rounded","aria-label":"Clear deadline",children:o.jsx(yt,{className:"w-4 h-4"})}),r&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]}):o.jsxs("div",{className:"flex items-center gap-2 group",children:[o.jsx("span",{className:`text-sm cursor-pointer hover:text-[var(--color-primary)] transition-colors ${e?"text-[var(--color-text)]":"text-[var(--color-text-tertiary)] italic"}`,onClick:()=>a(!0),"data-testid":"task-deadline-display",children:e?ape(e):"No deadline"}),o.jsx("button",{onClick:()=>a(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit deadline",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})}),r&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"})]})}function bet({tags:e,onSave:t,isUpdating:r,onEdit:n}){const[a,s]=w.useState(!1),[i,l]=w.useState(e),[c,u]=w.useState(""),d=w.useRef(null);w.useEffect(()=>{a&&d.current&&d.current.focus()},[a]),w.useEffect(()=>{l(e)},[e]);const f=()=>{const b=c.trim().toLowerCase();b&&!i.includes(b)&&(l([...i,b]),u(""))},m=b=>{l(i.filter(y=>y!==b))},p=b=>{b.key==="Enter"||b.key===","?(b.preventDefault(),f()):b.key==="Escape"?(l(e),u(""),s(!1)):b.key==="Backspace"&&!c&&i.length>0&&l(i.slice(0,-1))},v=()=>{JSON.stringify(i.sort())!==JSON.stringify([...e].sort())&&(n(),t(i)),s(!1),u("")};return a?o.jsxs("div",{className:"mb-6","data-testid":"tags-editor",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:[o.jsx(Vc,{className:"w-3 h-3"}),"Tags"]}),o.jsx("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:"Enter to add, Esc to cancel"})]}),o.jsxs("div",{className:"p-2 border border-[var(--color-primary)] rounded-lg bg-[var(--color-input-bg)] focus-within:ring-2 focus-within:ring-[var(--color-primary)]",children:[o.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:i.map(b=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300 rounded-full",children:[b,o.jsx("button",{type:"button",onClick:()=>m(b),className:"hover:text-red-600 dark:hover:text-red-400 transition-colors","aria-label":`Remove ${b}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},b))}),o.jsx("input",{ref:d,type:"text",value:c,onChange:b=>u(b.target.value),onKeyDown:p,onBlur:()=>{c.trim()&&f()},placeholder:"Type tag and press Enter...",className:"w-full text-sm bg-transparent text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none","data-testid":"tags-input"})]}),o.jsxs("div",{className:"flex items-center justify-end gap-2 mt-2",children:[r&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"}),o.jsx("button",{onClick:()=>{l(e),u(""),s(!1)},className:"px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded transition-colors",children:"Cancel"}),o.jsx("button",{onClick:v,className:"px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:opacity-90 rounded transition-colors",children:"Save"})]})]}):o.jsxs("div",{className:"mb-6 group","data-testid":"tags-section",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:[o.jsx(Vc,{className:"w-3 h-3"}),"Tags"]}),o.jsx("button",{onClick:()=>s(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit tags",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})})]}),e.length>0?o.jsx("div",{className:"flex flex-wrap gap-1.5 p-2 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)] cursor-pointer hover:border-[var(--color-primary)] transition-colors",onClick:()=>s(!0),children:e.map(b=>o.jsx("span",{className:"px-2.5 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300 rounded-full",children:b},b))}):o.jsx("button",{onClick:()=>s(!0),className:"w-full p-2 text-sm text-[var(--color-text-tertiary)] italic bg-[var(--color-surface-elevated)] rounded-lg border border-dashed border-[var(--color-border)] hover:border-[var(--color-primary)] hover:text-[var(--color-text-secondary)] transition-colors text-left","data-testid":"add-tags-btn",children:"Add tags..."}),r&&o.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),"Saving..."]})]})}function yet({value:e,onSave:t,isUpdating:r,onEdit:n}){const[a,s]=w.useState(!1),[i,l]=w.useState(e??""),c=w.useRef(null),u=w.useRef(0);w.useEffect(()=>{a&&c.current&&(u.current=i.length,c.current.focus(),c.current.setSelectionRange(u.current,u.current))},[a]),w.useEffect(()=>{l(e??"")},[e]);const d=()=>{const m=i.trim();m!==(e??"")&&(n(),t(m||null)),s(!1)},f=m=>{m.key==="Escape"&&(l(e??""),s(!1)),m.key==="Enter"&&(m.ctrlKey||m.metaKey)&&d()};return a?o.jsxs("div",{className:"mb-6","data-testid":"description-editor",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:"Description"}),o.jsx("span",{className:"text-[10px] text-[var(--color-text-tertiary)]",children:"Ctrl+Enter to save, Esc to cancel"})]}),o.jsx("div",{className:"relative",children:o.jsx("textarea",{ref:c,value:i,onChange:m=>l(m.target.value),onKeyDown:f,rows:8,placeholder:"Add a description (supports markdown)...",className:"w-full p-3 text-sm border border-[var(--color-primary)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)] resize-y min-h-[120px]","data-testid":"task-description-input"})}),o.jsxs("div",{className:"flex items-center justify-end gap-2 mt-2",children:[r&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-text-tertiary)]"}),o.jsx("button",{onClick:()=>{l(e??""),s(!1)},className:"px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded transition-colors",children:"Cancel"}),o.jsx("button",{onClick:d,className:"px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:opacity-90 rounded transition-colors",children:"Save"})]})]}):o.jsxs("div",{className:"mb-6 group","data-testid":"description-section",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h3",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide",children:"Description"}),o.jsx("button",{onClick:()=>s(!0),className:"p-1 opacity-0 group-hover:opacity-100 hover:bg-[var(--color-surface-hover)] rounded transition-opacity","aria-label":"Edit description",children:o.jsx(Uh,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"})})]}),e?o.jsx("div",{onClick:()=>s(!0),className:"p-3 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)] cursor-pointer hover:border-[var(--color-primary)] transition-colors",children:o.jsx(C2,{content:e,className:"text-sm text-[var(--color-text)] prose prose-sm dark:prose-invert max-w-none","data-testid":"task-description"})}):o.jsx("button",{onClick:()=>s(!0),className:"w-full p-3 text-sm text-[var(--color-text-tertiary)] italic bg-[var(--color-surface-elevated)] rounded-lg border border-dashed border-[var(--color-border)] hover:border-[var(--color-primary)] hover:text-[var(--color-text-secondary)] transition-colors text-left","data-testid":"add-description-btn",children:"Add a description..."}),r&&o.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),"Saving..."]})]})}function xet({taskTitle:e,onConfirm:t,onCancel:r,isDeleting:n}){return w.useEffect(()=>{const a=s=>{s.key==="Escape"&&!n&&r()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[n,r]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"delete-confirm-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!n&&r()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-[var(--color-danger-muted)] flex items-center justify-center",children:o.jsx(pr,{className:"w-5 h-5 text-[var(--color-danger)]"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Task"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Are you sure you want to delete"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e,'"']}),"? This action cannot be undone."]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"delete-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:t,disabled:n,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 disabled:opacity-50","data-testid":"delete-confirm-btn",children:n?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})})]})]})]})}function npe({taskTitle:e,onConfirm:t,onCancel:r,isReopening:n}){const[a,s]=w.useState(""),i=w.useRef(null);return w.useEffect(()=>{i.current&&i.current.focus()},[]),w.useEffect(()=>{const l=c=>{c.key==="Escape"&&!n&&r()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[n,r]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"reopen-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!n&&r()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:o.jsx(Ri,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Reopen Task"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Reopen ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e,'"']}),"? This will clear the assignee and merge metadata."]})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"Message (optional)"}),o.jsx("textarea",{ref:i,value:a,onChange:l=>s(l.target.value),placeholder:"Why is this task being reopened?",rows:3,className:"w-full p-3 text-sm border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-[var(--color-input-bg)] text-[var(--color-text)] resize-y","data-testid":"reopen-message-input"})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"reopen-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:()=>t(a.trim()||void 0),disabled:n,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-amber-600 rounded-md hover:bg-amber-700 disabled:opacity-50","data-testid":"reopen-confirm-btn",children:n?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Reopening..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ri,{className:"w-4 h-4"}),"Reopen"]})})]})]})]})}function wet({taskTitle:e,onConfirm:t,onCancel:r,isResetting:n}){return w.useEffect(()=>{const a=s=>{s.key==="Escape"&&!n&&r()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[n,r]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"reset-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!n&&r()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center",children:o.jsx(LO,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Reset Task"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Reset ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e,'"']}),"? This will:"]}),o.jsxs("ul",{className:"mt-2 text-sm text-[var(--color-text-secondary)] list-disc list-inside space-y-1",children:[o.jsx("li",{children:"Set status back to open"}),o.jsx("li",{children:"Remove the assignee"}),o.jsx("li",{children:"Clear merge status"}),o.jsx("li",{children:"Remove branch/worktree metadata"}),o.jsx("li",{children:"Remove session ID"})]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"reset-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:t,disabled:n,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-amber-600 rounded-md hover:bg-amber-700 disabled:opacity-50","data-testid":"reset-confirm-btn",children:n?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Resetting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(LO,{className:"w-4 h-4"}),"Reset Task"]})})]})]})]})}function ape(e){return new Date(e).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function dh(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function jl(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:ape(e)}function ket({taskId:e}){const[t,r]=w.useState(!0),[n,a]=w.useState(!1),{data:s,isLoading:i}=gJe(e),l=vJe(),c=bJe(),[u,d]=w.useState(null),f=v=>{l.mutate({taskId:e,documentId:v},{onSuccess:()=>a(!1)})},m=v=>{d(v),c.mutate({taskId:e,documentId:v},{onSettled:()=>d(null)})},p=s?.map(v=>v.id)||[];return o.jsxs("div",{className:"mb-6","data-testid":"attachments-section",children:[o.jsxs("button",{onClick:()=>r(!t),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-2 hover:text-[var(--color-text)]","data-testid":"attachments-toggle",children:[t?o.jsx(Yt,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),o.jsx(KC,{className:"w-3 h-3"}),"Attachments (",s?.length||0,")"]}),t&&o.jsxs("div",{className:"space-y-2",children:[i?o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Loading attachments..."]}):s&&s.length>0?s.map(v=>o.jsx(Cet,{doc:v,onRemove:()=>m(v.id),isRemoving:u===v.id},v.id)):o.jsx("div",{className:"text-sm text-[var(--color-text-tertiary)]","data-testid":"attachments-empty",children:"No documents attached"}),o.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors w-full","data-testid":"attach-document-btn",children:[o.jsx(dr,{className:"w-4 h-4"}),"Attach Document"]})]}),o.jsx(jet,{isOpen:n,onClose:()=>a(!1),onSelect:f,alreadyAttachedIds:p,isAttaching:l.isPending})]})}function _et(e){if(!e)return"";const t=e.split(`
`)[0].trim();return t.length>100?t.substring(0,100)+"...":t}function Net(e,t){if(t==="json")try{const r=JSON.stringify(JSON.parse(e),null,2);return o.jsx("pre",{className:"text-xs font-mono bg-[var(--color-surface)] p-3 rounded overflow-x-auto whitespace-pre-wrap text-[var(--color-text)]",children:r})}catch{return o.jsx("pre",{className:"text-xs font-mono bg-[var(--color-surface)] p-3 rounded overflow-x-auto whitespace-pre-wrap text-[var(--color-text)]",children:e})}return t==="markdown"?o.jsx(C2,{content:e,className:"text-sm text-[var(--color-text)] prose prose-sm dark:prose-invert max-w-none","data-testid":"attachment-markdown-content"}):o.jsx("pre",{className:"whitespace-pre-wrap font-sans text-sm text-[var(--color-text)]",children:e})}function Cet({doc:e,onRemove:t,isRemoving:r}){const[n,a]=w.useState(!1),s=_et(e.content);return o.jsxs("div",{className:"border border-[var(--color-border)] rounded-lg overflow-hidden","data-testid":`attachment-item-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-[var(--color-surface-elevated)] group",children:[o.jsx("button",{onClick:()=>a(!n),className:"p-1 hover:bg-[var(--color-surface-hover)] rounded flex-shrink-0","data-testid":`attachment-expand-${e.id}`,"aria-label":n?"Collapse":"Expand",children:n?o.jsx(Yt,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}):o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})}),o.jsx(rn,{className:"w-4 h-4 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-primary)] truncate",children:e.title||"Untitled Document"}),o.jsx("span",{className:"px-1.5 py-0.5 bg-[var(--color-surface)] text-[var(--color-text-tertiary)] rounded text-[10px] flex-shrink-0",children:e.contentType})]}),!n&&s&&o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)] truncate mt-0.5","data-testid":`attachment-preview-${e.id}`,children:s})]}),o.jsx("button",{onClick:t,disabled:r,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-danger)] hover:bg-[var(--color-danger-muted)] rounded opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50","aria-label":"Remove attachment","data-testid":`attachment-remove-${e.id}`,children:r?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(yt,{className:"w-4 h-4"})})]}),n&&e.content&&o.jsx("div",{className:"p-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":`attachment-content-${e.id}`,children:Net(e.content,e.contentType)}),n&&!e.content&&o.jsx("div",{className:"p-3 border-t border-[var(--color-border)] bg-[var(--color-surface)] text-sm text-[var(--color-text-tertiary)] italic","data-testid":`attachment-content-${e.id}`,children:"No content available"})]})}function jet({isOpen:e,onClose:t,onSelect:r,alreadyAttachedIds:n,isAttaching:a}){const[s,i]=w.useState(""),{data:l,isLoading:c}=yJe(s),u=w.useRef(null);if(w.useEffect(()=>{e&&u.current&&u.current.focus()},[e]),w.useEffect(()=>{if(e){const f=m=>{m.key==="Escape"&&!a&&t()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)}},[e,a,t]),!e)return null;const d=l?.filter(f=>!n.includes(f.id))||[];return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"document-picker-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!a&&t()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col border border-[var(--color-border)]",children:[o.jsxs("div",{className:"p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Attach Document"}),o.jsx("button",{onClick:t,disabled:a,className:"p-1 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded","data-testid":"document-picker-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{ref:u,type:"text",placeholder:"Search documents...",value:s,onChange:f=>i(f.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]","data-testid":"document-picker-search"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-text-tertiary)]"})}):d.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-tertiary)]","data-testid":"document-picker-empty",children:l?.length===0?"No documents available":s?"No documents match your search":"All documents are already attached"}):o.jsx("div",{className:"space-y-2",children:d.map(f=>o.jsxs("button",{onClick:()=>r(f.id),disabled:a,className:"w-full flex items-center gap-3 p-3 text-left bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors disabled:opacity-50","data-testid":`document-picker-item-${f.id}`,children:[o.jsx(rn,{className:"w-5 h-5 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] truncate",children:f.title||"Untitled Document"}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)] flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:f.id}),o.jsx("span",{className:"px-1.5 py-0.5 bg-[var(--color-surface)] text-[var(--color-text-tertiary)] rounded",children:f.contentType})]})]}),a&&o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-primary)]"})]},f.id))})})]})]})}function Eet({sessionHistory:e,entityNameMap:t}){const[r,n]=w.useState(!0),[a,s]=w.useState(null),[i,l]=w.useState(null),c=[...e].sort((u,d)=>new Date(d.startedAt).getTime()-new Date(u.startedAt).getTime());return o.jsxs("div",{className:"mb-6","data-testid":"sessions-section",children:[o.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-2 hover:text-[var(--color-text)]","data-testid":"sessions-toggle",children:[r?o.jsx(Yt,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),o.jsx(eh,{className:"w-3 h-3"}),"Sessions (",e.length,")"]}),r&&o.jsx("div",{className:"space-y-2",children:c.length>0?c.map(u=>o.jsx(Met,{entry:u,entityNameMap:t,onView:()=>s(u),onResume:()=>l(u)},u.sessionId)):o.jsx("div",{className:"text-sm text-[var(--color-text-tertiary)]","data-testid":"sessions-empty",children:"No sessions recorded"})}),a&&o.jsx(Tet,{entry:a,onClose:()=>s(null),onResume:()=>{s(null),l(a)}}),i&&o.jsx(Aet,{entry:i,onClose:()=>l(null)})]})}function Met({entry:e,onView:t,onResume:r}){const n=e.agentRole==="worker",a=e.providerSessionId?.substring(0,8);return o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)] group","data-testid":`session-entry-${e.sessionId}`,children:[n?o.jsx(Vr,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}):o.jsx(Al,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.agentName}),o.jsx("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded ${n?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.agentRole}),a&&o.jsx("span",{className:"font-mono text-[10px] text-[var(--color-text-tertiary)]",children:a})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-tertiary)] mt-0.5",children:[o.jsx("span",{title:dh(e.startedAt),children:jl(e.startedAt)}),e.endedAt&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{title:dh(e.endedAt),children:jl(e.endedAt)})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"View transcript",title:"View transcript","data-testid":`session-view-${e.sessionId}`,children:o.jsx(du,{className:"w-4 h-4"})}),e.providerSessionId&&o.jsx("button",{onClick:r,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-green-600 dark:hover:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/30 rounded transition-colors","aria-label":"Resume session",title:"Resume session","data-testid":`session-resume-${e.sessionId}`,children:o.jsx(Yr,{className:"w-4 h-4"})})]})]})}function Tet({entry:e,onClose:t,onResume:r}){const[n,a]=w.useState([]),[s,i]=w.useState(!0),[l,c]=w.useState(null),u=w.useCallback(async()=>{i(!0),c(null);try{const p=(await hme(e.sessionId)).messages.map(tpe);a(p)}catch(m){c(m instanceof Error?m.message:"Failed to load messages")}finally{i(!1)}},[e.sessionId]);w.useEffect(()=>{u()},[u]),w.useEffect(()=>{const m=p=>{p.key==="Escape"&&t()};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[t]);const d=e.agentRole==="worker",f=e.providerSessionId?.substring(0,8);return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"session-transcript-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[70vh] flex flex-col border border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[d?o.jsx(Vr,{className:"w-5 h-5 text-purple-500"}):o.jsx(Al,{className:"w-5 h-5 text-blue-500"}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:e.agentName}),o.jsx("span",{className:`px-1.5 py-0.5 text-xs font-medium rounded ${d?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.agentRole})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-tertiary)] mt-0.5",children:[f&&o.jsx("span",{className:"font-mono",children:f}),o.jsxs("span",{title:dh(e.startedAt),children:["Started: ",jl(e.startedAt)]}),e.endedAt&&o.jsxs("span",{title:dh(e.endedAt),children:[" Ended: ",jl(e.endedAt)]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[e.providerSessionId&&o.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-green-700 bg-green-100 hover:bg-green-200 dark:text-green-300 dark:bg-green-900/30 dark:hover:bg-green-900/50 rounded-md transition-colors","data-testid":"transcript-resume-btn",children:[o.jsx(Yr,{className:"w-4 h-4"}),"Resume"]}),o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded","aria-label":"Close","data-testid":"transcript-close-btn",children:o.jsx(yt,{className:"w-5 h-5"})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:s?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-primary)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading transcript..."})]}):l?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[o.jsx(Rt,{className:"w-6 h-6 text-[var(--color-danger)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:l}),o.jsx("button",{onClick:u,className:"mt-3 px-3 py-1.5 text-sm text-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] rounded-md",children:"Retry"})]}):o.jsx(rpe,{events:n})})]})]})}function Aet({entry:e,onClose:t}){const[r,n]=w.useState(""),a=Ma(),s=w.useRef(null);w.useEffect(()=>{s.current&&s.current.focus()},[]),w.useEffect(()=>{const c=u=>{u.key==="Escape"&&t()};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[t]);const i=()=>{a({to:"/workspaces",search:{layout:"single",agent:e.agentId,resumeSessionId:e.providerSessionId,resumePrompt:r.trim()||void 0}})},l=e.agentRole==="worker";return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"session-resume-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6 border border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${l?"bg-purple-100 dark:bg-purple-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:l?o.jsx(Vr,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}):o.jsx(Al,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Resume Session"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["You'll be taken to the workspace to resume the session with"," ",o.jsx("span",{className:"font-medium text-[var(--color-text)]",children:e.agentName}),"."]})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text-secondary)] mb-1",children:"Resume message (optional)"}),o.jsx("textarea",{ref:s,value:r,onChange:c=>n(c.target.value),placeholder:"Enter a message to send when resuming...",rows:3,className:"w-full p-3 text-sm border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)] resize-y","data-testid":"resume-prompt-input"})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)]","data-testid":"resume-cancel-btn",children:"Cancel"}),o.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700","data-testid":"resume-confirm-btn",children:[o.jsx(Yr,{className:"w-4 h-4"}),"Resume"]})]})]})]})}const Det=[{value:1,label:"Critical"},{value:2,label:"High"},{value:3,label:"Medium"},{value:4,label:"Low"},{value:5,label:"Minimal"}],Let=[{value:1,label:"Trivial"},{value:2,label:"Simple"},{value:3,label:"Moderate"},{value:4,label:"Complex"},{value:5,label:"Very Complex"}],Oet=[{value:"task",label:"Task"},{value:"bug",label:"Bug"},{value:"feature",label:"Feature"},{value:"chore",label:"Chore"}];function spe({isOpen:e,onClose:t,onSuccess:r,defaultToBacklog:n=!1}){const[a,s]=w.useState(""),[i,l]=w.useState(""),[c,u]=w.useState(3),[d,f]=w.useState(3),[m,p]=w.useState("task"),[v,b]=w.useState(""),[y,S]=w.useState([]),[_,N]=w.useState(n),k=w.useRef(null),j=wme(),{data:E}=m1("worker"),{data:T}=pme(),{currentUser:O}=rl(),R=E?.agents??[],H=T?.items??[];w.useEffect(()=>{e&&k.current&&setTimeout(()=>k.current?.focus(),100)},[e]),w.useEffect(()=>{e?N(n):(s(""),l(""),u(3),f(3),p("task"),b(""),S([]),N(!1),j.reset())},[e,n]);const $=async M=>{if(M.preventDefault(),!!a.trim())try{const P=await j.mutateAsync({title:a.trim(),createdBy:O?.id,description:i.trim()||void 0,priority:c,complexity:d,taskType:m,assignee:v||void 0,tags:y.length>0?y:void 0,status:_?"backlog":void 0});r?.(P.task?.id??""),t()}catch{}},L=M=>{M.key==="Escape"&&t()},A=typeof window<"u"&&window.innerWidth<768;return e?A?o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)]","data-testid":"create-task-modal",onKeyDown:L,children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",children:[o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Cancel","data-testid":"create-task-close",children:o.jsx(Ul,{className:"w-5 h-5"})}),o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)]",children:"Create Task"}),o.jsx("button",{onClick:$,disabled:j.isPending||!a.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors","data-testid":"create-task-submit",children:j.isPending?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):"Create"})]}),o.jsxs("form",{onSubmit:$,className:"p-4 pb-20 overflow-y-auto h-[calc(100vh-60px)]",children:[j.isError&&o.jsx("div",{className:"mb-4 p-3 bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-lg text-sm text-[var(--color-danger)]",children:j.error?.message||"Failed to create task"}),o.jsx(LX,{title:a,setTitle:s,titleInputRef:k,description:i,setDescription:l,priority:c,setPriority:u,complexity:d,setComplexity:f,taskType:m,setTaskType:p,assignee:v,setAssignee:b,workers:R,operators:H,tags:y,setTags:S,addToBacklog:_,setAddToBacklog:N})]})]}):o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"create-task-modal",onKeyDown:L,children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t,"data-testid":"create-task-backdrop"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Create Task"}),o.jsx("button",{onClick:t,className:"p-1 text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded","aria-label":"Close","data-testid":"create-task-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:$,className:"p-4",children:[j.isError&&o.jsx("div",{className:"mb-4 p-3 bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-lg text-sm text-[var(--color-danger)]","data-testid":"create-task-error",children:j.error?.message||"Failed to create task"}),o.jsx(LX,{title:a,setTitle:s,titleInputRef:k,description:i,setDescription:l,priority:c,setPriority:u,complexity:d,setComplexity:f,taskType:m,setTaskType:p,assignee:v,setAssignee:b,workers:R,operators:H,tags:y,setTags:S,addToBacklog:_,setAddToBacklog:N}),o.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"create-task-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:j.isPending||!a.trim(),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"create-task-submit",children:j.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Task"]})})]})]})]})})]}):null}function LX({title:e,setTitle:t,titleInputRef:r,description:n,setDescription:a,priority:s,setPriority:i,complexity:l,setComplexity:c,taskType:u,setTaskType:d,assignee:f,setAssignee:m,workers:p,operators:v,tags:b,setTags:y,addToBacklog:S,setAddToBacklog:_}){return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"task-title",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:["Title ",o.jsx("span",{className:"text-[var(--color-danger)]",children:"*"})]}),o.jsx("input",{ref:r,id:"task-title",type:"text",value:e,onChange:N=>t(N.target.value),placeholder:"Enter task title...",className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-title",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"task-description",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Description"}),o.jsx("textarea",{id:"task-description",value:n,onChange:N=>a(N.target.value),placeholder:"Describe the task in detail... (supports Markdown)",rows:4,className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent resize-y min-h-[100px]","data-testid":"create-task-description"}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Markdown formatting is supported"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-priority",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Priority"}),o.jsx("select",{id:"task-priority",value:s,onChange:N=>i(Number(N.target.value)),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-priority",children:Det.map(N=>o.jsx("option",{value:N.value,children:N.label},N.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-complexity",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Complexity"}),o.jsx("select",{id:"task-complexity",value:l,onChange:N=>c(Number(N.target.value)),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-complexity",children:Let.map(N=>o.jsx("option",{value:N.value,children:N.label},N.value))})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-type",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Type"}),o.jsx("select",{id:"task-type",value:u,onChange:N=>d(N.target.value),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-type",children:Oet.map(N=>o.jsx("option",{value:N.value,children:N.label},N.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"task-assignee",className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Assign to"}),o.jsxs("select",{id:"task-assignee",value:f,onChange:N=>m(N.target.value),className:"w-full px-3 py-2 border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"create-task-assignee",children:[o.jsx("option",{value:"",children:"Unassigned"}),v.length>0&&o.jsx("optgroup",{label:"Operators",children:v.map(N=>o.jsx("option",{value:N.id,children:N.name},N.id))}),p.length>0&&o.jsx("optgroup",{label:"Worker Agents",children:p.map(N=>o.jsx("option",{value:N.id,children:N.name},N.id))})]})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-[var(--color-text)] mb-1",children:"Tags"}),o.jsx(ij,{tags:b,onChange:y,placeholder:"Type and press comma to add tags","data-testid":"create-task-tags"})]}),o.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",id:"task-backlog",checked:S,onChange:N=>_(N.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)]","data-testid":"create-task-backlog"}),o.jsx("label",{htmlFor:"task-backlog",className:"text-sm text-[var(--color-text)]",children:"Add to Backlog"})]})]})}function Iet({sortField:e,sortDirection:t,secondarySort:r,onSortFieldChange:n,onSortDirectionChange:a,onSecondarySortChange:s}){const[i,l]=w.useState(!1),[c,u]=w.useState(!1),d=w.useRef(null);w.useEffect(()=>{function v(b){d.current&&!d.current.contains(b.target)&&(l(!1),u(!1))}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const f=bl.find(v=>v.value===e)||bl[0],m=r?bl.find(v=>v.value===r):null,p=bl.filter(v=>v.value!==e);return o.jsxs("div",{className:"relative flex items-center gap-1",ref:d,children:[o.jsxs("button",{onClick:()=>{l(!i),u(!1)},className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-sm text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)]","data-testid":"sort-by-dropdown",children:[o.jsx(t0,{className:"w-4 h-4"}),o.jsxs("span",{children:["Sort: ",f.label]}),m&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["+ ",m.label]}),o.jsx(Yt,{className:`w-3.5 h-3.5 transition-transform ${i?"rotate-180":""}`})]}),o.jsx("button",{onClick:()=>a(t==="asc"?"desc":"asc"),className:`inline-flex items-center justify-center w-8 h-8 text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)] ${t==="asc"?"text-[var(--color-primary)]":""}`,"data-testid":"sort-direction-toggle","aria-label":t==="asc"?"Sort ascending":"Sort descending",title:t==="asc"?"Sort ascending":"Sort descending",children:t==="asc"?o.jsx(Px,{className:"w-4 h-4"}):o.jsx(Rx,{className:"w-4 h-4"})}),i&&!c&&o.jsxs("div",{className:"absolute z-20 mt-1 top-full left-0 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-48","data-testid":"sort-by-options",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase",children:"Primary Sort"}),bl.map(v=>o.jsxs("button",{onClick:()=>{n(v.value),r===v.value&&s(null),l(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${e===v.value?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":`sort-by-option-${v.value}`,children:[o.jsx("span",{children:v.label}),e===v.value&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]},v.value)),o.jsx("div",{className:"border-t border-[var(--color-border)] mt-1 pt-1",children:o.jsxs("button",{onClick:()=>u(!0),className:"w-full text-left px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] flex items-center justify-between","data-testid":"sort-secondary-button",children:[o.jsx("span",{children:"Secondary sort..."}),o.jsx(gn,{className:"w-4 h-4"})]})})]}),i&&c&&o.jsxs("div",{className:"absolute z-20 mt-1 top-full left-0 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-48","data-testid":"sort-secondary-options",children:[o.jsxs("button",{onClick:()=>u(!1),className:"w-full text-left px-3 py-1.5 text-sm text-[var(--color-text-tertiary)] hover:bg-[var(--color-surface-hover)] flex items-center gap-1",children:[o.jsx(gn,{className:"w-4 h-4 rotate-180"}),o.jsx("span",{children:"Back"})]}),o.jsx("div",{className:"border-t border-[var(--color-border)] my-1"}),o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase",children:"Secondary Sort"}),o.jsxs("button",{onClick:()=>{s(null),l(!1),u(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${r===null?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":"sort-secondary-option-none",children:[o.jsx("span",{children:"None"}),r===null&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]}),p.map(v=>o.jsxs("button",{onClick:()=>{s(v.value),l(!1),u(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${r===v.value?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":`sort-secondary-option-${v.value}`,children:[o.jsx("span",{children:v.label}),r===v.value&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]},v.value))]})]})}function Ret({groupBy:e,onGroupByChange:t}){const[r,n]=w.useState(!1),a=w.useRef(null);w.useEffect(()=>{function i(l){a.current&&!a.current.contains(l.target)&&n(!1)}return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const s=Ok.find(i=>i.value===e)||Ok[0];return o.jsxs("div",{className:"relative",ref:a,children:[o.jsxs("button",{onClick:()=>n(!r),className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-sm text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors border border-[var(--color-border)]","data-testid":"group-by-dropdown",children:[o.jsx(t_,{className:"w-4 h-4"}),o.jsxs("span",{children:["Group: ",s.label]}),o.jsx(Yt,{className:`w-3.5 h-3.5 transition-transform ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"absolute z-20 mt-1 right-0 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg py-1 min-w-40","data-testid":"group-by-options",children:Ok.map(i=>o.jsxs("button",{onClick:()=>{t(i.value),n(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-[var(--color-surface-hover)] flex items-center justify-between ${e===i.value?"text-[var(--color-primary)] font-medium":"text-[var(--color-text)]"}`,"data-testid":`group-by-option-${i.value}`,children:[o.jsx("span",{children:i.label}),e===i.value&&o.jsx("span",{className:"text-[var(--color-primary)]",children:""})]},i.value))})]})}function Pet({view:e,onViewChange:t}){return o.jsxs("div",{className:"flex items-center bg-[var(--color-surface-elevated)] rounded-md p-0.5 border border-[var(--color-border)]","data-testid":"tasks-view-toggle",children:[o.jsxs("button",{onClick:()=>t("list"),className:`inline-flex items-center justify-center px-2 py-1.5 text-sm rounded transition-all duration-200 ${e==="list"?"bg-[var(--color-primary)] text-white shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":"tasks-view-list","aria-label":"List view (V L)",title:"List view (V L)",children:[o.jsx(Wp,{className:"w-4 h-4"}),o.jsx("span",{className:"pl-2 hidden @sm:inline",children:"List"})]}),o.jsxs("button",{onClick:()=>t("kanban"),className:`inline-flex items-center justify-center px-2 py-1.5 text-sm rounded transition-all duration-200 ${e==="kanban"?"bg-[var(--color-primary)] text-white shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":"tasks-view-kanban","aria-label":"Kanban view (V K)",title:"Kanban view (V K)",children:[o.jsx(bh,{className:"w-4 h-4"}),o.jsx("span",{className:"pl-2 hidden @sm:inline",children:"Kanban"})]})]})}function zet({filters:e,onFilterChange:t,onClearFilters:r,entityNameMap:n}){const[a,s]=w.useState(!1),i=e.status.length>0||e.priority.length>0||e.assignee!=="",l=e.status.length+e.priority.length+(e.assignee?1:0),c=d=>{const f=e.status.includes(d)?e.status.filter(m=>m!==d):[...e.status,d];t({...e,status:f})},u=d=>{const f=e.priority.includes(d)?e.priority.filter(m=>m!==d):[...e.priority,d];t({...e,priority:f})};return o.jsxs("div",{className:"border-b border-[var(--color-border)] bg-[var(--color-surface-elevated)]","data-testid":"filter-bar",children:[o.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[o.jsxs("button",{onClick:()=>s(!a),className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)]","data-testid":"filter-toggle",children:[o.jsx(ru,{className:"w-4 h-4"}),o.jsx("span",{children:"Filters"}),l>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium bg-[var(--color-primary-muted)] text-[var(--color-primary)] rounded-full",children:l}),o.jsx(Yt,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`})]}),i&&o.jsxs("button",{onClick:r,className:"flex items-center gap-1 text-sm text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)]","data-testid":"clear-filters",children:[o.jsx(us,{className:"w-4 h-4"}),o.jsx("span",{children:"Clear all"})]})]}),a&&o.jsxs("div",{className:"px-4 pb-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-tertiary)] uppercase mb-1.5",children:"Status"}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:UP.map(d=>o.jsx("button",{onClick:()=>c(d.value),className:`px-2.5 py-1 text-xs rounded-full border transition-colors ${e.status.includes(d.value)?`${d.color} border-transparent font-medium`:"bg-[var(--color-surface)] border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-[var(--color-border-hover)]"}`,"data-testid":`filter-status-${d.value}`,children:d.label},d.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-tertiary)] uppercase mb-1.5",children:"Priority"}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:dC.map(d=>o.jsx("button",{onClick:()=>u(d.value),className:`px-2.5 py-1 text-xs rounded-full border transition-colors ${e.priority.includes(d.value)?`${d.color} border-transparent font-medium`:"bg-[var(--color-surface)] border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-[var(--color-border-hover)]"}`,"data-testid":`filter-priority-${d.value}`,children:d.label},d.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-medium text-[var(--color-text-tertiary)] uppercase mb-1.5",children:"Assignee"}),o.jsxs("select",{value:e.assignee,onChange:d=>t({...e,assignee:d.target.value}),className:"w-full max-w-xs px-3 py-1.5 text-sm border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] focus:border-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":"filter-assignee",children:[o.jsx("option",{value:"",children:"All assignees"}),Array.from(n.entries()).map(([d,f])=>o.jsx("option",{value:d,children:f||d},d))]})]})]}),!a&&i&&o.jsxs("div",{className:"px-4 pb-2 flex flex-wrap gap-1.5",children:[e.status.map(d=>{const f=UP.find(m=>m.value===d);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full ${f?.color||"bg-gray-100 text-gray-800"}`,children:[f?.label||d,o.jsx("button",{onClick:()=>c(d),className:"hover:opacity-70","aria-label":`Remove ${f?.label||d} filter`,children:o.jsx(yt,{className:"w-3 h-3"})})]},d)}),e.priority.map(d=>{const f=dC.find(m=>m.value===d);return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full ${f?.color||"bg-gray-100 text-gray-800"}`,children:[f?.label||d,o.jsx("button",{onClick:()=>u(d),className:"hover:opacity-70","aria-label":`Remove ${f?.label||d} filter`,children:o.jsx(yt,{className:"w-3 h-3"})})]},d)}),e.assignee&&o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full bg-[var(--color-surface)] text-[var(--color-text)]",children:["Assignee: ",n.get(e.assignee)||e.assignee,o.jsx("button",{onClick:()=>t({...e,assignee:""}),className:"hover:opacity-70","aria-label":"Remove assignee filter",children:o.jsx(yt,{className:"w-3 h-3"})})]})]})]})}function Bet(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w.useMemo(()=>n=>{t.forEach(a=>a(n))},t)}const j2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function y0(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function BB(e){return"nodeType"in e}function Ws(e){var t,r;return e?y0(e)?e:BB(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function $B(e){const{Document:t}=Ws(e);return e instanceof t}function x1(e){return y0(e)?!1:e instanceof Ws(e).HTMLElement}function ipe(e){return e instanceof Ws(e).SVGElement}function x0(e){return e?y0(e)?e.document:BB(e)?$B(e)?e:x1(e)||ipe(e)?e.ownerDocument:document:document:document}const Xo=j2?w.useLayoutEffect:w.useEffect;function E2(e){const t=w.useRef(e);return Xo(()=>{t.current=e}),w.useCallback(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.current==null?void 0:t.current(...n)},[])}function $et(){const e=w.useRef(null),t=w.useCallback((n,a)=>{e.current=setInterval(n,a)},[]),r=w.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function ux(e,t){t===void 0&&(t=[e]);const r=w.useRef(e);return Xo(()=>{r.current!==e&&(r.current=e)},t),r}function w1(e,t){const r=w.useRef();return w.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function fC(e){const t=E2(e),r=w.useRef(null),n=w.useCallback(a=>{a!==r.current&&t?.(a,r.current),r.current=a},[]);return[r,n]}function hC(e){const t=w.useRef();return w.useEffect(()=>{t.current=e},[e]),t.current}let TL={};function S1(e,t){return w.useMemo(()=>{if(t)return t;const r=TL[e]==null?0:TL[e]+1;return TL[e]=r,e+"-"+r},[e,t])}function ope(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((s,i)=>{const l=Object.entries(i);for(const[c,u]of l){const d=s[c];d!=null&&(s[c]=d+e*u)}return s},{...t})}}const Fp=ope(1),dx=ope(-1);function Fet(e){return"clientX"in e&&"clientY"in e}function M2(e){if(!e)return!1;const{KeyboardEvent:t}=Ws(e.target);return t&&e instanceof t}function Uet(e){if(!e)return!1;const{TouchEvent:t}=Ws(e.target);return t&&e instanceof t}function mC(e){if(Uet(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return Fet(e)?{x:e.clientX,y:e.clientY}:null}const $l=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[$l.Translate.toString(e),$l.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),OX="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Het(e){return e.matches(OX)?e:e.querySelector(OX)}const qet={display:"none"};function Wet(e){let{id:t,value:r}=e;return ce.createElement("div",{id:t,style:qet},r)}function Ket(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ce.createElement("div",{id:t,style:a,role:"status","aria-live":n,"aria-atomic":!0},r)}function Get(){const[e,t]=w.useState("");return{announce:w.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const lpe=w.createContext(null);function Vet(e){const t=w.useContext(lpe);w.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Yet(){const[e]=w.useState(()=>new Set),t=w.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[w.useCallback(n=>{let{type:a,event:s}=n;e.forEach(i=>{var l;return(l=i[a])==null?void 0:l.call(i,s)})},[e]),t]}const Qet={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Jet={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Zet(e){let{announcements:t=Jet,container:r,hiddenTextDescribedById:n,screenReaderInstructions:a=Qet}=e;const{announce:s,announcement:i}=Get(),l=S1("DndLiveRegion"),[c,u]=w.useState(!1);if(w.useEffect(()=>{u(!0)},[]),Vet(w.useMemo(()=>({onDragStart(f){let{active:m}=f;s(t.onDragStart({active:m}))},onDragMove(f){let{active:m,over:p}=f;t.onDragMove&&s(t.onDragMove({active:m,over:p}))},onDragOver(f){let{active:m,over:p}=f;s(t.onDragOver({active:m,over:p}))},onDragEnd(f){let{active:m,over:p}=f;s(t.onDragEnd({active:m,over:p}))},onDragCancel(f){let{active:m,over:p}=f;s(t.onDragCancel({active:m,over:p}))}}),[s,t])),!c)return null;const d=ce.createElement(ce.Fragment,null,ce.createElement(Wet,{id:n,value:a.draggable}),ce.createElement(Ket,{id:l,announcement:i}));return r?pd.createPortal(d,r):d}var Na;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Na||(Na={}));function pC(){}function fx(e,t){return w.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function FB(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return w.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const el=Object.freeze({x:0,y:0});function cpe(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Xet(e,t){const r=mC(e);if(!r)return"0 0";const n={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return n.x+"% "+n.y+"%"}function upe(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function ett(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function IX(e){let{left:t,top:r,height:n,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+n},{x:t+a,y:r+n}]}function dpe(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function RX(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const ttt=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=RX(t,t.left,t.top),s=[];for(const i of n){const{id:l}=i,c=r.get(l);if(c){const u=cpe(RX(c),a);s.push({id:l,data:{droppableContainer:i,value:u}})}}return s.sort(upe)},fpe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=IX(t),s=[];for(const i of n){const{id:l}=i,c=r.get(l);if(c){const u=IX(c),d=a.reduce((m,p,v)=>m+cpe(u[v],p),0),f=Number((d/4).toFixed(4));s.push({id:l,data:{droppableContainer:i,value:f}})}}return s.sort(upe)};function rtt(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),i=a-n,l=s-r;if(n<a&&r<s){const c=t.width*t.height,u=e.width*e.height,d=i*l,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const ntt=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=[];for(const s of n){const{id:i}=s,l=r.get(i);if(l){const c=rtt(l,t);c>0&&a.push({id:i,data:{droppableContainer:s,value:c}})}}return a.sort(ett)};function att(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function hpe(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:el}function stt(e){return function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return a.reduce((i,l)=>({...i,top:i.top+e*l.y,bottom:i.bottom+e*l.y,left:i.left+e*l.x,right:i.right+e*l.x}),{...r})}}const itt=stt(1);function mpe(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ott(e,t,r){const n=mpe(t);if(!n)return e;const{scaleX:a,scaleY:s,x:i,y:l}=n,c=e.left-i-(1-a)*parseFloat(r),u=e.top-l-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),d=a?e.width/a:e.width,f=s?e.height/s:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const ltt={ignoreTransform:!1};function w0(e,t){t===void 0&&(t=ltt);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Ws(e).getComputedStyle(e);u&&(r=ott(r,u,d))}const{top:n,left:a,width:s,height:i,bottom:l,right:c}=r;return{top:n,left:a,width:s,height:i,bottom:l,right:c}}function PX(e){return w0(e,{ignoreTransform:!0})}function ctt(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function utt(e,t){return t===void 0&&(t=Ws(e).getComputedStyle(e)),t.position==="fixed"}function dtt(e,t){t===void 0&&(t=Ws(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const s=t[a];return typeof s=="string"?r.test(s):!1})}function T2(e,t){const r=[];function n(a){if(t!=null&&r.length>=t||!a)return r;if($B(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!x1(a)||ipe(a)||r.includes(a))return r;const s=Ws(e).getComputedStyle(a);return a!==e&&dtt(a,s)&&r.push(a),utt(a,s)?r:n(a.parentNode)}return e?n(e):r}function ppe(e){const[t]=T2(e,1);return t??null}function AL(e){return!j2||!e?null:y0(e)?e:BB(e)?$B(e)||e===x0(e).scrollingElement?window:x1(e)?e:null:null}function gpe(e){return y0(e)?e.scrollX:e.scrollLeft}function vpe(e){return y0(e)?e.scrollY:e.scrollTop}function qP(e){return{x:gpe(e),y:vpe(e)}}var Ba;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Ba||(Ba={}));function bpe(e){return!j2||!e?!1:e===document.scrollingElement}function ype(e){const t={x:0,y:0},r=bpe(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,i=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:a,isLeft:s,isBottom:i,isRight:l,maxScroll:n,minScroll:t}}const ftt={x:.2,y:.2};function htt(e,t,r,n,a){let{top:s,left:i,right:l,bottom:c}=r;n===void 0&&(n=10),a===void 0&&(a=ftt);const{isTop:u,isBottom:d,isLeft:f,isRight:m}=ype(e),p={x:0,y:0},v={x:0,y:0},b={height:t.height*a.y,width:t.width*a.x};return!u&&s<=t.top+b.height?(p.y=Ba.Backward,v.y=n*Math.abs((t.top+b.height-s)/b.height)):!d&&c>=t.bottom-b.height&&(p.y=Ba.Forward,v.y=n*Math.abs((t.bottom-b.height-c)/b.height)),!m&&l>=t.right-b.width?(p.x=Ba.Forward,v.x=n*Math.abs((t.right-b.width-l)/b.width)):!f&&i<=t.left+b.width&&(p.x=Ba.Backward,v.x=n*Math.abs((t.left+b.width-i)/b.width)),{direction:p,speed:v}}function mtt(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:i}=window;return{top:0,left:0,right:s,bottom:i,width:s,height:i}}const{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}function xpe(e){return e.reduce((t,r)=>Fp(t,qP(r)),el)}function ptt(e){return e.reduce((t,r)=>t+gpe(r),0)}function gtt(e){return e.reduce((t,r)=>t+vpe(r),0)}function wpe(e,t){if(t===void 0&&(t=w0),!e)return;const{top:r,left:n,bottom:a,right:s}=t(e);ppe(e)&&(a<=0||s<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const vtt=[["x",["left","right"],ptt],["y",["top","bottom"],gtt]];class UB{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=T2(r),a=xpe(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,i,l]of vtt)for(const c of i)Object.defineProperty(this,c,{get:()=>{const u=l(n),d=a[s]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Qb{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var a;(a=this.target)==null||a.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function btt(e){const{EventTarget:t}=Ws(e);return e instanceof t?e:x0(e)}function DL(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var ho;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ho||(ho={}));function zX(e){e.preventDefault()}function ytt(e){e.stopPropagation()}var Cr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Cr||(Cr={}));const Spe={start:[Cr.Space,Cr.Enter],cancel:[Cr.Esc],end:[Cr.Space,Cr.Enter,Cr.Tab]},xtt=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Cr.Right:return{...r,x:r.x+25};case Cr.Left:return{...r,x:r.x-25};case Cr.Down:return{...r,y:r.y+25};case Cr.Up:return{...r,y:r.y-25}}};class A2{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Qb(x0(r)),this.windowListeners=new Qb(Ws(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ho.Resize,this.handleCancel),this.windowListeners.add(ho.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ho.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&wpe(n),r(el)}handleKeyDown(t){if(M2(t)){const{active:r,context:n,options:a}=this.props,{keyboardCodes:s=Spe,coordinateGetter:i=xtt,scrollBehavior:l="smooth"}=a,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:el;this.referenceCoordinates||(this.referenceCoordinates=d);const f=i(t,{active:r,context:n.current,currentCoordinates:d});if(f){const m=dx(f,d),p={x:0,y:0},{scrollableAncestors:v}=n.current;for(const b of v){const y=t.code,{isTop:S,isRight:_,isLeft:N,isBottom:k,maxScroll:j,minScroll:E}=ype(b),T=mtt(b),O={x:Math.min(y===Cr.Right?T.right-T.width/2:T.right,Math.max(y===Cr.Right?T.left:T.left+T.width/2,f.x)),y:Math.min(y===Cr.Down?T.bottom-T.height/2:T.bottom,Math.max(y===Cr.Down?T.top:T.top+T.height/2,f.y))},R=y===Cr.Right&&!_||y===Cr.Left&&!N,H=y===Cr.Down&&!k||y===Cr.Up&&!S;if(R&&O.x!==f.x){const $=b.scrollLeft+m.x,L=y===Cr.Right&&$<=j.x||y===Cr.Left&&$>=E.x;if(L&&!m.y){b.scrollTo({left:$,behavior:l});return}L?p.x=b.scrollLeft-$:p.x=y===Cr.Right?b.scrollLeft-j.x:b.scrollLeft-E.x,p.x&&b.scrollBy({left:-p.x,behavior:l});break}else if(H&&O.y!==f.y){const $=b.scrollTop+m.y,L=y===Cr.Down&&$<=j.y||y===Cr.Up&&$>=E.y;if(L&&!m.x){b.scrollTo({top:$,behavior:l});return}L?p.y=b.scrollTop-$:p.y=y===Cr.Down?b.scrollTop-j.y:b.scrollTop-E.y,p.y&&b.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,Fp(dx(f,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}A2.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=Spe,onActivation:a}=t,{active:s}=r;const{code:i}=e.nativeEvent;if(n.start.includes(i)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function BX(e){return!!(e&&"distance"in e)}function $X(e){return!!(e&&"delay"in e)}class HB{constructor(t,r,n){var a;n===void 0&&(n=btt(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:s}=t,{target:i}=s;this.props=t,this.events=r,this.document=x0(i),this.documentListeners=new Qb(this.document),this.listeners=new Qb(n),this.windowListeners=new Qb(Ws(i)),this.initialCoordinates=(a=mC(s))!=null?a:el,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ho.Resize,this.handleCancel),this.windowListeners.add(ho.DragStart,zX),this.windowListeners.add(ho.VisibilityChange,this.handleCancel),this.windowListeners.add(ho.ContextMenu,zX),this.documentListeners.add(ho.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if($X(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(BX(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:a}=this.props;a(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(ho.Click,ytt,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ho.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:a,props:s}=this,{onMove:i,options:{activationConstraint:l}}=s;if(!a)return;const c=(r=mC(t))!=null?r:el,u=dx(a,c);if(!n&&l){if(BX(l)){if(l.tolerance!=null&&DL(u,l.tolerance))return this.handleCancel();if(DL(u,l.distance))return this.handleStart()}if($X(l)&&DL(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),i(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Cr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const wtt={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class k1 extends HB{constructor(t){const{event:r}=t,n=x0(r.target);super(t,wtt,n)}}k1.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const Stt={move:{name:"mousemove"},end:{name:"mouseup"}};var WP;(function(e){e[e.RightClick=2]="RightClick"})(WP||(WP={}));class ktt extends HB{constructor(t){super(t,Stt,x0(t.event.target))}}ktt.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===WP.RightClick?!1:(n?.({event:r}),!0)}}];const LL={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class _tt extends HB{constructor(t){super(t,LL)}static setup(){return window.addEventListener(LL.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(LL.move.name,t)};function t(){}}}_tt.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:a}=r;return a.length>1?!1:(n?.({event:r}),!0)}}];var Jb;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Jb||(Jb={}));var gC;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(gC||(gC={}));function Ntt(e){let{acceleration:t,activator:r=Jb.Pointer,canScroll:n,draggingRect:a,enabled:s,interval:i=5,order:l=gC.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:m}=e;const p=jtt({delta:f,disabled:!s}),[v,b]=$et(),y=w.useRef({x:0,y:0}),S=w.useRef({x:0,y:0}),_=w.useMemo(()=>{switch(r){case Jb.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Jb.DraggableRect:return a}},[r,a,c]),N=w.useRef(null),k=w.useCallback(()=>{const E=N.current;if(!E)return;const T=y.current.x*S.current.x,O=y.current.y*S.current.y;E.scrollBy(T,O)},[]),j=w.useMemo(()=>l===gC.TreeOrder?[...u].reverse():u,[l,u]);w.useEffect(()=>{if(!s||!u.length||!_){b();return}for(const E of j){if(n?.(E)===!1)continue;const T=u.indexOf(E),O=d[T];if(!O)continue;const{direction:R,speed:H}=htt(E,O,_,t,m);for(const $ of["x","y"])p[$][R[$]]||(H[$]=0,R[$]=0);if(H.x>0||H.y>0){b(),N.current=E,v(k,i),y.current=H,S.current=R;return}}y.current={x:0,y:0},S.current={x:0,y:0},b()},[t,k,n,b,s,i,JSON.stringify(_),JSON.stringify(p),v,u,j,d,JSON.stringify(m)])}const Ctt={x:{[Ba.Backward]:!1,[Ba.Forward]:!1},y:{[Ba.Backward]:!1,[Ba.Forward]:!1}};function jtt(e){let{delta:t,disabled:r}=e;const n=hC(t);return w1(a=>{if(r||!n||!a)return Ctt;const s={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[Ba.Backward]:a.x[Ba.Backward]||s.x===-1,[Ba.Forward]:a.x[Ba.Forward]||s.x===1},y:{[Ba.Backward]:a.y[Ba.Backward]||s.y===-1,[Ba.Forward]:a.y[Ba.Forward]||s.y===1}}},[r,t,n])}function Ett(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return w1(a=>{var s;return t==null?null:(s=n??a)!=null?s:null},[n,t])}function Mtt(e,t){return w.useMemo(()=>e.reduce((r,n)=>{const{sensor:a}=n,s=a.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,n)}));return[...r,...s]},[]),[e,t])}var hx;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(hx||(hx={}));var KP;(function(e){e.Optimized="optimized"})(KP||(KP={}));const FX=new Map;function Ttt(e,t){let{dragging:r,dependencies:n,config:a}=t;const[s,i]=w.useState(null),{frequency:l,measure:c,strategy:u}=a,d=w.useRef(e),f=y(),m=ux(f),p=w.useCallback(function(S){S===void 0&&(S=[]),!m.current&&i(_=>_===null?S:_.concat(S.filter(N=>!_.includes(N))))},[m]),v=w.useRef(null),b=w1(S=>{if(f&&!r)return FX;if(!S||S===FX||d.current!==e||s!=null){const _=new Map;for(let N of e){if(!N)continue;if(s&&s.length>0&&!s.includes(N.id)&&N.rect.current){_.set(N.id,N.rect.current);continue}const k=N.node.current,j=k?new UB(c(k),k):null;N.rect.current=j,j&&_.set(N.id,j)}return _}return S},[e,s,r,f,c]);return w.useEffect(()=>{d.current=e},[e]),w.useEffect(()=>{f||p()},[r,f]),w.useEffect(()=>{s&&s.length>0&&i(null)},[JSON.stringify(s)]),w.useEffect(()=>{f||typeof l!="number"||v.current!==null||(v.current=setTimeout(()=>{p(),v.current=null},l))},[l,f,p,...n]),{droppableRects:b,measureDroppableContainers:p,measuringScheduled:s!=null};function y(){switch(u){case hx.Always:return!1;case hx.BeforeDragging:return r;default:return!r}}}function qB(e,t){return w1(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function Att(e,t){return qB(e,t)}function Dtt(e){let{callback:t,disabled:r}=e;const n=E2(t),a=w.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(n)},[n,r]);return w.useEffect(()=>()=>a?.disconnect(),[a]),a}function D2(e){let{callback:t,disabled:r}=e;const n=E2(t),a=w.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(n)},[r]);return w.useEffect(()=>()=>a?.disconnect(),[a]),a}function Ltt(e){return new UB(w0(e),e)}function UX(e,t,r){t===void 0&&(t=Ltt);const[n,a]=w.useState(null);function s(){a(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const i=Dtt({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=D2({callback:s});return Xo(()=>{s(),e?(l?.observe(e),i?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),i?.disconnect())},[e]),n}function Ott(e){const t=qB(e);return hpe(e,t)}const HX=[];function Itt(e){const t=w.useRef(e),r=w1(n=>e?n&&n!==HX&&e&&t.current&&e.parentNode===t.current.parentNode?n:T2(e):HX,[e]);return w.useEffect(()=>{t.current=e},[e]),r}function Rtt(e){const[t,r]=w.useState(null),n=w.useRef(e),a=w.useCallback(s=>{const i=AL(s.target);i&&r(l=>l?(l.set(i,qP(i)),new Map(l)):null)},[]);return w.useEffect(()=>{const s=n.current;if(e!==s){i(s);const l=e.map(c=>{const u=AL(c);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,qP(u)]):null}).filter(c=>c!=null);r(l.length?new Map(l):null),n.current=e}return()=>{i(e),i(s)};function i(l){l.forEach(c=>{const u=AL(c);u?.removeEventListener("scroll",a)})}},[a,e]),w.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,i)=>Fp(s,i),el):xpe(e):el,[e,t])}function qX(e,t){t===void 0&&(t=[]);const r=w.useRef(null);return w.useEffect(()=>{r.current=null},t),w.useEffect(()=>{const n=e!==el;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?dx(e,r.current):el}function Ptt(e){w.useEffect(()=>{if(!j2)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function ztt(e,t){return w.useMemo(()=>e.reduce((r,n)=>{let{eventName:a,handler:s}=n;return r[a]=i=>{s(i,t)},r},{}),[e,t])}function kpe(e){return w.useMemo(()=>e?ctt(e):null,[e])}const WX=[];function Btt(e,t){t===void 0&&(t=w0);const[r]=e,n=kpe(r?Ws(r):null),[a,s]=w.useState(WX);function i(){s(()=>e.length?e.map(c=>bpe(c)?n:new UB(t(c),c)):WX)}const l=D2({callback:i});return Xo(()=>{l?.disconnect(),i(),e.forEach(c=>l?.observe(c))},[e]),a}function _pe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return x1(t)?t:e}function $tt(e){let{measure:t}=e;const[r,n]=w.useState(null),a=w.useCallback(u=>{for(const{target:d}of u)if(x1(d)){n(f=>{const m=t(d);return f?{...f,width:m.width,height:m.height}:m});break}},[t]),s=D2({callback:a}),i=w.useCallback(u=>{const d=_pe(u);s?.disconnect(),d&&s?.observe(d),n(d?t(d):null)},[t,s]),[l,c]=fC(i);return w.useMemo(()=>({nodeRef:l,rect:r,setRef:c}),[r,l,c])}const Ftt=[{sensor:k1,options:{}},{sensor:A2,options:{}}],Utt={current:{}},Ik={draggable:{measure:PX},droppable:{measure:PX,strategy:hx.WhileDragging,frequency:KP.Optimized},dragOverlay:{measure:w0}};class Zb extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const Htt={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Zb,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:pC},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ik,measureDroppableContainers:pC,windowRect:null,measuringScheduled:!1},Npe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:pC,draggableNodes:new Map,over:null,measureDroppableContainers:pC},_1=w.createContext(Npe),Cpe=w.createContext(Htt);function qtt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Zb}}}function Wtt(e,t){switch(t.type){case Na.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Na.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Na.DragEnd:case Na.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Na.RegisterDroppable:{const{element:r}=t,{id:n}=r,a=new Zb(e.droppable.containers);return a.set(n,r),{...e,droppable:{...e.droppable,containers:a}}}case Na.SetDroppableDisabled:{const{id:r,key:n,disabled:a}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const i=new Zb(e.droppable.containers);return i.set(r,{...s,disabled:a}),{...e,droppable:{...e.droppable,containers:i}}}case Na.UnregisterDroppable:{const{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;const s=new Zb(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function Ktt(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:a}=w.useContext(_1),s=hC(n),i=hC(r?.id);return w.useEffect(()=>{if(!t&&!n&&s&&i!=null){if(!M2(s)||document.activeElement===s.target)return;const l=a.get(i);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=Het(d);if(f){f.focus();break}}})}},[n,t,a,i,s]),null}function jpe(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((a,s)=>s({transform:a,...n}),r):r}function Gtt(e){return w.useMemo(()=>({draggable:{...Ik.draggable,...e?.draggable},droppable:{...Ik.droppable,...e?.droppable},dragOverlay:{...Ik.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Vtt(e){let{activeNode:t,measure:r,initialRect:n,config:a=!0}=e;const s=w.useRef(!1),{x:i,y:l}=typeof a=="boolean"?{x:a,y:a}:a;Xo(()=>{if(!i&&!l||!t){s.current=!1;return}if(s.current||!n)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=hpe(d,n);if(i||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=ppe(u);m&&m.scrollBy({top:f.y,left:f.x})}},[t,i,l,n,r])}const L2=w.createContext({...el,scaleX:1,scaleY:1});var cd;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(cd||(cd={}));const vC=w.memo(function(t){var r,n,a,s;let{id:i,accessibility:l,autoScroll:c=!0,children:u,sensors:d=Ftt,collisionDetection:f=ntt,measuring:m,modifiers:p,...v}=t;const b=w.useReducer(Wtt,void 0,qtt),[y,S]=b,[_,N]=Yet(),[k,j]=w.useState(cd.Uninitialized),E=k===cd.Initialized,{draggable:{active:T,nodes:O,translate:R},droppable:{containers:H}}=y,$=T!=null?O.get(T):null,L=w.useRef({initial:null,translated:null}),A=w.useMemo(()=>{var bt;return T!=null?{id:T,data:(bt=$?.data)!=null?bt:Utt,rect:L}:null},[T,$]),M=w.useRef(null),[P,I]=w.useState(null),[B,F]=w.useState(null),q=ux(v,Object.values(v)),Q=S1("DndDescribedBy",i),W=w.useMemo(()=>H.getEnabled(),[H]),G=Gtt(m),{droppableRects:J,measureDroppableContainers:X,measuringScheduled:V}=Ttt(W,{dragging:E,dependencies:[R.x,R.y],config:G.droppable}),se=Ett(O,T),de=w.useMemo(()=>B?mC(B):null,[B]),he=nt(),te=Att(se,G.draggable.measure);Vtt({activeNode:T!=null?O.get(T):null,config:he.layoutShiftCompensation,initialRect:te,measure:G.draggable.measure});const le=UX(se,G.draggable.measure,te),oe=UX(se?se.parentElement:null),Z=w.useRef({activatorEvent:null,active:null,activeNode:se,collisionRect:null,collisions:null,droppableRects:J,draggableNodes:O,draggingNode:null,draggingNodeRect:null,droppableContainers:H,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ve=H.getNodeFor((r=Z.current.over)==null?void 0:r.id),U=$tt({measure:G.dragOverlay.measure}),ge=(n=U.nodeRef.current)!=null?n:se,ue=E?(a=U.rect)!=null?a:le:null,re=!!(U.nodeRef.current&&U.rect),ne=Ott(re?null:le),me=kpe(ge?Ws(ge):null),ke=Itt(E?ve??se:null),we=Btt(ke),pe=jpe(p,{transform:{x:R.x-ne.x,y:R.y-ne.y,scaleX:1,scaleY:1},activatorEvent:B,active:A,activeNodeRect:le,containerNodeRect:oe,draggingNodeRect:ue,over:Z.current.over,overlayNodeRect:U.rect,scrollableAncestors:ke,scrollableAncestorRects:we,windowRect:me}),Oe=de?Fp(de,R):null,Ae=Rtt(ke),Re=qX(Ae),Ve=qX(Ae,[le]),gt=Fp(pe,Re),lt=ue?itt(ue,pe):null,Pt=A&&lt?f({active:A,collisionRect:lt,droppableRects:J,droppableContainers:W,pointerCoordinates:Oe}):null,fr=dpe(Pt,"id"),[Qe,Vt]=w.useState(null),at=re?pe:Fp(pe,Ve),Ne=att(at,(s=Qe?.rect)!=null?s:null,le),Fe=w.useRef(null),Ke=w.useCallback((bt,Ct)=>{let{sensor:fe,options:De}=Ct;if(M.current==null)return;const Ue=O.get(M.current);if(!Ue)return;const dt=bt.nativeEvent,Nt=new fe({active:M.current,activeNode:Ue,event:dt,options:De,context:Z,onAbort(Je){if(!O.get(Je))return;const{onDragAbort:it}=q.current,tr={id:Je};it?.(tr),_({type:"onDragAbort",event:tr})},onPending(Je,et,it,tr){if(!O.get(Je))return;const{onDragPending:Le}=q.current,We={id:Je,constraint:et,initialCoordinates:it,offset:tr};Le?.(We),_({type:"onDragPending",event:We})},onStart(Je){const et=M.current;if(et==null)return;const it=O.get(et);if(!it)return;const{onDragStart:tr}=q.current,ee={activatorEvent:dt,active:{id:et,data:it.data,rect:L}};pd.unstable_batchedUpdates(()=>{tr?.(ee),j(cd.Initializing),S({type:Na.DragStart,initialCoordinates:Je,active:et}),_({type:"onDragStart",event:ee}),I(Fe.current),F(dt)})},onMove(Je){S({type:Na.DragMove,coordinates:Je})},onEnd:Mt(Na.DragEnd),onCancel:Mt(Na.DragCancel)});Fe.current=Nt;function Mt(Je){return async function(){const{active:it,collisions:tr,over:ee,scrollAdjustedTranslate:Le}=Z.current;let We=null;if(it&&Le){const{cancelDrop:be}=q.current;We={activatorEvent:dt,active:it,collisions:tr,delta:Le,over:ee},Je===Na.DragEnd&&typeof be=="function"&&await Promise.resolve(be(We))&&(Je=Na.DragCancel)}M.current=null,pd.unstable_batchedUpdates(()=>{S({type:Je}),j(cd.Uninitialized),Vt(null),I(null),F(null),Fe.current=null;const be=Je===Na.DragEnd?"onDragEnd":"onDragCancel";if(We){const K=q.current[be];K?.(We),_({type:be,event:We})}})}}},[O]),Tt=w.useCallback((bt,Ct)=>(fe,De)=>{const Ue=fe.nativeEvent,dt=O.get(De);if(M.current!==null||!dt||Ue.dndKit||Ue.defaultPrevented)return;const Nt={active:dt};bt(fe,Ct.options,Nt)===!0&&(Ue.dndKit={capturedBy:Ct.sensor},M.current=De,Ke(fe,Ct))},[O,Ke]),wt=Mtt(d,Tt);Ptt(d),Xo(()=>{le&&k===cd.Initializing&&j(cd.Initialized)},[le,k]),w.useEffect(()=>{const{onDragMove:bt}=q.current,{active:Ct,activatorEvent:fe,collisions:De,over:Ue}=Z.current;if(!Ct||!fe)return;const dt={active:Ct,activatorEvent:fe,collisions:De,delta:{x:gt.x,y:gt.y},over:Ue};pd.unstable_batchedUpdates(()=>{bt?.(dt),_({type:"onDragMove",event:dt})})},[gt.x,gt.y]),w.useEffect(()=>{const{active:bt,activatorEvent:Ct,collisions:fe,droppableContainers:De,scrollAdjustedTranslate:Ue}=Z.current;if(!bt||M.current==null||!Ct||!Ue)return;const{onDragOver:dt}=q.current,Nt=De.get(fr),Mt=Nt&&Nt.rect.current?{id:Nt.id,rect:Nt.rect.current,data:Nt.data,disabled:Nt.disabled}:null,Je={active:bt,activatorEvent:Ct,collisions:fe,delta:{x:Ue.x,y:Ue.y},over:Mt};pd.unstable_batchedUpdates(()=>{Vt(Mt),dt?.(Je),_({type:"onDragOver",event:Je})})},[fr]),Xo(()=>{Z.current={activatorEvent:B,active:A,activeNode:se,collisionRect:lt,collisions:Pt,droppableRects:J,draggableNodes:O,draggingNode:ge,draggingNodeRect:ue,droppableContainers:H,over:Qe,scrollableAncestors:ke,scrollAdjustedTranslate:gt},L.current={initial:ue,translated:lt}},[A,se,Pt,lt,O,ge,ue,J,H,Qe,ke,gt]),Ntt({...he,delta:R,draggingRect:lt,pointerCoordinates:Oe,scrollableAncestors:ke,scrollableAncestorRects:we});const Zt=w.useMemo(()=>({active:A,activeNode:se,activeNodeRect:le,activatorEvent:B,collisions:Pt,containerNodeRect:oe,dragOverlay:U,draggableNodes:O,droppableContainers:H,droppableRects:J,over:Qe,measureDroppableContainers:X,scrollableAncestors:ke,scrollableAncestorRects:we,measuringConfiguration:G,measuringScheduled:V,windowRect:me}),[A,se,le,B,Pt,oe,U,O,H,J,Qe,X,ke,we,G,V,me]),Xe=w.useMemo(()=>({activatorEvent:B,activators:wt,active:A,activeNodeRect:le,ariaDescribedById:{draggable:Q},dispatch:S,draggableNodes:O,over:Qe,measureDroppableContainers:X}),[B,wt,A,le,S,Q,O,Qe,X]);return ce.createElement(lpe.Provider,{value:N},ce.createElement(_1.Provider,{value:Xe},ce.createElement(Cpe.Provider,{value:Zt},ce.createElement(L2.Provider,{value:Ne},u)),ce.createElement(Ktt,{disabled:l?.restoreFocus===!1})),ce.createElement(Zet,{...l,hiddenTextDescribedById:Q}));function nt(){const bt=P?.autoScrollEnabled===!1,Ct=typeof c=="object"?c.enabled===!1:c===!1,fe=E&&!bt&&!Ct;return typeof c=="object"?{...c,enabled:fe}:{enabled:fe}}}),Ytt=w.createContext(null),KX="button",Qtt="Draggable";function Epe(e){let{id:t,data:r,disabled:n=!1,attributes:a}=e;const s=S1(Qtt),{activators:i,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:m}=w.useContext(_1),{role:p=KX,roleDescription:v="draggable",tabIndex:b=0}=a??{},y=c?.id===t,S=w.useContext(y?L2:Ytt),[_,N]=fC(),[k,j]=fC(),E=ztt(i,t),T=ux(r);Xo(()=>(f.set(t,{id:t,key:s,node:_,activatorNode:k,data:T}),()=>{const R=f.get(t);R&&R.key===s&&f.delete(t)}),[f,t]);const O=w.useMemo(()=>({role:p,tabIndex:b,"aria-disabled":n,"aria-pressed":y&&p===KX?!0:void 0,"aria-roledescription":v,"aria-describedby":d.draggable}),[n,p,b,y,v,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:O,isDragging:y,listeners:n?void 0:E,node:_,over:m,setNodeRef:N,setActivatorNodeRef:j,transform:S}}function Mpe(){return w.useContext(Cpe)}const Jtt="Droppable",Ztt={timeout:25};function O2(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:a}=e;const s=S1(Jtt),{active:i,dispatch:l,over:c,measureDroppableContainers:u}=w.useContext(_1),d=w.useRef({disabled:r}),f=w.useRef(!1),m=w.useRef(null),p=w.useRef(null),{disabled:v,updateMeasurementsFor:b,timeout:y}={...Ztt,...a},S=ux(b??n),_=w.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(S.current)?S.current:[S.current]),p.current=null},y)},[y]),N=D2({callback:_,disabled:v||!i}),k=w.useCallback((O,R)=>{N&&(R&&(N.unobserve(R),f.current=!1),O&&N.observe(O))},[N]),[j,E]=fC(k),T=ux(t);return w.useEffect(()=>{!N||!j.current||(N.disconnect(),f.current=!1,N.observe(j.current))},[j,N]),w.useEffect(()=>(l({type:Na.RegisterDroppable,element:{id:n,key:s,disabled:r,node:j,rect:m,data:T}}),()=>l({type:Na.UnregisterDroppable,key:s,id:n})),[n]),w.useEffect(()=>{r!==d.current.disabled&&(l({type:Na.SetDroppableDisabled,id:n,key:s,disabled:r}),d.current.disabled=r)},[n,s,r,l]),{active:i,rect:m,isOver:c?.id===n,node:j,over:c,setNodeRef:E}}function Xtt(e){let{animation:t,children:r}=e;const[n,a]=w.useState(null),[s,i]=w.useState(null),l=hC(r);return!r&&!n&&l&&a(l),Xo(()=>{if(!s)return;const c=n?.key,u=n?.props.id;if(c==null||u==null){a(null);return}Promise.resolve(t(u,s)).then(()=>{a(null)})},[t,n,s]),ce.createElement(ce.Fragment,null,r,n?w.cloneElement(n,{ref:i}):null)}const ert={x:0,y:0,scaleX:1,scaleY:1};function trt(e){let{children:t}=e;return ce.createElement(_1.Provider,{value:Npe},ce.createElement(L2.Provider,{value:ert},t))}const rrt={position:"fixed",touchAction:"none"},nrt=e=>M2(e)?"transform 250ms ease":void 0,art=w.forwardRef((e,t)=>{let{as:r,activatorEvent:n,adjustScale:a,children:s,className:i,rect:l,style:c,transform:u,transition:d=nrt}=e;if(!l)return null;const f=a?u:{...u,scaleX:1,scaleY:1},m={...rrt,width:l.width,height:l.height,top:l.top,left:l.left,transform:$l.Transform.toString(f),transformOrigin:a&&n?Xet(n,l):void 0,transition:typeof d=="function"?d(n):d,...c};return ce.createElement(r,{className:i,style:m,ref:t},s)}),srt=e=>t=>{let{active:r,dragOverlay:n}=t;const a={},{styles:s,className:i}=e;if(s!=null&&s.active)for(const[l,c]of Object.entries(s.active))c!==void 0&&(a[l]=r.node.style.getPropertyValue(l),r.node.style.setProperty(l,c));if(s!=null&&s.dragOverlay)for(const[l,c]of Object.entries(s.dragOverlay))c!==void 0&&n.node.style.setProperty(l,c);return i!=null&&i.active&&r.node.classList.add(i.active),i!=null&&i.dragOverlay&&n.node.classList.add(i.dragOverlay),function(){for(const[c,u]of Object.entries(a))r.node.style.setProperty(c,u);i!=null&&i.active&&r.node.classList.remove(i.active)}},irt=e=>{let{transform:{initial:t,final:r}}=e;return[{transform:$l.Transform.toString(t)},{transform:$l.Transform.toString(r)}]},ort={duration:250,easing:"ease",keyframes:irt,sideEffects:srt({styles:{active:{opacity:"0"}}})};function lrt(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:a}=e;return E2((s,i)=>{if(t===null)return;const l=r.get(s);if(!l)return;const c=l.node.current;if(!c)return;const u=_pe(i);if(!u)return;const{transform:d}=Ws(i).getComputedStyle(i),f=mpe(d);if(!f)return;const m=typeof t=="function"?t:crt(t);return wpe(c,a.draggable.measure),m({active:{id:s,data:l.data,node:c,rect:a.draggable.measure(c)},draggableNodes:r,dragOverlay:{node:i,rect:a.dragOverlay.measure(u)},droppableContainers:n,measuringConfiguration:a,transform:f})})}function crt(e){const{duration:t,easing:r,sideEffects:n,keyframes:a}={...ort,...e};return s=>{let{active:i,dragOverlay:l,transform:c,...u}=s;if(!t)return;const d={x:l.rect.left-i.rect.left,y:l.rect.top-i.rect.top},f={scaleX:c.scaleX!==1?i.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?i.rect.height*c.scaleY/l.rect.height:1},m={x:c.x-d.x,y:c.y-d.y,...f},p=a({...u,active:i,dragOverlay:l,transform:{initial:c,final:m}}),[v]=p,b=p[p.length-1];if(JSON.stringify(v)===JSON.stringify(b))return;const y=n?.({active:i,dragOverlay:l,...u}),S=l.node.animate(p,{duration:t,easing:r,fill:"forwards"});return new Promise(_=>{S.onfinish=()=>{y?.(),_()}})}}let GX=0;function urt(e){return w.useMemo(()=>{if(e!=null)return GX++,GX},[e])}const bC=ce.memo(e=>{let{adjustScale:t=!1,children:r,dropAnimation:n,style:a,transition:s,modifiers:i,wrapperElement:l="div",className:c,zIndex:u=999}=e;const{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:p,draggableNodes:v,droppableContainers:b,dragOverlay:y,over:S,measuringConfiguration:_,scrollableAncestors:N,scrollableAncestorRects:k,windowRect:j}=Mpe(),E=w.useContext(L2),T=urt(f?.id),O=jpe(i,{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:p,draggingNodeRect:y.rect,over:S,overlayNodeRect:y.rect,scrollableAncestors:N,scrollableAncestorRects:k,transform:E,windowRect:j}),R=qB(m),H=lrt({config:n,draggableNodes:v,droppableContainers:b,measuringConfiguration:_}),$=R?y.setRef:void 0;return ce.createElement(trt,null,ce.createElement(Xtt,{animation:H},f&&T?ce.createElement(art,{key:T,id:f.id,ref:$,as:l,activatorEvent:d,adjustScale:t,className:c,transition:s,rect:R,style:{zIndex:u,...a},transform:O},r):null))});function Tpe(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function drt(e,t){return e.reduce((r,n,a)=>{const s=t.get(n);return s&&(r[a]=s),r},Array(e.length))}function BS(e){return e!==null&&e>=0}function frt(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function hrt(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const $S={scaleX:1,scaleY:1},mrt=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:a,overIndex:s,index:i}=e;const l=(t=r[a])!=null?t:n;if(!l)return null;const c=prt(r,i,a);if(i===a){const u=r[s];return u?{x:a<s?u.left+u.width-(l.left+l.width):u.left-l.left,y:0,...$S}:null}return i>a&&i<=s?{x:-l.width-c,y:0,...$S}:i<a&&i>=s?{x:l.width+c,y:0,...$S}:{x:0,y:0,...$S}};function prt(e,t,r){const n=e[t],a=e[t-1],s=e[t+1];return!n||!a&&!s?0:r<t?a?n.left-(a.left+a.width):s.left-(n.left+n.width):s?s.left-(n.left+n.width):n.left-(a.left+a.width)}const Ape=e=>{let{rects:t,activeIndex:r,overIndex:n,index:a}=e;const s=Tpe(t,n,r),i=t[a],l=s[a];return!l||!i?null:{x:l.left-i.left,y:l.top-i.top,scaleX:l.width/i.width,scaleY:l.height/i.height}},FS={scaleX:1,scaleY:1},grt=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:a,rects:s,overIndex:i}=e;const l=(t=s[r])!=null?t:n;if(!l)return null;if(a===r){const u=s[i];return u?{x:0,y:r<i?u.top+u.height-(l.top+l.height):u.top-l.top,...FS}:null}const c=vrt(s,a,r);return a>r&&a<=i?{x:0,y:-l.height-c,...FS}:a<r&&a>=i?{x:0,y:l.height+c,...FS}:{x:0,y:0,...FS}};function vrt(e,t,r){const n=e[t],a=e[t-1],s=e[t+1];return n?r<t?a?n.top-(a.top+a.height):s?s.top-(n.top+n.height):0:s?s.top-(n.top+n.height):a?n.top-(a.top+a.height):0:0}const Dpe="Sortable",Lpe=ce.createContext({activeIndex:-1,containerId:Dpe,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ape,disabled:{draggable:!1,droppable:!1}});function Ope(e){let{children:t,id:r,items:n,strategy:a=Ape,disabled:s=!1}=e;const{active:i,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=Mpe(),f=S1(Dpe,r),m=l.rect!==null,p=w.useMemo(()=>n.map(E=>typeof E=="object"&&"id"in E?E.id:E),[n]),v=i!=null,b=i?p.indexOf(i.id):-1,y=u?p.indexOf(u.id):-1,S=w.useRef(p),_=!frt(p,S.current),N=y!==-1&&b===-1||_,k=hrt(s);Xo(()=>{_&&v&&d(p)},[_,p,v,d]),w.useEffect(()=>{S.current=p},[p]);const j=w.useMemo(()=>({activeIndex:b,containerId:f,disabled:k,disableTransforms:N,items:p,overIndex:y,useDragOverlay:m,sortedRects:drt(p,c),strategy:a}),[b,f,k.draggable,k.droppable,N,p,y,c,m,a]);return ce.createElement(Lpe.Provider,{value:j},t)}const brt=e=>{let{id:t,items:r,activeIndex:n,overIndex:a}=e;return Tpe(r,n,a).indexOf(t)},yrt=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:a,items:s,newIndex:i,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!n||l!==s&&a===i?!1:r?!0:i!==a&&t===c},xrt={duration:200,easing:"ease"},Ipe="transform",wrt=$l.Transition.toString({property:Ipe,duration:0,easing:"linear"}),Srt={roleDescription:"sortable"};function krt(e){let{disabled:t,index:r,node:n,rect:a}=e;const[s,i]=w.useState(null),l=w.useRef(r);return Xo(()=>{if(!t&&r!==l.current&&n.current){const c=a.current;if(c){const u=w0(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&i(d)}}r!==l.current&&(l.current=r)},[t,r,n,a]),w.useEffect(()=>{s&&i(null)},[s]),s}function Rpe(e){let{animateLayoutChanges:t=yrt,attributes:r,disabled:n,data:a,getNewIndex:s=brt,id:i,strategy:l,resizeObserverConfig:c,transition:u=xrt}=e;const{items:d,containerId:f,activeIndex:m,disabled:p,disableTransforms:v,sortedRects:b,overIndex:y,useDragOverlay:S,strategy:_}=w.useContext(Lpe),N=_rt(n,p),k=d.indexOf(i),j=w.useMemo(()=>({sortable:{containerId:f,index:k,items:d},...a}),[f,a,k,d]),E=w.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:T,node:O,isOver:R,setNodeRef:H}=O2({id:i,data:j,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...c}}),{active:$,activatorEvent:L,activeNodeRect:A,attributes:M,setNodeRef:P,listeners:I,isDragging:B,over:F,setActivatorNodeRef:q,transform:Q}=Epe({id:i,data:j,attributes:{...Srt,...r},disabled:N.draggable}),W=Bet(H,P),G=!!$,J=G&&!v&&BS(m)&&BS(y),X=!S&&B,V=X&&J?Q:null,de=J?V??(l??_)({rects:b,activeNodeRect:A,activeIndex:m,overIndex:y,index:k}):null,he=BS(m)&&BS(y)?s({id:i,items:d,activeIndex:m,overIndex:y}):k,te=$?.id,le=w.useRef({activeId:te,items:d,newIndex:he,containerId:f}),oe=d!==le.current.items,Z=t({active:$,containerId:f,isDragging:B,isSorting:G,id:i,index:k,items:d,newIndex:le.current.newIndex,previousItems:le.current.items,previousContainerId:le.current.containerId,transition:u,wasDragging:le.current.activeId!=null}),ve=krt({disabled:!Z,index:k,node:O,rect:T});return w.useEffect(()=>{G&&le.current.newIndex!==he&&(le.current.newIndex=he),f!==le.current.containerId&&(le.current.containerId=f),d!==le.current.items&&(le.current.items=d)},[G,he,f,d]),w.useEffect(()=>{if(te===le.current.activeId)return;if(te!=null&&le.current.activeId==null){le.current.activeId=te;return}const ge=setTimeout(()=>{le.current.activeId=te},50);return()=>clearTimeout(ge)},[te]),{active:$,activeIndex:m,attributes:M,data:j,rect:T,index:k,newIndex:he,items:d,isOver:R,isSorting:G,isDragging:B,listeners:I,node:O,overIndex:y,over:F,setNodeRef:W,setActivatorNodeRef:q,setDroppableNodeRef:H,setDraggableNodeRef:P,transform:ve??de,transition:U()};function U(){if(ve||oe&&le.current.newIndex===k)return wrt;if(!(X&&!M2(L)||!u)&&(G||Z))return $l.Transition.toString({...u,property:Ipe})}}function _rt(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e?.draggable)!=null?r:t.draggable,droppable:(n=e?.droppable)!=null?n:t.droppable}}function yC(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Nrt=[Cr.Down,Cr.Right,Cr.Up,Cr.Left],Ppe=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:a,droppableContainers:s,over:i,scrollableAncestors:l}}=t;if(Nrt.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const m=a.get(f.id);if(m)switch(e.code){case Cr.Down:n.top<m.top&&c.push(f);break;case Cr.Up:n.top>m.top&&c.push(f);break;case Cr.Left:n.left>m.left&&c.push(f);break;case Cr.Right:n.left<m.left&&c.push(f);break}});const u=fpe({collisionRect:n,droppableRects:a,droppableContainers:c});let d=dpe(u,"id");if(d===i?.id&&u.length>1&&(d=u[1].id),d!=null){const f=s.get(r.id),m=s.get(d),p=m?a.get(m.id):null,v=m?.node.current;if(v&&p&&f&&m){const y=T2(v).some((E,T)=>l[T]!==E),S=zpe(f,m),_=Crt(f,m),N=y||!S?{x:0,y:0}:{x:_?n.width-p.width:0,y:_?n.height-p.height:0},k={x:p.left,y:p.top};return N.x&&N.y?k:dx(k,N)}}}};function zpe(e,t){return!yC(e)||!yC(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Crt(e,t){return!yC(e)||!yC(t)||!zpe(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const OL=new Map,Rk={assignee:null,priority:null,tag:null},VX={field:"created_at",direction:"desc"},YX=[{id:"backlog",title:"Backlog",icon:H6,color:"border-slate-400",iconColor:"text-slate-500"},{id:"unassigned",title:"Unassigned",icon:ni,color:"border-gray-400",iconColor:"text-gray-500"},{id:"assigned",title:"Assigned",icon:nse,color:"border-blue-400",iconColor:"text-blue-500"},{id:"in_progress",title:"In Progress",icon:Yr,color:"border-yellow-400",iconColor:"text-yellow-500"},{id:"awaiting_merge",title:"Awaiting Merge",icon:Ps,color:"border-purple-400",iconColor:"text-purple-500"},{id:"closed",title:"Closed",icon:Yn,color:"border-green-400",iconColor:"text-green-500"}],jrt=120,Ert=8,QX={1:"border-l-red-500",2:"border-l-orange-500",3:"border-l-yellow-500",4:"border-l-green-500",5:"border-l-gray-400"},Mrt={bug:"bg-red-50 dark:bg-red-900/20",feature:"bg-purple-50 dark:bg-purple-900/20",task:"bg-blue-50 dark:bg-blue-900/20",chore:"bg-gray-50 dark:bg-gray-800/50"};function Trt(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:t.toLocaleDateString()}function np(e){const t=`orchestrator-kanban-column-${e}`,[r,n]=w.useState(()=>{if(typeof window>"u")return{filters:{...Rk},sortOverride:null};try{const s=localStorage.getItem(t);if(s){const i=JSON.parse(s);return{filters:{...Rk,...i.filters},sortOverride:i.sortOverride||null}}}catch{}return{filters:{...Rk},sortOverride:null}}),a=w.useCallback(s=>{n(i=>{const l={filters:{...i.filters,...s.filters||{}},sortOverride:"sortOverride"in s?s.sortOverride??null:i.sortOverride};try{localStorage.setItem(t,JSON.stringify(l))}catch{}return l})},[t]);return[r,a]}function ap(e,t,r,n){let a=[...e];if(n){const s=n.toLowerCase();a=a.filter(i=>i.title.toLowerCase().includes(s)||i.id.toLowerCase().includes(s))}return t.assignee&&(a=a.filter(s=>s.assignee===t.assignee)),t.priority!==null&&(a=a.filter(s=>s.priority===t.priority)),t.tag&&(a=a.filter(s=>s.tags?.includes(t.tag))),a.sort((s,i)=>{let l=0;switch(r.field){case"priority":l=s.priority-i.priority;break;case"created_at":l=new Date(s.createdAt).getTime()-new Date(i.createdAt).getTime();break;case"updated_at":l=new Date(s.updatedAt).getTime()-new Date(i.updatedAt).getTime();break;case"deadline":{const c=s.deadline,u=i.deadline;!c&&!u?l=0:c?u?l=new Date(c).getTime()-new Date(u).getTime():l=-1:l=1;break}case"title":l=s.title.localeCompare(i.title);break;case"complexity":l=s.complexity-i.complexity;break}return r.direction==="asc"?l:-l}),a}function Art(e){const t=new Set;return e.forEach(r=>{r.assignee&&t.add(r.assignee)}),Array.from(t).sort()}function Drt(e){const t=new Set;return e.forEach(r=>{r.tags?.forEach(n=>t.add(n))}),Array.from(t).sort()}function Bpe({task:e,entityNameMap:t,isSelected:r,onClick:n,isDragging:a=!1}){const s=QX[e.priority]||QX[3],i=Mrt[e.taskType]||"",l=e.assignee?t.get(e.assignee):void 0,c=e.metadata?.orchestrator?.branch,u=e.metadata?.orchestrator?.mergeStatus;return o.jsxs("div",{className:`
        p-3 bg-[var(--color-surface)] rounded-lg shadow-sm border-l-4 ${s} ${i}
        cursor-pointer transition-all hover:shadow-md h-full flex flex-col
        ${r?"ring-2 ring-[var(--color-primary)]":"border-t border-r border-b border-[var(--color-border)]"}
        ${a?"opacity-50":""}
      `,onClick:n,"data-testid":`kanban-card-${e.id}`,children:[o.jsx("div",{className:"font-medium text-[var(--color-text)] text-sm mb-1 line-clamp-2 break-words",children:e.title}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-tertiary)] mb-2",children:[o.jsx("span",{className:"font-mono truncate max-w-20",children:e.id.slice(0,8)}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(Rr,{className:"w-3 h-3"}),Trt(e.createdAt)]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap mt-auto",children:[o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)] rounded capitalize",children:e.taskType}),l&&o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 text-xs bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded truncate max-w-24",children:[o.jsx(tn,{className:"w-3 h-3 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:l})]}),c&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)] rounded truncate max-w-20 font-mono",children:c.split("/").pop()}),u&&o.jsx(Lrt,{status:u})]})]})}function Lrt({status:e}){const t={pending:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300",testing:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300",merging:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/50 dark:text-yellow-300",merged:"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300",conflict:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300",test_failed:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300",failed:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300",not_applicable:"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400"};return o.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${t[e]}`,children:e.replace("_"," ")})}function Ort({task:e,entityNameMap:t,isSelected:r,onClick:n}){const{attributes:a,listeners:s,setNodeRef:i,transform:l,transition:c,isDragging:u}=Rpe({id:e.id}),d={transform:$l.Transform.toString(l),transition:c};return o.jsx("div",{ref:i,style:d,className:"h-full",...a,...s,children:o.jsx(Bpe,{task:e,entityNameMap:t,isSelected:r,onClick:n,isDragging:u})})}function Irt({columnId:e,availableAssignees:t,availableTags:r,preferences:n,pageSort:a,onUpdate:s,entityNameMap:i}){const[l,c]=w.useState(!1),u=w.useRef(null),d=[n.filters.assignee,n.filters.priority,n.filters.tag].filter(Boolean).length,f=n.sortOverride!==null,m=n.sortOverride||a;w.useEffect(()=>{function S(_){u.current&&!u.current.contains(_.target)&&c(!1)}return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);const p=()=>{s({filters:Rk})},v=S=>{s(S==="page"?{sortOverride:null}:{sortOverride:{field:S,direction:m.direction}})},b=S=>{f&&n.sortOverride?s({sortOverride:{...n.sortOverride,direction:S}}):s({sortOverride:{field:a.field,direction:S}})},y=bl.find(S=>S.value===a.field)?.label||a.field;return o.jsxs("div",{className:"relative",ref:u,children:[o.jsxs("button",{onClick:()=>c(!l),className:`p-1 rounded transition-colors ${d>0||f?"text-[var(--color-primary)] bg-[var(--color-primary-muted)] hover:bg-[var(--color-primary-muted)]":"text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,title:"Filter & Sort","data-testid":`${e}-filter-button`,children:[o.jsx(ru,{className:"w-3.5 h-3.5"}),(d>0||f)&&o.jsx("span",{className:"absolute -top-1 -right-1 w-3.5 h-3.5 bg-[var(--color-primary)] text-white text-[10px] rounded-full flex items-center justify-center",children:d+(f?1:0)})]}),l&&o.jsxs("div",{className:"absolute right-0 top-full mt-1 w-56 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg z-20 py-2","data-testid":`${e}-filter-dropdown`,children:[o.jsxs("div",{className:"px-3 pb-2 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide mb-2",children:[o.jsx(t0,{className:"w-3 h-3"}),"Sort"]}),o.jsx("div",{className:"mb-2",children:o.jsxs("select",{value:f?n.sortOverride.field:"page",onChange:S=>v(S.target.value),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1.5 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-sort-field`,children:[o.jsxs("option",{value:"page",children:["Page sort (",y,")"]}),bl.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))]})}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>b("asc"),className:`flex-1 px-2 py-1 text-xs rounded ${m.direction==="asc"?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] border border-[var(--color-border)]"}`,"data-testid":`${e}-sort-asc`,children:"Ascending"}),o.jsx("button",{onClick:()=>b("desc"),className:`flex-1 px-2 py-1 text-xs rounded ${m.direction==="desc"?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] border border-[var(--color-border)]"}`,"data-testid":`${e}-sort-desc`,children:"Descending"})]})]}),o.jsxs("div",{className:"px-3 pt-2",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:[o.jsx(ru,{className:"w-3 h-3"}),"Filter"]}),d>0&&o.jsx("button",{onClick:p,className:"text-xs text-[var(--color-primary)] hover:underline","data-testid":`${e}-clear-filters`,children:"Clear"})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)] mb-1 block",children:"Priority"}),o.jsxs("select",{value:n.filters.priority??"",onChange:S=>s({filters:{...n.filters,priority:S.target.value?parseInt(S.target.value,10):null}}),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-filter-priority`,children:[o.jsx("option",{value:"",children:"All priorities"}),dC.map(S=>o.jsx("option",{value:S.value,children:S.label},S.value))]})]}),t.length>0&&o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)] mb-1 block",children:"Assignee"}),o.jsxs("select",{value:n.filters.assignee??"",onChange:S=>s({filters:{...n.filters,assignee:S.target.value||null}}),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-filter-assignee`,children:[o.jsx("option",{value:"",children:"All assignees"}),t.map(S=>o.jsx("option",{value:S,children:i.get(S)||S},S))]})]}),r.length>0&&o.jsxs("div",{className:"mb-1",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)] mb-1 block",children:"Tag"}),o.jsxs("select",{value:n.filters.tag??"",onChange:S=>s({filters:{...n.filters,tag:S.target.value||null}}),className:"w-full text-xs border border-[var(--color-border)] rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] bg-[var(--color-input-bg)] text-[var(--color-text)]","data-testid":`${e}-filter-tag`,children:[o.jsx("option",{value:"",children:"All tags"}),r.map(S=>o.jsx("option",{value:S,children:S},S))]})]})]})]})]})}function Rrt({columnId:e,title:t,color:r,icon:n,tasks:a,entityNameMap:s,selectedTaskId:i,onTaskClick:l,isDragActive:c,preferences:u,pageSort:d,onUpdatePreferences:f,availableAssignees:m,availableTags:p}){const v=w.useRef(null),b=a.map(R=>R.id),y=w.useRef(null),S=`kanban-column-${e}`,_=u.filters.assignee||u.filters.priority!==null||u.filters.tag,{setNodeRef:N,isOver:k}=O2({id:e}),j=uj({count:a.length,getScrollElement:()=>v.current,estimateSize:()=>jrt,gap:Ert,overscan:5,getItemKey:R=>a[R].id}),E=j.getVirtualItems(),T=w.useCallback(R=>{v.current=R,N(R)},[N]);w.useEffect(()=>{if(S&&v.current){const R=OL.get(S);R!==void 0&&R>0&&requestAnimationFrame(()=>{j.scrollToOffset(R)})}},[S]),w.useEffect(()=>()=>{if(S&&v.current){const R=j.scrollOffset;R!==null&&R>0&&OL.set(S,R)}},[S,j]);const O=w.useCallback(()=>{y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{const R=j.scrollOffset;S&&R!==null&&R>0&&OL.set(S,R)},100)},[j,S]);return w.useEffect(()=>()=>{y.current&&clearTimeout(y.current)},[]),o.jsxs("div",{className:`flex flex-col flex-1 min-w-[280px] bg-[var(--color-surface-elevated)] rounded-lg border-t-4 ${r} h-full`,"data-testid":`kanban-column-${e}`,children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-3 border-b border-[var(--color-border)] sticky top-0 bg-[var(--color-surface-elevated)] z-10 rounded-t-lg",children:[n,o.jsx("span",{className:"font-medium text-[var(--color-text)] text-sm",children:t}),o.jsx("span",{className:"px-2 py-0.5 text-xs bg-[var(--color-surface)] text-[var(--color-text-secondary)] rounded-full","data-testid":`kanban-column-${e}-count`,children:a.length}),o.jsx("div",{className:"ml-auto flex items-center gap-2",children:o.jsx(Irt,{columnId:e,availableAssignees:m,availableTags:p,preferences:u,pageSort:d,onUpdate:f,entityNameMap:s})})]}),o.jsx("div",{ref:T,className:`flex-1 overflow-y-auto p-2 pt-3 ${k&&c?"bg-[var(--color-primary-muted)]":""}`,"data-testid":`kanban-column-${e}-scroll`,onScroll:O,children:a.length===0?o.jsx("div",{className:"p-4 text-center text-[var(--color-text-tertiary)] text-sm h-32 flex items-center justify-center",children:_?"No matching tasks":"No tasks"}):o.jsx("div",{className:"relative w-full",style:{height:`${j.getTotalSize()}px`},children:o.jsx(Ope,{items:b,strategy:grt,children:E.map(R=>{const H=a[R.index];return o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${R.size}px`,transform:`translateY(${R.start}px)`},"data-index":R.index,children:o.jsx(Ort,{task:H,entityNameMap:s,isSelected:H.id===i,onClick:()=>l(H.id)})},H.id)})})})})]})}function Prt({tasks:e,entityNameMap:t,selectedTaskId:r,onTaskClick:n,onUpdateTask:a,searchQuery:s,pageSort:i}){const[l,c]=w.useState(null),u=w.useMemo(()=>{if(!i)return VX;const Q=i.field;return bl.some(W=>W.value===Q)?{field:Q,direction:i.direction}:VX},[i?.field,i?.direction]),[d,f]=np("backlog"),[m,p]=np("unassigned"),[v,b]=np("assigned"),[y,S]=np("in_progress"),[_,N]=np("closed"),[k,j]=np("awaiting_merge"),E=w.useMemo(()=>Art(e||[]),[e]),T=w.useMemo(()=>Drt(e||[]),[e]),O=w.useMemo(()=>{const Q={backlog:[],unassigned:[],assigned:[],in_progress:[],closed:[],awaiting_merge:[]};for(const W of e){if(W.status==="tombstone")continue;const G=W.metadata?.orchestrator?.mergeStatus;W.status==="backlog"?Q.backlog.push(W):W.status==="review"?Q.awaiting_merge.push(W):W.status==="closed"?G&&G!=="merged"?Q.awaiting_merge.push(W):Q.closed.push(W):W.status==="in_progress"?Q.in_progress.push(W):(W.status==="open"||W.status==="blocked"||W.status==="deferred")&&(W.assignee?Q.assigned.push(W):Q.unassigned.push(W))}return Q},[e]),R=w.useMemo(()=>ap(O.backlog,d.filters,d.sortOverride||u,s),[O.backlog,d.filters,d.sortOverride,u,s]),H=w.useMemo(()=>ap(O.unassigned,m.filters,m.sortOverride||u,s),[O.unassigned,m.filters,m.sortOverride,u,s]),$=w.useMemo(()=>ap(O.assigned,v.filters,v.sortOverride||u,s),[O.assigned,v.filters,v.sortOverride,u,s]),L=w.useMemo(()=>ap(O.in_progress,y.filters,y.sortOverride||u,s),[O.in_progress,y.filters,y.sortOverride,u,s]),A=w.useMemo(()=>ap(O.closed,_.filters,_.sortOverride||u,s),[O.closed,_.filters,_.sortOverride,u,s]),M=w.useMemo(()=>ap(O.awaiting_merge,k.filters,k.sortOverride||u,s),[O.awaiting_merge,k.filters,k.sortOverride,u,s]),P=FB(fx(k1,{activationConstraint:{distance:8}}),fx(A2,{coordinateGetter:Ppe})),I=Q=>{const{active:W}=Q,G=e?.find(J=>J.id===W.id);G&&c(G)},B=Q=>{const{active:W,over:G}=Q;if(c(null),!G||!e)return;const J=W.id,X=e.find(de=>de.id===J);if(!X)return;let V=null;if(e.find(de=>de.id===G.id)){for(const[de,he]of Object.entries(O))if(he.some(te=>te.id===G.id)){V=de;break}}else YX.some(de=>de.id===G.id)&&(V=G.id);if(V){const de={},te={backlog:"backlog",unassigned:"open",assigned:"open",in_progress:"in_progress",closed:"closed",awaiting_merge:"closed"}[V];te&&te!==X.status&&(de.status=te),V==="unassigned"&&X.assignee&&(de.assignee=null),Object.keys(de).length>0&&a(J,de)}},F=l!==null,q=[{id:"backlog",prefs:d,setPrefs:f,tasks:R},{id:"unassigned",prefs:m,setPrefs:p,tasks:H},{id:"assigned",prefs:v,setPrefs:b,tasks:$},{id:"in_progress",prefs:y,setPrefs:S,tasks:L},{id:"awaiting_merge",prefs:k,setPrefs:j,tasks:M},{id:"closed",prefs:_,setPrefs:N,tasks:A}];return o.jsxs(vC,{sensors:P,collisionDetection:fpe,onDragStart:I,onDragEnd:B,children:[o.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 h-[calc(100vh-320px)]","data-testid":"kanban-board",children:YX.map((Q,W)=>{const G=Q.icon,{prefs:J,setPrefs:X,tasks:V}=q[W];return o.jsx(Rrt,{columnId:Q.id,title:Q.title,color:Q.color,icon:o.jsx(G,{className:`w-4 h-4 ${Q.iconColor}`}),tasks:V,entityNameMap:t,selectedTaskId:r,onTaskClick:n,isDragActive:F,preferences:J,pageSort:u,onUpdatePreferences:X,availableAssignees:E,availableTags:T},Q.id)})}),o.jsx(bC,{children:l&&o.jsx(Bpe,{task:l,entityNameMap:t,isSelected:!1,onClick:()=>{}})})]})}const zrt=[10,25,50,100];function Brt({currentPage:e,totalPages:t,totalItems:r,pageSize:n,onPageChange:a,onPageSizeChange:s,showPageSizeSelector:i=!0}){const l=r===0?0:(e-1)*n+1,c=Math.min(e*n,r),u=()=>{const d=[];if(t<=5)for(let m=1;m<=t;m++)d.push(m);else{d.push(1),e>3&&d.push("ellipsis");const m=Math.max(2,e-1),p=Math.min(t-1,e+1);for(let v=m;v<=p;v++)d.push(v);e<t-2&&d.push("ellipsis"),t>1&&d.push(t)}return d};return t<=1&&!i?o.jsx("div",{className:"flex items-center justify-center sm:justify-between px-3 sm:px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]",children:o.jsx("span",{className:"text-xs sm:text-sm text-[var(--color-text-tertiary)]",children:r===0?"No items":`Showing ${r} item${r!==1?"s":""}`})}):o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 px-4 py-3 border-t border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":"pagination",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]","data-testid":"pagination-info",children:r===0?"No items":`Showing ${l}-${c} of ${r}`}),i&&s&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{htmlFor:"pagination-page-size",className:"text-sm text-[var(--color-text-tertiary)]",children:"Show"}),o.jsx("select",{id:"pagination-page-size",value:n,onChange:d=>s(parseInt(d.target.value,10)),className:"px-2 py-1 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] focus:border-[var(--color-primary)]","data-testid":"pagination-page-size","aria-label":"Items per page",children:zrt.map(d=>o.jsx("option",{value:d,children:d},d))}),o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"per page"})]})]}),t>1&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>a(1),disabled:e===1,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"First page","data-testid":"pagination-first",children:o.jsx(Owe,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>a(e-1),disabled:e===1,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Previous page","data-testid":"pagination-prev",children:o.jsx(Ul,{className:"w-4 h-4"})}),o.jsx("div",{className:"flex items-center gap-1 mx-2",children:u().map((d,f)=>d==="ellipsis"?o.jsx("span",{className:"px-2 text-[var(--color-text-tertiary)]",children:"..."},`ellipsis-${f}`):o.jsx("button",{onClick:()=>a(d),className:`min-w-[32px] h-8 px-2 text-sm rounded transition-colors ${d===e?"bg-[var(--color-primary)] text-white font-medium":"hover:bg-[var(--color-surface-hover)] text-[var(--color-text)]"}`,"data-testid":`pagination-page-${d}`,"aria-current":d===e?"page":void 0,children:d},d))}),o.jsx("button",{onClick:()=>a(e+1),disabled:e===t,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Next page","data-testid":"pagination-next",children:o.jsx(gn,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>a(t),disabled:e===t,className:"p-2 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":"Last page","data-testid":"pagination-last",children:o.jsx(Iwe,{className:"w-4 h-4"})})]})]})}function $rt(){const e=tl({from:"/tasks"}),t=Ma(),r=e.showClosed??!1,[n,a]=w.useState(()=>rXe()),[s,i]=w.useState(()=>iXe()),[l,c]=w.useState(()=>lXe()),[u,d]=w.useState(()=>uXe()),[f,m]=w.useState(()=>aXe()),[p,v]=w.useState(()=>eXe()),[b,y]=w.useState(yX),S=e.page??1,_=e.limit??yf,N=e.status||"all",[k,j]=w.useState(!1),[E,T]=w.useState(!1),O=e.selected,[R,H]=w.useState(new Set),[$,L]=w.useState(!1),{columnWidths:A,handleMouseDown:M}=hXe();w.useEffect(()=>{(e.action==="create"||e.backlog)&&(T(e.backlog===!0),j(!0),t({to:"/tasks",search:{selected:e.selected,page:e.page??1,limit:e.limit??yf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0},replace:!0}))},[e.action,e.backlog,e.selected,e.page,e.limit,e.status,e.assignee,e.showClosed,t]);const[P,I]=w.useState(new Set),[B,F]=w.useState(new Set),[q,Q]=w.useState(new Set),[W,G]=w.useState(null),[J,X]=w.useState(new Set),{backlog:V,unassigned:se,assigned:de,inProgress:he,closed:te,awaitingMerge:le,allTasks:oe,isLoading:Z,error:ve,refetch:U}=g1(),{data:ge}=k2(),ue=w.useMemo(()=>{const be=new Map;return ge&&ge.forEach(K=>be.set(K.id,K.name)),be},[ge]),re=kme(),ne=_me(),me=Nme(),ke=Sme(),we=pJe(),pe=w.useCallback(be=>{a(be),nXe(be)},[]),Oe=w.useCallback(be=>{i(be),oXe(be)},[]),Ae=w.useCallback(be=>{c(be),cXe(be)},[]),Re=w.useCallback(be=>{d(be),dXe(be)},[]),Ve=w.useCallback(be=>{m(be),sXe(be)},[]),gt=w.useCallback(be=>{v(be),tXe(be)},[]);w.useEffect(()=>{let be=!1;const K=xe=>{if(!(xe.target instanceof HTMLInputElement||xe.target instanceof HTMLTextAreaElement)){if(xe.key==="v"||xe.key==="V"){be=!0;return}be&&(xe.key==="l"||xe.key==="L"?(pe("list"),be=!1):((xe.key==="k"||xe.key==="K")&&pe("kanban"),be=!1))}},ie=()=>{setTimeout(()=>{be=!1},500)};return document.addEventListener("keydown",K),document.addEventListener("keyup",ie),()=>{document.removeEventListener("keydown",K),document.removeEventListener("keyup",ie)}},[pe]);const lt=w.useMemo(()=>{let be;switch(N){case"backlog":be=V;break;case"unassigned":be=se;break;case"assigned":be=de;break;case"in_progress":be=he;break;case"closed":be=te;break;case"awaiting_merge":be=le;break;default:be=oe.filter(K=>K.status!=="tombstone"&&(r||K.status!=="closed"))}return be},[N,oe,V,se,de,he,te,le,r]),Pt=w.useMemo(()=>{const be=XZe(b,p);return lt.filter(be)},[lt,b,p]),fr=w.useMemo(()=>{const be=[...Pt];return be.sort((K,ie)=>{const xe=wX(K,ie,s==="created_at"?"createdAt":s==="updated_at"?"updatedAt":s,l);return xe!==0||!u?xe:wX(K,ie,u==="created_at"?"createdAt":u==="updated_at"?"updatedAt":u,l)}),be},[Pt,s,l,u]),Qe=fr.length,Vt=Math.ceil(Qe/_),at=w.useMemo(()=>{if(n==="kanban")return fr;const be=(S-1)*_,K=be+_;return fr.slice(be,K)},[fr,S,_,n]),Ne=w.useMemo(()=>n==="kanban"||f==="none"?[{key:"all",label:"All Tasks",tasks:at}]:ZZe(at,f,ue),[at,f,ue,n]),Fe=be=>{H(new Set),t({to:"/tasks",search:{selected:e.selected,page:1,limit:e.limit??yf,status:be==="all"?void 0:be,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},Ke=w.useCallback(be=>{t({to:"/tasks",search:{selected:e.selected,page:e.page??1,limit:e.limit??yf,status:e.status,assignee:e.assignee,showClosed:be||void 0,action:void 0,backlog:void 0}})},[t,e.selected,e.page,e.limit,e.status,e.assignee]),Tt=be=>{t({to:"/tasks",search:{selected:e.selected,page:be,limit:e.limit??yf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},wt=be=>{t({to:"/tasks",search:{selected:e.selected,page:1,limit:be,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},Zt=be=>{t({to:"/tasks",search:{selected:be,page:e.page??1,limit:e.limit??yf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},Xe=()=>{t({to:"/tasks",search:{selected:void 0,page:e.page??1,limit:e.limit??yf,status:e.status,assignee:e.assignee,showClosed:e.showClosed,action:void 0,backlog:void 0}})},nt=async be=>{I(K=>new Set(K).add(be));try{await re.mutateAsync({taskId:be})}finally{I(K=>{const ie=new Set(K);return ie.delete(be),ie})}},bt=async be=>{F(K=>new Set(K).add(be));try{await ne.mutateAsync({taskId:be})}finally{F(K=>{const ie=new Set(K);return ie.delete(be),ie})}},Ct=be=>{G(be)},fe=async be=>{if(!W)return;const K=W;G(null),Q(ie=>new Set(ie).add(K));try{await me.mutateAsync({taskId:K,message:be})}finally{Q(ie=>{const xe=new Set(ie);return xe.delete(K),xe})}},De=async(be,K)=>{const ie={taskId:be};K.status!==void 0&&(ie.status=K.status),K.assignee!==void 0&&(ie.assignee=K.assignee),await ke.mutateAsync(ie)},Ue=()=>{y(yX)},dt=w.useCallback(be=>{H(K=>{const ie=new Set(K);return ie.has(be)?ie.delete(be):ie.add(be),ie})},[]),Nt=w.useCallback(()=>{H(be=>{const K=at.map(xe=>xe.id);if(K.length>0&&K.every(xe=>be.has(xe))){const xe=new Set(be);return K.forEach(Ce=>xe.delete(Ce)),xe}else{const xe=new Set(be);return K.forEach(Ce=>xe.add(Ce)),xe}})},[at]),Mt=async()=>{try{await we.mutateAsync({ids:Array.from(R)}),H(new Set),L(!1)}catch(be){console.error("Failed to bulk delete tasks:",be)}},Je=w.useCallback(()=>{H(new Set)},[]),et=be=>{X(K=>{const ie=new Set(K);return ie.has(be)?ie.delete(be):ie.add(be),ie})},it=w.useCallback(be=>{be===s?Ae(l==="asc"?"desc":"asc"):(Oe(be),Ae(be==="updated_at"||be==="priority"?"desc":"asc"))},[s,l,Oe,Ae]),tr=at.length>0&&at.every(be=>R.has(be.id)),ee=at.some(be=>R.has(be.id)),Le={all:oe.filter(be=>be.status!=="tombstone"&&(r||be.status!=="closed")).length,backlog:V.length,unassigned:se.length,assigned:de.length,in_progress:he.length,closed:te.length,awaiting_merge:le.length},We=oe.filter(be=>be.status==="closed").length;return o.jsxs("div",{className:"space-y-4 animate-fade-in","data-testid":"tasks-page",children:[o.jsx(spe,{isOpen:k,onClose:()=>{j(!1),T(!1)},onSuccess:be=>Zt(be),defaultToBacklog:E}),W&&o.jsx(npe,{taskTitle:oe.find(be=>be.id===W)?.title??W,onConfirm:fe,onCancel:()=>G(null),isReopening:me.isPending}),O&&o.jsxs("div",{className:"fixed inset-0 z-40","data-testid":"task-detail-overlay",children:[o.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:Xe}),o.jsx("div",{className:"absolute right-0 top-0 h-full w-full max-w-[min(32rem,100%)] bg-[var(--color-surface)] shadow-xl border-l border-[var(--color-border)] animate-slide-in-right",children:o.jsx(iet,{taskId:O,onClose:Xe,onNavigateToTask:Zt})})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)] shrink-0",children:o.jsx(Tl,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Tasks"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] truncate",children:"Manage and track agent task assignments"})]})]}),o.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150 shrink-0","data-testid":"tasks-create",children:[o.jsx(dr,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden @sm:inline",children:"Create Task"}),o.jsx("kbd",{className:"hidden @sm:inline ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(zl("action.createTask"))})]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("div",{className:"relative flex-1 min-w-[12rem] max-w-xs",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:"Search tasks...",value:p,onChange:be=>gt(be.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"tasks-search"})]}),o.jsx(Iet,{sortField:s,sortDirection:l,secondarySort:u,onSortFieldChange:Oe,onSortDirectionChange:Ae,onSecondarySortChange:Re}),n==="list"&&o.jsx(Ret,{groupBy:f,onGroupByChange:Ve}),o.jsx(Pet,{view:n,onViewChange:pe})]})]}),n==="list"&&o.jsx(zet,{filters:b,onFilterChange:y,onClearFilters:Ue,entityNameMap:ue}),n==="list"&&o.jsxs("div",{className:"flex items-center justify-between border-b border-[var(--color-border)] overflow-x-auto",children:[o.jsxs("nav",{className:"flex gap-1 min-w-max","aria-label":"Tabs",children:[o.jsx(xf,{label:"All",value:"all",current:N,count:Le.all,icon:Tl,onClick:()=>Fe("all")}),o.jsx(xf,{label:"Backlog",value:"backlog",current:N,count:Le.backlog,icon:ni,onClick:()=>Fe("backlog")}),o.jsx(xf,{label:"Unassigned",value:"unassigned",current:N,count:Le.unassigned,icon:ni,onClick:()=>Fe("unassigned")}),o.jsx(xf,{label:"Assigned",value:"assigned",current:N,count:Le.assigned,icon:nse,onClick:()=>Fe("assigned")}),o.jsx(xf,{label:"In Progress",value:"in_progress",current:N,count:Le.in_progress,icon:Yr,onClick:()=>Fe("in_progress")}),o.jsx(xf,{label:"Awaiting Merge",value:"awaiting_merge",current:N,count:Le.awaiting_merge,icon:Ps,onClick:()=>Fe("awaiting_merge")}),o.jsx(xf,{label:"Closed",value:"closed",current:N,count:Le.closed,icon:Yn,onClick:()=>Fe("closed")})]}),o.jsxs("button",{onClick:()=>Ke(!r),className:`
              flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-md ml-4 mb-1
              transition-all duration-150 ease-out border
              ${r?"bg-[var(--color-success-muted)] text-[var(--color-success)] border-[var(--color-success)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:bg-[var(--color-surface-hover)]"}
            `,"data-testid":"toggle-show-closed",children:[r?o.jsx(du,{className:"w-4 h-4"}):o.jsx(ase,{className:"w-4 h-4"}),o.jsxs("span",{children:["Closed (",We,")"]})]})]}),R.size>0&&n==="list"&&o.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 bg-[var(--color-primary-muted)] border border-[var(--color-primary)] rounded-lg","data-testid":"bulk-actions-bar",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-sm font-medium text-[var(--color-primary)]",children:[R.size," task",R.size!==1?"s":""," selected"]}),o.jsxs("button",{onClick:Je,className:"text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors flex items-center gap-1","data-testid":"bulk-clear-selection",children:[o.jsx(yt,{className:"w-3.5 h-3.5"}),"Clear"]})]}),o.jsxs("button",{onClick:()=>L(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 border border-red-200 dark:border-red-800 rounded-md transition-colors","data-testid":"bulk-delete-button",children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})]}),$&&o.jsxs("div",{className:"fixed inset-0 z-50",onClick:()=>L(!1),"data-testid":"bulk-delete-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm",onClick:be=>be.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Tasks"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsx("div",{className:"px-5 py-4",children:o.jsxs("p",{className:"text-sm text-[var(--color-text)]",children:["Are you sure you want to delete ",o.jsx("strong",{children:R.size})," task",R.size!==1?"s":"","?"]})}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>L(!1),disabled:we.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"bulk-delete-cancel",children:"Cancel"}),o.jsxs("button",{onClick:Mt,disabled:we.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"bulk-delete-confirm",children:[we.isPending&&o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Delete ",R.size," Task",R.size!==1?"s":""]})]})]})})]}),Z?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading tasks..."})]}):ve?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-danger)] rounded-lg bg-[var(--color-danger-muted)]",children:[o.jsx(Rt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"Failed to load tasks"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:ve.message}),o.jsxs("button",{onClick:()=>U(),className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-surface)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"tasks-retry",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]}):Pt.length===0?o.jsx(Hrt,{searchQuery:p,currentTab:N,onCreateClick:()=>j(!0)}):n==="list"?o.jsxs(o.Fragment,{children:[o.jsx(Frt,{groups:Ne,entityNameMap:ue,onStart:nt,onComplete:bt,onReopen:Ct,onSelectTask:Zt,pendingStart:P,pendingComplete:B,pendingReopen:q,collapsedGroups:J,onToggleCollapse:et,searchQuery:p,sortField:s,sortDirection:l,onSortChange:it,selectedTaskIds:R,onToggleSelect:dt,allPageSelected:tr,somePageSelected:ee,onToggleSelectAll:Nt,columnWidths:A,onColumnResizeStart:M}),o.jsx(Brt,{currentPage:S,totalPages:Vt,totalItems:Qe,pageSize:_,onPageChange:Tt,onPageSizeChange:wt})]}):o.jsx(Prt,{tasks:oe,entityNameMap:ue,selectedTaskId:O??null,onTaskClick:Zt,onUpdateTask:De,searchQuery:p,pageSort:{field:s,direction:l}})]})}function xf({label:e,value:t,current:r,count:n,icon:a,onClick:s}){const i=r===t;return o.jsx("button",{onClick:s,className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${i?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":`tasks-tab-${t}`,children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(a,{className:"w-4 h-4"}),e,n>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:n})]})})}function sp({label:e,field:t,currentSortField:r,currentSortDirection:n,onSortChange:a,width:s,resizable:i,columnId:l,onResizeStart:c}){const u=r===t;return o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wider relative",style:s!=null?{width:`${s}px`,minWidth:`${s}px`}:void 0,children:[o.jsxs("button",{onClick:()=>a(t),className:"flex items-center gap-1 cursor-pointer hover:text-[var(--color-text)] transition-colors group",children:[o.jsx("span",{children:e}),u?n==="asc"?o.jsx(Px,{className:"w-3.5 h-3.5 text-[var(--color-primary)]"}):o.jsx(Rx,{className:"w-3.5 h-3.5 text-[var(--color-primary)]"}):o.jsx(t0,{className:"w-3.5 h-3.5 opacity-0 group-hover:opacity-50 transition-opacity"})]}),i&&l&&c&&o.jsx($pe,{columnId:l,onResizeStart:c})]})}function $pe({columnId:e,onResizeStart:t}){return o.jsx("div",{className:"absolute top-0 right-0 w-2 h-full cursor-col-resize group/resize z-10 select-none",onMouseDown:r=>t(r,e),onClick:r=>r.stopPropagation(),role:"separator","aria-orientation":"vertical","aria-label":`Resize ${e} column`,"data-testid":`column-resize-handle-${e}`,children:o.jsx("div",{className:"absolute right-0 top-0 w-[2px] h-full bg-transparent group-hover/resize:bg-[var(--color-primary)] transition-colors"})})}function Frt({groups:e,entityNameMap:t,onStart:r,onComplete:n,onReopen:a,onSelectTask:s,pendingStart:i,pendingComplete:l,pendingReopen:c,collapsedGroups:u,onToggleCollapse:d,searchQuery:f,sortField:m,sortDirection:p,onSortChange:v,selectedTaskIds:b,onToggleSelect:y,allPageSelected:S,somePageSelected:_,onToggleSelectAll:N,columnWidths:k,onColumnResizeStart:j}){const E=e.length>1||e.length===1&&e[0].key!=="all",T=uC;return o.jsx("div",{className:"border border-[var(--color-border)] rounded-lg overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",style:{tableLayout:"fixed"},"data-testid":"tasks-table",children:[o.jsx("colgroup",{children:T.map(O=>o.jsx("col",{style:{width:`${k[O.id]??O.defaultWidth}px`,minWidth:`${O.minWidth}px`}},O.id))}),o.jsx("thead",{className:"bg-[var(--color-surface-elevated)]",children:o.jsxs("tr",{className:"border-b border-[var(--color-border)]",children:[o.jsx("th",{className:"pl-4 pr-1 py-3",style:{width:`${k.checkbox??40}px`},children:o.jsx("input",{type:"checkbox",checked:S,ref:O=>{O&&(O.indeterminate=_&&!S)},onChange:N,className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)] cursor-pointer","data-testid":"task-select-all-checkbox","aria-label":"Select all tasks"})}),o.jsx(sp,{label:"Task",field:"title",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.title,resizable:!0,columnId:"title",onResizeStart:j}),o.jsx(sp,{label:"Status",field:"status",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.status,resizable:!0,columnId:"status",onResizeStart:j}),o.jsx(sp,{label:"Priority",field:"priority",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.priority,resizable:!0,columnId:"priority",onResizeStart:j}),o.jsx(sp,{label:"Type",field:"taskType",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.taskType,resizable:!0,columnId:"taskType",onResizeStart:j}),o.jsx(sp,{label:"Assignee",field:"assignee",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.assignee,resizable:!0,columnId:"assignee",onResizeStart:j}),o.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wider relative",style:{width:`${k.branch??160}px`},children:["Branch",o.jsx($pe,{columnId:"branch",onResizeStart:j})]}),o.jsx(sp,{label:"Updated",field:"updated_at",currentSortField:m,currentSortDirection:p,onSortChange:v,width:k.updatedAt,resizable:!0,columnId:"updatedAt",onResizeStart:j}),o.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wider",style:{width:`${k.actions??100}px`},children:"Actions"})]})}),o.jsx("tbody",{className:"bg-[var(--color-surface)]",children:e.map(O=>o.jsx(Urt,{group:O,entityNameMap:t,onStart:r,onComplete:n,onReopen:a,onSelectTask:s,pendingStart:i,pendingComplete:l,pendingReopen:c,showHeader:E,isCollapsed:u.has(O.key),onToggleCollapse:()=>d(O.key),searchQuery:f,selectedTaskIds:b,onToggleSelect:y},O.key))})]})})})}function Urt({group:e,entityNameMap:t,onStart:r,onComplete:n,onReopen:a,onSelectTask:s,pendingStart:i,pendingComplete:l,pendingReopen:c,showHeader:u,isCollapsed:d,onToggleCollapse:f,searchQuery:m,selectedTaskIds:p,onToggleSelect:v}){return o.jsxs(o.Fragment,{children:[u&&o.jsx("tr",{className:"bg-[var(--color-surface-elevated)] border-t border-b border-[var(--color-border)]",children:o.jsx("td",{colSpan:9,children:o.jsxs("button",{onClick:f,className:"w-full px-4 py-2 flex items-center gap-2 text-sm font-medium text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]",children:[d?o.jsx(gn,{className:"w-4 h-4"}):o.jsx(Yt,{className:"w-4 h-4"}),o.jsx("span",{className:e.color?`px-2 py-0.5 rounded text-xs ${e.color}`:"",children:e.label}),o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:["(",e.tasks.length,")"]})]})})}),!d&&e.tasks.map(b=>{const y=m?QZe(b.title,m):null;return o.jsx(ZXe,{task:b,assigneeName:b.assignee?t.get(b.assignee):void 0,onStart:()=>r(b.id),onComplete:()=>n(b.id),onReopen:()=>a(b.id),onClick:()=>s(b.id),isStarting:i.has(b.id),isCompleting:l.has(b.id),isReopening:c.has(b.id),highlightedTitle:y?.indices?JZe(b.title,y.indices):void 0,isSelected:p.has(b.id),onToggleSelect:v},b.id)})]})}function Hrt({searchQuery:e,currentTab:t,onCreateClick:r}){if(e)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(xr,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"No matching tasks"}),o.jsxs("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:['No tasks found matching "',e,'". Try a different search term.']})]});const n={all:{title:"No tasks yet",description:"Create your first task to get started. Tasks can be assigned to agents and tracked through completion."},backlog:{title:"No backlog tasks",description:"No tasks are currently in the backlog. Create a task with backlog status to see it here."},unassigned:{title:"No unassigned tasks",description:"All tasks have been assigned to agents. Create a new task or unassign an existing one."},assigned:{title:"No assigned tasks",description:"No tasks are currently assigned and waiting to start. Assign a task to an agent to see it here."},in_progress:{title:"No tasks in progress",description:"No agents are currently working on tasks. Start a task to see it here."},closed:{title:"No completed tasks",description:"No tasks have been completed yet. Keep working on those tasks!"},awaiting_merge:{title:"No tasks awaiting merge",description:"No completed tasks are waiting to be merged. Completed task branches will appear here."}},{title:a,description:s}=n[t];return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(Tl,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:a}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:s}),t==="all"&&o.jsxs("button",{onClick:r,className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"tasks-create-empty",children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Task"]})]})}function GP({title:e,icon:t,iconColor:r="text-blue-500",count:n,totalCount:a,subtitle:s,actions:i=[],children:l,testId:c,bordered:u=!1,className:d=""}){const f=jo(),m=()=>n===void 0?null:a!==void 0&&a!==n?o.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:[n," of ",a]}):o.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:["(",n,")"]}),p=()=>i.length===0?null:o.jsx("div",{className:"flex items-center gap-2",children:i.map((b,y)=>{const S=b.icon,_=b.variant!=="secondary";return o.jsxs("button",{onClick:b.onClick,className:`inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-md transition-colors touch-target ${_?"text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)]":"text-[var(--color-text)] bg-[var(--color-surface-hover)] hover:bg-[var(--color-border)]"}`,"data-testid":b.testId,children:[S&&o.jsx(S,{className:"w-4 h-4"}),o.jsx("span",{className:f&&b.shortLabel?"hidden sm:inline":"",children:b.label}),f&&b.shortLabel&&o.jsx("span",{className:"sm:hidden",children:b.shortLabel}),b.shortcut&&!f&&o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:b.shortcut})]},y)})}),v=u?`border-b border-[var(--color-border)] bg-[var(--color-surface)] ${f?"p-3":"p-4"} ${d}`:`mb-4 sm:mb-6 ${d}`;return o.jsxs("div",{"data-testid":c,className:v,children:[o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t&&o.jsx(t,{className:`w-5 h-5 sm:w-6 sm:h-6 ${r} flex-shrink-0`}),o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-[var(--color-text)] truncate",children:e}),!f&&m()]})]}),p()]}),f&&n!==void 0&&o.jsx("div",{className:"mt-1",children:m()}),s&&o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)]",children:s}),l&&o.jsx("div",{className:u?"mt-3":"mt-3 sm:mt-4",children:l})]})}function qrt(){const e=tl({from:"/plans"}),t=Ma(),r=jo(),{currentUser:n}=rl(),[a,s]=w.useState(()=>N6e()),[i,l]=w.useState(()=>k6e()),[c,u]=w.useState(i),[d,f]=w.useState(!1),[m,p]=w.useState(!1);w.useEffect(()=>{e.action==="create"&&(f(!0),t({to:"/plans",search:{selected:e.selected,status:e.status},replace:!0}))},[e.action,e.selected,e.status,t]);const v=e.status||null,{data:b=[],isLoading:y,isError:S,error:_,refetch:N}=E6e(v||void 0),k=w.useCallback(I=>{s(I),C6e(I)},[]),j=w.useCallback(I=>{l(I),_6e(I)},[]);w.useEffect(()=>{const I=setTimeout(()=>{u(i)},S6e);return()=>clearTimeout(I)},[i]);const E=w.useMemo(()=>c?b.filter(I=>{const B=ZY(I.title,c);return B&&B.matched}):b,[b,c]),T=w.useCallback(I=>c?ZY(I,c)?.indices||[]:[],[c]),O=w.useCallback(I=>{t({to:"/plans",search:{selected:I,status:e.status??void 0}})},[t,e.status]),R=w.useCallback(()=>{t({to:"/plans",search:{selected:void 0,status:e.status??void 0}})},[t,e.status]),H=w.useCallback(I=>{t({to:"/plans",search:{status:I??void 0,selected:void 0}})},[t]),$=w.useCallback(()=>{j("")},[j]),L=w.useCallback(I=>{O(I.id)},[O]),A=w.useCallback(I=>{fetch(`/api/tasks/${I}`).then(B=>B.json()).then(B=>{const F=B.task||B;tQ({id:F.id,title:F.title}),Gr.success("Task created and added to selection")}).catch(()=>{tQ({id:I,title:"New Task"})}),p(!1)},[]),M=e.selected||null,P=M&&!r;return S?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[o.jsx(Rt,{className:"w-12 h-12 text-red-400 mb-4"}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Failed to load plans"}),o.jsx("p",{className:"text-[var(--color-text-secondary)] mt-1",children:_?.message||"An unknown error occurred"}),o.jsx("button",{onClick:()=>N(),className:"mt-4 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:"Retry"})]}):o.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[o.jsx(GP,{title:"Plans",icon:tu,iconColor:"text-blue-500",count:E.length,totalCount:b.length!==E.length?b.length:void 0,bordered:!0,actions:[{label:"Create Plan",shortLabel:"Create",icon:dr,onClick:()=>f(!0),shortcut:zl("action.createPlan"),testId:"create-plan-btn"}],testId:"plans-header",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx(F6e,{value:i,onChange:j,onClear:$}),o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsx("div",{className:r?"overflow-x-auto -mx-3 px-3 scrollbar-hide flex-1":"",children:o.jsx(B6e,{selectedStatus:v,onStatusChange:H})}),!r&&o.jsx($6e,{view:a,onViewChange:k})]})]})}),o.jsxs("div",{className:"flex-1 flex min-h-0",children:[o.jsx("div",{className:`flex-1 overflow-hidden ${P?"hidden lg:block":""}`,children:y?o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx(Pe,{className:"w-8 h-8 animate-spin text-blue-500"})}):E.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center",children:[o.jsx(tu,{className:"w-12 h-12 text-gray-300 mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:c?"No plans found":"No plans yet"}),o.jsx("p",{className:"text-[var(--color-text-secondary)] mt-1",children:c?"Try adjusting your search or filters":"Create your first plan to get started"}),!c&&o.jsxs("button",{onClick:()=>f(!0),className:"mt-4 inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Plan"]})]}):a==="roadmap"&&!r?o.jsx("div",{className:"h-full p-4",children:o.jsx(G6e,{plans:E,onPlanClick:O,selectedPlanId:M})}):o.jsx("div",{className:"h-full overflow-y-auto",children:r?o.jsx("div",{children:E.map(I=>o.jsx(Z6e,{plan:I,isSelected:M===I.id,onClick:()=>O(I.id),searchMatchIndices:T(I.title)},I.id))}):o.jsx("div",{className:"p-4 space-y-3",children:E.map(I=>o.jsx(U6e,{plan:I,isSelected:M===I.id,onClick:O,searchMatchIndices:T(I.title)},I.id))})})}),P&&M&&o.jsx("div",{className:"w-96 flex-shrink-0 border-l border-[var(--color-border)] overflow-hidden",children:o.jsx(Y6e,{planId:M,onClose:R,taskLinkBase:"/tasks",onRemoveTaskNotAllowed:()=>Gr.error("Cannot remove the last task. Plans must have at least one task."),onDeleteSuccess:()=>{Gr.success("Plan deleted successfully"),R()},onDeleteError:I=>Gr.error(I)})})]}),o.jsx(X6e,{isOpen:d,onClose:()=>f(!1),onSuccess:L,currentUserId:n?.id,isMobile:r,onToastSuccess:I=>Gr.success(I),onToastError:I=>Gr.error(I),onCreateNewTask:()=>p(!0)}),o.jsx(spe,{isOpen:m,onClose:()=>p(!1),onSuccess:A})]})}const JX={running:{label:"Running",color:"text-[var(--color-success-text)]",bgColor:"bg-[var(--color-success-muted)]",icon:nu},idle:{label:"Idle",color:"text-[var(--color-text-secondary)]",bgColor:"bg-[var(--color-surface-elevated)]",icon:nu},suspended:{label:"Suspended",color:"text-[var(--color-warning-text)]",bgColor:"bg-[var(--color-warning-muted)]",icon:sse},terminated:{label:"Stopped",color:"text-[var(--color-text-tertiary)]",bgColor:"bg-[var(--color-surface)]",icon:uu},starting:{label:"Starting",color:"text-[var(--color-info-text)]",bgColor:"bg-[var(--color-info-muted)]",icon:Pe},unknown:{label:"Unknown",color:"text-[var(--color-text-muted)]",bgColor:"bg-[var(--color-surface)]",icon:Rt}};function Wrt({status:e,size:t="md",showLabel:r=!0}){const n=JX[e??"unknown"]??JX.unknown,a=n.icon,s=e==="running"||e==="starting",i=t==="sm"?"w-2.5 h-2.5":"w-3 h-3",l=t==="sm"?"text-xs":"text-sm",c=t==="sm"?"px-1.5 py-0.5":"px-2 py-1";return o.jsxs("span",{className:`inline-flex items-center gap-1.5 ${c} rounded-full ${n.bgColor} ${n.color} ${l} font-medium`,"data-testid":`agent-status-${e??"unknown"}`,children:[o.jsx(a,{className:`${i} ${s?e==="running"?"fill-current":"animate-spin":""}`}),r&&o.jsx("span",{children:n.label})]})}const Krt={director:{label:"Director",color:"text-[var(--color-primary)]",bgColor:"bg-[var(--color-primary-muted)]",icon:zx},worker:{label:"Worker",color:"text-[var(--color-info-text)]",bgColor:"bg-[var(--color-info-muted)]",icon:Zo},steward:{label:"Steward",color:"text-[var(--color-accent-text)]",bgColor:"bg-[var(--color-accent-muted)]",icon:Al}},Grt={ephemeral:{label:"Ephemeral",icon:Sl},persistent:{label:"Persistent",icon:Vr}},Vrt={merge:{label:"Merge",icon:Vr},docs:{label:"Docs",icon:Vr},recovery:{label:"Recovery",icon:Vr},custom:{label:"Custom",icon:Vr}};function Yrt({role:e,workerMode:t,stewardFocus:r,size:n="md"}){const a=Krt[e];let s=a.icon,i=null;if(e==="worker"&&t){const d=Grt[t];s=d.icon,i=d.label}e==="steward"&&r&&(i=Vrt[r].label);const l=n==="sm"?"w-3 h-3":"w-4 h-4",c=n==="sm"?"text-xs":"text-sm",u=n==="sm"?"px-1.5 py-0.5":"px-2 py-1";return o.jsxs("span",{className:`inline-flex items-center gap-1.5 ${u} rounded-md ${a.bgColor} ${a.color} ${c} font-medium`,"data-testid":`agent-role-${e}`,children:[o.jsx(s,{className:l}),o.jsx("span",{children:a.label}),i&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["(",i,")"]})]})}function Fpe(e,t="sm"){const r=t==="sm"?"w-3 h-3":"w-4 h-4";switch(e){case"agent":return o.jsx(Vr,{className:r});case"human":return o.jsx(tn,{className:r});case"system":return o.jsx(Id,{className:r});default:return o.jsx(tn,{className:r})}}function Upe(e){switch(e){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}}function Qrt({item:e,isSelected:t,onSelect:r}){const n=e.status==="unread",a=e.sender?.name??"Unknown",s=e.sender?.entityType??"agent",l=(e.message?.contentPreview??"").split(`
`)[0]?.slice(0,60)||"";return o.jsxs("button",{onClick:r,className:`w-full text-left px-3 py-2.5 flex items-start gap-2.5 transition-colors border-b border-gray-100 dark:border-gray-800 ${t?"bg-blue-50 dark:bg-blue-900/20 border-l-2 border-l-blue-500":n?"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800/50":"bg-gray-50/50 dark:bg-gray-900/50 hover:bg-gray-100/50 dark:hover:bg-gray-800/30"}`,children:[o.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0 ${Upe(s)}`,children:Fpe(s,"sm")}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("span",{className:`text-sm truncate ${n?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"}`,children:a}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:bme(e.createdAt)}),n&&o.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[o.jsx("span",{className:`inline-flex items-center gap-0.5 px-1 py-0.5 text-[10px] font-medium rounded ${e.sourceType==="mention"?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.sourceType==="mention"?o.jsx(q6,{className:"w-2.5 h-2.5"}):o.jsx(oi,{className:"w-2.5 h-2.5"})}),l&&o.jsx("p",{className:`text-xs truncate ${n?"text-gray-600 dark:text-gray-400":"text-gray-500 dark:text-gray-500"}`,children:l})]})]})]})}function Jrt({item:e,onMarkRead:t,onMarkUnread:r,onArchive:n,onRestore:a,isPending:s}){const i=e.status==="unread",l=e.status==="archived",c=e.sender?.name??"Unknown",u=e.sender?.entityType??"agent",d=e.channel?.name??"Unknown channel",f=e.message?.fullContent??e.message?.contentPreview??"";return o.jsxs("div",{className:"h-full flex flex-col bg-white dark:bg-gray-900",children:[o.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${Upe(u)}`,children:Fpe(u,"md")}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:c}),o.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("span",{children:["#",d]}),o.jsx("span",{children:""}),o.jsx("span",{className:`inline-flex items-center gap-0.5 px-1 py-0.5 font-medium rounded ${e.sourceType==="mention"?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"}`,children:e.sourceType==="mention"?o.jsxs(o.Fragment,{children:[o.jsx(q6,{className:"w-2.5 h-2.5"}),"Mention"]}):o.jsxs(o.Fragment,{children:[o.jsx(oi,{className:"w-2.5 h-2.5"}),"Direct"]})})]})]})]}),o.jsx("div",{className:"flex items-center gap-0.5",children:s?o.jsx(Pe,{className:"w-4 h-4 animate-spin text-gray-400"}):l?o.jsx("button",{onClick:a,className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors",title:"Restore",children:o.jsx(jr,{className:"w-4 h-4"})}):o.jsxs(o.Fragment,{children:[i?o.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",title:"Mark as read",children:o.jsx(ZC,{className:"w-4 h-4"})}):o.jsx("button",{onClick:r,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",title:"Mark as unread",children:o.jsx(JC,{className:"w-4 h-4"})}),o.jsx("button",{onClick:n,className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded transition-colors",title:"Archive",children:o.jsx(H6,{className:"w-4 h-4"})})]})})]}),o.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:tJe(e.createdAt)})]}),o.jsx("div",{className:"flex-1 overflow-auto p-3",children:o.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:f||o.jsx("span",{className:"text-gray-400 italic",children:"No content"})})})]})}function Zrt({view:e}){const t={unread:{title:"No unread messages",subtitle:"All caught up!"},all:{title:"No messages",subtitle:"This agent has no messages yet"},archived:{title:"No archived messages",subtitle:"Archive messages to see them here"}};return o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 dark:text-gray-500 p-6",children:[o.jsx(ni,{className:"w-10 h-10 mb-2"}),o.jsx("p",{className:"text-sm font-medium",children:t[e].title}),o.jsx("p",{className:"text-xs mt-1",children:t[e].subtitle})]})}function Xrt({isOpen:e,onClose:t,agentId:r,agentName:n}){const[a,s]=w.useState("unread"),[i,l]=w.useState(null),{data:c,isLoading:u,error:d,refetch:f}=gme(r,a),{data:m}=AB(r),p=eJe(r),v=vme(r),b=c?.items.find(E=>E.id===i),y=m?.count??0,S=E=>{p.mutate({itemId:E,status:"read"})},_=E=>{p.mutate({itemId:E,status:"unread"})},N=E=>{p.mutate({itemId:E,status:"archived"}),i===E&&l(null)},k=E=>{p.mutate({itemId:E,status:"read"})},j=()=>{v.mutate()};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/30 z-40",onClick:t}),o.jsxs("div",{className:"fixed inset-y-0 right-0 w-full max-w-2xl bg-white dark:bg-gray-900 shadow-xl z-50 flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ni,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:["Inbox: ",n]}),y>0&&o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[y," unread message",y!==1?"s":""]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[y>0&&o.jsx("button",{onClick:j,disabled:v.isPending,className:"text-xs px-2 py-1 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors disabled:opacity-50",children:v.isPending?"Marking...":"Mark all read"}),o.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded transition-colors",children:o.jsx(yt,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"flex items-center gap-1 px-4 py-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[["unread","all","archived"].map(E=>o.jsxs("button",{onClick:()=>{s(E),l(null)},className:`px-3 py-1.5 text-xs font-medium rounded transition-colors ${a===E?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[E==="unread"?"Unread":E==="all"?"All":"Archived",E==="unread"&&y>0&&o.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-[10px] bg-blue-500 text-white rounded-full",children:y})]},E)),o.jsx("button",{onClick:()=>f(),className:"ml-auto p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Refresh",children:o.jsx(jr,{className:`w-4 h-4 ${u?"animate-spin":""}`})})]}),o.jsx("div",{className:"flex-1 flex overflow-hidden",children:d?o.jsx("div",{className:"flex-1 flex items-center justify-center text-red-500 dark:text-red-400 p-6",children:o.jsxs("p",{className:"text-sm",children:["Failed to load inbox: ",d.message]})}):u?o.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:o.jsx(Pe,{className:"w-6 h-6 animate-spin"})}):c?.items.length?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-2/5 border-r border-gray-200 dark:border-gray-700 overflow-y-auto",children:c.items.map(E=>o.jsx(Qrt,{item:E,isSelected:i===E.id,onSelect:()=>l(E.id)},E.id))}),o.jsx("div",{className:"flex-1 overflow-hidden",children:b?o.jsx(Jrt,{item:b,onMarkRead:()=>S(b.id),onMarkUnread:()=>_(b.id),onArchive:()=>N(b.id),onRestore:()=>k(b.id),isPending:p.isPending}):o.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-500",children:[o.jsx(gn,{className:"w-8 h-8 mb-2"}),o.jsx("p",{className:"text-sm",children:"Select a message to view"})]})})]}):o.jsx(Zrt,{view:a})})]})]}):null}const VP={claude:"Claude Code",opencode:"OpenCode",codex:"Codex"};function I2(e){return VP[e]??e}function ent({isOpen:e,onClose:t,agentId:r,currentProvider:n,onSuccess:a}){const[s,i]=w.useState(n),[l,c]=w.useState(null),u=YQe(),{data:d,isLoading:f}=g2();if(w.useEffect(()=>{e&&(i(n),c(null))},[e,n]),!e)return null;const m=()=>{c(null),t()},p=async b=>{if(b.preventDefault(),c(null),s===n){m();return}try{await u.mutateAsync({agentId:r,provider:s}),a?.(),m()}catch(y){c(y instanceof Error?y.message:"Failed to change provider")}},v=d?.providers??[];return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:m,"data-testid":"change-provider-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-sm
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"change-provider-dialog",role:"dialog","aria-labelledby":"change-provider-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"change-provider-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Change Provider"}),o.jsx("button",{onClick:m,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"change-provider-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:p,className:"p-4 space-y-4",children:[l&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),l]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-provider",className:"text-sm font-medium text-[var(--color-text)]",children:"Provider"}),f?o.jsxs("div",{className:"flex items-center gap-2 py-2 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Loading providers..."]}):o.jsx("select",{id:"agent-provider",value:s,onChange:b=>i(b.target.value),className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":"change-provider-select",children:v.map(b=>o.jsxs("option",{value:b.name,disabled:!b.available,children:[I2(b.name),b.available?"":" (not installed)"]},b.name))})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:m,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-provider-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u.isPending||s===n,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-provider-submit",children:u.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Changing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(tj,{className:"w-4 h-4"}),"Change"]})})]})]})]})})]})}function tnt({isOpen:e,onClose:t,agentId:r,currentModel:n,currentProvider:a,onSuccess:s}){const[i,l]=w.useState(n??""),[c,u]=w.useState(null),d=QQe(),{data:f,isLoading:m,error:p}=v2(a);if(w.useEffect(()=>{e&&(l(n??""),u(null))},[e,n]),!e)return null;const v=()=>{u(null),t()},b=async j=>{if(j.preventDefault(),u(null),i===(n??"")){v();return}try{await d.mutateAsync({agentId:r,model:i||null}),s?.(),v()}catch(T){u(T instanceof Error?T.message:"Failed to change model")}},y=f?.models??[],S=y.find(j=>j.isDefault),_=y.filter(j=>!j.isDefault),k=i!==(n??"");return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:v,"data-testid":"change-model-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-sm
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"change-model-dialog",role:"dialog","aria-labelledby":"change-model-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"change-model-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Change Model"}),o.jsx("button",{onClick:v,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"change-model-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:b,className:"p-4 space-y-4",children:[c&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),c]}),p&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-amber-700 dark:text-amber-300 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),"Failed to load models. Try again later."]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-model",className:"text-sm font-medium text-[var(--color-text)]",children:"Model"}),m?o.jsxs("div",{className:"flex items-center gap-2 py-2 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Loading models..."]}):o.jsxs("select",{id:"agent-model",value:i,onChange:j=>l(j.target.value),className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":"change-model-select",children:[o.jsx("option",{value:"",children:S?`Default (${S.displayName})`:"(Default)"}),_.map(j=>o.jsx("option",{value:j.id,children:j.providerName?`${j.displayName}    ${j.providerName}`:j.displayName},j.id))]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Select a model or use the provider's default."})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:v,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-model-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:d.isPending||!k||m,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-model-submit",children:d.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Changing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Wa,{className:"w-4 h-4"}),"Change"]})})]})]})]})})]})}const Hpe=[{value:0,label:"Sunday",short:"Sun"},{value:1,label:"Monday",short:"Mon"},{value:2,label:"Tuesday",short:"Tue"},{value:3,label:"Wednesday",short:"Wed"},{value:4,label:"Thursday",short:"Thu"},{value:5,label:"Friday",short:"Fri"},{value:6,label:"Saturday",short:"Sat"}],rnt=[{value:"minutely",label:"Minutes",description:"Runs every N minutes"},{value:"hourly",label:"Hourly",description:"Runs every N hours"},{value:"daily",label:"Daily",description:"Runs every N days"},{value:"weekly",label:"Weekly",description:"Runs once every week"},{value:"monthly",label:"Monthly",description:"Runs once every month"},{value:"custom",label:"Custom",description:"Write a cron expression directly"}],IL={minutely:[1,2,3,5,10,15,20,30],hourly:[1,2,3,4,6,8,12],daily:[1,2,3,5,7,10,14,30]};function ZX(e){const t=e.trim().split(/\s+/);if(t.length<5||t.length>6)return!1;const r=/^(\*|\d+(-\d+)?(,\d+(-\d+)?)*)(\/\d+)?$/;return t.every(n=>r.test(n)||n==="*")}function US(e){const t=e.interval??1;switch(e.frequency){case"minutely":return t>1?`*/${t} * * * *`:"* * * * *";case"hourly":return t>1?`${e.minute} */${t} * * *`:`${e.minute} * * * *`;case"daily":return t>1?`${e.minute} ${e.hour} */${t} * *`:`${e.minute} ${e.hour} * * *`;case"weekly":return`${e.minute} ${e.hour} * * ${e.dayOfWeek}`;case"monthly":return`${e.minute} ${e.hour} ${e.dayOfMonth} * *`;case"custom":return""}}function XX(e){const t=e.trim().split(/\s+/);if(t.length!==5)return null;const[r,n,a,s,i]=t,l=m=>/^\d+$/.test(m),c=m=>m==="*",u=m=>/^\*\/\d+$/.test(m),d=m=>parseInt(m,10),f=m=>d(m.split("/")[1]);return u(r)&&c(n)&&c(a)&&c(s)&&c(i)?{frequency:"minutely",interval:f(r),minute:0,hour:0,dayOfWeek:1,dayOfMonth:1}:c(r)&&c(n)&&c(a)&&c(s)&&c(i)?{frequency:"minutely",interval:1,minute:0,hour:0,dayOfWeek:1,dayOfMonth:1}:l(r)&&u(n)&&c(a)&&c(s)&&c(i)?{frequency:"hourly",interval:f(n),minute:d(r),hour:0,dayOfWeek:1,dayOfMonth:1}:l(r)&&c(n)&&c(a)&&c(s)&&c(i)?{frequency:"hourly",interval:1,minute:d(r),hour:0,dayOfWeek:1,dayOfMonth:1}:l(r)&&l(n)&&u(a)&&c(s)&&c(i)?{frequency:"daily",interval:f(a),minute:d(r),hour:d(n),dayOfWeek:1,dayOfMonth:1}:l(r)&&l(n)&&c(a)&&c(s)&&c(i)?{frequency:"daily",interval:1,minute:d(r),hour:d(n),dayOfWeek:1,dayOfMonth:1}:l(r)&&l(n)&&c(a)&&c(s)&&l(i)?{frequency:"weekly",interval:1,minute:d(r),hour:d(n),dayOfWeek:d(i),dayOfMonth:1}:l(r)&&l(n)&&l(a)&&c(s)&&c(i)?{frequency:"monthly",interval:1,minute:d(r),hour:d(n),dayOfWeek:1,dayOfMonth:d(a)}:null}function nnt(e){const t=e.trim().split(/\s+/);if(t.length<5||t.length>6)return"Invalid cron expression";const[r,n,a,s,i]=t.length===6?t.slice(1):t,l=b=>b==="*",c=b=>/^\d+$/.test(b),u=b=>parseInt(b,10),d=(b,y)=>{const S=b>=12?"PM":"AM";return`${b===0?12:b>12?b-12:b}:${y.toString().padStart(2,"0")} ${S}`},f=b=>Hpe[b%7]?.label??`day ${b}`,m=b=>{const y=["th","st","nd","rd"],S=b%100;return b+(y[(S-20)%10]||y[S]||y[0])},p=b=>b.startsWith("*/"),v=b=>u(b.split("/")[1]);if(p(r)&&l(n)&&l(a)&&l(s)&&l(i)){const b=v(r);return`Every ${b} minute${b===1?"":"s"}`}if(l(r)&&l(n)&&l(a)&&l(s)&&l(i))return"Every minute";if(c(r)&&p(n)&&l(a)&&l(s)&&l(i)){const b=v(n),y=u(r),S=`Every ${b} hour${b===1?"":"s"}`;return y===0?S:`${S} at minute ${y}`}if(c(r)&&l(n)&&l(a)&&l(s)&&l(i)){const b=u(r);return b===0?"Every hour, on the hour":`Every hour at minute ${b}`}if(c(r)&&c(n)&&p(a)&&l(s)&&l(i)){const b=v(a);return`Every ${b} day${b===1?"":"s"} at ${d(u(n),u(r))}`}return c(r)&&c(n)&&l(a)&&l(s)&&l(i)?`Every day at ${d(u(n),u(r))}`:c(r)&&c(n)&&l(a)&&l(s)&&c(i)?`Every ${f(u(i))} at ${d(u(n),u(r))}`:c(r)&&c(n)&&c(a)&&l(s)&&l(i)?`${m(u(a))} of every month at ${d(u(n),u(r))}`:`Custom schedule: ${e}`}const RL={frequency:"hourly",interval:1,minute:0,hour:9,dayOfWeek:1,dayOfMonth:1};function qpe({value:e,onChange:t,testIdPrefix:r="cron-builder"}){const[n,a]=w.useState("builder"),[s,i]=w.useState(RL),[l,c]=w.useState(e),[u,d]=w.useState(null);w.useEffect(()=>{const k=XX(e);k?(i(k),a("builder")):e&&e!==US(s)&&(c(e),e!=="0 * * * *"&&a("raw"))},[]);const f=w.useMemo(()=>US(s),[s]),m=w.useMemo(()=>{const k=n==="raw"?l:f;return k?nnt(k):""},[n,l,f]),p=w.useCallback(k=>{i(j=>{const E={...j,...k},T=US(E);return T&&t(T),E})},[t]),v=w.useCallback(k=>{c(k),ZX(k)?(d(null),t(k)):k.trim()?d("Invalid cron expression. Expected format: * * * * * (minute hour day month weekday)"):d(null)},[t]),b=w.useCallback(()=>{if(n==="builder")c(f),d(null),a("raw");else{const k=XX(l);k?(i(k),a("builder")):(i(RL),t(US(RL)),a("builder"))}},[n,f,l,t]),y=w.useMemo(()=>{const k=[];for(let j=0;j<60;j+=5)k.push(j);return k},[]),S=w.useMemo(()=>{const k=[];for(let j=0;j<24;j++)k.push(j);return k},[]),_=k=>{const j=k>=12?"PM":"AM";return`${k===0?12:k>12?k-12:k}:00 ${j}`},N=k=>`:${k.toString().padStart(2,"0")}`;return o.jsxs("div",{className:"space-y-2","data-testid":r,children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsx("button",{type:"button",onClick:b,className:"flex items-center gap-1.5 text-xs text-[var(--color-primary)] hover:text-[var(--color-primary-hover)] transition-colors","data-testid":`${r}-mode-toggle`,children:n==="builder"?o.jsxs(o.Fragment,{children:[o.jsx(Kp,{className:"w-3 h-3"}),"Use cron syntax"]}):o.jsxs(o.Fragment,{children:[o.jsx(Bx,{className:"w-3 h-3"}),"Use schedule builder"]})})}),n==="builder"?o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"flex flex-wrap gap-1",children:rnt.filter(k=>k.value!=="custom").map(k=>o.jsx("button",{type:"button",onClick:()=>{p({frequency:k.value,interval:1})},className:`
                  px-2.5 py-1 text-xs rounded-full border transition-all
                  ${s.frequency===k.value?"border-[var(--color-primary)] bg-[var(--color-primary-muted)] text-[var(--color-primary)] font-medium":"border-[var(--color-border)] text-[var(--color-text-secondary)] hover:border-[var(--color-border-hover)] hover:text-[var(--color-text)]"}
                `,"data-testid":`${r}-freq-${k.value}`,children:k.label},k.value))}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-[var(--color-text-secondary)]",children:[s.frequency==="minutely"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Every"}),o.jsx("select",{value:s.interval,onChange:k=>p({interval:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-interval`,children:IL.minutely.map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsxs("span",{children:["minute",s.interval===1?"":"s"]})]}),s.frequency==="hourly"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Every"}),o.jsx("select",{value:s.interval,onChange:k=>p({interval:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-interval`,children:IL.hourly.map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsxs("span",{children:["hour",s.interval===1?"":"s"," at minute"]}),o.jsx("select",{value:s.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]}),s.frequency==="daily"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Every"}),o.jsx("select",{value:s.interval,onChange:k=>p({interval:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-interval`,children:IL.daily.map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsxs("span",{children:["day",s.interval===1?"":"s"," at"]}),o.jsx("select",{value:s.hour,onChange:k=>p({hour:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-hour`,children:S.map(k=>o.jsx("option",{value:k,children:_(k)},k))}),o.jsx("select",{value:s.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]}),s.frequency==="weekly"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"on"}),o.jsx("select",{value:s.dayOfWeek,onChange:k=>p({dayOfWeek:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-day-of-week`,children:Hpe.map(k=>o.jsx("option",{value:k.value,children:k.label},k.value))}),o.jsx("span",{children:"at"}),o.jsx("select",{value:s.hour,onChange:k=>p({hour:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-hour`,children:S.map(k=>o.jsx("option",{value:k,children:_(k)},k))}),o.jsx("select",{value:s.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]}),s.frequency==="monthly"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"on day"}),o.jsx("select",{value:s.dayOfMonth,onChange:k=>p({dayOfMonth:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-day-of-month`,children:Array.from({length:31},(k,j)=>j+1).map(k=>o.jsx("option",{value:k,children:k},k))}),o.jsx("span",{children:"at"}),o.jsx("select",{value:s.hour,onChange:k=>p({hour:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-hour`,children:S.map(k=>o.jsx("option",{value:k,children:_(k)},k))}),o.jsx("select",{value:s.minute,onChange:k=>p({minute:parseInt(k.target.value,10)}),className:`
                    px-2 py-1 text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`${r}-minute`,children:y.map(k=>o.jsx("option",{value:k,children:N(k)},k))})]})]}),o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-[var(--color-surface)] border border-[var(--color-border)] rounded text-xs",children:[o.jsx(Rr,{className:"w-3 h-3 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsx("span",{className:"font-mono text-[var(--color-text-secondary)]",children:f}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:m})]})]}):o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("input",{type:"text",value:l,onChange:k=>v(k.target.value),placeholder:"0 * * * * (every hour)",className:`
              w-full px-2 py-1
              text-xs font-mono
              bg-[var(--color-bg)]
              border rounded
              focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
              ${u?"border-red-400 dark:border-red-600":"border-[var(--color-border)]"}
            `,"data-testid":`${r}-raw-input`}),u&&o.jsx("p",{className:"text-xs text-red-600 dark:text-red-400","data-testid":`${r}-raw-error`,children:u}),!u&&l.trim()&&ZX(l)&&o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-[var(--color-surface)] border border-[var(--color-border)] rounded text-xs",children:[o.jsx(Rr,{className:"w-3 h-3 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:m})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Format: minute (0-59) hour (0-23) day (1-31) month (1-12) weekday (0-6, Sun=0)"})]})]})}function ant({isOpen:e,onClose:t,agentId:r,currentTriggers:n,onSuccess:a}){const[s,i]=w.useState(n),[l,c]=w.useState(null),u=JQe();if(w.useEffect(()=>{e&&(i(n.length>0?[...n]:[]),c(null))},[e,n]),!e)return null;const d=()=>{c(null),t()},f=()=>{i(S=>[...S,{type:"cron",schedule:"0 * * * *"}])},m=()=>{i(S=>[...S,{type:"event",event:"task_completed"}])},p=(S,_)=>{i(N=>N.map((k,j)=>j===S?_:k))},v=S=>{i(_=>_.filter((N,k)=>k!==S))},b=JSON.stringify(s)!==JSON.stringify(n),y=async S=>{S.preventDefault(),c(null);for(const _ of s){if(_.type==="cron"&&!_.schedule.trim()){c("Cron trigger requires a schedule");return}if(_.type==="event"&&!_.event.trim()){c("Event trigger requires an event name");return}}if(!b){d();return}try{await u.mutateAsync({agentId:r,triggers:s}),a?.(),d()}catch(_){c(_ instanceof Error?_.message:"Failed to update triggers")}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:d,"data-testid":"change-triggers-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-md
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
            max-h-[80vh] flex flex-col
          `,"data-testid":`agent-change-triggers-${r}`,role:"dialog","aria-labelledby":"change-triggers-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"change-triggers-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Change Triggers"}),o.jsx("button",{onClick:d,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"change-triggers-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:y,className:"flex-1 overflow-y-auto p-4 space-y-4",children:[l&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),l]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Triggers"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsxs("button",{type:"button",onClick:f,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"change-triggers-add-cron",children:[o.jsx(Rr,{className:"w-3 h-3"}),"Cron"]}),o.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"change-triggers-add-event",children:[o.jsx(Sl,{className:"w-3 h-3"}),"Event"]})]})]}),s.length===0?o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No triggers configured. Steward will only run manually."}):o.jsx("div",{className:"space-y-2",children:s.map((S,_)=>o.jsxs("div",{className:"flex items-start gap-2 p-2 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg","data-testid":`change-triggers-trigger-${_}`,children:[S.type==="cron"?o.jsxs("div",{className:"flex-1 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Rr,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Cron Schedule"})]}),o.jsx(qpe,{value:S.schedule,onChange:N=>p(_,{...S,schedule:N}),testIdPrefix:`change-triggers-trigger-${_}-schedule`})]}):o.jsxs("div",{className:"flex-1 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Sl,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Event"})]}),o.jsx("input",{type:"text",value:S.event,onChange:N=>p(_,{...S,event:N.target.value}),placeholder:"task_completed",className:`
                              w-full px-2 py-1
                              text-xs
                              bg-[var(--color-bg)]
                              border border-[var(--color-border)]
                              rounded
                              focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                            `,"data-testid":`change-triggers-trigger-${_}-event`}),o.jsx("input",{type:"text",value:S.condition??"",onChange:N=>p(_,{...S,condition:N.target.value||void 0}),placeholder:"Condition (optional)",className:`
                              w-full px-2 py-1
                              text-xs
                              bg-[var(--color-bg)]
                              border border-[var(--color-border)]
                              rounded
                              focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                            `,"data-testid":`change-triggers-trigger-${_}-condition`})]}),o.jsx("button",{type:"button",onClick:()=>v(_),className:"p-1 text-[var(--color-text-tertiary)] hover:text-red-500 transition-colors","aria-label":"Remove trigger","data-testid":`change-triggers-trigger-${_}-remove`,children:o.jsx(pr,{className:"w-4 h-4"})})]},_))})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:d,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-triggers-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u.isPending||!b,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"change-triggers-submit",children:u.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Rr,{className:"w-4 h-4"}),"Save"]})})]})]})]})})]})}function Pk({agent:e,activeSessionStatus:t,onStart:r,onStop:n,onRestart:a,onOpenTerminal:s,onRename:i,onDelete:l,isStarting:c,isStopping:u}){const[d,f]=w.useState(!1),[m,p]=w.useState(!1),[v,b]=w.useState(!1),[y,S]=w.useState(!1),[_,N]=w.useState(!1),k=w.useRef(null),{data:j}=AB(e.id),E=j?.count??0,T=e.metadata?.agent,O=t==="running"||t==="starting",R=!O&&!c,H=O&&!u;w.useEffect(()=>{if(!d)return;const A=M=>{k.current&&!k.current.contains(M.target)&&f(!1)};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[d]);const $=T?.agentRole==="worker"?T:null,L=T?.agentRole==="steward"?T:null;return o.jsxs("div",{className:"p-4 border border-[var(--color-border)] rounded-lg bg-[var(--color-surface)] hover:border-[var(--color-border-hover)] transition-colors duration-150","data-testid":`agent-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h3",{className:"font-semibold text-[var(--color-text)] truncate","data-testid":`agent-name-${e.id}`,children:e.name}),o.jsx(Wrt,{status:t??"idle",size:"sm",showLabel:!1})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[o.jsx(Yrt,{role:T?.agentRole??"worker",workerMode:$?.workerMode,stewardFocus:L?.stewardFocus,size:"sm"}),o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-[10px] font-medium rounded bg-[var(--color-surface-elevated)] text-[var(--color-text-tertiary)] border border-[var(--color-border)]","data-testid":`agent-provider-${e.id}`,children:I2(T?.provider||"claude").toLowerCase()}),T?.model&&o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-[10px] font-medium rounded bg-[var(--color-surface-elevated)] text-[var(--color-text-tertiary)] border border-[var(--color-border)]","data-testid":`agent-model-${e.id}`,children:T.model})]})]}),o.jsxs("div",{className:"relative",ref:k,children:[o.jsx("button",{onClick:()=>f(!d),className:"p-1.5 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-menu-${e.id}`,children:o.jsx(n0,{className:"w-4 h-4"})}),d&&o.jsxs("div",{className:`
                absolute right-0 top-full mt-1 z-20
                min-w-36 py-1 rounded-md shadow-lg
                bg-[var(--color-bg)] border border-[var(--color-border)]
              `,"data-testid":`agent-menu-dropdown-${e.id}`,children:[o.jsxs("button",{onClick:()=>{f(!1),i?.()},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-text-secondary)]
                  hover:bg-[var(--color-surface-hover)]
                  hover:text-[var(--color-text)]
                `,"data-testid":`agent-rename-${e.id}`,children:[o.jsx(Uh,{className:"w-3.5 h-3.5"}),"Rename agent"]}),o.jsxs("button",{onClick:()=>{f(!1),b(!0)},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-text-secondary)]
                  hover:bg-[var(--color-surface-hover)]
                  hover:text-[var(--color-text)]
                  whitespace-nowrap
                `,"data-testid":`agent-change-provider-${e.id}`,children:[o.jsx(tj,{className:"w-3.5 h-3.5"}),"Change provider"]}),o.jsxs("button",{onClick:()=>{f(!1),S(!0)},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-text-secondary)]
                  hover:bg-[var(--color-surface-hover)]
                  hover:text-[var(--color-text)]
                  whitespace-nowrap
                `,"data-testid":`agent-change-model-${e.id}`,children:[o.jsx(Wa,{className:"w-3.5 h-3.5"}),"Change model"]}),L&&o.jsxs("button",{onClick:()=>{f(!1),N(!0)},className:`
                    w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                    text-[var(--color-text-secondary)]
                    hover:bg-[var(--color-surface-hover)]
                    hover:text-[var(--color-text)]
                    whitespace-nowrap
                  `,"data-testid":`agent-change-triggers-${e.id}`,children:[o.jsx(Sl,{className:"w-3.5 h-3.5"}),"Change triggers"]}),o.jsxs("button",{onClick:()=>{f(!1),l?.()},className:`
                  w-full flex items-center gap-2 px-3 py-1.5 text-left text-sm
                  text-[var(--color-danger)]
                  hover:bg-[var(--color-surface-hover)]
                `,"data-testid":`agent-delete-${e.id}`,children:[o.jsx(pr,{className:"w-3.5 h-3.5"}),"Delete agent"]})]})]})]}),$?.branch&&o.jsxs("div",{className:"mt-3 flex items-center gap-1.5 text-sm text-[var(--color-text-secondary)]",children:[o.jsx(cu,{className:"w-3.5 h-3.5"}),o.jsx("span",{className:"truncate font-mono text-xs",children:$.branch})]}),L?.lastExecutedAt&&o.jsxs("div",{className:"mt-3 flex items-center gap-1.5 text-sm text-[var(--color-text-secondary)]",children:[o.jsx(Rr,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:["Last run: ",snt(L.lastExecutedAt)]})]}),o.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[R&&r&&o.jsx(Cn,{content:"Start agent",children:o.jsxs("button",{onClick:r,disabled:c,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-white bg-[var(--color-success)] rounded-md hover:bg-[var(--color-success-hover)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":`agent-start-${e.id}`,children:[o.jsx(Yr,{className:"w-3.5 h-3.5"}),c?"Starting...":"Start"]})}),H&&n&&o.jsx(Cn,{content:"Stop agent",children:o.jsxs("button",{onClick:n,disabled:u,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-[var(--color-danger-text)] bg-[var(--color-danger-muted)] rounded-md hover:bg-[var(--color-danger-muted-hover)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":`agent-stop-${e.id}`,children:[o.jsx(uu,{className:"w-3.5 h-3.5"}),u?"Stopping...":"Stop"]})}),O&&s&&o.jsx(Cn,{content:"Open in Workspace",children:o.jsxs("button",{onClick:s,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface-elevated)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-terminal-${e.id}`,children:[o.jsx(na,{className:"w-3.5 h-3.5"}),"Open"]})}),o.jsx(Cn,{content:E>0?`${E} unread messages`:"View inbox",children:o.jsxs("button",{onClick:()=>p(!0),className:"relative p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-inbox-${e.id}`,children:[o.jsx(ni,{className:"w-4 h-4"}),E>0&&o.jsx("span",{className:"absolute -top-0.5 -right-0.5 min-w-[14px] h-[14px] flex items-center justify-center text-[10px] font-medium text-white bg-blue-500 rounded-full px-0.5","data-testid":`agent-inbox-badge-${e.id}`,children:E>99?"99+":E})]})}),a&&o.jsx(Cn,{content:"Restart agent",children:o.jsx("button",{onClick:a,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`agent-restart-${e.id}`,children:o.jsx(jr,{className:"w-4 h-4"})})})]}),o.jsx(Xrt,{isOpen:m,onClose:()=>p(!1),agentId:e.id,agentName:e.name}),o.jsx(ent,{isOpen:v,onClose:()=>b(!1),agentId:e.id,currentProvider:T?.provider??"claude"}),o.jsx(tnt,{isOpen:y,onClose:()=>S(!1),agentId:e.id,currentModel:T?.model,currentProvider:T?.provider??"claude"}),L&&o.jsx(ant,{isOpen:_,onClose:()=>N(!1),agentId:e.id,currentTriggers:L.triggers??[]})]})}function snt(e){const r=Date.now()-e,n=Math.floor(r/1e3),a=Math.floor(n/60),s=Math.floor(a/60),i=Math.floor(s/24);return i>0?`${i}d ago`:s>0?`${s}h ago`:a>0?`${a}m ago`:"just now"}const eee={taskCompletion:!0,agentHealth:!0,mergeNotifications:!0,sound:!1,toastDuration:5e3},tee={worktreeDirectory:".stoneforge/.worktrees/",ephemeralRetention:"24h",defaultBranch:"main",autoMerge:!1},ree={mergeStewardEnabled:!0,docsStewardEnabled:!1},nee={defaultProvider:"claude",defaultModels:{}},aee="settings.theme",see="settings.notifications",iee="settings.workspace",oee="settings.stewardSchedules",lee="settings.agentDefaults";function R2(e,t){try{const r=localStorage.getItem(e);if(r)return{...t,...JSON.parse(r)}}catch{}return t}function P2(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}function int(){const[e,t]=w.useState(()=>{if(typeof window>"u")return"system";const s=localStorage.getItem(aee);return s==="light"||s==="dark"||s==="system"?s:"system"}),r=w.useCallback(s=>{const i=document.documentElement,l=window.matchMedia("(prefers-color-scheme: dark)").matches;i.classList.remove("dark","theme-dark","theme-light"),(s==="system"?l?"dark":"light":s)==="dark"?i.classList.add("dark","theme-dark"):i.classList.add("theme-light")},[]);w.useEffect(()=>{r(e),localStorage.setItem(aee,e)},[e,r]),w.useEffect(()=>{if(e!=="system")return;const s=window.matchMedia("(prefers-color-scheme: dark)"),i=()=>r("system");return s.addEventListener("change",i),()=>s.removeEventListener("change",i)},[e,r]);const n=w.useCallback(s=>{t(s)},[]),a=e==="system"?typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;return{theme:e,setTheme:n,resolvedTheme:a}}function ont(){const[e,t]=w.useState(()=>R2(see,eee));w.useEffect(()=>{P2(see,e)},[e]);const r=w.useCallback(a=>{t(s=>({...s,...a}))},[]),n=w.useCallback(()=>{t(eee)},[]);return{settings:e,setSettings:r,resetToDefaults:n}}function lnt(){const[e,t]=w.useState(()=>R2(iee,tee));w.useEffect(()=>{P2(iee,e)},[e]);const r=w.useCallback(a=>{t(s=>({...s,...a}))},[]),n=w.useCallback(()=>{t(tee)},[]);return{settings:e,setSettings:r,resetToDefaults:n}}function cnt(){const[e,t]=w.useState(()=>R2(oee,ree));w.useEffect(()=>{P2(oee,e)},[e]);const r=w.useCallback(a=>{t(s=>({...s,...a}))},[]),n=w.useCallback(()=>{t(ree)},[]);return{settings:e,setSettings:r,resetToDefaults:n}}function Wpe(){const[e,t]=w.useState(()=>R2(lee,nee));w.useEffect(()=>{P2(lee,e)},[e]);const r=w.useCallback(s=>{t(i=>({...i,...s}))},[]),n=w.useCallback((s,i)=>{t(l=>({...l,defaultModels:{...l.defaultModels,[s]:i}}))},[]),a=w.useCallback(()=>{t(nee)},[]);return{settings:e,setSettings:r,setDefaultModel:n,resetToDefaults:a}}function Kpe(){const e=int(),t=ont(),r=lnt(),n=cnt(),a=Wpe(),s={theme:e.theme,notifications:t.settings,workspace:r.settings,stewardSchedules:n.settings,agentDefaults:a.settings},i=w.useCallback(()=>{e.setTheme("system"),t.resetToDefaults(),r.resetToDefaults(),n.resetToDefaults(),a.resetToDefaults()},[e,t,r,n,a]);return{settings:s,theme:e,notifications:t,workspace:r,stewardSchedules:n,agentDefaults:a,resetAllToDefaults:i}}function unt(){const e=[];for(const[t,r]of Object.entries(ix))e.push({key:nm(r.keys),label:r.description||t,description:r.path?`Navigate to ${r.path.split("?")[0]}`:"Quick action",actionId:t});return e.push({key:"Esc",label:"Close dialog",description:"Close any open dialog or panel"},{key:"",label:"Navigate",description:"Navigate through lists and options"},{key:"Enter",label:"Select",description:"Select the current item or confirm action"},{key:"J/K",label:"Next/Previous",description:"Navigate items in inbox (vim-style)"}),e}unt();function Gpe(e){return e.type==="function"}const WB={pending:{label:"Pending",icon:Rr,color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-100 dark:bg-gray-900/30",borderColor:"border-gray-300 dark:border-gray-700"},running:{label:"Running",icon:Yr,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30",borderColor:"border-blue-300 dark:border-blue-700"},completed:{label:"Completed",icon:zs,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30",borderColor:"border-green-300 dark:border-green-700"},failed:{label:"Failed",icon:us,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30",borderColor:"border-red-300 dark:border-red-700"},cancelled:{label:"Cancelled",icon:VC,color:"text-yellow-600 dark:text-yellow-400",bgColor:"bg-yellow-100 dark:bg-yellow-900/30",borderColor:"border-yellow-300 dark:border-yellow-700"}},dnt=[{value:"task",label:"Task"},{value:"bug",label:"Bug"},{value:"feature",label:"Feature"},{value:"chore",label:"Chore"}],fnt=[{value:5,label:"5 - Critical"},{value:4,label:"4 - High"},{value:3,label:"3 - Medium"},{value:2,label:"2 - Low"},{value:1,label:"1 - Lowest"}],hnt=[{value:1,label:"1 - Trivial"},{value:2,label:"2 - Simple"},{value:3,label:"3 - Medium"},{value:4,label:"4 - Complex"},{value:5,label:"5 - Very Complex"}],mnt=[{value:"string",label:"String"},{value:"number",label:"Number"},{value:"boolean",label:"Boolean"}],pnt=[{value:"task",label:"Task",description:"Agent-executed task"},{value:"function",label:"Function",description:"Execute code directly"}],cee=[{value:"typescript",label:"TypeScript",description:"Execute TypeScript/JavaScript code"},{value:"python",label:"Python",description:"Execute Python code"},{value:"shell",label:"Shell",description:"Execute shell commands"}];function gnt(e){return WB[e]?.label??e}function uee(e){const t=WB[e];return t?`${t.color} ${t.bgColor}`:"text-gray-600 bg-gray-100"}function vnt(e){if(!e.startedAt)return;const t=new Date(e.startedAt).getTime(),n=(e.finishedAt?new Date(e.finishedAt).getTime():Date.now())-t;return n<1e3?`${n}ms`:n<6e4?`${Math.round(n/1e3)}s`:n<36e5?`${Math.round(n/6e4)}m`:`${Math.round(n/36e5)}h`}function dee(e){const t=Date.now(),r=new Date(e).getTime(),n=t-r,a=Math.floor(n/1e3),s=Math.floor(a/60),i=Math.floor(s/60),l=Math.floor(i/24);return a<60?"just now":s<60?`${s}m ago`:i<24?`${i}h ago`:l<7?`${l}d ago`:new Date(e).toLocaleDateString()}function PL(){return`step_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,6)}`}const bnt="/api";async function Wl(e,t){const r=await fetch(`${bnt}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!r.ok){const n=await r.json().catch(()=>({error:{message:"Unknown error"}}));throw new Error(n.error?.message||`HTTP ${r.status}`)}return r.json()}function ynt(e){const r=new URLSearchParams().toString(),n=r?`/workflows?${r}`:"/workflows";return pt({queryKey:["workflows",e],queryFn:()=>Wl(n),refetchInterval:1e4})}function xnt(e){return pt({queryKey:["workflow",e],queryFn:()=>Wl(`/workflows/${e}`),enabled:!!e})}function wnt(e){return pt({queryKey:["workflow-tasks",e],queryFn:()=>Wl(`/workflows/${e}/tasks`),enabled:!!e,refetchInterval:5e3})}function Snt(e){const t=xnt(e),r=wnt(e);return{workflow:t.data?.workflow,tasks:r.data?.tasks??[],progress:r.data?.progress??{total:0,completed:0,inProgress:0,blocked:0,open:0,percentage:0},dependencies:r.data?.dependencies??[],isLoading:t.isLoading||r.isLoading,error:t.error||r.error,refetch:async()=>{await t.refetch(),await r.refetch()}}}function knt(){const e=ft();return kt({mutationFn:async({workflowId:t,reason:r})=>Wl(`/workflows/${t}/cancel`,{method:"POST",body:JSON.stringify({reason:r})}),onSuccess:(t,{workflowId:r})=>{e.invalidateQueries({queryKey:["workflows"]}),e.invalidateQueries({queryKey:["workflow",r]})}})}function _nt(){const e=ft();return kt({mutationFn:async({workflowId:t})=>Wl(`/workflows/${t}`,{method:"DELETE"}),onSuccess:()=>{e.invalidateQueries({queryKey:["workflows"]})}})}function KB(e){const r=new URLSearchParams().toString(),n=r?`/playbooks?${r}`:"/playbooks";return pt({queryKey:["playbooks",e],queryFn:()=>Wl(n),refetchInterval:3e4})}function Vpe(e){return pt({queryKey:["playbook",e],queryFn:()=>Wl(`/playbooks/${e}`),enabled:!!e})}function Nnt(){const e=ft();return kt({mutationFn:async t=>Wl("/playbooks",{method:"POST",body:JSON.stringify(t)}),onSuccess:()=>{e.invalidateQueries({queryKey:["playbooks"]})}})}function Cnt(){const e=ft();return kt({mutationFn:async({playbookId:t,...r})=>Wl(`/playbooks/${t}`,{method:"PATCH",body:JSON.stringify(r)}),onSuccess:(t,{playbookId:r})=>{e.invalidateQueries({queryKey:["playbooks"]}),e.invalidateQueries({queryKey:["playbook",r]})}})}function jnt(){const e=ft();return kt({mutationFn:async({playbookId:t,...r})=>Wl("/workflows",{method:"POST",body:JSON.stringify({playbookId:t,...r})}),onSuccess:()=>{e.invalidateQueries({queryKey:["workflows"]})}})}function Ent({playbook:e,onCreate:t,onEdit:r,onDelete:n}){const[a,s]=w.useState(!1);return o.jsxs("div",{className:"flex flex-col p-4 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:border-[var(--color-primary)] transition-colors duration-150","data-testid":`playbook-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(_d,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:e.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:e.name})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>s(!a),className:"p-1 rounded hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Playbook actions",children:o.jsx(n0,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),a&&o.jsxs("div",{className:"absolute right-0 mt-1 w-40 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg z-10",children:[o.jsxs("button",{onClick:()=>{t(e.id),s(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]",children:[o.jsx(Yr,{className:"w-4 h-4"}),"Create Workflow"]}),r&&o.jsxs("button",{onClick:()=>{r(e.id),s(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]","data-testid":`playbook-edit-${e.id}`,children:[o.jsx(Wa,{className:"w-4 h-4"}),"Edit"]}),n&&o.jsxs("button",{onClick:()=>{n(e.id),s(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-[var(--color-text-secondary)]",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(rn,{className:"w-3 h-3"}),e.steps.length," steps"]}),o.jsxs("span",{children:["v",e.version]}),e.variables.length>0&&o.jsxs("span",{children:[e.variables.length," variables"]})]}),o.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--color-border)]",children:o.jsxs("button",{onClick:()=>t(e.id),className:"w-full flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":`playbook-create-${e.id}`,children:[o.jsx(Yr,{className:"w-4 h-4"}),"Create Workflow"]})})]})}function Mnt(e){switch(e){case"pending":return o.jsx(Rr,{className:"w-4 h-4"});case"running":return o.jsx(Yr,{className:"w-4 h-4"});case"completed":return o.jsx(zs,{className:"w-4 h-4"});case"failed":return o.jsx(us,{className:"w-4 h-4"});case"cancelled":return o.jsx(VC,{className:"w-4 h-4"});default:return o.jsx(Rr,{className:"w-4 h-4"})}}function fee({workflow:e,onViewDetails:t,onCancel:r,onDelete:n}){const[a,s]=w.useState(!1),i=e.status==="pending"||e.status==="running",l=["completed","failed","cancelled"].includes(e.status),c=vnt(e);return o.jsxs("div",{className:"flex flex-col p-4 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:border-[var(--color-primary)] transition-colors duration-150 cursor-pointer","data-testid":`workflow-card-${e.id}`,onClick:()=>t(e.id),children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${uee(e.status)}`,children:Mnt(e.status)}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:e.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:e.id})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:u=>{u.stopPropagation(),s(!a)},className:"p-1 rounded hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Workflow actions",children:o.jsx(n0,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),a&&o.jsxs("div",{className:"absolute right-0 mt-1 w-40 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md shadow-lg z-10",children:[o.jsxs("button",{onClick:u=>{u.stopPropagation(),t(e.id),s(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]",children:[o.jsx(du,{className:"w-4 h-4"}),"View Details"]}),i&&r&&o.jsxs("button",{onClick:u=>{u.stopPropagation(),r(e.id),s(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-yellow-600 hover:bg-yellow-50 dark:hover:bg-yellow-900/20",children:[o.jsx(Bn,{className:"w-4 h-4"}),"Cancel"]}),l&&n&&o.jsxs("button",{onClick:u=>{u.stopPropagation(),n(e.id),s(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})]})]})]}),o.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-[var(--color-text-secondary)]",children:[o.jsx("span",{className:`px-2 py-0.5 rounded-full ${uee(e.status)}`,children:gnt(e.status)}),c&&o.jsxs("span",{children:["Duration: ",c]}),e.ephemeral&&o.jsx("span",{className:"text-amber-600",children:"Ephemeral"})]}),o.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs text-[var(--color-text-tertiary)]",children:[o.jsxs("span",{children:["Created ",dee(e.createdAt)]}),e.startedAt&&o.jsxs("span",{children:["Started ",dee(e.startedAt)]})]}),(e.failureReason||e.cancelReason)&&o.jsx("div",{className:"mt-2 p-2 bg-red-50 dark:bg-red-900/20 rounded text-xs text-red-600 dark:text-red-400",children:e.failureReason||e.cancelReason})]})}function Tnt({variable:e,value:t,onChange:r}){const n=t!==void 0?t:e.default;return e.type==="boolean"?o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:!!n,onChange:a=>r(a.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)]","data-testid":`variable-input-${e.name}`}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Enable"})]}):e.enum&&e.enum.length>0?o.jsxs("select",{value:String(n??""),onChange:a=>r(e.type==="number"?Number(a.target.value):a.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":`variable-input-${e.name}`,children:[o.jsx("option",{value:"",children:"Select..."}),e.enum.map(a=>o.jsx("option",{value:String(a),children:String(a)},String(a)))]}):o.jsx("input",{type:e.type==="number"?"number":"text",value:String(n??""),onChange:a=>r(e.type==="number"?Number(a.target.value):a.target.value),placeholder:e.default!==void 0?`Default: ${e.default}`:"",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":`variable-input-${e.name}`})}function Ant({steps:e}){const[t,r]=w.useState(!1),n=t?e:e.slice(0,3),a=e.length>3;return o.jsxs("div",{"data-testid":"steps-preview",className:"space-y-2",children:[o.jsxs("div",{className:"text-sm font-medium text-[var(--color-text)]",children:["Steps (",e.length,")"]}),o.jsx("div",{className:"space-y-1",children:n.map((s,i)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-secondary)]",children:[o.jsx("span",{className:"w-5 h-5 flex items-center justify-center bg-[var(--color-surface-elevated)] rounded text-xs font-medium",children:i+1}),o.jsx("span",{className:"truncate",children:s.title})]},s.id))}),a&&o.jsx("button",{onClick:()=>r(!t),className:"text-xs text-[var(--color-primary)] hover:underline",children:t?"Show less":`Show ${e.length-3} more...`})]})}function Dnt({selectedPlaybookId:e,onSelect:t}){const[r,n]=w.useState(!1),{data:a,isLoading:s}=KB(),i=a?.playbooks??[],l=i.find(c=>c.id===e);return s?o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading playbooks..."})]}):i.length===0?o.jsxs("div",{className:"px-3 py-4 text-center bg-[var(--color-surface)] border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(_d,{className:"w-6 h-6 mx-auto mb-2 text-[var(--color-text-tertiary)]"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"No playbooks available"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Create a playbook template first"})]}):o.jsxs("div",{className:"relative","data-testid":"playbook-picker",children:[o.jsxs("button",{type:"button",onClick:()=>n(!r),className:"w-full flex items-center justify-between px-3 py-2 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg hover:border-[var(--color-primary)]/50 transition-colors","data-testid":"playbook-picker-trigger",children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(_d,{className:"w-4 h-4 text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:l?.title??"Select a playbook..."})]}),o.jsx(Yt,{className:`w-4 h-4 text-[var(--color-text-secondary)] transition-transform ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"absolute z-20 w-full mt-1 max-h-60 overflow-auto bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg","data-testid":"playbook-picker-dropdown",children:i.map(c=>o.jsxs("button",{onClick:()=>{t(c.id),n(!1)},className:`w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-[var(--color-surface-hover)] ${e===c.id?"bg-[var(--color-primary-muted)]":""}`,"data-testid":`playbook-option-${c.id}`,children:[o.jsx(_d,{className:"w-4 h-4 text-[var(--color-primary)]"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-[var(--color-text)]",children:c.title}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:c.name})]})]},c.id))})]})}function Lnt({isOpen:e,onClose:t,playbookId:r,onSuccess:n}){const[a,s]=w.useState(""),[i,l]=w.useState(r??null),[c,u]=w.useState({}),[d,f]=w.useState(!0),[m,p]=w.useState(null),{data:v,isLoading:b}=Vpe(i),y=v?.playbook,S=jnt();w.useEffect(()=>{r&&l(r)},[r]),w.useEffect(()=>{if(y){const E={};for(const T of y.variables)T.default!==void 0&&(E[T.name]=T.default);u(E),a||s(y.title)}},[y]),w.useEffect(()=>{e||(s(""),l(r??null),u({}),f(!0),p(null),S.reset())},[e,r]);const N=w.useMemo(()=>{const E=[];if(!y)E.push("Please select a playbook");else for(const T of y.variables)T.required&&!c[T.name]&&T.default===void 0&&E.push(`Required variable: ${T.name}`);return E},[y,c]).length===0&&!S.isPending,k=w.useCallback((E,T)=>{u(O=>({...O,[E]:T}))},[]),j=async()=>{if(p(null),!y||!i){p("Please select a playbook");return}try{const E=await S.mutateAsync({playbookId:i,title:a||y.title,variables:c,ephemeral:d});n?.({id:E.workflow.id,title:a||y.title}),t()}catch(E){p(E instanceof Error?E.message:"Failed to create workflow")}};return e?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"create-workflow-container",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 animate-fade-in",onClick:t,"data-testid":"create-workflow-backdrop"}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4 pointer-events-none overflow-y-auto",children:o.jsxs("div",{className:`
            w-full max-w-lg max-h-[90vh]
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
            flex flex-col
          `,style:{pointerEvents:"auto"},"data-testid":"create-workflow-dialog",role:"dialog","aria-labelledby":"create-workflow-title",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Yr,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{id:"create-workflow-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Create Workflow"})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded-lg text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Close dialog","data-testid":"create-workflow-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),(m||S.error)&&o.jsxs("div",{className:"mx-4 mt-4 flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),m||S.error?.message||"An error occurred"]}),o.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-sm font-medium text-[var(--color-text)]",children:["Playbook ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(Dnt,{selectedPlaybookId:i,onSelect:l})]}),b&&i&&o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(Pe,{className:"w-6 h-6 text-[var(--color-primary)] animate-spin"})}),y&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Workflow Title"}),o.jsx("input",{type:"text",value:a,onChange:E=>s(E.target.value),placeholder:y.title,className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"create-title-input"})]}),o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(_d,{className:"w-4 h-4 text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:y.title})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[y.steps.length," steps, v",y.version]})]}),y.variables.length>0&&o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"text-sm font-medium text-[var(--color-text)]",children:"Variables"}),y.variables.map(E=>o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"flex items-center gap-1 text-xs font-medium text-[var(--color-text-secondary)]",children:[E.name,E.required&&o.jsx("span",{className:"text-red-500",children:"*"})]}),E.description&&o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:E.description}),o.jsx(Tnt,{variable:E,value:c[E.name],onChange:T=>k(E.name,T)})]},E.name))]}),o.jsx(Ant,{steps:y.steps}),o.jsxs("details",{className:"text-sm","data-testid":"advanced-options",children:[o.jsx("summary",{className:"text-[var(--color-text-secondary)] cursor-pointer hover:text-[var(--color-text)]","data-testid":"toggle-advanced",children:"Advanced options"}),o.jsx("div",{className:"mt-2 p-3 bg-[var(--color-surface)] rounded-lg space-y-2",children:o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:d,onChange:E=>f(E.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)]","data-testid":"ephemeral-checkbox"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Ephemeral workflow"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Ephemeral workflows are automatically cleaned up after completion"})]})]})})]})]})]}),o.jsxs("div",{className:"flex items-center justify-end gap-2 px-4 py-3 border-t border-[var(--color-border)] flex-shrink-0",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors","data-testid":"create-cancel-button",children:"Cancel"}),o.jsx("button",{onClick:j,disabled:!N,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors","data-testid":"create-submit-button",children:S.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-4 h-4"}),"Create Workflow"]})})]})]})})]}):null}function Ont(e){const t={id:e.id,title:e.title};if(e.description.trim()&&(t.description=e.description.trim()),e.dependsOn.length>0&&(t.dependsOn=e.dependsOn),e.condition.trim()&&(t.condition=e.condition.trim()),e.stepType==="function"){if(t.stepType="function",t.runtime=e.runtime,e.runtime==="shell"?e.command.trim()&&(t.command=e.command.trim()):e.code.trim()&&(t.code=e.code.trim()),e.timeout.trim()){const r=parseInt(e.timeout,10);!isNaN(r)&&r>0&&(t.timeout=r)}}else e.taskType&&(t.taskType=e.taskType),e.priority&&(t.priority=e.priority),e.complexity&&(t.complexity=e.complexity),e.assignee.trim()&&(t.assignee=e.assignee.trim());return t}function Int(e){const t={name:e.name,type:e.type,required:e.required};if(e.description.trim()&&(t.description=e.description.trim()),e.default.trim())switch(e.type){case"number":t.default=Number(e.default);break;case"boolean":t.default=e.default==="true";break;default:t.default=e.default}if(e.enum.length>0&&e.enum.some(r=>r.trim())){const r=e.enum.filter(n=>n.trim());switch(e.type){case"number":t.enum=r.map(Number);break;case"boolean":t.enum=r.map(n=>n==="true");break;default:t.enum=r}}return t}function Rnt(e,t,r,n){const a=[];if(a.push(`name: ${e}`),a.push(`title: "${t}"`),a.push("version: 1"),n.length>0){a.push(""),a.push("variables:");for(const s of n){if(a.push(`  - name: ${s.name}`),a.push(`    type: ${s.type}`),a.push(`    required: ${s.required}`),s.description&&a.push(`    description: "${s.description}"`),s.default){const i=s.type==="string"?`"${s.default}"`:s.default;a.push(`    default: ${i}`)}if(s.enum.length>0&&s.enum.some(i=>i.trim())){a.push("    enum:");for(const i of s.enum.filter(l=>l.trim())){const l=s.type==="string"?`"${i}"`:i;a.push(`      - ${l}`)}}}}if(r.length>0){a.push(""),a.push("steps:");for(const s of r){if(a.push(`  - id: ${s.id}`),a.push(`    title: "${s.title}"`),s.description&&a.push(`    description: "${s.description}"`),s.stepType==="function"){if(a.push("    step_type: function"),a.push(`    runtime: ${s.runtime}`),s.runtime==="shell"&&s.command)if(s.command.includes(`
`)){a.push("    command: |");for(const i of s.command.split(`
`))a.push(`      ${i}`)}else a.push(`    command: "${s.command}"`);else if(s.code){a.push("    code: |");for(const i of s.code.split(`
`))a.push(`      ${i}`)}s.timeout&&a.push(`    timeout: ${s.timeout}`)}else s.taskType&&a.push(`    task_type: ${s.taskType}`),s.priority&&a.push(`    priority: ${s.priority}`),s.complexity&&a.push(`    complexity: ${s.complexity}`),s.assignee&&a.push(`    assignee: "${s.assignee}"`);if(s.dependsOn.length>0){a.push("    depends_on:");for(const i of s.dependsOn)a.push(`      - ${i}`)}s.condition&&a.push(`    condition: "${s.condition}"`)}}return a.join(`
`)}function Pnt({step:e,index:t,isSelected:r,onSelect:n,onMoveUp:a,onMoveDown:s,onDelete:i,isFirst:l,isLast:c}){const u=e.stepType==="function";return o.jsxs("div",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors duration-150 ${r?"border-[var(--color-primary)] bg-[var(--color-primary-muted)]":"border-[var(--color-border)] bg-[var(--color-surface)] hover:border-[var(--color-primary)]/50"}`,onClick:n,"data-testid":`step-item-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx(ise,{className:"w-4 h-4 text-[var(--color-text-tertiary)] cursor-grab flex-shrink-0"}),o.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-[var(--color-bg)] border border-[var(--color-border)] rounded text-xs font-medium text-[var(--color-text-secondary)] flex-shrink-0",children:t+1}),o.jsx("span",{className:`flex items-center justify-center w-6 h-6 rounded flex-shrink-0 ${u?"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400":"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400"}`,title:u?"Function step":"Task step",children:u?o.jsx(na,{className:"w-3.5 h-3.5"}):o.jsx(tu,{className:"w-3.5 h-3.5"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.title||"Untitled step"}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)] font-mono truncate",children:[e.id,u&&e.runtime&&o.jsxs("span",{className:"ml-1 text-purple-500",children:[" ",e.runtime]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[e.dependsOn.length>0&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",children:[e.dependsOn.length," dep",e.dependsOn.length>1?"s":""]}),o.jsx("button",{onClick:d=>{d.stopPropagation(),a()},disabled:l,className:"p-1 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:o.jsx(Px,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),o.jsx("button",{onClick:d=>{d.stopPropagation(),s()},disabled:c,className:"p-1 rounded hover:bg-[var(--color-surface-hover)] disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:o.jsx(Rx,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})}),o.jsx("button",{onClick:d=>{d.stopPropagation(),i()},className:"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-red-500",title:"Delete step",children:o.jsx(pr,{className:"w-4 h-4"})})]})]})}function znt({step:e,onChange:t,allStepIds:r,onClose:n}){const a=r.filter(c=>c!==e.id),s=e.stepType==="function",i=(c,u)=>{t({...e,[c]:u})},l=c=>{const u=e.dependsOn.includes(c)?e.dependsOn.filter(d=>d!==c):[...e.dependsOn,c];i("dependsOn",u)};return o.jsxs("div",{className:"space-y-4 max-h-[500px] overflow-y-auto","data-testid":"step-form",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)]",children:"Edit Step"}),o.jsx("button",{onClick:n,className:"p-1 rounded hover:bg-[var(--color-surface-hover)]",children:o.jsx(yt,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Step Type"}),o.jsx("div",{className:"flex gap-2",children:pnt.map(c=>o.jsx("button",{onClick:()=>i("stepType",c.value),className:`flex-1 px-3 py-2 text-sm rounded-lg border transition-colors ${e.stepType===c.value?"bg-[var(--color-primary)] text-white border-[var(--color-primary)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:border-[var(--color-primary)]"}`,"data-testid":`step-type-${c.value}`,children:c.label},c.value))}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:e.stepType==="function"?"Execute code directly":"Create an agent task"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Step ID"}),o.jsx("input",{type:"text",value:e.id,onChange:c=>i("id",c.target.value.replace(/[^a-zA-Z0-9_-]/g,"")),placeholder:"step_id",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 font-mono","data-testid":"step-id-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:e.title,onChange:c=>i("title",c.target.value),placeholder:"Step title",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-title-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Description"}),o.jsx("textarea",{value:e.description,onChange:c=>i("description",c.target.value),placeholder:"Step description",rows:2,className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"step-description-input"})]}),s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Runtime ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("select",{value:e.runtime,onChange:c=>i("runtime",c.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-runtime-select",children:cee.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:cee.find(c=>c.value===e.runtime)?.description})]}),e.runtime!=="shell"&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Code ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{value:e.code,onChange:c=>i("code",c.target.value),placeholder:e.runtime==="typescript"?`// TypeScript code to execute
export default async function() {
  // Your code here
}`:`# Python code to execute
def main():
    # Your code here
    pass`,rows:8,className:"w-full px-3 py-2 text-sm font-mono bg-gray-900 text-green-400 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"step-code-input"})]}),e.runtime==="shell"&&o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Command ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{value:e.command,onChange:c=>i("command",c.target.value),placeholder:"echo 'Hello World' && ls -la",rows:4,className:"w-full px-3 py-2 text-sm font-mono bg-gray-900 text-green-400 border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"step-command-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Timeout (ms)"}),o.jsx("input",{type:"number",value:e.timeout,onChange:c=>i("timeout",c.target.value),placeholder:"30000",min:"1",max:"600000",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-timeout-input"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Default: 30000ms (30 seconds). Max: 600000ms (10 minutes)"})]})]}),!s&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Task Type"}),o.jsxs("select",{value:e.taskType,onChange:c=>i("taskType",c.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-tasktype-select",children:[o.jsx("option",{value:"",children:"None"}),dnt.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Priority"}),o.jsxs("select",{value:e.priority,onChange:c=>i("priority",c.target.value?Number(c.target.value):""),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-priority-select",children:[o.jsx("option",{value:"",children:"None"}),fnt.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Complexity"}),o.jsxs("select",{value:e.complexity,onChange:c=>i("complexity",c.target.value?Number(c.target.value):""),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-complexity-select",children:[o.jsx("option",{value:"",children:"None"}),hnt.map(c=>o.jsx("option",{value:c.value,children:c.label},c.value))]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Assignee"}),o.jsx("input",{type:"text",value:e.assignee,onChange:c=>i("assignee",c.target.value),placeholder:"{{variable}} or entity name",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"step-assignee-input"})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Dependencies"}),a.length===0?o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No other steps available"}):o.jsx("div",{className:"flex flex-wrap gap-2","data-testid":"step-dependencies",children:a.map(c=>o.jsx("button",{onClick:()=>l(c),className:`px-2 py-1 text-xs rounded-full border transition-colors ${e.dependsOn.includes(c)?"bg-[var(--color-primary)] text-white border-[var(--color-primary)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:border-[var(--color-primary)]"}`,children:c},c))})]})]})}function Bnt({variable:e,onChange:t,onClose:r}){const n=(l,c)=>{t({...e,[l]:c})},a=()=>{n("enum",[...e.enum,""])},s=(l,c)=>{const u=[...e.enum];u[l]=c,n("enum",u)},i=l=>{n("enum",e.enum.filter((c,u)=>u!==l))};return o.jsxs("div",{className:"space-y-4","data-testid":"variable-form",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)]",children:"Edit Variable"}),o.jsx("button",{onClick:r,className:"p-1 rounded hover:bg-[var(--color-surface-hover)]",children:o.jsx(yt,{className:"w-4 h-4 text-[var(--color-text-secondary)]"})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:e.name,onChange:l=>n("name",l.target.value.replace(/[^a-zA-Z0-9_]/g,"")),placeholder:"variable_name",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 font-mono","data-testid":"variable-name-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Type ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("select",{value:e.type,onChange:l=>n("type",l.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-type-select",children:mnt.map(l=>o.jsx("option",{value:l.value,children:l.label},l.value))})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:e.required,onChange:l=>n("required",l.target.checked),className:"w-4 h-4 rounded border-[var(--color-border)] text-[var(--color-primary)]","data-testid":"variable-required-checkbox"}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Required"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Description"}),o.jsx("input",{type:"text",value:e.description,onChange:l=>n("description",l.target.value),placeholder:"What this variable is for",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-description-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Default Value"}),e.type==="boolean"?o.jsxs("select",{value:e.default,onChange:l=>n("default",l.target.value),className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-default-input",children:[o.jsx("option",{value:"",children:"No default"}),o.jsx("option",{value:"true",children:"true"}),o.jsx("option",{value:"false",children:"false"})]}):o.jsx("input",{type:e.type==="number"?"number":"text",value:e.default,onChange:l=>n("default",l.target.value),placeholder:e.type==="number"?"0":"default value",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"variable-default-input"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Allowed Values"}),o.jsxs("button",{onClick:a,className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded",children:[o.jsx(dr,{className:"w-3 h-3"}),"Add"]})]}),e.enum.length>0?o.jsx("div",{className:"space-y-2","data-testid":"variable-enum-list",children:e.enum.map((l,c)=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:e.type==="number"?"number":"text",value:l,onChange:u=>s(c,u.target.value),placeholder:`Option ${c+1}`,className:"flex-1 px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30"}),o.jsx("button",{onClick:()=>i(c),className:"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-red-500",children:o.jsx(pr,{className:"w-4 h-4"})})]},c))}):o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No enum values. Variable accepts any value of its type."})]})]})}function $nt({yaml:e,onImport:t}){const[r,n]=w.useState(!1),[a,s]=w.useState(""),[i,l]=w.useState(!1),c=async()=>{try{await navigator.clipboard.writeText(e),l(!0),setTimeout(()=>l(!1),2e3)}catch(f){console.error("Failed to copy:",f)}},u=()=>{const f=new Blob([e],{type:"text/yaml"}),m=URL.createObjectURL(f),p=document.createElement("a");p.href=m,p.download="playbook.yaml",p.click(),URL.revokeObjectURL(m)},d=()=>{t(a),n(!1),s("")};return o.jsxs("div",{className:"space-y-3","data-testid":"yaml-preview",children:[o.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[o.jsxs("button",{onClick:()=>n(!r),className:`flex items-center gap-1 px-3 py-1.5 text-sm rounded-lg transition-colors ${r?"bg-[var(--color-primary)] text-white":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":"yaml-import-toggle",children:[o.jsx(Kae,{className:"w-4 h-4"}),"Import"]}),o.jsxs("button",{onClick:c,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-[var(--color-surface)] text-[var(--color-text-secondary)] rounded-lg hover:bg-[var(--color-surface-hover)]","data-testid":"yaml-copy",children:[i?o.jsx(Vn,{className:"w-4 h-4 text-green-500"}):o.jsx(rj,{className:"w-4 h-4"}),i?"Copied!":"Copy"]}),o.jsxs("button",{onClick:u,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-[var(--color-surface)] text-[var(--color-text-secondary)] rounded-lg hover:bg-[var(--color-surface-hover)]","data-testid":"yaml-download",children:[o.jsx(oy,{className:"w-4 h-4"}),"Download"]})]}),r&&o.jsxs("div",{className:"p-3 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 text-sm bg-[var(--color-primary)] text-white rounded-lg cursor-pointer hover:bg-[var(--color-primary-hover)]",children:[o.jsx(rn,{className:"w-4 h-4"}),"Upload File",o.jsx("input",{type:"file",accept:".yaml,.yml",onChange:f=>{const m=f.target.files?.[0];if(m){const p=new FileReader;p.onload=v=>{const b=v.target?.result;t(b),n(!1)},p.readAsText(m)}},className:"hidden","data-testid":"yaml-file-input"})]}),o.jsx("span",{className:"text-sm text-[var(--color-text-tertiary)]",children:"or paste YAML below"})]}),o.jsx("textarea",{value:a,onChange:f=>s(f.target.value),placeholder:"Paste YAML content here...",rows:10,className:"w-full px-3 py-2 text-sm font-mono bg-[var(--color-bg)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 resize-none","data-testid":"yaml-import-textarea"}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{onClick:()=>{n(!1),s("")},className:"px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] rounded-lg",children:"Cancel"}),o.jsxs("button",{onClick:d,disabled:!a.trim(),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-[var(--color-primary)] text-white rounded-lg hover:bg-[var(--color-primary-hover)] disabled:opacity-50","data-testid":"yaml-import-confirm",children:[o.jsx(Vn,{className:"w-4 h-4"}),"Import"]})]})]}),o.jsx("pre",{className:"p-4 bg-gray-900 text-green-400 rounded-lg overflow-auto text-xs font-mono max-h-96","data-testid":"yaml-content",children:e})]})}function Fnt({isOpen:e,onClose:t,playbookId:r,onSuccess:n}){const a=!!r,[s,i]=w.useState(""),[l,c]=w.useState(""),[u,d]=w.useState([]),[f,m]=w.useState([]),[p,v]=w.useState("steps"),[b,y]=w.useState(null),[S,_]=w.useState(null),[N,k]=w.useState(null),{data:j,isLoading:E,error:T}=Vpe(r??void 0),O=j?.playbook,R=Nnt(),H=Cnt();w.useEffect(()=>{O&&a&&(i(O.name),c(O.title),d(O.steps.map(V=>{const se=V.stepType??"task",de=se==="function";return{id:V.id,title:V.title,description:V.description??"",stepType:se,taskType:de?"":V.taskType??"",priority:de?"":V.priority??"",complexity:de?"":V.complexity??"",assignee:de?"":V.assignee??"",runtime:de?V.runtime??"typescript":"typescript",code:de?V.code??"":"",command:de?V.command??"":"",timeout:de?V.timeout?.toString()??"":"",dependsOn:V.dependsOn??[],condition:V.condition??""}})),m(O.variables.map(V=>({name:V.name,description:V.description??"",type:V.type,required:V.required,default:V.default!==void 0?String(V.default):"",enum:V.enum?.map(String)??[]}))))},[O,a]),w.useEffect(()=>{e||(i(""),c(""),d([]),m([]),v("steps"),y(null),_(null),k(null))},[e]);const $=w.useMemo(()=>Rnt(s||"my_playbook",l||"My Playbook",u,f),[s,l,u,f]),L=w.useMemo(()=>u.map(V=>V.id),[u]),A=w.useMemo(()=>{const V=[];s.trim()||V.push("Name is required"),l.trim()||V.push("Title is required"),!/^[a-zA-Z_][a-zA-Z0-9_-]*$/.test(s)&&s.trim()&&V.push("Name must start with letter/underscore");for(const se of u)se.id.trim()||V.push("All steps must have an ID"),se.title.trim()||V.push("All steps must have a title");for(const se of f)se.name.trim()||V.push("All variables must have a name");return V},[s,l,u,f]),M=A.length===0&&!R.isPending&&!H.isPending,P=w.useCallback((V="task")=>{const se={id:PL(),title:"",description:"",stepType:V,taskType:"",priority:"",complexity:"",assignee:"",runtime:"typescript",code:"",command:"",timeout:"",dependsOn:[],condition:""};d(de=>[...de,se]),y(u.length)},[u.length]),I=w.useCallback((V,se)=>{d(de=>de.map((he,te)=>te===V?se:he))},[]),B=w.useCallback(V=>{const se=u[V]?.id;d(de=>de.filter((te,le)=>le!==V).map(te=>({...te,dependsOn:te.dependsOn.filter(le=>le!==se)}))),y(null)},[u]),F=w.useCallback((V,se)=>{d(de=>{const he=[...de],te=se==="up"?V-1:V+1;return[he[V],he[te]]=[he[te],he[V]],he}),y(se==="up"?V-1:V+1)},[]),q=w.useCallback(()=>{const V={name:"",description:"",type:"string",required:!1,default:"",enum:[]};m(se=>[...se,V]),_(f.length)},[f.length]),Q=w.useCallback((V,se)=>{m(de=>de.map((he,te)=>te===V?se:he))},[]),W=w.useCallback(V=>{m(se=>se.filter((de,he)=>he!==V)),_(null)},[]),G=w.useCallback(V=>{try{const se=V.split(`
`);let de="",he="";const te=[],le=[];let oe="root",Z=null;for(const ve of se){const U=ve.trim();if(!U||U.startsWith("#"))continue;if(U==="steps:"){oe="steps",Z=null;continue}if(U==="variables:"){oe="variables",Z=null;continue}const ge=U.match(/^-?\s*(\w+):\s*(.*)$/);if(!ge)continue;const[,ue,re]=ge,ne=re.replace(/^["']|["']$/g,"");oe==="root"?ue==="name"?de=ne:ue==="title"&&(he=ne):oe==="steps"?U.startsWith("-")?(Z&&"id"in Z&&te.push({id:Z.id||PL(),title:Z.title||"",description:Z.description||"",stepType:"task",taskType:"",priority:"",complexity:"",assignee:"",runtime:"typescript",code:"",command:"",timeout:"",dependsOn:[],condition:""}),Z={id:ne}):Z&&(ue==="title"?Z.title=ne:ue==="description"&&(Z.description=ne)):oe==="variables"&&(U.startsWith("-")?(Z&&"name"in Z&&Z.name&&le.push({name:Z.name||"",description:Z.description||"",type:Z.type||"string",required:Z.required||!1,default:Z.default||"",enum:[]}),Z={name:ne}):Z&&(ue==="type"?Z.type=ne:ue==="required"?Z.required=ne==="true":ue==="description"?Z.description=ne:ue==="default"&&(Z.default=ne)))}Z&&(oe==="steps"&&"id"in Z?te.push({id:Z.id||PL(),title:Z.title||"",description:Z.description||"",stepType:"task",taskType:"",priority:"",complexity:"",assignee:"",runtime:"typescript",code:"",command:"",timeout:"",dependsOn:[],condition:""}):oe==="variables"&&"name"in Z&&Z.name&&le.push({name:Z.name||"",description:Z.description||"",type:Z.type||"string",required:Z.required||!1,default:Z.default||"",enum:[]})),de&&i(de),he&&c(he),te.length>0&&d(te),le.length>0&&m(le),v("steps"),k(null)}catch{k("Failed to parse YAML. Please check the format and try again.")}},[]),J=async()=>{if(k(null),A.length>0){k(A.join(", "));return}try{const V=u.map(Ont),se=f.map(Int);if(a&&r){const de=await H.mutateAsync({playbookId:r,title:l,steps:V,variables:se});n?.(de.playbook)}else{const de=await R.mutateAsync({name:s,title:l,steps:V,variables:se});n?.(de.playbook)}t()}catch(V){k(V instanceof Error?V.message:"Failed to save playbook")}};if(!e)return null;const X=R.isPending||H.isPending;return o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":"workflow-editor-container",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 animate-fade-in",onClick:t,"data-testid":"workflow-editor-backdrop"}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4 pointer-events-none overflow-y-auto",children:o.jsxs("div",{className:"w-full max-w-3xl max-h-[90vh] mx-auto bg-[var(--color-bg)] rounded-xl shadow-2xl border border-[var(--color-border)] animate-scale-in pointer-events-auto flex flex-col",style:{pointerEvents:"auto"},"data-testid":"workflow-editor-dialog",role:"dialog","aria-labelledby":"workflow-editor-title",onClick:V=>V.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(_d,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{id:"workflow-editor-title",className:"text-lg font-semibold text-[var(--color-text)]",children:a?"Edit Template":"Create Template"})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded-lg text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","aria-label":"Close dialog","data-testid":"workflow-editor-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),E&&a&&o.jsx("div",{className:"flex items-center justify-center py-16",children:o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})}),(N||T)&&o.jsxs("div",{className:"mx-4 mt-4 flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),N||T?.message||"An error occurred"]}),(!E||!a)&&o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[o.jsx("div",{className:"px-4 pt-4 pb-3 border-b border-[var(--color-border)] space-y-3 flex-shrink-0",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:s,onChange:V=>i(V.target.value.replace(/[^a-zA-Z0-9_-]/g,"")),placeholder:"my_playbook",disabled:a,className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30 font-mono disabled:opacity-50","data-testid":"playbook-name-input"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",value:l,onChange:V=>c(V.target.value),placeholder:"My Playbook",className:"w-full px-3 py-2 text-sm bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30","data-testid":"playbook-title-input"})]})]})}),o.jsx("div",{className:"px-4 border-b border-[var(--color-border)] flex-shrink-0",children:o.jsxs("nav",{className:"flex gap-4","aria-label":"Editor tabs",children:[o.jsxs("button",{onClick:()=>v("steps"),className:`flex items-center gap-1.5 py-3 px-1 text-sm font-medium border-b-2 transition-colors ${p==="steps"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent"}`,"data-testid":"tab-steps",children:[o.jsx(Wp,{className:"w-4 h-4"}),"Steps",o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface)]",children:u.length})]}),o.jsxs("button",{onClick:()=>v("variables"),className:`flex items-center gap-1.5 py-3 px-1 text-sm font-medium border-b-2 transition-colors ${p==="variables"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent"}`,"data-testid":"tab-variables",children:[o.jsx(vT,{className:"w-4 h-4"}),"Variables",o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface)]",children:f.length})]}),o.jsxs("button",{onClick:()=>v("yaml"),className:`flex items-center gap-1.5 py-3 px-1 text-sm font-medium border-b-2 transition-colors ${p==="yaml"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent"}`,"data-testid":"tab-yaml",children:[o.jsx(Kp,{className:"w-4 h-4"}),"YAML"]})]})}),o.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[p==="steps"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:"Steps"}),o.jsxs("div",{className:"relative group",children:[o.jsxs("button",{className:"flex items-center gap-1 px-2 py-1 text-sm text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded","data-testid":"add-step-button",children:[o.jsx(dr,{className:"w-4 h-4"}),"Add Step",o.jsx(Yt,{className:"w-3 h-3 ml-0.5"})]}),o.jsxs("div",{className:"absolute right-0 mt-1 w-48 py-1 bg-[var(--color-bg)] border border-[var(--color-border)] rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:[o.jsxs("button",{onClick:()=>P("task"),className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]","data-testid":"add-task-step",children:[o.jsx(tu,{className:"w-4 h-4 text-blue-500"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-medium",children:"Task Step"}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Agent-executed task"})]})]}),o.jsxs("button",{onClick:()=>P("function"),className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]","data-testid":"add-function-step",children:[o.jsx(na,{className:"w-4 h-4 text-purple-500"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-medium",children:"Function Step"}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Execute code directly"})]})]})]})]})]}),o.jsx("div",{className:"space-y-2 max-h-[400px] overflow-auto","data-testid":"step-list",children:u.length===0?o.jsxs("div",{className:"text-center py-8 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(Wp,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),'No steps yet. Click "Add Step" to begin.']}):u.map((V,se)=>o.jsx(Pnt,{step:V,index:se,isSelected:b===se,onSelect:()=>y(se),onMoveUp:()=>F(se,"up"),onMoveDown:()=>F(se,"down"),onDelete:()=>B(se),isFirst:se===0,isLast:se===u.length-1},V.id||se))})]}),o.jsx("div",{className:"border-l border-[var(--color-border)] pl-4",children:b!==null&&u[b]?o.jsx(znt,{step:u[b],onChange:V=>I(b,V),allStepIds:L,onClose:()=>y(null)}):o.jsx("div",{className:"flex items-center justify-center h-full text-sm text-[var(--color-text-tertiary)]",children:o.jsxs("div",{className:"text-center",children:[o.jsx(OO,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),"Select a step to edit"]})})})]}),p==="variables"&&o.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:"Variables"}),o.jsxs("button",{onClick:q,className:"flex items-center gap-1 px-2 py-1 text-sm text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded","data-testid":"add-variable-button",children:[o.jsx(dr,{className:"w-4 h-4"}),"Add Variable"]})]}),o.jsx("div",{className:"space-y-2 max-h-[400px] overflow-auto","data-testid":"variable-list",children:f.length===0?o.jsxs("div",{className:"text-center py-8 text-sm text-[var(--color-text-tertiary)]",children:[o.jsx(vT,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),'No variables yet. Click "Add Variable" to begin.']}):f.map((V,se)=>o.jsxs("div",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors duration-150 ${S===se?"border-[var(--color-primary)] bg-[var(--color-primary-muted)]":"border-[var(--color-border)] bg-[var(--color-surface)] hover:border-[var(--color-primary)]/50"}`,onClick:()=>_(se),"data-testid":`variable-item-${V.name}`,children:[o.jsx(vT,{className:"w-4 h-4 text-[var(--color-primary)] flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate font-mono",children:V.name||"unnamed"}),V.required&&o.jsx("span",{className:"text-red-500 text-xs",children:"required"})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[V.type,V.enum.length>0&&` (enum: ${V.enum.length})`]})]}),o.jsx("button",{onClick:de=>{de.stopPropagation(),W(se)},className:"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-red-500",title:"Delete variable",children:o.jsx(pr,{className:"w-4 h-4"})})]},V.name||se))})]}),o.jsx("div",{className:"border-l border-[var(--color-border)] pl-4",children:S!==null&&f[S]?o.jsx(Bnt,{variable:f[S],onChange:V=>Q(S,V),onClose:()=>_(null)}):o.jsx("div",{className:"flex items-center justify-center h-full text-sm text-[var(--color-text-tertiary)]",children:o.jsxs("div",{className:"text-center",children:[o.jsx(OO,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),"Select a variable to edit"]})})})]}),p==="yaml"&&o.jsx($nt,{yaml:$,onImport:G})]})]}),o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:[u.length," step",u.length!==1?"s":"",", ",f.length," variable",f.length!==1?"s":"",A.length>0&&o.jsxs("span",{className:"ml-2 text-red-500",children:["(",A.length," validation error",A.length!==1?"s":"",")"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors","data-testid":"cancel-button",children:"Cancel"}),o.jsx("button",{onClick:J,disabled:!M,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors","data-testid":"save-button",children:X?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx($x,{className:"w-4 h-4"}),a?"Save Changes":"Create Template"]})})]})]})]})})]})}function Unt({progress:e}){const{percentage:t,completed:r,inProgress:n,blocked:a,open:s,total:i}=e,l=i>0?r/i*100:0,c=i>0?n/i*100:0,u=i>0?a/i*100:0;return o.jsxs("div",{className:"space-y-3","data-testid":"workflow-progress-bar",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Progress"}),o.jsxs("span",{className:"text-sm text-[var(--color-text-secondary)]",children:[t,"% complete"]})]}),o.jsxs("div",{className:"h-3 bg-[var(--color-surface-elevated)] rounded-full overflow-hidden flex",children:[l>0&&o.jsx("div",{className:"bg-green-500 transition-all duration-500",style:{width:`${l}%`},title:`Completed: ${r}`}),c>0&&o.jsx("div",{className:"bg-blue-500 transition-all duration-500",style:{width:`${c}%`},title:`In Progress: ${n}`}),u>0&&o.jsx("div",{className:"bg-red-400 transition-all duration-500",style:{width:`${u}%`},title:`Blocked: ${a}`})]}),o.jsxs("div",{className:"flex flex-wrap gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["Completed (",r,")"]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["In Progress (",n,")"]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["Blocked (",a,")"]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300 dark:bg-gray-600"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)]",children:["Open (",s,")"]})]})]})]})}function Hnt({progress:e}){const t=[{label:"Total Tasks",value:e.total,icon:B6,color:"text-[var(--color-text)]",bgColor:"bg-[var(--color-surface-elevated)]"},{label:"Completed",value:e.completed,icon:zs,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30"},{label:"In Progress",value:e.inProgress,icon:Yr,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30"},{label:"Blocked",value:e.blocked,icon:Rt,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30"}];return o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3","data-testid":"workflow-stats-cards",children:t.map(r=>o.jsxs("div",{className:`p-3 rounded-lg ${r.bgColor}`,"data-testid":`stat-card-${r.label.toLowerCase().replace(" ","-")}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(r.icon,{className:`w-4 h-4 ${r.color}`}),o.jsx("span",{className:`text-xl font-semibold ${r.color}`,children:r.value})]}),o.jsx("span",{className:"text-xs text-[var(--color-text-secondary)]",children:r.label})]},r.label))})}function qnt({task:e,dependsOn:t,blockedBy:r}){const n=w.useMemo(()=>{switch(e.status){case"closed":return o.jsx(zs,{className:"w-4 h-4 text-green-500"});case"in_progress":return o.jsx(Pe,{className:"w-4 h-4 text-blue-500 animate-spin"});case"blocked":return o.jsx(Rt,{className:"w-4 h-4 text-red-400"});case"open":return o.jsx(nu,{className:"w-4 h-4 text-gray-400"});default:return o.jsx(Rr,{className:"w-4 h-4 text-gray-400"})}},[e.status]);return o.jsxs("div",{className:"flex items-center gap-3 p-3 border border-[var(--color-border)] rounded-lg bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":`workflow-task-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0",children:n}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.title})}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs",children:[o.jsx("span",{className:`px-1.5 py-0.5 rounded ${Wnt(e.status)}`,children:e.status.replace("_"," ")}),t.length>0&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["Depends on ",t.length," task",t.length>1?"s":""]})]})]}),r.length>0&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-500",children:[o.jsx(Bn,{className:"w-3 h-3"}),o.jsx("span",{children:"Blocked"})]})]})}function Wnt(e){switch(e){case"closed":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400";case"blocked":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400";case"in_progress":return"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400";default:return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400"}}function Knt({step:e,dependsOn:t,blockedBy:r}){const n=w.useMemo(()=>{switch(e.status){case"completed":return o.jsx(zs,{className:"w-4 h-4 text-green-500"});case"running":return o.jsx(Pe,{className:"w-4 h-4 text-purple-500 animate-spin"});case"failed":return o.jsx(us,{className:"w-4 h-4 text-red-500"});case"pending":default:return o.jsx(Rr,{className:"w-4 h-4 text-gray-400"})}},[e.status]),a=w.useMemo(()=>{const l=e.runtime;switch(l){case"typescript":return"TS";case"python":return"PY";case"shell":return"SH";default:return l?.toUpperCase()??""}},[e.runtime]),s=l=>{switch(l){case"typescript":return"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400";case"python":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400";case"shell":return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400";default:return"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400"}},i=l=>{switch(l){case"completed":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400";case"failed":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400";case"running":return"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400";default:return"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400"}};return o.jsxs("div",{className:"flex items-center gap-3 p-3 border border-purple-200 dark:border-purple-800/50 rounded-lg bg-purple-50/50 dark:bg-purple-900/10 hover:bg-purple-100/50 dark:hover:bg-purple-900/20 transition-colors","data-testid":`workflow-function-step-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0",children:n}),o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded bg-purple-100 dark:bg-purple-900/30",children:o.jsx(na,{className:"w-3.5 h-3.5 text-purple-600 dark:text-purple-400"})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:e.title}),o.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs font-mono ${s(e.runtime)}`,children:a})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs",children:[o.jsx("span",{className:`px-1.5 py-0.5 rounded ${i(e.status)}`,children:e.status}),t.length>0&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["Depends on ",t.length," step",t.length>1?"s":""]}),e.timeout&&o.jsxs("span",{className:"text-[var(--color-text-tertiary)]",children:["Timeout: ",e.timeout/1e3,"s"]})]})]}),e.error&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-500",title:e.error,children:[o.jsx(Bn,{className:"w-3 h-3"}),o.jsx("span",{children:"Error"})]}),r.length>0&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-500",children:[o.jsx(Bn,{className:"w-3 h-3"}),o.jsx("span",{children:"Blocked"})]})]})}function Gnt({tasks:e,functionSteps:t=[],steps:r=[],dependencies:n}){const{dependsOnMap:a,blockedByMap:s}=w.useMemo(()=>{const l=new Map,c=new Map;for(const u of n)l.has(u.blockedId)||l.set(u.blockedId,[]),l.get(u.blockedId).push(u.blockerId),c.has(u.blockedId)||c.set(u.blockedId,[]),c.get(u.blockedId).push(u.blockerId);return{dependsOnMap:l,blockedByMap:c}},[n]),i=w.useMemo(()=>{let l=r.length>0?r:[...e,...t];const c={in_progress:0,running:0,blocked:1,open:2,pending:2,closed:3,completed:3,failed:4,deferred:5,tombstone:6};return l.sort((u,d)=>{const f=c[u.status]??99,m=c[d.status]??99;return f-m})},[e,t,r]);return i.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-secondary)]",children:"No steps in this workflow"}):o.jsx("div",{className:"space-y-2","data-testid":"workflow-step-list",children:i.map(l=>Gpe(l)?o.jsx(Knt,{step:l,dependsOn:a.get(l.id)??[],blockedBy:s.get(l.id)??[]},l.id):o.jsx(qnt,{task:l,dependsOn:a.get(l.id)??[],blockedBy:s.get(l.id)??[]},l.id))})}function Vnt({tasks:e,dependencies:t}){const r=w.useMemo(()=>{const a=new Map;for(const s of e)a.set(s.id,s);return a},[e]);if(t.length===0)return o.jsx("div",{className:"text-center py-4 text-[var(--color-text-tertiary)] text-sm",children:"No dependencies between tasks"});const n=a=>{switch(a){case"closed":return"border-green-500 bg-green-100 dark:bg-green-900/30";case"in_progress":return"border-blue-500 bg-blue-100 dark:bg-blue-900/30";case"blocked":return"border-red-400 bg-red-100 dark:bg-red-900/30";default:return"border-gray-300 bg-gray-100 dark:bg-gray-800"}};return o.jsxs("div",{className:"space-y-3","data-testid":"workflow-dependency-graph",children:[o.jsxs("div",{className:"text-xs text-[var(--color-text-secondary)] mb-2",children:["Task dependencies (",t.length," connection",t.length!==1?"s":"",")"]}),o.jsxs("div",{className:"space-y-2 overflow-x-auto",children:[t.slice(0,10).map((a,s)=>{const i=r.get(a.blockedId),l=r.get(a.blockerId);return!i||!l?null:o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsx("div",{className:`px-2 py-1 rounded border-2 ${n(i.status)} truncate max-w-[150px]`,title:i.title,children:i.title}),o.jsx(qh,{className:"w-4 h-4 text-[var(--color-text-tertiary)] flex-shrink-0"}),o.jsx("div",{className:`px-2 py-1 rounded border-2 ${n(l.status)} truncate max-w-[150px]`,title:l.title,children:l.title})]},s)}),t.length>10&&o.jsxs("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:["...and ",t.length-10," more"]})]})]})}function Ynt({workflow:e,tasks:t,functionSteps:r=[],steps:n=[],progress:a,dependencies:s,isLoading:i}){if(i)return o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})});const l=WB[e.status],c=n.length>0?n.length:t.length+r.length,u=r.length>0||n.some(d=>Gpe(d));return o.jsxs("div",{className:"space-y-6","data-testid":"workflow-progress-dashboard",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:e.title}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)]",children:[c," step",c!==1?"s":""," in workflow",u&&o.jsxs("span",{className:"ml-2 inline-flex items-center gap-1",children:[o.jsx(na,{className:"w-3 h-3 text-purple-500"}),o.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"includes function steps"})]})]})]}),o.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${l?.bgColor??""} ${l?.color??""}`,children:l?.label??e.status})]}),o.jsx(Hnt,{progress:a}),o.jsx(Unt,{progress:a}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"lg:col-span-2",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)] mb-3",children:"Steps"}),o.jsx(Gnt,{tasks:t,functionSteps:r,steps:n,dependencies:s})]}),o.jsxs("div",{className:"lg:col-span-1",children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)] mb-3",children:"Dependencies"}),o.jsx("div",{className:"p-4 border border-[var(--color-border)] rounded-lg bg-[var(--color-surface)]",children:o.jsx(Vnt,{tasks:t,dependencies:s})})]})]})]})}const zL={director:{icon:Vr,color:"purple",description:"Strategic agent that creates and assigns tasks. One per workspace."},worker:{icon:na,color:"blue",description:"Execution agent that produces code and completes tasks."},steward:{icon:r0,color:"amber",description:"Support agent that performs automated maintenance tasks."}},BL={merge:{label:"Merge Steward",description:"Handles merging completed branches, running tests, and cleanup."},docs:{label:"Documentation Steward",description:"Reviews, updates, and maintains workspace documents."},recovery:{label:"Recovery Steward",description:"Diagnoses and recovers tasks left in broken state by workers."},custom:{label:"Custom Steward",description:"User-defined steward with a workflow template executed when triggers fire."}},hee={ephemeral:{label:"Ephemeral",description:"Short-lived worker spawned per task, reports to Director."},persistent:{label:"Persistent",description:"Long-lived worker that handles multiple tasks, human-supervised."}};function Qnt(e,t,r,n){if(e==="director")return"director";let a,s;e==="worker"?(a=t==="ephemeral"?"e-worker":"p-worker",s=a):(a=`${r.charAt(0)}-steward`,s=a);const i=new RegExp(`^${a}-(\\d+)$`);let l=0;for(const c of n){const u=c.name.match(i);if(u){const d=parseInt(u[1],10);d>l&&(l=d)}}return`${s}-${l+1}`}const mee={name:"",role:"steward",workerMode:"ephemeral",stewardFocus:"merge",triggers:[],playbookId:"",tags:"",provider:"claude",model:""};function Jnt({isOpen:e,onClose:t,initialRole:r,initialStewardFocus:n,hasDirector:a=!1,onSuccess:s}){const{data:i}=m1(),l=w.useMemo(()=>i?.agents??[],[i?.agents]),{data:c}=g2(),u=w.useMemo(()=>c?.providers??[],[c?.providers]),d=u.length>1,{settings:f}=Wpe(),{data:m}=KB(),p=m?.playbooks??[],[v,b]=w.useState({...mee,role:r??"steward",stewardFocus:n??"merge",provider:f.defaultProvider||"claude",model:f.defaultModels[f.defaultProvider]??""}),{data:y,isLoading:S}=v2(v.provider),_=w.useMemo(()=>y?.models??[],[y?.models]),N=w.useMemo(()=>_.find(W=>W.isDefault),[_]),k=w.useMemo(()=>_.filter(W=>!W.isDefault),[_]),[j,E]=w.useState(!1),[T,O]=w.useState(null),[R,H]=w.useState(!1),$=w.useCallback(()=>Qnt(v.role,v.workerMode,v.stewardFocus,l),[v.role,v.workerMode,v.stewardFocus,l]);w.useEffect(()=>{if(e&&!R){const W=$();b(G=>({...G,name:W}))}},[e,$,R]),w.useEffect(()=>{e||H(!1)},[e]),w.useEffect(()=>{e&&b(W=>({...W,provider:f.defaultProvider||W.provider,model:f.defaultModels[f.defaultProvider]??""}))},[e,f.defaultProvider,f.defaultModels]);const L=KQe();if(!e)return null;const A=()=>{b({...mee,role:r??"steward",stewardFocus:n??"merge",provider:f.defaultProvider||"claude",model:f.defaultModels[f.defaultProvider]??""}),O(null),H(!1),t()},M=W=>{const G=f.defaultModels[W]??"";b(J=>({...J,provider:W,model:G}))},P=async W=>{if(W.preventDefault(),O(null),!v.name.trim()){O("Name is required");return}if(v.role==="steward"&&v.stewardFocus==="custom"&&!v.playbookId){O("A workflow template is required for custom stewards");return}const G={name:v.name.trim(),role:v.role,tags:v.tags.trim()?v.tags.split(",").map(J=>J.trim()).filter(Boolean):void 0,provider:v.provider!=="claude"?v.provider:void 0,model:v.model||void 0};v.role==="worker"?G.workerMode=v.workerMode:v.role==="steward"&&(G.stewardFocus=v.stewardFocus,v.triggers.length>0&&(G.triggers=v.triggers),v.stewardFocus==="custom"&&v.playbookId&&(G.playbookId=v.playbookId));try{const J=await L.mutateAsync(G);s?.({id:J.agent.id,name:J.agent.name}),A()}catch(J){O(J instanceof Error?J.message:"Failed to create agent")}},I=()=>{b(W=>({...W,triggers:[...W.triggers,{type:"cron",schedule:"0 * * * *"}]}))},B=()=>{b(W=>({...W,triggers:[...W.triggers,{type:"event",event:"task_completed"}]}))},F=(W,G)=>{b(J=>({...J,triggers:J.triggers.map((X,V)=>V===W?G:X)}))},q=W=>{b(G=>({...G,triggers:G.triggers.filter((J,X)=>X!==W)}))},Q=zL[v.role];return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:A,"data-testid":"create-agent-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none overflow-y-auto",children:o.jsxs("div",{className:`
            w-full max-w-lg
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
            my-8
          `,"data-testid":"create-agent-dialog",role:"dialog","aria-labelledby":"create-agent-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsxs("h2",{id:"create-agent-title",className:"text-lg font-semibold text-[var(--color-text)]",children:["Create ",v.role==="steward"?"Steward":v.role==="worker"?"Worker":"Agent"]}),o.jsx("button",{onClick:A,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"create-agent-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:P,className:"p-4 space-y-4",children:[T&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),T]}),!r&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Agent Type"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.keys(zL).map(W=>{const G=zL[W],J=G.icon,X=v.role===W,V=W==="director"&&a;return o.jsxs("button",{type:"button",onClick:()=>!V&&b(se=>({...se,role:W})),disabled:V,className:`
                          flex flex-col items-center gap-2 p-3 rounded-lg border transition-all
                          ${V?"opacity-50 cursor-not-allowed border-[var(--color-border)] bg-[var(--color-surface)]":X?`border-${G.color}-500 bg-${G.color}-50 dark:bg-${G.color}-900/20`:"border-[var(--color-border)] hover:border-[var(--color-border-hover)]"}
                        `,title:V?"A Director already exists. Use the menu on the existing Director card to rename it.":void 0,"data-testid":`role-${W}`,children:[o.jsx(J,{className:`w-6 h-6 ${V?"text-[var(--color-text-tertiary)]":X?`text-${G.color}-600 dark:text-${G.color}-400`:"text-[var(--color-text-secondary)]"}`}),o.jsx("span",{className:`text-sm font-medium capitalize ${V?"text-[var(--color-text-tertiary)]":X?`text-${G.color}-700 dark:text-${G.color}-300`:"text-[var(--color-text)]"}`,children:W}),V&&o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"(exists)"})]},W)})}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:Q.description})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-name",className:"text-sm font-medium text-[var(--color-text)]",children:"Name"}),o.jsx("input",{id:"agent-name",type:"text",value:v.name,onChange:W=>{H(!0),b(G=>({...G,name:W.target.value}))},placeholder:`e.g., ${v.role==="steward"?"Merge Bot":v.role==="worker"?"Alice":"Director"}`,className:`
                  w-full px-3 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,"data-testid":"agent-name"})]}),v.role==="worker"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Worker Mode"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(hee).map(W=>{const G=hee[W],J=v.workerMode===W;return o.jsxs("button",{type:"button",onClick:()=>b(X=>({...X,workerMode:W})),className:`
                          flex items-center gap-2 p-3 rounded-lg border text-left transition-all
                          ${J?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-[var(--color-border)] hover:border-[var(--color-border-hover)]"}
                        `,"data-testid":`worker-mode-${W}`,children:[W==="ephemeral"?o.jsx(Sl,{className:`w-5 h-5 ${J?"text-blue-600 dark:text-blue-400":"text-[var(--color-text-secondary)]"}`}):o.jsx(na,{className:`w-5 h-5 ${J?"text-blue-600 dark:text-blue-400":"text-[var(--color-text-secondary)]"}`}),o.jsxs("div",{children:[o.jsx("div",{className:`text-sm font-medium ${J?"text-blue-700 dark:text-blue-300":"text-[var(--color-text)]"}`,children:G.label}),o.jsx("div",{className:"text-xs text-[var(--color-text-tertiary)]",children:G.description})]})]},W)})})]}),v.role==="steward"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"steward-focus",className:"text-sm font-medium text-[var(--color-text)]",children:"Focus Area"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{id:"steward-focus",value:v.stewardFocus,onChange:W=>b(G=>({...G,stewardFocus:W.target.value})),className:`
                      w-full px-3 py-2 pr-8
                      text-sm
                      bg-[var(--color-surface)]
                      border border-[var(--color-border)]
                      rounded-lg
                      appearance-none
                      focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                    `,"data-testid":"steward-focus",children:Object.keys(BL).map(W=>o.jsx("option",{value:W,children:BL[W].label},W))}),o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:BL[v.stewardFocus].description})]}),v.role==="steward"&&v.stewardFocus==="custom"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"steward-playbook",className:"text-sm font-medium text-[var(--color-text)]",children:"Workflow Template"}),p.length===0?o.jsxs("div",{className:"px-3 py-4 text-sm text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg",children:[o.jsx("p",{className:"mb-2",children:"No workflow templates exist yet. Create one on the Workflows page to use with custom stewards."}),o.jsxs(I6,{to:"/workflows",search:{action:"create",tab:"templates",selected:void 0},className:"inline-flex items-center gap-1 text-sm font-medium text-[var(--color-primary)] hover:text-[var(--color-primary-hover)] transition-colors","data-testid":"create-workflow-template-link",children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Workflow Template"]})]}):o.jsxs("div",{className:"relative",children:[o.jsxs("select",{id:"steward-playbook",value:v.playbookId,onChange:W=>b(G=>({...G,playbookId:W.target.value})),className:`
                        w-full px-3 py-2 pr-8
                        text-sm
                        bg-[var(--color-surface)]
                        border border-[var(--color-border)]
                        rounded-lg
                        appearance-none
                        focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                      `,"data-testid":"steward-playbook",children:[o.jsx("option",{value:"",children:"Select a workflow template..."}),p.map(W=>o.jsx("option",{value:W.id,children:W.title},W.id))]}),o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"The workflow template defines this steward's behavior when its triggers fire."})]}),v.role==="steward"&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Triggers"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsxs("button",{type:"button",onClick:I,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"add-cron-trigger",children:[o.jsx(Rr,{className:"w-3 h-3"}),"Cron"]}),o.jsxs("button",{type:"button",onClick:B,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"add-event-trigger",children:[o.jsx(Sl,{className:"w-3 h-3"}),"Event"]})]})]}),v.triggers.length===0?o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No triggers configured. Steward will only run manually."}):o.jsx("div",{className:"space-y-2",children:v.triggers.map((W,G)=>o.jsxs("div",{className:"flex items-start gap-2 p-2 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg","data-testid":`trigger-${G}`,children:[W.type==="cron"?o.jsxs("div",{className:"flex-1 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Rr,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Cron Schedule"})]}),o.jsx(qpe,{value:W.schedule,onChange:J=>F(G,{...W,schedule:J}),testIdPrefix:`trigger-${G}-schedule`})]}):o.jsxs("div",{className:"flex-1 space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Sl,{className:"w-4 h-4 text-[var(--color-text-secondary)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Event"})]}),o.jsx("input",{type:"text",value:W.event,onChange:J=>F(G,{...W,event:J.target.value}),placeholder:"task_completed",className:`
                                w-full px-2 py-1
                                text-xs
                                bg-[var(--color-bg)]
                                border border-[var(--color-border)]
                                rounded
                                focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                              `,"data-testid":`trigger-${G}-event`}),o.jsx("input",{type:"text",value:W.condition??"",onChange:J=>F(G,{...W,condition:J.target.value||void 0}),placeholder:"Condition (optional)",className:`
                                w-full px-2 py-1
                                text-xs
                                bg-[var(--color-bg)]
                                border border-[var(--color-border)]
                                rounded
                                focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                              `,"data-testid":`trigger-${G}-condition`})]}),o.jsx("button",{type:"button",onClick:()=>q(G),className:"p-1 text-[var(--color-text-tertiary)] hover:text-red-500 transition-colors","aria-label":"Remove trigger","data-testid":`trigger-${G}-remove`,children:o.jsx(pr,{className:"w-4 h-4"})})]},G))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("button",{type:"button",onClick:()=>E(!j),className:"flex items-center gap-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors","data-testid":"toggle-capabilities",children:[o.jsx(Yt,{className:`w-4 h-4 transition-transform ${j?"rotate-180":""}`}),"Settings & Tags"]}),j&&o.jsxs("div",{className:"space-y-3 pl-6",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-tags",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Tags (comma-separated)"}),o.jsx("input",{id:"agent-tags",type:"text",value:v.tags,onChange:W=>b(G=>({...G,tags:W.target.value})),placeholder:"e.g., team-alpha, high-priority",className:`
                        w-full px-3 py-1.5
                        text-sm
                        bg-[var(--color-surface)]
                        border border-[var(--color-border)]
                        rounded-lg
                        placeholder:text-[var(--color-text-tertiary)]
                        focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                      `,"data-testid":"agent-tags"})]}),d&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-provider",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Provider"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{id:"agent-provider",value:v.provider,onChange:W=>M(W.target.value),className:`
                            w-full px-3 py-1.5 pr-8
                            text-sm
                            bg-[var(--color-surface)]
                            border border-[var(--color-border)]
                            rounded-lg
                            appearance-none
                            focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                          `,"data-testid":"agent-provider",children:u.map(W=>o.jsxs("option",{value:W.name,disabled:!W.available,children:[I2(W.name),W.available?"":" (not installed)"]},W.name))}),o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-model",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Model"}),o.jsxs("div",{className:"relative",children:[S?o.jsxs("div",{className:"flex items-center gap-2 py-1.5 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),"Loading models..."]}):o.jsxs("select",{id:"agent-model",value:v.model,onChange:W=>b(G=>({...G,model:W.target.value})),disabled:!v.provider,className:`
                            w-full px-3 py-1.5 pr-8
                            text-sm
                            bg-[var(--color-surface)]
                            border border-[var(--color-border)]
                            rounded-lg
                            appearance-none
                            focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                            disabled:opacity-50 disabled:cursor-not-allowed
                          `,"data-testid":"agent-model",children:[o.jsx("option",{value:"",children:N?`Default (${N.displayName})`:"(Default)"}),k.map(W=>o.jsx("option",{value:W.id,children:W.providerName?`${W.displayName}    ${W.providerName}`:W.displayName},W.id))]}),!S&&o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:A,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"cancel-create-agent",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:L.isPending||!v.name.trim()||v.role==="steward"&&v.stewardFocus==="custom"&&!v.playbookId,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"submit-create-agent",children:L.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(dr,{className:"w-4 h-4"}),"Create ",v.role==="steward"?"Steward":v.role==="worker"?"Worker":"Agent"]})})]})]})]})})]})}function Znt({isOpen:e,onClose:t,agentName:r,onConfirm:n,isDeleting:a}){return w.useEffect(()=>{if(!e)return;const s=i=>{i.key==="Escape"&&!a&&t()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[e,a,t]),e?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"delete-agent-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!a&&t()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-[var(--color-danger-muted)] flex items-center justify-center",children:o.jsx(pr,{className:"w-5 h-5 text-[var(--color-danger)]"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Agent"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Are you sure you want to delete"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',r,'"']}),"? This action cannot be undone."]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:t,disabled:a,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"delete-agent-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:n,disabled:a,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 disabled:opacity-50","data-testid":"delete-agent-confirm-btn",children:a?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})})]})]})]}):null}function Xnt({isOpen:e,onClose:t,agentId:r,currentName:n,onSuccess:a}){const[s,i]=w.useState(n),[l,c]=w.useState(null),u=VQe();if(w.useEffect(()=>{e&&(i(n),c(null))},[e,n]),!e)return null;const d=()=>{c(null),t()},f=async m=>{m.preventDefault(),c(null);const p=s.trim();if(!p){c("Name is required");return}if(p===n){d();return}try{await u.mutateAsync({agentId:r,name:p}),a?.(),d()}catch(v){c(v instanceof Error?v.message:"Failed to rename agent")}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:d,"data-testid":"rename-agent-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-sm
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"rename-agent-dialog",role:"dialog","aria-labelledby":"rename-agent-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"rename-agent-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Rename Agent"}),o.jsx("button",{onClick:d,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"rename-agent-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:f,className:"p-4 space-y-4",children:[l&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),l]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"agent-new-name",className:"text-sm font-medium text-[var(--color-text)]",children:"New Name"}),o.jsx("input",{id:"agent-new-name",type:"text",value:s,onChange:m=>i(m.target.value),placeholder:"Enter new name",className:`
                  w-full px-3 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,"data-testid":"rename-agent-input"})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:d,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"rename-agent-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u.isPending||!s.trim(),className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"rename-agent-submit",children:u.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Renaming..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Uh,{className:"w-4 h-4"}),"Rename"]})})]})]})]})})]})}const pee={title:"",priority:3};function eat({isOpen:e,onClose:t,agent:r,onStart:n,onStartAndOpen:a,isStarting:s=!1}){const[i,l]=w.useState(""),[c,u]=w.useState(""),[d,f]=w.useState(!1),[m,p]=w.useState(pee),[v,b]=w.useState(null),[y,S]=w.useState(null),{data:_,isLoading:N}=S2({assignment:"unassigned"}),k=wme(),j=w.useMemo(()=>(_?.tasks??[]).filter(L=>!L.assignee&&L.status!=="closed"&&L.status!=="tombstone"),[_]);if(w.useEffect(()=>{e&&(l(""),u(""),f(!1),p(pee),b(null),S(null))},[e]),!e)return null;const E=()=>{b(null),t()},T=async($,L="start")=>{$.preventDefault(),b(null),S(L);let A=i;if(d){const M=m.title.trim();if(!M){b("Task title is required"),S(null);return}try{A=(await k.mutateAsync({title:M,priority:m.priority})).task.id}catch(P){b(P instanceof Error?P.message:"Failed to create task"),S(null);return}}if(!A){b("Please select or create a task"),S(null);return}try{await(L==="startAndOpen"&&a?a:n)(r.id,A,c.trim()||void 0),E()}catch(M){b(M instanceof Error?M.message:"Failed to start agent"),S(null)}},O=$=>{const L=$.target.value;L==="__new__"?(f(!0),l("")):(f(!1),l(L))},R=d?m.title.trim().length>0:i.length>0,H=s||k.isPending||y!==null;return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:E,"data-testid":"start-agent-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-md
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"start-agent-dialog",role:"dialog","aria-labelledby":"start-agent-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsxs("h2",{id:"start-agent-title",className:"text-lg font-semibold text-[var(--color-text)]",children:["Start Agent: ",r.name]}),o.jsx("button",{onClick:E,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"start-agent-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:T,className:"p-4 space-y-4",children:[v&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),v]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{htmlFor:"task-select",className:"text-sm font-medium text-[var(--color-text)]",children:["Task ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Select an unassigned task or create a new one for this agent to work on."}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{id:"task-select",value:d?"__new__":i,onChange:O,disabled:N,className:`
                    w-full px-3 py-2 pr-8
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    appearance-none
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                    disabled:opacity-50
                  `,"data-testid":"task-select",children:[o.jsx("option",{value:"",children:N?"Loading tasks...":"Select a task..."}),j.map($=>o.jsx("option",{value:$.id,children:$.title},$.id)),o.jsx("option",{value:"__new__",children:"+ Create new task"})]}),o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]}),d&&o.jsxs("div",{className:"space-y-3 p-3 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-[var(--color-text)]",children:[o.jsx(dr,{className:"w-4 h-4"}),"New Task"]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{htmlFor:"new-task-title",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{id:"new-task-title",type:"text",value:m.title,onChange:$=>p(L=>({...L,title:$.target.value})),placeholder:"Enter task title",className:`
                      w-full px-3 py-2
                      text-sm
                      bg-[var(--color-bg)]
                      border border-[var(--color-border)]
                      rounded-lg
                      placeholder:text-[var(--color-text-tertiary)]
                      focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                    `,autoFocus:!0,"data-testid":"new-task-title"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"new-task-priority",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Priority"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{id:"new-task-priority",value:m.priority,onChange:$=>p(L=>({...L,priority:parseInt($.target.value,10)})),className:`
                        w-full px-3 py-2 pr-8
                        text-sm
                        bg-[var(--color-bg)]
                        border border-[var(--color-border)]
                        rounded-lg
                        appearance-none
                        focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                      `,"data-testid":"new-task-priority",children:[o.jsx("option",{value:1,children:"Critical (P1)"}),o.jsx("option",{value:2,children:"High (P2)"}),o.jsx("option",{value:3,children:"Medium (P3)"}),o.jsx("option",{value:4,children:"Low (P4)"}),o.jsx("option",{value:5,children:"Minimal (P5)"})]}),o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{htmlFor:"initial-message",className:"text-sm font-medium text-[var(--color-text)]",children:["Initial Message ",o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:"(optional)"})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Additional context or instructions for the agent."}),o.jsx("textarea",{id:"initial-message",value:c,onChange:$=>u($.target.value),placeholder:"e.g., Focus on the API endpoints first...",rows:3,className:`
                  w-full px-3 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  resize-none
                `,"data-testid":"initial-message"})]}),i&&!d&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[o.jsx(B6,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0"}),o.jsx("span",{className:"text-blue-700 dark:text-blue-300 truncate",children:j.find($=>$.id===i)?.title??"Selected task"})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:E,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"start-agent-cancel",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:H||!R,className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  border border-[var(--color-border)]
                  hover:bg-[var(--color-surface-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"start-agent-submit",children:H&&y==="start"?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),k.isPending?"Creating task...":"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-4 h-4"}),"Start"]})}),a&&o.jsx("button",{type:"button",onClick:$=>T($,"startAndOpen"),disabled:H||!R,className:`
                    flex items-center gap-2
                    px-4 py-2
                    text-sm font-medium
                    text-white
                    bg-green-600
                    hover:bg-green-500
                    disabled:opacity-50 disabled:cursor-not-allowed
                    rounded-lg
                    transition-colors
                  `,"data-testid":"start-agent-submit-and-open",children:H&&y==="startAndOpen"?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),k.isPending?"Creating task...":"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(wl,{className:"w-4 h-4"}),"Start & Open"]})})]})]})]})})]})}function tat({pool:e,onToggleEnabled:t,onEdit:r,onDelete:n,isUpdating:a}){const{config:s,status:i}=e,l=s.maxSize>0?Math.round(i.activeCount/s.maxSize*100):0;return o.jsxs("div",{className:`
        relative border rounded-lg p-4 bg-[var(--color-surface)]
        ${s.enabled?"border-[var(--color-border)]":"border-dashed border-[var(--color-border)] opacity-60"}
        transition-all duration-200
      `,"data-testid":`pool-card-${e.id}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`p-1.5 rounded-md ${s.enabled?"bg-[var(--color-primary-muted)]":"bg-[var(--color-surface-elevated)]"}`,children:o.jsx(ds,{className:`w-4 h-4 ${s.enabled?"text-[var(--color-primary)]":"text-[var(--color-text-tertiary)]"}`})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-[var(--color-text)]",children:s.name}),s.description&&o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:s.description})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("button",{className:"p-1 rounded-md text-[var(--color-text-tertiary)] hover:text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]","data-testid":`pool-actions-${e.id}`,children:o.jsx(rse,{className:"w-4 h-4"})}),o.jsxs("div",{className:"absolute right-0 top-full mt-1 w-40 py-1 bg-[var(--color-surface-elevated)] border border-[var(--color-border)] rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-150 z-20",children:[t&&o.jsx("button",{onClick:()=>t(!s.enabled),disabled:a,className:"w-full flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text)] disabled:opacity-50",children:s.enabled?o.jsxs(o.Fragment,{children:[o.jsx(sse,{className:"w-4 h-4"}),"Disable"]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-4 h-4"}),"Enable"]})}),r&&o.jsxs("button",{onClick:r,className:"w-full flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text)]",children:[o.jsx(Wa,{className:"w-4 h-4"}),"Edit"]}),n&&o.jsxs("button",{onClick:n,className:"w-full flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-danger)] hover:bg-[var(--color-danger-muted)]",children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})]})]})]}),o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"flex justify-between text-xs text-[var(--color-text-secondary)] mb-1",children:[o.jsx("span",{children:"Capacity"}),o.jsxs("span",{children:[i.activeCount," / ",s.maxSize," (",l,"%)"]})]}),o.jsx("div",{className:"h-2 bg-[var(--color-surface-elevated)] rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full transition-all duration-300 ${l>=90?"bg-[var(--color-danger)]":l>=70?"bg-[var(--color-warning)]":"bg-[var(--color-primary)]"}`,style:{width:`${l}%`}})})]}),s.agentTypes.length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] mb-1",children:"Agent Types"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:s.agentTypes.map((c,u)=>{let d=c.role==="worker"?c.workerMode?`${c.workerMode} worker`:"worker":c.stewardFocus?`${c.stewardFocus} steward`:"steward";return(c.model||c.provider)&&(d+=` (${c.model??c.provider})`),o.jsxs("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)] rounded",children:[d,c.priority!==void 0&&` (p:${c.priority})`]},u)})})]}),i.activeAgentIds.length>0&&o.jsxs("div",{children:[o.jsxs("p",{className:"text-xs text-[var(--color-text-tertiary)] mb-1",children:["Active Agents (",i.activeAgentIds.length,")"]}),o.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.activeAgentIds.slice(0,5).map(c=>o.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-[var(--color-success-muted)] text-[var(--color-success)] rounded font-mono",children:c.slice(0,8)},c)),i.activeAgentIds.length>5&&o.jsxs("span",{className:"px-1.5 py-0.5 text-xs text-[var(--color-text-tertiary)]",children:["+",i.activeAgentIds.length-5," more"]})]})]}),o.jsx("div",{className:"absolute top-2 right-12",children:o.jsx("span",{className:`px-1.5 py-0.5 text-xs rounded ${s.enabled?i.availableSlots>0?"bg-[var(--color-success-muted)] text-[var(--color-success)]":"bg-[var(--color-warning-muted)] text-[var(--color-warning)]":"bg-[var(--color-surface-elevated)] text-[var(--color-text-tertiary)]"}`,children:s.enabled?i.availableSlots>0?`${i.availableSlots} slots`:"Full":"Disabled"})})]})}const rat=/^[a-zA-Z][a-zA-Z0-9_-]*$/;function nat(e){return e.trim()?e.length<1||e.length>64?"Pool name must be 1-64 characters":rat.test(e)?null:"Must start with a letter and contain only letters, numbers, hyphens, or underscores":"Pool name is required"}function Ype(e,t){if(!e.trim())return"Max size is required";const r=parseInt(e,10);return isNaN(r)||!Number.isInteger(r)?"Must be a whole number":r<1||r>1e3?"Must be between 1 and 1000":t!==void 0&&r<t?`Must be >= ${t} (current active agents)`:null}function Qpe(e){if(!e.trim())return null;const t=parseInt(e,10);return isNaN(t)||!Number.isInteger(t)?"Must be a whole number":null}function Jpe(e,t){if(!e.trim())return null;const r=parseInt(e,10);if(isNaN(r)||!Number.isInteger(r))return"Must be a whole number";if(r<1||r>1e3)return"Must be between 1 and 1000";const n=parseInt(t,10);return!isNaN(n)&&r>n?`Must be <= pool max size (${n})`:null}const aat={ephemeral:"Ephemeral",persistent:"Persistent"},sat={merge:"Merge",docs:"Docs",recovery:"Recovery",custom:"Custom"},gee={name:"",description:"",maxSize:"5",agentTypes:[],enabled:!0,tags:""},Zpe={role:"worker",workerMode:"",stewardFocus:"",priority:"0",maxSlots:"",provider:"claude",model:""};function Xpe({index:e,agentType:t,onUpdate:r,onRemove:n}){const{data:a}=g2(),s=w.useMemo(()=>a?.providers??[],[a?.providers]),{data:i,isLoading:l}=v2(t.provider||void 0),c=w.useMemo(()=>i?.models??[],[i?.models]),u=w.useMemo(()=>c.find(m=>m.isDefault),[c]),d=w.useMemo(()=>c.filter(m=>!m.isDefault),[c]),f=m=>{r({provider:m,model:""})};return o.jsxs("div",{className:"p-3 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg space-y-2","data-testid":`agent-type-${e}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:["Agent Type ",e+1]}),o.jsx("button",{type:"button",onClick:n,className:"p-1 text-[var(--color-text-tertiary)] hover:text-red-500 transition-colors","aria-label":"Remove agent type","data-testid":`agent-type-${e}-remove`,children:o.jsx(pr,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Role"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:t.role,onChange:m=>{const p=m.target.value;r({role:p,workerMode:p==="worker"?"":t.workerMode,stewardFocus:p==="steward"?"":t.stewardFocus})},className:`
                w-full px-2 py-1.5 pr-7
                text-xs
                bg-[var(--color-bg)]
                border border-[var(--color-border)]
                rounded
                appearance-none
                focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
              `,"data-testid":`agent-type-${e}-role`,children:[o.jsx("option",{value:"worker",children:"Worker"}),o.jsx("option",{value:"steward",children:"Steward"})]}),o.jsx(Yt,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-[var(--color-text-tertiary)] pointer-events-none"})]})]}),o.jsx("div",{className:"space-y-1",children:t.role==="worker"?o.jsxs(o.Fragment,{children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Mode"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:t.workerMode,onChange:m=>r({workerMode:m.target.value}),className:`
                    w-full px-2 py-1.5 pr-7
                    text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    appearance-none
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`agent-type-${e}-worker-mode`,children:[o.jsx("option",{value:"",children:"Any"}),Object.entries(aat).map(([m,p])=>o.jsx("option",{value:m,children:p},m))]}),o.jsx(Yt,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-[var(--color-text-tertiary)] pointer-events-none"})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Focus"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:t.stewardFocus,onChange:m=>r({stewardFocus:m.target.value}),className:`
                    w-full px-2 py-1.5 pr-7
                    text-xs
                    bg-[var(--color-bg)]
                    border border-[var(--color-border)]
                    rounded
                    appearance-none
                    focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":`agent-type-${e}-steward-focus`,children:[o.jsx("option",{value:"",children:"Any"}),Object.entries(sat).map(([m,p])=>o.jsx("option",{value:m,children:p},m))]}),o.jsx(Yt,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-[var(--color-text-tertiary)] pointer-events-none"})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Priority"}),o.jsx("input",{type:"number",value:t.priority,onChange:m=>r({priority:m.target.value}),placeholder:"0",className:`
              w-full px-2 py-1.5
              text-xs
              bg-[var(--color-bg)]
              border border-[var(--color-border)]
              rounded
              focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
            `,"data-testid":`agent-type-${e}-priority`})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Max Slots"}),o.jsx("input",{type:"number",min:"1",value:t.maxSlots,onChange:m=>r({maxSlots:m.target.value}),placeholder:"No limit",className:`
              w-full px-2 py-1.5
              text-xs
              bg-[var(--color-bg)]
              border border-[var(--color-border)]
              rounded
              focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
            `,"data-testid":`agent-type-${e}-max-slots`})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Provider"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:t.provider,onChange:m=>f(m.target.value),className:`
                w-full px-2 py-1.5 pr-7
                text-xs
                bg-[var(--color-bg)]
                border border-[var(--color-border)]
                rounded
                appearance-none
                focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
              `,"data-testid":`agent-type-${e}-provider`,children:[o.jsx("option",{value:"",children:"Any"}),s.map(m=>o.jsxs("option",{value:m.name,disabled:!m.available,children:[I2(m.name),m.available?"":" (not installed)"]},m.name))]}),o.jsx(Yt,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-[var(--color-text-tertiary)] pointer-events-none"})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Model"}),o.jsxs("div",{className:"relative",children:[l&&t.provider?o.jsxs("div",{className:"flex items-center gap-1.5 py-1.5 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),"Loading..."]}):o.jsxs("select",{value:t.model,onChange:m=>r({model:m.target.value}),disabled:!t.provider,className:`
                  w-full px-2 py-1.5 pr-7
                  text-xs
                  bg-[var(--color-bg)]
                  border border-[var(--color-border)]
                  rounded
                  appearance-none
                  focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]/30
                  disabled:opacity-50 disabled:cursor-not-allowed
                `,"data-testid":`agent-type-${e}-model`,children:[o.jsx("option",{value:"",children:u?`Default (${u.displayName})`:"(Default)"}),d.map(m=>o.jsx("option",{value:m.id,children:m.providerName?`${m.displayName}  ${m.providerName}`:m.displayName},m.id))]}),!(l&&t.provider)&&o.jsx(Yt,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3 h-3 text-[var(--color-text-tertiary)] pointer-events-none"})]})]})]})]})}function iat({isOpen:e,onClose:t,onSuccess:r}){const[n,a]=w.useState({...gee}),[s,i]=w.useState(null),[l,c]=w.useState(!1),u=gZe();if(!e)return null;const d=()=>{a({...gee}),i(null),c(!1),t()},f=()=>{a(b=>({...b,agentTypes:[...b.agentTypes,{...Zpe}]}))},m=(b,y)=>{a(S=>({...S,agentTypes:S.agentTypes.map((_,N)=>N===b?{..._,...y}:_)}))},p=b=>{a(y=>({...y,agentTypes:y.agentTypes.filter((S,_)=>_!==b)}))},v=async b=>{b.preventDefault(),i(null);const y=nat(n.name);if(y){i(y);return}const S=Ype(n.maxSize);if(S){i(`Max size: ${S}`);return}for(let k=0;k<n.agentTypes.length;k++){const j=n.agentTypes[k],E=Qpe(j.priority);if(E){i(`Agent type ${k+1} priority: ${E}`);return}const T=Jpe(j.maxSlots,n.maxSize);if(T){i(`Agent type ${k+1} max slots: ${T}`);return}}const _=n.agentTypes.map(k=>({role:k.role,...k.role==="worker"&&k.workerMode?{workerMode:k.workerMode}:{},...k.role==="steward"&&k.stewardFocus?{stewardFocus:k.stewardFocus}:{},...k.priority.trim()?{priority:parseInt(k.priority,10)}:{},...k.maxSlots.trim()?{maxSlots:parseInt(k.maxSlots,10)}:{},...k.provider.trim()?{provider:k.provider.trim()}:{},...k.model.trim()?{model:k.model.trim()}:{}})),N={name:n.name.trim(),maxSize:parseInt(n.maxSize,10),...n.description.trim()&&{description:n.description.trim()},..._.length>0&&{agentTypes:_},enabled:n.enabled,...n.tags.trim()&&{tags:n.tags.split(",").map(k=>k.trim()).filter(Boolean)}};try{const k=await u.mutateAsync(N);r?.({id:k.id,name:k.config.name}),d()}catch(k){i(k instanceof Error?k.message:"Failed to create pool")}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:d,"data-testid":"create-pool-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-lg max-h-[90vh]
            flex flex-col
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"create-pool-dialog",role:"dialog","aria-labelledby":"create-pool-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ds,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{id:"create-pool-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Create Pool"})]}),o.jsx("button",{onClick:d,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"create-pool-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:v,className:"flex flex-col min-h-0 flex-1",children:[o.jsxs("div",{className:"overflow-y-auto flex-1 min-h-0 p-4 space-y-4",children:[s&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),s]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"pool-name",className:"text-sm font-medium text-[var(--color-text)]",children:"Pool Name"}),o.jsx("input",{id:"pool-name",type:"text",value:n.name,onChange:b=>a(y=>({...y,name:b.target.value})),placeholder:"e.g., worker-pool, build-agents",className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    placeholder:text-[var(--color-text-tertiary)]
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,autoFocus:!0,"data-testid":"pool-name"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Must start with a letter. Letters, numbers, hyphens, underscores only."})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{htmlFor:"pool-description",className:"text-sm font-medium text-[var(--color-text)]",children:["Description",o.jsx("span",{className:"ml-1 text-xs text-[var(--color-text-tertiary)]",children:"(optional)"})]}),o.jsx("input",{id:"pool-description",type:"text",value:n.description,onChange:b=>a(y=>({...y,description:b.target.value})),placeholder:"e.g., Pool for ephemeral build workers",className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    placeholder:text-[var(--color-text-tertiary)]
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":"pool-description"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"pool-max-size",className:"text-sm font-medium text-[var(--color-text)]",children:"Max Concurrent Agents"}),o.jsx("input",{id:"pool-max-size",type:"number",min:"1",max:"1000",value:n.maxSize,onChange:b=>a(y=>({...y,maxSize:b.target.value})),className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":"pool-max-size"}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Maximum number of agents that can run simultaneously in this pool (1-1000)."})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("label",{className:"text-sm font-medium text-[var(--color-text)]",children:["Agent Types",o.jsx("span",{className:"ml-1 text-xs text-[var(--color-text-tertiary)]",children:"(optional)"})]}),o.jsxs("button",{type:"button",onClick:f,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"add-agent-type",children:[o.jsx(dr,{className:"w-3 h-3"}),"Add Type"]})]}),n.agentTypes.length===0?o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No agent types configured. Pool will include all workers and stewards."}):o.jsx("div",{className:"space-y-2",children:n.agentTypes.map((b,y)=>o.jsx(Xpe,{index:y,agentType:b,onUpdate:S=>m(y,S),onRemove:()=>p(y)},y))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("button",{type:"button",onClick:()=>c(!l),className:"flex items-center gap-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors","data-testid":"toggle-advanced",children:[o.jsx(Yt,{className:`w-4 h-4 transition-transform ${l?"rotate-180":""}`}),"Advanced Settings"]}),l&&o.jsxs("div",{className:"space-y-3 pl-6",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:n.enabled,onChange:b=>a(y=>({...y,enabled:b.target.checked})),className:"rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)]","data-testid":"pool-enabled"}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Pool enabled"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"pool-tags",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Tags (comma-separated)"}),o.jsx("input",{id:"pool-tags",type:"text",value:n.tags,onChange:b=>a(y=>({...y,tags:b.target.value})),placeholder:"e.g., production, high-priority",className:`
                          w-full px-3 py-1.5
                          text-sm
                          bg-[var(--color-surface)]
                          border border-[var(--color-border)]
                          rounded-lg
                          placeholder:text-[var(--color-text-tertiary)]
                          focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                        `,"data-testid":"pool-tags"})]})]})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 px-4 py-3 border-t border-[var(--color-border)] flex-shrink-0",children:[o.jsx("button",{type:"button",onClick:d,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"cancel-create-pool",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:u.isPending||!n.name.trim()||!n.maxSize.trim(),className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"submit-create-pool",children:u.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Pool"]})})]})]})]})})]})}function vee(e){const{config:t}=e;return{name:t.name,description:t.description??"",maxSize:String(t.maxSize),agentTypes:t.agentTypes.map(r=>({role:r.role,workerMode:r.workerMode??"",stewardFocus:r.stewardFocus??"",priority:r.priority!==void 0?String(r.priority):"0",maxSlots:r.maxSlots!==void 0?String(r.maxSlots):"",provider:r.provider??"",model:r.model??""})),enabled:t.enabled,tags:t.tags?.join(", ")??""}}function oat({isOpen:e,onClose:t,pool:r,onSuccess:n}){const[a,s]=w.useState(()=>vee(r)),[i,l]=w.useState(null),[c,u]=w.useState(!1),d=Pme();if(w.useEffect(()=>{e&&(s(vee(r)),l(null),u(!r.config.enabled||r.config.tags&&r.config.tags.length>0||!1))},[e,r]),!e)return null;const f=()=>{l(null),t()},m=()=>{s(y=>({...y,agentTypes:[...y.agentTypes,{...Zpe}]}))},p=(y,S)=>{s(_=>({..._,agentTypes:_.agentTypes.map((N,k)=>k===y?{...N,...S}:N)}))},v=y=>{s(S=>({...S,agentTypes:S.agentTypes.filter((_,N)=>N!==y)}))},b=async y=>{y.preventDefault(),l(null);const S=Ype(a.maxSize,r.status.activeCount);if(S){l(`Max size: ${S}`);return}for(let k=0;k<a.agentTypes.length;k++){const j=a.agentTypes[k],E=Qpe(j.priority);if(E){l(`Agent type ${k+1} priority: ${E}`);return}const T=Jpe(j.maxSlots,a.maxSize);if(T){l(`Agent type ${k+1} max slots: ${T}`);return}}const _=a.agentTypes.map(k=>({role:k.role,...k.role==="worker"&&k.workerMode?{workerMode:k.workerMode}:{},...k.role==="steward"&&k.stewardFocus?{stewardFocus:k.stewardFocus}:{},...k.priority.trim()?{priority:parseInt(k.priority,10)}:{},...k.maxSlots.trim()?{maxSlots:parseInt(k.maxSlots,10)}:{},...k.provider.trim()?{provider:k.provider.trim()}:{},...k.model.trim()?{model:k.model.trim()}:{}})),N={id:r.id,maxSize:parseInt(a.maxSize,10),description:a.description.trim()||void 0,agentTypes:_,enabled:a.enabled,tags:a.tags.trim()?a.tags.split(",").map(k=>k.trim()).filter(Boolean):void 0};try{await d.mutateAsync(N),n?.(),f()}catch(k){l(k instanceof Error?k.message:"Failed to update pool")}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:f,"data-testid":"edit-pool-backdrop"}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
            w-full max-w-lg max-h-[90vh]
            flex flex-col
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"edit-pool-dialog",role:"dialog","aria-labelledby":"edit-pool-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Wa,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{id:"edit-pool-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Edit Pool"})]}),o.jsx("button",{onClick:f,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"edit-pool-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:b,className:"flex flex-col min-h-0 flex-1",children:[o.jsxs("div",{className:"overflow-y-auto flex-1 min-h-0 p-4 space-y-4",children:[i&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-4 h-4 flex-shrink-0"}),i]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-sm font-medium text-[var(--color-text)]",children:"Pool Name"}),o.jsx("p",{className:`
                    px-3 py-2
                    text-sm
                    text-[var(--color-text-secondary)]
                    bg-[var(--color-surface-elevated)]
                    border border-[var(--color-border)]
                    rounded-lg
                  `,"data-testid":"edit-pool-name",children:r.config.name}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Pool name cannot be changed after creation."})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("label",{htmlFor:"edit-pool-description",className:"text-sm font-medium text-[var(--color-text)]",children:["Description",o.jsx("span",{className:"ml-1 text-xs text-[var(--color-text-tertiary)]",children:"(optional)"})]}),o.jsx("input",{id:"edit-pool-description",type:"text",value:a.description,onChange:y=>s(S=>({...S,description:y.target.value})),placeholder:"e.g., Pool for ephemeral build workers",className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    placeholder:text-[var(--color-text-tertiary)]
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,autoFocus:!0,"data-testid":"edit-pool-description"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"edit-pool-max-size",className:"text-sm font-medium text-[var(--color-text)]",children:"Max Concurrent Agents"}),o.jsx("input",{id:"edit-pool-max-size",type:"number",min:r.status.activeCount||1,max:"1000",value:a.maxSize,onChange:y=>s(S=>({...S,maxSize:y.target.value})),className:`
                    w-full px-3 py-2
                    text-sm
                    bg-[var(--color-surface)]
                    border border-[var(--color-border)]
                    rounded-lg
                    focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                  `,"data-testid":"edit-pool-max-size"}),o.jsxs("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:["Maximum number of agents that can run simultaneously in this pool (1-1000).",r.status.activeCount>0&&o.jsxs(o.Fragment,{children:[" Currently ",r.status.activeCount," active  cannot set below this."]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("label",{className:"text-sm font-medium text-[var(--color-text)]",children:["Agent Types",o.jsx("span",{className:"ml-1 text-xs text-[var(--color-text-tertiary)]",children:"(optional)"})]}),o.jsxs("button",{type:"button",onClick:m,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-[var(--color-primary)] hover:bg-[var(--color-primary-muted)] rounded transition-colors","data-testid":"edit-add-agent-type",children:[o.jsx(dr,{className:"w-3 h-3"}),"Add Type"]})]}),a.agentTypes.length===0?o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] italic",children:"No agent types configured. Pool will include all workers and stewards."}):o.jsx("div",{className:"space-y-2",children:a.agentTypes.map((y,S)=>o.jsx(Xpe,{index:S,agentType:y,onUpdate:_=>p(S,_),onRemove:()=>v(S)},S))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("button",{type:"button",onClick:()=>u(!c),className:"flex items-center gap-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors","data-testid":"edit-toggle-advanced",children:[o.jsx(Yt,{className:`w-4 h-4 transition-transform ${c?"rotate-180":""}`}),"Advanced Settings"]}),c&&o.jsxs("div",{className:"space-y-3 pl-6",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:a.enabled,onChange:y=>s(S=>({...S,enabled:y.target.checked})),className:"rounded border-[var(--color-border)] text-[var(--color-primary)] focus:ring-[var(--color-primary)]","data-testid":"edit-pool-enabled"}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Pool enabled"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"edit-pool-tags",className:"text-xs font-medium text-[var(--color-text-secondary)]",children:"Tags (comma-separated)"}),o.jsx("input",{id:"edit-pool-tags",type:"text",value:a.tags,onChange:y=>s(S=>({...S,tags:y.target.value})),placeholder:"e.g., production, high-priority",className:`
                          w-full px-3 py-1.5
                          text-sm
                          bg-[var(--color-surface)]
                          border border-[var(--color-border)]
                          rounded-lg
                          placeholder:text-[var(--color-text-tertiary)]
                          focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                        `,"data-testid":"edit-pool-tags"})]})]})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 px-4 py-3 border-t border-[var(--color-border)] flex-shrink-0",children:[o.jsx("button",{type:"button",onClick:f,className:`
                  px-4 py-2
                  text-sm font-medium
                  text-[var(--color-text-secondary)]
                  hover:text-[var(--color-text)]
                  hover:bg-[var(--color-surface-hover)]
                  rounded-lg
                  transition-colors
                `,"data-testid":"cancel-edit-pool",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:d.isPending||!a.maxSize.trim(),className:`
                  flex items-center gap-2
                  px-4 py-2
                  text-sm font-medium
                  text-white
                  bg-[var(--color-primary)]
                  hover:bg-[var(--color-primary-hover)]
                  disabled:opacity-50 disabled:cursor-not-allowed
                  rounded-lg
                  transition-colors
                `,"data-testid":"submit-edit-pool",children:d.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx($x,{className:"w-4 h-4"}),"Save Changes"]})})]})]})]})})]})}function ya(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=ya(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var lat={value:()=>{}};function z2(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new zk(r)}function zk(e){this._=e}function cat(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",a=r.indexOf(".");if(a>=0&&(n=r.slice(a+1),r=r.slice(0,a)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}zk.prototype=z2.prototype={constructor:zk,on:function(e,t){var r=this._,n=cat(e+"",r),a,s=-1,i=n.length;if(arguments.length<2){for(;++s<i;)if((a=(e=n[s]).type)&&(a=uat(r[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(a=(e=n[s]).type)r[a]=bee(r[a],e.name,t);else if(t==null)for(a in r)r[a]=bee(r[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new zk(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var r=new Array(a),n=0,a,s;n<a;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],n=0,a=s.length;n<a;++n)s[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,s=n.length;a<s;++a)n[a].value.apply(t,r)}};function uat(e,t){for(var r=0,n=e.length,a;r<n;++r)if((a=e[r]).name===t)return a.value}function bee(e,t,r){for(var n=0,a=e.length;n<a;++n)if(e[n].name===t){e[n]=lat,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var YP="http://www.w3.org/1999/xhtml";const yee={svg:"http://www.w3.org/2000/svg",xhtml:YP,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function B2(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),yee.hasOwnProperty(t)?{space:yee[t],local:e}:e}function dat(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===YP&&t.documentElement.namespaceURI===YP?t.createElement(e):t.createElementNS(r,e)}}function fat(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ege(e){var t=B2(e);return(t.local?fat:dat)(t)}function hat(){}function GB(e){return e==null?hat:function(){return this.querySelector(e)}}function mat(e){typeof e!="function"&&(e=GB(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var s=t[a],i=s.length,l=n[a]=new Array(i),c,u,d=0;d<i;++d)(c=s[d])&&(u=e.call(c,c.__data__,d,s))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u);return new zi(n,this._parents)}function pat(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function gat(){return[]}function tge(e){return e==null?gat:function(){return this.querySelectorAll(e)}}function vat(e){return function(){return pat(e.apply(this,arguments))}}function bat(e){typeof e=="function"?e=vat(e):e=tge(e);for(var t=this._groups,r=t.length,n=[],a=[],s=0;s<r;++s)for(var i=t[s],l=i.length,c,u=0;u<l;++u)(c=i[u])&&(n.push(e.call(c,c.__data__,u,i)),a.push(c));return new zi(n,a)}function rge(e){return function(){return this.matches(e)}}function nge(e){return function(t){return t.matches(e)}}var yat=Array.prototype.find;function xat(e){return function(){return yat.call(this.children,e)}}function wat(){return this.firstElementChild}function Sat(e){return this.select(e==null?wat:xat(typeof e=="function"?e:nge(e)))}var kat=Array.prototype.filter;function _at(){return Array.from(this.children)}function Nat(e){return function(){return kat.call(this.children,e)}}function Cat(e){return this.selectAll(e==null?_at:Nat(typeof e=="function"?e:nge(e)))}function jat(e){typeof e!="function"&&(e=rge(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var s=t[a],i=s.length,l=n[a]=[],c,u=0;u<i;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&l.push(c);return new zi(n,this._parents)}function age(e){return new Array(e.length)}function Eat(){return new zi(this._enter||this._groups.map(age),this._parents)}function xC(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}xC.prototype={constructor:xC,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Mat(e){return function(){return e}}function Tat(e,t,r,n,a,s){for(var i=0,l,c=t.length,u=s.length;i<u;++i)(l=t[i])?(l.__data__=s[i],n[i]=l):r[i]=new xC(e,s[i]);for(;i<c;++i)(l=t[i])&&(a[i]=l)}function Aat(e,t,r,n,a,s,i){var l,c,u=new Map,d=t.length,f=s.length,m=new Array(d),p;for(l=0;l<d;++l)(c=t[l])&&(m[l]=p=i.call(c,c.__data__,l,t)+"",u.has(p)?a[l]=c:u.set(p,c));for(l=0;l<f;++l)p=i.call(e,s[l],l,s)+"",(c=u.get(p))?(n[l]=c,c.__data__=s[l],u.delete(p)):r[l]=new xC(e,s[l]);for(l=0;l<d;++l)(c=t[l])&&u.get(m[l])===c&&(a[l]=c)}function Dat(e){return e.__data__}function Lat(e,t){if(!arguments.length)return Array.from(this,Dat);var r=t?Aat:Tat,n=this._parents,a=this._groups;typeof e!="function"&&(e=Mat(e));for(var s=a.length,i=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var d=n[u],f=a[u],m=f.length,p=Oat(e.call(d,d&&d.__data__,u,n)),v=p.length,b=l[u]=new Array(v),y=i[u]=new Array(v),S=c[u]=new Array(m);r(d,f,b,y,S,p,t);for(var _=0,N=0,k,j;_<v;++_)if(k=b[_]){for(_>=N&&(N=_+1);!(j=y[N])&&++N<v;);k._next=j||null}}return i=new zi(i,n),i._enter=l,i._exit=c,i}function Oat(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Iat(){return new zi(this._exit||this._groups.map(age),this._parents)}function Rat(e,t,r){var n=this.enter(),a=this,s=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),r==null?s.remove():r(s),n&&a?n.merge(a).order():a}function Pat(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,a=r.length,s=n.length,i=Math.min(a,s),l=new Array(a),c=0;c<i;++c)for(var u=r[c],d=n[c],f=u.length,m=l[c]=new Array(f),p,v=0;v<f;++v)(p=u[v]||d[v])&&(m[v]=p);for(;c<a;++c)l[c]=r[c];return new zi(l,this._parents)}function zat(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],a=n.length-1,s=n[a],i;--a>=0;)(i=n[a])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Bat(e){e||(e=$at);function t(f,m){return f&&m?e(f.__data__,m.__data__):!f-!m}for(var r=this._groups,n=r.length,a=new Array(n),s=0;s<n;++s){for(var i=r[s],l=i.length,c=a[s]=new Array(l),u,d=0;d<l;++d)(u=i[d])&&(c[d]=u);c.sort(t)}return new zi(a,this._parents).order()}function $at(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Fat(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Uat(){return Array.from(this)}function Hat(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,s=n.length;a<s;++a){var i=n[a];if(i)return i}return null}function qat(){let e=0;for(const t of this)++e;return e}function Wat(){return!this.node()}function Kat(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var a=t[r],s=0,i=a.length,l;s<i;++s)(l=a[s])&&e.call(l,l.__data__,s,a);return this}function Gat(e){return function(){this.removeAttribute(e)}}function Vat(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Yat(e,t){return function(){this.setAttribute(e,t)}}function Qat(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Jat(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Zat(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Xat(e,t){var r=B2(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?Vat:Gat:typeof t=="function"?r.local?Zat:Jat:r.local?Qat:Yat)(r,t))}function sge(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function est(e){return function(){this.style.removeProperty(e)}}function tst(e,t,r){return function(){this.style.setProperty(e,t,r)}}function rst(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function nst(e,t,r){return arguments.length>1?this.each((t==null?est:typeof t=="function"?rst:tst)(e,t,r??"")):Ig(this.node(),e)}function Ig(e,t){return e.style.getPropertyValue(t)||sge(e).getComputedStyle(e,null).getPropertyValue(t)}function ast(e){return function(){delete this[e]}}function sst(e,t){return function(){this[e]=t}}function ist(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function ost(e,t){return arguments.length>1?this.each((t==null?ast:typeof t=="function"?ist:sst)(e,t)):this.node()[e]}function ige(e){return e.trim().split(/^|\s+/)}function VB(e){return e.classList||new oge(e)}function oge(e){this._node=e,this._names=ige(e.getAttribute("class")||"")}oge.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function lge(e,t){for(var r=VB(e),n=-1,a=t.length;++n<a;)r.add(t[n])}function cge(e,t){for(var r=VB(e),n=-1,a=t.length;++n<a;)r.remove(t[n])}function lst(e){return function(){lge(this,e)}}function cst(e){return function(){cge(this,e)}}function ust(e,t){return function(){(t.apply(this,arguments)?lge:cge)(this,e)}}function dst(e,t){var r=ige(e+"");if(arguments.length<2){for(var n=VB(this.node()),a=-1,s=r.length;++a<s;)if(!n.contains(r[a]))return!1;return!0}return this.each((typeof t=="function"?ust:t?lst:cst)(r,t))}function fst(){this.textContent=""}function hst(e){return function(){this.textContent=e}}function mst(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function pst(e){return arguments.length?this.each(e==null?fst:(typeof e=="function"?mst:hst)(e)):this.node().textContent}function gst(){this.innerHTML=""}function vst(e){return function(){this.innerHTML=e}}function bst(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function yst(e){return arguments.length?this.each(e==null?gst:(typeof e=="function"?bst:vst)(e)):this.node().innerHTML}function xst(){this.nextSibling&&this.parentNode.appendChild(this)}function wst(){return this.each(xst)}function Sst(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function kst(){return this.each(Sst)}function _st(e){var t=typeof e=="function"?e:ege(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Nst(){return null}function Cst(e,t){var r=typeof e=="function"?e:ege(e),n=t==null?Nst:typeof t=="function"?t:GB(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function jst(){var e=this.parentNode;e&&e.removeChild(this)}function Est(){return this.each(jst)}function Mst(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Tst(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ast(e){return this.select(e?Tst:Mst)}function Dst(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Lst(e){return function(t){e.call(this,t,this.__data__)}}function Ost(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function Ist(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,a=t.length,s;r<a;++r)s=t[r],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++n]=s;++n?t.length=n:delete this.__on}}}function Rst(e,t,r){return function(){var n=this.__on,a,s=Lst(t);if(n){for(var i=0,l=n.length;i<l;++i)if((a=n[i]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=r),a.value=t;return}}this.addEventListener(e.type,s,r),a={type:e.type,name:e.name,value:t,listener:s,options:r},n?n.push(a):this.__on=[a]}}function Pst(e,t,r){var n=Ost(e+""),a,s=n.length,i;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,d;c<u;++c)for(a=0,d=l[c];a<s;++a)if((i=n[a]).type===d.type&&i.name===d.name)return d.value}return}for(l=t?Rst:Ist,a=0;a<s;++a)this.each(l(n[a],t,r));return this}function uge(e,t,r){var n=sge(e),a=n.CustomEvent;typeof a=="function"?a=new a(t,r):(a=n.document.createEvent("Event"),r?(a.initEvent(t,r.bubbles,r.cancelable),a.detail=r.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function zst(e,t){return function(){return uge(this,e,t)}}function Bst(e,t){return function(){return uge(this,e,t.apply(this,arguments))}}function $st(e,t){return this.each((typeof t=="function"?Bst:zst)(e,t))}function*Fst(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],a=0,s=n.length,i;a<s;++a)(i=n[a])&&(yield i)}var dge=[null];function zi(e,t){this._groups=e,this._parents=t}function N1(){return new zi([[document.documentElement]],dge)}function Ust(){return this}zi.prototype=N1.prototype={constructor:zi,select:mat,selectAll:bat,selectChild:Sat,selectChildren:Cat,filter:jat,data:Lat,enter:Eat,exit:Iat,join:Rat,merge:Pat,selection:Ust,order:zat,sort:Bat,call:Fat,nodes:Uat,node:Hat,size:qat,empty:Wat,each:Kat,attr:Xat,style:nst,property:ost,classed:dst,text:pst,html:yst,raise:wst,lower:kst,append:_st,insert:Cst,remove:Est,clone:Ast,datum:Dst,on:Pst,dispatch:$st,[Symbol.iterator]:Fst};function Ti(e){return typeof e=="string"?new zi([[document.querySelector(e)]],[document.documentElement]):new zi([[e]],dge)}function Hst(e){let t;for(;t=e.sourceEvent;)e=t;return e}function zo(e,t){if(e=Hst(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const qst={passive:!1},mx={capture:!0,passive:!1};function $L(e){e.stopImmediatePropagation()}function Up(e){e.preventDefault(),e.stopImmediatePropagation()}function fge(e){var t=e.document.documentElement,r=Ti(e).on("dragstart.drag",Up,mx);"onselectstart"in t?r.on("selectstart.drag",Up,mx):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function hge(e,t){var r=e.document.documentElement,n=Ti(e).on("dragstart.drag",null);t&&(n.on("click.drag",Up,mx),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const HS=e=>()=>e;function QP(e,{sourceEvent:t,subject:r,target:n,identifier:a,active:s,x:i,y:l,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}QP.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Wst(e){return!e.ctrlKey&&!e.button}function Kst(){return this.parentNode}function Gst(e,t){return t??{x:e.x,y:e.y}}function Vst(){return navigator.maxTouchPoints||"ontouchstart"in this}function mge(){var e=Wst,t=Kst,r=Gst,n=Vst,a={},s=z2("start","drag","end"),i=0,l,c,u,d,f=0;function m(k){k.on("mousedown.drag",p).filter(n).on("touchstart.drag",y).on("touchmove.drag",S,qst).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(k,j){if(!(d||!e.call(this,k,j))){var E=N(this,t.call(this,k,j),k,j,"mouse");E&&(Ti(k.view).on("mousemove.drag",v,mx).on("mouseup.drag",b,mx),fge(k.view),$L(k),u=!1,l=k.clientX,c=k.clientY,E("start",k))}}function v(k){if(Up(k),!u){var j=k.clientX-l,E=k.clientY-c;u=j*j+E*E>f}a.mouse("drag",k)}function b(k){Ti(k.view).on("mousemove.drag mouseup.drag",null),hge(k.view,u),Up(k),a.mouse("end",k)}function y(k,j){if(e.call(this,k,j)){var E=k.changedTouches,T=t.call(this,k,j),O=E.length,R,H;for(R=0;R<O;++R)(H=N(this,T,k,j,E[R].identifier,E[R]))&&($L(k),H("start",k,E[R]))}}function S(k){var j=k.changedTouches,E=j.length,T,O;for(T=0;T<E;++T)(O=a[j[T].identifier])&&(Up(k),O("drag",k,j[T]))}function _(k){var j=k.changedTouches,E=j.length,T,O;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),T=0;T<E;++T)(O=a[j[T].identifier])&&($L(k),O("end",k,j[T]))}function N(k,j,E,T,O,R){var H=s.copy(),$=zo(R||E,j),L,A,M;if((M=r.call(k,new QP("beforestart",{sourceEvent:E,target:m,identifier:O,active:i,x:$[0],y:$[1],dx:0,dy:0,dispatch:H}),T))!=null)return L=M.x-$[0]||0,A=M.y-$[1]||0,function P(I,B,F){var q=$,Q;switch(I){case"start":a[O]=P,Q=i++;break;case"end":delete a[O],--i;case"drag":$=zo(F||B,j),Q=i;break}H.call(I,k,new QP(I,{sourceEvent:B,subject:M,target:m,identifier:O,active:Q,x:$[0]+L,y:$[1]+A,dx:$[0]-q[0],dy:$[1]-q[1],dispatch:H}),T)}}return m.filter=function(k){return arguments.length?(e=typeof k=="function"?k:HS(!!k),m):e},m.container=function(k){return arguments.length?(t=typeof k=="function"?k:HS(k),m):t},m.subject=function(k){return arguments.length?(r=typeof k=="function"?k:HS(k),m):r},m.touchable=function(k){return arguments.length?(n=typeof k=="function"?k:HS(!!k),m):n},m.on=function(){var k=s.on.apply(s,arguments);return k===s?m:k},m.clickDistance=function(k){return arguments.length?(f=(k=+k)*k,m):Math.sqrt(f)},m}var Rg=0,kb=0,Fv=0,pge=1e3,wC,_b,SC=0,Ih=0,$2=0,px=typeof performance=="object"&&performance.now?performance:Date,gge=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function YB(){return Ih||(gge(Yst),Ih=px.now()+$2)}function Yst(){Ih=0}function kC(){this._call=this._time=this._next=null}kC.prototype=vge.prototype={constructor:kC,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?YB():+r)+(t==null?0:+t),!this._next&&_b!==this&&(_b?_b._next=this:wC=this,_b=this),this._call=e,this._time=r,JP()},stop:function(){this._call&&(this._call=null,this._time=1/0,JP())}};function vge(e,t,r){var n=new kC;return n.restart(e,t,r),n}function Qst(){YB(),++Rg;for(var e=wC,t;e;)(t=Ih-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Rg}function xee(){Ih=(SC=px.now())+$2,Rg=kb=0;try{Qst()}finally{Rg=0,Zst(),Ih=0}}function Jst(){var e=px.now(),t=e-SC;t>pge&&($2-=t,SC=e)}function Zst(){for(var e,t=wC,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:wC=r);_b=e,JP(n)}function JP(e){if(!Rg){kb&&(kb=clearTimeout(kb));var t=e-Ih;t>24?(e<1/0&&(kb=setTimeout(xee,e-px.now()-$2)),Fv&&(Fv=clearInterval(Fv))):(Fv||(SC=px.now(),Fv=setInterval(Jst,pge)),Rg=1,gge(xee))}}function wee(e,t,r){var n=new kC;return t=t==null?0:+t,n.restart(a=>{n.stop(),e(a+t)},t,r),n}var Xst=z2("start","end","cancel","interrupt"),eit=[],bge=0,See=1,ZP=2,Bk=3,kee=4,XP=5,$k=6;function F2(e,t,r,n,a,s){var i=e.__transition;if(!i)e.__transition={};else if(r in i)return;tit(e,r,{name:t,index:n,group:a,on:Xst,tween:eit,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:bge})}function QB(e,t){var r=al(e,t);if(r.state>bge)throw new Error("too late; already scheduled");return r}function Kl(e,t){var r=al(e,t);if(r.state>Bk)throw new Error("too late; already running");return r}function al(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function tit(e,t,r){var n=e.__transition,a;n[t]=r,r.timer=vge(s,0,r.time);function s(u){r.state=See,r.timer.restart(i,r.delay,r.time),r.delay<=u&&i(u-r.delay)}function i(u){var d,f,m,p;if(r.state!==See)return c();for(d in n)if(p=n[d],p.name===r.name){if(p.state===Bk)return wee(i);p.state===kee?(p.state=$k,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete n[d]):+d<t&&(p.state=$k,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete n[d])}if(wee(function(){r.state===Bk&&(r.state=kee,r.timer.restart(l,r.delay,r.time),l(u))}),r.state=ZP,r.on.call("start",e,e.__data__,r.index,r.group),r.state===ZP){for(r.state=Bk,a=new Array(m=r.tween.length),d=0,f=-1;d<m;++d)(p=r.tween[d].value.call(e,e.__data__,r.index,r.group))&&(a[++f]=p);a.length=f+1}}function l(u){for(var d=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=XP,1),f=-1,m=a.length;++f<m;)a[f].call(e,d);r.state===XP&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=$k,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function Fk(e,t){var r=e.__transition,n,a,s=!0,i;if(r){t=t==null?null:t+"";for(i in r){if((n=r[i]).name!==t){s=!1;continue}a=n.state>ZP&&n.state<XP,n.state=$k,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[i]}s&&delete e.__transition}}function rit(e){return this.each(function(){Fk(this,e)})}function nit(e,t){var r,n;return function(){var a=Kl(this,e),s=a.tween;if(s!==r){n=r=s;for(var i=0,l=n.length;i<l;++i)if(n[i].name===t){n=n.slice(),n.splice(i,1);break}}a.tween=n}}function ait(e,t,r){var n,a;if(typeof r!="function")throw new Error;return function(){var s=Kl(this,e),i=s.tween;if(i!==n){a=(n=i).slice();for(var l={name:t,value:r},c=0,u=a.length;c<u;++c)if(a[c].name===t){a[c]=l;break}c===u&&a.push(l)}s.tween=a}}function sit(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=al(this.node(),r).tween,a=0,s=n.length,i;a<s;++a)if((i=n[a]).name===e)return i.value;return null}return this.each((t==null?nit:ait)(r,e,t))}function JB(e,t,r){var n=e._id;return e.each(function(){var a=Kl(this,n);(a.value||(a.value={}))[t]=r.apply(this,arguments)}),function(a){return al(a,n).value[t]}}function yge(e,t){var r;return(typeof t=="number"?Bo:t instanceof Sh?y_:(r=Sh(t))?(t=r,y_):doe)(e,t)}function iit(e){return function(){this.removeAttribute(e)}}function oit(e){return function(){this.removeAttributeNS(e.space,e.local)}}function lit(e,t,r){var n,a=r+"",s;return function(){var i=this.getAttribute(e);return i===a?null:i===n?s:s=t(n=i,r)}}function cit(e,t,r){var n,a=r+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===n?s:s=t(n=i,r)}}function uit(e,t,r){var n,a,s;return function(){var i,l=r(this),c;return l==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=l+"",i===c?null:i===n&&c===a?s:(a=c,s=t(n=i,l)))}}function dit(e,t,r){var n,a,s;return function(){var i,l=r(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=l+"",i===c?null:i===n&&c===a?s:(a=c,s=t(n=i,l)))}}function fit(e,t){var r=B2(e),n=r==="transform"?mMe:yge;return this.attrTween(e,typeof t=="function"?(r.local?dit:uit)(r,n,JB(this,"attr."+e,t)):t==null?(r.local?oit:iit)(r):(r.local?cit:lit)(r,n,t))}function hit(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function mit(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function pit(e,t){var r,n;function a(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&mit(e,s)),r}return a._value=t,a}function git(e,t){var r,n;function a(){var s=t.apply(this,arguments);return s!==n&&(r=(n=s)&&hit(e,s)),r}return a._value=t,a}function vit(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=B2(e);return this.tween(r,(n.local?pit:git)(n,t))}function bit(e,t){return function(){QB(this,e).delay=+t.apply(this,arguments)}}function yit(e,t){return t=+t,function(){QB(this,e).delay=t}}function xit(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?bit:yit)(t,e)):al(this.node(),t).delay}function wit(e,t){return function(){Kl(this,e).duration=+t.apply(this,arguments)}}function Sit(e,t){return t=+t,function(){Kl(this,e).duration=t}}function kit(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?wit:Sit)(t,e)):al(this.node(),t).duration}function _it(e,t){if(typeof t!="function")throw new Error;return function(){Kl(this,e).ease=t}}function Nit(e){var t=this._id;return arguments.length?this.each(_it(t,e)):al(this.node(),t).ease}function Cit(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Kl(this,e).ease=r}}function jit(e){if(typeof e!="function")throw new Error;return this.each(Cit(this._id,e))}function Eit(e){typeof e!="function"&&(e=rge(e));for(var t=this._groups,r=t.length,n=new Array(r),a=0;a<r;++a)for(var s=t[a],i=s.length,l=n[a]=[],c,u=0;u<i;++u)(c=s[u])&&e.call(c,c.__data__,u,s)&&l.push(c);return new lu(n,this._parents,this._name,this._id)}function Mit(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,a=r.length,s=Math.min(n,a),i=new Array(n),l=0;l<s;++l)for(var c=t[l],u=r[l],d=c.length,f=i[l]=new Array(d),m,p=0;p<d;++p)(m=c[p]||u[p])&&(f[p]=m);for(;l<n;++l)i[l]=t[l];return new lu(i,this._parents,this._name,this._id)}function Tit(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function Ait(e,t,r){var n,a,s=Tit(t)?QB:Kl;return function(){var i=s(this,e),l=i.on;l!==n&&(a=(n=l).copy()).on(t,r),i.on=a}}function Dit(e,t){var r=this._id;return arguments.length<2?al(this.node(),r).on.on(e):this.each(Ait(r,e,t))}function Lit(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function Oit(){return this.on("end.remove",Lit(this._id))}function Iit(e){var t=this._name,r=this._id;typeof e!="function"&&(e=GB(e));for(var n=this._groups,a=n.length,s=new Array(a),i=0;i<a;++i)for(var l=n[i],c=l.length,u=s[i]=new Array(c),d,f,m=0;m<c;++m)(d=l[m])&&(f=e.call(d,d.__data__,m,l))&&("__data__"in d&&(f.__data__=d.__data__),u[m]=f,F2(u[m],t,r,m,u,al(d,r)));return new lu(s,this._parents,t,r)}function Rit(e){var t=this._name,r=this._id;typeof e!="function"&&(e=tge(e));for(var n=this._groups,a=n.length,s=[],i=[],l=0;l<a;++l)for(var c=n[l],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var m=e.call(d,d.__data__,f,c),p,v=al(d,r),b=0,y=m.length;b<y;++b)(p=m[b])&&F2(p,t,r,b,m,v);s.push(m),i.push(d)}return new lu(s,i,t,r)}var Pit=N1.prototype.constructor;function zit(){return new Pit(this._groups,this._parents)}function Bit(e,t){var r,n,a;return function(){var s=Ig(this,e),i=(this.style.removeProperty(e),Ig(this,e));return s===i?null:s===r&&i===n?a:a=t(r=s,n=i)}}function xge(e){return function(){this.style.removeProperty(e)}}function $it(e,t,r){var n,a=r+"",s;return function(){var i=Ig(this,e);return i===a?null:i===n?s:s=t(n=i,r)}}function Fit(e,t,r){var n,a,s;return function(){var i=Ig(this,e),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Ig(this,e))),i===c?null:i===n&&c===a?s:(a=c,s=t(n=i,l))}}function Uit(e,t){var r,n,a,s="style."+t,i="end."+s,l;return function(){var c=Kl(this,e),u=c.on,d=c.value[s]==null?l||(l=xge(t)):void 0;(u!==r||a!==d)&&(n=(r=u).copy()).on(i,a=d),c.on=n}}function Hit(e,t,r){var n=(e+="")=="transform"?hMe:yge;return t==null?this.styleTween(e,Bit(e,n)).on("end.style."+e,xge(e)):typeof t=="function"?this.styleTween(e,Fit(e,n,JB(this,"style."+e,t))).each(Uit(this._id,e)):this.styleTween(e,$it(e,n,t),r).on("end.style."+e,null)}function qit(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function Wit(e,t,r){var n,a;function s(){var i=t.apply(this,arguments);return i!==a&&(n=(a=i)&&qit(e,i,r)),n}return s._value=t,s}function Kit(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Wit(e,t,r??""))}function Git(e){return function(){this.textContent=e}}function Vit(e){return function(){var t=e(this);this.textContent=t??""}}function Yit(e){return this.tween("text",typeof e=="function"?Vit(JB(this,"text",e)):Git(e==null?"":e+""))}function Qit(e){return function(t){this.textContent=e.call(this,t)}}function Jit(e){var t,r;function n(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&Qit(a)),t}return n._value=e,n}function Zit(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Jit(e))}function Xit(){for(var e=this._name,t=this._id,r=wge(),n=this._groups,a=n.length,s=0;s<a;++s)for(var i=n[s],l=i.length,c,u=0;u<l;++u)if(c=i[u]){var d=al(c,t);F2(c,e,r,u,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new lu(n,this._parents,e,r)}function eot(){var e,t,r=this,n=r._id,a=r.size();return new Promise(function(s,i){var l={value:i},c={value:function(){--a===0&&s()}};r.each(function(){var u=Kl(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),u.on=t}),a===0&&s()})}var tot=0;function lu(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function wge(){return++tot}var xc=N1.prototype;lu.prototype={constructor:lu,select:Iit,selectAll:Rit,selectChild:xc.selectChild,selectChildren:xc.selectChildren,filter:Eit,merge:Mit,selection:zit,transition:Xit,call:xc.call,nodes:xc.nodes,node:xc.node,size:xc.size,empty:xc.empty,each:xc.each,on:Dit,attr:fit,attrTween:vit,style:Hit,styleTween:Kit,text:Yit,textTween:Zit,remove:Oit,tween:sit,delay:xit,duration:kit,ease:Nit,easeVarying:jit,end:eot,[Symbol.iterator]:xc[Symbol.iterator]};function rot(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var not={time:null,delay:0,duration:250,ease:rot};function aot(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function sot(e){var t,r;e instanceof lu?(t=e._id,e=e._name):(t=wge(),(r=not).time=YB(),e=e==null?null:e+"");for(var n=this._groups,a=n.length,s=0;s<a;++s)for(var i=n[s],l=i.length,c,u=0;u<l;++u)(c=i[u])&&F2(c,e,t,u,i,r||aot(c,t));return new lu(n,this._parents,e,t)}N1.prototype.interrupt=rit;N1.prototype.transition=sot;const qS=e=>()=>e;function iot(e,{sourceEvent:t,target:r,transform:n,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:a}})}function Kc(e,t,r){this.k=e,this.x=t,this.y=r}Kc.prototype={constructor:Kc,scale:function(e){return e===1?this:new Kc(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Kc(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var U2=new Kc(1,0,0);Sge.prototype=Kc.prototype;function Sge(e){for(;!e.__zoom;)if(!(e=e.parentNode))return U2;return e.__zoom}function FL(e){e.stopImmediatePropagation()}function Uv(e){e.preventDefault(),e.stopImmediatePropagation()}function oot(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function lot(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function _ee(){return this.__zoom||U2}function cot(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function uot(){return navigator.maxTouchPoints||"ontouchstart"in this}function dot(e,t,r){var n=e.invertX(t[0][0])-r[0][0],a=e.invertX(t[1][0])-r[1][0],s=e.invertY(t[0][1])-r[0][1],i=e.invertY(t[1][1])-r[1][1];return e.translate(a>n?(n+a)/2:Math.min(0,n)||Math.max(0,a),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function kge(){var e=oot,t=lot,r=dot,n=cot,a=uot,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],l=250,c=bk,u=z2("start","zoom","end"),d,f,m,p=500,v=150,b=0,y=10;function S(M){M.property("__zoom",_ee).on("wheel.zoom",O,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",H).filter(a).on("touchstart.zoom",$).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}S.transform=function(M,P,I,B){var F=M.selection?M.selection():M;F.property("__zoom",_ee),M!==F?j(M,P,I,B):F.interrupt().each(function(){E(this,arguments).event(B).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},S.scaleBy=function(M,P,I,B){S.scaleTo(M,function(){var F=this.__zoom.k,q=typeof P=="function"?P.apply(this,arguments):P;return F*q},I,B)},S.scaleTo=function(M,P,I,B){S.transform(M,function(){var F=t.apply(this,arguments),q=this.__zoom,Q=I==null?k(F):typeof I=="function"?I.apply(this,arguments):I,W=q.invert(Q),G=typeof P=="function"?P.apply(this,arguments):P;return r(N(_(q,G),Q,W),F,i)},I,B)},S.translateBy=function(M,P,I,B){S.transform(M,function(){return r(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),i)},null,B)},S.translateTo=function(M,P,I,B,F){S.transform(M,function(){var q=t.apply(this,arguments),Q=this.__zoom,W=B==null?k(q):typeof B=="function"?B.apply(this,arguments):B;return r(U2.translate(W[0],W[1]).scale(Q.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof I=="function"?-I.apply(this,arguments):-I),q,i)},B,F)};function _(M,P){return P=Math.max(s[0],Math.min(s[1],P)),P===M.k?M:new Kc(P,M.x,M.y)}function N(M,P,I){var B=P[0]-I[0]*M.k,F=P[1]-I[1]*M.k;return B===M.x&&F===M.y?M:new Kc(M.k,B,F)}function k(M){return[(+M[0][0]+ +M[1][0])/2,(+M[0][1]+ +M[1][1])/2]}function j(M,P,I,B){M.on("start.zoom",function(){E(this,arguments).event(B).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(B).end()}).tween("zoom",function(){var F=this,q=arguments,Q=E(F,q).event(B),W=t.apply(F,q),G=I==null?k(W):typeof I=="function"?I.apply(F,q):I,J=Math.max(W[1][0]-W[0][0],W[1][1]-W[0][1]),X=F.__zoom,V=typeof P=="function"?P.apply(F,q):P,se=c(X.invert(G).concat(J/X.k),V.invert(G).concat(J/V.k));return function(de){if(de===1)de=V;else{var he=se(de),te=J/he[2];de=new Kc(te,G[0]-he[0]*te,G[1]-he[1]*te)}Q.zoom(null,de)}})}function E(M,P,I){return!I&&M.__zooming||new T(M,P)}function T(M,P){this.that=M,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(M,P),this.taps=0}T.prototype={event:function(M){return M&&(this.sourceEvent=M),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(M,P){return this.mouse&&M!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&M!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&M!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(M){var P=Ti(this.that).datum();u.call(M,this.that,new iot(M,{sourceEvent:this.sourceEvent,target:S,transform:this.that.__zoom,dispatch:u}),P)}};function O(M,...P){if(!e.apply(this,arguments))return;var I=E(this,P).event(M),B=this.__zoom,F=Math.max(s[0],Math.min(s[1],B.k*Math.pow(2,n.apply(this,arguments)))),q=zo(M);if(I.wheel)(I.mouse[0][0]!==q[0]||I.mouse[0][1]!==q[1])&&(I.mouse[1]=B.invert(I.mouse[0]=q)),clearTimeout(I.wheel);else{if(B.k===F)return;I.mouse=[q,B.invert(q)],Fk(this),I.start()}Uv(M),I.wheel=setTimeout(Q,v),I.zoom("mouse",r(N(_(B,F),I.mouse[0],I.mouse[1]),I.extent,i));function Q(){I.wheel=null,I.end()}}function R(M,...P){if(m||!e.apply(this,arguments))return;var I=M.currentTarget,B=E(this,P,!0).event(M),F=Ti(M.view).on("mousemove.zoom",G,!0).on("mouseup.zoom",J,!0),q=zo(M,I),Q=M.clientX,W=M.clientY;fge(M.view),FL(M),B.mouse=[q,this.__zoom.invert(q)],Fk(this),B.start();function G(X){if(Uv(X),!B.moved){var V=X.clientX-Q,se=X.clientY-W;B.moved=V*V+se*se>b}B.event(X).zoom("mouse",r(N(B.that.__zoom,B.mouse[0]=zo(X,I),B.mouse[1]),B.extent,i))}function J(X){F.on("mousemove.zoom mouseup.zoom",null),hge(X.view,B.moved),Uv(X),B.event(X).end()}}function H(M,...P){if(e.apply(this,arguments)){var I=this.__zoom,B=zo(M.changedTouches?M.changedTouches[0]:M,this),F=I.invert(B),q=I.k*(M.shiftKey?.5:2),Q=r(N(_(I,q),B,F),t.apply(this,P),i);Uv(M),l>0?Ti(this).transition().duration(l).call(j,Q,B,M):Ti(this).call(S.transform,Q,B,M)}}function $(M,...P){if(e.apply(this,arguments)){var I=M.touches,B=I.length,F=E(this,P,M.changedTouches.length===B).event(M),q,Q,W,G;for(FL(M),Q=0;Q<B;++Q)W=I[Q],G=zo(W,this),G=[G,this.__zoom.invert(G),W.identifier],F.touch0?!F.touch1&&F.touch0[2]!==G[2]&&(F.touch1=G,F.taps=0):(F.touch0=G,q=!0,F.taps=1+!!d);d&&(d=clearTimeout(d)),q&&(F.taps<2&&(f=G[0],d=setTimeout(function(){d=null},p)),Fk(this),F.start())}}function L(M,...P){if(this.__zooming){var I=E(this,P).event(M),B=M.changedTouches,F=B.length,q,Q,W,G;for(Uv(M),q=0;q<F;++q)Q=B[q],W=zo(Q,this),I.touch0&&I.touch0[2]===Q.identifier?I.touch0[0]=W:I.touch1&&I.touch1[2]===Q.identifier&&(I.touch1[0]=W);if(Q=I.that.__zoom,I.touch1){var J=I.touch0[0],X=I.touch0[1],V=I.touch1[0],se=I.touch1[1],de=(de=V[0]-J[0])*de+(de=V[1]-J[1])*de,he=(he=se[0]-X[0])*he+(he=se[1]-X[1])*he;Q=_(Q,Math.sqrt(de/he)),W=[(J[0]+V[0])/2,(J[1]+V[1])/2],G=[(X[0]+se[0])/2,(X[1]+se[1])/2]}else if(I.touch0)W=I.touch0[0],G=I.touch0[1];else return;I.zoom("touch",r(N(Q,W,G),I.extent,i))}}function A(M,...P){if(this.__zooming){var I=E(this,P).event(M),B=M.changedTouches,F=B.length,q,Q;for(FL(M),m&&clearTimeout(m),m=setTimeout(function(){m=null},p),q=0;q<F;++q)Q=B[q],I.touch0&&I.touch0[2]===Q.identifier?delete I.touch0:I.touch1&&I.touch1[2]===Q.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(Q=zo(Q,this),Math.hypot(f[0]-Q[0],f[1]-Q[1])<y)){var W=Ti(this).on("dblclick.zoom");W&&W.apply(this,arguments)}}}return S.wheelDelta=function(M){return arguments.length?(n=typeof M=="function"?M:qS(+M),S):n},S.filter=function(M){return arguments.length?(e=typeof M=="function"?M:qS(!!M),S):e},S.touchable=function(M){return arguments.length?(a=typeof M=="function"?M:qS(!!M),S):a},S.extent=function(M){return arguments.length?(t=typeof M=="function"?M:qS([[+M[0][0],+M[0][1]],[+M[1][0],+M[1][1]]]),S):t},S.scaleExtent=function(M){return arguments.length?(s[0]=+M[0],s[1]=+M[1],S):[s[0],s[1]]},S.translateExtent=function(M){return arguments.length?(i[0][0]=+M[0][0],i[1][0]=+M[1][0],i[0][1]=+M[0][1],i[1][1]=+M[1][1],S):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},S.constrain=function(M){return arguments.length?(r=M,S):r},S.duration=function(M){return arguments.length?(l=+M,S):l},S.interpolate=function(M){return arguments.length?(c=M,S):c},S.on=function(){var M=u.on.apply(u,arguments);return M===u?S:M},S.clickDistance=function(M){return arguments.length?(b=(M=+M)*M,S):Math.sqrt(b)},S.tapDistance=function(M){return arguments.length?(y=+M,S):y},S}const Fl={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:r,targetHandle:n})=>`Couldn't create edge for ${e} handle id: "${e==="source"?r:n}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},gx=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],_ge=["Enter"," ","Escape"],Nge={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:r})=>`Moved selected node ${e}. New position, x: ${t}, y: ${r}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Pg;(function(e){e.Strict="strict",e.Loose="loose"})(Pg||(Pg={}));var fh;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(fh||(fh={}));var vx;(function(e){e.Partial="partial",e.Full="full"})(vx||(vx={}));const Cge={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var hd;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(hd||(hd={}));var _C;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(_C||(_C={}));var zt;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(zt||(zt={}));const Nee={[zt.Left]:zt.Right,[zt.Right]:zt.Left,[zt.Top]:zt.Bottom,[zt.Bottom]:zt.Top};function jge(e){return e===null?null:e?"valid":"invalid"}const Ege=e=>"id"in e&&"source"in e&&"target"in e,fot=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),ZB=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),C1=(e,t=[0,0])=>{const{width:r,height:n}=yu(e),a=e.origin??t,s=r*a[0],i=n*a[1];return{x:e.position.x-s,y:e.position.y-i}},hot=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,a)=>{const s=typeof a=="string";let i=!t.nodeLookup&&!s?a:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(a):ZB(a)?a:t.nodeLookup.get(a.id));const l=i?NC(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return H2(n,l)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return q2(r)},j1=(e,t={})=>{let r={x:1/0,y:1/0,x2:-1/0,y2:-1/0},n=!1;return e.forEach(a=>{(t.filter===void 0||t.filter(a))&&(r=H2(r,NC(a)),n=!0)}),n?q2(r):{x:0,y:0,width:0,height:0}},XB=(e,t,[r,n,a]=[0,0,1],s=!1,i=!1)=>{const l={...M1(t,[r,n,a]),width:t.width/a,height:t.height/a},c=[];for(const u of e.values()){const{measured:d,selectable:f=!0,hidden:m=!1}=u;if(i&&!f||m)continue;const p=d.width??u.width??u.initialWidth??null,v=d.height??u.height??u.initialHeight??null,b=bx(l,Bg(u)),y=(p??0)*(v??0),S=s&&b>0;(!u.internals.handleBounds||S||b>=y||u.dragging)&&c.push(u)}return c},mot=(e,t)=>{const r=new Set;return e.forEach(n=>{r.add(n.id)}),t.filter(n=>r.has(n.source)||r.has(n.target))};function pot(e,t){const r=new Map,n=t?.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&(t?.includeHiddenNodes||!a.hidden)&&(!n||n.has(a.id))&&r.set(a.id,a)}),r}async function got({nodes:e,width:t,height:r,panZoom:n,minZoom:a,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const l=pot(e,i),c=j1(l),u=e$(c,t,r,i?.minZoom??a,i?.maxZoom??s,i?.padding??.1);return await n.setViewport(u,{duration:i?.duration,ease:i?.ease,interpolate:i?.interpolate}),Promise.resolve(!0)}function Mge({nodeId:e,nextPosition:t,nodeLookup:r,nodeOrigin:n=[0,0],nodeExtent:a,onError:s}){const i=r.get(e),l=i.parentId?r.get(i.parentId):void 0,{x:c,y:u}=l?l.internals.positionAbsolute:{x:0,y:0},d=i.origin??n;let f=i.extent||a;if(i.extent==="parent"&&!i.expandParent)if(!l)s?.("005",Fl.error005());else{const p=l.measured.width,v=l.measured.height;p&&v&&(f=[[c,u],[c+p,u+v]])}else l&&$g(i.extent)&&(f=[[i.extent[0][0]+c,i.extent[0][1]+u],[i.extent[1][0]+c,i.extent[1][1]+u]]);const m=$g(f)?Rh(t,f,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&s?.("015",Fl.error015()),{position:{x:m.x-c+(i.measured.width??0)*d[0],y:m.y-u+(i.measured.height??0)*d[1]},positionAbsolute:m}}async function vot({nodesToRemove:e=[],edgesToRemove:t=[],nodes:r,edges:n,onBeforeDelete:a}){const s=new Set(e.map(m=>m.id)),i=[];for(const m of r){if(m.deletable===!1)continue;const p=s.has(m.id),v=!p&&m.parentId&&i.find(b=>b.id===m.parentId);(p||v)&&i.push(m)}const l=new Set(t.map(m=>m.id)),c=n.filter(m=>m.deletable!==!1),d=mot(i,c);for(const m of c)l.has(m.id)&&!d.find(v=>v.id===m.id)&&d.push(m);if(!a)return{edges:d,nodes:i};const f=await a({nodes:i,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:i}:{edges:[],nodes:[]}:f}const zg=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Rh=(e={x:0,y:0},t,r)=>({x:zg(e.x,t[0][0],t[1][0]-(r?.width??0)),y:zg(e.y,t[0][1],t[1][1]-(r?.height??0))});function Tge(e,t,r){const{width:n,height:a}=yu(r),{x:s,y:i}=r.internals.positionAbsolute;return Rh(e,[[s,i],[s+n,i+a]],t)}const Cee=(e,t,r)=>e<t?zg(Math.abs(e-t),1,t)/t:e>r?-zg(Math.abs(e-r),1,t)/t:0,Age=(e,t,r=15,n=40)=>{const a=Cee(e.x,n,t.width-n)*r,s=Cee(e.y,n,t.height-n)*r;return[a,s]},H2=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),e5=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),q2=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),Bg=(e,t=[0,0])=>{const{x:r,y:n}=ZB(e)?e.internals.positionAbsolute:C1(e,t);return{x:r,y:n,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},NC=(e,t=[0,0])=>{const{x:r,y:n}=ZB(e)?e.internals.positionAbsolute:C1(e,t);return{x:r,y:n,x2:r+(e.measured?.width??e.width??e.initialWidth??0),y2:n+(e.measured?.height??e.height??e.initialHeight??0)}},Dge=(e,t)=>q2(H2(e5(e),e5(t))),bx=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},jee=e=>Go(e.width)&&Go(e.height)&&Go(e.x)&&Go(e.y),Go=e=>!isNaN(e)&&isFinite(e),bot=(e,t)=>{},E1=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),M1=({x:e,y:t},[r,n,a],s=!1,i=[1,1])=>{const l={x:(e-r)/a,y:(t-n)/a};return s?E1(l,i):l},CC=({x:e,y:t},[r,n,a])=>({x:e*a+r,y:t*a+n});function ip(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(r)}if(typeof e=="string"&&e.endsWith("%")){const r=parseFloat(e);if(!Number.isNaN(r))return Math.floor(t*r*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function yot(e,t,r){if(typeof e=="string"||typeof e=="number"){const n=ip(e,r),a=ip(e,t);return{top:n,right:a,bottom:n,left:a,x:a*2,y:n*2}}if(typeof e=="object"){const n=ip(e.top??e.y??0,r),a=ip(e.bottom??e.y??0,r),s=ip(e.left??e.x??0,t),i=ip(e.right??e.x??0,t);return{top:n,right:i,bottom:a,left:s,x:s+i,y:n+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function xot(e,t,r,n,a,s){const{x:i,y:l}=CC(e,[t,r,n]),{x:c,y:u}=CC({x:e.x+e.width,y:e.y+e.height},[t,r,n]),d=a-c,f=s-u;return{left:Math.floor(i),top:Math.floor(l),right:Math.floor(d),bottom:Math.floor(f)}}const e$=(e,t,r,n,a,s)=>{const i=yot(s,t,r),l=(t-i.x)/e.width,c=(r-i.y)/e.height,u=Math.min(l,c),d=zg(u,n,a),f=e.x+e.width/2,m=e.y+e.height/2,p=t/2-f*d,v=r/2-m*d,b=xot(e,p,v,d,t,r),y={left:Math.min(b.left-i.left,0),top:Math.min(b.top-i.top,0),right:Math.min(b.right-i.right,0),bottom:Math.min(b.bottom-i.bottom,0)};return{x:p-y.left+y.right,y:v-y.top+y.bottom,zoom:d}},yx=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function $g(e){return e!=null&&e!=="parent"}function yu(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Lge(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Oge(e,t={width:0,height:0},r,n,a){const s={...e},i=n.get(r);if(i){const l=i.origin||a;s.x+=i.internals.positionAbsolute.x-(t.width??0)*l[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*l[1]}return s}function Eee(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function wot(){let e,t;return{promise:new Promise((n,a)=>{e=n,t=a}),resolve:e,reject:t}}function Sot(e){return{...Nge,...e||{}}}function Xb(e,{snapGrid:t=[0,0],snapToGrid:r=!1,transform:n,containerBounds:a}){const{x:s,y:i}=Vo(e),l=M1({x:s-(a?.left??0),y:i-(a?.top??0)},n),{x:c,y:u}=r?E1(l,t):l;return{xSnapped:c,ySnapped:u,...l}}const t$=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ige=e=>e?.getRootNode?.()||window?.document,kot=["INPUT","SELECT","TEXTAREA"];function Rge(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:kot.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Pge=e=>"clientX"in e,Vo=(e,t)=>{const r=Pge(e),n=r?e.clientX:e.touches?.[0].clientX,a=r?e.clientY:e.touches?.[0].clientY;return{x:n-(t?.left??0),y:a-(t?.top??0)}},Mee=(e,t,r,n,a)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const l=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:a,position:i.getAttribute("data-handlepos"),x:(l.left-r.left)/n,y:(l.top-r.top)/n,...t$(i)}})};function zge({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:a,sourceControlY:s,targetControlX:i,targetControlY:l}){const c=e*.125+a*.375+i*.375+r*.125,u=t*.125+s*.375+l*.375+n*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}function WS(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Tee({pos:e,x1:t,y1:r,x2:n,y2:a,c:s}){switch(e){case zt.Left:return[t-WS(t-n,s),r];case zt.Right:return[t+WS(n-t,s),r];case zt.Top:return[t,r-WS(r-a,s)];case zt.Bottom:return[t,r+WS(a-r,s)]}}function Bge({sourceX:e,sourceY:t,sourcePosition:r=zt.Bottom,targetX:n,targetY:a,targetPosition:s=zt.Top,curvature:i=.25}){const[l,c]=Tee({pos:r,x1:e,y1:t,x2:n,y2:a,c:i}),[u,d]=Tee({pos:s,x1:n,y1:a,x2:e,y2:t,c:i}),[f,m,p,v]=zge({sourceX:e,sourceY:t,targetX:n,targetY:a,sourceControlX:l,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${l},${c} ${u},${d} ${n},${a}`,f,m,p,v]}function $ge({sourceX:e,sourceY:t,targetX:r,targetY:n}){const a=Math.abs(r-e)/2,s=r<e?r+a:r-a,i=Math.abs(n-t)/2,l=n<t?n+i:n-i;return[s,l,a,i]}function _ot({sourceNode:e,targetNode:t,selected:r=!1,zIndex:n=0,elevateOnSelect:a=!1,zIndexMode:s="basic"}){if(s==="manual")return n;const i=a&&r?n+1e3:n,l=Math.max(e.parentId||a&&e.selected?e.internals.z:0,t.parentId||a&&t.selected?t.internals.z:0);return i+l}function Not({sourceNode:e,targetNode:t,width:r,height:n,transform:a}){const s=H2(NC(e),NC(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-a[0]/a[2],y:-a[1]/a[2],width:r/a[2],height:n/a[2]};return bx(i,q2(s))>0}const Cot=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`xy-edge__${e}${t||""}-${r}${n||""}`,jot=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),Eot=(e,t,r={})=>{if(!e.source||!e.target)return t;const n=r.getEdgeId||Cot;let a;return Ege(e)?a={...e}:a={...e,id:n(e)},jot(a,t)?t:(a.sourceHandle===null&&delete a.sourceHandle,a.targetHandle===null&&delete a.targetHandle,t.concat(a))};function Fge({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[a,s,i,l]=$ge({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,a,s,i,l]}const Aee={[zt.Left]:{x:-1,y:0},[zt.Right]:{x:1,y:0},[zt.Top]:{x:0,y:-1},[zt.Bottom]:{x:0,y:1}},Mot=({source:e,sourcePosition:t=zt.Bottom,target:r})=>t===zt.Left||t===zt.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Dee=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Tot({source:e,sourcePosition:t=zt.Bottom,target:r,targetPosition:n=zt.Top,center:a,offset:s,stepPosition:i}){const l=Aee[t],c=Aee[n],u={x:e.x+l.x*s,y:e.y+l.y*s},d={x:r.x+c.x*s,y:r.y+c.y*s},f=Mot({source:u,sourcePosition:t,target:d}),m=f.x!==0?"x":"y",p=f[m];let v=[],b,y;const S={x:0,y:0},_={x:0,y:0},[,,N,k]=$ge({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(l[m]*c[m]===-1){m==="x"?(b=a.x??u.x+(d.x-u.x)*i,y=a.y??(u.y+d.y)/2):(b=a.x??(u.x+d.x)/2,y=a.y??u.y+(d.y-u.y)*i);const E=[{x:b,y:u.y},{x:b,y:d.y}],T=[{x:u.x,y},{x:d.x,y}];l[m]===p?v=m==="x"?E:T:v=m==="x"?T:E}else{const E=[{x:u.x,y:d.y}],T=[{x:d.x,y:u.y}];if(m==="x"?v=l.x===p?T:E:v=l.y===p?E:T,t===n){const L=Math.abs(e[m]-r[m]);if(L<=s){const A=Math.min(s-1,s-L);l[m]===p?S[m]=(u[m]>e[m]?-1:1)*A:_[m]=(d[m]>r[m]?-1:1)*A}}if(t!==n){const L=m==="x"?"y":"x",A=l[m]===c[L],M=u[L]>d[L],P=u[L]<d[L];(l[m]===1&&(!A&&M||A&&P)||l[m]!==1&&(!A&&P||A&&M))&&(v=m==="x"?E:T)}const O={x:u.x+S.x,y:u.y+S.y},R={x:d.x+_.x,y:d.y+_.y},H=Math.max(Math.abs(O.x-v[0].x),Math.abs(R.x-v[0].x)),$=Math.max(Math.abs(O.y-v[0].y),Math.abs(R.y-v[0].y));H>=$?(b=(O.x+R.x)/2,y=v[0].y):(b=v[0].x,y=(O.y+R.y)/2)}return[[e,{x:u.x+S.x,y:u.y+S.y},...v,{x:d.x+_.x,y:d.y+_.y},r],b,y,N,k]}function Aot(e,t,r,n){const a=Math.min(Dee(e,t)/2,Dee(t,r)/2,n),{x:s,y:i}=t;if(e.x===s&&s===r.x||e.y===i&&i===r.y)return`L${s} ${i}`;if(e.y===i){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${s+a*u},${i}Q ${s},${i} ${s},${i+a*d}`}const l=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${s},${i+a*c}Q ${s},${i} ${s+a*l},${i}`}function t5({sourceX:e,sourceY:t,sourcePosition:r=zt.Bottom,targetX:n,targetY:a,targetPosition:s=zt.Top,borderRadius:i=5,centerX:l,centerY:c,offset:u=20,stepPosition:d=.5}){const[f,m,p,v,b]=Tot({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:a},targetPosition:s,center:{x:l,y:c},offset:u,stepPosition:d});return[f.reduce((S,_,N)=>{let k="";return N>0&&N<f.length-1?k=Aot(f[N-1],_,f[N+1],i):k=`${N===0?"M":"L"}${_.x} ${_.y}`,S+=k,S},""),m,p,v,b]}function Lee(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Dot(e){const{sourceNode:t,targetNode:r}=e;if(!Lee(t)||!Lee(r))return null;const n=t.internals.handleBounds||Oee(t.handles),a=r.internals.handleBounds||Oee(r.handles),s=Iee(n?.source??[],e.sourceHandle),i=Iee(e.connectionMode===Pg.Strict?a?.target??[]:(a?.target??[]).concat(a?.source??[]),e.targetHandle);if(!s||!i)return e.onError?.("008",Fl.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const l=s?.position||zt.Bottom,c=i?.position||zt.Top,u=Ph(t,s,l),d=Ph(r,i,c);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y,sourcePosition:l,targetPosition:c}}function Oee(e){if(!e)return null;const t=[],r=[];for(const n of e)n.width=n.width??1,n.height=n.height??1,n.type==="source"?t.push(n):n.type==="target"&&r.push(n);return{source:t,target:r}}function Ph(e,t,r=zt.Left,n=!1){const a=(t?.x??0)+e.internals.positionAbsolute.x,s=(t?.y??0)+e.internals.positionAbsolute.y,{width:i,height:l}=t??yu(e);if(n)return{x:a+i/2,y:s+l/2};switch(t?.position??r){case zt.Top:return{x:a+i/2,y:s};case zt.Right:return{x:a+i,y:s+l/2};case zt.Bottom:return{x:a+i/2,y:s+l};case zt.Left:return{x:a,y:s+l/2}}}function Iee(e,t){return e&&(t?e.find(r=>r.id===t):e[0])||null}function r5(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`:""}function Lot(e,{id:t,defaultColor:r,defaultMarkerStart:n,defaultMarkerEnd:a}){const s=new Set;return e.reduce((i,l)=>([l.markerStart||n,l.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const u=r5(c,t);s.has(u)||(i.push({id:u,color:c.color||r,...c}),s.add(u))}}),i),[]).sort((i,l)=>i.id.localeCompare(l.id))}const Uge=1e3,Oot=10,r$={nodeOrigin:[0,0],nodeExtent:gx,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},Iot={...r$,checkEquality:!0};function n$(e,t){const r={...e};for(const n in t)t[n]!==void 0&&(r[n]=t[n]);return r}function Rot(e,t,r){const n=n$(r$,r);for(const a of e.values())if(a.parentId)s$(a,e,t,n);else{const s=C1(a,n.nodeOrigin),i=$g(a.extent)?a.extent:n.nodeExtent,l=Rh(s,i,yu(a));a.internals.positionAbsolute=l}}function Pot(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const r=[],n=[];for(const a of e.handles){const s={id:a.id,width:a.width??1,height:a.height??1,nodeId:e.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?r.push(s):a.type==="target"&&n.push(s)}return{source:r,target:n}}function a$(e){return e==="manual"}function n5(e,t,r,n={}){const a=n$(Iot,n),s={i:0},i=new Map(t),l=a?.elevateNodesOnSelect&&!a$(a.zIndexMode)?Uge:0;let c=e.length>0;t.clear(),r.clear();for(const u of e){let d=i.get(u.id);if(a.checkEquality&&u===d?.internals.userNode)t.set(u.id,d);else{const f=C1(u,a.nodeOrigin),m=$g(u.extent)?u.extent:a.nodeExtent,p=Rh(f,m,yu(u));d={...a.defaults,...u,measured:{width:u.measured?.width,height:u.measured?.height},internals:{positionAbsolute:p,handleBounds:Pot(u,d),z:Hge(u,l,a.zIndexMode),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(c=!1),u.parentId&&s$(d,t,r,n,s)}return c}function zot(e,t){if(!e.parentId)return;const r=t.get(e.parentId);r?r.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function s$(e,t,r,n,a){const{elevateNodesOnSelect:s,nodeOrigin:i,nodeExtent:l,zIndexMode:c}=n$(r$,n),u=e.parentId,d=t.get(u);if(!d){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}zot(e,r),a&&!d.parentId&&d.internals.rootParentIndex===void 0&&c==="auto"&&(d.internals.rootParentIndex=++a.i,d.internals.z=d.internals.z+a.i*Oot),a&&d.internals.rootParentIndex!==void 0&&(a.i=d.internals.rootParentIndex);const f=s&&!a$(c)?Uge:0,{x:m,y:p,z:v}=Bot(e,d,i,l,f,c),{positionAbsolute:b}=e.internals,y=m!==b.x||p!==b.y;(y||v!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:m,y:p}:b,z:v}})}function Hge(e,t,r){const n=Go(e.zIndex)?e.zIndex:0;return a$(r)?n:n+(e.selected?t:0)}function Bot(e,t,r,n,a,s){const{x:i,y:l}=t.internals.positionAbsolute,c=yu(e),u=C1(e,r),d=$g(e.extent)?Rh(u,e.extent,c):u;let f=Rh({x:i+d.x,y:l+d.y},n,c);e.extent==="parent"&&(f=Tge(f,c,t));const m=Hge(e,a,s),p=t.internals.z??0;return{x:f.x,y:f.y,z:p>=m?p+1:m}}function i$(e,t,r,n=[0,0]){const a=[],s=new Map;for(const i of e){const l=t.get(i.parentId);if(!l)continue;const c=s.get(i.parentId)?.expandedRect??Bg(l),u=Dge(c,i.rect);s.set(i.parentId,{expandedRect:u,parent:l})}return s.size>0&&s.forEach(({expandedRect:i,parent:l},c)=>{const u=l.internals.positionAbsolute,d=yu(l),f=l.origin??n,m=i.x<u.x?Math.round(Math.abs(u.x-i.x)):0,p=i.y<u.y?Math.round(Math.abs(u.y-i.y)):0,v=Math.max(d.width,Math.round(i.width)),b=Math.max(d.height,Math.round(i.height)),y=(v-d.width)*f[0],S=(b-d.height)*f[1];(m>0||p>0||y||S)&&(a.push({id:c,type:"position",position:{x:l.position.x-m+y,y:l.position.y-p+S}}),r.get(c)?.forEach(_=>{e.some(N=>N.id===_.id)||a.push({id:_.id,type:"position",position:{x:_.position.x+m,y:_.position.y+p}})})),(d.width<i.width||d.height<i.height||m||p)&&a.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:v+(m?f[0]*m-y:0),height:b+(p?f[1]*p-S:0)}})}),a}function $ot(e,t,r,n,a,s,i){const l=n?.querySelector(".xyflow__viewport");let c=!1;if(!l)return{changes:[],updatedInternals:c};const u=[],d=window.getComputedStyle(l),{m22:f}=new window.DOMMatrixReadOnly(d.transform),m=[];for(const p of e.values()){const v=t.get(p.id);if(!v)continue;if(v.hidden){t.set(v.id,{...v,internals:{...v.internals,handleBounds:void 0}}),c=!0;continue}const b=t$(p.nodeElement),y=v.measured.width!==b.width||v.measured.height!==b.height;if(!!(b.width&&b.height&&(y||!v.internals.handleBounds||p.force))){const _=p.nodeElement.getBoundingClientRect(),N=$g(v.extent)?v.extent:s;let{positionAbsolute:k}=v.internals;v.parentId&&v.extent==="parent"?k=Tge(k,b,t.get(v.parentId)):N&&(k=Rh(k,N,b));const j={...v,measured:b,internals:{...v.internals,positionAbsolute:k,handleBounds:{source:Mee("source",p.nodeElement,_,f,v.id),target:Mee("target",p.nodeElement,_,f,v.id)}}};t.set(v.id,j),v.parentId&&s$(j,t,r,{nodeOrigin:a,zIndexMode:i}),c=!0,y&&(u.push({id:v.id,type:"dimensions",dimensions:b}),v.expandParent&&v.parentId&&m.push({id:v.id,parentId:v.parentId,rect:Bg(j,a)}))}}if(m.length>0){const p=i$(m,t,r,a);u.push(...p)}return{changes:u,updatedInternals:c}}async function Fot({delta:e,panZoom:t,transform:r,translateExtent:n,width:a,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:r[0]+e.x,y:r[1]+e.y,zoom:r[2]},[[0,0],[a,s]],n),l=!!i&&(i.x!==r[0]||i.y!==r[1]||i.k!==r[2]);return Promise.resolve(l)}function Ree(e,t,r,n,a,s){let i=a;const l=n.get(i)||new Map;n.set(i,l.set(r,t)),i=`${a}-${e}`;const c=n.get(i)||new Map;if(n.set(i,c.set(r,t)),s){i=`${a}-${e}-${s}`;const u=n.get(i)||new Map;n.set(i,u.set(r,t))}}function qge(e,t,r){e.clear(),t.clear();for(const n of r){const{source:a,target:s,sourceHandle:i=null,targetHandle:l=null}=n,c={edgeId:n.id,source:a,target:s,sourceHandle:i,targetHandle:l},u=`${a}-${i}--${s}-${l}`,d=`${s}-${l}--${a}-${i}`;Ree("source",c,d,e,a,i),Ree("target",c,u,e,s,l),t.set(n.id,n)}}function Wge(e,t){if(!e.parentId)return!1;const r=t.get(e.parentId);return r?r.selected?!0:Wge(r,t):!1}function Pee(e,t,r){let n=e;do{if(n?.matches?.(t))return!0;if(n===r)return!1;n=n?.parentElement}while(n);return!1}function Uot(e,t,r,n){const a=new Map;for(const[s,i]of e)if((i.selected||i.id===n)&&(!i.parentId||!Wge(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const l=e.get(s);l&&a.set(s,{id:s,position:l.position||{x:0,y:0},distance:{x:r.x-l.internals.positionAbsolute.x,y:r.y-l.internals.positionAbsolute.y},extent:l.extent,parentId:l.parentId,origin:l.origin,expandParent:l.expandParent,internals:{positionAbsolute:l.internals.positionAbsolute||{x:0,y:0}},measured:{width:l.measured.width??0,height:l.measured.height??0}})}return a}function UL({nodeId:e,dragItems:t,nodeLookup:r,dragging:n=!0}){const a=[];for(const[i,l]of t){const c=r.get(i)?.internals.userNode;c&&a.push({...c,position:l.position,dragging:n})}if(!e)return[a[0],a];const s=r.get(e)?.internals.userNode;return[s?{...s,position:t.get(e)?.position||s.position,dragging:n}:a[0],a]}function Hot({dragItems:e,snapGrid:t,x:r,y:n}){const a=e.values().next().value;if(!a)return null;const s={x:r-a.distance.x,y:n-a.distance.y},i=E1(s,t);return{x:i.x-s.x,y:i.y-s.y}}function qot({onNodeMouseDown:e,getStoreItems:t,onDragStart:r,onDrag:n,onDragStop:a}){let s={x:null,y:null},i=0,l=new Map,c=!1,u={x:0,y:0},d=null,f=!1,m=null,p=!1,v=!1,b=null;function y({noDragClassName:_,handleSelector:N,domNode:k,isSelectable:j,nodeId:E,nodeClickDistance:T=0}){m=Ti(k);function O({x:L,y:A}){const{nodeLookup:M,nodeExtent:P,snapGrid:I,snapToGrid:B,nodeOrigin:F,onNodeDrag:q,onSelectionDrag:Q,onError:W,updateNodePositions:G}=t();s={x:L,y:A};let J=!1;const X=l.size>1,V=X&&P?e5(j1(l)):null,se=X&&B?Hot({dragItems:l,snapGrid:I,x:L,y:A}):null;for(const[de,he]of l){if(!M.has(de))continue;let te={x:L-he.distance.x,y:A-he.distance.y};B&&(te=se?{x:Math.round(te.x+se.x),y:Math.round(te.y+se.y)}:E1(te,I));let le=null;if(X&&P&&!he.extent&&V){const{positionAbsolute:ve}=he.internals,U=ve.x-V.x+P[0][0],ge=ve.x+he.measured.width-V.x2+P[1][0],ue=ve.y-V.y+P[0][1],re=ve.y+he.measured.height-V.y2+P[1][1];le=[[U,ue],[ge,re]]}const{position:oe,positionAbsolute:Z}=Mge({nodeId:de,nextPosition:te,nodeLookup:M,nodeExtent:le||P,nodeOrigin:F,onError:W});J=J||he.position.x!==oe.x||he.position.y!==oe.y,he.position=oe,he.internals.positionAbsolute=Z}if(v=v||J,!!J&&(G(l,!0),b&&(n||q||!E&&Q))){const[de,he]=UL({nodeId:E,dragItems:l,nodeLookup:M});n?.(b,l,de,he),q?.(b,de,he),E||Q?.(b,he)}}async function R(){if(!d)return;const{transform:L,panBy:A,autoPanSpeed:M,autoPanOnNodeDrag:P}=t();if(!P){c=!1,cancelAnimationFrame(i);return}const[I,B]=Age(u,d,M);(I!==0||B!==0)&&(s.x=(s.x??0)-I/L[2],s.y=(s.y??0)-B/L[2],await A({x:I,y:B})&&O(s)),i=requestAnimationFrame(R)}function H(L){const{nodeLookup:A,multiSelectionActive:M,nodesDraggable:P,transform:I,snapGrid:B,snapToGrid:F,selectNodesOnDrag:q,onNodeDragStart:Q,onSelectionDragStart:W,unselectNodesAndEdges:G}=t();f=!0,(!q||!j)&&!M&&E&&(A.get(E)?.selected||G()),j&&q&&E&&e?.(E);const J=Xb(L.sourceEvent,{transform:I,snapGrid:B,snapToGrid:F,containerBounds:d});if(s=J,l=Uot(A,P,J,E),l.size>0&&(r||Q||!E&&W)){const[X,V]=UL({nodeId:E,dragItems:l,nodeLookup:A});r?.(L.sourceEvent,l,X,V),Q?.(L.sourceEvent,X,V),E||W?.(L.sourceEvent,V)}}const $=mge().clickDistance(T).on("start",L=>{const{domNode:A,nodeDragThreshold:M,transform:P,snapGrid:I,snapToGrid:B}=t();d=A?.getBoundingClientRect()||null,p=!1,v=!1,b=L.sourceEvent,M===0&&H(L),s=Xb(L.sourceEvent,{transform:P,snapGrid:I,snapToGrid:B,containerBounds:d}),u=Vo(L.sourceEvent,d)}).on("drag",L=>{const{autoPanOnNodeDrag:A,transform:M,snapGrid:P,snapToGrid:I,nodeDragThreshold:B,nodeLookup:F}=t(),q=Xb(L.sourceEvent,{transform:M,snapGrid:P,snapToGrid:I,containerBounds:d});if(b=L.sourceEvent,(L.sourceEvent.type==="touchmove"&&L.sourceEvent.touches.length>1||E&&!F.has(E))&&(p=!0),!p){if(!c&&A&&f&&(c=!0,R()),!f){const Q=Vo(L.sourceEvent,d),W=Q.x-u.x,G=Q.y-u.y;Math.sqrt(W*W+G*G)>B&&H(L)}(s.x!==q.xSnapped||s.y!==q.ySnapped)&&l&&f&&(u=Vo(L.sourceEvent,d),O(q))}}).on("end",L=>{if(!(!f||p)&&(c=!1,f=!1,cancelAnimationFrame(i),l.size>0)){const{nodeLookup:A,updateNodePositions:M,onNodeDragStop:P,onSelectionDragStop:I}=t();if(v&&(M(l,!1),v=!1),a||P||!E&&I){const[B,F]=UL({nodeId:E,dragItems:l,nodeLookup:A,dragging:!1});a?.(L.sourceEvent,l,B,F),P?.(L.sourceEvent,B,F),E||I?.(L.sourceEvent,F)}}}).filter(L=>{const A=L.target;return!L.button&&(!_||!Pee(A,`.${_}`,k))&&(!N||Pee(A,N,k))});m.call($)}function S(){m?.on(".drag",null)}return{update:y,destroy:S}}function Wot(e,t,r){const n=[],a={x:e.x-r,y:e.y-r,width:r*2,height:r*2};for(const s of t.values())bx(a,Bg(s))>0&&n.push(s);return n}const Kot=250;function Got(e,t,r,n){let a=[],s=1/0;const i=Wot(e,r,t+Kot);for(const l of i){const c=[...l.internals.handleBounds?.source??[],...l.internals.handleBounds?.target??[]];for(const u of c){if(n.nodeId===u.nodeId&&n.type===u.type&&n.id===u.id)continue;const{x:d,y:f}=Ph(l,u,u.position,!0),m=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(f-e.y,2));m>t||(m<s?(a=[{...u,x:d,y:f}],s=m):m===s&&a.push({...u,x:d,y:f}))}}if(!a.length)return null;if(a.length>1){const l=n.type==="source"?"target":"source";return a.find(c=>c.type===l)??a[0]}return a[0]}function Kge(e,t,r,n,a,s=!1){const i=n.get(e);if(!i)return null;const l=a==="strict"?i.internals.handleBounds?.[t]:[...i.internals.handleBounds?.source??[],...i.internals.handleBounds?.target??[]],c=(r?l?.find(u=>u.id===r):l?.[0])??null;return c&&s?{...c,...Ph(i,c,c.position,!0)}:c}function Gge(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Vot(e,t){let r=null;return t?r=!0:e&&!t&&(r=!1),r}const Vge=()=>!0;function Yot(e,{connectionMode:t,connectionRadius:r,handleId:n,nodeId:a,edgeUpdaterType:s,isTarget:i,domNode:l,nodeLookup:c,lib:u,autoPanOnConnect:d,flowId:f,panBy:m,cancelConnection:p,onConnectStart:v,onConnect:b,onConnectEnd:y,isValidConnection:S=Vge,onReconnectEnd:_,updateConnection:N,getTransform:k,getFromHandle:j,autoPanSpeed:E,dragThreshold:T=1,handleDomNode:O}){const R=Ige(e.target);let H=0,$;const{x:L,y:A}=Vo(e),M=Gge(s,O),P=l?.getBoundingClientRect();let I=!1;if(!P||!M)return;const B=Kge(a,M,n,c,t);if(!B)return;let F=Vo(e,P),q=!1,Q=null,W=!1,G=null;function J(){if(!d||!P)return;const[oe,Z]=Age(F,P,E);m({x:oe,y:Z}),H=requestAnimationFrame(J)}const X={...B,nodeId:a,type:M,position:B.position},V=c.get(a);let de={inProgress:!0,isValid:null,from:Ph(V,X,zt.Left,!0),fromHandle:X,fromPosition:X.position,fromNode:V,to:F,toHandle:null,toPosition:Nee[X.position],toNode:null,pointer:F};function he(){I=!0,N(de),v?.(e,{nodeId:a,handleId:n,handleType:M})}T===0&&he();function te(oe){if(!I){const{x:re,y:ne}=Vo(oe),me=re-L,ke=ne-A;if(!(me*me+ke*ke>T*T))return;he()}if(!j()||!X){le(oe);return}const Z=k();F=Vo(oe,P),$=Got(M1(F,Z,!1,[1,1]),r,c,X),q||(J(),q=!0);const ve=Yge(oe,{handle:$,connectionMode:t,fromNodeId:a,fromHandleId:n,fromType:i?"target":"source",isValidConnection:S,doc:R,lib:u,flowId:f,nodeLookup:c});G=ve.handleDomNode,Q=ve.connection,W=Vot(!!$,ve.isValid);const U=c.get(a),ge=U?Ph(U,X,zt.Left,!0):de.from,ue={...de,from:ge,isValid:W,to:ve.toHandle&&W?CC({x:ve.toHandle.x,y:ve.toHandle.y},Z):F,toHandle:ve.toHandle,toPosition:W&&ve.toHandle?ve.toHandle.position:Nee[X.position],toNode:ve.toHandle?c.get(ve.toHandle.nodeId):null,pointer:F};N(ue),de=ue}function le(oe){if(!("touches"in oe&&oe.touches.length>0)){if(I){($||G)&&Q&&W&&b?.(Q);const{inProgress:Z,...ve}=de,U={...ve,toPosition:de.toHandle?de.toPosition:null};y?.(oe,U),s&&_?.(oe,U)}p(),cancelAnimationFrame(H),q=!1,W=!1,Q=null,G=null,R.removeEventListener("mousemove",te),R.removeEventListener("mouseup",le),R.removeEventListener("touchmove",te),R.removeEventListener("touchend",le)}}R.addEventListener("mousemove",te),R.addEventListener("mouseup",le),R.addEventListener("touchmove",te),R.addEventListener("touchend",le)}function Yge(e,{handle:t,connectionMode:r,fromNodeId:n,fromHandleId:a,fromType:s,doc:i,lib:l,flowId:c,isValidConnection:u=Vge,nodeLookup:d}){const f=s==="target",m=t?i.querySelector(`.${l}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:v}=Vo(e),b=i.elementFromPoint(p,v),y=b?.classList.contains(`${l}-flow__handle`)?b:m,S={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const _=Gge(void 0,y),N=y.getAttribute("data-nodeid"),k=y.getAttribute("data-handleid"),j=y.classList.contains("connectable"),E=y.classList.contains("connectableend");if(!N||!_)return S;const T={source:f?N:n,sourceHandle:f?k:a,target:f?n:N,targetHandle:f?a:k};S.connection=T;const R=j&&E&&(r===Pg.Strict?f&&_==="source"||!f&&_==="target":N!==n||k!==a);S.isValid=R&&u(T),S.toHandle=Kge(N,_,k,d,r,!0)}return S}const a5={onPointerDown:Yot,isValid:Yge};function Qot({domNode:e,panZoom:t,getTransform:r,getViewScale:n}){const a=Ti(e);function s({translateExtent:l,width:c,height:u,zoomStep:d=1,pannable:f=!0,zoomable:m=!0,inversePan:p=!1}){const v=N=>{if(N.sourceEvent.type!=="wheel"||!t)return;const k=r(),j=N.sourceEvent.ctrlKey&&yx()?10:1,E=-N.sourceEvent.deltaY*(N.sourceEvent.deltaMode===1?.05:N.sourceEvent.deltaMode?1:.002)*d,T=k[2]*Math.pow(2,E*j);t.scaleTo(T)};let b=[0,0];const y=N=>{(N.sourceEvent.type==="mousedown"||N.sourceEvent.type==="touchstart")&&(b=[N.sourceEvent.clientX??N.sourceEvent.touches[0].clientX,N.sourceEvent.clientY??N.sourceEvent.touches[0].clientY])},S=N=>{const k=r();if(N.sourceEvent.type!=="mousemove"&&N.sourceEvent.type!=="touchmove"||!t)return;const j=[N.sourceEvent.clientX??N.sourceEvent.touches[0].clientX,N.sourceEvent.clientY??N.sourceEvent.touches[0].clientY],E=[j[0]-b[0],j[1]-b[1]];b=j;const T=n()*Math.max(k[2],Math.log(k[2]))*(p?-1:1),O={x:k[0]-E[0]*T,y:k[1]-E[1]*T},R=[[0,0],[c,u]];t.setViewportConstrained({x:O.x,y:O.y,zoom:k[2]},R,l)},_=kge().on("start",y).on("zoom",f?S:null).on("zoom.wheel",m?v:null);a.call(_,{})}function i(){a.on("zoom",null)}return{update:s,destroy:i,pointer:zo}}const W2=e=>({x:e.x,y:e.y,zoom:e.k}),HL=({x:e,y:t,zoom:r})=>U2.translate(e,t).scale(r),Ap=(e,t)=>e.target.closest(`.${t}`),Qge=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Jot=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,qL=(e,t=0,r=Jot,n=()=>{})=>{const a=typeof t=="number"&&t>0;return a||n(),a?e.transition().duration(t).ease(r).on("end",n):e},Jge=e=>{const t=e.ctrlKey&&yx()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Zot({zoomPanValues:e,noWheelClassName:t,d3Selection:r,d3Zoom:n,panOnScrollMode:a,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:l,onPanZoom:c,onPanZoomEnd:u}){return d=>{if(Ap(d,t))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const f=r.property("__zoom").k||1;if(d.ctrlKey&&i){const y=zo(d),S=Jge(d),_=f*Math.pow(2,S);n.scaleTo(r,_,y,d);return}const m=d.deltaMode===1?20:1;let p=a===fh.Vertical?0:d.deltaX*m,v=a===fh.Horizontal?0:d.deltaY*m;!yx()&&d.shiftKey&&a!==fh.Vertical&&(p=d.deltaY*m,v=0),n.translateBy(r,-(p/f)*s,-(v/f)*s,{internal:!0});const b=W2(r.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c?.(d,b),e.panScrollTimeout=setTimeout(()=>{u?.(d,b),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,l?.(d,b))}}function Xot({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:r}){return function(n,a){const s=n.type==="wheel",i=!t&&s&&!n.ctrlKey,l=Ap(n,e);if(n.ctrlKey&&s&&l&&n.preventDefault(),i||l)return null;n.preventDefault(),r.call(this,n,a)}}function elt({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:r}){return n=>{if(n.sourceEvent?.internal)return;const a=W2(n.transform);e.mouseButton=n.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=a,n.sourceEvent?.type==="mousedown"&&t(!0),r&&r?.(n.sourceEvent,a)}}function tlt({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:r,onTransformChange:n,onPanZoom:a}){return s=>{e.usedRightMouseButton=!!(r&&Qge(t,e.mouseButton??0)),s.sourceEvent?.sync||n([s.transform.x,s.transform.y,s.transform.k]),a&&!s.sourceEvent?.internal&&a?.(s.sourceEvent,W2(s.transform))}}function rlt({zoomPanValues:e,panOnDrag:t,panOnScroll:r,onDraggingChange:n,onPanZoomEnd:a,onPaneContextMenu:s}){return i=>{if(!i.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,s&&Qge(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,n(!1),a)){const l=W2(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a?.(i.sourceEvent,l)},r?150:0)}}}function nlt({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:r,panOnDrag:n,panOnScroll:a,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:l,noPanClassName:c,lib:u,connectionInProgress:d}){return f=>{const m=e||t,p=r&&f.ctrlKey,v=f.type==="wheel";if(f.button===1&&f.type==="mousedown"&&(Ap(f,`${u}-flow__node`)||Ap(f,`${u}-flow__edge`)))return!0;if(!n&&!m&&!a&&!s&&!r||i||d&&!v||Ap(f,l)&&v||Ap(f,c)&&(!v||a&&v&&!e)||!r&&f.ctrlKey&&v)return!1;if(!r&&f.type==="touchstart"&&f.touches?.length>1)return f.preventDefault(),!1;if(!m&&!a&&!p&&v||!n&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(n)&&!n.includes(f.button)&&f.type==="mousedown")return!1;const b=Array.isArray(n)&&n.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||v)&&b}}function alt({domNode:e,minZoom:t,maxZoom:r,translateExtent:n,viewport:a,onPanZoom:s,onPanZoomStart:i,onPanZoomEnd:l,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=kge().scaleExtent([t,r]).translateExtent(n),m=Ti(e).call(f);_({x:a.x,y:a.y,zoom:zg(a.zoom,t,r)},[[0,0],[d.width,d.height]],n);const p=m.on("wheel.zoom"),v=m.on("dblclick.zoom");f.wheelDelta(Jge);function b($,L){return m?new Promise(A=>{f?.interpolate(L?.interpolate==="linear"?Qc:bk).transform(qL(m,L?.duration,L?.ease,()=>A(!0)),$)}):Promise.resolve(!1)}function y({noWheelClassName:$,noPanClassName:L,onPaneContextMenu:A,userSelectionActive:M,panOnScroll:P,panOnDrag:I,panOnScrollMode:B,panOnScrollSpeed:F,preventScrolling:q,zoomOnPinch:Q,zoomOnScroll:W,zoomOnDoubleClick:G,zoomActivationKeyPressed:J,lib:X,onTransformChange:V,connectionInProgress:se,paneClickDistance:de,selectionOnDrag:he}){M&&!u.isZoomingOrPanning&&S();const te=P&&!J&&!M;f.clickDistance(he?1/0:!Go(de)||de<0?0:de);const le=te?Zot({zoomPanValues:u,noWheelClassName:$,d3Selection:m,d3Zoom:f,panOnScrollMode:B,panOnScrollSpeed:F,zoomOnPinch:Q,onPanZoomStart:i,onPanZoom:s,onPanZoomEnd:l}):Xot({noWheelClassName:$,preventScrolling:q,d3ZoomHandler:p});if(m.on("wheel.zoom",le,{passive:!1}),!M){const Z=elt({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:i});f.on("start",Z);const ve=tlt({zoomPanValues:u,panOnDrag:I,onPaneContextMenu:!!A,onPanZoom:s,onTransformChange:V});f.on("zoom",ve);const U=rlt({zoomPanValues:u,panOnDrag:I,panOnScroll:P,onPaneContextMenu:A,onPanZoomEnd:l,onDraggingChange:c});f.on("end",U)}const oe=nlt({zoomActivationKeyPressed:J,panOnDrag:I,zoomOnScroll:W,panOnScroll:P,zoomOnDoubleClick:G,zoomOnPinch:Q,userSelectionActive:M,noPanClassName:L,noWheelClassName:$,lib:X,connectionInProgress:se});f.filter(oe),G?m.on("dblclick.zoom",v):m.on("dblclick.zoom",null)}function S(){f.on("zoom",null)}async function _($,L,A){const M=HL($),P=f?.constrain()(M,L,A);return P&&await b(P),new Promise(I=>I(P))}async function N($,L){const A=HL($);return await b(A,L),new Promise(M=>M(A))}function k($){if(m){const L=HL($),A=m.property("__zoom");(A.k!==$.zoom||A.x!==$.x||A.y!==$.y)&&f?.transform(m,L,null,{sync:!0})}}function j(){const $=m?Sge(m.node()):{x:0,y:0,k:1};return{x:$.x,y:$.y,zoom:$.k}}function E($,L){return m?new Promise(A=>{f?.interpolate(L?.interpolate==="linear"?Qc:bk).scaleTo(qL(m,L?.duration,L?.ease,()=>A(!0)),$)}):Promise.resolve(!1)}function T($,L){return m?new Promise(A=>{f?.interpolate(L?.interpolate==="linear"?Qc:bk).scaleBy(qL(m,L?.duration,L?.ease,()=>A(!0)),$)}):Promise.resolve(!1)}function O($){f?.scaleExtent($)}function R($){f?.translateExtent($)}function H($){const L=!Go($)||$<0?0:$;f?.clickDistance(L)}return{update:y,destroy:S,setViewport:N,setViewportConstrained:_,getViewport:j,scaleTo:E,scaleBy:T,setScaleExtent:O,setTranslateExtent:R,syncViewport:k,setClickDistance:H}}var Fg;(function(e){e.Line="line",e.Handle="handle"})(Fg||(Fg={}));function slt({width:e,prevWidth:t,height:r,prevHeight:n,affectsX:a,affectsY:s}){const i=e-t,l=r-n,c=[i>0?1:i<0?-1:0,l>0?1:l<0?-1:0];return i&&a&&(c[0]=c[0]*-1),l&&s&&(c[1]=c[1]*-1),c}function zee(e){const t=e.includes("right")||e.includes("left"),r=e.includes("bottom")||e.includes("top"),n=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:r,affectsX:n,affectsY:a}}function Zu(e,t){return Math.max(0,t-e)}function Xu(e,t){return Math.max(0,e-t)}function KS(e,t,r){return Math.max(0,t-e,e-r)}function Bee(e,t){return e?!t:t}function ilt(e,t,r,n,a,s,i,l){let{affectsX:c,affectsY:u}=t;const{isHorizontal:d,isVertical:f}=t,m=d&&f,{xSnapped:p,ySnapped:v}=r,{minWidth:b,maxWidth:y,minHeight:S,maxHeight:_}=n,{x:N,y:k,width:j,height:E,aspectRatio:T}=e;let O=Math.floor(d?p-e.pointerX:0),R=Math.floor(f?v-e.pointerY:0);const H=j+(c?-O:O),$=E+(u?-R:R),L=-s[0]*j,A=-s[1]*E;let M=KS(H,b,y),P=KS($,S,_);if(i){let F=0,q=0;c&&O<0?F=Zu(N+O+L,i[0][0]):!c&&O>0&&(F=Xu(N+H+L,i[1][0])),u&&R<0?q=Zu(k+R+A,i[0][1]):!u&&R>0&&(q=Xu(k+$+A,i[1][1])),M=Math.max(M,F),P=Math.max(P,q)}if(l){let F=0,q=0;c&&O>0?F=Xu(N+O,l[0][0]):!c&&O<0&&(F=Zu(N+H,l[1][0])),u&&R>0?q=Xu(k+R,l[0][1]):!u&&R<0&&(q=Zu(k+$,l[1][1])),M=Math.max(M,F),P=Math.max(P,q)}if(a){if(d){const F=KS(H/T,S,_)*T;if(M=Math.max(M,F),i){let q=0;!c&&!u||c&&!u&&m?q=Xu(k+A+H/T,i[1][1])*T:q=Zu(k+A+(c?O:-O)/T,i[0][1])*T,M=Math.max(M,q)}if(l){let q=0;!c&&!u||c&&!u&&m?q=Zu(k+H/T,l[1][1])*T:q=Xu(k+(c?O:-O)/T,l[0][1])*T,M=Math.max(M,q)}}if(f){const F=KS($*T,b,y)/T;if(P=Math.max(P,F),i){let q=0;!c&&!u||u&&!c&&m?q=Xu(N+$*T+L,i[1][0])/T:q=Zu(N+(u?R:-R)*T+L,i[0][0])/T,P=Math.max(P,q)}if(l){let q=0;!c&&!u||u&&!c&&m?q=Zu(N+$*T,l[1][0])/T:q=Xu(N+(u?R:-R)*T,l[0][0])/T,P=Math.max(P,q)}}}R=R+(R<0?P:-P),O=O+(O<0?M:-M),a&&(m?H>$*T?R=(Bee(c,u)?-O:O)/T:O=(Bee(c,u)?-R:R)*T:d?(R=O/T,u=c):(O=R*T,c=u));const I=c?N+O:N,B=u?k+R:k;return{width:j+(c?-O:O),height:E+(u?-R:R),x:s[0]*O*(c?-1:1)+I,y:s[1]*R*(u?-1:1)+B}}const Zge={width:0,height:0,x:0,y:0},olt={...Zge,pointerX:0,pointerY:0,aspectRatio:1};function llt(e){return[[0,0],[e.measured.width,e.measured.height]]}function clt(e,t,r){const n=t.position.x+e.position.x,a=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,l=r[0]*s,c=r[1]*i;return[[n-l,a-c],[n+s-l,a+i-c]]}function ult({domNode:e,nodeId:t,getStoreItems:r,onChange:n,onEnd:a}){const s=Ti(e);let i={controlDirection:zee("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function l({controlPosition:u,boundaries:d,keepAspectRatio:f,resizeDirection:m,onResizeStart:p,onResize:v,onResizeEnd:b,shouldResize:y}){let S={...Zge},_={...olt};i={boundaries:d,resizeDirection:m,keepAspectRatio:f,controlDirection:zee(u)};let N,k=null,j=[],E,T,O,R=!1;const H=mge().on("start",$=>{const{nodeLookup:L,transform:A,snapGrid:M,snapToGrid:P,nodeOrigin:I,paneDomNode:B}=r();if(N=L.get(t),!N)return;k=B?.getBoundingClientRect()??null;const{xSnapped:F,ySnapped:q}=Xb($.sourceEvent,{transform:A,snapGrid:M,snapToGrid:P,containerBounds:k});S={width:N.measured.width??0,height:N.measured.height??0,x:N.position.x??0,y:N.position.y??0},_={...S,pointerX:F,pointerY:q,aspectRatio:S.width/S.height},E=void 0,N.parentId&&(N.extent==="parent"||N.expandParent)&&(E=L.get(N.parentId),T=E&&N.extent==="parent"?llt(E):void 0),j=[],O=void 0;for(const[Q,W]of L)if(W.parentId===t&&(j.push({id:Q,position:{...W.position},extent:W.extent}),W.extent==="parent"||W.expandParent)){const G=clt(W,N,W.origin??I);O?O=[[Math.min(G[0][0],O[0][0]),Math.min(G[0][1],O[0][1])],[Math.max(G[1][0],O[1][0]),Math.max(G[1][1],O[1][1])]]:O=G}p?.($,{...S})}).on("drag",$=>{const{transform:L,snapGrid:A,snapToGrid:M,nodeOrigin:P}=r(),I=Xb($.sourceEvent,{transform:L,snapGrid:A,snapToGrid:M,containerBounds:k}),B=[];if(!N)return;const{x:F,y:q,width:Q,height:W}=S,G={},J=N.origin??P,{width:X,height:V,x:se,y:de}=ilt(_,i.controlDirection,I,i.boundaries,i.keepAspectRatio,J,T,O),he=X!==Q,te=V!==W,le=se!==F&&he,oe=de!==q&&te;if(!le&&!oe&&!he&&!te)return;if((le||oe||J[0]===1||J[1]===1)&&(G.x=le?se:S.x,G.y=oe?de:S.y,S.x=G.x,S.y=G.y,j.length>0)){const ge=se-F,ue=de-q;for(const re of j)re.position={x:re.position.x-ge+J[0]*(X-Q),y:re.position.y-ue+J[1]*(V-W)},B.push(re)}if((he||te)&&(G.width=he&&(!i.resizeDirection||i.resizeDirection==="horizontal")?X:S.width,G.height=te&&(!i.resizeDirection||i.resizeDirection==="vertical")?V:S.height,S.width=G.width,S.height=G.height),E&&N.expandParent){const ge=J[0]*(G.width??0);G.x&&G.x<ge&&(S.x=ge,_.x=_.x-(G.x-ge));const ue=J[1]*(G.height??0);G.y&&G.y<ue&&(S.y=ue,_.y=_.y-(G.y-ue))}const Z=slt({width:S.width,prevWidth:Q,height:S.height,prevHeight:W,affectsX:i.controlDirection.affectsX,affectsY:i.controlDirection.affectsY}),ve={...S,direction:Z};y?.($,ve)!==!1&&(R=!0,v?.($,ve),n(G,B))}).on("end",$=>{R&&(b?.($,{...S}),a?.({...S}),R=!1)});s.call(H)}function c(){s.on(".drag",null)}return{update:l,destroy:c}}const dlt={},$ee=e=>{let t;const r=new Set,n=(d,f)=>{const m=typeof d=="function"?d(t):d;if(!Object.is(m,t)){const p=t;t=f??(typeof m!="object"||m===null)?m:Object.assign({},t,m),r.forEach(v=>v(t,p))}},a=()=>t,c={setState:n,getState:a,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(dlt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,a,c);return c},flt=e=>e?$ee(e):$ee,{useDebugValue:hlt}=ce,{useSyncExternalStoreWithSelector:mlt}=awe,plt=e=>e;function Xge(e,t=plt,r){const n=mlt(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return hlt(n),n}const Fee=(e,t)=>{const r=flt(e),n=(a,s=t)=>Xge(r,a,s);return Object.assign(n,r),n},glt=(e,t)=>e?Fee(e,t):Fee;function Tn(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,a]of e)if(!Object.is(a,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}const K2=w.createContext(null),vlt=K2.Provider,e0e=Fl.error001();function Er(e,t){const r=w.useContext(K2);if(r===null)throw new Error(e0e);return Xge(r,e,t)}function An(){const e=w.useContext(K2);if(e===null)throw new Error(e0e);return w.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Uee={display:"none"},blt={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},t0e="react-flow__node-desc",r0e="react-flow__edge-desc",ylt="react-flow__aria-live",xlt=e=>e.ariaLiveMessage,wlt=e=>e.ariaLabelConfig;function Slt({rfId:e}){const t=Er(xlt);return o.jsx("div",{id:`${ylt}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:blt,children:t})}function klt({rfId:e,disableKeyboardA11y:t}){const r=Er(wlt);return o.jsxs(o.Fragment,{children:[o.jsx("div",{id:`${t0e}-${e}`,style:Uee,children:t?r["node.a11yDescription.default"]:r["node.a11yDescription.keyboardDisabled"]}),o.jsx("div",{id:`${r0e}-${e}`,style:Uee,children:r["edge.a11yDescription.default"]}),!t&&o.jsx(Slt,{rfId:e})]})}const G2=w.forwardRef(({position:e="top-left",children:t,className:r,style:n,...a},s)=>{const i=`${e}`.split("-");return o.jsx("div",{className:ya(["react-flow__panel",r,...i]),style:n,ref:s,...a,children:t})});G2.displayName="Panel";function _lt({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:o.jsx(G2,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:o.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Nlt=e=>{const t=[],r=[];for(const[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(const[,n]of e.edgeLookup)n.selected&&r.push(n);return{selectedNodes:t,selectedEdges:r}},GS=e=>e.id;function Clt(e,t){return Tn(e.selectedNodes.map(GS),t.selectedNodes.map(GS))&&Tn(e.selectedEdges.map(GS),t.selectedEdges.map(GS))}function jlt({onSelectionChange:e}){const t=An(),{selectedNodes:r,selectedEdges:n}=Er(Nlt,Clt);return w.useEffect(()=>{const a={nodes:r,edges:n};e?.(a),t.getState().onSelectionChangeHandlers.forEach(s=>s(a))},[r,n,e]),null}const Elt=e=>!!e.onSelectionChangeHandlers;function Mlt({onSelectionChange:e}){const t=Er(Elt);return e||t?o.jsx(jlt,{onSelectionChange:e}):null}const n0e=[0,0],Tlt={x:0,y:0,zoom:1},Alt=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Hee=[...Alt,"rfId"],Dlt=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),qee={translateExtent:gx,nodeOrigin:n0e,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function Llt(e){const{setNodes:t,setEdges:r,setMinZoom:n,setMaxZoom:a,setTranslateExtent:s,setNodeExtent:i,reset:l,setDefaultNodesAndEdges:c}=Er(Dlt,Tn),u=An();w.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=qee,l()}),[]);const d=w.useRef(qee);return w.useEffect(()=>{for(const f of Hee){const m=e[f],p=d.current[f];m!==p&&(typeof e[f]>"u"||(f==="nodes"?t(m):f==="edges"?r(m):f==="minZoom"?n(m):f==="maxZoom"?a(m):f==="translateExtent"?s(m):f==="nodeExtent"?i(m):f==="ariaLabelConfig"?u.setState({ariaLabelConfig:Sot(m)}):f==="fitView"?u.setState({fitViewQueued:m}):f==="fitViewOptions"?u.setState({fitViewOptions:m}):u.setState({[f]:m})))}d.current=e},Hee.map(f=>e[f])),null}function Wee(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Olt(e){const[t,r]=w.useState(e==="system"?null:e);return w.useEffect(()=>{if(e!=="system"){r(e);return}const n=Wee(),a=()=>r(n?.matches?"dark":"light");return a(),n?.addEventListener("change",a),()=>{n?.removeEventListener("change",a)}},[e]),t!==null?t:Wee()?.matches?"dark":"light"}const Kee=typeof document<"u"?document:null;function xx(e=null,t={target:Kee,actInsideInputWithModifier:!0}){const[r,n]=w.useState(!1),a=w.useRef(!1),s=w.useRef(new Set([])),[i,l]=w.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=u.reduce((f,m)=>f.concat(...m),[]);return[u,d]}return[[],[]]},[e]);return w.useEffect(()=>{const c=t?.target??Kee,u=t?.actInsideInputWithModifier??!0;if(e!==null){const d=p=>{if(a.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!a.current||a.current&&!u)&&Rge(p))return!1;const b=Vee(p.code,l);if(s.current.add(p[b]),Gee(i,s.current,!1)){const y=p.composedPath?.()?.[0]||p.target,S=y?.nodeName==="BUTTON"||y?.nodeName==="A";t.preventDefault!==!1&&(a.current||!S)&&p.preventDefault(),n(!0)}},f=p=>{const v=Vee(p.code,l);Gee(i,s.current,!0)?(n(!1),s.current.clear()):s.current.delete(p[v]),p.key==="Meta"&&s.current.clear(),a.current=!1},m=()=>{s.current.clear(),n(!1)};return c?.addEventListener("keydown",d),c?.addEventListener("keyup",f),window.addEventListener("blur",m),window.addEventListener("contextmenu",m),()=>{c?.removeEventListener("keydown",d),c?.removeEventListener("keyup",f),window.removeEventListener("blur",m),window.removeEventListener("contextmenu",m)}}},[e,n]),r}function Gee(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(a=>t.has(a)))}function Vee(e,t){return t.includes(e)?"code":"key"}const Ilt=()=>{const e=An();return w.useMemo(()=>({zoomIn:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:r}=e.getState();return r?r.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,r)=>{const{panZoom:n}=e.getState();return n?n.scaleTo(t,{duration:r?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,r)=>{const{transform:[n,a,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??n,y:t.y??a,zoom:t.zoom??s},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,r,n]=e.getState().transform;return{x:t,y:r,zoom:n}},setCenter:async(t,r,n)=>e.getState().setCenter(t,r,n),fitBounds:async(t,r)=>{const{width:n,height:a,minZoom:s,maxZoom:i,panZoom:l}=e.getState(),c=e$(t,n,a,s,i,r?.padding??.1);return l?(await l.setViewport(c,{duration:r?.duration,ease:r?.ease,interpolate:r?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,r={})=>{const{transform:n,snapGrid:a,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:l,y:c}=i.getBoundingClientRect(),u={x:t.x-l,y:t.y-c},d=r.snapGrid??a,f=r.snapToGrid??s;return M1(u,n,f,d)},flowToScreenPosition:t=>{const{transform:r,domNode:n}=e.getState();if(!n)return t;const{x:a,y:s}=n.getBoundingClientRect(),i=CC(t,r);return{x:i.x+a,y:i.y+s}}}),[])};function a0e(e,t){const r=[],n=new Map,a=[];for(const s of e)if(s.type==="add"){a.push(s);continue}else if(s.type==="remove"||s.type==="replace")n.set(s.id,[s]);else{const i=n.get(s.id);i?i.push(s):n.set(s.id,[s])}for(const s of t){const i=n.get(s.id);if(!i){r.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){r.push({...i[0].item});continue}const l={...s};for(const c of i)Rlt(c,l);r.push(l)}return a.length&&a.forEach(s=>{s.index!==void 0?r.splice(s.index,0,{...s.item}):r.push({...s.item})}),r}function Rlt(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function s0e(e,t){return a0e(e,t)}function i0e(e,t){return a0e(e,t)}function Ff(e,t){return{id:e,type:"select",selected:t}}function Dp(e,t=new Set,r=!1){const n=[];for(const[a,s]of e){const i=t.has(a);!(s.selected===void 0&&!i)&&s.selected!==i&&(r&&(s.selected=i),n.push(Ff(s.id,i)))}return n}function Yee({items:e=[],lookup:t}){const r=[],n=new Map(e.map(a=>[a.id,a]));for(const[a,s]of e.entries()){const i=t.get(s.id),l=i?.internals?.userNode??i;l!==void 0&&l!==s&&r.push({id:s.id,item:s,type:"replace"}),l===void 0&&r.push({item:s,type:"add",index:a})}for(const[a]of t)n.get(a)===void 0&&r.push({id:a,type:"remove"});return r}function Qee(e){return{id:e.id,type:"remove"}}const Jee=e=>fot(e),Plt=e=>Ege(e);function o0e(e){return w.forwardRef(e)}const zlt=typeof window<"u"?w.useLayoutEffect:w.useEffect;function Zee(e){const[t,r]=w.useState(BigInt(0)),[n]=w.useState(()=>Blt(()=>r(a=>a+BigInt(1))));return zlt(()=>{const a=n.get();a.length&&(e(a),n.reset())},[t]),n}function Blt(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:r=>{t.push(r),e()}}}const l0e=w.createContext(null);function $lt({children:e}){const t=An(),r=w.useCallback(l=>{const{nodes:c=[],setNodes:u,hasDefaultNodes:d,onNodesChange:f,nodeLookup:m,fitViewQueued:p,onNodesChangeMiddlewareMap:v}=t.getState();let b=c;for(const S of l)b=typeof S=="function"?S(b):S;let y=Yee({items:b,lookup:m});for(const S of v.values())y=S(y);d&&u(b),y.length>0?f?.(y):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:S,nodes:_,setNodes:N}=t.getState();S&&N(_)})},[]),n=Zee(r),a=w.useCallback(l=>{const{edges:c=[],setEdges:u,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:m}=t.getState();let p=c;for(const v of l)p=typeof v=="function"?v(p):v;d?u(p):f&&f(Yee({items:p,lookup:m}))},[]),s=Zee(a),i=w.useMemo(()=>({nodeQueue:n,edgeQueue:s}),[]);return o.jsx(l0e.Provider,{value:i,children:e})}function Flt(){const e=w.useContext(l0e);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Ult=e=>!!e.panZoom;function o$(){const e=Ilt(),t=An(),r=Flt(),n=Er(Ult),a=w.useMemo(()=>{const s=f=>t.getState().nodeLookup.get(f),i=f=>{r.nodeQueue.push(f)},l=f=>{r.edgeQueue.push(f)},c=f=>{const{nodeLookup:m,nodeOrigin:p}=t.getState(),v=Jee(f)?f:m.get(f.id),b=v.parentId?Oge(v.position,v.measured,v.parentId,m,p):v.position,y={...v,position:b,width:v.measured?.width??v.width,height:v.measured?.height??v.height};return Bg(y)},u=(f,m,p={replace:!1})=>{i(v=>v.map(b=>{if(b.id===f){const y=typeof m=="function"?m(b):m;return p.replace&&Jee(y)?y:{...b,...y}}return b}))},d=(f,m,p={replace:!1})=>{l(v=>v.map(b=>{if(b.id===f){const y=typeof m=="function"?m(b):m;return p.replace&&Plt(y)?y:{...b,...y}}return b}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>s(f)?.internals.userNode,getInternalNode:s,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(m=>({...m}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:i,setEdges:l,addNodes:f=>{const m=Array.isArray(f)?f:[f];r.nodeQueue.push(p=>[...p,...m])},addEdges:f=>{const m=Array.isArray(f)?f:[f];r.edgeQueue.push(p=>[...p,...m])},toObject:()=>{const{nodes:f=[],edges:m=[],transform:p}=t.getState(),[v,b,y]=p;return{nodes:f.map(S=>({...S})),edges:m.map(S=>({...S})),viewport:{x:v,y:b,zoom:y}}},deleteElements:async({nodes:f=[],edges:m=[]})=>{const{nodes:p,edges:v,onNodesDelete:b,onEdgesDelete:y,triggerNodeChanges:S,triggerEdgeChanges:_,onDelete:N,onBeforeDelete:k}=t.getState(),{nodes:j,edges:E}=await vot({nodesToRemove:f,edgesToRemove:m,nodes:p,edges:v,onBeforeDelete:k}),T=E.length>0,O=j.length>0;if(T){const R=E.map(Qee);y?.(E),_(R)}if(O){const R=j.map(Qee);b?.(j),S(R)}return(O||T)&&N?.({nodes:j,edges:E}),{deletedNodes:j,deletedEdges:E}},getIntersectingNodes:(f,m=!0,p)=>{const v=jee(f),b=v?f:c(f),y=p!==void 0;return b?(p||t.getState().nodes).filter(S=>{const _=t.getState().nodeLookup.get(S.id);if(_&&!v&&(S.id===f.id||!_.internals.positionAbsolute))return!1;const N=Bg(y?S:_),k=bx(N,b);return m&&k>0||k>=N.width*N.height||k>=b.width*b.height}):[]},isNodeIntersecting:(f,m,p=!0)=>{const b=jee(f)?f:c(f);if(!b)return!1;const y=bx(b,m);return p&&y>0||y>=m.width*m.height||y>=b.width*b.height},updateNode:u,updateNodeData:(f,m,p={replace:!1})=>{u(f,v=>{const b=typeof m=="function"?m(v):m;return p.replace?{...v,data:b}:{...v,data:{...v.data,...b}}},p)},updateEdge:d,updateEdgeData:(f,m,p={replace:!1})=>{d(f,v=>{const b=typeof m=="function"?m(v):m;return p.replace?{...v,data:b}:{...v,data:{...v.data,...b}}},p)},getNodesBounds:f=>{const{nodeLookup:m,nodeOrigin:p}=t.getState();return hot(f,{nodeLookup:m,nodeOrigin:p})},getHandleConnections:({type:f,id:m,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}-${f}${m?`-${m}`:""}`)?.values()??[]),getNodeConnections:({type:f,handleId:m,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}${f?m?`-${f}-${m}`:`-${f}`:""}`)?.values()??[]),fitView:async f=>{const m=t.getState().fitViewResolver??wot();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:m}),r.nodeQueue.push(p=>[...p]),m.promise}}},[]);return w.useMemo(()=>({...a,...e,viewportInitialized:n}),[n])}const Xee=e=>e.selected,Hlt=typeof window<"u"?window:void 0;function qlt({deleteKeyCode:e,multiSelectionKeyCode:t}){const r=An(),{deleteElements:n}=o$(),a=xx(e,{actInsideInputWithModifier:!1}),s=xx(t,{target:Hlt});w.useEffect(()=>{if(a){const{edges:i,nodes:l}=r.getState();n({nodes:l.filter(Xee),edges:i.filter(Xee)}),r.setState({nodesSelectionActive:!1})}},[a]),w.useEffect(()=>{r.setState({multiSelectionActive:s})},[s])}function Wlt(e){const t=An();w.useEffect(()=>{const r=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const n=t$(e.current);(n.height===0||n.width===0)&&t.getState().onError?.("004",Fl.error004()),t.setState({width:n.width||500,height:n.height||500})};if(e.current){r(),window.addEventListener("resize",r);const n=new ResizeObserver(()=>r());return n.observe(e.current),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}}},[])}const V2={position:"absolute",width:"100%",height:"100%",top:0,left:0},Klt=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Glt({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:r=!0,panOnScroll:n=!1,panOnScrollSpeed:a=.5,panOnScrollMode:s=fh.Free,zoomOnDoubleClick:i=!0,panOnDrag:l=!0,defaultViewport:c,translateExtent:u,minZoom:d,maxZoom:f,zoomActivationKeyCode:m,preventScrolling:p=!0,children:v,noWheelClassName:b,noPanClassName:y,onViewportChange:S,isControlledViewport:_,paneClickDistance:N,selectionOnDrag:k}){const j=An(),E=w.useRef(null),{userSelectionActive:T,lib:O,connectionInProgress:R}=Er(Klt,Tn),H=xx(m),$=w.useRef();Wlt(E);const L=w.useCallback(A=>{S?.({x:A[0],y:A[1],zoom:A[2]}),_||j.setState({transform:A})},[S,_]);return w.useEffect(()=>{if(E.current){$.current=alt({domNode:E.current,minZoom:d,maxZoom:f,translateExtent:u,viewport:c,onDraggingChange:I=>j.setState({paneDragging:I}),onPanZoomStart:(I,B)=>{const{onViewportChangeStart:F,onMoveStart:q}=j.getState();q?.(I,B),F?.(B)},onPanZoom:(I,B)=>{const{onViewportChange:F,onMove:q}=j.getState();q?.(I,B),F?.(B)},onPanZoomEnd:(I,B)=>{const{onViewportChangeEnd:F,onMoveEnd:q}=j.getState();q?.(I,B),F?.(B)}});const{x:A,y:M,zoom:P}=$.current.getViewport();return j.setState({panZoom:$.current,transform:[A,M,P],domNode:E.current.closest(".react-flow")}),()=>{$.current?.destroy()}}},[]),w.useEffect(()=>{$.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:r,panOnScroll:n,panOnScrollSpeed:a,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:l,zoomActivationKeyPressed:H,preventScrolling:p,noPanClassName:y,userSelectionActive:T,noWheelClassName:b,lib:O,onTransformChange:L,connectionInProgress:R,selectionOnDrag:k,paneClickDistance:N})},[e,t,r,n,a,s,i,l,H,p,y,T,b,O,L,R,k,N]),o.jsx("div",{className:"react-flow__renderer",ref:E,style:V2,children:v})}const Vlt=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Ylt(){const{userSelectionActive:e,userSelectionRect:t}=Er(Vlt,Tn);return e&&t?o.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const WL=(e,t)=>r=>{r.target===t.current&&e?.(r)},Qlt=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Jlt({isSelecting:e,selectionKeyPressed:t,selectionMode:r=vx.Full,panOnDrag:n,paneClickDistance:a,selectionOnDrag:s,onSelectionStart:i,onSelectionEnd:l,onPaneClick:c,onPaneContextMenu:u,onPaneScroll:d,onPaneMouseEnter:f,onPaneMouseMove:m,onPaneMouseLeave:p,children:v}){const b=An(),{userSelectionActive:y,elementsSelectable:S,dragging:_,connectionInProgress:N}=Er(Qlt,Tn),k=S&&(e||y),j=w.useRef(null),E=w.useRef(),T=w.useRef(new Set),O=w.useRef(new Set),R=w.useRef(!1),H=F=>{if(R.current||N){R.current=!1;return}c?.(F),b.getState().resetSelectedElements(),b.setState({nodesSelectionActive:!1})},$=F=>{if(Array.isArray(n)&&n?.includes(2)){F.preventDefault();return}u?.(F)},L=d?F=>d(F):void 0,A=F=>{R.current&&(F.stopPropagation(),R.current=!1)},M=F=>{const{domNode:q}=b.getState();if(E.current=q?.getBoundingClientRect(),!E.current)return;const Q=F.target===j.current;if(!Q&&!!F.target.closest(".nokey")||!e||!(s&&Q||t)||F.button!==0||!F.isPrimary)return;F.target?.setPointerCapture?.(F.pointerId),R.current=!1;const{x:J,y:X}=Vo(F.nativeEvent,E.current);b.setState({userSelectionRect:{width:0,height:0,startX:J,startY:X,x:J,y:X}}),Q||(F.stopPropagation(),F.preventDefault())},P=F=>{const{userSelectionRect:q,transform:Q,nodeLookup:W,edgeLookup:G,connectionLookup:J,triggerNodeChanges:X,triggerEdgeChanges:V,defaultEdgeOptions:se,resetSelectedElements:de}=b.getState();if(!E.current||!q)return;const{x:he,y:te}=Vo(F.nativeEvent,E.current),{startX:le,startY:oe}=q;if(!R.current){const ue=t?0:a;if(Math.hypot(he-le,te-oe)<=ue)return;de(),i?.(F)}R.current=!0;const Z={startX:le,startY:oe,x:he<le?he:le,y:te<oe?te:oe,width:Math.abs(he-le),height:Math.abs(te-oe)},ve=T.current,U=O.current;T.current=new Set(XB(W,Z,Q,r===vx.Partial,!0).map(ue=>ue.id)),O.current=new Set;const ge=se?.selectable??!0;for(const ue of T.current){const re=J.get(ue);if(re)for(const{edgeId:ne}of re.values()){const me=G.get(ne);me&&(me.selectable??ge)&&O.current.add(ne)}}if(!Eee(ve,T.current)){const ue=Dp(W,T.current,!0);X(ue)}if(!Eee(U,O.current)){const ue=Dp(G,O.current);V(ue)}b.setState({userSelectionRect:Z,userSelectionActive:!0,nodesSelectionActive:!1})},I=F=>{F.button===0&&(F.target?.releasePointerCapture?.(F.pointerId),!y&&F.target===j.current&&b.getState().userSelectionRect&&H?.(F),b.setState({userSelectionActive:!1,userSelectionRect:null}),R.current&&(l?.(F),b.setState({nodesSelectionActive:T.current.size>0})))},B=n===!0||Array.isArray(n)&&n.includes(0);return o.jsxs("div",{className:ya(["react-flow__pane",{draggable:B,dragging:_,selection:e}]),onClick:k?void 0:WL(H,j),onContextMenu:WL($,j),onWheel:WL(L,j),onPointerEnter:k?void 0:f,onPointerMove:k?P:m,onPointerUp:k?I:void 0,onPointerDownCapture:k?M:void 0,onClickCapture:k?A:void 0,onPointerLeave:p,ref:j,style:V2,children:[v,o.jsx(Ylt,{})]})}function s5({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:a,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:l,onError:c}=t.getState(),u=l.get(e);if(!u){c?.("012",Fl.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&i)&&(s({nodes:[u],edges:[]}),requestAnimationFrame(()=>n?.current?.blur())):a([e])}function c0e({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:a,isSelectable:s,nodeClickDistance:i}){const l=An(),[c,u]=w.useState(!1),d=w.useRef();return w.useEffect(()=>{d.current=qot({getStoreItems:()=>l.getState(),onNodeMouseDown:f=>{s5({id:f,store:l,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),w.useEffect(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:r,handleSelector:n,domNode:e.current,isSelectable:s,nodeId:a,nodeClickDistance:i}),()=>{d.current?.destroy()}},[r,n,t,s,e,a]),c}const Zlt=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function u0e(){const e=An();return w.useCallback(r=>{const{nodeExtent:n,snapToGrid:a,snapGrid:s,nodesDraggable:i,onError:l,updateNodePositions:c,nodeLookup:u,nodeOrigin:d}=e.getState(),f=new Map,m=Zlt(i),p=a?s[0]:5,v=a?s[1]:5,b=r.direction.x*p*r.factor,y=r.direction.y*v*r.factor;for(const[,S]of u){if(!m(S))continue;let _={x:S.internals.positionAbsolute.x+b,y:S.internals.positionAbsolute.y+y};a&&(_=E1(_,s));const{position:N,positionAbsolute:k}=Mge({nodeId:S.id,nextPosition:_,nodeLookup:u,nodeExtent:n,nodeOrigin:d,onError:l});S.position=N,S.internals.positionAbsolute=k,f.set(S.id,S)}c(f)},[])}const l$=w.createContext(null),Xlt=l$.Provider;l$.Consumer;const d0e=()=>w.useContext(l$),ect=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),tct=(e,t,r)=>n=>{const{connectionClickStartHandle:a,connectionMode:s,connection:i}=n,{fromHandle:l,toHandle:c,isValid:u}=i,d=c?.nodeId===e&&c?.id===t&&c?.type===r;return{connectingFrom:l?.nodeId===e&&l?.id===t&&l?.type===r,connectingTo:d,clickConnecting:a?.nodeId===e&&a?.id===t&&a?.type===r,isPossibleEndHandle:s===Pg.Strict?l?.type!==r:e!==l?.nodeId||t!==l?.id,connectionInProcess:!!l,clickConnectionInProcess:!!a,valid:d&&u}};function rct({type:e="source",position:t=zt.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:a=!0,isConnectableEnd:s=!0,id:i,onConnect:l,children:c,className:u,onMouseDown:d,onTouchStart:f,...m},p){const v=i||null,b=e==="target",y=An(),S=d0e(),{connectOnClick:_,noPanClassName:N,rfId:k}=Er(ect,Tn),{connectingFrom:j,connectingTo:E,clickConnecting:T,isPossibleEndHandle:O,connectionInProcess:R,clickConnectionInProcess:H,valid:$}=Er(tct(S,v,e),Tn);S||y.getState().onError?.("010",Fl.error010());const L=P=>{const{defaultEdgeOptions:I,onConnect:B,hasDefaultEdges:F}=y.getState(),q={...I,...P};if(F){const{edges:Q,setEdges:W}=y.getState();W(Eot(q,Q))}B?.(q),l?.(q)},A=P=>{if(!S)return;const I=Pge(P.nativeEvent);if(a&&(I&&P.button===0||!I)){const B=y.getState();a5.onPointerDown(P.nativeEvent,{handleDomNode:P.currentTarget,autoPanOnConnect:B.autoPanOnConnect,connectionMode:B.connectionMode,connectionRadius:B.connectionRadius,domNode:B.domNode,nodeLookup:B.nodeLookup,lib:B.lib,isTarget:b,handleId:v,nodeId:S,flowId:B.rfId,panBy:B.panBy,cancelConnection:B.cancelConnection,onConnectStart:B.onConnectStart,onConnectEnd:B.onConnectEnd,updateConnection:B.updateConnection,onConnect:L,isValidConnection:r||B.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:B.autoPanSpeed,dragThreshold:B.connectionDragThreshold})}I?d?.(P):f?.(P)},M=P=>{const{onClickConnectStart:I,onClickConnectEnd:B,connectionClickStartHandle:F,connectionMode:q,isValidConnection:Q,lib:W,rfId:G,nodeLookup:J,connection:X}=y.getState();if(!S||!F&&!a)return;if(!F){I?.(P.nativeEvent,{nodeId:S,handleId:v,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:S,type:e,id:v}});return}const V=Ige(P.target),se=r||Q,{connection:de,isValid:he}=a5.isValid(P.nativeEvent,{handle:{nodeId:S,id:v,type:e},connectionMode:q,fromNodeId:F.nodeId,fromHandleId:F.id||null,fromType:F.type,isValidConnection:se,flowId:G,doc:V,lib:W,nodeLookup:J});he&&de&&L(de);const te=structuredClone(X);delete te.inProgress,te.toPosition=te.toHandle?te.toHandle.position:null,B?.(P,te),y.setState({connectionClickStartHandle:null})};return o.jsx("div",{"data-handleid":v,"data-nodeid":S,"data-handlepos":t,"data-id":`${k}-${S}-${v}-${e}`,className:ya(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,u,{source:!b,target:b,connectable:n,connectablestart:a,connectableend:s,clickconnecting:T,connectingfrom:j,connectingto:E,valid:$,connectionindicator:n&&(!R||O)&&(R||H?s:a)}]),onMouseDown:A,onTouchStart:A,onClick:_?M:void 0,ref:p,...m,children:c})}const Ug=w.memo(o0e(rct));function nct({data:e,isConnectable:t,sourcePosition:r=zt.Bottom}){return o.jsxs(o.Fragment,{children:[e?.label,o.jsx(Ug,{type:"source",position:r,isConnectable:t})]})}function act({data:e,isConnectable:t,targetPosition:r=zt.Top,sourcePosition:n=zt.Bottom}){return o.jsxs(o.Fragment,{children:[o.jsx(Ug,{type:"target",position:r,isConnectable:t}),e?.label,o.jsx(Ug,{type:"source",position:n,isConnectable:t})]})}function sct(){return null}function ict({data:e,isConnectable:t,targetPosition:r=zt.Top}){return o.jsxs(o.Fragment,{children:[o.jsx(Ug,{type:"target",position:r,isConnectable:t}),e?.label]})}const jC={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ete={input:nct,default:act,output:ict,group:sct};function oct(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const lct=e=>{const{width:t,height:r,x:n,y:a}=j1(e.nodeLookup,{filter:s=>!!s.selected});return{width:Go(t)?t:null,height:Go(r)?r:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${n}px,${a}px)`}};function cct({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=An(),{width:a,height:s,transformString:i,userSelectionActive:l}=Er(lct,Tn),c=u0e(),u=w.useRef(null);if(w.useEffect(()=>{r||u.current?.focus({preventScroll:!0})},[r]),c0e({nodeRef:u}),l||!a||!s)return null;const d=e?m=>{const p=n.getState().nodes.filter(v=>v.selected);e(m,p)}:void 0,f=m=>{Object.prototype.hasOwnProperty.call(jC,m.key)&&(m.preventDefault(),c({direction:jC[m.key],factor:m.shiftKey?4:1}))};return o.jsx("div",{className:ya(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:o.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:r?void 0:-1,onKeyDown:r?void 0:f,style:{width:a,height:s}})})}const tte=typeof window<"u"?window:void 0,uct=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function f0e({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:l,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:d,selectionMode:f,onSelectionStart:m,onSelectionEnd:p,multiSelectionKeyCode:v,panActivationKeyCode:b,zoomActivationKeyCode:y,elementsSelectable:S,zoomOnScroll:_,zoomOnPinch:N,panOnScroll:k,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:T,panOnDrag:O,defaultViewport:R,translateExtent:H,minZoom:$,maxZoom:L,preventScrolling:A,onSelectionContextMenu:M,noWheelClassName:P,noPanClassName:I,disableKeyboardA11y:B,onViewportChange:F,isControlledViewport:q}){const{nodesSelectionActive:Q,userSelectionActive:W}=Er(uct,Tn),G=xx(u,{target:tte}),J=xx(b,{target:tte}),X=J||O,V=J||k,se=d&&X!==!0,de=G||W||se;return qlt({deleteKeyCode:c,multiSelectionKeyCode:v}),o.jsx(Glt,{onPaneContextMenu:s,elementsSelectable:S,zoomOnScroll:_,zoomOnPinch:N,panOnScroll:V,panOnScrollSpeed:j,panOnScrollMode:E,zoomOnDoubleClick:T,panOnDrag:!G&&X,defaultViewport:R,translateExtent:H,minZoom:$,maxZoom:L,zoomActivationKeyCode:y,preventScrolling:A,noWheelClassName:P,noPanClassName:I,onViewportChange:F,isControlledViewport:q,paneClickDistance:l,selectionOnDrag:se,children:o.jsxs(Jlt,{onSelectionStart:m,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:X,isSelecting:!!de,selectionMode:f,selectionKeyPressed:G,paneClickDistance:l,selectionOnDrag:se,children:[e,Q&&o.jsx(cct,{onSelectionContextMenu:M,noPanClassName:I,disableKeyboardA11y:B})]})})}f0e.displayName="FlowRenderer";const dct=w.memo(f0e),fct=e=>t=>e?XB(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(r=>r.id):Array.from(t.nodeLookup.keys());function hct(e){return Er(w.useCallback(fct(e),[e]),Tn)}const mct=e=>e.updateNodeInternals;function pct(){const e=Er(mct),[t]=w.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(r=>{const n=new Map;r.forEach(a=>{const s=a.target.getAttribute("data-id");n.set(s,{id:s,nodeElement:a.target,force:!0})}),e(n)}));return w.useEffect(()=>()=>{t?.disconnect()},[t]),t}function gct({node:e,nodeType:t,hasDimensions:r,resizeObserver:n}){const a=An(),s=w.useRef(null),i=w.useRef(null),l=w.useRef(e.sourcePosition),c=w.useRef(e.targetPosition),u=w.useRef(t),d=r&&!!e.internals.handleBounds;return w.useEffect(()=>{s.current&&!e.hidden&&(!d||i.current!==s.current)&&(i.current&&n?.unobserve(i.current),n?.observe(s.current),i.current=s.current)},[d,e.hidden]),w.useEffect(()=>()=>{i.current&&(n?.unobserve(i.current),i.current=null)},[]),w.useEffect(()=>{if(s.current){const f=u.current!==t,m=l.current!==e.sourcePosition,p=c.current!==e.targetPosition;(f||m||p)&&(u.current=t,l.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function vct({id:e,onClick:t,onMouseEnter:r,onMouseMove:n,onMouseLeave:a,onContextMenu:s,onDoubleClick:i,nodesDraggable:l,elementsSelectable:c,nodesConnectable:u,nodesFocusable:d,resizeObserver:f,noDragClassName:m,noPanClassName:p,disableKeyboardA11y:v,rfId:b,nodeTypes:y,nodeClickDistance:S,onError:_}){const{node:N,internals:k,isParent:j}=Er(he=>{const te=he.nodeLookup.get(e),le=he.parentLookup.has(e);return{node:te,internals:te.internals,isParent:le}},Tn);let E=N.type||"default",T=y?.[E]||ete[E];T===void 0&&(_?.("003",Fl.error003(E)),E="default",T=y?.default||ete.default);const O=!!(N.draggable||l&&typeof N.draggable>"u"),R=!!(N.selectable||c&&typeof N.selectable>"u"),H=!!(N.connectable||u&&typeof N.connectable>"u"),$=!!(N.focusable||d&&typeof N.focusable>"u"),L=An(),A=Lge(N),M=gct({node:N,nodeType:E,hasDimensions:A,resizeObserver:f}),P=c0e({nodeRef:M,disabled:N.hidden||!O,noDragClassName:m,handleSelector:N.dragHandle,nodeId:e,isSelectable:R,nodeClickDistance:S}),I=u0e();if(N.hidden)return null;const B=yu(N),F=oct(N),q=R||O||t||r||n||a,Q=r?he=>r(he,{...k.userNode}):void 0,W=n?he=>n(he,{...k.userNode}):void 0,G=a?he=>a(he,{...k.userNode}):void 0,J=s?he=>s(he,{...k.userNode}):void 0,X=i?he=>i(he,{...k.userNode}):void 0,V=he=>{const{selectNodesOnDrag:te,nodeDragThreshold:le}=L.getState();R&&(!te||!O||le>0)&&s5({id:e,store:L,nodeRef:M}),t&&t(he,{...k.userNode})},se=he=>{if(!(Rge(he.nativeEvent)||v)){if(_ge.includes(he.key)&&R){const te=he.key==="Escape";s5({id:e,store:L,unselect:te,nodeRef:M})}else if(O&&N.selected&&Object.prototype.hasOwnProperty.call(jC,he.key)){he.preventDefault();const{ariaLabelConfig:te}=L.getState();L.setState({ariaLiveMessage:te["node.a11yDescription.ariaLiveMessage"]({direction:he.key.replace("Arrow","").toLowerCase(),x:~~k.positionAbsolute.x,y:~~k.positionAbsolute.y})}),I({direction:jC[he.key],factor:he.shiftKey?4:1})}}},de=()=>{if(v||!M.current?.matches(":focus-visible"))return;const{transform:he,width:te,height:le,autoPanOnNodeFocus:oe,setCenter:Z}=L.getState();if(!oe)return;XB(new Map([[e,N]]),{x:0,y:0,width:te,height:le},he,!0).length>0||Z(N.position.x+B.width/2,N.position.y+B.height/2,{zoom:he[2]})};return o.jsx("div",{className:ya(["react-flow__node",`react-flow__node-${E}`,{[p]:O},N.className,{selected:N.selected,selectable:R,parent:j,draggable:O,dragging:P}]),ref:M,style:{zIndex:k.z,transform:`translate(${k.positionAbsolute.x}px,${k.positionAbsolute.y}px)`,pointerEvents:q?"all":"none",visibility:A?"visible":"hidden",...N.style,...F},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:Q,onMouseMove:W,onMouseLeave:G,onContextMenu:J,onClick:V,onDoubleClick:X,onKeyDown:$?se:void 0,tabIndex:$?0:void 0,onFocus:$?de:void 0,role:N.ariaRole??($?"group":void 0),"aria-roledescription":"node","aria-describedby":v?void 0:`${t0e}-${b}`,"aria-label":N.ariaLabel,...N.domAttributes,children:o.jsx(Xlt,{value:e,children:o.jsx(T,{id:e,data:N.data,type:E,positionAbsoluteX:k.positionAbsolute.x,positionAbsoluteY:k.positionAbsolute.y,selected:N.selected??!1,selectable:R,draggable:O,deletable:N.deletable??!0,isConnectable:H,sourcePosition:N.sourcePosition,targetPosition:N.targetPosition,dragging:P,dragHandle:N.dragHandle,zIndex:k.z,parentId:N.parentId,...B})})})}var bct=w.memo(vct);const yct=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function h0e(e){const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:a,onError:s}=Er(yct,Tn),i=hct(e.onlyRenderVisibleElements),l=pct();return o.jsx("div",{className:"react-flow__nodes",style:V2,children:i.map(c=>o.jsx(bct,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:l,nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:s},c))})}h0e.displayName="NodeRenderer";const xct=w.memo(h0e);function wct(e){return Er(w.useCallback(r=>{if(!e)return r.edges.map(a=>a.id);const n=[];if(r.width&&r.height)for(const a of r.edges){const s=r.nodeLookup.get(a.source),i=r.nodeLookup.get(a.target);s&&i&&Not({sourceNode:s,targetNode:i,width:r.width,height:r.height,transform:r.transform})&&n.push(a.id)}return n},[e]),Tn)}const Sct=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e}};return o.jsx("polyline",{className:"arrow",style:r,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},kct=({color:e="none",strokeWidth:t=1})=>{const r={strokeWidth:t,...e&&{stroke:e,fill:e}};return o.jsx("polyline",{className:"arrowclosed",style:r,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},rte={[_C.Arrow]:Sct,[_C.ArrowClosed]:kct};function _ct(e){const t=An();return w.useMemo(()=>Object.prototype.hasOwnProperty.call(rte,e)?rte[e]:(t.getState().onError?.("009",Fl.error009(e)),null),[e])}const Nct=({id:e,type:t,color:r,width:n=12.5,height:a=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:l="auto-start-reverse"})=>{const c=_ct(t);return c?o.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:l,refX:"0",refY:"0",children:o.jsx(c,{color:r,strokeWidth:i})}):null},m0e=({defaultColor:e,rfId:t})=>{const r=Er(s=>s.edges),n=Er(s=>s.defaultEdgeOptions),a=w.useMemo(()=>Lot(r,{id:t,defaultColor:e,defaultMarkerStart:n?.markerStart,defaultMarkerEnd:n?.markerEnd}),[r,n,t,e]);return a.length?o.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:o.jsx("defs",{children:a.map(s=>o.jsx(Nct,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};m0e.displayName="MarkerDefinitions";var Cct=w.memo(m0e);function p0e({x:e,y:t,label:r,labelStyle:n,labelShowBg:a=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:l=2,children:c,className:u,...d}){const[f,m]=w.useState({x:1,y:0,width:0,height:0}),p=ya(["react-flow__edge-textwrapper",u]),v=w.useRef(null);return w.useEffect(()=>{if(v.current){const b=v.current.getBBox();m({x:b.x,y:b.y,width:b.width,height:b.height})}},[r]),r?o.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:p,visibility:f.width?"visible":"hidden",...d,children:[a&&o.jsx("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:l,ry:l}),o.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:v,style:n,children:r}),c]}):null}p0e.displayName="EdgeText";const jct=w.memo(p0e);function Y2({path:e,labelX:t,labelY:r,label:n,labelStyle:a,labelShowBg:s,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:c,interactionWidth:u=20,...d}){return o.jsxs(o.Fragment,{children:[o.jsx("path",{...d,d:e,fill:"none",className:ya(["react-flow__edge-path",d.className])}),u?o.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,n&&Go(t)&&Go(r)?o.jsx(jct,{x:t,y:r,label:n,labelStyle:a,labelShowBg:s,labelBgStyle:i,labelBgPadding:l,labelBgBorderRadius:c}):null]})}function nte({pos:e,x1:t,y1:r,x2:n,y2:a}){return e===zt.Left||e===zt.Right?[.5*(t+n),r]:[t,.5*(r+a)]}function g0e({sourceX:e,sourceY:t,sourcePosition:r=zt.Bottom,targetX:n,targetY:a,targetPosition:s=zt.Top}){const[i,l]=nte({pos:r,x1:e,y1:t,x2:n,y2:a}),[c,u]=nte({pos:s,x1:n,y1:a,x2:e,y2:t}),[d,f,m,p]=zge({sourceX:e,sourceY:t,targetX:n,targetY:a,sourceControlX:i,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${i},${l} ${c},${u} ${n},${a}`,d,f,m,p]}function v0e(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:s,sourcePosition:i,targetPosition:l,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,interactionWidth:S})=>{const[_,N,k]=g0e({sourceX:r,sourceY:n,sourcePosition:i,targetX:a,targetY:s,targetPosition:l}),j=e.isInternal?void 0:t;return o.jsx(Y2,{id:j,path:_,labelX:N,labelY:k,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,interactionWidth:S})})}const Ect=v0e({isInternal:!1}),b0e=v0e({isInternal:!0});Ect.displayName="SimpleBezierEdge";b0e.displayName="SimpleBezierEdgeInternal";function y0e(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:s,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,sourcePosition:p=zt.Bottom,targetPosition:v=zt.Top,markerEnd:b,markerStart:y,pathOptions:S,interactionWidth:_})=>{const[N,k,j]=t5({sourceX:r,sourceY:n,sourcePosition:p,targetX:a,targetY:s,targetPosition:v,borderRadius:S?.borderRadius,offset:S?.offset,stepPosition:S?.stepPosition}),E=e.isInternal?void 0:t;return o.jsx(Y2,{id:E,path:N,labelX:k,labelY:j,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:b,markerStart:y,interactionWidth:_})})}const x0e=y0e({isInternal:!1}),w0e=y0e({isInternal:!0});x0e.displayName="SmoothStepEdge";w0e.displayName="SmoothStepEdgeInternal";function S0e(e){return w.memo(({id:t,...r})=>{const n=e.isInternal?void 0:t;return o.jsx(x0e,{...r,id:n,pathOptions:w.useMemo(()=>({borderRadius:0,offset:r.pathOptions?.offset}),[r.pathOptions?.offset])})})}const Mct=S0e({isInternal:!1}),k0e=S0e({isInternal:!0});Mct.displayName="StepEdge";k0e.displayName="StepEdgeInternal";function _0e(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:s,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:p,markerStart:v,interactionWidth:b})=>{const[y,S,_]=Fge({sourceX:r,sourceY:n,targetX:a,targetY:s}),N=e.isInternal?void 0:t;return o.jsx(Y2,{id:N,path:y,labelX:S,labelY:_,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:p,markerStart:v,interactionWidth:b})})}const Tct=_0e({isInternal:!1}),N0e=_0e({isInternal:!0});Tct.displayName="StraightEdge";N0e.displayName="StraightEdgeInternal";function C0e(e){return w.memo(({id:t,sourceX:r,sourceY:n,targetX:a,targetY:s,sourcePosition:i=zt.Bottom,targetPosition:l=zt.Top,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,pathOptions:S,interactionWidth:_})=>{const[N,k,j]=Bge({sourceX:r,sourceY:n,sourcePosition:i,targetX:a,targetY:s,targetPosition:l,curvature:S?.curvature}),E=e.isInternal?void 0:t;return o.jsx(Y2,{id:E,path:N,labelX:k,labelY:j,label:c,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:y,interactionWidth:_})})}const Act=C0e({isInternal:!1}),j0e=C0e({isInternal:!0});Act.displayName="BezierEdge";j0e.displayName="BezierEdgeInternal";const ate={default:j0e,straight:N0e,step:k0e,smoothstep:w0e,simplebezier:b0e},ste={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Dct=(e,t,r)=>r===zt.Left?e-t:r===zt.Right?e+t:e,Lct=(e,t,r)=>r===zt.Top?e-t:r===zt.Bottom?e+t:e,ite="react-flow__edgeupdater";function ote({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:a,onMouseEnter:s,onMouseOut:i,type:l}){return o.jsx("circle",{onMouseDown:a,onMouseEnter:s,onMouseOut:i,className:ya([ite,`${ite}-${l}`]),cx:Dct(t,n,e),cy:Lct(r,n,e),r:n,stroke:"transparent",fill:"transparent"})}function Oct({isReconnectable:e,reconnectRadius:t,edge:r,sourceX:n,sourceY:a,targetX:s,targetY:i,sourcePosition:l,targetPosition:c,onReconnect:u,onReconnectStart:d,onReconnectEnd:f,setReconnecting:m,setUpdateHover:p}){const v=An(),b=(k,j)=>{if(k.button!==0)return;const{autoPanOnConnect:E,domNode:T,isValidConnection:O,connectionMode:R,connectionRadius:H,lib:$,onConnectStart:L,onConnectEnd:A,cancelConnection:M,nodeLookup:P,rfId:I,panBy:B,updateConnection:F}=v.getState(),q=j.type==="target",Q=(J,X)=>{m(!1),f?.(J,r,j.type,X)},W=J=>u?.(r,J),G=(J,X)=>{m(!0),d?.(k,r,j.type),L?.(J,X)};a5.onPointerDown(k.nativeEvent,{autoPanOnConnect:E,connectionMode:R,connectionRadius:H,domNode:T,handleId:j.id,nodeId:j.nodeId,nodeLookup:P,isTarget:q,edgeUpdaterType:j.type,lib:$,flowId:I,cancelConnection:M,panBy:B,isValidConnection:O,onConnect:W,onConnectStart:G,onConnectEnd:A,onReconnectEnd:Q,updateConnection:F,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,dragThreshold:v.getState().connectionDragThreshold,handleDomNode:k.currentTarget})},y=k=>b(k,{nodeId:r.target,id:r.targetHandle??null,type:"target"}),S=k=>b(k,{nodeId:r.source,id:r.sourceHandle??null,type:"source"}),_=()=>p(!0),N=()=>p(!1);return o.jsxs(o.Fragment,{children:[(e===!0||e==="source")&&o.jsx(ote,{position:l,centerX:n,centerY:a,radius:t,onMouseDown:y,onMouseEnter:_,onMouseOut:N,type:"source"}),(e===!0||e==="target")&&o.jsx(ote,{position:c,centerX:s,centerY:i,radius:t,onMouseDown:S,onMouseEnter:_,onMouseOut:N,type:"target"})]})}function Ict({id:e,edgesFocusable:t,edgesReconnectable:r,elementsSelectable:n,onClick:a,onDoubleClick:s,onContextMenu:i,onMouseEnter:l,onMouseMove:c,onMouseLeave:u,reconnectRadius:d,onReconnect:f,onReconnectStart:m,onReconnectEnd:p,rfId:v,edgeTypes:b,noPanClassName:y,onError:S,disableKeyboardA11y:_}){let N=Er(Z=>Z.edgeLookup.get(e));const k=Er(Z=>Z.defaultEdgeOptions);N=k?{...k,...N}:N;let j=N.type||"default",E=b?.[j]||ate[j];E===void 0&&(S?.("011",Fl.error011(j)),j="default",E=b?.default||ate.default);const T=!!(N.focusable||t&&typeof N.focusable>"u"),O=typeof f<"u"&&(N.reconnectable||r&&typeof N.reconnectable>"u"),R=!!(N.selectable||n&&typeof N.selectable>"u"),H=w.useRef(null),[$,L]=w.useState(!1),[A,M]=w.useState(!1),P=An(),{zIndex:I,sourceX:B,sourceY:F,targetX:q,targetY:Q,sourcePosition:W,targetPosition:G}=Er(w.useCallback(Z=>{const ve=Z.nodeLookup.get(N.source),U=Z.nodeLookup.get(N.target);if(!ve||!U)return{zIndex:N.zIndex,...ste};const ge=Dot({id:e,sourceNode:ve,targetNode:U,sourceHandle:N.sourceHandle||null,targetHandle:N.targetHandle||null,connectionMode:Z.connectionMode,onError:S});return{zIndex:_ot({selected:N.selected,zIndex:N.zIndex,sourceNode:ve,targetNode:U,elevateOnSelect:Z.elevateEdgesOnSelect,zIndexMode:Z.zIndexMode}),...ge||ste}},[N.source,N.target,N.sourceHandle,N.targetHandle,N.selected,N.zIndex]),Tn),J=w.useMemo(()=>N.markerStart?`url('#${r5(N.markerStart,v)}')`:void 0,[N.markerStart,v]),X=w.useMemo(()=>N.markerEnd?`url('#${r5(N.markerEnd,v)}')`:void 0,[N.markerEnd,v]);if(N.hidden||B===null||F===null||q===null||Q===null)return null;const V=Z=>{const{addSelectedEdges:ve,unselectNodesAndEdges:U,multiSelectionActive:ge}=P.getState();R&&(P.setState({nodesSelectionActive:!1}),N.selected&&ge?(U({nodes:[],edges:[N]}),H.current?.blur()):ve([e])),a&&a(Z,N)},se=s?Z=>{s(Z,{...N})}:void 0,de=i?Z=>{i(Z,{...N})}:void 0,he=l?Z=>{l(Z,{...N})}:void 0,te=c?Z=>{c(Z,{...N})}:void 0,le=u?Z=>{u(Z,{...N})}:void 0,oe=Z=>{if(!_&&_ge.includes(Z.key)&&R){const{unselectNodesAndEdges:ve,addSelectedEdges:U}=P.getState();Z.key==="Escape"?(H.current?.blur(),ve({edges:[N]})):U([e])}};return o.jsx("svg",{style:{zIndex:I},children:o.jsxs("g",{className:ya(["react-flow__edge",`react-flow__edge-${j}`,N.className,y,{selected:N.selected,animated:N.animated,inactive:!R&&!a,updating:$,selectable:R}]),onClick:V,onDoubleClick:se,onContextMenu:de,onMouseEnter:he,onMouseMove:te,onMouseLeave:le,onKeyDown:T?oe:void 0,tabIndex:T?0:void 0,role:N.ariaRole??(T?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":N.ariaLabel===null?void 0:N.ariaLabel||`Edge from ${N.source} to ${N.target}`,"aria-describedby":T?`${r0e}-${v}`:void 0,ref:H,...N.domAttributes,children:[!A&&o.jsx(E,{id:e,source:N.source,target:N.target,type:N.type,selected:N.selected,animated:N.animated,selectable:R,deletable:N.deletable??!0,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,sourceX:B,sourceY:F,targetX:q,targetY:Q,sourcePosition:W,targetPosition:G,data:N.data,style:N.style,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerStart:J,markerEnd:X,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth}),O&&o.jsx(Oct,{edge:N,isReconnectable:O,reconnectRadius:d,onReconnect:f,onReconnectStart:m,onReconnectEnd:p,sourceX:B,sourceY:F,targetX:q,targetY:Q,sourcePosition:W,targetPosition:G,setUpdateHover:L,setReconnecting:M})]})})}var Rct=w.memo(Ict);const Pct=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function E0e({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:r,edgeTypes:n,noPanClassName:a,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:m,onReconnectStart:p,onReconnectEnd:v,disableKeyboardA11y:b}){const{edgesFocusable:y,edgesReconnectable:S,elementsSelectable:_,onError:N}=Er(Pct,Tn),k=wct(t);return o.jsxs("div",{className:"react-flow__edges",children:[o.jsx(Cct,{defaultColor:e,rfId:r}),k.map(j=>o.jsx(Rct,{id:j,edgesFocusable:y,edgesReconnectable:S,elementsSelectable:_,noPanClassName:a,onReconnect:s,onContextMenu:i,onMouseEnter:l,onMouseMove:c,onMouseLeave:u,onClick:d,reconnectRadius:f,onDoubleClick:m,onReconnectStart:p,onReconnectEnd:v,rfId:r,onError:N,edgeTypes:n,disableKeyboardA11y:b},j))]})}E0e.displayName="EdgeRenderer";const zct=w.memo(E0e),Bct=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function $ct({children:e}){const t=Er(Bct);return o.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Fct(e){const t=o$(),r=w.useRef(!1);w.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const Uct=e=>e.panZoom?.syncViewport;function Hct(e){const t=Er(Uct),r=An();return w.useEffect(()=>{e&&(t?.(e),r.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function qct(e){return e.connection.inProgress?{...e.connection,to:M1(e.connection.to,e.transform)}:{...e.connection}}function Wct(e){return qct}function Kct(e){const t=Wct();return Er(t,Tn)}const Gct=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Vct({containerStyle:e,style:t,type:r,component:n}){const{nodesConnectable:a,width:s,height:i,isValid:l,inProgress:c}=Er(Gct,Tn);return!(s&&a&&c)?null:o.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:o.jsx("g",{className:ya(["react-flow__connection",jge(l)]),children:o.jsx(M0e,{style:t,type:r,CustomComponent:n,isValid:l})})})}const M0e=({style:e,type:t=hd.Bezier,CustomComponent:r,isValid:n})=>{const{inProgress:a,from:s,fromNode:i,fromHandle:l,fromPosition:c,to:u,toNode:d,toHandle:f,toPosition:m,pointer:p}=Kct();if(!a)return;if(r)return o.jsx(r,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:l,fromX:s.x,fromY:s.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:m,connectionStatus:jge(n),toNode:d,toHandle:f,pointer:p});let v="";const b={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:m};switch(t){case hd.Bezier:[v]=Bge(b);break;case hd.SimpleBezier:[v]=g0e(b);break;case hd.Step:[v]=t5({...b,borderRadius:0});break;case hd.SmoothStep:[v]=t5(b);break;default:[v]=Fge(b)}return o.jsx("path",{d:v,fill:"none",className:"react-flow__connection-path",style:e})};M0e.displayName="ConnectionLine";const Yct={};function lte(e=Yct){w.useRef(e),An(),w.useEffect(()=>{},[e])}function Qct(){An(),w.useRef(!1),w.useEffect(()=>{},[])}function T0e({nodeTypes:e,edgeTypes:t,onInit:r,onNodeClick:n,onEdgeClick:a,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:l,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:m,onSelectionEnd:p,connectionLineType:v,connectionLineStyle:b,connectionLineComponent:y,connectionLineContainerStyle:S,selectionKeyCode:_,selectionOnDrag:N,selectionMode:k,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:T,deleteKeyCode:O,onlyRenderVisibleElements:R,elementsSelectable:H,defaultViewport:$,translateExtent:L,minZoom:A,maxZoom:M,preventScrolling:P,defaultMarkerColor:I,zoomOnScroll:B,zoomOnPinch:F,panOnScroll:q,panOnScrollSpeed:Q,panOnScrollMode:W,zoomOnDoubleClick:G,panOnDrag:J,onPaneClick:X,onPaneMouseEnter:V,onPaneMouseMove:se,onPaneMouseLeave:de,onPaneScroll:he,onPaneContextMenu:te,paneClickDistance:le,nodeClickDistance:oe,onEdgeContextMenu:Z,onEdgeMouseEnter:ve,onEdgeMouseMove:U,onEdgeMouseLeave:ge,reconnectRadius:ue,onReconnect:re,onReconnectStart:ne,onReconnectEnd:me,noDragClassName:ke,noWheelClassName:we,noPanClassName:pe,disableKeyboardA11y:Oe,nodeExtent:Ae,rfId:Re,viewport:Ve,onViewportChange:gt}){return lte(e),lte(t),Qct(),Fct(r),Hct(Ve),o.jsx(dct,{onPaneClick:X,onPaneMouseEnter:V,onPaneMouseMove:se,onPaneMouseLeave:de,onPaneContextMenu:te,onPaneScroll:he,paneClickDistance:le,deleteKeyCode:O,selectionKeyCode:_,selectionOnDrag:N,selectionMode:k,onSelectionStart:m,onSelectionEnd:p,multiSelectionKeyCode:j,panActivationKeyCode:E,zoomActivationKeyCode:T,elementsSelectable:H,zoomOnScroll:B,zoomOnPinch:F,zoomOnDoubleClick:G,panOnScroll:q,panOnScrollSpeed:Q,panOnScrollMode:W,panOnDrag:J,defaultViewport:$,translateExtent:L,minZoom:A,maxZoom:M,onSelectionContextMenu:f,preventScrolling:P,noDragClassName:ke,noWheelClassName:we,noPanClassName:pe,disableKeyboardA11y:Oe,onViewportChange:gt,isControlledViewport:!!Ve,children:o.jsxs($ct,{children:[o.jsx(zct,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:i,onReconnect:re,onReconnectStart:ne,onReconnectEnd:me,onlyRenderVisibleElements:R,onEdgeContextMenu:Z,onEdgeMouseEnter:ve,onEdgeMouseMove:U,onEdgeMouseLeave:ge,reconnectRadius:ue,defaultMarkerColor:I,noPanClassName:pe,disableKeyboardA11y:Oe,rfId:Re}),o.jsx(Vct,{style:b,type:v,component:y,containerStyle:S}),o.jsx("div",{className:"react-flow__edgelabel-renderer"}),o.jsx(xct,{nodeTypes:e,onNodeClick:n,onNodeDoubleClick:s,onNodeMouseEnter:l,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:d,nodeClickDistance:oe,onlyRenderVisibleElements:R,noPanClassName:pe,noDragClassName:ke,disableKeyboardA11y:Oe,nodeExtent:Ae,rfId:Re}),o.jsx("div",{className:"react-flow__viewport-portal"})]})})}T0e.displayName="GraphView";const Jct=w.memo(T0e),cte=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:a,height:s,fitView:i,fitViewOptions:l,minZoom:c=.5,maxZoom:u=2,nodeOrigin:d,nodeExtent:f,zIndexMode:m="basic"}={})=>{const p=new Map,v=new Map,b=new Map,y=new Map,S=n??t??[],_=r??e??[],N=d??[0,0],k=f??gx;qge(b,y,S);const j=n5(_,p,v,{nodeOrigin:N,nodeExtent:k,zIndexMode:m});let E=[0,0,1];if(i&&a&&s){const T=j1(p,{filter:$=>!!(($.width||$.initialWidth)&&($.height||$.initialHeight))}),{x:O,y:R,zoom:H}=e$(T,a,s,c,u,l?.padding??.1);E=[O,R,H]}return{rfId:"1",width:a??0,height:s??0,transform:E,nodes:_,nodesInitialized:j,nodeLookup:p,parentLookup:v,edges:S,edgeLookup:y,connectionLookup:b,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:r!==void 0,hasDefaultEdges:n!==void 0,panZoom:null,minZoom:c,maxZoom:u,translateExtent:gx,nodeExtent:k,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Pg.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:l,fitViewResolver:null,connection:{...Cge},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:bot,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Nge,zIndexMode:m,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Zct=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:a,height:s,fitView:i,fitViewOptions:l,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:f,zIndexMode:m})=>glt((p,v)=>{async function b(){const{nodeLookup:y,panZoom:S,fitViewOptions:_,fitViewResolver:N,width:k,height:j,minZoom:E,maxZoom:T}=v();S&&(await got({nodes:y,width:k,height:j,panZoom:S,minZoom:E,maxZoom:T},_),N?.resolve(!0),p({fitViewResolver:null}))}return{...cte({nodes:e,edges:t,width:a,height:s,fitView:i,fitViewOptions:l,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:f,defaultNodes:r,defaultEdges:n,zIndexMode:m}),setNodes:y=>{const{nodeLookup:S,parentLookup:_,nodeOrigin:N,elevateNodesOnSelect:k,fitViewQueued:j,zIndexMode:E}=v(),T=n5(y,S,_,{nodeOrigin:N,nodeExtent:f,elevateNodesOnSelect:k,checkEquality:!0,zIndexMode:E});j&&T?(b(),p({nodes:y,nodesInitialized:T,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:y,nodesInitialized:T})},setEdges:y=>{const{connectionLookup:S,edgeLookup:_}=v();qge(S,_,y),p({edges:y})},setDefaultNodesAndEdges:(y,S)=>{if(y){const{setNodes:_}=v();_(y),p({hasDefaultNodes:!0})}if(S){const{setEdges:_}=v();_(S),p({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:S,nodeLookup:_,parentLookup:N,domNode:k,nodeOrigin:j,nodeExtent:E,debug:T,fitViewQueued:O,zIndexMode:R}=v(),{changes:H,updatedInternals:$}=$ot(y,_,N,k,j,E,R);$&&(Rot(_,N,{nodeOrigin:j,nodeExtent:E,zIndexMode:R}),O?(b(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),H?.length>0&&(T&&console.log("React Flow: trigger node changes",H),S?.(H)))},updateNodePositions:(y,S=!1)=>{const _=[];let N=[];const{nodeLookup:k,triggerNodeChanges:j,connection:E,updateConnection:T,onNodesChangeMiddlewareMap:O}=v();for(const[R,H]of y){const $=k.get(R),L=!!($?.expandParent&&$?.parentId&&H?.position),A={id:R,type:"position",position:L?{x:Math.max(0,H.position.x),y:Math.max(0,H.position.y)}:H.position,dragging:S};if($&&E.inProgress&&E.fromNode.id===$.id){const M=Ph($,E.fromHandle,zt.Left,!0);T({...E,from:M})}L&&$.parentId&&_.push({id:R,parentId:$.parentId,rect:{...H.internals.positionAbsolute,width:H.measured.width??0,height:H.measured.height??0}}),N.push(A)}if(_.length>0){const{parentLookup:R,nodeOrigin:H}=v(),$=i$(_,k,R,H);N.push(...$)}for(const R of O.values())N=R(N);j(N)},triggerNodeChanges:y=>{const{onNodesChange:S,setNodes:_,nodes:N,hasDefaultNodes:k,debug:j}=v();if(y?.length){if(k){const E=s0e(y,N);_(E)}j&&console.log("React Flow: trigger node changes",y),S?.(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:S,setEdges:_,edges:N,hasDefaultEdges:k,debug:j}=v();if(y?.length){if(k){const E=i0e(y,N);_(E)}j&&console.log("React Flow: trigger edge changes",y),S?.(y)}},addSelectedNodes:y=>{const{multiSelectionActive:S,edgeLookup:_,nodeLookup:N,triggerNodeChanges:k,triggerEdgeChanges:j}=v();if(S){const E=y.map(T=>Ff(T,!0));k(E);return}k(Dp(N,new Set([...y]),!0)),j(Dp(_))},addSelectedEdges:y=>{const{multiSelectionActive:S,edgeLookup:_,nodeLookup:N,triggerNodeChanges:k,triggerEdgeChanges:j}=v();if(S){const E=y.map(T=>Ff(T,!0));j(E);return}j(Dp(_,new Set([...y]))),k(Dp(N,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:S}={})=>{const{edges:_,nodes:N,nodeLookup:k,triggerNodeChanges:j,triggerEdgeChanges:E}=v(),T=y||N,O=S||_,R=T.map($=>{const L=k.get($.id);return L&&(L.selected=!1),Ff($.id,!1)}),H=O.map($=>Ff($.id,!1));j(R),E(H)},setMinZoom:y=>{const{panZoom:S,maxZoom:_}=v();S?.setScaleExtent([y,_]),p({minZoom:y})},setMaxZoom:y=>{const{panZoom:S,minZoom:_}=v();S?.setScaleExtent([_,y]),p({maxZoom:y})},setTranslateExtent:y=>{v().panZoom?.setTranslateExtent(y),p({translateExtent:y})},resetSelectedElements:()=>{const{edges:y,nodes:S,triggerNodeChanges:_,triggerEdgeChanges:N,elementsSelectable:k}=v();if(!k)return;const j=S.reduce((T,O)=>O.selected?[...T,Ff(O.id,!1)]:T,[]),E=y.reduce((T,O)=>O.selected?[...T,Ff(O.id,!1)]:T,[]);_(j),N(E)},setNodeExtent:y=>{const{nodes:S,nodeLookup:_,parentLookup:N,nodeOrigin:k,elevateNodesOnSelect:j,nodeExtent:E,zIndexMode:T}=v();y[0][0]===E[0][0]&&y[0][1]===E[0][1]&&y[1][0]===E[1][0]&&y[1][1]===E[1][1]||(n5(S,_,N,{nodeOrigin:k,nodeExtent:y,elevateNodesOnSelect:j,checkEquality:!1,zIndexMode:T}),p({nodeExtent:y}))},panBy:y=>{const{transform:S,width:_,height:N,panZoom:k,translateExtent:j}=v();return Fot({delta:y,panZoom:k,transform:S,translateExtent:j,width:_,height:N})},setCenter:async(y,S,_)=>{const{width:N,height:k,maxZoom:j,panZoom:E}=v();if(!E)return Promise.resolve(!1);const T=typeof _?.zoom<"u"?_.zoom:j;return await E.setViewport({x:N/2-y*T,y:k/2-S*T,zoom:T},{duration:_?.duration,ease:_?.ease,interpolate:_?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...Cge}})},updateConnection:y=>{p({connection:y})},reset:()=>p({...cte()})}},Object.is);function Xct({initialNodes:e,initialEdges:t,defaultNodes:r,defaultEdges:n,initialWidth:a,initialHeight:s,initialMinZoom:i,initialMaxZoom:l,initialFitViewOptions:c,fitView:u,nodeOrigin:d,nodeExtent:f,zIndexMode:m,children:p}){const[v]=w.useState(()=>Zct({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,width:a,height:s,fitView:u,minZoom:i,maxZoom:l,fitViewOptions:c,nodeOrigin:d,nodeExtent:f,zIndexMode:m}));return o.jsx(vlt,{value:v,children:o.jsx($lt,{children:p})})}function eut({children:e,nodes:t,edges:r,defaultNodes:n,defaultEdges:a,width:s,height:i,fitView:l,fitViewOptions:c,minZoom:u,maxZoom:d,nodeOrigin:f,nodeExtent:m,zIndexMode:p}){return w.useContext(K2)?o.jsx(o.Fragment,{children:e}):o.jsx(Xct,{initialNodes:t,initialEdges:r,defaultNodes:n,defaultEdges:a,initialWidth:s,initialHeight:i,fitView:l,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:d,nodeOrigin:f,nodeExtent:m,zIndexMode:p,children:e})}const tut={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function rut({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:a,nodeTypes:s,edgeTypes:i,onNodeClick:l,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:m,onConnect:p,onConnectStart:v,onConnectEnd:b,onClickConnectStart:y,onClickConnectEnd:S,onNodeMouseEnter:_,onNodeMouseMove:N,onNodeMouseLeave:k,onNodeContextMenu:j,onNodeDoubleClick:E,onNodeDragStart:T,onNodeDrag:O,onNodeDragStop:R,onNodesDelete:H,onEdgesDelete:$,onDelete:L,onSelectionChange:A,onSelectionDragStart:M,onSelectionDrag:P,onSelectionDragStop:I,onSelectionContextMenu:B,onSelectionStart:F,onSelectionEnd:q,onBeforeDelete:Q,connectionMode:W,connectionLineType:G=hd.Bezier,connectionLineStyle:J,connectionLineComponent:X,connectionLineContainerStyle:V,deleteKeyCode:se="Backspace",selectionKeyCode:de="Shift",selectionOnDrag:he=!1,selectionMode:te=vx.Full,panActivationKeyCode:le="Space",multiSelectionKeyCode:oe=yx()?"Meta":"Control",zoomActivationKeyCode:Z=yx()?"Meta":"Control",snapToGrid:ve,snapGrid:U,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:ue,nodesDraggable:re,autoPanOnNodeFocus:ne,nodesConnectable:me,nodesFocusable:ke,nodeOrigin:we=n0e,edgesFocusable:pe,edgesReconnectable:Oe,elementsSelectable:Ae=!0,defaultViewport:Re=Tlt,minZoom:Ve=.5,maxZoom:gt=2,translateExtent:lt=gx,preventScrolling:Pt=!0,nodeExtent:fr,defaultMarkerColor:Qe="#b1b1b7",zoomOnScroll:Vt=!0,zoomOnPinch:at=!0,panOnScroll:Ne=!1,panOnScrollSpeed:Fe=.5,panOnScrollMode:Ke=fh.Free,zoomOnDoubleClick:Tt=!0,panOnDrag:wt=!0,onPaneClick:Zt,onPaneMouseEnter:Xe,onPaneMouseMove:nt,onPaneMouseLeave:bt,onPaneScroll:Ct,onPaneContextMenu:fe,paneClickDistance:De=1,nodeClickDistance:Ue=0,children:dt,onReconnect:Nt,onReconnectStart:Mt,onReconnectEnd:Je,onEdgeContextMenu:et,onEdgeDoubleClick:it,onEdgeMouseEnter:tr,onEdgeMouseMove:ee,onEdgeMouseLeave:Le,reconnectRadius:We=10,onNodesChange:be,onEdgesChange:K,noDragClassName:ie="nodrag",noWheelClassName:xe="nowheel",noPanClassName:Ce="nopan",fitView:ht,fitViewOptions:ot,connectOnClick:Dt,attributionPosition:Ut,proOptions:ct,defaultEdgeOptions:Bt,elevateNodesOnSelect:ut=!0,elevateEdgesOnSelect:qt=!1,disableKeyboardA11y:nr=!1,autoPanOnConnect:Dr,autoPanOnNodeDrag:vn,autoPanSpeed:gm,connectionRadius:Gl,isValidConnection:Mo,onError:Ye,style:At,id:or,nodeDragThreshold:$r,connectionDragThreshold:On,viewport:Aa,onViewportChange:Ns,width:hs,height:nn,colorMode:Cs="light",debug:vm,onScroll:Vl,ariaLabelConfig:Qd,zIndexMode:Yl="basic",...C0},ms){const Ql=or||"1",Jl=Olt(Cs),wu=w.useCallback(aa=>{aa.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Vl?.(aa)},[Vl]);return o.jsx("div",{"data-testid":"rf__wrapper",...C0,onScroll:wu,style:{...At,...tut},ref:ms,className:ya(["react-flow",a,Jl]),id:or,role:"application",children:o.jsxs(eut,{nodes:e,edges:t,width:hs,height:nn,fitView:ht,fitViewOptions:ot,minZoom:Ve,maxZoom:gt,nodeOrigin:we,nodeExtent:fr,zIndexMode:Yl,children:[o.jsx(Jct,{onInit:u,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:_,onNodeMouseMove:N,onNodeMouseLeave:k,onNodeContextMenu:j,onNodeDoubleClick:E,nodeTypes:s,edgeTypes:i,connectionLineType:G,connectionLineStyle:J,connectionLineComponent:X,connectionLineContainerStyle:V,selectionKeyCode:de,selectionOnDrag:he,selectionMode:te,deleteKeyCode:se,multiSelectionKeyCode:oe,panActivationKeyCode:le,zoomActivationKeyCode:Z,onlyRenderVisibleElements:ge,defaultViewport:Re,translateExtent:lt,minZoom:Ve,maxZoom:gt,preventScrolling:Pt,zoomOnScroll:Vt,zoomOnPinch:at,zoomOnDoubleClick:Tt,panOnScroll:Ne,panOnScrollSpeed:Fe,panOnScrollMode:Ke,panOnDrag:wt,onPaneClick:Zt,onPaneMouseEnter:Xe,onPaneMouseMove:nt,onPaneMouseLeave:bt,onPaneScroll:Ct,onPaneContextMenu:fe,paneClickDistance:De,nodeClickDistance:Ue,onSelectionContextMenu:B,onSelectionStart:F,onSelectionEnd:q,onReconnect:Nt,onReconnectStart:Mt,onReconnectEnd:Je,onEdgeContextMenu:et,onEdgeDoubleClick:it,onEdgeMouseEnter:tr,onEdgeMouseMove:ee,onEdgeMouseLeave:Le,reconnectRadius:We,defaultMarkerColor:Qe,noDragClassName:ie,noWheelClassName:xe,noPanClassName:Ce,rfId:Ql,disableKeyboardA11y:nr,nodeExtent:fr,viewport:Aa,onViewportChange:Ns}),o.jsx(Llt,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:p,onConnectStart:v,onConnectEnd:b,onClickConnectStart:y,onClickConnectEnd:S,nodesDraggable:re,autoPanOnNodeFocus:ne,nodesConnectable:me,nodesFocusable:ke,edgesFocusable:pe,edgesReconnectable:Oe,elementsSelectable:Ae,elevateNodesOnSelect:ut,elevateEdgesOnSelect:qt,minZoom:Ve,maxZoom:gt,nodeExtent:fr,onNodesChange:be,onEdgesChange:K,snapToGrid:ve,snapGrid:U,connectionMode:W,translateExtent:lt,connectOnClick:Dt,defaultEdgeOptions:Bt,fitView:ht,fitViewOptions:ot,onNodesDelete:H,onEdgesDelete:$,onDelete:L,onNodeDragStart:T,onNodeDrag:O,onNodeDragStop:R,onSelectionDrag:P,onSelectionDragStart:M,onSelectionDragStop:I,onMove:d,onMoveStart:f,onMoveEnd:m,noPanClassName:Ce,nodeOrigin:we,rfId:Ql,autoPanOnConnect:Dr,autoPanOnNodeDrag:vn,autoPanSpeed:gm,onError:Ye,connectionRadius:Gl,isValidConnection:Mo,selectNodesOnDrag:ue,nodeDragThreshold:$r,connectionDragThreshold:On,onBeforeDelete:Q,debug:vm,ariaLabelConfig:Qd,zIndexMode:Yl}),o.jsx(Mlt,{onSelectionChange:A}),dt,o.jsx(_lt,{proOptions:ct,position:Ut}),o.jsx(klt,{rfId:Ql,disableKeyboardA11y:nr})]})})}var nut=o0e(rut);function aut(e){const[t,r]=w.useState(e),n=w.useCallback(a=>r(s=>s0e(a,s)),[]);return[t,r,n]}function sut(e){const[t,r]=w.useState(e),n=w.useCallback(a=>r(s=>i0e(a,s)),[]);return[t,r,n]}function iut({dimensions:e,lineWidth:t,variant:r,className:n}){return o.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ya(["react-flow__background-pattern",r,n])})}function out({radius:e,className:t}){return o.jsx("circle",{cx:e,cy:e,r:e,className:ya(["react-flow__background-pattern","dots",t])})}var Dd;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Dd||(Dd={}));const lut={[Dd.Dots]:1,[Dd.Lines]:1,[Dd.Cross]:6},cut=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function A0e({id:e,variant:t=Dd.Dots,gap:r=20,size:n,lineWidth:a=1,offset:s=0,color:i,bgColor:l,style:c,className:u,patternClassName:d}){const f=w.useRef(null),{transform:m,patternId:p}=Er(cut,Tn),v=n||lut[t],b=t===Dd.Dots,y=t===Dd.Cross,S=Array.isArray(r)?r:[r,r],_=[S[0]*m[2]||1,S[1]*m[2]||1],N=v*m[2],k=Array.isArray(s)?s:[s,s],j=y?[N,N]:_,E=[k[0]*m[2]||1+j[0]/2,k[1]*m[2]||1+j[1]/2],T=`${p}${e||""}`;return o.jsxs("svg",{className:ya(["react-flow__background",u]),style:{...c,...V2,"--xy-background-color-props":l,"--xy-background-pattern-color-props":i},ref:f,"data-testid":"rf__background",children:[o.jsx("pattern",{id:T,x:m[0]%_[0],y:m[1]%_[1],width:_[0],height:_[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:b?o.jsx(out,{radius:N/2,className:d}):o.jsx(iut,{dimensions:j,lineWidth:a,variant:t,className:d})}),o.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${T})`})]})}A0e.displayName="Background";const uut=w.memo(A0e);function dut(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:o.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function fut(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:o.jsx("path",{d:"M0 0h32v4.2H0z"})})}function hut(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:o.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function mut(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:o.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function put(){return o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:o.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function VS({children:e,className:t,...r}){return o.jsx("button",{type:"button",className:ya(["react-flow__controls-button",t]),...r,children:e})}const gut=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function D0e({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:n=!0,fitViewOptions:a,onZoomIn:s,onZoomOut:i,onFitView:l,onInteractiveChange:c,className:u,children:d,position:f="bottom-left",orientation:m="vertical","aria-label":p}){const v=An(),{isInteractive:b,minZoomReached:y,maxZoomReached:S,ariaLabelConfig:_}=Er(gut,Tn),{zoomIn:N,zoomOut:k,fitView:j}=o$(),E=()=>{N(),s?.()},T=()=>{k(),i?.()},O=()=>{j(a),l?.()},R=()=>{v.setState({nodesDraggable:!b,nodesConnectable:!b,elementsSelectable:!b}),c?.(!b)},H=m==="horizontal"?"horizontal":"vertical";return o.jsxs(G2,{className:ya(["react-flow__controls",H,u]),position:f,style:e,"data-testid":"rf__controls","aria-label":p??_["controls.ariaLabel"],children:[t&&o.jsxs(o.Fragment,{children:[o.jsx(VS,{onClick:E,className:"react-flow__controls-zoomin",title:_["controls.zoomIn.ariaLabel"],"aria-label":_["controls.zoomIn.ariaLabel"],disabled:S,children:o.jsx(dut,{})}),o.jsx(VS,{onClick:T,className:"react-flow__controls-zoomout",title:_["controls.zoomOut.ariaLabel"],"aria-label":_["controls.zoomOut.ariaLabel"],disabled:y,children:o.jsx(fut,{})})]}),r&&o.jsx(VS,{className:"react-flow__controls-fitview",onClick:O,title:_["controls.fitView.ariaLabel"],"aria-label":_["controls.fitView.ariaLabel"],children:o.jsx(hut,{})}),n&&o.jsx(VS,{className:"react-flow__controls-interactive",onClick:R,title:_["controls.interactive.ariaLabel"],"aria-label":_["controls.interactive.ariaLabel"],children:b?o.jsx(put,{}):o.jsx(mut,{})}),d]})}D0e.displayName="Controls";const vut=w.memo(D0e);function but({id:e,x:t,y:r,width:n,height:a,style:s,color:i,strokeColor:l,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,selected:m,onClick:p}){const{background:v,backgroundColor:b}=s||{},y=i||v||b;return o.jsx("rect",{className:ya(["react-flow__minimap-node",{selected:m},u]),x:t,y:r,rx:d,ry:d,width:n,height:a,style:{fill:y,stroke:l,strokeWidth:c},shapeRendering:f,onClick:p?S=>p(S,e):void 0})}const yut=w.memo(but),xut=e=>e.nodes.map(t=>t.id),KL=e=>e instanceof Function?e:()=>e;function wut({nodeStrokeColor:e,nodeColor:t,nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:a,nodeComponent:s=yut,onClick:i}){const l=Er(xut,Tn),c=KL(t),u=KL(e),d=KL(r),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return o.jsx(o.Fragment,{children:l.map(m=>o.jsx(kut,{id:m,nodeColorFunc:c,nodeStrokeColorFunc:u,nodeClassNameFunc:d,nodeBorderRadius:n,nodeStrokeWidth:a,NodeComponent:s,onClick:i,shapeRendering:f},m))})}function Sut({id:e,nodeColorFunc:t,nodeStrokeColorFunc:r,nodeClassNameFunc:n,nodeBorderRadius:a,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:l,onClick:c}){const{node:u,x:d,y:f,width:m,height:p}=Er(v=>{const{internals:b}=v.nodeLookup.get(e),y=b.userNode,{x:S,y:_}=b.positionAbsolute,{width:N,height:k}=yu(y);return{node:y,x:S,y:_,width:N,height:k}},Tn);return!u||u.hidden||!Lge(u)?null:o.jsx(l,{x:d,y:f,width:m,height:p,style:u.style,selected:!!u.selected,className:n(u),color:t(u),borderRadius:a,strokeColor:r(u),strokeWidth:s,shapeRendering:i,onClick:c,id:u.id})}const kut=w.memo(Sut);var _ut=w.memo(wut);const Nut=200,Cut=150,jut=e=>!e.hidden,Eut=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Dge(j1(e.nodeLookup,{filter:jut}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Mut="react-flow__minimap-desc";function L0e({style:e,className:t,nodeStrokeColor:r,nodeColor:n,nodeClassName:a="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:l,bgColor:c,maskColor:u,maskStrokeColor:d,maskStrokeWidth:f,position:m="bottom-right",onClick:p,onNodeClick:v,pannable:b=!1,zoomable:y=!1,ariaLabel:S,inversePan:_,zoomStep:N=1,offsetScale:k=5}){const j=An(),E=w.useRef(null),{boundingRect:T,viewBB:O,rfId:R,panZoom:H,translateExtent:$,flowWidth:L,flowHeight:A,ariaLabelConfig:M}=Er(Eut,Tn),P=e?.width??Nut,I=e?.height??Cut,B=T.width/P,F=T.height/I,q=Math.max(B,F),Q=q*P,W=q*I,G=k*q,J=T.x-(Q-T.width)/2-G,X=T.y-(W-T.height)/2-G,V=Q+G*2,se=W+G*2,de=`${Mut}-${R}`,he=w.useRef(0),te=w.useRef();he.current=q,w.useEffect(()=>{if(E.current&&H)return te.current=Qot({domNode:E.current,panZoom:H,getTransform:()=>j.getState().transform,getViewScale:()=>he.current}),()=>{te.current?.destroy()}},[H]),w.useEffect(()=>{te.current?.update({translateExtent:$,width:L,height:A,inversePan:_,pannable:b,zoomStep:N,zoomable:y})},[b,y,_,N,$,L,A]);const le=p?ve=>{const[U,ge]=te.current?.pointer(ve)||[0,0];p(ve,{x:U,y:ge})}:void 0,oe=v?w.useCallback((ve,U)=>{const ge=j.getState().nodeLookup.get(U).internals.userNode;v(ve,ge)},[]):void 0,Z=S??M["minimap.ariaLabel"];return o.jsx(G2,{position:m,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*q:void 0,"--xy-minimap-node-background-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:ya(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:o.jsxs("svg",{width:P,height:I,viewBox:`${J} ${X} ${V} ${se}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":de,ref:E,onClick:le,children:[Z&&o.jsx("title",{id:de,children:Z}),o.jsx(_ut,{onClick:oe,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:s,nodeClassName:a,nodeStrokeWidth:i,nodeComponent:l}),o.jsx("path",{className:"react-flow__minimap-mask",d:`M${J-G},${X-G}h${V+G*2}v${se+G*2}h${-V-G*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}L0e.displayName="MiniMap";const Tut=w.memo(L0e),Aut=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Dut={[Fg.Line]:"right",[Fg.Handle]:"bottom-right"};function Lut({nodeId:e,position:t,variant:r=Fg.Handle,className:n,style:a=void 0,children:s,color:i,minWidth:l=10,minHeight:c=10,maxWidth:u=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:m,autoScale:p=!0,shouldResize:v,onResizeStart:b,onResize:y,onResizeEnd:S}){const _=d0e(),N=typeof e=="string"?e:_,k=An(),j=w.useRef(null),E=r===Fg.Handle,T=Er(w.useCallback(Aut(E&&p),[E,p]),Tn),O=w.useRef(null),R=t??Dut[r];w.useEffect(()=>{if(!(!j.current||!N))return O.current||(O.current=ult({domNode:j.current,nodeId:N,getStoreItems:()=>{const{nodeLookup:$,transform:L,snapGrid:A,snapToGrid:M,nodeOrigin:P,domNode:I}=k.getState();return{nodeLookup:$,transform:L,snapGrid:A,snapToGrid:M,nodeOrigin:P,paneDomNode:I}},onChange:($,L)=>{const{triggerNodeChanges:A,nodeLookup:M,parentLookup:P,nodeOrigin:I}=k.getState(),B=[],F={x:$.x,y:$.y},q=M.get(N);if(q&&q.expandParent&&q.parentId){const Q=q.origin??I,W=$.width??q.measured.width??0,G=$.height??q.measured.height??0,J={id:q.id,parentId:q.parentId,rect:{width:W,height:G,...Oge({x:$.x??q.position.x,y:$.y??q.position.y},{width:W,height:G},q.parentId,M,Q)}},X=i$([J],M,P,I);B.push(...X),F.x=$.x?Math.max(Q[0]*W,$.x):void 0,F.y=$.y?Math.max(Q[1]*G,$.y):void 0}if(F.x!==void 0&&F.y!==void 0){const Q={id:N,type:"position",position:{...F}};B.push(Q)}if($.width!==void 0&&$.height!==void 0){const W={id:N,type:"dimensions",resizing:!0,setAttributes:m?m==="horizontal"?"width":"height":!0,dimensions:{width:$.width,height:$.height}};B.push(W)}for(const Q of L){const W={...Q,type:"position"};B.push(W)}A(B)},onEnd:({width:$,height:L})=>{const A={id:N,type:"dimensions",resizing:!1,dimensions:{width:$,height:L}};k.getState().triggerNodeChanges([A])}})),O.current.update({controlPosition:R,boundaries:{minWidth:l,minHeight:c,maxWidth:u,maxHeight:d},keepAspectRatio:f,resizeDirection:m,onResizeStart:b,onResize:y,onResizeEnd:S,shouldResize:v}),()=>{O.current?.destroy()}},[R,l,c,u,d,f,b,y,S,v]);const H=R.split("-");return o.jsx("div",{className:ya(["react-flow__resize-control","nodrag",...H,r,n]),ref:j,style:{...a,scale:T,...i&&{[E?"backgroundColor":"borderColor"]:i}},children:s})}w.memo(Lut);const Out={human:tn,director:zx,worker:Sl,steward:Al},ute={running:{bg:"bg-[var(--color-success-muted)]",text:"text-[var(--color-success-text)]",border:"border-[var(--color-success)]"},idle:{bg:"bg-[var(--color-surface-elevated)]",text:"text-[var(--color-text-secondary)]",border:"border-[var(--color-border)]"},suspended:{bg:"bg-[var(--color-warning-muted)]",text:"text-[var(--color-warning-text)]",border:"border-[var(--color-warning)]"},terminated:{bg:"bg-[var(--color-surface)]",text:"text-[var(--color-text-tertiary)]",border:"border-[var(--color-border-subtle)]"},starting:{bg:"bg-[var(--color-info-muted)]",text:"text-[var(--color-info-text)]",border:"border-[var(--color-info)]"}},Iut={healthy:{icon:zs,color:"text-[var(--color-success)]"},warning:{icon:Bn,color:"text-[var(--color-warning)]"},error:{icon:us,color:"text-[var(--color-error)]"}};function Rut({data:e,selected:t}){const{label:r,nodeType:n,agent:a,status:s="idle",currentTask:i,branch:l,healthIndicator:c}=e,u=Out[n]||tn,d=ute[s]||ute.idle,f=c?Iut[c]:null,m=f?.icon,p=n==="human",v=!!a;return o.jsxs("div",{className:`
        relative min-w-[180px] max-w-[220px] rounded-lg border-2 shadow-sm transition-all duration-200
        ${d.bg} ${d.border}
        ${t?"ring-2 ring-[var(--color-primary)] ring-offset-2 ring-offset-[var(--color-bg)]":""}
        ${v?"cursor-pointer hover:shadow-md hover:scale-[1.02]":""}
        ${p?"border-dashed":""}
      `,"data-testid":`graph-node-${a?.id||n}`,children:[!p&&o.jsx(Ug,{type:"target",position:zt.Top,className:"!bg-[var(--color-border)] !border-[var(--color-bg)] !w-3 !h-3","data-testid":`handle-target-${a?.id||n}`}),o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`
              p-1.5 rounded-md
              ${p?"bg-[var(--color-accent-muted)]":d.bg}
            `,children:o.jsx(u,{className:`w-4 h-4 ${p?"text-[var(--color-accent)]":d.text}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-semibold text-sm text-[var(--color-text)] truncate",title:r,children:r}),!p&&o.jsx("span",{className:`text-xs ${d.text} capitalize`,children:s})]}),m&&o.jsx(m,{className:`w-4 h-4 ${f?.color}`})]}),i&&o.jsx("div",{className:"mt-2 px-2 py-1 rounded bg-[var(--color-surface)] border border-[var(--color-border-subtle)]",children:o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] truncate",title:i.title,children:i.title})}),l&&o.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(cu,{className:"w-3 h-3"}),o.jsx("span",{className:"truncate font-mono",title:l,children:l})]}),v&&(s==="running"||s==="starting")&&o.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-[var(--color-primary)]",children:[o.jsx(na,{className:"w-3 h-3"}),o.jsx("span",{children:"Open in Workspace"})]}),s==="running"&&o.jsx("div",{className:"absolute top-2 right-2",children:o.jsx(nu,{className:"w-2 h-2 fill-[var(--color-success)] text-[var(--color-success)] animate-pulse"})})]}),(p||n==="director")&&o.jsx(Ug,{type:"source",position:zt.Bottom,className:"!bg-[var(--color-border)] !border-[var(--color-bg)] !w-3 !h-3","data-testid":`handle-source-${a?.id||n}`})]})}const Put=w.memo(Rut),zut={humanY:50,directorY:200,workerY:400,stewardY:400,nodeSpacing:200,centerX:400},But=[],$ut=new Map,Fut={};function Uut({director:e,workers:t,stewards:r,tasks:n,sessionStatuses:a,layout:s}){const i=n??But,l=a??$ut,c=s??Fut,u=w.useMemo(()=>({...zut,...c}),[c]);return w.useMemo(()=>{const d=[],f=[],m=new Map;for(const y of i)y.assignee&&(y.status==="in_progress"||y.status==="open")&&m.set(y.assignee,y);const p={id:"human",type:"agentNode",position:{x:u.centerX,y:u.humanY},data:{label:"Human",nodeType:"human"}};if(d.push(p),e){const y=l.get(e.id)||e.metadata?.agent?.sessionStatus||"idle",S={id:e.id,type:"agentNode",position:{x:u.centerX,y:u.directorY},data:{label:e.name,nodeType:"director",agent:e,status:y,currentTask:m.get(e.id)}};d.push(S),f.push({id:"human-director",source:"human",target:e.id,type:"smoothstep",animated:y==="running",style:{stroke:"var(--color-border)",strokeWidth:2},data:{relationship:"supervises"}})}const v=t.filter(y=>y.metadata?.agent?.workerMode==="persistent"),b=t.filter(y=>y.metadata?.agent?.workerMode==="ephemeral");return v.forEach((y,S)=>{const _=l.get(y.id)||y.metadata?.agent?.sessionStatus||"idle",N=y.metadata?.agent,k=u.centerX-300+S*u.nodeSpacing,j={id:y.id,type:"agentNode",position:{x:k,y:u.workerY},data:{label:y.name,nodeType:"worker",agent:y,status:_,currentTask:m.get(y.id),branch:N?.branch}};d.push(j),f.push({id:`human-${y.id}`,source:"human",target:y.id,type:"smoothstep",animated:_==="running",style:{stroke:"var(--color-border)",strokeWidth:2},data:{relationship:"supervises"}})}),e&&b.forEach((y,S)=>{const _=l.get(y.id)||y.metadata?.agent?.sessionStatus||"idle",N=y.metadata?.agent,k=(b.length-1)*u.nodeSpacing,E=u.centerX-k/2-100+S*u.nodeSpacing,T={id:y.id,type:"agentNode",position:{x:E,y:u.workerY},data:{label:y.name,nodeType:"worker",agent:y,status:_,currentTask:m.get(y.id),branch:N?.branch}};d.push(T),f.push({id:`${e.id}-${y.id}`,source:e.id,target:y.id,type:"smoothstep",animated:_==="running",style:{stroke:"var(--color-border)",strokeWidth:2},data:{relationship:"supervises"}})}),e&&r.forEach((y,S)=>{const _=l.get(y.id)||y.metadata?.agent?.sessionStatus||"idle";y.metadata?.agent;const N=(r.length-1)*u.nodeSpacing,j=u.centerX-N/2+100+S*u.nodeSpacing,E={id:y.id,type:"agentNode",position:{x:j,y:u.stewardY},data:{label:y.name,nodeType:"steward",agent:y,status:_,healthIndicator:void 0}};d.push(E),f.push({id:`${e.id}-${y.id}`,source:e.id,target:y.id,type:"smoothstep",animated:_==="running",style:{stroke:"var(--color-border)",strokeWidth:2,strokeDasharray:"5,5"},data:{relationship:"supervises"}})}),{nodes:d,edges:f}},[e,t,r,i,l,u])}const Hut=new Map,qut={agentNode:Put};function Wut(e){switch(e.data?.status){case"running":return"var(--color-success)";case"starting":return"var(--color-info)";case"suspended":return"var(--color-warning)";case"terminated":return"var(--color-text-tertiary)";default:return"var(--color-border)"}}function Kut({director:e,workers:t,stewards:r,tasks:n=[],sessionStatuses:a=Hut,isLoading:s=!1,error:i=null,onRefresh:l}){const c=Ma(),{nodes:u,edges:d}=Uut({director:e,workers:t,stewards:r,tasks:n,sessionStatuses:a}),f=w.useCallback((N,k)=>{const j=k.data?.agent;j&&c({to:"/workspaces",search:{layout:"single",agent:j.id,resumeSessionId:void 0,resumePrompt:void 0}})},[c]),[m,p,v]=aut(u),[b,y,S]=sut(d);w.useEffect(()=>{p(u),y(d)},[u,d]);const _=w.useMemo(()=>({padding:.2,maxZoom:1.5,minZoom:.5}),[]);return s?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-graph-loading",children:o.jsxs("div",{className:"flex flex-col items-center gap-3 text-[var(--color-text-secondary)]",children:[o.jsx(Pe,{className:"w-8 h-8 animate-spin"}),o.jsx("span",{children:"Loading agents..."})]})}):i?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-graph-error",children:o.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-error)]"}),o.jsx("p",{className:"text-[var(--color-text)]",children:"Failed to load agents"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-md",children:i.message}),l&&o.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-[var(--color-primary)] border border-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-muted)] transition-colors","data-testid":"agent-graph-retry",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]})}):!e&&t.length===0&&r.length===0?o.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-graph-empty",children:o.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[o.jsx("div",{className:"p-3 rounded-full bg-[var(--color-surface-elevated)]",children:o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-text-tertiary)]"})}),o.jsx("p",{className:"text-[var(--color-text)]",children:"No agents registered"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-md",children:"Register agents to see them visualized in the hierarchy graph."})]})}):o.jsx("div",{className:"w-full h-full min-h-[400px] bg-[var(--color-bg)]","data-testid":"agent-workspace-graph",children:o.jsxs(nut,{nodes:m,edges:b,onNodesChange:v,onEdgesChange:S,onNodeClick:f,nodeTypes:qut,fitView:!0,fitViewOptions:_,nodesDraggable:!0,nodesConnectable:!1,elementsSelectable:!0,zoomOnScroll:!0,panOnScroll:!0,panOnDrag:!0,attributionPosition:"bottom-left",className:"bg-[var(--color-bg)]",children:[o.jsx(uut,{gap:16,size:1,color:"var(--color-border-subtle)"}),o.jsx(vut,{showZoom:!0,showFitView:!0,showInteractive:!1,className:"!bg-[var(--color-surface)] !border-[var(--color-border)] !rounded-lg !shadow-sm"}),o.jsx(Tut,{nodeColor:Wut,maskColor:"rgba(0, 0, 0, 0.1)",className:"!bg-[var(--color-surface)] !border-[var(--color-border)] !rounded-lg",zoomable:!0,pannable:!0})]})})}function Gut(){const e=tl({from:"/agents"}),t=Ma(),r=e.tab||"agents",[n,a]=w.useState(""),[s,i]=w.useState(!1),[l,c]=w.useState(!1),[u,d]=w.useState(null);w.useEffect(()=>{e.action==="create"&&(i(!0),t({to:"/agents",search:{tab:e.tab??"agents",selected:e.selected,role:e.role},replace:!0}))},[e.action,e.tab,e.selected,e.role,t]);const[f,m]=w.useState(void 0),[p,v]=w.useState(void 0),[b,y]=w.useState(!1),[S,_]=w.useState(null),[N,k]=w.useState(!1),[j,E]=w.useState(null),[T,O]=w.useState(!1),[R,H]=w.useState(null),[$,L]=w.useState(new Set),[A,M]=w.useState(new Set),{director:P,ephemeralWorkers:I,persistentWorkers:B,stewards:F,workers:q,isLoading:Q,error:W,refetch:G}=g0(),{data:J,isLoading:X,refetch:V}=pZe(),se=J??[],de=Pme(),he=vZe(),{data:te}=S2({status:"all",limit:100}),le=te?.tasks??[],oe=y2(),Z=p1(),ve=ZQe(),{hasActiveSession:U}=mme(),{data:ge}=b2({status:"running"}),ue=ge?.sessions??[],re=w.useMemo(()=>{const Xe=new Map;P&&Xe.set(P.id,"idle");for(const nt of q)Xe.set(nt.id,"idle");for(const nt of F)Xe.set(nt.id,"idle");for(const nt of ue){const bt=nt.status==="terminating"?"terminated":nt.status;Xe.set(nt.agentId,bt)}return Xe},[P,q,F,ue]),ne=Xe=>{const nt=ue.find(bt=>bt.agentId===Xe);if(nt)return nt.status==="running"?"running":nt.status==="starting"?"starting":void 0},me=w.useMemo(()=>{const Xe=n.toLowerCase().trim();if(!Xe)return{director:P,ephemeralWorkers:I,persistentWorkers:B,stewards:F};const nt=bt=>bt.filter(Ct=>Ct.name.toLowerCase().includes(Xe));return{director:P?.name.toLowerCase().includes(Xe)?P:void 0,ephemeralWorkers:nt(I),persistentWorkers:nt(B),stewards:nt(F)}},[n,P,I,B,F]),ke=Xe=>{t({to:"/agents",search:{selected:e.selected,tab:Xe,role:e.role}})},we=async Xe=>{L(nt=>new Set(nt).add(Xe));try{await oe.mutateAsync({agentId:Xe})}finally{L(nt=>{const bt=new Set(nt);return bt.delete(Xe),bt})}},pe=Xe=>{H(Xe),O(!0)},Oe=()=>{O(!1),H(null)},Ae=async(Xe,nt,bt)=>{L(Ct=>new Set(Ct).add(Xe));try{await oe.mutateAsync({agentId:Xe,taskId:nt,initialMessage:bt})}finally{L(Ct=>{const fe=new Set(Ct);return fe.delete(Xe),fe})}},Re=async(Xe,nt,bt)=>{await Ae(Xe,nt,bt),t({to:"/workspaces",search:{layout:"single",agent:Xe,resumeSessionId:void 0,resumePrompt:void 0}})},Ve=Xe=>I.some(nt=>nt.id===Xe),gt=Xe=>{const nt=[...I,...B,P].find(bt=>bt?.id===Xe);nt&&(Ve(Xe)?pe({id:nt.id,name:nt.name}):we(Xe))},lt=async Xe=>{M(nt=>new Set(nt).add(Xe));try{await Z.mutateAsync({agentId:Xe,graceful:!0})}finally{M(nt=>{const bt=new Set(nt);return bt.delete(Xe),bt})}},Pt=Xe=>{t({to:"/workspaces",search:{layout:"single",agent:Xe,resumeSessionId:void 0,resumePrompt:void 0}})},fr=()=>{window.dispatchEvent(new CustomEvent("open-director-panel"))},Qe=(Xe,nt)=>{m(Xe),v(nt),i(!0)},Vt=()=>{i(!1),m(void 0),v(void 0)},at=Xe=>{_(Xe),y(!0)},Ne=()=>{y(!1),_(null)},Fe=Xe=>{E(Xe),k(!0)},Ke=()=>{k(!1),E(null)},Tt=async()=>{if(j)try{await ve.mutateAsync({agentId:j.id}),Ke()}catch{}},wt=(P?1:0)+I.length+B.length,Zt=F.length;return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"agents-page",children:[o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(ds,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]","data-testid":"agents-page-title",children:"Agents"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Manage your AI agents and stewards"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:"Search agents...",value:n,onChange:Xe=>a(Xe.target.value),className:"pl-9 pr-3 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent w-48 @md:w-64","data-testid":"agents-search"})]}),r==="pools"?o.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"pools-create",children:[o.jsx(dr,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Create Pool"})]}):o.jsxs("button",{onClick:()=>Qe(r==="stewards"?"steward":void 0),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"agents-create",children:[o.jsx(dr,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:r==="stewards"?"Create Steward":"Create Agent"}),o.jsx("kbd",{className:"hidden sm:inline ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(zl("action.createAgent"))})]})]})]}),o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("nav",{className:"flex gap-1","aria-label":"Tabs",children:[o.jsx("button",{onClick:()=>ke("agents"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="agents"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"agents-tab-agents",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(ds,{className:"w-4 h-4"}),"Agents",wt>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:wt})]})}),o.jsx("button",{onClick:()=>ke("stewards"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="stewards"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"agents-tab-stewards",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(Al,{className:"w-4 h-4"}),"Stewards",Zt>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:Zt})]})}),o.jsx("button",{onClick:()=>ke("pools"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="pools"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"agents-tab-pools",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(t_,{className:"w-4 h-4"}),"Pools",se.length>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:se.length})]})}),o.jsx("button",{onClick:()=>ke("graph"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="graph"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"agents-tab-graph",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(Rwe,{className:"w-4 h-4"}),"Graph"]})})]})}),r==="graph"?o.jsx("div",{className:"h-[600px] border border-[var(--color-border)] rounded-lg overflow-hidden",children:o.jsx(Kut,{director:P,workers:q,stewards:F,tasks:le,sessionStatuses:re,isLoading:Q,error:W,onRefresh:G})}):Q?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading agents..."})]}):W?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-danger)] rounded-lg bg-[var(--color-danger-muted)]",children:[o.jsx(Rt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"Failed to load agents"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:W.message}),o.jsxs("button",{onClick:()=>G(),className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-surface)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]}):r==="agents"?o.jsx(Vut,{director:me.director,directorHasActiveSession:U,onOpenDirectorPanel:fr,ephemeralWorkers:me.ephemeralWorkers,persistentWorkers:me.persistentWorkers,onStart:gt,onStop:lt,onOpenTerminal:Pt,onRename:at,onDelete:Fe,pendingStart:$,pendingStop:A,onCreateAgent:()=>Qe(),getActiveSessionStatus:ne}):r==="stewards"?o.jsx(Yut,{stewards:me.stewards,onStart:we,onStop:lt,onOpenTerminal:Pt,onRename:at,onDelete:Fe,pendingStart:$,pendingStop:A,onCreateSteward:()=>Qe("steward"),getActiveSessionStatus:ne}):r==="pools"?o.jsx(Qut,{pools:se,isLoading:X,onCreatePool:()=>c(!0),onEditPool:Xe=>d(Xe),onToggleEnabled:(Xe,nt)=>de.mutate({id:Xe,enabled:nt}),onDeletePool:Xe=>he.mutate({id:Xe}),isUpdating:de.isPending}):null,o.jsx(Jnt,{isOpen:s,onClose:Vt,initialRole:f,initialStewardFocus:p,hasDirector:!!P,onSuccess:()=>G()}),o.jsx(iat,{isOpen:l,onClose:()=>c(!1),onSuccess:()=>V()}),u&&o.jsx(oat,{isOpen:!!u,onClose:()=>d(null),pool:u,onSuccess:()=>{d(null),V()}}),S&&o.jsx(Xnt,{isOpen:b,onClose:Ne,agentId:S.id,currentName:S.name,onSuccess:()=>G()}),R&&o.jsx(eat,{isOpen:T,onClose:Oe,agent:R,onStart:Ae,onStartAndOpen:Re,isStarting:$.has(R.id)}),j&&o.jsx(Znt,{isOpen:N,onClose:Ke,agentName:j.name,onConfirm:Tt,isDeleting:ve.isPending})]})}function Vut({director:e,directorHasActiveSession:t,onOpenDirectorPanel:r,ephemeralWorkers:n,persistentWorkers:a,onStart:s,onStop:i,onOpenTerminal:l,onRename:c,onDelete:u,pendingStart:d,pendingStop:f,onCreateAgent:m,getActiveSessionStatus:p}){return e||n.length>0||a.length>0?o.jsxs("div",{className:"space-y-8",children:[e&&o.jsx(ey,{title:"Director",icon:zx,description:"Strategic agent that creates and assigns tasks",children:o.jsx(Pk,{agent:e,activeSessionStatus:t?"running":void 0,onStart:()=>s(e.id),onStop:()=>i(e.id),onOpenTerminal:r,onRename:()=>c({id:e.id,name:e.name}),onDelete:()=>u({id:e.id,name:e.name}),isStarting:d.has(e.id),isStopping:f.has(e.id)})}),a.length>0&&o.jsx(ey,{title:"Persistent Workers",icon:Zo,description:"Long-lived workers that handle multiple tasks",count:a.length,children:o.jsx("div",{className:"grid grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3 gap-4",children:a.map(b=>o.jsx(Pk,{agent:b,activeSessionStatus:p(b.id),onStart:()=>s(b.id),onStop:()=>i(b.id),onOpenTerminal:()=>l(b.id),onRename:()=>c({id:b.id,name:b.name}),onDelete:()=>u({id:b.id,name:b.name}),isStarting:d.has(b.id),isStopping:f.has(b.id)},b.id))})}),n.length>0&&o.jsx(ey,{title:"Ephemeral Workers",icon:Zo,description:"Short-lived workers spawned per task",count:n.length,children:o.jsx("div",{className:"grid grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3 gap-4",children:n.map(b=>o.jsx(Pk,{agent:b,activeSessionStatus:p(b.id),onStart:()=>s(b.id),onStop:()=>i(b.id),onOpenTerminal:()=>l(b.id),onRename:()=>c({id:b.id,name:b.name}),onDelete:()=>u({id:b.id,name:b.name}),isStarting:d.has(b.id),isStopping:f.has(b.id)},b.id))})})]}):o.jsx(c$,{icon:ds,title:"No agents yet",description:"Create your first agent to start orchestrating AI work. Agents can work on tasks autonomously in isolated git worktrees.",actionLabel:"Create Agent",actionTestId:"agents-create-empty",onAction:m})}function Yut({stewards:e,onStart:t,onStop:r,onOpenTerminal:n,onRename:a,onDelete:s,pendingStart:i,pendingStop:l,onCreateSteward:c,getActiveSessionStatus:u}){if(e.length===0)return o.jsx(c$,{icon:Al,title:"No stewards yet",description:"Create stewards to automate maintenance tasks like merging branches and scanning documentation.",actionLabel:"Create Steward",actionTestId:"stewards-create-empty",onAction:c});const d=e.reduce((m,p)=>{const v=p.metadata?.agent,b=v?.agentRole==="steward"?v?.stewardFocus:"merge";return m[b??"merge"]||(m[b??"merge"]=[]),m[b??"merge"].push(p),m},{}),f={merge:"Merge Stewards",docs:"Docs Stewards",custom:"Custom Stewards"};return o.jsx("div",{className:"space-y-8",children:Object.entries(d).map(([m,p])=>o.jsx(ey,{title:f[m]??m,icon:Al,count:p.length,children:o.jsx("div",{className:"grid grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3 gap-4",children:p.map(v=>o.jsx(Pk,{agent:v,activeSessionStatus:u(v.id),onStart:()=>t(v.id),onStop:()=>r(v.id),onOpenTerminal:()=>n(v.id),onRename:()=>a({id:v.id,name:v.name}),onDelete:()=>s({id:v.id,name:v.name}),isStarting:i.has(v.id),isStopping:l.has(v.id)},v.id))})},m))})}function Qut({pools:e,isLoading:t,onCreatePool:r,onEditPool:n,onToggleEnabled:a,onDeletePool:s,isUpdating:i}){return t?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading pools..."})]}):e.length===0?o.jsx(c$,{icon:t_,title:"No pools yet",description:"Create agent pools to control the maximum number of agents running concurrently. Pools help manage resource usage and agent scheduling.",actionLabel:"Create Pool",actionTestId:"pools-create-empty",onAction:r}):o.jsx("div",{className:"space-y-8",children:o.jsx(ey,{title:"Agent Pools",icon:t_,description:"Pools control how many agents can run concurrently",count:e.length,children:o.jsx("div",{className:"grid grid-cols-1 @md:grid-cols-2 @xl:grid-cols-3 gap-4",children:e.map(l=>o.jsx(tat,{pool:l,onEdit:()=>n(l),onToggleEnabled:c=>a(l.id,c),onDelete:()=>s(l.id),isUpdating:i},l.id))})})})}function ey({title:e,icon:t,description:r,count:n,children:a}){return o.jsxs("section",{"data-testid":`agent-section-${e.toLowerCase().replace(/\s+/g,"-")}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(t,{className:"w-5 h-5 text-[var(--color-text-secondary)]"}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:e}),n!==void 0&&o.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)] text-[var(--color-text-secondary)]",children:n})]}),r&&o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4",children:r}),a]})}function c$({icon:e,title:t,description:r,actionLabel:n,actionTestId:a,onAction:s}){return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(e,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:t}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:r}),o.jsxs("button",{onClick:s,className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":a,children:[o.jsx(dr,{className:"w-4 h-4"}),n]})]})}const O0e="stoneforge-workspace-layouts",I0e="stoneforge-active-workspace-layout",R0e="stoneforge-workspace-channel",Jut={id:"default",name:"Default",preset:"single",panes:[],gridOrientation:"horizontal",sectionLayout:"single-first",createdAt:Date.now(),modifiedAt:Date.now()};function dte(){return`pane-${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function Zut(){return`layout-${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function Xut(e){const t=e.metadata?.agent;return t&&(t.agentRole==="director"||t.agentRole==="worker"&&t.workerMode==="persistent")?"terminal":"stream"}function edt(){try{const e=localStorage.getItem(O0e);return e?JSON.parse(e):[]}catch{return[]}}function fte(e){try{localStorage.setItem(O0e,JSON.stringify(e))}catch{}}function tdt(){try{const e=localStorage.getItem(I0e);if(e){const t=JSON.parse(e);if(t.id&&t.panes&&Array.isArray(t.panes))return t}}catch{}return{...Jut}}function rdt(e){try{localStorage.setItem(I0e,JSON.stringify(e))}catch{}}function ndt(){const[e,t]=w.useState(()=>tdt()),[r,n]=w.useState(null),[a,s]=w.useState(null),[i,l]=w.useState(()=>edt()),c=a!==null;w.useEffect(()=>{rdt(e)},[e]),w.useEffect(()=>{const M=new BroadcastChannel(R0e),P=I=>{if(I.data.type==="pop-back-in"){const{pane:B}=I.data,F={id:dte(),...B,status:"disconnected",position:0,weight:1};t(q=>{const Q=[...q.panes,{...F,position:q.panes.length}];let W=q.preset;return Q.length===2&&q.preset==="single"?W="columns":Q.length>2&&q.preset!=="grid"&&q.preset!=="flex"&&q.preset!=="rows"&&q.preset!=="columns"&&(W="grid"),{...q,preset:W,panes:Q,modifiedAt:Date.now()}}),n(F.id)}};return M.addEventListener("message",P),()=>{M.removeEventListener("message",P),M.close()}},[]);const u=w.useCallback(M=>{const P={id:dte(),agentId:M.id,agentName:M.name,agentRole:M.metadata?.agent?.agentRole??"worker",workerMode:M.metadata?.agent?.agentRole==="worker"?M.metadata?.agent?.workerMode:void 0,paneType:Xut(M),status:"disconnected",position:0,weight:1};t(I=>{const B=[...I.panes,{...P,position:I.panes.length}];let F=I.preset;return B.length===2&&I.preset==="single"?F="columns":B.length>2&&I.preset!=="grid"&&I.preset!=="flex"&&I.preset!=="rows"&&I.preset!=="columns"&&(F="grid"),{...I,preset:F,panes:B,modifiedAt:Date.now()}}),n(P.id)},[]),d=w.useCallback(M=>{t(P=>{const B=P.panes.filter(q=>q.id!==M).map((q,Q)=>({...q,position:Q}));let F=P.preset;return B.length<=1?F="single":B.length===2&&P.preset==="grid"&&(F="columns"),{...P,preset:F,panes:B,modifiedAt:Date.now()}}),n(P=>P===M?null:P)},[]),f=w.useCallback((M,P)=>{t(I=>({...I,panes:I.panes.map(B=>B.id===M?{...B,status:P}:B)}))},[]),m=w.useCallback(M=>{t(P=>({...P,preset:M,modifiedAt:Date.now()}))},[]),p=w.useCallback((M,P)=>{t(I=>{const B=[...I.panes],[F]=B.splice(M,1);B.splice(P,0,F);const q=B.map((Q,W)=>({...Q,position:W}));return{...I,panes:q,modifiedAt:Date.now()}})},[]),v=w.useCallback((M,P)=>{t(I=>({...I,panes:I.panes.map(B=>B.id===M?{...B,weight:Math.max(.5,Math.min(2,P))}:B)}))},[]),b=w.useCallback(M=>{const P=e.panes.find(I=>I.id===M);P&&s({paneId:M,originalPosition:P.position,targetPosition:null})},[e.panes]),y=w.useCallback(M=>{s(P=>P?{...P,targetPosition:M}:null)},[]),S=w.useCallback(()=>{a&&a.targetPosition!==null&&a.targetPosition!==a.originalPosition&&p(a.originalPosition,a.targetPosition),s(null)},[a,p]),_=w.useCallback(()=>{s(null)},[]),N=w.useCallback((M,P)=>{t(I=>{const B=I.panes.findIndex(G=>G.id===M);if(B===-1)return I;const F=[...I.panes],[q]=F.splice(B,1),Q=Math.min(P,F.length);F.splice(Q,0,q);const W=F.map((G,J)=>({...G,position:J}));return{...I,panes:W,modifiedAt:Date.now()}})},[]),k=w.useCallback(M=>{const P={...e,id:Zut(),name:M,createdAt:Date.now(),modifiedAt:Date.now()},I=[...i,P];l(I),fte(I)},[e,i]),j=w.useCallback(M=>{t({...M,modifiedAt:Date.now()}),n(M.panes[0]?.id??null)},[]),E=w.useCallback(M=>{const P=i.filter(I=>I.id!==M);l(P),fte(P)},[i]),T=w.useCallback(()=>{t(M=>({...M,preset:"single",panes:[],modifiedAt:Date.now()})),n(null)},[]),O=w.useCallback((M,P)=>{t(I=>{const B=[...I.panes],F=B.findIndex(W=>W.id===M),q=B.findIndex(W=>W.id===P);if(F===-1||q===-1)return I;[B[F],B[q]]=[B[q],B[F]];const Q=B.map((W,G)=>({...W,position:G}));return{...I,panes:Q,modifiedAt:Date.now()}})},[]),R=w.useCallback(M=>{t(P=>{const I=P.panes.findIndex(q=>q.id===M);if(I<=0)return P;const B=[...P.panes];[B[I-1],B[I]]=[B[I],B[I-1]];const F=B.map((q,Q)=>({...q,position:Q}));return{...P,panes:F,modifiedAt:Date.now()}})},[]),H=w.useCallback(M=>{t(P=>{const I=P.panes.findIndex(q=>q.id===M);if(I===-1||I>=P.panes.length-1)return P;const B=[...P.panes];[B[I],B[I+1]]=[B[I+1],B[I]];const F=B.map((q,Q)=>({...q,position:Q}));return{...P,panes:F,modifiedAt:Date.now()}})},[]),$=w.useCallback(()=>{t(M=>{const P=M.panes.length;if(M.preset!=="grid"||P<3)return M;const B=(M.gridOrientation||"horizontal")==="horizontal"?"vertical":"horizontal";return{...M,gridOrientation:B,modifiedAt:Date.now()}})},[]),L=w.useCallback(()=>{t(M=>{const P=M.panes.length;if(M.preset!=="grid"||P<3)return M;if(P===3){const I=M.sectionLayout||"single-first",B=I==="single-first"?"single-last":"single-first",F=[...M.panes];if(I==="single-first"){const Q=F.shift();F.push(Q)}else{const Q=F.pop();F.unshift(Q)}const q=F.map((Q,W)=>({...Q,position:W}));return{...M,panes:q,sectionLayout:B,modifiedAt:Date.now()}}if(P===4){const I=M.gridOrientation||"horizontal",B=[...M.panes];I==="horizontal"?([B[0],B[1]]=[B[1],B[0]],[B[2],B[3]]=[B[3],B[2]]):([B[0],B[2]]=[B[2],B[0]],[B[1],B[3]]=[B[3],B[1]]);const F=B.map((q,Q)=>({...q,position:Q}));return{...M,panes:F,modifiedAt:Date.now()}}return M})},[]),A=w.useCallback(()=>{t(M=>{if(M.panes.length!==4)return M;const I=[...M.panes];[I[0],I[2]]=[I[2],I[0]],[I[1],I[3]]=[I[3],I[1]];const B=I.map((F,q)=>({...F,position:q}));return{...M,panes:B,modifiedAt:Date.now()}})},[]);return{layout:e,activePane:r,isDragging:c,dragState:a,savedLayouts:i,hasPanes:e.panes.length>0,paneCount:e.panes.length,addPane:u,removePane:d,setActivePane:n,updatePaneStatus:f,setLayoutPreset:m,reorderPanes:p,setPaneWeight:v,saveLayout:k,loadLayout:j,deleteLayout:E,clearPanes:T,startDrag:b,updateDragTarget:y,endDrag:S,cancelDrag:_,movePaneToPosition:N,swapPanes:O,movePaneUp:R,movePaneDown:H,rotateLayout:$,swapGridSections:L,swap2x2Rows:A}}function P0e({isConnected:e,onSend:t,connectedPlaceholder:r="Type a message...",disconnectedPlaceholder:n="Connect to send messages","data-testid":a="terminal-input"}){const[s,i]=w.useState(""),[l,c]=w.useState(!1),u=w.useRef(null),d=w.useCallback(()=>{const p=u.current;if(!p)return;p.style.height="auto";const v=200;p.style.height=`${Math.min(p.scrollHeight,v)}px`},[]);w.useEffect(()=>{d()},[s,d]);const f=w.useCallback(async()=>{if(!s.trim()||l||!e)return;const p=s.trim();c(!0),i("");try{await t(p)}catch(v){console.error("[TerminalInput] Error sending message:",v),i(p)}finally{c(!1)}},[s,l,e,t]),m=w.useCallback(p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),f())},[f]);return o.jsxs("div",{className:`
        flex items-end gap-2 p-3
        border-t border-[var(--color-border)]
        bg-[var(--color-surface)]
      `,"data-testid":a,children:[o.jsx("textarea",{ref:u,value:s,onChange:p=>i(p.target.value),onKeyDown:m,placeholder:e?r:n,disabled:!e||l,rows:1,className:`
          flex-1 px-3 py-2
          text-sm
          bg-[var(--color-bg)]
          border border-[var(--color-border)]
          rounded-md
          placeholder:text-[var(--color-text-tertiary)]
          focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)]
          disabled:opacity-50 disabled:cursor-not-allowed
          resize-none
          overflow-y-auto
        `,style:{minHeight:"38px"},"data-testid":`${a}-field`}),o.jsx("button",{onClick:f,disabled:!s.trim()||!e||l,className:`
          p-2 rounded-md
          text-white bg-[var(--color-primary)]
          hover:bg-[var(--color-primary-hover)]
          disabled:opacity-50 disabled:cursor-not-allowed
          transition-colors
          flex-shrink-0
        `,title:"Send message (Enter)","data-testid":`${a}-send-btn`,children:o.jsx(XC,{className:"w-4 h-4"})})]})}const adt=180*1e3,hte="/api/agents",sdt=window.location.origin,i5={assistant:{bg:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-700 dark:text-blue-300",border:"border-blue-200 dark:border-blue-800"},tool_use:{bg:"bg-amber-50 dark:bg-amber-900/20",text:"text-amber-700 dark:text-amber-300",border:"border-amber-200 dark:border-amber-800"},tool_result:{bg:"bg-green-50 dark:bg-green-900/20",text:"text-green-700 dark:text-green-300",border:"border-green-200 dark:border-green-800"},user:{bg:"bg-purple-50 dark:bg-purple-900/20",text:"text-purple-700 dark:text-purple-300",border:"border-purple-200 dark:border-purple-800"},system:{bg:"bg-gray-50 dark:bg-gray-800/50",text:"text-gray-600 dark:text-gray-400",border:"border-gray-200 dark:border-gray-700"},error:{bg:"bg-red-50 dark:bg-red-900/20",text:"text-red-700 dark:text-red-300",border:"border-red-200 dark:border-red-800"},result:{bg:"bg-cyan-50 dark:bg-cyan-900/20",text:"text-cyan-700 dark:text-cyan-300",border:"border-cyan-200 dark:border-cyan-800"}},idt={assistant:Vr,tool_use:Zo,tool_result:Zo,user:tn,system:YC,error:Rt,result:zs};function odt(e){return e.content!=null||e.toolInput!=null||e.toolOutput!=null}function z0e({event:e,isLast:t}){const r=e.type==="tool_use"||e.type==="tool_result",[n,a]=w.useState(!r),s=i5[e.type]||i5.system,i=idt[e.type]||YC,l=new Date(e.timestamp).toLocaleTimeString();return o.jsxs("div",{className:`
        mb-1 rounded border overflow-hidden
        ${s.bg} ${s.border}
        ${t?"animate-fade-in":""}
      `,"data-testid":`stream-event-${e.id}`,children:[o.jsxs("div",{className:`
          flex items-center gap-1.5 px-2 py-1 cursor-pointer
          ${s.text}
        `,onClick:()=>a(!n),children:[e.content||e.toolInput||e.toolOutput?n?o.jsx(Yt,{className:"w-3 h-3 flex-shrink-0"}):o.jsx(gn,{className:"w-3 h-3 flex-shrink-0"}):o.jsx("div",{className:"w-3 h-3 flex-shrink-0"}),o.jsx(i,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide flex-shrink-0",children:e.type.replace("_"," ")}),e.toolName&&o.jsx("span",{className:"text-[10px] font-mono opacity-75 truncate",children:e.toolName}),o.jsx("span",{className:"ml-auto text-[10px] opacity-50 flex-shrink-0",children:l})]}),n&&odt(e)&&o.jsxs("div",{className:"px-2 py-1.5 border-t border-[var(--color-border)]/30",children:[e.content!=null&&e.content!==""&&(e.type==="assistant"||e.type==="user"?o.jsx(C2,{content:e.content,className:"text-xs text-[var(--color-text)]"}):o.jsx("div",{className:"text-xs whitespace-pre-wrap break-words text-[var(--color-text)]",children:e.content})),e.toolInput!=null&&o.jsxs("div",{className:"mt-1.5",children:[o.jsx("div",{className:"text-[10px] font-medium text-[var(--color-text-secondary)] mb-0.5",children:"Input:"}),o.jsx("pre",{className:`
                text-[10px] font-mono p-1.5 rounded
                bg-[var(--color-bg-secondary)]
                text-[var(--color-text-secondary)]
                overflow-x-auto
              `,children:typeof e.toolInput=="string"?e.toolInput:String(JSON.stringify(e.toolInput,null,2))})]}),e.toolOutput&&o.jsxs("div",{className:"mt-1.5",children:[o.jsx("div",{className:"text-[10px] font-medium text-[var(--color-text-secondary)] mb-0.5",children:"Output:"}),o.jsx("pre",{className:`
                text-[10px] font-mono p-1.5 rounded
                bg-[var(--color-bg-secondary)]
                text-[var(--color-text-secondary)]
                overflow-x-auto max-h-36 overflow-y-auto
              `,children:e.toolOutput})]})]})]})}function ldt(e){const t=[];let r=[];const n=()=>{r.length>0&&(r.length===1?t.push({type:"single",event:r[0]}):t.push({type:"tool-group",events:[...r]}),r=[])};for(const a of e)a.type==="tool_use"||a.type==="tool_result"?r.push(a):(n(),t.push({type:"single",event:a}));return n(),t}function cdt({events:e,isLast:t}){const[r,n]=w.useState(!1),a=i5.tool_use,s=e.filter(u=>u.type==="tool_use").length,i=e.filter(u=>u.type==="tool_result").length,l=[...new Set(e.filter(u=>u.toolName).map(u=>u.toolName))],c=l.length>3?`${l.slice(0,3).join(", ")}...`:l.join(", ");return o.jsxs("div",{className:`
        mb-1 rounded border overflow-hidden
        ${a.bg} ${a.border}
        ${t?"animate-fade-in":""}
      `,"data-testid":"tool-call-group",children:[o.jsxs("div",{className:`
          flex items-center gap-1.5 px-2 py-1 cursor-pointer
          ${a.text}
        `,onClick:()=>n(!r),children:[r?o.jsx(Yt,{className:"w-3 h-3 flex-shrink-0"}):o.jsx(gn,{className:"w-3 h-3 flex-shrink-0"}),o.jsx(Zo,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsxs("span",{className:"text-[10px] font-semibold uppercase tracking-wide flex-shrink-0",children:[s," tool call",s!==1?"s":""]}),c&&o.jsxs("span",{className:"text-[10px] font-mono opacity-75 truncate",children:["(",c,")"]}),i>0&&o.jsxs("span",{className:"text-[10px] opacity-60 flex-shrink-0",children:[" ",i," result",i!==1?"s":""]})]}),r&&o.jsx("div",{className:"px-1.5 py-1 border-t border-[var(--color-border)]/30 space-y-1",children:e.map((u,d)=>o.jsx(z0e,{event:u,isLast:t&&d===e.length-1},u.id))})]})}function B0e({agentId:e,agentName:t,sessionId:r,providerSessionId:n,hasActiveSession:a=!1,onResumeWithMessage:s,apiUrl:i=sdt,onStatusChange:l,enableFileDrop:c=!0,"data-testid":u="stream-viewer"}){const[d,f]=w.useState([]),[m,p]=w.useState("disconnected"),[v,b]=w.useState(!1),[y,S]=w.useState(!1),[_,N]=w.useState(!1),k=w.useRef(null),j=w.useRef(!0),E=w.useRef(null),T=w.useRef(null),O=w.useRef(0),R=5,H=w.useRef(!1),$=w.useRef(0),L=w.useRef(null),A=w.useRef(void 0);w.useEffect(()=>{r&&A.current&&r!==A.current&&(f([]),N(!1)),A.current=r},[r]),w.useEffect(()=>{j.current=!0},[r]),w.useEffect(()=>{if(!r)return;(async()=>{try{const V=await fetch(`/api/sessions/${r}/messages`);if(!V.ok){console.warn("[StreamViewer] Failed to fetch session messages:",V.status);return}const de=(await V.json()).messages||[];if(de.length>0){const he=oe=>{if(oe)try{return JSON.parse(oe)}catch{return oe}},te=de.map(oe=>({id:oe.id,type:oe.type,timestamp:new Date(oe.createdAt).getTime(),content:oe.content,toolName:oe.toolName,toolInput:he(oe.toolInput),toolOutput:oe.toolOutput,isError:oe.isError}));f(oe=>{if(oe.length===0)return te;const Z=new Set(te.map(U=>U.id)),ve=oe.filter(U=>!Z.has(U.id));return[...te,...ve]});const le=te.filter(oe=>oe.type==="user"||oe.type==="assistant"||oe.type==="result"||oe.type==="error");if(le.length>0){const oe=le[le.length-1],Z=oe.type==="assistant"||oe.type==="result"||oe.type==="error";N(!Z)}}}catch(V){console.error("[StreamViewer] Error loading session messages:",V)}})()},[r]);const M=w.useCallback(X=>{p(X),l?.(X)},[l]),P=w.useCallback(X=>{$.current=Date.now(),L.current&&(clearTimeout(L.current),L.current=null),(X??_)&&(L.current=setTimeout(()=>{N(!1)},adt))},[_]),I=w.useCallback(()=>{if(!k.current)return;const{scrollTop:X,scrollHeight:V,clientHeight:se}=k.current,de=V-X-se<80;j.current=de},[]);w.useEffect(()=>()=>{L.current&&clearTimeout(L.current)},[]),w.useEffect(()=>{k.current&&j.current&&(k.current.scrollTop=k.current.scrollHeight)},[d]),w.useEffect(()=>{if(!e){M("disconnected");return}if(!a){M("disconnected");return}O.current=0,N(!1);const X=()=>{M("connecting");const V=`${hte}/${e}/stream`;console.log("[StreamViewer] Connecting to SSE:",V,"sessionId:",r);const se=new EventSource(V);T.current=se;const de=()=>{console.log("[StreamViewer] ReadyState:",["CONNECTING","OPEN","CLOSED"][se.readyState]||se.readyState)};se.onopen=()=>{console.log("[StreamViewer] Connection opened"),de(),O.current=0,M("connected")};const he=le=>{if(le!=null){if(typeof le=="string")return le;if(Array.isArray(le)){const oe=le.filter(Z=>typeof Z=="object"&&Z!==null&&Z.type==="text"&&typeof Z.text=="string").map(Z=>Z.text);return oe.length>0?oe.join(`
`):void 0}if(typeof le=="object"&&"content"in le)return he(le.content);if(typeof le=="object"&&"text"in le&&typeof le.text=="string")return le.text;if(typeof le=="object")try{const oe=JSON.stringify(le,null,2);return oe.length>500?oe.slice(0,500)+"...":oe}catch{return"[Object]"}return String(le)}},te=le=>{try{const oe=JSON.parse(le.data),Z=oe.event||oe;let ve=Z.type?.replace("agent_","")||"system";if(ve==="result"){N(!1),P(!1);return}if(ve==="system")return;let U=Z.tool?.name||Z.data?.name||Z.toolName||Z.raw?.tool,ge=Z.tool?.input||Z.data?.input||Z.toolInput||Z.raw?.tool_input,ue;const re=Z.raw?.message?.content||Z.raw?.content||Z.message?.content||Z.content;if(Array.isArray(re))for(const pe of re)typeof pe=="object"&&pe!==null&&"type"in pe&&(pe.type==="tool_use"&&pe.name?(U=U||pe.name,ge=ge||pe.input,ve==="assistant"&&(ve="tool_use")):pe.type==="tool_result"&&(ue=typeof pe.content=="string"?pe.content:void 0,ve==="user"&&(ve="tool_result")));const ne=Z.message||(typeof Z.content=="string"?Z.content:void 0)||Z.raw?.message||(typeof Z.raw?.content=="string"?Z.raw?.content:void 0)||Z.raw?.result||Z.data?.content,me=he(ne);ue||(ue=Z.output||Z.data?.output||(ve==="tool_result"&&typeof Z.raw?.content=="string"?Z.raw?.content:void 0));const ke=ve==="tool_result"&&ue?void 0:me,we={id:Z.msgId||le.lastEventId||`event-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,type:ve,timestamp:Date.now(),content:ke,toolName:U,toolInput:ge,toolOutput:ue,isError:ve==="error"};f(pe=>pe.some(Oe=>Oe.id===we.id)?pe:[...pe.slice(-200),we]),P(),ve==="user"&&(N(!0),P(!0))}catch(oe){console.error("[StreamViewer] Error parsing event:",oe)}};se.addEventListener("connected",le=>{console.log('[StreamViewer] Received "connected" event:',le)}),se.addEventListener("heartbeat",()=>{console.log("[StreamViewer] Received heartbeat")}),se.addEventListener("agent_system",te),se.addEventListener("agent_assistant",te),se.addEventListener("agent_user",te),se.addEventListener("agent_tool_use",te),se.addEventListener("agent_tool_result",te),se.addEventListener("agent_error",te),se.addEventListener("agent_result",te),se.addEventListener("agent_exit",le=>{try{const oe=JSON.parse(le.data),Z=oe.code===0?"The agent has stopped the session":`The agent session ended unexpectedly (exit code ${oe.code})${oe.signal?` (signal: ${oe.signal})`:""}`,ve={id:`exit-${Date.now()}`,type:"system",timestamp:Date.now(),content:Z};f(U=>[...U,ve])}catch(oe){console.error("[StreamViewer] Error parsing exit event:",oe)}}),se.onmessage=le=>{try{const oe=JSON.parse(le.data);if(oe.type==="connected"||oe.type==="heartbeat")return;te(le)}catch(oe){console.error("[StreamViewer] Error parsing message:",oe)}},se.onerror=le=>{if(console.log("[StreamViewer] SSE error:",le),console.log("[StreamViewer] ReadyState on error:",se.readyState),H.current){H.current=!1;return}if(M("error"),se.close(),O.current<R){O.current++;const oe=Math.min(1e3*Math.pow(2,O.current),3e4);console.log(`[StreamViewer] Reconnecting in ${oe}ms (attempt ${O.current}/${R})`),setTimeout(X,oe)}else console.log("[StreamViewer] Max reconnect attempts reached")}};return H.current=!1,X(),()=>{if(T.current){H.current=!0;const V=T.current;V.onopen=null,V.onmessage=null,V.onerror=null,V.close(),T.current=null}}},[e,r,a,M]);const B=w.useCallback(async X=>{try{if(!a&&n&&s){N(!0),P(!0),await s(n,X);return}const V={id:`user-${Date.now()}`,type:"user",timestamp:Date.now(),content:X};f(de=>[...de,V]);const se=await fetch(`${hte}/${e}/input`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:X,isUserMessage:!0})});if(!se.ok)throw new Error(`HTTP ${se.status}`);N(!0),P(!0)}catch(V){console.error("[StreamViewer] Error sending input:",V);const se={id:`error-${Date.now()}`,type:"error",timestamp:Date.now(),content:`Failed to send message: ${V instanceof Error?V.message:"Unknown error"}`,isError:!0};throw f(de=>[...de,se]),N(!1),V}},[e,a,n,s,P]),F=w.useCallback(async X=>{try{const V=await X.arrayBuffer(),se=btoa(new Uint8Array(V).reduce((te,le)=>te+String.fromCharCode(le),"")),de=await fetch(`${i}/api/terminal/upload`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:X.name,data:se})});if(!de.ok){const te=await de.json().catch(()=>({}));throw new Error(te.error?.message||`Upload failed: ${de.status}`)}return(await de.json()).path}catch(V){console.error("[StreamViewer] File upload failed:",V);const se={id:`error-${Date.now()}`,type:"error",timestamp:Date.now(),content:`File upload failed: ${V instanceof Error?V.message:"Unknown error"}`,isError:!0};return f(de=>[...de,se]),null}},[i]),q=w.useCallback(X=>Array.from(X.dataTransfer.types).includes("application/x-workspace-pane"),[]),Q=w.useCallback(async X=>{if(q(X)||(X.preventDefault(),X.stopPropagation(),b(!1),!c||m!=="connected"))return;const V=Array.from(X.dataTransfer.files);if(V.length===0)return;S(!0);const se={id:`system-${Date.now()}`,type:"system",timestamp:Date.now(),content:`Uploading ${V.length} file(s)...`};f(he=>[...he,se]);const de=[];for(const he of V){const te=await F(he);te&&de.push(te)}if(S(!1),de.length>0){const he=de.join(" "),te={id:`system-${Date.now()+1}`,type:"system",timestamp:Date.now(),content:`${de.length} file(s) uploaded:
${he}`};f(le=>[...le,te]),await B(he)}},[c,m,F,B,q]),W=w.useCallback(X=>{if(q(X)){X.preventDefault();return}X.preventDefault(),X.stopPropagation(),c&&m==="connected"&&b(!0)},[c,m,q]),G=w.useCallback(X=>{if(q(X)){X.preventDefault();return}X.preventDefault(),X.stopPropagation(),c&&m==="connected"&&b(!0)},[c,m,q]),J=w.useCallback(X=>{if(q(X))return;X.preventDefault(),X.stopPropagation();const V=E.current?.getBoundingClientRect();if(V){const{clientX:se,clientY:de}=X;(se<V.left||se>=V.right||de<V.top||de>=V.bottom)&&b(!1)}},[q]);return o.jsxs("div",{ref:E,className:"relative flex flex-col h-full bg-[var(--color-bg-secondary)]","data-testid":u,"data-status":m,"data-drag-over":v,onDrop:Q,onDragOver:W,onDragEnter:G,onDragLeave:J,children:[v&&c&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-primary)]/20 border-2 border-dashed border-[var(--color-primary)] rounded-lg pointer-events-none","data-testid":"file-drop-overlay",children:o.jsxs("div",{className:"flex flex-col items-center gap-2 p-4 rounded-lg bg-[var(--color-bg)]/90 shadow-lg",children:[o.jsx("svg",{className:"w-10 h-10 text-[var(--color-primary)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)]",children:"Drop files to upload"}),o.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"File paths will be added to input"})]})}),y&&o.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-[var(--color-bg)]/50 pointer-events-none","data-testid":"upload-progress-overlay",children:o.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-[var(--color-bg)] shadow-lg border border-[var(--color-border)]",children:[o.jsxs("svg",{className:"w-5 h-5 text-[var(--color-primary)] animate-spin",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm text-[var(--color-text)]",children:"Uploading..."})]})}),o.jsx("div",{ref:k,className:"flex-1 overflow-y-auto p-3 space-y-1",onScroll:I,"data-testid":"stream-events",children:d.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-[var(--color-text-tertiary)]",children:[o.jsx(Vr,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:m==="connected"?`Waiting for output from ${t}...`:m==="connecting"?"Connecting...":"Not connected"})]}):o.jsxs(o.Fragment,{children:[ldt(d).map((X,V,se)=>{const de=V===se.length-1&&!_;return X.type==="tool-group"?o.jsx(cdt,{events:X.events,isLast:de},`group-${X.events[0].id}`):o.jsx(z0e,{event:X.event,isLast:de},X.event.id)}),_&&m==="connected"&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-[var(--color-text-secondary)] animate-fade-in","data-testid":"working-indicator",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm",children:"Agent is working..."})]})]})}),o.jsx(P0e,{isConnected:m==="connected"||!a&&!!n&&!!s,onSend:B,connectedPlaceholder:a?void 0:"Send a message to resume this session...","data-testid":"stream-input"})]})}const $0e="stoneforge-session-transcript-";function udt(e){try{const t=localStorage.getItem(`${$0e}${e}`);if(t)return JSON.parse(t)}catch(t){console.error("[SessionHistory] Failed to load transcript:",t)}return[]}function ddt(e){try{localStorage.removeItem(`${$0e}${e}`)}catch(t){console.error("[SessionHistory] Failed to clear transcript:",t)}}function fdt(e){if(!e)return"Unknown";const t=new Date(e),r=new Date,n=t.toDateString()===r.toDateString(),a=new Date(r.getTime()-864e5).toDateString()===t.toDateString();return n?`Today ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:a?`Yesterday ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:t.toLocaleDateString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function hdt(e){const t=e.match(/\*\*Title\*\*:\s*(.+?)(?:\n|$)/);if(t?.[1])return t[1].trim();const r=e.match(/Title:\s*(.+?)(?:\n|$)/);return r?.[1]?r[1].trim():null}function mdt(e){const t=e.match(/\*\*Task ID\*\*:\s*(.+?)(?:\n|$)/);if(t?.[1])return t[1].trim();const r=e.match(/Task ID:\s*(.+?)(?:\n|$)/);return r?.[1]?r[1].trim():null}function GL(e){if(e.content?.trim()){const t=e.content.trim();if(t.includes("You have been assigned the following task")){const r=hdt(t);if(r)return r}return t}if(e.type==="tool_use"&&e.toolInput){const t=typeof e.toolInput=="string"?e.toolInput:JSON.stringify(e.toolInput);if(t.trim())return t.trim()}if(e.type==="tool_result"&&e.toolOutput?.trim())return e.toolOutput.trim()}function F0e(e,t){if(e.worktree){const l=e.worktree.split("/"),c=l[l.length-1];if(c&&!c.startsWith("worktree-"))return c.replace(/-/g," ")}const r=t.find(l=>l.type==="user"),n=r?GL(r):void 0;if(n)return n.length>100?n.slice(0,100)+"...":n;const a=t.find(l=>l.type==="assistant"),s=a?GL(a):void 0;if(s){const l=s.split(`
`)[0].split(".")[0];if(l.length>100)return l.slice(0,100)+"...";if(l.length>0)return l}for(const l of t){if(l.type==="system"||l.type==="error")continue;const c=GL(l);if(c){const u=c.split(`
`)[0];if(u.length>100)return u.slice(0,100)+"...";if(u.length>0)return u}}return`Session from ${new Date(e.startedAt||e.createdAt).toLocaleDateString([],{month:"short",day:"numeric"})}`}function pdt({session:e,transcript:t,isSelected:r,onClick:n,onDelete:a,onOpen:s}){const[i,l]=w.useState(!1),c=F0e(e,t),u=fdt(e.startedAt||e.createdAt),d=w.useMemo(()=>{const v=t.find(b=>b.type==="user"&&b.content);return v?.content?.includes("You have been assigned the following task")?mdt(v.content):null},[t]),f=v=>{v.stopPropagation(),l(!0)},m=v=>{v.stopPropagation(),a(),l(!1)},p=v=>{v.stopPropagation(),l(!1)};return o.jsxs("div",{className:`
        group flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-colors
        ${r?"bg-[var(--color-primary)]/10 border border-[var(--color-primary)]/30":"hover:bg-[var(--color-surface-hover)] border border-transparent"}
      `,onClick:n,"data-testid":`session-item-${e.id}`,children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(oi,{className:`w-4 h-4 ${r?"text-[var(--color-primary)]":"text-[var(--color-text-muted)]"}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:`text-sm font-medium truncate ${r?"text-[var(--color-primary)]":"text-[var(--color-text)]"}`,children:c}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-muted)]",children:[o.jsx(Rr,{className:"w-3 h-3"}),o.jsx("span",{children:u}),d&&o.jsx("span",{className:"px-1.5 py-0.5 rounded bg-[var(--color-primary)]/10 text-[var(--color-primary)] text-[10px] font-mono",children:d})]})]}),o.jsx("div",{className:"flex items-center gap-1",children:i?o.jsxs("div",{className:"flex items-center gap-1",onClick:v=>v.stopPropagation(),children:[o.jsx("button",{onClick:m,className:"px-2 py-0.5 text-xs rounded bg-red-500 text-white hover:bg-red-600 transition-colors",children:"Delete"}),o.jsx("button",{onClick:p,className:"px-2 py-0.5 text-xs rounded bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:bg-[var(--color-border)] transition-colors",children:"Cancel"})]}):o.jsxs(o.Fragment,{children:[s&&o.jsx("button",{onClick:v=>{v.stopPropagation(),s()},className:"p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity text-[var(--color-text-muted)] hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",title:"Open session",children:o.jsx(du,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:f,className:"p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity text-[var(--color-text-muted)] hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",title:"Delete transcript",children:o.jsx(pr,{className:"w-3.5 h-3.5"})}),o.jsx(gn,{className:`w-4 h-4 ${r?"text-[var(--color-primary)]":"text-[var(--color-text-muted)]"}`})]})})]})}function gdt({isOpen:e,onClose:t,agentName:r,sessions:n,onViewSession:a}){const[s,i]=w.useState(null),[l,c]=w.useState({}),[u,d]=w.useState(!1);w.useEffect(()=>{if(!e)return;let b=!1;d(!0);async function y(){const S={};await Promise.all(n.map(async _=>{try{const N=await hme(_.id);if(!b&&N.messages&&N.messages.length>0){S[_.id]=N.messages.map(tpe);return}}catch(N){console.debug("[SessionHistory] Server fetch failed, trying localStorage:",N)}b||(S[_.id]=udt(_.id))})),b||(c(S),i(null),d(!1))}return y(),()=>{b=!0}},[e,n]);const f=w.useMemo(()=>{const b=n.filter(S=>(l[S.id]?.length||0)>0),y=new Map;for(const S of b){const _=S.providerSessionId||S.id,N=y.get(_);if(!N)y.set(_,S);else{const k=N.startedAt||N.createdAt,j=S.startedAt||S.createdAt,E=typeof k=="number"?k:new Date(k).getTime();(typeof j=="number"?j:new Date(j).getTime())>E&&y.set(_,S)}}return Array.from(y.values())},[n,l]),m=w.useMemo(()=>s?l[s]||[]:[],[s,l]),p=b=>{ddt(b),c(y=>({...y,[b]:[]})),b===s&&i(null)};if(!e)return null;const v=s!==null;return o.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-4","data-testid":"session-history-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),o.jsxs("div",{className:"relative w-full max-w-3xl h-[70%] max-h-[500px] bg-[var(--color-bg)] rounded-xl shadow-2xl border border-[var(--color-border)] flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(eh,{className:"w-5 h-5 text-[var(--color-primary)]"}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Session History"}),o.jsxs("span",{className:"text-sm text-[var(--color-text-muted)]",children:[" ",r]})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded-lg text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"session-history-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"flex-1 flex min-h-0",children:u?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-[var(--color-text-muted)] p-6",children:[o.jsx(eh,{className:"w-12 h-12 mb-3 opacity-50 animate-pulse"}),o.jsx("p",{className:"text-sm",children:"Loading session history..."})]}):f.length===0?o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-[var(--color-text-muted)] p-6",children:[o.jsx(eh,{className:"w-12 h-12 mb-3 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No session history available"}),o.jsx("p",{className:"text-xs mt-1",children:"Sessions will appear here after you start using this agent"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`${v?"w-72 border-r border-[var(--color-border)]":"flex-1"} overflow-y-auto p-2 flex-shrink-0`,children:f.map(b=>o.jsx(pdt,{session:b,transcript:l[b.id]||[],isSelected:b.id===s,onClick:()=>i(b.id),onDelete:()=>p(b.id),onOpen:a?()=>a(b.id,b.providerSessionId):void 0},b.id))}),v&&(()=>{const b=f.find(y=>y.id===s);return o.jsxs("div",{className:"flex-1 min-w-0 bg-[var(--color-bg-secondary)] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface)]",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:F0e(b,m)}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a&&o.jsxs("button",{onClick:()=>{a(b.id,b.providerSessionId),t()},className:"flex items-center gap-1.5 px-2.5 py-1 rounded text-sm font-medium bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Open this session (send a message to resume)",children:[o.jsx(du,{className:"w-3.5 h-3.5"}),"Open"]}),o.jsx("button",{onClick:()=>i(null),className:"p-1 rounded text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",title:"Close transcript",children:o.jsx(yt,{className:"w-4 h-4"})})]})]}),o.jsx("div",{className:"flex-1 min-h-0",children:o.jsx(rpe,{events:m})})]})})()]})})]})]})}const mte={disconnected:"bg-gray-400",connecting:"bg-yellow-500 animate-pulse",connected:"bg-green-500",error:"bg-red-500"},pte={disconnected:"Disconnected",connecting:"Connecting...",connected:"Connected",error:"Error"},gte={director:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",icon:na},worker:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",icon:na},steward:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",icon:r0}},vdt=w.forwardRef(function({pane:t,isActive:r,isMaximized:n,isSingleMode:a=!1,draggable:s=!1,onClose:i,onMaximize:l,onMinimize:c,onFocus:u,onStatusChange:d,onDragStart:f,onDragEnd:m},p){const[v,b]=w.useState(!1),[y,S]=w.useState(!1),[_,N]=w.useState(!1),[k,j]=w.useState(!1),[E,T]=w.useState(void 0),[O,R]=w.useState(void 0),[H,$]=w.useState(!1),L=w.useRef(null),A=w.useRef(null),{data:M}=MB(t.agentRole!=="director"?t.agentId:void 0),P=y2(),I=p1(),B=GQe(),F=TB(),q=M?.hasActiveSession??!1;w.useEffect(()=>{M?.activeSession?.id?(T(M.activeSession.id),R(M.activeSession.providerSessionId),$(!1)):E&&!q&&$(!0)},[M?.activeSession?.id,M?.activeSession?.providerSessionId,q,E]);const Q=w.useCallback(async()=>{try{const oe=L.current?.getDimensions();await P.mutateAsync({agentId:t.agentId,interactive:t.paneType==="terminal",...oe&&{cols:oe.cols,rows:oe.rows}})}catch(oe){console.error("Failed to start session:",oe)}},[t.agentId,t.paneType,P]),W=w.useCallback(async()=>{try{await I.mutateAsync({agentId:t.agentId,graceful:!0}),T(void 0),R(void 0),$(!1)}catch(oe){console.error("Failed to stop session:",oe)}},[t.agentId,I]),G=w.useCallback((oe,Z)=>{T(oe),R(Z),$(!0),N(!1)},[]),J=w.useCallback(async(oe,Z)=>{try{$(!1),await F.mutateAsync({agentId:t.agentId,providerSessionId:oe,resumePrompt:Z})}catch(ve){throw console.error("Failed to resume session:",ve),$(!0),ve}},[t.agentId,F]),X=w.useRef(d);w.useEffect(()=>{X.current=d},[d]),w.useEffect(()=>{if(!k||!q||t.agentRole==="director")return;const oe=Z=>{Z.key==="Escape"&&!B.isPending&&(Z.preventDefault(),Z.stopPropagation(),B.mutate({agentId:t.agentId}))};return window.addEventListener("keydown",oe),()=>window.removeEventListener("keydown",oe)},[k,q,t.agentId,t.agentRole,B]);const V=w.useCallback(oe=>{X.current(oe)},[]),se=w.useCallback(()=>{L.current?.refresh()},[]),de=w.useCallback(oe=>{L.current?.sendInput(oe),L.current?.sendInput("\r")},[]),he=w.useCallback(()=>{S(oe=>!oe),b(!1)},[]);w.useImperativeHandle(p,()=>({refresh:se}),[se]);const te=gte[t.agentRole]||gte.worker,le=te.icon;return o.jsxs("div",{ref:A,tabIndex:0,className:`
        flex flex-col h-full
        rounded-lg border overflow-hidden
        transition-all duration-150
        ${r?"border-[var(--color-primary)] ring-1 ring-[var(--color-primary)]/30":"border-[var(--color-border)]"}
        bg-[var(--color-bg-secondary)]
        focus:outline-none
      `,onClick:u,onFocus:()=>j(!0),onBlur:()=>j(!1),"data-testid":`workspace-pane-${t.id}`,"data-pane-id":t.id,"data-agent-id":t.agentId,"data-pane-type":t.paneType,children:[o.jsxs("div",{className:`
          flex items-center justify-between
          px-3 py-2
          border-b border-[var(--color-border)]
          bg-[var(--color-surface)]
          ${s?"cursor-grab active:cursor-grabbing":""}
        `,draggable:s,onDragStart:f,onDragEnd:m,"data-testid":"pane-header",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("div",{className:`w-2.5 h-2.5 rounded-full flex-shrink-0 ${t.agentRole==="director"||q?mte[t.status]:"bg-gray-400"}`,title:t.agentRole==="director"||q?pte[t.status]:"Session not running"}),o.jsxs("span",{className:`
            inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium flex-shrink-0
            ${te.bg} ${te.text}
          `,children:[o.jsx(le,{className:"w-3 h-3"}),t.agentRole]}),o.jsx("span",{className:"text-sm font-mono text-[var(--color-text)] truncate",title:t.agentName,children:t.agentName}),t.workerMode&&o.jsx("span",{className:`
              px-1.5 py-0.5 rounded text-xs
              bg-[var(--color-surface-hover)] text-[var(--color-text-tertiary)]
              flex-shrink-0
            `,children:t.workerMode})]}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[t.agentRole!=="director"&&o.jsx(o.Fragment,{children:q?o.jsx(Cn,{content:"Stop Session",side:"bottom",children:o.jsx("button",{onClick:oe=>{oe.stopPropagation(),W()},disabled:I.isPending,className:`
                      p-1 rounded
                      text-red-600 dark:text-red-400
                      hover:bg-[var(--color-surface-hover)]
                      transition-colors
                      disabled:opacity-50
                    `,title:"Stop Session","data-testid":"pane-stop-session",children:I.isPending?o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(uu,{className:"w-3.5 h-3.5"})})}):o.jsx(Cn,{content:"Start Session",side:"bottom",children:o.jsx("button",{onClick:oe=>{oe.stopPropagation(),Q()},disabled:P.isPending,className:`
                      p-1 rounded
                      text-green-600 dark:text-green-400
                      hover:bg-[var(--color-surface-hover)]
                      transition-colors
                      disabled:opacity-50
                    `,title:"Start Session","data-testid":"pane-start-session",children:P.isPending?o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx(Yr,{className:"w-3.5 h-3.5"})})})}),!a&&o.jsx("button",{onClick:oe=>{oe.stopPropagation(),n?c():l()},className:`
                p-1 rounded
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,title:n?"Restore":"Maximize","data-testid":"pane-maximize-btn",children:n?o.jsx($6,{className:"w-3.5 h-3.5"}):o.jsx(ej,{className:"w-3.5 h-3.5"})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:oe=>{oe.stopPropagation(),b(!v)},className:`
                p-1 rounded
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,title:"More options","data-testid":"pane-menu-btn",children:o.jsx(n0,{className:"w-3.5 h-3.5"})}),v&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>b(!1)}),o.jsxs("div",{className:`
                    absolute right-0 top-full mt-1 z-20
                    min-w-40 py-1 rounded-md shadow-lg
                    bg-[var(--color-bg)] border border-[var(--color-border)]
                  `,"data-testid":"pane-menu",children:[t.paneType==="terminal"&&t.agentRole!=="director"&&o.jsxs("button",{onClick:oe=>{oe.stopPropagation(),b(!1),se()},className:`
                        w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                        text-[var(--color-text-secondary)]
                        hover:bg-[var(--color-surface-hover)]
                      `,children:[o.jsx(ose,{className:"w-4 h-4"}),"Refresh"]}),t.paneType==="terminal"&&t.agentRole!=="director"&&o.jsx("button",{onClick:oe=>{oe.stopPropagation(),he()},className:`
                        w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                        text-[var(--color-text-secondary)]
                        hover:bg-[var(--color-surface-hover)]
                      `,"data-testid":"pane-toggle-textbox",children:y?o.jsxs(o.Fragment,{children:[o.jsx(Pwe,{className:"w-4 h-4"}),"Hide textbox"]}):o.jsxs(o.Fragment,{children:[o.jsx(oi,{className:"w-4 h-4"}),"Show textbox"]})}),(t.workerMode==="ephemeral"||t.agentRole==="steward")&&t.agentRole!=="director"&&o.jsxs("button",{onClick:oe=>{oe.stopPropagation(),b(!1),N(!0)},className:`
                        w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                        text-[var(--color-text-secondary)]
                        hover:bg-[var(--color-surface-hover)]
                      `,"data-testid":"pane-view-history",children:[o.jsx(eh,{className:"w-4 h-4"}),"View history"]}),o.jsxs("button",{onClick:oe=>{oe.stopPropagation(),b(!1);const ve=`/popout/terminal?${new URLSearchParams({agent:t.agentId,type:t.paneType,name:t.agentName,role:t.agentRole,...t.workerMode&&{mode:t.workerMode}}).toString()}`;window.open(ve,`terminal-${t.agentId}`,"width=800,height=600,menubar=no,toolbar=no,location=no,status=no"),i()},className:`
                      w-full px-3 py-1.5 text-left text-sm flex items-center gap-2
                      text-[var(--color-text-secondary)]
                      hover:bg-[var(--color-surface-hover)]
                    `,children:[o.jsx(tj,{className:"w-4 h-4"}),"Pop out"]})]})]})]}),o.jsx("button",{onClick:oe=>{oe.stopPropagation(),i()},className:`
              p-1 rounded
              text-[var(--color-text-tertiary)]
              hover:text-red-500
              hover:bg-red-50 dark:hover:bg-red-900/20
              transition-colors
            `,title:"Close pane","data-testid":"pane-close-btn",children:o.jsx(yt,{className:"w-3.5 h-3.5"})})]})]}),o.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden relative flex flex-col","data-testid":"pane-content",children:[t.agentRole==="director"?o.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 p-6 text-center bg-[#1a1a1a]",children:[o.jsx(na,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-2",children:"Director Terminal"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-xs",children:"Use the Director panel on the right for interactive terminal access."})]}):t.paneType==="terminal"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 min-h-0",children:o.jsx(EB,{ref:L,agentId:t.agentId,onStatusChange:V,interactive:!0,autoFocus:!0,controlsResize:!0,"data-testid":`terminal-${t.id}`})}),y&&o.jsx(P0e,{isConnected:t.status==="connected"&&q,onSend:de,connectedPlaceholder:"Type a command...",disconnectedPlaceholder:"Start session to send commands","data-testid":`textbox-${t.id}`})]}):o.jsx(B0e,{agentId:t.agentId,agentName:t.agentName,sessionId:E,providerSessionId:O,hasActiveSession:q,onResumeWithMessage:J,onStatusChange:V,"data-testid":`stream-${t.id}`}),t.agentRole!=="director"&&(!q||I.isPending)&&!H&&!F.isPending&&o.jsx("div",{className:`
              absolute inset-0 z-10
              flex flex-col items-center justify-center
              bg-[#1a1a1a]/95 backdrop-blur-sm
              overflow-y-auto p-3
            `,"data-testid":"pane-idle-overlay",children:I.isPending?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-3",children:[o.jsx("div",{className:"absolute inset-0 bg-amber-500/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                    relative p-2.5 rounded-xl
                    bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                    border border-[#333]
                    shadow-lg
                  `,children:o.jsx(jr,{className:"w-7 h-7 text-amber-400 animate-spin"})})]}),o.jsxs("div",{className:"text-center mb-3",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-0.5",children:"Shutting Down"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-[280px] px-2",children:"Gracefully stopping the session..."})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"0ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"150ms"}}),o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse",style:{animationDelay:"300ms"}})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative mb-3 flex-shrink-0",children:[o.jsx("div",{className:"absolute inset-0 bg-[var(--color-primary)]/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                    relative p-2.5 rounded-xl
                    bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                    border border-[#333]
                    shadow-lg
                  `,children:t.status==="error"?o.jsx(Rt,{className:"w-7 h-7 text-red-400"}):o.jsx(Qae,{className:"w-7 h-7 text-[var(--color-text-muted)]"})})]}),o.jsxs("div",{className:"text-center mb-3 flex-shrink-0",children:[o.jsx("h3",{className:"text-base font-medium text-[var(--color-text)] mb-0.5",children:t.status==="error"?"Session Error":"Session Idle"}),o.jsx("p",{className:"text-xs text-[var(--color-text-muted)] max-w-[280px] px-2",children:t.status==="error"?"The agent session encountered an error.":`Start a session to interact with ${t.agentName}.`})]}),o.jsx("button",{onClick:Q,disabled:P.isPending,className:`
                    inline-flex items-center gap-2 flex-shrink-0
                    px-4 py-2 rounded-lg
                    bg-gradient-to-r from-green-600 to-green-500
                    hover:from-green-500 hover:to-green-400
                    text-white font-medium text-sm
                    shadow-lg shadow-green-500/25
                    transition-all duration-200
                    hover:scale-105 hover:shadow-green-500/40
                    disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                    focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
                  `,"data-testid":"pane-overlay-start-btn",children:P.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-3.5 h-3.5"}),"Start Session"]})}),o.jsxs("div",{className:`
                  mt-3 px-2.5 py-1 rounded-full flex-shrink-0
                  bg-[#252525] border border-[#333]
                  text-[10px] text-[var(--color-text-tertiary)]
                `,children:[t.workerMode==="persistent"?"Persistent Worker":"Ephemeral Worker","  ",t.paneType==="terminal"?"Interactive":"Stream"]})]})})]}),(t.workerMode==="ephemeral"||t.agentRole==="steward")&&o.jsx(gdt,{isOpen:_,onClose:()=>N(!1),agentId:t.agentId,agentName:t.agentName,sessions:M?.recentHistory??[],onViewSession:G})]})});function un(e,t="Assertion error"){if(!e)throw Error(t)}function Hg({group:e}){const{orientation:t,panels:r}=e;return r.reduce((n,a)=>(n+=t==="horizontal"?a.element.offsetWidth:a.element.offsetHeight,n),0)}function o5(e,t){return t.sort(e==="horizontal"?bdt:ydt)}function bdt(e,t){const r=e.element.offsetLeft-t.element.offsetLeft;return r!==0?r:e.element.offsetWidth-t.element.offsetWidth}function ydt(e,t){const r=e.element.offsetTop-t.element.offsetTop;return r!==0?r:e.element.offsetHeight-t.element.offsetHeight}function U0e(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function H0e(e,t){return{x:e.x>=t.left&&e.x<=t.right?0:Math.min(Math.abs(e.x-t.left),Math.abs(e.x-t.right)),y:e.y>=t.top&&e.y<=t.bottom?0:Math.min(Math.abs(e.y-t.top),Math.abs(e.y-t.bottom))}}function xdt({orientation:e,rects:t,targetRect:r}){const n={x:r.x+r.width/2,y:r.y+r.height/2};let a,s=Number.MAX_VALUE;for(const i of t){const{x:l,y:c}=H0e(n,i),u=e==="horizontal"?l:c;u<s&&(s=u,a=i)}return un(a,"No rect found"),a}let YS;function wdt(){return YS===void 0&&(typeof matchMedia=="function"?YS=!!matchMedia("(pointer:coarse)").matches:YS=!1),YS}function q0e(e){const{element:t,orientation:r,panels:n,separators:a}=e,s=o5(r,Array.from(t.children).filter(U0e).map(d=>({element:d}))).map(({element:d})=>d),i=[];let l=!1,c,u=[];for(const d of s)if(d.hasAttribute("data-panel")){const f=n.find(m=>m.element===d);if(f){if(c){const m=c.element.getBoundingClientRect(),p=d.getBoundingClientRect();let v;if(l){const b=r==="horizontal"?new DOMRect(m.right,m.top,0,m.height):new DOMRect(m.left,m.bottom,m.width,0),y=r==="horizontal"?new DOMRect(p.left,p.top,0,p.height):new DOMRect(p.left,p.top,p.width,0);switch(u.length){case 0:{v=[b,y];break}case 1:{const S=u[0],_=xdt({orientation:r,rects:[m,p],targetRect:S.element.getBoundingClientRect()});v=[S,_===m?y:b];break}default:{v=u;break}}}else u.length?v=u:v=[r==="horizontal"?new DOMRect(m.right,p.top,p.left-m.right,p.height):new DOMRect(p.left,m.bottom,p.width,p.top-m.bottom)];for(const b of v){let y="width"in b?b:b.element.getBoundingClientRect();const S=wdt()?e.resizeTargetMinimumSize.coarse:e.resizeTargetMinimumSize.fine;if(y.width<S){const _=S-y.width;y=new DOMRect(y.x-_/2,y.y,y.width+_,y.height)}if(y.height<S){const _=S-y.height;y=new DOMRect(y.x,y.y-_/2,y.width,y.height+_)}i.push({group:e,groupSize:Hg({group:e}),panels:[c,f],separator:"width"in b?void 0:b,rect:y})}}l=!1,c=f,u=[]}}else if(d.hasAttribute("data-separator")){const f=a.find(m=>m.element===d);f?u.push(f):(c=void 0,u=[])}else l=!0;return i}function Sdt(e,t){const r=getComputedStyle(e),n=parseFloat(r.fontSize);return t*n}function kdt(e,t){const r=getComputedStyle(e.ownerDocument.body),n=parseFloat(r.fontSize);return t*n}function _dt(e){return e/100*window.innerHeight}function Ndt(e){return e/100*window.innerWidth}function Cdt(e){switch(typeof e){case"number":return[e,"px"];case"string":{const t=parseFloat(e);return e.endsWith("%")?[t,"%"]:e.endsWith("px")?[t,"px"]:e.endsWith("rem")?[t,"rem"]:e.endsWith("em")?[t,"em"]:e.endsWith("vh")?[t,"vh"]:e.endsWith("vw")?[t,"vw"]:[t,"%"]}}}function QS({groupSize:e,panelElement:t,styleProp:r}){let n;const[a,s]=Cdt(r);switch(s){case"%":{n=a/100*e;break}case"px":{n=a;break}case"rem":{n=kdt(t,a);break}case"em":{n=Sdt(t,a);break}case"vh":{n=_dt(a);break}case"vw":{n=Ndt(a);break}}return n}function Yo(e){return parseFloat(e.toFixed(3))}function vte(e){const{panels:t}=e,r=Hg({group:e});return r===0?t.map(n=>({collapsedSize:0,collapsible:n.panelConstraints.collapsible===!0,defaultSize:void 0,minSize:0,maxSize:100,panelId:n.id})):t.map(n=>{const{element:a,panelConstraints:s}=n;let i=0;if(s.collapsedSize!==void 0){const d=QS({groupSize:r,panelElement:a,styleProp:s.collapsedSize});i=Yo(d/r*100)}let l;if(s.defaultSize!==void 0){const d=QS({groupSize:r,panelElement:a,styleProp:s.defaultSize});l=Yo(d/r*100)}let c=0;if(s.minSize!==void 0){const d=QS({groupSize:r,panelElement:a,styleProp:s.minSize});c=Yo(d/r*100)}let u=100;if(s.maxSize!==void 0){const d=QS({groupSize:r,panelElement:a,styleProp:s.maxSize});u=Yo(d/r*100)}return{collapsedSize:i,collapsible:s.collapsible===!0,defaultSize:l,minSize:c,maxSize:u,panelId:n.id}})}var md;class jdt{constructor(){OH(this,md,{})}addListener(t,r){const n=gv(this,md)[t];return n===void 0?gv(this,md)[t]=[r]:n.includes(r)||n.push(r),()=>{this.removeListener(t,r)}}emit(t,r){const n=gv(this,md)[t];if(n!==void 0)if(n.length===1)n[0].call(null,r);else{let a=!1,s=null;const i=Array.from(n);for(let l=0;l<i.length;l++){const c=i[l];try{c.call(null,r)}catch(u){s===null&&(a=!0,s=u)}}if(a)throw s}}removeAllListeners(){IH(this,md,{})}removeListener(t,r){const n=gv(this,md)[t];if(n!==void 0){const a=n.indexOf(r);a>=0&&n.splice(a,1)}}}md=new WeakMap;function Ds(e,t,r=0){return Math.abs(Yo(e)-Yo(t))<=r}let lo={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map};const hh=new jdt;function Ii(){return lo}function ri(e){const t=typeof e=="function"?e(lo):e;if(lo===t)return lo;const r=lo;return lo={...lo,...t},t.cursorFlags!==void 0&&hh.emit("cursorFlagsChange",lo.cursorFlags),t.interactionState!==void 0&&hh.emit("interactionStateChange",lo.interactionState),t.mountedGroups!==void 0&&(lo.mountedGroups.forEach((n,a)=>{n.derivedPanelConstraints.forEach(s=>{if(s.collapsible){const{layout:i}=r.mountedGroups.get(a)??{};if(i){const l=Ds(s.collapsedSize,n.layout[s.panelId]),c=Ds(s.collapsedSize,i[s.panelId]);l&&!c&&(a.inMemoryLastExpandedPanelSizes[s.panelId]=i[s.panelId])}}})}),hh.emit("mountedGroupsChange",lo.mountedGroups)),lo}function Edt(e,t,r){let n,a={x:1/0,y:1/0};for(const s of t){const i=H0e(r,s.rect);switch(e){case"horizontal":{i.x<=a.x&&(n=s,a=i);break}case"vertical":{i.y<=a.y&&(n=s,a=i);break}}}return n?{distance:a,hitRegion:n}:void 0}function Mdt(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function Tdt(e,t){if(e===t)throw new Error("Cannot compare node with itself");const r={a:xte(e),b:xte(t)};let n;for(;r.a.at(-1)===r.b.at(-1);)e=r.a.pop(),t=r.b.pop(),n=e;un(n,"Stacking order can only be calculated for elements with a common ancestor");const a={a:yte(bte(r.a)),b:yte(bte(r.b))};if(a.a===a.b){const s=n.childNodes,i={a:r.a.at(-1),b:r.b.at(-1)};let l=s.length;for(;l--;){const c=s[l];if(c===i.a)return 1;if(c===i.b)return-1}}return Math.sign(a.a-a.b)}const Adt=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Ddt(e){const t=getComputedStyle(W0e(e)??e).display;return t==="flex"||t==="inline-flex"}function Ldt(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||Ddt(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||Adt.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function bte(e){let t=e.length;for(;t--;){const r=e[t];if(un(r,"Missing node"),Ldt(r))return r}return null}function yte(e){return e&&Number(getComputedStyle(e).zIndex)||0}function xte(e){const t=[];for(;e;)t.push(e),e=W0e(e);return t}function W0e(e){const{parentNode:t}=e;return Mdt(t)?t.host:t}function Odt(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function Idt({groupElement:e,hitRegion:t,pointerEventTarget:r}){if(!U0e(r)||r.contains(e)||e.contains(r))return!0;if(Tdt(r,e)>0){let n=r;for(;n;){if(n.contains(e))return!0;if(Odt(n.getBoundingClientRect(),t))return!1;n=n.parentElement}}return!0}function u$(e,t){const r=[];return t.forEach((n,a)=>{if(a.disabled)return;const s=q0e(a),i=Edt(a.orientation,s,{x:e.clientX,y:e.clientY});i&&i.distance.x<=0&&i.distance.y<=0&&Idt({groupElement:a.element,hitRegion:i.hitRegion.rect,pointerEventTarget:e.target})&&r.push(i.hitRegion)}),r}function Rdt(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function zc(e,t){return Ds(e,t)?0:e>t?1:-1}function Lp({panelConstraints:e,size:t}){const{collapsedSize:r=0,collapsible:n,maxSize:a=100,minSize:s=0}=e;if(zc(t,s)<0)if(n){const i=(r+s)/2;zc(t,i)<0?t=r:t=s}else t=s;return t=Math.min(a,t),t=Yo(t),t}function wx({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:n,prevLayout:a,trigger:s}){if(Ds(e,0))return t;const i=Object.values(t),l=Object.values(a),c=[...i],[u,d]=n;un(u!=null,"Invalid first pivot index"),un(d!=null,"Invalid second pivot index");let f=0;switch(s){case"keyboard":{{const v=e<0?d:u,b=r[v];un(b,`Panel constraints not found for index ${v}`);const{collapsedSize:y=0,collapsible:S,minSize:_=0}=b;if(S){const N=i[v];if(un(N!=null,`Previous layout not found for panel index ${v}`),Ds(N,y)){const k=_-N;zc(k,Math.abs(e))>0&&(e=e<0?0-k:k)}}}{const v=e<0?u:d,b=r[v];un(b,`No panel constraints found for index ${v}`);const{collapsedSize:y=0,collapsible:S,minSize:_=0}=b;if(S){const N=i[v];if(un(N!=null,`Previous layout not found for panel index ${v}`),Ds(N,_)){const k=N-y;zc(k,Math.abs(e))>0&&(e=e<0?0-k:k)}}}break}default:{const v=e<0?d:u,b=r[v];un(b,`Panel constraints not found for index ${v}`);const{collapsible:y,collapsedSize:S,minSize:_}=b;if(y)if(e>0){const N=_-S,k=N/2;zc(e,_)<0&&(e=zc(e,k)<=0?0:N)}else{const N=_-S,k=100-N/2;zc(100+e,_)>0&&(e=zc(100+e,k)>0?0:-N)}break}}{const v=e<0?1:-1;let b=e<0?d:u,y=0;for(;;){const _=i[b];un(_!=null,`Previous layout not found for panel index ${b}`);const N=Lp({panelConstraints:r[b],size:100})-_;if(y+=N,b+=v,b<0||b>=r.length)break}const S=Math.min(Math.abs(e),Math.abs(y));e=e<0?0-S:S}{let v=e<0?u:d;for(;v>=0&&v<r.length;){const b=Math.abs(e)-Math.abs(f),y=i[v];un(y!=null,`Previous layout not found for panel index ${v}`);const S=y-b,_=Lp({panelConstraints:r[v],size:S});if(!Ds(y,_)&&(f+=y-_,c[v]=_,f.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?v--:v++}}if(Rdt(l,c))return a;{const v=e<0?d:u,b=i[v];un(b!=null,`Previous layout not found for panel index ${v}`);const y=b+f,S=Lp({panelConstraints:r[v],size:y});if(c[v]=S,!Ds(S,y)){let _=y-S,N=e<0?d:u;for(;N>=0&&N<r.length;){const k=c[N];un(k!=null,`Previous layout not found for panel index ${N}`);const j=k+_,E=Lp({panelConstraints:r[N],size:j});if(Ds(k,E)||(_-=E-k,c[N]=E),Ds(_,0))break;e>0?N--:N++}}}const m=Object.values(c).reduce((v,b)=>b+v,0);if(!Ds(m,100,.1))return a;const p=Object.keys(a);return c.reduce((v,b,y)=>(v[p[y]]=b,v),{})}function zh(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(t[r]===void 0||zc(e[r],t[r])!==0)return!1;return!0}function Bh({layout:e,panelConstraints:t}){const r=[...Object.values(e)],n=r.reduce((i,l)=>i+l,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(i=>`${i}%`).join(", ")}`);if(!Ds(n,100)&&r.length>0)for(let i=0;i<t.length;i++){const l=r[i];un(l!=null,`No layout data found for index ${i}`);const c=100/n*l;r[i]=c}let a=0;for(let i=0;i<t.length;i++){const l=r[i];un(l!=null,`No layout data found for index ${i}`);const c=Lp({panelConstraints:t[i],size:l});l!=c&&(a+=l-c,r[i]=c)}if(!Ds(a,0))for(let i=0;i<t.length;i++){const l=r[i];un(l!=null,`No layout data found for index ${i}`);const c=l+a,u=Lp({panelConstraints:t[i],size:c});if(l!==u&&(a-=u-l,r[i]=u,Ds(a,0)))break}const s=Object.keys(e);return r.reduce((i,l,c)=>(i[s[c]]=l,i),{})}function K0e({groupId:e,panelId:t}){const r=()=>{const{mountedGroups:l}=Ii();for(const[c,{defaultLayoutDeferred:u,derivedPanelConstraints:d,layout:f,separatorToPanels:m}]of l)if(c.id===e)return{defaultLayoutDeferred:u,derivedPanelConstraints:d,group:c,layout:f,separatorToPanels:m};throw Error(`Group ${e} not found`)},n=()=>{const l=r().derivedPanelConstraints.find(c=>c.panelId===t);if(l!==void 0)return l;throw Error(`Panel constraints not found for Panel ${t}`)},a=()=>{const l=r().group.panels.find(c=>c.id===t);if(l!==void 0)return l;throw Error(`Layout not found for Panel ${t}`)},s=()=>{const l=r().layout[t];if(l!==void 0)return l;throw Error(`Layout not found for Panel ${t}`)},i=l=>{const c=s();if(l===c)return;const{defaultLayoutDeferred:u,derivedPanelConstraints:d,group:f,layout:m,separatorToPanels:p}=r(),v=f.panels.findIndex(_=>_.id===t),b=v===f.panels.length-1,y=wx({delta:b?c-l:l-c,initialLayout:m,panelConstraints:d,pivotIndices:b?[v-1,v]:[v,v+1],prevLayout:m,trigger:"imperative-api"}),S=Bh({layout:y,panelConstraints:d});zh(m,S)||ri(_=>({mountedGroups:new Map(_.mountedGroups).set(f,{defaultLayoutDeferred:u,derivedPanelConstraints:d,layout:S,separatorToPanels:p})}))};return{collapse:()=>{const{collapsible:l,collapsedSize:c}=n(),{mutableValues:u}=a(),d=s();l&&d!==c&&(u.expandToSize=d,i(c))},expand:()=>{const{collapsible:l,collapsedSize:c,minSize:u}=n(),{mutableValues:d}=a(),f=s();if(l&&f===c){let m=d.expandToSize??u;m===0&&(m=1),i(m)}},getSize:()=>{const{group:l}=r(),c=s(),{element:u}=a(),d=l.orientation==="horizontal"?u.offsetWidth:u.offsetHeight;return{asPercentage:c,inPixels:d}},isCollapsed:()=>{const{collapsible:l,collapsedSize:c}=n(),u=s();return l&&Ds(c,u)},resize:l=>{if(s()!==l){let c;switch(typeof l){case"number":{const{group:u}=r(),d=Hg({group:u});c=Yo(l/d*100);break}case"string":{c=parseFloat(l);break}}i(c)}}}}function wte(e){if(e.defaultPrevented)return;const{mountedGroups:t}=Ii();u$(e,t).forEach(r=>{if(r.separator){const n=r.panels.find(a=>a.panelConstraints.defaultSize!==void 0);if(n){const a=n.panelConstraints.defaultSize,s=K0e({groupId:r.group.id,panelId:n.id});s&&a!==void 0&&(s.resize(a),e.preventDefault())}}})}function Uk(e){const{mountedGroups:t}=Ii();for(const[r]of t)if(r.separators.some(n=>n.element===e))return r;throw Error("Could not find parent Group for separator element")}function G0e({groupId:e}){const t=()=>{const{mountedGroups:r}=Ii();for(const[n,a]of r)if(n.id===e)return{group:n,...a};throw Error(`Could not find Group with id "${e}"`)};return{getLayout(){const{defaultLayoutDeferred:r,layout:n}=t();return r?{}:n},setLayout(r){const{defaultLayoutDeferred:n,derivedPanelConstraints:a,group:s,layout:i,separatorToPanels:l}=t(),c=Bh({layout:r,panelConstraints:a});return n?i:(zh(i,c)||ri(u=>({mountedGroups:new Map(u.mountedGroups).set(s,{defaultLayoutDeferred:n,derivedPanelConstraints:a,layout:c,separatorToPanels:l})})),c)}}}function V0e(e){const{mountedGroups:t}=Ii(),r=t.get(e);return un(r,`Mounted Group ${e.id} not found`),r}function wf(e,t){const r=Uk(e),n=V0e(r),a=r.separators.find(d=>d.element===e);un(a,"Matching separator not found");const s=n.separatorToPanels.get(a);un(s,"Matching panels not found");const i=s.map(d=>r.panels.indexOf(d)),l=G0e({groupId:r.id}).getLayout(),c=wx({delta:t,initialLayout:l,panelConstraints:n.derivedPanelConstraints,pivotIndices:i,prevLayout:l,trigger:"keyboard"}),u=Bh({layout:c,panelConstraints:n.derivedPanelConstraints});zh(l,u)||ri(d=>({mountedGroups:new Map(d.mountedGroups).set(r,{defaultLayoutDeferred:n.defaultLayoutDeferred,derivedPanelConstraints:n.derivedPanelConstraints,layout:u,separatorToPanels:n.separatorToPanels})}))}function Ste(e){if(e.defaultPrevented)return;const t=e.currentTarget,r=Uk(t);if(!r.disabled)switch(e.key){case"ArrowDown":{e.preventDefault(),r.orientation==="vertical"&&wf(t,5);break}case"ArrowLeft":{e.preventDefault(),r.orientation==="horizontal"&&wf(t,-5);break}case"ArrowRight":{e.preventDefault(),r.orientation==="horizontal"&&wf(t,5);break}case"ArrowUp":{e.preventDefault(),r.orientation==="vertical"&&wf(t,-5);break}case"End":{e.preventDefault(),wf(t,100);break}case"Enter":{e.preventDefault();const n=Uk(t),{derivedPanelConstraints:a,layout:s,separatorToPanels:i}=V0e(n),l=n.separators.find(f=>f.element===t);un(l,"Matching separator not found");const c=i.get(l);un(c,"Matching panels not found");const u=c[0],d=a.find(f=>f.panelId===u.id);if(un(d,"Panel metadata not found"),d.collapsible){const f=s[u.id],m=d.collapsedSize===f?n.inMemoryLastExpandedPanelSizes[u.id]??d.minSize:d.collapsedSize;wf(t,m-f)}break}case"F6":{e.preventDefault();const n=Uk(t).separators.map(i=>i.element),a=Array.from(n).findIndex(i=>i===e.currentTarget);un(a!==null,"Index not found");const s=e.shiftKey?a>0?a-1:n.length-1:a+1<n.length?a+1:0;n[s].focus();break}case"Home":{e.preventDefault(),wf(t,-100);break}}}function kte(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{mountedGroups:t}=Ii(),r=u$(e,t),n=new Set,a=new Set,s=new Set,i=new Map;let l=!1;r.forEach(c=>{n.add(c.group),c.panels.forEach(d=>{a.add(d)}),c.separator&&(s.add(c.separator),l||(l=!0,c.separator.element.focus()));const u=t.get(c.group);u&&i.set(c.group,u.layout)}),ri({interactionState:{hitRegions:r,initialLayoutMap:i,pointerDownAtPoint:{x:e.clientX,y:e.clientY},state:"active"}}),r.length&&e.preventDefault()}const Pdt=e=>e,VL=()=>{},Y0e=1,Q0e=2,J0e=4,Z0e=8,_te=3,Nte=12;let JS;function Cte(){return JS===void 0&&(JS=!1,typeof window<"u"&&(window.navigator.userAgent.includes("Chrome")||window.navigator.userAgent.includes("Firefox"))&&(JS=!0)),JS}function zdt({cursorFlags:e,groups:t,state:r}){let n=0,a=0;switch(r){case"active":case"hover":t.forEach(s=>{if(!s.disableCursor)switch(s.orientation){case"horizontal":{n++;break}case"vertical":{a++;break}}})}if(n===0&&a===0)return null;switch(r){case"active":{if(e&&Cte()){const s=(e&Y0e)!==0,i=(e&Q0e)!==0,l=(e&J0e)!==0,c=(e&Z0e)!==0;if(s)return l?"se-resize":c?"ne-resize":"e-resize";if(i)return l?"sw-resize":c?"nw-resize":"w-resize";if(l)return"s-resize";if(c)return"n-resize"}break}}return Cte()?n>0&&a>0?"move":n>0?"ew-resize":"ns-resize":n>0&&a>0?"grab":n>0?"col-resize":"row-resize"}const jte=new WeakMap;function d$(e){if(e.defaultView===null||e.defaultView===void 0)return;let{prevStyle:t,styleSheet:r}=jte.get(e)??{};r===void 0&&(r=new e.defaultView.CSSStyleSheet,e.adoptedStyleSheets.push(r));const{cursorFlags:n,interactionState:a}=Ii();switch(a.state){case"active":case"hover":{const s=zdt({cursorFlags:n,groups:a.hitRegions.map(l=>l.group),state:a.state}),i=`*, *:hover {cursor: ${s} !important; ${a.state==="active"?"touch-action: none;":""} }`;if(t===i)return;t=i,s?r.cssRules.length===0?r.insertRule(i):r.replaceSync(i):r.cssRules.length===1&&r.deleteRule(0);break}case"inactive":{t=void 0,r.cssRules.length===1&&r.deleteRule(0);break}}jte.set(e,{prevStyle:t,styleSheet:r})}function X0e({document:e,event:t,hitRegions:r,initialLayoutMap:n,mountedGroups:a,pointerDownAtPoint:s,prevCursorFlags:i}){let l=0;const c=new Map(a);r.forEach(d=>{const{group:f,groupSize:m}=d,{disableCursor:p,orientation:v,panels:b}=f;let y=0;s?v==="horizontal"?y=(t.clientX-s.x)/m*100:y=(t.clientY-s.y)/m*100:v==="horizontal"?y=t.clientX<0?-100:100:y=t.clientY<0?-100:100;const S=n.get(f),{defaultLayoutDeferred:_,derivedPanelConstraints:N,layout:k,separatorToPanels:j}=a.get(f)??{defaultLayoutDeferred:!1};if(N&&S&&k&&j){const E=wx({delta:y,initialLayout:S,panelConstraints:N,pivotIndices:d.panels.map(T=>b.indexOf(T)),prevLayout:k,trigger:"mouse-or-touch"});if(zh(E,k)){if(y!==0&&!p)switch(v){case"horizontal":{l|=y<0?Y0e:Q0e;break}case"vertical":{l|=y<0?J0e:Z0e;break}}}else{c.set(d.group,{defaultLayoutDeferred:_,derivedPanelConstraints:N,layout:E,separatorToPanels:j});const T=d.group.panels.map(({id:O})=>O).join(",");d.group.inMemoryLayouts[T]=E}}});let u=0;t.movementX===0?u|=i&_te:u|=l&_te,t.movementY===0?u|=i&Nte:u|=l&Nte,ri({cursorFlags:u,mountedGroups:c}),d$(e)}function Ete(e){const{cursorFlags:t,interactionState:r,mountedGroups:n}=Ii();switch(r.state){case"active":X0e({document:e.currentTarget,event:e,hitRegions:r.hitRegions,initialLayoutMap:r.initialLayoutMap,mountedGroups:n,prevCursorFlags:t})}}function Mte(e){if(e.defaultPrevented)return;const{cursorFlags:t,interactionState:r,mountedGroups:n}=Ii();switch(r.state){case"active":{if(e.buttons===0){ri(a=>a.interactionState.state==="inactive"?a:{cursorFlags:0,interactionState:{state:"inactive"}}),ri(a=>({mountedGroups:new Map(a.mountedGroups)}));return}X0e({document:e.currentTarget,event:e,hitRegions:r.hitRegions,initialLayoutMap:r.initialLayoutMap,mountedGroups:n,pointerDownAtPoint:r.pointerDownAtPoint,prevCursorFlags:t});break}default:{const a=u$(e,n);a.length===0?r.state!=="inactive"&&ri({interactionState:{state:"inactive"}}):ri({interactionState:{hitRegions:a,state:"hover"}}),d$(e.currentTarget);break}}}function Tte(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{interactionState:t}=Ii();switch(t.state){case"active":ri({cursorFlags:0,interactionState:{state:"inactive"}}),t.hitRegions.length>0&&(d$(e.currentTarget),ri(r=>({mountedGroups:new Map(r.mountedGroups)})),e.preventDefault())}}function Ate(e){let t=0,r=0;const n={};for(const s of e)if(s.defaultSize!==void 0){t++;const i=Yo(s.defaultSize);r+=i,n[s.panelId]=i}else n[s.panelId]=void 0;const a=e.length-t;if(a!==0){const s=Yo((100-r)/a);for(const i of e)i.defaultSize===void 0&&(n[i.panelId]=s)}return n}function Bdt(e,t,r){if(!r[0])return;const n=e.panels.find(c=>c.element===t);if(!n||!n.onResize)return;const a=Hg({group:e}),s=e.orientation==="horizontal"?n.element.offsetWidth:n.element.offsetHeight,i=n.mutableValues.prevSize,l={asPercentage:Yo(s/a*100),inPixels:s};n.mutableValues.prevSize=l,n.onResize(l,n.id,i)}function $dt(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function Fdt(e,t){const r=e.map(a=>a.id),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r)if(!n.includes(a))return!1;return!0}const op=new Map;function Udt(e){let t=!0;un(e.element.ownerDocument.defaultView,"Cannot register an unmounted Group");const r=e.element.ownerDocument.defaultView.ResizeObserver,n=new Set,a=new Set,s=new r(v=>{for(const b of v){const{borderBoxSize:y,target:S}=b;if(S===e.element){if(t){if(Hg({group:e})===0)return;ri(_=>{const N=_.mountedGroups.get(e);if(N){const k=vte(e),j=N.defaultLayoutDeferred?Ate(k):N.layout,E=Bh({layout:j,panelConstraints:k});return!N.defaultLayoutDeferred&&zh(j,E)&&$dt(N.derivedPanelConstraints,k)?_:{mountedGroups:new Map(_.mountedGroups).set(e,{defaultLayoutDeferred:!1,derivedPanelConstraints:k,layout:E,separatorToPanels:N.separatorToPanels})}}return _})}}else Bdt(e,S,y)}});s.observe(e.element),e.panels.forEach(v=>{un(!n.has(v.id),`Panel ids must be unique; id "${v.id}" was used more than once`),n.add(v.id),v.onResize&&s.observe(v.element)});const i=Hg({group:e}),l=vte(e),c=e.panels.map(({id:v})=>v).join(",");let u=e.defaultLayout;u&&(Fdt(e.panels,u)||(u=void 0));const d=e.inMemoryLayouts[c]??u??Ate(l),f=Bh({layout:d,panelConstraints:l}),m=q0e(e),p=e.element.ownerDocument;return ri(v=>{const b=new Map;return op.set(p,(op.get(p)??0)+1),m.forEach(y=>{y.separator&&b.set(y.separator,y.panels)}),{mountedGroups:new Map(v.mountedGroups).set(e,{defaultLayoutDeferred:i===0,derivedPanelConstraints:l,layout:f,separatorToPanels:b})}}),e.separators.forEach(v=>{un(!a.has(v.id),`Separator ids must be unique; id "${v.id}" was used more than once`),a.add(v.id),v.element.addEventListener("keydown",Ste)}),op.get(p)===1&&(p.addEventListener("dblclick",wte,!0),p.addEventListener("pointerdown",kte,!0),p.addEventListener("pointerleave",Ete),p.addEventListener("pointermove",Mte),p.addEventListener("pointerup",Tte,!0)),function(){t=!1,op.set(p,Math.max(0,(op.get(p)??0)-1)),ri(v=>{const b=new Map(v.mountedGroups);return b.delete(e),{mountedGroups:b}}),e.separators.forEach(v=>{v.element.removeEventListener("keydown",Ste)}),op.get(p)||(p.removeEventListener("dblclick",wte,!0),p.removeEventListener("pointerdown",kte,!0),p.removeEventListener("pointerleave",Ete),p.removeEventListener("pointermove",Mte),p.removeEventListener("pointerup",Tte,!0)),s.disconnect()}}function eve(){const[e,t]=w.useState({}),r=w.useCallback(()=>t({}),[]);return[e,r]}function f$(e){const t=w.useId();return`${e??t}`}const sm=typeof window<"u"?w.useLayoutEffect:w.useEffect;function ty(e){const t=w.useRef(e);return sm(()=>{t.current=e},[e]),w.useCallback((...r)=>t.current?.(...r),[t])}function h$(...e){return ty(t=>{e.forEach(r=>{if(r)switch(typeof r){case"function":{r(t);break}case"object":{r.current=t;break}}})})}function Hdt(e){const t=w.useRef({...e});return sm(()=>{for(const r in e)t.current[r]=e[r]},[e]),t.current}const tve=w.createContext(null);function qdt(e,t){const r=w.useRef({getLayout:()=>({}),setLayout:Pdt});w.useImperativeHandle(t,()=>r.current,[]),sm(()=>{Object.assign(r.current,G0e({groupId:e}))})}function nd({children:e,className:t,defaultLayout:r,disableCursor:n,disabled:a,elementRef:s,groupRef:i,id:l,onLayoutChange:c,onLayoutChanged:u,orientation:d="horizontal",resizeTargetMinimumSize:f={coarse:20,fine:10},style:m,...p}){const v=w.useRef({onLayoutChange:{},onLayoutChanged:{}}),b=ty($=>{zh(v.current.onLayoutChange,$)||(v.current.onLayoutChange=$,c?.($))}),y=ty($=>{zh(v.current.onLayoutChanged,$)||(v.current.onLayoutChanged=$,u?.($))}),S=f$(l),_=w.useRef(null),[N,k]=eve(),j=w.useRef({lastExpandedPanelSizes:{},layouts:{},panels:[],resizeTargetMinimumSize:f,separators:[]}),E=h$(_,s);qdt(S,i);const T=ty(($,L)=>{const{interactionState:A,mountedGroups:M}=Ii();for(const P of M.keys())if(P.id===$){const I=M.get(P);if(I){let B=!1;switch(A.state){case"active":{B=A.hitRegions.some(F=>F.group===P);break}}return{flexGrow:I.layout[L]??1,pointerEvents:B?"none":void 0}}}return{flexGrow:r?.[L]??1}}),O=w.useMemo(()=>({getPanelStyles:T,id:S,orientation:d,registerPanel:$=>{const L=j.current;return L.panels=o5(d,[...L.panels,$]),k(),()=>{L.panels=L.panels.filter(A=>A!==$),k()}},registerSeparator:$=>{const L=j.current;return L.separators=o5(d,[...L.separators,$]),k(),()=>{L.separators=L.separators.filter(A=>A!==$),k()}}}),[T,S,k,d]),R=Hdt({defaultLayout:r,disableCursor:n}),H=w.useRef(null);return sm(()=>{const $=_.current;if($===null)return;const L=j.current,A={defaultLayout:R.defaultLayout,disableCursor:!!R.disableCursor,disabled:!!a,element:$,id:S,inMemoryLastExpandedPanelSizes:j.current.lastExpandedPanelSizes,inMemoryLayouts:j.current.layouts,orientation:d,panels:L.panels,resizeTargetMinimumSize:L.resizeTargetMinimumSize,separators:L.separators};H.current=A;const M=Udt(A),P=Ii().mountedGroups.get(A);if(P){const{defaultLayoutDeferred:F,derivedPanelConstraints:q,layout:Q}=P;!F&&q.length>0&&(b(Q),y(Q),L.panels.forEach(W=>{W.scheduleUpdate()}))}const I=hh.addListener("interactionStateChange",()=>{L.panels.forEach(F=>{F.scheduleUpdate()})}),B=hh.addListener("mountedGroupsChange",F=>{const q=F.get(A);if(q){const{defaultLayoutDeferred:Q,derivedPanelConstraints:W,layout:G}=q;if(Q||W.length===0)return;const{interactionState:J}=Ii(),X=J.state!=="active";b(G),X&&y(G),L.panels.forEach(V=>{V.scheduleUpdate()})}});return()=>{H.current=null,M(),I(),B()}},[a,S,y,b,d,N,R]),w.useEffect(()=>{const $=H.current;$&&($.defaultLayout=r,$.disableCursor=!!n)}),o.jsx(tve.Provider,{value:O,children:o.jsx("div",{...p,"aria-orientation":d,className:t,"data-group":!0,"data-testid":S,id:S,ref:E,style:{height:"100%",width:"100%",overflow:"hidden",...m,display:"flex",flexDirection:d==="horizontal"?"row":"column",flexWrap:"nowrap"},children:e})})}nd.displayName="Group";function m$(){const e=w.useContext(tve);return un(e,"Group Context not found; did you render a Panel or Separator outside of a Group?"),e}function Wdt(e,t){const{id:r}=m$(),n=w.useRef({collapse:VL,expand:VL,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:VL});w.useImperativeHandle(t,()=>n.current,[]),sm(()=>{Object.assign(n.current,K0e({groupId:r,panelId:e}))})}function xi({children:e,className:t,collapsedSize:r="0%",collapsible:n=!1,defaultSize:a,elementRef:s,id:i,maxSize:l="100%",minSize:c="0%",onResize:u,panelRef:d,style:f,...m}){const p=!!i,v=f$(i),b=w.useRef(null),y=h$(b,s),[,S]=eve(),{getPanelStyles:_,id:N,registerPanel:k}=m$(),j=u!==null,E=ty((O,R,H)=>{u?.(O,i,H)});sm(()=>{const O=b.current;if(O!==null)return k({element:O,id:v,idIsStable:p,mutableValues:{expandToSize:void 0,prevSize:void 0},onResize:j?E:void 0,panelConstraints:{collapsedSize:r,collapsible:n,defaultSize:a,maxSize:l,minSize:c},scheduleUpdate:S})},[r,n,a,S,j,v,p,l,c,E,k]),Wdt(v,d);const T=_(N,v);return o.jsx("div",{...m,"data-panel":!0,"data-testid":v,id:v,ref:y,style:{...Kdt,display:"flex",flexBasis:0,flexShrink:1,overflow:"hidden",...T},children:o.jsx("div",{className:t,style:{maxHeight:"100%",maxWidth:"100%",flexGrow:1,...f},children:e})})}xi.displayName="Panel";const Kdt={minHeight:0,maxHeight:"100%",height:"auto",minWidth:0,maxWidth:"100%",width:"auto",border:"none",borderWidth:0,padding:0,margin:0};function Gdt({layout:e,panelConstraints:t,panelId:r,panelIndex:n}){let a,s;const i=e[r],l=t.find(c=>c.panelId===r);if(l){const c=l.maxSize,u=s=l.collapsible?l.collapsedSize:l.minSize,d=[n,n+1];s=Bh({layout:wx({delta:u-i,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[r],a=Bh({layout:wx({delta:c-i,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[r]}return{valueControls:r,valueMax:a,valueMin:s,valueNow:i}}function rve({children:e,className:t,elementRef:r,id:n,style:a,...s}){const i=f$(n),[l,c]=w.useState({}),[u,d]=w.useState("inactive"),f=w.useRef(null),m=h$(f,r),{id:p,orientation:v,registerSeparator:b}=m$(),y=v==="horizontal"?"vertical":"horizontal";return sm(()=>{const S=f.current;if(S!==null){const _={element:S,id:i},N=b(_),k=hh.addListener("interactionStateChange",E=>{d(E.state!=="inactive"&&E.hitRegions.some(T=>T.separator===_)?E.state:"inactive")}),j=hh.addListener("mountedGroupsChange",E=>{E.forEach(({derivedPanelConstraints:T,layout:O,separatorToPanels:R},H)=>{if(H.id===p){const $=R.get(_);if($){const L=$[0],A=H.panels.indexOf(L);c(Gdt({layout:O,panelConstraints:T,panelId:L.id,panelIndex:A}))}}})});return()=>{k(),j(),N()}}},[p,i,b]),o.jsx("div",{...s,"aria-controls":l.valueControls,"aria-orientation":y,"aria-valuemax":l.valueMax,"aria-valuemin":l.valueMin,"aria-valuenow":l.valueNow,children:e,className:t,"data-separator":u,"data-testid":i,id:i,ref:m,role:"separator",style:{flexBasis:"auto",...a,flexGrow:0,flexShrink:0},tabIndex:0})}rve.displayName="Separator";const Dte={director:"text-purple-500",worker:"text-blue-500",steward:"text-amber-500"};function ed({orientation:e,onSwap:t,swapTestId:r,testId:n}){const a=e==="horizontal",s=a?tj:t0,i=ce.useRef(null),l=ce.useRef(!1),c=ce.useRef(null),u=5,d=w.useCallback(f=>{c.current={x:f.clientX,y:f.clientY},l.current=!1;const m=v=>{if(c.current){const b=v.clientX-c.current.x,y=v.clientY-c.current.y;(Math.abs(b)>u||Math.abs(y)>u)&&(l.current=!0)}},p=()=>{c.current=null,document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",p)};document.addEventListener("pointermove",m),document.addEventListener("pointerup",p)},[]);return ce.useEffect(()=>{if(!t)return;const f=m=>{if(i.current&&!l.current){const p=i.current.getBoundingClientRect();m.clientX>=p.left&&m.clientX<=p.right&&m.clientY>=p.top&&m.clientY<=p.bottom&&t()}l.current=!1};return document.addEventListener("click",f),()=>document.removeEventListener("click",f)},[t]),ce.useEffect(()=>{if(!t)return;const f=i.current;if(!f)return;const m=v=>{const b=f.getBoundingClientRect(),y=v.clientX>=b.left&&v.clientX<=b.right&&v.clientY>=b.top&&v.clientY<=b.bottom;f.classList.toggle("is-hovered",y)},p=()=>{f.classList.remove("is-hovered")};return document.addEventListener("mousemove",m),document.addEventListener("mouseleave",p),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseleave",p)}},[t]),o.jsxs(rve,{onPointerDown:t?d:void 0,className:`
        group relative
        flex items-center justify-center
        ${a?"w-2 cursor-col-resize":"h-2 cursor-row-resize"}
        hover:bg-[var(--color-primary-muted)]
        transition-colors duration-150
      `,"data-testid":n,children:[!t&&o.jsx("div",{className:`
            ${a?"w-0.5 h-8":"h-0.5 w-8"}
            bg-[var(--color-border)]
            group-hover:bg-[var(--color-primary)]
            group-data-[resize-handle-active]:bg-[var(--color-primary)]
            transition-colors duration-150
            rounded-full
          `}),t&&o.jsx("div",{ref:i,className:`
            absolute z-20
            p-2 rounded-full
            bg-[var(--color-surface)] border border-[var(--color-border)]
            text-[var(--color-text-tertiary)]
            pointer-events-none
            transition-all duration-150
            shadow-md
            opacity-60
            [&.is-hovered]:opacity-100
            [&.is-hovered]:bg-[var(--color-primary-muted)]
            [&.is-hovered]:text-[var(--color-primary)]
            [&.is-hovered]:border-[var(--color-primary)]
            [&.is-hovered]:scale-110
          `,title:"Swap sections","data-testid":r,children:o.jsx(s,{className:"w-3.5 h-3.5"})})]})}function Lte({pane:e,isActive:t,isMaximized:r,isSingleMode:n,isDragging:a,isDropTarget:s,onClose:i,onMaximize:l,onMinimize:c,onFocus:u,onStatusChange:d,onDragStart:f,onDragOver:m,onDrop:p,onDragEnd:v,paneRef:b}){const y=!r&&!n;return o.jsxs("div",{className:`
        h-full w-full min-h-0 min-w-0 relative
        ${a?"opacity-50 scale-95":""}
        transition-all duration-150
      `,onDragOver:m,onDrop:p,children:[s&&o.jsx("div",{className:"absolute inset-0 z-10 pointer-events-none flex items-center justify-center bg-[var(--color-primary)]/10 border-2 border-dashed border-[var(--color-primary)] rounded-lg",children:o.jsx("div",{className:"px-3 py-1.5 rounded-md bg-[var(--color-primary)] text-white text-sm font-medium shadow-lg",children:"Drop to swap positions"})}),o.jsx(vdt,{ref:b,pane:e,isActive:t,isMaximized:r,isSingleMode:n,draggable:y,onClose:i,onMaximize:l,onMinimize:c,onFocus:u,onStatusChange:d,onDragStart:f,onDragEnd:v})]})}function Vdt(e,t){if(t===0)return{orientation:"horizontal",rows:[]};if(t===1)return{orientation:"horizontal",rows:[[0]]};switch(e){case"single":return{orientation:"vertical",rows:Array.from({length:t},(a,s)=>[s])};case"columns":return{orientation:"horizontal",rows:Array.from({length:t},(a,s)=>[s])};case"rows":return{orientation:"vertical",rows:Array.from({length:t},(a,s)=>[s])};case"grid":case"flex":default:if(t===2)return{orientation:"horizontal",rows:[[0,1]]};if(t===3)return{orientation:"horizontal",rows:[[0],[1,2]]};if(t===4)return{orientation:"vertical",rows:[[0,1],[2,3]]};const r=3,n=[];for(let a=0;a<t;a+=r)n.push(Array.from({length:Math.min(r,t-a)},(s,i)=>a+i));return{orientation:"vertical",rows:n}}}function Ydt({panes:e,preset:t,gridOrientation:r="horizontal",sectionLayout:n="single-first",activePane:a,dragState:s,onPaneClose:i,onPaneActivate:l,onPaneStatusChange:c,onStartDrag:u,onUpdateDragTarget:d,onEndDrag:f,onCancelDrag:m,onSwapSections:p,onSwapPanes:v,onSwap2x2Rows:b}){const[y,S]=w.useState(null),_=y?e.filter(J=>J.id===y):e,N=y!==null,k=a||e[0]?.id||null,j=w.useRef(new Map),[E,T]=w.useState(0),O=w.useCallback(J=>(j.current.has(J)||j.current.set(J,ce.createRef()),j.current.get(J)),[]),R=w.useCallback(()=>{setTimeout(()=>{j.current.forEach(J=>{J.current?.refresh()})},200)},[]);w.useEffect(()=>{E>0&&R()},[E,R]);const H=w.useCallback((J,X)=>{v?.(J,X),T(V=>V+1)},[v]),$=w.useCallback(()=>{p?.(),T(J=>J+1)},[p]),L=w.useCallback(()=>{b?.(),T(J=>J+1)},[b]),A=w.useCallback(()=>{T(J=>J+1)},[]),M=w.useCallback(J=>{S(J)},[]),P=w.useCallback(()=>{S(null)},[]),I=w.useCallback((J,X)=>{J.dataTransfer.effectAllowed="move",J.dataTransfer.setData("text/plain",X),J.dataTransfer.setData("application/x-workspace-pane",X),u(X)},[u]),B=w.useCallback((J,X)=>{J.preventDefault(),J.dataTransfer.dropEffect="move",d(X)},[d]),F=w.useCallback((J,X)=>{J.preventDefault();let V=J.dataTransfer.getData("application/x-workspace-pane");if(!V){const de=J.dataTransfer.getData("text/plain");de&&de.startsWith("pane-")&&(V=de)}if(!V){m();return}const se=_[X];if(!se||se.id===V){m();return}v&&H(V,se.id),m()},[m,_,v,H]),q=w.useCallback(J=>X=>F(X,J),[F]),Q=w.useCallback(()=>{m()},[m]),W=w.useMemo(()=>Vdt(N?"single":t,_.length),[t,_.length,N]);if(e.length===0)return null;const G=J=>{const X=_[J];if(!X)return null;const V=s?.paneId===X.id,se=s!==null&&s.targetPosition===J&&!V;return o.jsx(Lte,{pane:X,paneRef:O(X.id),isActive:X.id===a,isMaximized:y===X.id,isSingleMode:t==="single"&&!N,isDragging:V,isDropTarget:se,onClose:()=>i(X.id),onMaximize:()=>M(X.id),onMinimize:P,onFocus:()=>l(X.id),onStatusChange:de=>c(X.id,de),onDragStart:de=>I(de,X.id),onDragOver:de=>B(de,J),onDrop:q(J),onDragEnd:Q},X.id)};if(_.length===1)return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:G(0)});if(t==="single"&&!N&&_.length>1){const J=_.findIndex(V=>V.id===k),X=J>=0?J:0;return o.jsxs("div",{className:"h-full w-full flex flex-col","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:[o.jsx("div",{className:"flex-shrink-0 flex items-center border-b border-[var(--color-border)] bg-[var(--color-surface)] overflow-x-auto",children:_.map((V,se)=>{const de=se===X,he=V.agentRole==="steward"?r0:na,te=Dte[V.agentRole]||Dte.worker;return o.jsxs("div",{className:`
                  group relative flex items-center gap-2 px-3 py-2 min-w-0
                  border-r border-[var(--color-border)]
                  cursor-pointer select-none
                  transition-colors duration-150
                  ${de?"bg-[var(--color-bg)] text-[var(--color-text)]":"bg-[var(--color-surface-hover)] text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-secondary)]"}
                `,onClick:()=>l(V.id),"data-testid":`workspace-tab-${V.id}`,children:[o.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${V.status==="connected"?"bg-green-500":V.status==="connecting"?"bg-yellow-500 animate-pulse":V.status==="error"?"bg-red-500":"bg-gray-400"}`}),o.jsx(he,{className:`w-3.5 h-3.5 flex-shrink-0 ${te}`}),o.jsx("span",{className:"truncate text-sm font-medium max-w-32",title:V.agentName,children:V.agentName}),o.jsx("button",{onClick:le=>{le.stopPropagation(),i(V.id)},className:`
                    p-0.5 rounded ml-1 flex-shrink-0
                    text-[var(--color-text-tertiary)]
                    hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20
                    opacity-0 group-hover:opacity-100
                    transition-all duration-150
                  `,title:"Close tab",children:o.jsx(yt,{className:"w-3 h-3"})}),de&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[var(--color-primary)]"})]},V.id)})}),o.jsx("div",{className:"flex-1 min-h-0 relative",children:_.map((V,se)=>{const de=se===X,he=s?.paneId===V.id,te=s!==null&&s.targetPosition===se&&!he;return o.jsx("div",{className:`
                  absolute inset-0
                  ${de?"visible z-10":"invisible z-0"}
                `,children:o.jsx(Lte,{pane:V,paneRef:O(V.id),isActive:V.id===a,isMaximized:!1,isSingleMode:!0,isDragging:he,isDropTarget:te,onClose:()=>i(V.id),onMaximize:()=>M(V.id),onMinimize:P,onFocus:()=>l(V.id),onStatusChange:le=>c(V.id,le),onDragStart:le=>I(le,V.id),onDragOver:le=>B(le,se),onDrop:q(se),onDragEnd:Q})},V.id)})})]})}if(!N&&t==="grid"&&_.length===3){const J=r==="horizontal",X=n==="single-first",V=X?0:2,se=X?[1,2]:[0,1];return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,"data-orientation":r,"data-section-layout":n,children:o.jsx(nd,{orientation:J?"horizontal":"vertical",id:"workspace-grid-3pane",onLayoutChange:A,children:X?o.jsxs(o.Fragment,{children:[o.jsx(xi,{id:"pane-single",defaultSize:50,minSize:15,children:G(V)}),o.jsx(ed,{orientation:J?"horizontal":"vertical",onSwap:$,swapTestId:"swap-sections-btn"}),o.jsx(xi,{id:"pane-paired",defaultSize:50,minSize:15,children:o.jsxs(nd,{orientation:J?"vertical":"horizontal",id:"workspace-grid-3pane-secondary",onLayoutChange:A,children:[o.jsx(xi,{id:"pane-paired-0",defaultSize:50,minSize:15,children:G(se[0])}),o.jsx(ed,{orientation:J?"vertical":"horizontal",onSwap:v?()=>H(_[se[0]].id,_[se[1]].id):void 0,swapTestId:"swap-panes-btn"}),o.jsx(xi,{id:"pane-paired-1",defaultSize:50,minSize:15,children:G(se[1])})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(xi,{id:"pane-paired",defaultSize:50,minSize:15,children:o.jsxs(nd,{orientation:J?"vertical":"horizontal",id:"workspace-grid-3pane-secondary",onLayoutChange:A,children:[o.jsx(xi,{id:"pane-paired-0",defaultSize:50,minSize:15,children:G(se[0])}),o.jsx(ed,{orientation:J?"vertical":"horizontal",onSwap:v?()=>H(_[se[0]].id,_[se[1]].id):void 0,swapTestId:"swap-panes-btn"}),o.jsx(xi,{id:"pane-paired-1",defaultSize:50,minSize:15,children:G(se[1])})]})}),o.jsx(ed,{orientation:J?"horizontal":"vertical",onSwap:$,swapTestId:"swap-sections-btn"}),o.jsx(xi,{id:"pane-single",defaultSize:50,minSize:15,children:G(V)})]})})})}if(W.orientation==="vertical"){const J=W.rows.length===2&&W.rows[0].length===2&&W.rows[1].length===2;return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:o.jsx(nd,{orientation:"vertical",id:`workspace-grid-${t}`,onLayoutChange:A,children:W.rows.map((X,V)=>o.jsxs(w.Fragment,{children:[V>0&&o.jsx(ed,{orientation:"vertical",onSwap:J&&b?L:v&&W.rows[V-1].length===1&&X.length===1?()=>H(_[W.rows[V-1][0]].id,_[X[0]].id):void 0,swapTestId:`swap-row-${V-1}-${V}-btn`,testId:J?"vertical-resize-handle":void 0}),o.jsx(xi,{id:`row-${V}`,defaultSize:100/W.rows.length,minSize:10,children:X.length===1?G(X[0]):o.jsx(nd,{orientation:"horizontal",id:`workspace-row-${V}`,onLayoutChange:A,children:X.map((se,de)=>o.jsxs(w.Fragment,{children:[de>0&&o.jsx(ed,{orientation:"horizontal",onSwap:H?()=>H(_[X[de-1]].id,_[se].id):void 0,swapTestId:`swap-col-${de-1}-${de}-btn`}),o.jsx(xi,{id:`col-${V}-${de}`,defaultSize:100/X.length,minSize:15,children:G(se)})]},`col-group-${de}`))})})]},`row-group-${V}`))})})}return o.jsx("div",{className:"h-full w-full","data-testid":"workspace-grid","data-preset":t,"data-pane-count":_.length,children:o.jsx(nd,{orientation:"horizontal",id:`workspace-grid-${t}`,onLayoutChange:A,children:W.rows.map((J,X)=>o.jsxs(w.Fragment,{children:[X>0&&o.jsx(ed,{orientation:"horizontal",onSwap:v&&W.rows[X-1].length===1&&J.length===1?()=>H(_[W.rows[X-1][0]].id,_[J[0]].id):void 0,swapTestId:`swap-col-${X-1}-${X}-btn`}),o.jsx(xi,{id:`col-${X}`,defaultSize:100/W.rows.length,minSize:15,children:J.length===1?G(J[0]):o.jsx(nd,{orientation:"vertical",id:`workspace-col-${X}`,onLayoutChange:A,children:J.map((V,se)=>o.jsxs(w.Fragment,{children:[se>0&&o.jsx(ed,{orientation:"vertical",onSwap:v?()=>H(_[J[se-1]].id,_[V].id):void 0,swapTestId:`swap-row-${se-1}-${se}-btn`}),o.jsx(xi,{id:`row-${X}-${se}`,defaultSize:100/J.length,minSize:15,children:G(V)})]},`row-group-${se}`))})})]},`col-group-${X}`))})})}const Qdt={director:Vr,worker:na,steward:r0},Jdt={director:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300"},worker:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300"},steward:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300"}};function Ote({agent:e,isExisting:t,onSelect:r}){const n=e.metadata?.agent,a=n?.agentRole??"worker",s=a==="worker"?n?.workerMode:void 0,i=Qdt[a],l=Jdt[a],c=n?.sessionStatus,u=c==="running";return o.jsxs("button",{onClick:r,disabled:t,className:`
        w-full flex items-center gap-3 p-3 rounded-lg text-left
        transition-colors duration-150
        ${t?"opacity-50 cursor-not-allowed bg-[var(--color-surface)]":"hover:bg-[var(--color-surface-hover)] cursor-pointer"}
      `,"data-testid":`agent-option-${e.id}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`p-2 rounded-lg ${l.bg}`,children:o.jsx(i,{className:`w-5 h-5 ${l.text}`})}),u&&o.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full bg-green-500 border-2 border-[var(--color-bg)]"})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium text-[var(--color-text)] truncate",children:e.name}),t&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-[var(--color-primary-muted)] text-[var(--color-primary)]",children:"In workspace"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-secondary)]",children:[o.jsx("span",{className:"capitalize",children:a}),s&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{className:"capitalize flex items-center gap-1",children:[s==="ephemeral"&&o.jsx(Sl,{className:"w-3 h-3"}),s]})]}),c&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:u?"text-green-600 dark:text-green-400":"",children:c})]})]})]})]})}function Zdt({isOpen:e,onClose:t,onSelectAgent:r,existingAgentIds:n=[]}){const[a,s]=w.useState(""),{persistentWorkers:i,ephemeralWorkers:l,stewards:c,isLoading:u,error:d}=g0();if(!e)return null;const m=[...i,...l,...c].filter(y=>y!=null).filter(y=>{const S=a.toLowerCase(),_=y.name.toLowerCase(),N=y.metadata?.agent?.agentRole?.toLowerCase()??"";return _.includes(S)||N.includes(S)}),p=m.filter(y=>y.metadata?.agent?.agentRole==="worker"),v=m.filter(y=>y.metadata?.agent?.agentRole==="steward"),b=y=>{r(y),t()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:t,"data-testid":"add-pane-backdrop"}),o.jsx("div",{className:`
          fixed inset-0 z-50
          flex items-center justify-center
          p-4
          pointer-events-none
        `,children:o.jsxs("div",{className:`
            w-full max-w-md
            bg-[var(--color-bg)]
            rounded-xl shadow-2xl
            border border-[var(--color-border)]
            animate-scale-in
            pointer-events-auto
          `,"data-testid":"add-pane-dialog",role:"dialog","aria-labelledby":"add-pane-title",children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:[o.jsx("h2",{id:"add-pane-title",className:"text-lg font-semibold text-[var(--color-text)]",children:"Add Terminal Pane"}),o.jsx("button",{onClick:t,className:`
                p-1.5 rounded-lg
                text-[var(--color-text-tertiary)]
                hover:text-[var(--color-text)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors
              `,"aria-label":"Close dialog","data-testid":"add-pane-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"px-4 py-3 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",value:a,onChange:y=>s(y.target.value),placeholder:"Search agents...",className:`
                  w-full pl-10 pr-4 py-2
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,"data-testid":"add-pane-search"})]})}),o.jsx("div",{className:"max-h-80 overflow-y-auto p-2","data-testid":"add-pane-list",children:u?o.jsx("div",{className:"flex items-center justify-center py-8 text-[var(--color-text-secondary)]",children:"Loading agents..."}):d?o.jsx("div",{className:"flex items-center justify-center py-8 text-red-500",children:"Failed to load agents"}):m.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-[var(--color-text-secondary)]",children:[o.jsx(ds,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:a?"No agents match your search":"No agents registered"})]}):o.jsxs("div",{className:"space-y-1",children:[p.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-2 py-1 mt-2 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Workers"}),p.map(y=>o.jsx(Ote,{agent:y,isExisting:n.includes(y.id),onSelect:()=>b(y)},y.id))]}),v.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"px-2 py-1 mt-2 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Stewards"}),v.map(y=>o.jsx(Ote,{agent:y,isExisting:n.includes(y.id),onSelect:()=>b(y)},y.id))]})]})})]})})]})}const YL=[{id:"single",icon:uu,label:"Single"},{id:"columns",icon:zwe,label:"Columns"},{id:"rows",icon:Bwe,label:"Rows"},{id:"grid",icon:Gae,label:"Grid"}];function Xdt(){const e=tl({from:"/workspaces"}),t=Ma(),[r,n]=w.useState(!1);w.useEffect(()=>{e.action==="addPane"&&(n(!0),t({to:"/workspaces",search:{layout:e.layout??"single",agent:void 0,resumeSessionId:void 0,resumePrompt:void 0},replace:!0}))},[e.action,e.layout,t]);const[a,s]=w.useState(!1),[i,l]=w.useState(!1),[c,u]=w.useState(""),{layout:d,activePane:f,hasPanes:m,paneCount:p,savedLayouts:v,dragState:b,addPane:y,removePane:S,setActivePane:_,updatePaneStatus:N,setLayoutPreset:k,saveLayout:j,loadLayout:E,deleteLayout:T,clearPanes:O,startDrag:R,updateDragTarget:H,endDrag:$,cancelDrag:L,rotateLayout:A,swapGridSections:M,swapPanes:P,swap2x2Rows:I}=ndt(),B=e.agent,{data:F}=fme(B??""),q=F?.agent,Q=w.useRef(null),W=w.useRef(null),G=TB();w.useEffect(()=>{if(q&&B&&Q.current!==B){const se=d.panes.find(he=>he.agentId===B);se?_(se.id):y(q),Q.current=B;const de=e.resumeSessionId;de&&W.current!==de&&(W.current=de,G.mutate({agentId:B,providerSessionId:de,resumePrompt:e.resumePrompt})),t({to:"/workspaces",search:{layout:e.layout??"single",agent:void 0,resumeSessionId:void 0,resumePrompt:void 0},replace:!0})}},[q,B,d.panes,y,_,t,e.layout,e.resumeSessionId,e.resumePrompt,G]);const J=YL.find(se=>se.id===d.preset)||YL[0],X=d.panes.map(se=>se.agentId),V=()=>{c.trim()&&(j(c.trim()),u(""),l(!1))};return o.jsxs("div",{className:"flex flex-col h-full animate-fade-in","data-testid":"workspaces-page",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(bh,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Workspaces"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)]",children:["Terminal multiplexer for agent sessions",p>0&&`  ${p} pane${p===1?"":"s"}`]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>s(!a),className:`
                flex items-center gap-2 px-3 py-2
                text-sm font-medium
                text-[var(--color-text-secondary)]
                rounded-md border border-[var(--color-border)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors duration-150
              `,"data-testid":"workspaces-layout-btn",children:[o.jsx(J.icon,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:J.label}),o.jsx(Yt,{className:"w-3.5 h-3.5 opacity-50"})]}),a&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),o.jsxs("div",{className:`
                    absolute right-0 top-full mt-1 z-20
                    min-w-48 py-1 rounded-md shadow-lg
                    bg-[var(--color-bg)] border border-[var(--color-border)]
                  `,"data-testid":"layout-menu",children:[o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Layout Presets"}),YL.map(se=>o.jsxs("button",{onClick:()=>{k(se.id),s(!1)},className:`
                        w-full flex items-center gap-2 px-3 py-2 text-left text-sm
                        ${d.preset===se.id?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}
                      `,"data-testid":`layout-preset-${se.id}`,children:[o.jsx(se.icon,{className:"w-4 h-4"}),se.label]},se.id)),v.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"my-1 border-t border-[var(--color-border)]"}),o.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text-tertiary)] uppercase tracking-wide",children:"Saved Layouts"}),v.map(se=>o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-[var(--color-surface-hover)]",children:[o.jsx("button",{onClick:()=>{E(se),s(!1)},className:"flex-1 text-left text-sm text-[var(--color-text-secondary)]",children:se.name}),o.jsx("button",{onClick:()=>T(se.id),className:"p-1 rounded text-[var(--color-text-tertiary)] hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",title:"Delete layout",children:o.jsx(pr,{className:"w-3.5 h-3.5"})})]},se.id))]}),m&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"my-1 border-t border-[var(--color-border)]"}),o.jsxs("button",{onClick:()=>{s(!1),l(!0)},className:"w-full flex items-center gap-2 px-3 py-2 text-left text-sm text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]",children:[o.jsx($x,{className:"w-4 h-4"}),"Save Current Layout"]})]}),m&&o.jsxs("button",{onClick:()=>{O(),s(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[o.jsx(pr,{className:"w-4 h-4"}),"Clear All Panes"]})]})]})]}),d.preset==="grid"&&p>=3&&o.jsxs("button",{onClick:A,className:`
                flex items-center gap-2 px-3 py-2
                text-sm font-medium
                text-[var(--color-text-secondary)]
                rounded-md border border-[var(--color-border)]
                hover:bg-[var(--color-surface-hover)]
                transition-colors duration-150
              `,title:"Rotate grid layout","data-testid":"workspaces-rotate-btn",children:[o.jsx(ose,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Rotate"})]}),o.jsxs("button",{onClick:()=>n(!0),className:`
              flex items-center gap-2 px-3 py-2
              text-sm font-medium text-white
              bg-[var(--color-primary)]
              rounded-md
              hover:bg-[var(--color-primary-hover)]
              transition-colors duration-150
            `,"data-testid":"workspaces-add-pane",children:[o.jsx(dr,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Add Pane"}),o.jsx("kbd",{className:"hidden sm:inline ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(zl("action.addPane"))})]})]})]}),o.jsx("div",{className:"flex-1 min-h-0 p-4 overflow-hidden",children:m?o.jsx(Ydt,{panes:d.panes,preset:d.preset,gridOrientation:d.gridOrientation,sectionLayout:d.sectionLayout,activePane:f,dragState:b,onPaneClose:S,onPaneActivate:_,onPaneStatusChange:N,onStartDrag:R,onUpdateDragTarget:H,onEndDrag:$,onCancelDrag:L,onSwapSections:M,onSwapPanes:P,onSwap2x2Rows:I}):o.jsxs("div",{className:`
              flex flex-col items-center justify-center
              h-full
              rounded-lg border-2 border-dashed border-[var(--color-border)]
              bg-[var(--color-bg-secondary)]
            `,"data-testid":"workspaces-empty",children:[o.jsx(bh,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4 opacity-50"}),o.jsx("h2",{className:"text-lg font-medium text-[var(--color-text)] mb-1",children:"No Terminal Panes"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-4 text-center max-w-sm",children:"Add panes to view and interact with your agent terminals side by side."}),o.jsxs("button",{onClick:()=>n(!0),className:`
                flex items-center gap-2 px-4 py-2
                text-sm font-medium text-white
                bg-[var(--color-primary)]
                rounded-md
                hover:bg-[var(--color-primary-hover)]
                transition-colors duration-150
              `,children:[o.jsx(dr,{className:"w-4 h-4"}),"Add Your First Pane"]})]})}),o.jsx(Zdt,{isOpen:r,onClose:()=>n(!1),onSelectAgent:y,existingAgentIds:X}),i&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-fade-in",onClick:()=>l(!1)}),o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:o.jsxs("div",{className:`
                w-full max-w-sm
                bg-[var(--color-bg)]
                rounded-xl shadow-2xl
                border border-[var(--color-border)]
                animate-scale-in
                pointer-events-auto
                p-4
              `,"data-testid":"save-layout-dialog",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)] mb-3",children:"Save Layout"}),o.jsx("input",{type:"text",value:c,onChange:se=>u(se.target.value),placeholder:"Layout name...",className:`
                  w-full px-3 py-2 mb-4
                  text-sm
                  bg-[var(--color-surface)]
                  border border-[var(--color-border)]
                  rounded-lg
                  placeholder:text-[var(--color-text-tertiary)]
                  focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
                `,autoFocus:!0,onKeyDown:se=>{se.key==="Enter"&&V(),se.key==="Escape"&&l(!1)}}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{onClick:()=>l(!1),className:`
                    px-3 py-2 text-sm font-medium
                    text-[var(--color-text-secondary)]
                    rounded-md
                    hover:bg-[var(--color-surface-hover)]
                  `,children:"Cancel"}),o.jsx("button",{onClick:V,disabled:!c.trim(),className:`
                    px-3 py-2 text-sm font-medium text-white
                    bg-[var(--color-primary)]
                    rounded-md
                    hover:bg-[var(--color-primary-hover)]
                    disabled:opacity-50 disabled:cursor-not-allowed
                  `,children:"Save"})]})]})})]})]})}function eft(){const e=tl({from:"/workflows"}),t=Ma(),r=e.tab||"templates",n=e.selected,[a,s]=w.useState(""),[i,l]=w.useState(!1),[c,u]=w.useState(null),[d,f]=w.useState(!1),[m,p]=w.useState(null);w.useEffect(()=>{e.action==="create"&&(f(!0),p(null),t({to:"/workflows",search:{tab:"templates",selected:void 0,action:void 0},replace:!0}))},[e.action,t]);const{data:v,isLoading:b,error:y,refetch:S}=KB(),_=v?.playbooks??[],{data:N,isLoading:k,error:j,refetch:E}=ynt(),T=N?.workflows??[],{workflow:O,tasks:R,progress:H,dependencies:$,isLoading:L,error:A}=Snt(n),M=w.useMemo(()=>T.filter(U=>U.status==="pending"||U.status==="running"),[T]),P=w.useMemo(()=>T.filter(U=>["completed","failed","cancelled"].includes(U.status)),[T]),I=knt(),B=_nt(),F=w.useMemo(()=>{const U=a.toLowerCase().trim();return U?_.filter(ge=>ge.name.toLowerCase().includes(U)||ge.title.toLowerCase().includes(U)):_},[a,_]),q=w.useMemo(()=>{const U=a.toLowerCase().trim();return U?M.filter(ge=>ge.title.toLowerCase().includes(U)):M},[a,M]),Q=w.useMemo(()=>{const U=a.toLowerCase().trim();return U?P.filter(ge=>ge.title.toLowerCase().includes(U)):P},[a,P]),W=U=>{t({to:"/workflows",search:{selected:e.selected,tab:U,action:void 0}})},G=U=>{u(U),l(!0)},J=U=>{console.log("Workflow created:",U.id,U.title),W("active")},X=()=>{p(null),f(!0)},V=U=>{p(U),f(!0)},se=()=>{S()},de=async U=>{try{await I.mutateAsync({workflowId:U,reason:"Cancelled by user"})}catch(ge){console.error("Failed to cancel workflow:",ge)}},he=async U=>{try{await B.mutateAsync({workflowId:U})}catch(ge){console.error("Failed to delete workflow:",ge)}},te=U=>{t({to:"/workflows",search:{tab:e.tab??"active",selected:U,action:void 0}})},le=()=>{t({to:"/workflows",search:{tab:e.tab??"active",selected:void 0,action:void 0}})},oe=r==="templates"?b:k,Z=r==="templates"?y:j,ve=r==="templates"?S:E;return n&&O?o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"workflow-detail-page",children:[o.jsx("div",{className:"flex items-center gap-4",children:o.jsxs("button",{onClick:le,className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"workflow-back-button",children:[o.jsx(Fx,{className:"w-4 h-4"}),"Back to Workflows"]})}),A&&o.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-5 h-5 text-red-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error loading workflow"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:A.message})]})]}),o.jsx(Ynt,{workflow:O,tasks:R,progress:H,dependencies:$,isLoading:L})]}):n&&L?o.jsx("div",{className:"flex items-center justify-center py-16",children:o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})}):o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"workflows-page",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(vh,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Workflows"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Manage workflow templates and active workflows"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>ve(),className:"flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-text-secondary)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors duration-150",title:"Refresh",children:o.jsx(jr,{className:`w-4 h-4 ${oe?"animate-spin":""}`})}),r==="templates"&&o.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"workflows-create",children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Template",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:nm(zl("action.createWorkflow"))})]})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:r==="templates"?"Search templates...":"Search workflows...",value:a,onChange:U=>s(U.target.value),className:"w-full pl-10 pr-4 py-2 text-sm text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"workflows-search"})]}),o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("nav",{className:"flex gap-4","aria-label":"Tabs",children:[o.jsxs("button",{onClick:()=>W("templates"),className:`pb-3 px-1 text-sm font-medium border-b-2 transition-colors ${r==="templates"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"workflows-tab-templates",children:["Templates",_.length>0&&o.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-[var(--color-primary-muted)] text-[var(--color-primary)]",children:_.length})]}),o.jsxs("button",{onClick:()=>W("active"),className:`pb-3 px-1 text-sm font-medium border-b-2 transition-colors ${r==="active"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"workflows-tab-active",children:["Active",M.length>0&&o.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400",children:M.length})]})]})}),Z&&o.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[o.jsx(Rt,{className:"w-5 h-5 text-red-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error loading data"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:Z.message})]}),o.jsx("button",{onClick:()=>ve(),className:"ml-auto px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",children:"Retry"})]}),oe&&o.jsx("div",{className:"flex items-center justify-center py-16","data-testid":"workflows-loading",children:o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin"})}),!oe&&!Z&&r==="templates"&&o.jsx(o.Fragment,{children:F.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(_d,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:a?"No matching templates":"No workflow templates"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:a?"Try adjusting your search query.":"Create workflow templates to define reusable sequences of tasks. Templates can be used to create active workflows."}),!a&&o.jsx("div",{className:"mt-4",children:o.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150","data-testid":"workflows-create-empty",children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Template"]})})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"playbooks-grid",children:F.map(U=>o.jsx(Ent,{playbook:U,onCreate:G,onEdit:V},U.id))})}),!oe&&!Z&&r==="active"&&o.jsx(o.Fragment,{children:q.length===0&&Q.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(vh,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:a?"No matching workflows":"No workflows"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:a?"Try adjusting your search query.":"Use a template to create a new workflow, or create an ad-hoc workflow."}),!a&&o.jsx("div",{className:"mt-4",children:o.jsxs("button",{onClick:()=>W("templates"),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)] transition-colors duration-150",children:[o.jsx(_d,{className:"w-4 h-4"}),"View Templates"]})})]}):o.jsxs("div",{className:"space-y-6",children:[q.length>0&&o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] mb-3",children:["Active (",q.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"active-workflows-grid",children:q.map(U=>o.jsx(fee,{workflow:U,onCancel:de,onDelete:he,onViewDetails:te},U.id))})]}),Q.length>0&&o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-medium text-[var(--color-text-secondary)] mb-3",children:["Recent (",Q.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"terminal-workflows-grid",children:Q.slice(0,9).map(U=>o.jsx(fee,{workflow:U,onCancel:de,onDelete:he,onViewDetails:te},U.id))}),Q.length>9&&o.jsxs("p",{className:"mt-4 text-sm text-[var(--color-text-secondary)] text-center",children:["Showing 9 of ",Q.length," completed workflows"]})]})]})}),o.jsx(Lnt,{isOpen:i,onClose:()=>{l(!1),u(null)},playbookId:c,onSuccess:J}),o.jsx(Fnt,{isOpen:d,onClose:()=>{f(!1),p(null)},playbookId:m,onSuccess:se})]})}const lp={open:"#3b82f6",in_progress:"#eab308",blocked:"#ef4444",closed:"#22c55e",review:"#8b5cf6",backlog:"#94a3b8"},tft={1:"#ef4444",2:"#f97316",3:"#eab308",4:"#3b82f6",5:"#6b7280"},nve=[{label:"Last 7 days",days:7},{label:"Last 14 days",days:14},{label:"Last 30 days",days:30}];function Ite(e,t){const r=new Date;return r.setDate(r.getDate()-t),r.setHours(0,0,0,0),e.filter(n=>{const a=n.metadata?.orchestrator?.completedAt||n.updatedAt;return new Date(a)>=r})}function rft(e){const t=new Date;return t.setHours(0,0,0,0),e.filter(r=>{const n=r.metadata?.orchestrator?.completedAt||r.updatedAt;return new Date(n)>=t}).length}function ave(e){if(e<6e4)return"<1m";const t=Math.floor(e/6e4);if(t<60)return`${t}m`;const r=Math.floor(t/60),n=t%60;return r<24?n>0?`${r}h ${n}m`:`${r}h`:`${Math.floor(r/24)}d ${r%24}h`}function nft(e){const t=e.filter(n=>{const a=n.metadata?.orchestrator;return a?.startedAt&&a?.completedAt});if(t.length===0)return"";const r=t.reduce((n,a)=>{const s=a.metadata?.orchestrator,i=new Date(s.startedAt).getTime(),l=new Date(s.completedAt).getTime();return n+Math.max(0,l-i)},0);return ave(r/t.length)}function cp({label:e,value:t,subtitle:r,icon:n,iconColor:a,trend:s,warning:i,testId:l}){return o.jsxs("div",{className:`p-4 rounded-lg border bg-[var(--color-card-bg)] transition-colors duration-150 ${i?"border-[var(--color-warning)] bg-[color-mix(in_srgb,var(--color-warning)_5%,var(--color-card-bg))]":"border-[var(--color-border)]"}`,"data-testid":l,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text-secondary)]",children:e}),o.jsx("div",{className:`p-1.5 rounded-md ${a}`,children:o.jsx(n,{className:"w-3.5 h-3.5"})})]}),o.jsx("div",{className:"mt-2 text-2xl font-bold text-[var(--color-text)] tabular-nums",children:t}),o.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:r}),s&&s.value!==0&&o.jsxs("span",{className:`inline-flex items-center gap-0.5 text-xs font-medium ${s.value>0?"text-[var(--color-success)]":"text-[var(--color-error)]"}`,children:[s.value>0?o.jsx(lse,{className:"w-3 h-3"}):o.jsx($we,{className:"w-3 h-3"}),s.value>0?"+":"",s.value,o.jsx("span",{className:"text-[var(--color-text-tertiary)] font-normal ml-0.5",children:s.label})]})]})]})}function aft({selected:e,onSelect:t}){const[r,n]=w.useState(!1),a=w.useRef(null);return w.useEffect(()=>{function s(i){a.current&&!a.current.contains(i.target)&&n(!1)}return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),o.jsxs("div",{className:"relative",ref:a,children:[o.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-[var(--color-text-secondary)] rounded-md border border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150","data-testid":"metrics-timerange",children:[o.jsx(Bx,{className:"w-4 h-4"}),e.label,o.jsx(Yt,{className:`w-3.5 h-3.5 transition-transform duration-150 ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"absolute right-0 mt-1 w-44 rounded-md border border-[var(--color-border)] bg-[var(--color-card-bg)] shadow-lg z-20",children:nve.map(s=>o.jsx("button",{onClick:()=>{t(s),n(!1)},className:`w-full text-left px-3 py-2 text-sm transition-colors duration-100 first:rounded-t-md last:rounded-b-md ${s.days===e.days?"bg-[var(--color-primary-muted)] text-[var(--color-primary)] font-medium":"text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,children:s.label},s.days))})]})}function ZS({title:e,icon:t}){return o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx(t,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("h2",{className:"text-sm font-semibold text-[var(--color-text-secondary)] uppercase tracking-wider",children:e})]})}function sft({plans:e,allTasks:t,isLoading:r}){const n=w.useMemo(()=>!e||e.length===0?[]:e.filter(a=>a.status!=="closed"&&a.status!=="completed").map(a=>{const s=t.filter(f=>f.tags?.includes(`plan:${a.id}`)||f.metadata?.planId===a.id),i=s.length,l=s.filter(f=>f.status==="closed").length,c=s.filter(f=>f.status==="in_progress").length,u=s.filter(f=>f.status==="blocked").length,d=i>0?Math.round(l/i*100):0;return{id:a.id,title:a.title,total:i,completed:l,inProgress:c,blocked:u,pct:d}}).filter(a=>a.total>0).sort((a,s)=>s.total-a.total).slice(0,8),[e,t]);return r?o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Plan Progress"}),o.jsx("div",{className:"space-y-3",children:[1,2,3].map(a=>o.jsxs("div",{className:"animate-pulse",children:[o.jsx("div",{className:"h-3 bg-[var(--color-surface-hover)] rounded w-1/3 mb-2"}),o.jsx("div",{className:"h-2 bg-[var(--color-surface-hover)] rounded w-full"})]},a))})]}):n.length===0?o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Plan Progress"}),o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-[var(--color-text-tertiary)]",children:[o.jsx(P6,{className:"w-8 h-8 mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:"No active plans with tasks"})]})]}):o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Plan Progress"}),o.jsx("div",{className:"space-y-4",children:n.map(a=>o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[o.jsx("span",{className:"text-sm text-[var(--color-text)] truncate max-w-[70%]",title:a.title,children:a.title}),o.jsxs("span",{className:"text-xs text-[var(--color-text-tertiary)] tabular-nums whitespace-nowrap ml-2",children:[a.completed,"/",a.total," (",a.pct,"%)"]})]}),o.jsxs("div",{className:"relative h-2 rounded-full bg-[var(--color-surface-hover)] overflow-hidden",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-[var(--color-success)] transition-all duration-500",style:{width:`${a.pct}%`}}),a.inProgress>0&&a.total>0&&o.jsx("div",{className:"absolute inset-y-0 rounded-full bg-[#eab308] opacity-70 transition-all duration-500",style:{left:`${a.pct}%`,width:`${Math.round(a.inProgress/a.total*100)}%`}}),a.blocked>0&&a.total>0&&o.jsx("div",{className:"absolute inset-y-0 rounded-full bg-[var(--color-error)] opacity-70 transition-all duration-500",style:{left:`${Math.round((a.completed+a.inProgress)/a.total*100)}%`,width:`${Math.round(a.blocked/a.total*100)}%`}})]}),(a.inProgress>0||a.blocked>0)&&o.jsxs("div",{className:"flex gap-3 mt-1",children:[a.inProgress>0&&o.jsxs("span",{className:"text-[10px] text-[#eab308]",children:[a.inProgress," in progress"]}),a.blocked>0&&o.jsxs("span",{className:"text-[10px] text-[var(--color-error)]",children:[a.blocked," blocked"]})]})]},a.id))})]})}function ift({counts:e,isLoading:t}){const r=[{label:"Needs Review",value:e.needsReview,color:"#eab308"},{label:"Testing",value:e.testing,color:"#3b82f6"},{label:"Conflicts",value:e.conflicts,color:"#ef4444"},{label:"Merged",value:e.merged,color:"#22c55e"}];return o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-4",children:"Merge Pipeline"}),t?o.jsx("div",{className:"space-y-3 animate-pulse",children:[1,2,3,4].map(n=>o.jsx("div",{className:"h-4 bg-[var(--color-surface-hover)] rounded"},n))}):o.jsx("div",{className:"space-y-3",children:r.map(n=>o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:n.color}}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:n.label})]}),o.jsx("span",{className:`text-sm font-semibold tabular-nums ${n.value>0?"text-[var(--color-text)]":"text-[var(--color-text-tertiary)]"}`,children:n.value})]},n.label))})]})}function oft({unassigned:e,blocked:t,inProgress:r,allTasks:n,isLoading:a}){const s=w.useMemo(()=>{if(e.length===0)return null;const u=e.reduce((f,m)=>new Date(f.createdAt)<new Date(m.createdAt)?f:m),d=Date.now()-new Date(u.createdAt).getTime();return ave(d)},[e]),i=w.useMemo(()=>{const u=n.filter(f=>f.status!=="closed"&&f.status!=="tombstone"&&f.status!=="backlog").length;if(u===0)return 100;let d=100;return d-=Math.min(40,t.length/Math.max(1,u)*100),d-=Math.min(30,e.length/Math.max(1,u)*60),Math.max(0,Math.round(d))},[n,t,e]),l=i>=80?"text-[var(--color-success)]":i>=50?"text-[#eab308]":"text-[var(--color-error)]",c=[{label:"Unassigned",value:e.length,warn:e.length>3},{label:"Blocked",value:t.length,warn:t.length>0},{label:"In Progress",value:r.length,warn:!1}];return o.jsxs("div",{className:"rounded-lg border border-[var(--color-border)] bg-[var(--color-card-bg)] p-4 sm:p-5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)]",children:"Queue Health"}),o.jsxs("span",{className:`text-lg font-bold tabular-nums ${l}`,children:[i,"%"]})]}),a?o.jsx("div",{className:"space-y-3 animate-pulse",children:[1,2,3].map(u=>o.jsx("div",{className:"h-4 bg-[var(--color-surface-hover)] rounded"},u))}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"space-y-3",children:c.map(u=>o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:u.label}),o.jsxs("span",{className:`text-sm font-semibold tabular-nums ${u.warn?"text-[var(--color-warning)]":"text-[var(--color-text)]"}`,children:[u.value,u.warn&&o.jsx(Bn,{className:"w-3 h-3 inline ml-1 -mt-0.5"})]})]},u.label))}),s&&o.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:"Oldest unassigned"}),o.jsxs("span",{className:"text-[var(--color-text-secondary)] font-medium tabular-nums",children:[s," ago"]})]})})]})]})}function lft(){const[e,t]=w.useState(nve[0]),{backlog:r,unassigned:n,assigned:a,inProgress:s,blocked:i,closed:l,awaitingMerge:c,allTasks:u,isLoading:d,error:f}=g1(),{data:m,isLoading:p,error:v}=m1(),b=m?.agents??[],{workers:y,stewards:S}=g0(),{data:_,isLoading:N}=zJe(),{counts:k,isLoading:j}=Ime(),E=d||p,T=!!(f||v),O=w.useMemo(()=>b.filter(Q=>Q.metadata?.agent?.sessionStatus==="running").length,[b]),R=b.length,H=w.useMemo(()=>Ite(l,e.days),[l,e.days]),$=w.useMemo(()=>rft(l),[l]),L=w.useMemo(()=>{const Q=H.length,W=Ite(l,e.days*2).length-Q;return{value:Q-W,label:"vs prev"}},[H,l,e.days]),A=w.useMemo(()=>nft(H),[H]),M=w.useMemo(()=>[{name:"Open",value:a.length,key:"open",color:lp.open},{name:"In Progress",value:s.length,key:"in_progress",color:lp.in_progress},{name:"Blocked",value:i.length,key:"blocked",color:lp.blocked},{name:"Completed",value:l.length,key:"closed",color:lp.closed},{name:"Review",value:c.length,key:"review",color:lp.review},{name:"Backlog",value:r.length,key:"backlog",color:lp.backlog}].filter(Q=>Q.value>0),[a.length,s.length,i.length,l.length,c.length,r.length]),P=w.useMemo(()=>{const Q=[],W=new Date,G=e.days;for(let J=G-1;J>=0;J--){const X=new Date(W);X.setDate(X.getDate()-J),X.setHours(0,0,0,0);const V=new Date(X);V.setDate(V.getDate()+1);const se=J===0?"Today":G<=7?X.toLocaleDateString("en-US",{weekday:"short"}):X.toLocaleDateString("en-US",{month:"short",day:"numeric"}),de=l.filter(he=>{const te=he.metadata?.orchestrator?.completedAt||he.updatedAt,le=new Date(te);return le>=X&&le<V}).length;Q.push({label:se,value:de,date:X.toISOString().split("T")[0]})}return Q},[l,e.days]),I=w.useMemo(()=>{const Q={};[...a,...s,...i].forEach(J=>{if(J.assignee){const V=b.find(se=>se.id===J.assignee)?.name||J.assignee.slice(0,8);Q[J.assignee]||(Q[J.assignee]={name:V,count:0}),Q[J.assignee].count++}});const G=Object.values(Q).reduce((J,{count:X})=>J+X,0);return Object.entries(Q).map(([J,{name:X,count:V}])=>({name:X,value:V,id:J,percentage:G>0?Math.round(V/G*100):0})).sort((J,X)=>X.value-J.value).slice(0,10)},[a,s,i,b]),B=w.useMemo(()=>{const Q={};H.forEach(G=>{const X=G.metadata?.orchestrator?.assignedAgent||G.assignee;if(X){const se=b.find(de=>de.id===X)?.name||X.slice(0,8);Q[X]||(Q[X]={name:se,count:0}),Q[X].count++}});const W=Object.values(Q).reduce((G,{count:J})=>G+J,0);return Object.entries(Q).map(([G,{name:J,count:X}])=>({name:J,value:X,id:G,percentage:W>0?Math.round(X/W*100):0})).sort((G,J)=>J.value-G.value).slice(0,10)},[H,b]),F=w.useMemo(()=>{const Q=u.filter(J=>J.status!=="closed"&&J.status!=="tombstone"),W={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Minimal"},G={};return Q.forEach(J=>{G[J.priority]=(G[J.priority]||0)+1}),Object.entries(G).map(([J,X])=>({name:W[Number(J)]||`P${J}`,value:X,key:`p${J}`,color:tft[Number(J)]||"#6b7280"})).filter(J=>J.value>0).sort((J,X)=>J.name.localeCompare(X.name))},[u]),q=w.useMemo(()=>{const Q={task:"Task",feature:"Feature",bug:"Bug",chore:"Chore"},W={task:"#3b82f6",feature:"#8b5cf6",bug:"#ef4444",chore:"#6b7280"},G={};return u.filter(J=>J.status!=="tombstone").forEach(J=>{G[J.taskType]=(G[J.taskType]||0)+1}),Object.entries(G).map(([J,X])=>({name:Q[J]||J,value:X,key:J,color:W[J]||"#6b7280"})).filter(J=>J.value>0).sort((J,X)=>X.value-J.value)},[u]);return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"metrics-page",children:[o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(QC,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Metrics"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Performance analytics and workspace health"})]})]}),o.jsx(aft,{selected:e,onSelect:t})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-3","data-testid":"stats-cards",children:[o.jsx(cp,{label:"Completed",value:H.length,subtitle:`${$} today`,icon:Yn,iconColor:"bg-[color-mix(in_srgb,var(--color-success)_15%,transparent)] text-[var(--color-success)]",trend:L,testId:"stat-tasks-completed"}),o.jsx(cp,{label:"Active Agents",value:`${O}/${R}`,subtitle:`${y.length} workers, ${S.length} stewards`,icon:ds,iconColor:"bg-[color-mix(in_srgb,var(--color-primary)_15%,transparent)] text-[var(--color-primary)]",testId:"stat-active-agents"}),o.jsx(cp,{label:"In Progress",value:s.length,subtitle:`${a.length} assigned total`,icon:Hh,iconColor:"bg-[color-mix(in_srgb,#eab308_15%,transparent)] text-[#eab308]",testId:"stat-in-progress"}),o.jsx(cp,{label:"Blocked",value:i.length,subtitle:`${n.length} unassigned`,icon:Bn,iconColor:"bg-[color-mix(in_srgb,var(--color-error)_15%,transparent)] text-[var(--color-error)]",warning:i.length>0,testId:"stat-blocked"}),o.jsx(cp,{label:"Avg Completion",value:A,subtitle:`${H.length} tasks measured`,icon:Rr,iconColor:"bg-[color-mix(in_srgb,var(--color-accent)_15%,transparent)] text-[var(--color-accent)]",testId:"stat-avg-time"}),o.jsx(cp,{label:"Merge Queue",value:c.length,subtitle:`${k.merged} merged total`,icon:Ps,iconColor:"bg-[color-mix(in_srgb,#8b5cf6_15%,transparent)] text-[#8b5cf6]",testId:"stat-merge-queue"})]}),o.jsxs("div",{children:[o.jsx(ZS,{title:"Activity & Distribution",icon:lse}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4","data-testid":"charts-grid-activity",children:[o.jsx(c6e,{data:P,title:`Task Completions (${e.label})`,testId:"tasks-completed-chart",isLoading:E,isError:T,errorMessage:"Failed to load completion data",emptyMessage:"No completions in this period",total:H.length,height:220}),o.jsx(CD,{data:M,title:"Task Status Distribution",testId:"task-distribution-chart",isLoading:E,isError:T,errorMessage:"Failed to load task data",emptyMessage:"No tasks to display",height:220}),o.jsx(CD,{data:q,title:"Tasks by Type",testId:"task-type-chart",isLoading:E,isError:T,errorMessage:"Failed to load type data",emptyMessage:"No tasks to display",height:220})]})]}),o.jsxs("div",{children:[o.jsx(ZS,{title:"Agent Performance",icon:Sl}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4","data-testid":"charts-grid-agents",children:[o.jsx(QY,{data:B,title:`Tasks Completed by Agent (${e.label})`,testId:"agent-performance-chart",isLoading:E,isError:T,errorMessage:"Failed to load performance data",emptyMessage:"No completed tasks in this period",barColor:"#22c55e",height:240,maxBars:8}),o.jsx(QY,{data:I,title:"Current Workload by Agent",testId:"workload-by-agent-chart",isLoading:E,isError:T,errorMessage:"Failed to load workload data",emptyMessage:"No assigned tasks",barColor:"#3b82f6",height:240,maxBars:8})]})]}),o.jsxs("div",{children:[o.jsx(ZS,{title:"Plans & Pipeline",icon:P6}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4","data-testid":"charts-grid-health",children:[o.jsx(sft,{plans:_??[],allTasks:u,isLoading:N||d}),o.jsx(oft,{unassigned:n,blocked:i,inProgress:s,allTasks:u,isLoading:d}),o.jsx(ift,{counts:k,isLoading:j})]})]}),o.jsxs("div",{children:[o.jsx(ZS,{title:"Priority Analysis",icon:Bn}),o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4","data-testid":"charts-grid-priority",children:o.jsx(CD,{data:F,title:"Open Tasks by Priority",testId:"priority-distribution-chart",isLoading:E,isError:T,errorMessage:"Failed to load priority data",emptyMessage:"No open tasks",height:220})})]})]})}function cft(){const e=tl({from:"/settings"}),t=Ma(),r=e.tab||"preferences",n=a=>{t({to:"/settings",search:{tab:a}})};return o.jsxs("div",{className:"space-y-6 animate-fade-in","data-testid":"settings-page",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Wa,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Settings"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Configure your preferences and workspace"})]})]}),o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("nav",{className:"flex gap-1","aria-label":"Settings tabs",children:[o.jsx("button",{onClick:()=>n("preferences"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="preferences"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"settings-tab-preferences",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(W6,{className:"w-4 h-4"}),"Preferences"]})}),o.jsx("button",{onClick:()=>n("workspace"),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors ${r==="workspace"?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":"settings-tab-workspace",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(a0,{className:"w-4 h-4"}),"Workspace"]})})]})}),r==="preferences"?o.jsx(uft,{}):o.jsx(hft,{})]})}function uft(){const{theme:e,notifications:t,agentDefaults:r}=Kpe(),n=jo();return o.jsxs("div",{className:"space-y-6 max-w-2xl","data-testid":"settings-preferences",children:[o.jsxs(Gc,{icon:W6,title:"Theme",description:"Choose how the interface looks",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(QL,{theme:"light",icon:e_,label:"Light",isActive:e.theme==="light",onClick:()=>e.setTheme("light")}),o.jsx(QL,{theme:"dark",icon:Xk,label:"Dark",isActive:e.theme==="dark",onClick:()=>e.setTheme("dark")}),o.jsx(QL,{theme:"system",icon:R6,label:"System",isActive:e.theme==="system",onClick:()=>e.setTheme("system")})]}),o.jsx("p",{className:"mt-2 text-xs text-[var(--color-text-tertiary)]",children:e.theme==="system"?`Currently using ${e.resolvedTheme} theme based on system preference`:`Using ${e.theme} theme`})]}),o.jsx(Gc,{icon:DO,title:"Notifications",description:"Configure how you receive alerts",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx(Sd,{label:"Task completion alerts",description:"Notify when tasks are completed",checked:t.settings.taskCompletion,onChange:a=>t.setSettings({taskCompletion:a}),testId:"settings-notify-task"}),o.jsx(Sd,{label:"Agent health warnings",description:"Notify when agents encounter issues",checked:t.settings.agentHealth,onChange:a=>t.setSettings({agentHealth:a}),testId:"settings-notify-health"}),o.jsx(Sd,{label:"Merge notifications",description:"Notify when branches are merged",checked:t.settings.mergeNotifications,onChange:a=>t.setSettings({mergeNotifications:a}),testId:"settings-notify-merge"}),o.jsx("div",{className:"pt-2 border-t border-[var(--color-border)]",children:o.jsx(Sd,{label:"Sound",description:"Play a sound when notifications arrive",checked:t.settings.sound,onChange:a=>t.setSettings({sound:a}),icon:t.settings.sound?Fwe:Uwe,testId:"settings-notify-sound"})}),o.jsxs("div",{className:"pt-2",children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Toast duration"}),o.jsxs("select",{value:t.settings.toastDuration,onChange:a=>t.setSettings({toastDuration:Number(a.target.value)}),className:"px-3 py-2 text-sm rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"settings-toast-duration",children:[o.jsx("option",{value:"3000",children:"3 seconds"}),o.jsx("option",{value:"5000",children:"5 seconds"}),o.jsx("option",{value:"10000",children:"10 seconds"}),o.jsx("option",{value:"0",children:"Don't auto-dismiss"})]})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{onClick:()=>t.resetToDefaults(),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"settings-notify-reset",children:[o.jsx(Ri,{className:"w-4 h-4"}),"Reset to defaults"]})})]})}),o.jsx(dft,{settings:r.settings,setSettings:r.setSettings,setDefaultModel:r.setDefaultModel,resetToDefaults:r.resetToDefaults}),o.jsx(Gc,{icon:Hwe,title:"Keyboard Shortcuts",description:"Quick access to common actions",children:o.jsx(sze,{defaults:ix,isMobile:n})})]})}function dft({settings:e,setSettings:t,setDefaultModel:r,resetToDefaults:n}){const{data:a}=g2(),s=w.useMemo(()=>a?.providers??[],[a?.providers]),i=w.useMemo(()=>s.length>0?s:[{name:"claude",available:!0,installInstructions:""},{name:"opencode",available:!0,installInstructions:""},{name:"codex",available:!0,installInstructions:""}],[s]);return o.jsx(Gc,{icon:Vr,title:"Agent Defaults",description:"Default provider and model for new agents",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"default-provider",className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Default Provider"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{id:"default-provider",value:e.defaultProvider,onChange:l=>t({defaultProvider:l.target.value}),className:"w-full px-3 py-2 pr-8 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] appearance-none focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"settings-default-provider",children:i.map(l=>o.jsxs("option",{value:l.name,disabled:!l.available,children:[VP[l.name]??l.name,l.available?"":" (not installed)"]},l.name))}),o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Provider used by default when creating new agents"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-2",children:"Default Model per Provider"}),o.jsx("div",{className:"space-y-3",children:i.filter(l=>l.available).map(l=>o.jsx(fft,{providerName:l.name,providerLabel:VP[l.name]??l.name,selectedModel:e.defaultModels[l.name]??"",onModelChange:c=>r(l.name,c)},l.name))}),o.jsx("p",{className:"mt-2 text-xs text-[var(--color-text-tertiary)]",children:"These models will be pre-selected when creating agents with the corresponding provider"})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"settings-agent-defaults-reset",children:[o.jsx(Ri,{className:"w-4 h-4"}),"Reset to defaults"]})})]})})}function fft({providerName:e,providerLabel:t,selectedModel:r,onModelChange:n}){const{data:a,isLoading:s}=v2(e),i=w.useMemo(()=>a?.models??[],[a?.models]),l=w.useMemo(()=>i.find(u=>u.isDefault),[i]),c=w.useMemo(()=>i.filter(u=>!u.isDefault),[i]);return o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-sm text-[var(--color-text)] w-24 flex-shrink-0 font-medium",children:t}),o.jsx("div",{className:"relative flex-1",children:s?o.jsxs("div",{className:"flex items-center gap-2 py-2 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),"Loading models..."]}):o.jsxs(o.Fragment,{children:[o.jsxs("select",{value:r,onChange:u=>n(u.target.value),className:"w-full px-3 py-1.5 pr-8 text-sm rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] appearance-none focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":`settings-default-model-${e}`,children:[o.jsx("option",{value:"",children:l?`Provider default (${l.displayName})`:"Provider default"}),c.map(u=>o.jsx("option",{value:u.id,children:u.providerName?`${u.displayName}  ${u.providerName}`:u.displayName},u.id))]}),o.jsx(Yt,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)] pointer-events-none"})]})})]})}function hft(){const{workspace:e,stewardSchedules:t,resetAllToDefaults:r}=Kpe(),[n,a]=w.useState(!1);return o.jsxs("div",{className:"space-y-6 max-w-2xl","data-testid":"settings-workspace",children:[o.jsx(Gc,{icon:cu,title:"Git Worktrees",description:"Configure how agent worktrees are managed",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Worktree directory"}),o.jsx("input",{type:"text",value:e.settings.worktreeDirectory,onChange:s=>e.setSettings({worktreeDirectory:s.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent",placeholder:".stoneforge/.worktrees/","data-testid":"settings-worktree-dir"}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Directory relative to workspace root where agent worktrees are created"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Default branch"}),o.jsx("input",{type:"text",value:e.settings.defaultBranch,onChange:s=>e.setSettings({defaultBranch:s.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent",placeholder:"main","data-testid":"settings-default-branch"}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Branch used as base for new worktrees"})]}),o.jsx(Sd,{label:"Auto-merge passing branches",description:"Automatically merge branches when tests pass",checked:e.settings.autoMerge,onChange:s=>e.setSettings({autoMerge:s}),testId:"settings-auto-merge"})]})}),o.jsx(Gc,{icon:Rr,title:"Ephemeral Tasks",description:"Configure temporary task retention",children:o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-[var(--color-text-secondary)] mb-1",children:"Retention period"}),o.jsxs("select",{value:e.settings.ephemeralRetention,onChange:s=>e.setSettings({ephemeralRetention:s.target.value}),className:"w-full px-3 py-2 rounded-md border border-[var(--color-border)] bg-[var(--color-input-bg)] text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent","data-testid":"settings-ephemeral-retention",children:[o.jsx("option",{value:"1h",children:"1 hour"}),o.jsx("option",{value:"6h",children:"6 hours"}),o.jsx("option",{value:"12h",children:"12 hours"}),o.jsx("option",{value:"24h",children:"24 hours"}),o.jsx("option",{value:"7d",children:"7 days"}),o.jsx("option",{value:"30d",children:"30 days"})]}),o.jsx("p",{className:"mt-1 text-xs text-[var(--color-text-tertiary)]",children:"Completed ephemeral tasks are automatically deleted after this period"})]})})}),o.jsx(Gc,{icon:Al,title:"Steward Schedules",description:"Configure automated steward execution",children:o.jsxs("div",{className:"space-y-4",children:[o.jsx(Sd,{label:"Merge Steward",description:"Automatically merges completed branches",checked:t.settings.mergeStewardEnabled,onChange:s=>t.setSettings({mergeStewardEnabled:s}),testId:"settings-merge-steward"}),o.jsx(Sd,{label:"Docs Steward",description:"Maintains and updates documentation",checked:t.settings.docsStewardEnabled,onChange:s=>t.setSettings({docsStewardEnabled:s}),testId:"settings-docs-steward"}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{onClick:()=>t.resetToDefaults(),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"settings-steward-reset",children:[o.jsx(Ri,{className:"w-4 h-4"}),"Reset to defaults"]})})]})}),o.jsx(mft,{}),o.jsx(Gc,{icon:pr,title:"Reset All Settings",description:"Reset all settings to their default values",variant:"danger",children:n?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Are you sure?"}),o.jsxs("button",{onClick:()=>{r(),a(!1)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 transition-opacity","data-testid":"settings-reset-confirm",children:[o.jsx(Vn,{className:"w-4 h-4"}),"Yes, Reset"]}),o.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] hover:text-[var(--color-text)] transition-colors","data-testid":"settings-reset-cancel",children:"Cancel"})]}):o.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-danger-text)] bg-[var(--color-danger-muted)] border border-[var(--color-danger)] rounded-md hover:bg-[var(--color-danger)] hover:text-white transition-colors","data-testid":"settings-reset-all",children:[o.jsx(Ri,{className:"w-4 h-4"}),"Reset All Settings"]})})]})}function mft(){const{data:e}=v1(),t=iZe(),r=e?.config?.directorInboxForwardingEnabled??!1;return o.jsx(Gc,{icon:oi,title:"Director",description:"Configure director agent behavior",children:o.jsx(Sd,{label:"Auto-forward inbox messages",description:"Forward new messages to the director's terminal when idle (120s debounce)",checked:r,onChange:n=>t.mutate({directorInboxForwardingEnabled:n}),testId:"settings-director-forwarding"})})}function Gc({icon:e,title:t,description:r,children:n,variant:a="default"}){const s=a==="danger"?"border-[var(--color-danger)]":"border-[var(--color-border)]",i=a==="danger"?"text-[var(--color-danger)]":"text-[var(--color-text-secondary)]";return o.jsxs("div",{className:`p-4 rounded-lg border ${s} bg-[var(--color-card-bg)]`,"data-testid":`settings-section-${t.toLowerCase().replace(/\s+/g,"-")}`,children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(e,{className:`w-5 h-5 ${i}`}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)]",children:t}),r&&o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:r})]})]}),n]})}function QL({theme:e,icon:t,label:r,isActive:n,onClick:a}){return o.jsxs("button",{onClick:a,className:`flex items-center gap-2 px-4 py-2 text-sm rounded-md border transition-colors ${n?"border-[var(--color-primary)] text-[var(--color-primary)] bg-[var(--color-primary-muted)]":"border-[var(--color-border)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}`,"data-testid":`settings-theme-${e}`,children:[o.jsx(t,{className:"w-4 h-4"}),r,n&&o.jsx(Vn,{className:"w-3 h-3"})]})}function Sd({label:e,description:t,checked:r,onChange:n,icon:a,testId:s}){return o.jsxs("label",{className:"flex items-center justify-between cursor-pointer group","data-testid":s,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a&&o.jsx(a,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm text-[var(--color-text)] group-hover:text-[var(--color-primary)]",children:e}),t&&o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:t})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"checkbox",checked:r,onChange:i=>n(i.target.checked),className:"sr-only peer","data-checked":r}),o.jsx("div",{className:"w-11 h-6 bg-[var(--color-surface-elevated)] peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-[var(--color-primary)] rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[var(--color-primary)]"})]})]})}const pft={disconnected:"bg-gray-400",connecting:"bg-yellow-500 animate-pulse",connected:"bg-green-500",error:"bg-red-500"},Rte={director:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",icon:na},worker:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",icon:na},steward:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",icon:r0}};function gft(){const e=tl({from:"/popout/terminal"}),t=e.agent,r=e.type||"terminal",n=e.name,a=e.role,s=e.mode,[i,l]=w.useState("disconnected"),{data:c,isLoading:u,error:d}=fme(t),{data:f}=MB(t),m=y2(),p=p1(),v=c?.agent,b=f?.hasActiveSession??!1,y=v?.metadata?.agent?.agentRole||a||"worker",S=v?.name||n||"Unknown Agent",_=v?.metadata?.agent?.workerMode||s;w.useEffect(()=>(S!=="Unknown Agent"&&(document.title=`Stoneforge | ${S} - Terminal`),()=>{document.title="Stoneforge"}),[S]);const N=async()=>{if(t)try{await m.mutateAsync({agentId:t,interactive:r==="terminal"})}catch(O){console.error("Failed to start session:",O)}},k=async()=>{if(t)try{await p.mutateAsync({agentId:t,graceful:!0})}catch(O){console.error("Failed to stop session:",O)}},j=w.useCallback(()=>{if(!t)return;const O={type:"pop-back-in",pane:{agentId:t,agentName:S,agentRole:y,workerMode:_,paneType:r}},R=new BroadcastChannel(R0e);R.postMessage(O),R.close(),window.close()},[t,S,y,_,r]);if(u&&!n)return o.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-[#1a1a1a]",children:o.jsxs("div",{className:"flex items-center gap-3 text-[var(--color-text-muted)]",children:[o.jsx(jr,{className:"w-5 h-5 animate-spin"}),o.jsx("span",{children:"Loading agent..."})]})});if(!t||d&&!n)return o.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-[#1a1a1a] p-6",children:[o.jsx(Rt,{className:"w-12 h-12 text-red-400 mb-4"}),o.jsx("h1",{className:"text-lg font-medium text-white mb-2",children:"Agent Not Found"}),o.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center max-w-md mb-6",children:t?"The specified agent could not be found.":"No agent ID provided."}),o.jsx("button",{onClick:()=>window.close(),className:`
            inline-flex items-center gap-2
            px-4 py-2 rounded-lg
            bg-[var(--color-surface)] border border-[var(--color-border)]
            text-[var(--color-text)]
            hover:bg-[var(--color-surface-hover)]
            transition-colors
          `,children:"Close Window"})]});const E=Rte[y]||Rte.worker,T=E.icon;return o.jsxs("div",{className:"h-screen w-screen flex flex-col bg-[#1a1a1a]",children:[o.jsxs("div",{className:`
        flex items-center justify-between
        px-4 py-2
        border-b border-[var(--color-border)]
        bg-[var(--color-surface)]
      `,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-2.5 h-2.5 rounded-full flex-shrink-0 ${b?pft[i]:"bg-gray-400"}`,title:b?i:"Session not running"}),o.jsxs("span",{className:`
            inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium
            ${E.bg} ${E.text}
          `,children:[o.jsx(T,{className:"w-3.5 h-3.5"}),y]}),o.jsx("span",{className:"text-sm font-mono text-[var(--color-text)]",children:S}),_&&o.jsx("span",{className:`
              px-2 py-1 rounded text-xs
              bg-[var(--color-surface-hover)] text-[var(--color-text-tertiary)]
            `,children:_})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:j,className:`
              inline-flex items-center gap-1.5
              px-3 py-1.5 rounded-md
              bg-[var(--color-surface-hover)] hover:bg-[var(--color-border)]
              text-[var(--color-text-secondary)] text-sm font-medium
              transition-colors
              border border-[var(--color-border)]
            `,title:"Return to Workspaces",children:[o.jsx(qwe,{className:"w-3.5 h-3.5"}),"Pop back in"]}),b?o.jsx("button",{onClick:k,disabled:p.isPending,className:`
                inline-flex items-center gap-1.5
                px-3 py-1.5 rounded-md
                bg-red-600 hover:bg-red-500
                text-white text-sm font-medium
                transition-colors
                disabled:opacity-50
              `,children:p.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}),"Stopping..."]}):o.jsxs(o.Fragment,{children:[o.jsx(uu,{className:"w-3.5 h-3.5"}),"Stop"]})}):o.jsx("button",{onClick:N,disabled:m.isPending,className:`
                inline-flex items-center gap-1.5
                px-3 py-1.5 rounded-md
                bg-green-600 hover:bg-green-500
                text-white text-sm font-medium
                transition-colors
                disabled:opacity-50
              `,children:m.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-3.5 h-3.5 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-3.5 h-3.5"}),"Start"]})})]})]}),o.jsxs("div",{className:"flex-1 min-h-0 relative",children:[r==="terminal"?o.jsx(EB,{agentId:t,onStatusChange:l,interactive:!0,autoFocus:!0,controlsResize:!0}):o.jsx(B0e,{agentId:t,agentName:S,onStatusChange:l}),!b&&o.jsxs("div",{className:`
              absolute inset-0 z-10
              flex flex-col items-center justify-center
              bg-[#1a1a1a]/95 backdrop-blur-sm
            `,children:[o.jsxs("div",{className:"relative mb-6",children:[o.jsx("div",{className:"absolute inset-0 bg-[var(--color-primary)]/20 blur-xl rounded-full scale-150"}),o.jsx("div",{className:`
                relative p-4 rounded-2xl
                bg-gradient-to-br from-[#252525] to-[#1a1a1a]
                border border-[#333]
                shadow-lg
              `,children:o.jsx(na,{className:"w-10 h-10 text-[var(--color-text-muted)]"})})]}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-1",children:"Session Idle"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-muted)] max-w-xs px-4",children:["Start a session to interact with ",S,"."]})]}),o.jsx("button",{onClick:N,disabled:m.isPending,className:`
                inline-flex items-center gap-2.5
                px-6 py-2.5 rounded-lg
                bg-gradient-to-r from-green-600 to-green-500
                hover:from-green-500 hover:to-green-400
                text-white font-medium text-sm
                shadow-lg shadow-green-500/25
                transition-all duration-200
                hover:scale-105 hover:shadow-green-500/40
                disabled:opacity-50 disabled:hover:scale-100 disabled:cursor-not-allowed
                focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 focus:ring-offset-[#1a1a1a]
              `,children:m.isPending?o.jsxs(o.Fragment,{children:[o.jsx(jr,{className:"w-4 h-4 animate-spin"}),"Starting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Yr,{className:"w-4 h-4"}),"Start Session"]})})]})]})]})}const JL=new Map;function T1({items:e,getItemKey:t,estimateSize:r,renderItem:n,overscan:a=5,className:s="",innerClassName:i="",scrollRestoreId:l,height:c,testId:u,renderEmpty:d,onScroll:f,gap:m=0}){const p=w.useRef(null),v=w.useRef(null),b=typeof r=="function"?r:()=>r,y=uj({count:e.length,getScrollElement:()=>p.current,estimateSize:N=>b(N)+(N<e.length-1?m:0),overscan:a,getItemKey:N=>t(e[N],N)});w.useEffect(()=>{if(l&&p.current){const N=JL.get(l);N!==void 0&&N>0&&requestAnimationFrame(()=>{y.scrollToOffset(N)})}},[l]),w.useEffect(()=>()=>{if(l&&p.current){const N=y.scrollOffset;N!==null&&N>0&&JL.set(l,N)}},[l,y]);const S=w.useCallback(()=>{v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{const N=y.scrollOffset;N!==null&&f&&f(N),l&&N!==null&&N>0&&JL.set(l,N)},100)},[y,f,l]);if(w.useEffect(()=>()=>{v.current&&clearTimeout(v.current)},[]),e.length===0)return o.jsx("div",{ref:p,className:s,style:c?{height:c}:void 0,"data-testid":u,children:d?d():o.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No items"})});const _=y.getVirtualItems();return o.jsx("div",{ref:p,className:`overflow-auto ${s}`,style:c?{height:c}:void 0,"data-testid":u,onScroll:S,tabIndex:0,role:"region","aria-label":"Scrollable list",children:o.jsx("div",{className:i,style:{height:y.getTotalSize(),width:"100%",position:"relative"},"data-testid":u?`${u}-inner`:void 0,children:_.map(N=>{const k=e[N.index];return o.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${N.start}px)`},"data-index":N.index,"data-testid":u?`${u}-item-${N.index}`:void 0,children:n(k,N.index,N)},N.key)})})})}const vft={today:"Today",yesterday:"Yesterday","this-week":"This Week",earlier:"Earlier"};function bft(e){const t=typeof e=="string"?new Date(e):e,r=new Date,n=new Date(r.getFullYear(),r.getMonth(),r.getDate()),a=new Date(n);a.setDate(a.getDate()-1);const s=new Date(n);return s.setDate(s.getDate()-6),t>=n?"today":t>=a?"yesterday":t>=s?"this-week":"earlier"}function yft(e,t){const r=[];let n=null;for(const a of e){const s=t(a),i=bft(s),l=i!==n;r.push({item:a,period:i,isFirstInGroup:l}),n=i}return r}function sve(e){const t=typeof e=="string"?new Date(e):e,n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"now":a<60?`${a}m`:s<24?`${s}h`:i<7?`${i}d`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function xft(e){const t=typeof e=="string"?new Date(e):e;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function wft(e){const t=typeof e=="string"?new Date(e):e,r=new Date,n=new Date(r.getFullYear(),r.getMonth(),r.getDate()),a=new Date(n);a.setDate(a.getDate()-1);const s=new Date(t.getFullYear(),t.getMonth(),t.getDate());return s.getTime()===n.getTime()?"Today":s.getTime()===a.getTime()?"Yesterday":t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}function Sft(e,t){const r=[];let n=null;for(const a of e){const s=t(a),i=xft(s),l=i!==n,c=l?wft(s):"";r.push({item:a,dateKey:i,formattedDate:c,isFirstInDay:l}),n=i}return r}const ive="stoneforge-inbox-page-view",ove="stoneforge-inbox-page-source-filter",lve="stoneforge-inbox-page-sort-order";function kft(){const e=localStorage.getItem(ive);return e==="unread"||e==="all"||e==="archived"?e:"unread"}function _ft(e){localStorage.setItem(ive,e)}function Nft(){const e=localStorage.getItem(ove);return e==="all"||e==="direct"||e==="mention"?e:"all"}function Cft(e){localStorage.setItem(ove,e)}function jft(){const e=localStorage.getItem(lve);return e==="newest"||e==="oldest"||e==="sender"?e:"newest"}function Eft(e){localStorage.setItem(lve,e)}function Mft(e="all",t){return pt({queryKey:["inbox",t,e],queryFn:async()=>{const r=new URLSearchParams({limit:"100",hydrate:"true"});e==="unread"?r.set("status","unread"):e==="archived"?r.set("status","archived"):r.set("status","unread,read"),t&&r.set("entityId",t);const n=await fetch(`/api/inbox/all?${r}`);if(!n.ok)throw new Error("Failed to fetch inbox");return n.json()},enabled:!!t,staleTime:0,refetchOnWindowFocus:"always"})}function Tft(e){return pt({queryKey:["inbox",e,"count"],queryFn:async()=>{const t=new URLSearchParams;e&&t.set("entityId",e);const r=await fetch(`/api/inbox/count?${t}`);if(!r.ok)throw new Error("Failed to fetch inbox count");return r.json()},enabled:!!e,staleTime:0,refetchOnWindowFocus:"always"})}function Aft(){const e=ft();return kt({mutationFn:async({itemId:t,status:r})=>{const n=await fetch(`/api/inbox/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:r})});if(!n.ok)throw new Error("Failed to update inbox item");return n.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["inbox"]})}})}function Dft(){const e=ft();return kt({mutationFn:async({channelId:t,sender:r,content:n,threadId:a})=>{const s=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channelId:t,sender:r,content:n,threadId:a})});if(!s.ok){const l=(await s.json().catch(()=>({})))?.error?.message||"Failed to send message";throw new Error(l)}return s.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["messages"]}),e.invalidateQueries({queryKey:["inbox"]}),r.threadId&&e.invalidateQueries({queryKey:["messages",r.threadId,"replies"]})}})}function Lft(e){return pt({queryKey:["messages",e,"replies"],queryFn:async()=>{if(!e)return[];const t=await fetch(`/api/messages/${e}/replies?hydrate.content=true`);if(!t.ok)throw new Error("Failed to fetch thread replies");const r=await t.json();return await Promise.all(r.map(async a=>{try{const s=await fetch(`/api/entities/${a.sender}`);if(s.ok){const i=await s.json();return{...a,_senderEntity:i}}}catch{}return a}))},enabled:!!e,staleTime:1e4})}function Oft({period:e}){return o.jsxs("div",{className:"sticky top-0 z-10 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center gap-2","data-testid":`inbox-page-time-period-${e}`,children:[o.jsx(Bx,{className:"w-3 h-3 text-gray-500"}),o.jsx("span",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:vft[e]})]})}function Ift({item:e,isSelected:t,onSelect:r,formattedTime:n}){const a=e.status==="unread",s=n??sve(e.createdAt),i=e.sender?.name??"Unknown",l=e.sender?.entityType??"agent",u=(e.message?.contentPreview??"").split(`
`)[0]?.slice(0,50)||"",d=e.threadParent!==null&&e.threadParent!==void 0,f=e.threadParent?.sender?.name??"Unknown",m=()=>{switch(l){case"agent":return o.jsx(Vr,{className:"w-3 h-3"});case"human":return o.jsx(tn,{className:"w-3 h-3"});case"system":return o.jsx(Id,{className:"w-3 h-3"});default:return o.jsx(tn,{className:"w-3 h-3"})}},p=()=>{switch(l){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}};return o.jsxs("button",{onClick:r,className:`w-full text-left px-3 py-2 flex items-start gap-2 transition-colors border-b border-gray-100 dark:border-gray-800 ${t?"bg-blue-50 dark:bg-blue-900/30 border-l-2 border-l-blue-500":a?"bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800":"bg-gray-50/50 dark:bg-gray-900/50 hover:bg-gray-100/50 dark:hover:bg-gray-800/50"}`,"data-testid":`inbox-page-list-item-${e.id}`,children:[o.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${p()}`,children:m()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("span",{className:`text-sm truncate ${a?"font-medium text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"}`,children:i}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500","data-testid":`inbox-page-list-item-time-${e.id}`,children:s}),a&&o.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500","data-testid":`inbox-page-list-item-unread-${e.id}`})]})]}),d&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mt-0.5","data-testid":`inbox-page-list-item-thread-${e.id}`,children:[o.jsx(cse,{className:"w-3 h-3"}),o.jsxs("span",{children:["Reply to ",f]})]}),e.recipient&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[o.jsx("span",{children:"To:"}),o.jsx("span",{className:"font-medium",children:e.recipient.name})]}),u&&o.jsx("p",{className:`text-xs truncate ${a?"text-gray-600 dark:text-gray-400":"text-gray-500 dark:text-gray-500"}`,children:u})]})]})}function Rft({item:e,onMarkRead:t,onMarkUnread:r,onArchive:n,onRestore:a,isPending:s,onNavigateToMessage:i,onNavigateToEntity:l,onReply:c,threadReplies:u,threadRepliesLoading:d,currentUserId:f}){const m=e.status==="unread",p=e.status==="archived",v=L=>new Date(L).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),b=L=>new Date(L).toLocaleString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit"}),y=L=>{const A=new Date(L),P=new Date().getTime()-A.getTime(),I=Math.floor(P/6e4),B=Math.floor(P/36e5),F=Math.floor(P/864e5);return I<1?"just now":I<60?`${I} minute${I===1?"":"s"} ago`:B<24?`${B} hour${B===1?"":"s"} ago`:F<7?`${F} day${F===1?"":"s"} ago`:""},S=e.sender?.name??"Unknown",_=e.sender?.entityType??"agent",N=e.sender?.id??e.message?.sender,k=e.channel?.name??e.channelId,j=e.message?.fullContent??e.message?.contentPreview??"",E=e.message?.contentType??"text",T=L=>{switch(L??_){case"agent":return o.jsx(Vr,{className:"w-5 h-5"});case"human":return o.jsx(tn,{className:"w-5 h-5"});case"system":return o.jsx(Id,{className:"w-5 h-5"});default:return o.jsx(tn,{className:"w-5 h-5"})}},O=L=>{switch(L??_){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}},R=y(e.createdAt),H=e.attachments&&e.attachments.length>0,$=e.threadParent!==null&&e.threadParent!==void 0;return o.jsxs("div",{className:"flex flex-col","data-testid":`inbox-page-message-content-${e.id}`,children:[o.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:()=>N&&l(N),className:`w-10 h-10 rounded-full flex items-center justify-center ${O()} hover:ring-2 hover:ring-blue-300 transition-all`,"data-testid":`inbox-page-content-avatar-${e.id}`,children:T()}),o.jsxs("div",{children:[o.jsx("button",{onClick:()=>N&&l(N),className:"text-sm font-medium text-gray-900 dark:text-gray-100 hover:text-blue-600 hover:underline","data-testid":`inbox-page-content-sender-${e.id}`,children:S}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("button",{onClick:i,className:"hover:text-blue-600 hover:underline","data-testid":`inbox-page-content-channel-${e.id}`,children:["#",k]}),o.jsx("span",{children:"*"}),o.jsx("span",{className:`inline-flex items-center gap-0.5 px-1.5 py-0.5 text-xs font-medium rounded ${e.sourceType==="mention"?"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300":"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300"}`,children:e.sourceType==="mention"?o.jsxs(o.Fragment,{children:[o.jsx(q6,{className:"w-3 h-3"}),"Mention"]}):o.jsxs(o.Fragment,{children:[o.jsx(oi,{className:"w-3 h-3"}),"Direct"]})})]})]})]}),o.jsx("div",{className:"flex items-center gap-1",children:s?o.jsx(Pe,{className:"w-4 h-4 animate-spin text-gray-400"}):o.jsxs(o.Fragment,{children:[!p&&c&&o.jsx("button",{onClick:c,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Reply","data-testid":`inbox-page-content-reply-${e.id}`,children:o.jsx(IO,{className:"w-4 h-4"})}),p?o.jsx("button",{onClick:a,className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/30 rounded transition-colors",title:"Restore","data-testid":`inbox-page-content-restore-${e.id}`,children:o.jsx(jr,{className:"w-4 h-4"})}):o.jsxs(o.Fragment,{children:[m?o.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Mark as read","data-testid":`inbox-page-content-mark-read-${e.id}`,children:o.jsx(ZC,{className:"w-4 h-4"})}):o.jsx("button",{onClick:r,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors",title:"Mark as unread","data-testid":`inbox-page-content-mark-unread-${e.id}`,children:o.jsx(JC,{className:"w-4 h-4"})}),o.jsx("button",{onClick:n,className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/30 rounded transition-colors",title:"Archive","data-testid":`inbox-page-content-archive-${e.id}`,children:o.jsx(H6,{className:"w-4 h-4"})})]})]})})]}),o.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 cursor-help",title:b(e.createdAt),"data-testid":`inbox-page-content-time-${e.id}`,children:[v(e.createdAt),R&&o.jsxs("span",{className:"ml-1",children:["(",R,")"]})]})]}),o.jsxs("div",{className:"flex-1",children:[$&&e.threadParent&&o.jsxs("div",{className:"mx-4 mt-4 p-3 bg-gray-50 dark:bg-gray-800 border-l-4 border-gray-300 dark:border-gray-600 rounded-r","data-testid":`inbox-page-content-thread-context-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-1",children:[o.jsx(cse,{className:"w-3 h-3"}),o.jsx("span",{children:"Reply to"})]}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("button",{onClick:()=>e.threadParent?.sender?.id&&l(e.threadParent.sender.id),className:`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${O(e.threadParent.sender?.entityType)} hover:ring-2 hover:ring-blue-300 transition-all`,children:T(e.threadParent.sender?.entityType)}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("button",{onClick:()=>e.threadParent?.sender?.id&&l(e.threadParent.sender.id),className:"text-xs font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 hover:underline",children:e.threadParent.sender?.name??"Unknown"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-0.5",children:e.threadParent.contentPreview||"No content"})]})]})]}),o.jsx("div",{className:"p-4",children:o.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none text-gray-700 dark:text-gray-300 whitespace-pre-wrap","data-testid":`inbox-page-content-body-${e.id}`,children:j||o.jsx("span",{className:"text-gray-400 italic",children:"No content"})})}),H&&o.jsxs("div",{className:"px-4 pb-4","data-testid":`inbox-page-content-attachments-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-2",children:[o.jsx(KC,{className:"w-3 h-3"}),o.jsxs("span",{children:[e.attachments.length," attachment",e.attachments.length!==1?"s":""]})]}),o.jsx("div",{className:"space-y-2",children:e.attachments.map(L=>o.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","data-testid":`inbox-page-content-attachment-${L.id}`,children:[o.jsx("div",{className:"flex items-start justify-between",children:o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx(rn,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate",children:L.title}),o.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 text-xs font-medium bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded",children:L.contentType??"text"})]})]})}),L.content&&o.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 line-clamp-3 whitespace-pre-wrap",children:[L.content.substring(0,200),L.content.length>200&&"..."]})]},L.id))})]}),u&&u.length>0&&o.jsxs("div",{className:"px-4 pb-4 border-t border-gray-200 dark:border-gray-700 mt-4 pt-4","data-testid":`inbox-page-content-thread-${e.id}`,children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-3",children:[o.jsx(oi,{className:"w-3 h-3"}),o.jsxs("span",{className:"font-medium",children:[u.length," ",u.length===1?"reply":"replies"," in thread"]})]}),o.jsx("div",{className:"space-y-3",children:u.map(L=>{const A=L.sender===f,M=L._senderEntity,P=M?.name??"Unknown",I=M?.entityType??"agent",B=()=>{switch(I){case"agent":return o.jsx(Vr,{className:"w-3 h-3"});case"human":return o.jsx(tn,{className:"w-3 h-3"});case"system":return o.jsx(Id,{className:"w-3 h-3"});default:return o.jsx(tn,{className:"w-3 h-3"})}},F=()=>{if(A)return"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-400";switch(I){case"agent":return"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-400";case"human":return"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400";case"system":return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400";default:return"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}},q=Q=>{const W=new Date(Q),J=new Date().getTime()-W.getTime(),X=Math.floor(J/6e4),V=Math.floor(J/36e5);return X<1?"just now":X<60?`${X}m ago`:V<24?`${V}h ago`:W.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return o.jsxs("div",{className:`flex gap-2 p-3 rounded-lg ${A?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700"}`,"data-testid":`inbox-page-thread-reply-${L.id}`,children:[o.jsx("button",{onClick:()=>L.sender&&l(L.sender),className:`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${F()} hover:ring-2 hover:ring-blue-300 transition-all`,children:B()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>L.sender&&l(L.sender),className:`text-xs font-medium hover:text-blue-600 hover:underline ${A?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300"}`,children:P}),A&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-green-200 dark:bg-green-800 text-green-700 dark:text-green-300 rounded font-medium",children:"You"})]}),o.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:q(L.createdAt)})]}),o.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:L._content??""})]})]},L.id)})})]}),d&&o.jsx("div",{className:"px-4 pb-4 border-t border-gray-200 dark:border-gray-700 mt-4 pt-4",children:o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),o.jsx("span",{children:"Loading thread..."})]})})]}),o.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:o.jsxs("button",{onClick:i,className:"text-sm text-blue-600 hover:text-blue-700 hover:underline flex items-center gap-1","data-testid":`inbox-page-content-view-in-channel-${e.id}`,children:["View in channel",o.jsx(gn,{className:"w-4 h-4"})]})})]})}function Pft(){return o.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-500","data-testid":"inbox-page-content-empty",children:[o.jsx(ni,{className:"w-12 h-12 mb-3"}),o.jsx("p",{className:"text-sm font-medium",children:"Select a message"}),o.jsx("p",{className:"text-xs mt-1",children:"Choose a message from the list to view its content"}),o.jsx("p",{className:"text-xs mt-3 text-gray-300 dark:text-gray-600",children:"Tip: Use J/K keys to navigate"})]})}function zft(){const e=Ma(),t=tl({strict:!1}),{currentUser:r,isLoading:n}=rl(),a=ft(),s=w.useRef(null),[i,l]=w.useState(()=>kft()),[c,u]=w.useState(()=>Nft()),[d,f]=w.useState(()=>jft()),[m,p]=w.useState(t.message||null),[v,b]=w.useState(null),[y,S]=w.useState(0),[_,N]=w.useState(""),[k,j]=w.useState(!1),E=w.useCallback(Z=>{if(Z.elementType==="inbox-item"&&Z.eventType==="created"&&Z.newValue?.recipientId===r?.id){const ge=Z.newValue?.sourceType==="mention"?"You were mentioned in a message":"You have a new direct message";Gr.info(ge,{description:"Click to view in inbox",action:{label:"View",onClick:()=>{p(null)}}})}},[r?.id]);w2({channels:r?.id?[`inbox:${r.id}`,"inbox","messages"]:["inbox","messages"],onEvent:E}),w.useEffect(()=>{r?.id&&s.current!==r.id&&(p(null),j(!1),N(""),a.invalidateQueries({queryKey:["inbox",r.id]}),s.current=r.id)},[r?.id,a]),w.useEffect(()=>{const Z=setInterval(()=>{S(ve=>ve+1)},6e4);return()=>clearInterval(Z)},[]);const{data:T,isLoading:O,isError:R,refetch:H}=Mft(i,r?.id??null),{data:$}=Tft(r?.id??null),L=Aft(),A=Dft(),M=w.useMemo(()=>!m||!T?.items?null:T.items.find(ve=>ve.id===m)?.messageId??null,[m,T?.items]),{data:P,isLoading:I}=Lft(M),B=w.useMemo(()=>{if(!T?.items)return[];let Z=[...T.items];return c==="direct"?Z=Z.filter(ve=>ve.sourceType==="direct"):c==="mention"&&(Z=Z.filter(ve=>ve.sourceType==="mention")),d==="newest"?Z.sort((ve,U)=>new Date(U.createdAt).getTime()-new Date(ve.createdAt).getTime()):d==="oldest"?Z.sort((ve,U)=>new Date(ve.createdAt).getTime()-new Date(U.createdAt).getTime()):d==="sender"&&Z.sort((ve,U)=>(ve.sender?.name??"").localeCompare(U.sender?.name??"")),Z},[T,c,d]),F=w.useMemo(()=>yft(B,Z=>new Date(Z.createdAt)),[B]),q=w.useMemo(()=>B.find(Z=>Z.id===m)||null,[B,m]),Q=w.useCallback(Z=>{l(Z),_ft(Z),p(null)},[]),W=w.useCallback(Z=>{u(Z),Cft(Z)},[]),G=w.useCallback(Z=>{f(Z),Eft(Z)},[]),J=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"read"},{onSettled:()=>b(null)})},[L]),X=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"unread"},{onSettled:()=>b(null)})},[L]),V=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"archived"},{onSuccess:()=>{const ve=B.findIndex(ge=>ge.id===Z),U=B[ve+1]||B[ve-1];p(U?.id||null)},onSettled:()=>b(null)})},[L,B]),se=w.useCallback(Z=>{b(Z),L.mutate({itemId:Z,status:"read"},{onSettled:()=>b(null)})},[L]),de=w.useCallback((Z,ve)=>{console.log(`Navigate to channel: ${Z}`)},[]),he=w.useCallback(Z=>{e({to:"/agents",search:{selected:Z,tab:"agents",role:void 0}})},[e]),te=w.useCallback(Z=>{const ve=B.findIndex(ge=>ge.id===m);let U=ve;Z==="next"?U=ve<B.length-1?ve+1:ve:U=ve>0?ve-1:0,U!==ve&&B[U]&&p(B[U].id)},[B,m]);w.useEffect(()=>{const Z=ve=>{ve.target instanceof HTMLInputElement||ve.target instanceof HTMLTextAreaElement||(ve.key==="j"||ve.key==="J"?te("next"):(ve.key==="k"||ve.key==="K")&&te("prev"))};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[te]);const le=jo(),oe=w.useCallback(async()=>{if(!(!_.trim()||!q||!r))try{await A.mutateAsync({channelId:q.channelId,sender:r.id,content:_.trim(),threadId:q.messageId}),N(""),j(!1)}catch(Z){console.error("Failed to send reply:",Z)}},[_,q,r,A]);return!n&&!r?o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-bg)]","data-testid":"inbox-page",children:[o.jsx(GP,{title:"Inbox",icon:ni,iconColor:"text-blue-500",subtitle:"No user selected",bordered:!0,testId:"inbox-header"}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[o.jsx(tn,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{className:"text-lg font-medium",children:"No user selected"}),o.jsx("p",{className:"text-sm mt-1",children:"Select a user from the header dropdown to view their inbox"})]})})]}):o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-bg)]","data-testid":"inbox-page",children:[o.jsx(GP,{title:r?`${r.name}'s Inbox`:"Inbox",icon:ni,iconColor:"text-blue-500",subtitle:$?.count!==void 0&&$.count>0?`${$.count} unread`:"No unread messages",bordered:!0,testId:"inbox-header",children:o.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1 w-fit",children:[o.jsxs("button",{onClick:()=>Q("unread"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${i==="unread"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,"data-testid":"inbox-page-tab-unread",children:["Unread",$?.count!==void 0&&$.count>0&&o.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-full",children:$.count})]}),o.jsx("button",{onClick:()=>Q("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${i==="all"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,"data-testid":"inbox-page-tab-all",children:"All"}),o.jsx("button",{onClick:()=>Q("archived"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${i==="archived"?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100"}`,"data-testid":"inbox-page-tab-archived",children:"Archived"})]})}),o.jsxs("div",{className:`flex items-center justify-between ${le?"px-3":"px-6"} py-2 border-b border-[var(--color-border)] bg-gray-50 dark:bg-gray-900/50`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ru,{className:"w-4 h-4 text-gray-400"}),o.jsxs("select",{value:c,onChange:Z=>W(Z.target.value),className:"text-sm bg-transparent border-none text-gray-600 dark:text-gray-400 cursor-pointer focus:outline-none","data-testid":"inbox-page-source-filter",children:[o.jsx("option",{value:"all",children:"All sources"}),o.jsx("option",{value:"direct",children:"Direct messages"}),o.jsx("option",{value:"mention",children:"Mentions"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(t0,{className:"w-4 h-4 text-gray-400"}),o.jsxs("select",{value:d,onChange:Z=>G(Z.target.value),className:"text-sm bg-transparent border-none text-gray-600 dark:text-gray-400 cursor-pointer focus:outline-none","data-testid":"inbox-page-sort-order",children:[o.jsx("option",{value:"newest",children:"Newest first"}),o.jsx("option",{value:"oldest",children:"Oldest first"}),o.jsx("option",{value:"sender",children:"By sender"})]})]})]}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"w-2/5 border-r border-[var(--color-border)] overflow-hidden flex flex-col bg-white dark:bg-gray-900","data-testid":"inbox-page-message-list",children:[O?o.jsxs("div",{className:"flex items-center justify-center p-8",children:[o.jsx(Pe,{className:"w-6 h-6 animate-spin text-gray-400"}),o.jsx("span",{className:"ml-2 text-gray-500",children:"Loading inbox..."})]}):R?o.jsxs("div",{className:"text-center py-8 px-4","data-testid":"inbox-page-error",children:[o.jsx(Rt,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Failed to load inbox"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1 mb-3",children:"There was an error loading your messages"}),o.jsxs("button",{onClick:()=>H(),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded transition-colors","data-testid":"inbox-page-retry",children:[o.jsx(jr,{className:"w-3 h-3"}),"Retry"]})]}):!T||T.items.length===0?o.jsxs("div",{className:"text-center py-8 px-4","data-testid":"inbox-page-empty",children:[o.jsx(ni,{className:"w-10 h-10 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),o.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:i==="unread"?"No unread messages":i==="archived"?"No archived messages":"Your inbox is empty"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 max-w-xs mx-auto",children:i==="archived"?"Archived messages will appear here":"Direct messages and @mentions will appear here when other entities message you"}),i==="unread"&&o.jsx("button",{onClick:()=>Q("all"),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View all messages"})]}):B.length===0?o.jsxs("div",{className:"text-center py-8 px-4","data-testid":"inbox-page-filtered-empty",children:[o.jsx(ru,{className:"w-8 h-8 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No messages match your filters"}),o.jsx("button",{onClick:()=>W("all"),className:"mt-2 text-xs font-medium text-blue-600 hover:text-blue-700",children:"Clear filters"})]}):o.jsx(T1,{items:F,getItemKey:Z=>Z.item.id,estimateSize:Z=>F[Z]?.isFirstInGroup&&d!=="sender"?100:72,height:"100%",testId:"inbox-page-items-list",renderItem:Z=>o.jsxs(o.Fragment,{children:[Z.isFirstInGroup&&d!=="sender"&&o.jsx(Oft,{period:Z.period}),o.jsx(Ift,{item:Z.item,isSelected:m===Z.item.id,onSelect:()=>p(Z.item.id),formattedTime:sve(Z.item.createdAt)},`${Z.item.id}-${y}`)]})}),T&&T.items.length>0&&o.jsx("div",{className:"text-center text-xs text-gray-500 dark:text-gray-400 py-2 border-t border-gray-100 dark:border-gray-800",children:c!=="all"?o.jsxs(o.Fragment,{children:["Showing ",B.length," of ",T.items.length," (filtered)"]}):T.hasMore?o.jsxs(o.Fragment,{children:["Showing ",T.items.length," of ",T.total," items"]}):o.jsxs(o.Fragment,{children:[T.items.length," ",T.items.length===1?"item":"items"]})})]}),o.jsx("div",{className:"flex-1 overflow-hidden bg-white dark:bg-gray-900 flex flex-col","data-testid":"inbox-page-message-content-panel",children:q?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-1 overflow-auto",children:o.jsx(Rft,{item:q,onMarkRead:()=>J(q.id),onMarkUnread:()=>X(q.id),onArchive:()=>V(q.id),onRestore:()=>se(q.id),isPending:v===q.id,onNavigateToMessage:()=>de(q.channelId,q.messageId),onNavigateToEntity:he,onReply:()=>j(!k),threadReplies:P,threadRepliesLoading:I,currentUserId:r?.id})}),k&&q.status!=="archived"&&o.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-800","data-testid":"inbox-reply-composer",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs text-gray-500 dark:text-gray-400",children:[o.jsx(IO,{className:"w-3 h-3"}),o.jsxs("span",{children:["Replying as ",o.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:r?.name})," to ",q.sender?.name??"Unknown"]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("textarea",{value:_,onChange:Z=>N(Z.target.value),placeholder:"Write your reply...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3,"data-testid":"inbox-reply-textarea",onKeyDown:Z=>{Z.key==="Enter"&&(Z.metaKey||Z.ctrlKey)&&oe()}}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("button",{onClick:oe,disabled:!_.trim()||A.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2","data-testid":"inbox-reply-send",children:[A.isPending?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(IO,{className:"w-4 h-4"}),"Send"]}),o.jsx("button",{onClick:()=>{j(!1),N("")},className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 rounded-lg transition-colors","data-testid":"inbox-reply-cancel",children:"Cancel"})]})]}),A.isError&&o.jsx("p",{className:"mt-2 text-xs text-red-500","data-testid":"inbox-reply-error",children:A.error instanceof Error?A.error.message:"Failed to send reply. Please try again."}),o.jsxs("p",{className:"mt-2 text-xs text-gray-400",children:["Press ",navigator.platform.includes("Mac")?"Cmd":"Ctrl","+Enter to send"]})]})]}):o.jsx(Pft,{})})]})]})}function Bft({channel:e}){return e.channelType==="direct"?o.jsx(ds,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}):e.permissions.visibility==="private"?o.jsx(GC,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}):o.jsx(qp,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})}function $ft({channel:e,isSelected:t,onClick:r,isMobile:n=!1}){return o.jsxs("button",{"data-testid":`channel-item-${e.id}`,onClick:r,className:`w-full flex items-center gap-2 sm:gap-2 rounded-md text-left transition-colors touch-target ${n?"px-4 py-3 gap-3":"px-3 py-2"} ${t?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx(Bft,{channel:e}),o.jsx("span",{className:`truncate font-medium ${n?"text-base":"text-sm"}`,children:e.name}),o.jsx("span",{className:`ml-auto text-gray-400 ${n?"text-sm":"text-xs"}`,children:e.members.length})]})}const Fft=36,Uft=48,Hft=28;function Pte({channels:e,selectedChannelId:t,onSelectChannel:r,onNewChannel:n,totalChannels:a,searchQuery:s,onSearchChange:i,isMobile:l=!1}){const c=e.filter(v=>v.channelType==="group"),u=e.filter(v=>v.channelType==="direct"),d=[];c.length>0&&(d.push({type:"header",label:"Channels",key:"header-group"}),c.forEach(v=>{d.push({type:"channel",channel:v,key:v.id})})),u.length>0&&(d.push({type:"header",label:"Direct Messages",key:"header-direct"}),u.forEach(v=>{d.push({type:"channel",channel:v,key:v.id})}));const f=l?Uft:Fft,m=v=>d[v].type==="header"?Hft:f,p=v=>v.type==="header"?o.jsx("div",{"data-testid":v.key==="header-group"?"channel-group-label":"channel-direct-label",className:`px-3 py-1 font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider ${l?"text-sm":"text-xs"}`,children:v.label}):o.jsx($ft,{channel:v.channel,isSelected:t===v.channel.id,onClick:()=>r(v.channel.id),isMobile:l});return o.jsxs("div",{"data-testid":"channel-list",className:`flex flex-col h-full bg-white dark:bg-[var(--color-bg)] ${l?"w-full":"w-64 border-r border-[var(--color-border)]"}`,children:[o.jsxs("div",{className:`border-b border-[var(--color-border)] ${l?"p-4 pt-2":"p-4"}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h2",{className:`font-semibold text-[var(--color-text)] ${l?"text-xl":"text-lg"} flex items-center gap-2`,children:[o.jsx(oi,{className:`${l?"w-4 h-4":"w-5 h-5"} text-blue-500`}),"Channels"]}),o.jsx("button",{onClick:n,className:`text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded transition-colors ${l?"p-2 touch-target":"p-1.5"}`,title:"New Channel","data-testid":"new-channel-button-sidebar",children:o.jsx(dr,{className:l?"w-6 h-6":"w-5 h-5"})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:`absolute top-1/2 -translate-y-1/2 text-gray-400 ${l?"left-3 w-5 h-5":"left-2.5 w-4 h-4"}`}),o.jsx("input",{type:"text",value:s,onChange:v=>i(v.target.value),placeholder:l?"Search...":"Search channels...",className:`w-full border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-[var(--color-surface)] text-[var(--color-text)] ${l?"pl-10 pr-4 py-2.5 text-base":"pl-8 pr-3 py-1.5 text-sm"}`,"data-testid":"channels-search-input"})]})]}),o.jsx("div",{className:"flex-1 min-h-0",children:e.length===0?o.jsxs("div",{"data-testid":"channel-empty-state",className:`text-center text-gray-500 dark:text-gray-400 ${l?"py-12":"py-8"}`,children:[o.jsx(oi,{className:`mx-auto mb-3 text-gray-300 dark:text-gray-600 ${l?"w-16 h-16":"w-12 h-12"}`}),o.jsx("p",{className:l?"text-base":"text-sm",children:s?"No channels match your search":"No channels yet"}),!s&&o.jsx("button",{onClick:n,className:`mt-3 text-blue-600 hover:text-blue-700 hover:underline ${l?"text-base py-2 px-4":"text-sm"}`,"data-testid":"new-channel-button-empty",children:"Create one"})]}):o.jsx(T1,{items:d,getItemKey:v=>v.key,estimateSize:m,renderItem:p,overscan:10,className:"h-full p-2",scrollRestoreId:"channel-list",testId:"channel-list-virtualized"})}),!l&&o.jsxs("div",{"data-testid":"channel-count",className:"p-3 border-t border-gray-200 dark:border-[var(--color-border)] text-xs text-gray-500 dark:text-gray-400",children:[a," ",a===1?"channel":"channels"]})]})}function qft({isMobile:e=!1}){return o.jsx("div",{"data-testid":"channel-placeholder",className:`flex-1 flex items-center justify-center bg-[var(--color-surface)] ${e?"hidden":""}`,children:o.jsxs("div",{className:"text-center px-4",children:[o.jsx(oi,{className:"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-1",children:"Select a channel"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose a channel from the sidebar to view messages"})]})})}const Wft=100;function cve({items:e,getItemKey:t,estimateSize:r,renderItem:n,overscan:a=5,className:s="",innerClassName:i="",scrollRestoreId:l,testId:c,renderEmpty:u,gap:d=8,onScrollToTop:f,isLoadingMore:m=!1,hasMore:p=!1,loadMoreThreshold:v=100,latestMessageId:b,onNewMessageWhileScrolledUp:y}){const S=w.useRef(null),[_,N]=w.useState(!0),[k,j]=w.useState(!1),E=w.useRef(b),T=w.useRef(!0),O=w.useRef(null),R=typeof r=="function"?r:()=>r,H=uj({count:e.length,getScrollElement:()=>S.current,estimateSize:I=>R(I)+(I<e.length-1?d:0),overscan:a,getItemKey:I=>t(e[I],I),measureElement:I=>I.getBoundingClientRect().height}),$=w.useCallback(()=>{if(!S.current)return!1;const{scrollTop:I,scrollHeight:B,clientHeight:F}=S.current;return B-I-F<Wft},[]),L=w.useCallback(()=>S.current?S.current.scrollTop<v:!1,[v]),A=w.useCallback((I="smooth")=>{S.current&&(S.current.scrollTo({top:S.current.scrollHeight,behavior:I}),N(!0),j(!1))},[]),M=w.useCallback(()=>{O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{const I=$(),B=L();N(I),j(!I&&e.length>0),B&&p&&!m&&f&&f()},50)},[$,L,p,m,f,e.length]);if(w.useEffect(()=>()=>{O.current&&clearTimeout(O.current)},[]),w.useEffect(()=>{T.current&&e.length>0&&requestAnimationFrame(()=>{A("instant"),T.current=!1})},[e.length,A]),w.useEffect(()=>{if(T.current){E.current=b;return}b!==E.current&&(E.current=b,_?requestAnimationFrame(()=>{A("smooth")}):(j(!0),y&&y()))},[b,_,A,y]),e.length===0&&!m)return o.jsx("div",{ref:S,className:`h-full ${s}`,"data-testid":c,children:u?u():o.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No messages"})});const P=H.getVirtualItems();return o.jsxs("div",{className:"relative h-full",children:[m&&o.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 flex justify-center py-2 bg-gradient-to-b from-white to-transparent","data-testid":`${c}-loading-more`,children:o.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Loading older messages..."]})}),o.jsx("div",{ref:S,className:`overflow-auto h-full ${s}`,"data-testid":c,onScroll:M,tabIndex:0,role:"log","aria-live":"polite","aria-label":"Messages",children:o.jsx("div",{className:i,style:{height:H.getTotalSize(),width:"100%",position:"relative"},"data-testid":c?`${c}-inner`:void 0,children:P.map(I=>{const B=e[I.index];return o.jsx("div",{ref:H.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${I.start}px)`},"data-index":I.index,"data-testid":c?`${c}-item-${I.index}`:void 0,children:n(B,I.index,I)},I.key)})})}),k&&o.jsxs("button",{onClick:()=>A("smooth"),className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-20 flex items-center gap-1.5 px-4 py-2 bg-blue-500 text-white text-sm font-medium rounded-full shadow-lg hover:bg-blue-600 transition-all hover:shadow-xl","data-testid":`${c}-jump-to-latest`,"aria-label":"Jump to latest messages",children:[o.jsx(Yt,{className:"w-4 h-4"}),"Jump to latest"]})]})}function Kft({date:e,isSticky:t=!1}){return o.jsxs("div",{"data-testid":`date-separator-${e.replace(/\s/g,"-").toLowerCase()}`,className:`flex items-center gap-3 py-3 ${t?"sticky top-0 bg-white z-10 -mx-4 px-4 shadow-sm":""}`,children:[o.jsx("div",{className:"flex-1 h-px bg-gray-200"}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full",children:[o.jsx(Bx,{className:"w-3 h-3 text-gray-500"}),o.jsx("span",{"data-testid":"date-separator-label",className:"text-xs font-medium text-gray-600",children:e})]}),o.jsx("div",{className:"flex-1 h-px bg-gray-200"})]})}function l5({message:e,onReply:t,replyCount:r=0,isThreaded:n=!1,isHighlighted:a=!1,isMobile:s=!1}){const[i,l]=w.useState(!1),[c,u]=w.useState(!1),d=w.useRef(null),f=w.useRef(null),{data:m}=PB(),v=m?.find(T=>T.id===e.sender)?.name,b=v?v.split(/\s+/).map(T=>T[0]).slice(0,2).join("").toUpperCase():e.sender.slice(-2).toUpperCase(),y=new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),S=async()=>{const T=e._content||"";try{await navigator.clipboard.writeText(T),l(!0),Gr.success("Message copied"),setTimeout(()=>l(!1),2e3),u(!1)}catch{Gr.error("Failed to copy message")}},_=T=>{T.key==="c"&&!T.ctrlKey&&!T.metaKey&&!T.altKey&&(T.preventDefault(),S())},N=()=>{s&&u(!0)},k=()=>{s&&(f.current=setTimeout(N,500))},j=()=>{f.current&&(clearTimeout(f.current),f.current=null)},E=()=>{f.current&&(clearTimeout(f.current),f.current=null)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{ref:d,"data-testid":`message-${e.id}`,className:`flex rounded-lg group relative focus:bg-blue-50 dark:focus:bg-blue-900/20 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 focus:outline-none transition-colors duration-300 ${s?"gap-2 p-2":"gap-3 p-3"} ${a?"bg-yellow-100 dark:bg-yellow-900/30 ring-2 ring-yellow-300 dark:ring-yellow-600":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,tabIndex:0,onKeyDown:_,onTouchStart:k,onTouchEnd:j,onTouchMove:E,children:[o.jsx("div",{"data-testid":`message-avatar-${e.id}`,className:`rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center flex-shrink-0 ${s?"w-8 h-8":"w-10 h-10"}`,children:o.jsx("span",{className:`text-blue-600 dark:text-blue-400 font-medium ${s?"text-xs":"text-sm"}`,children:b})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:`flex items-baseline ${s?"gap-1.5":"gap-2"}`,children:[o.jsx(Vse,{entityRef:e.sender,className:`font-semibold ${s?"text-sm":""}`,"data-testid":`message-sender-${e.id}`,children:v}),o.jsx("span",{"data-testid":`message-time-${e.id}`,className:`text-gray-400 dark:text-gray-500 ${s?"text-[10px]":"text-xs"}`,children:y})]}),o.jsx("div",{"data-testid":`message-content-${e.id}`,className:`text-[var(--color-text-secondary)] mt-1 break-words overflow-hidden whitespace-pre-wrap ${s?"text-sm":""}`,children:e._content?xme(e._content):o.jsx("span",{className:"text-gray-400 dark:text-gray-500 italic",children:"Content not loaded"})}),e._attachments&&e._attachments.length>0&&o.jsx("div",{className:"mt-2 space-y-1","data-testid":`message-attachments-${e.id}`,children:e._attachments.map(T=>o.jsxs("a",{href:`/documents?selected=${T.id}`,className:`flex items-center gap-2 bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] rounded-lg border border-[var(--color-border)] transition-colors ${s?"px-2 py-1.5":"px-3 py-2"}`,"data-testid":`message-attachment-${T.id}`,children:[o.jsx(rn,{className:`text-gray-400 flex-shrink-0 ${s?"w-3 h-3":"w-4 h-4"}`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:`font-medium text-blue-600 dark:text-blue-400 truncate ${s?"text-xs":"text-sm"}`,children:T.title||"Untitled Document"}),o.jsx("div",{className:s?"text-[10px]":"text-xs",children:o.jsx("span",{className:"px-1 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded text-[10px]",children:T.contentType})})]})]},T.id))}),o.jsxs("div",{className:`flex items-center gap-2 ${s?"mt-1.5":"mt-2"}`,children:[e.threadId&&!n&&o.jsx("div",{"data-testid":`message-thread-indicator-${e.id}`,className:`text-blue-500 ${s?"text-[10px]":"text-xs"}`,children:"Reply in thread"}),!n&&r>0&&o.jsxs("button",{"data-testid":`message-replies-${e.id}`,onClick:()=>t?.(e),className:`flex items-center gap-1 text-blue-600 hover:text-blue-700 ${s?"text-[10px]":"text-xs"}`,children:[o.jsx(gk,{className:s?"w-2.5 h-2.5":"w-3 h-3"}),o.jsxs("span",{children:[r," ",r===1?"reply":"replies"]})]}),!n&&!e.threadId&&t&&!s&&o.jsxs("button",{"data-testid":`message-reply-button-${e.id}`,onClick:()=>t(e),className:"flex items-center gap-1 text-xs text-gray-400 hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx(gk,{className:"w-3 h-3"}),o.jsx("span",{children:"Reply"})]})]})]}),!s&&o.jsxs("div",{"data-testid":`message-actions-${e.id}`,className:"absolute top-2 right-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-[var(--color-bg)] border border-[var(--color-border)] rounded-lg shadow-sm p-1",children:[o.jsx("button",{"data-testid":`message-copy-button-${e.id}`,onClick:S,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Copy message (C when focused)",children:i?o.jsx(Vn,{className:"w-4 h-4 text-green-500"}):o.jsx(rj,{className:"w-4 h-4"})}),!n&&t&&o.jsx("button",{"data-testid":`message-reply-action-${e.id}`,onClick:()=>t(e),className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Reply in thread",children:o.jsx(gk,{className:"w-4 h-4"})})]}),s&&o.jsx("button",{"data-testid":`message-more-button-${e.id}`,onClick:()=>u(!0),className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 self-start mt-1 touch-target","aria-label":"More actions",children:o.jsx(n0,{className:"w-4 h-4"})})]}),s&&c&&o.jsx(Gft,{message:e,isThreaded:n,onCopy:S,onReply:t,copied:i,onClose:()=>u(!1)})]})}function Gft({message:e,isThreaded:t,onCopy:r,onReply:n,copied:a,onClose:s}){return o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":`message-action-sheet-${e.id}`,role:"dialog","aria-modal":"true",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),o.jsxs("div",{className:"absolute bottom-0 inset-x-0 bg-[var(--color-bg)] rounded-t-2xl shadow-2xl p-4 space-y-2 animate-in slide-in-from-bottom duration-200",children:[o.jsx("div",{className:"w-10 h-1 bg-gray-300 dark:bg-gray-600 rounded-full mx-auto mb-4"}),o.jsxs("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors touch-target","data-testid":`message-copy-action-mobile-${e.id}`,children:[a?o.jsx(Vn,{className:"w-5 h-5 text-green-500"}):o.jsx(rj,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:"Copy message"})]}),!t&&n&&o.jsxs("button",{onClick:()=>{n(e),s()},className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors touch-target","data-testid":`message-reply-action-mobile-${e.id}`,children:[o.jsx(gk,{className:"w-5 h-5 text-gray-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:"Reply in thread"})]}),o.jsx("button",{onClick:s,className:"w-full flex items-center justify-center px-4 py-3 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors mt-2 touch-target",children:o.jsx("span",{className:"text-[var(--color-text)] font-medium",children:"Cancel"})})]})]})}const zte={open:o.jsx(nu,{className:"w-4 h-4 text-gray-400"}),in_progress:o.jsx(Rr,{className:"w-4 h-4 text-blue-500"}),blocked:o.jsx(Rt,{className:"w-4 h-4 text-red-500"}),completed:o.jsx(zs,{className:"w-4 h-4 text-green-500"}),cancelled:o.jsx(zs,{className:"w-4 h-4 text-gray-400"})},Vft={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Trivial"},Bte={1:"bg-red-100 text-red-700",2:"bg-orange-100 text-orange-700",3:"bg-yellow-100 text-yellow-700",4:"bg-blue-100 text-blue-700",5:"bg-gray-100 text-gray-600"};function Yft(e){return pt({queryKey:["tasks","search",e],queryFn:async()=>{const t=new URLSearchParams({limit:"50"});e&&t.set("search",e);const r=await fetch(`/api/tasks?${t}`);if(!r.ok)throw new Error("Failed to fetch tasks");const n=await r.json();return Array.isArray(n)?n:n.data||[]}})}function Qft({isOpen:e,onClose:t,onSelect:r,excludeIds:n=[]}){const[a,s]=w.useState(""),[i,l]=w.useState(0),c=w.useRef(null),u=w.useRef(null),{data:d,isLoading:f}=Yft(a),m=d?.filter(S=>!n.includes(S.id))||[];w.useEffect(()=>{l(0)},[m.length,a]),w.useEffect(()=>{e&&c.current&&setTimeout(()=>{c.current?.focus()},50)},[e]),w.useEffect(()=>{e||(s(""),l(0))},[e]),w.useEffect(()=>{u.current&&u.current.querySelector(`[data-index="${i}"]`)?.scrollIntoView({block:"nearest"})},[i]);const p=w.useCallback(S=>{r(S),t()},[r,t]),v=w.useCallback(S=>{if(S.key==="Escape"){t();return}if(S.key==="ArrowDown"){S.preventDefault(),l(_=>_>=m.length-1?0:_+1);return}if(S.key==="ArrowUp"){S.preventDefault(),l(_=>_<=0?m.length-1:_-1);return}if(S.key==="Enter"){S.preventDefault();const _=m[i];_&&p(_.id);return}},[m,i,p,t]),b=jo(),y=b?m.length>0?o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:[m.length," task",m.length!==1?"s":""," found"]}):null:o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(e0,{className:"w-3 h-3"}),o.jsx(Yt,{className:"w-3 h-3"}),"Navigate"]}),o.jsx("span",{children:" Select"}),o.jsx("span",{children:"Esc Close"})]}),m.length>0&&o.jsxs("span",{children:[m.length," task",m.length!==1?"s":""]})]});return o.jsx(Ux,{open:e,onClose:t,title:"Select Task",size:"lg","data-testid":"task-picker-modal",footer:y,children:o.jsxs("div",{onKeyDown:v,children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:c,type:"text",value:a,onChange:S=>s(S.target.value),onKeyDown:v,placeholder:"Search tasks...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"task-picker-search"})]})}),o.jsx("div",{ref:u,className:`overflow-y-auto p-2 ${b?"max-h-[calc(100vh-200px)]":"max-h-[300px]"}`,"data-testid":"task-picker-list",children:f?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx(Pe,{className:"w-5 h-5 animate-spin mr-2"}),"Loading tasks..."]}):m.length===0?o.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:a?"No tasks match your search":"No tasks available"}):m.map((S,_)=>{const N=_===i,k=zte[S.status]||zte.open,j=S.priority||3,E=Vft[j]||"Medium",T=Bte[j]||Bte[3];return o.jsxs("button",{"data-index":_,"data-testid":`task-picker-item-${S.id}`,onClick:()=>p(S.id),onMouseEnter:()=>!b&&l(_),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-colors touch-target ${N?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx("span",{className:"flex-shrink-0",children:k}),o.jsx("span",{className:"flex-1 truncate font-medium",children:S.title}),o.jsx("span",{className:`flex-shrink-0 px-2 py-0.5 text-xs font-medium rounded ${T}`,children:E})]},S.id)})})]})})}const $te={text:o.jsx(rn,{className:"w-4 h-4 text-gray-500"}),markdown:o.jsx(qp,{className:"w-4 h-4 text-purple-500"}),json:o.jsx(Bi,{className:"w-4 h-4 text-blue-500"})},Jft={text:"Text",markdown:"Markdown",json:"JSON"},Fte={text:"bg-gray-100 text-gray-700",markdown:"bg-purple-100 text-purple-700",json:"bg-blue-100 text-blue-700"};function Zft(e){return pt({queryKey:["documents","search",e],queryFn:async()=>{const t=new URLSearchParams({limit:"100"});e&&t.set("search",e);const r=await fetch(`/api/documents?${t}`);if(!r.ok)throw new Error("Failed to fetch documents");const n=await r.json();return Array.isArray(n)?n:n.items||n.data||[]}})}function Xft({isOpen:e,onClose:t,onSelect:r,excludeIds:n=[]}){const[a,s]=w.useState(""),[i,l]=w.useState(0),c=w.useRef(null),u=w.useRef(null),{data:d,isLoading:f}=Zft(a),m=d?.filter(S=>!n.includes(S.id))||[];w.useEffect(()=>{l(0)},[m.length,a]),w.useEffect(()=>{e&&c.current&&setTimeout(()=>{c.current?.focus()},50)},[e]),w.useEffect(()=>{e||(s(""),l(0))},[e]),w.useEffect(()=>{u.current&&u.current.querySelector(`[data-index="${i}"]`)?.scrollIntoView({block:"nearest"})},[i]);const p=w.useCallback(S=>{r(S),t()},[r,t]),v=w.useCallback(S=>{if(S.key==="Escape"){t();return}if(S.key==="ArrowDown"){S.preventDefault(),l(_=>_>=m.length-1?0:_+1);return}if(S.key==="ArrowUp"){S.preventDefault(),l(_=>_<=0?m.length-1:_-1);return}if(S.key==="Enter"){S.preventDefault();const _=m[i];_&&p(_.id);return}},[m,i,p,t]),b=jo(),y=b?m.length>0?o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:[m.length," document",m.length!==1?"s":""," found"]}):null:o.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(e0,{className:"w-3 h-3"}),o.jsx(Yt,{className:"w-3 h-3"}),"Navigate"]}),o.jsx("span",{children:" Select"}),o.jsx("span",{children:"Esc Close"})]}),m.length>0&&o.jsxs("span",{children:[m.length," document",m.length!==1?"s":""]})]});return o.jsx(Ux,{open:e,onClose:t,title:"Select Document",size:"lg","data-testid":"document-picker-modal",footer:y,children:o.jsxs("div",{onKeyDown:v,children:[o.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:c,type:"text",value:a,onChange:S=>s(S.target.value),onKeyDown:v,placeholder:"Search documents...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent touch-target","data-testid":"document-picker-search"})]})}),o.jsx("div",{ref:u,className:`overflow-y-auto p-2 ${b?"max-h-[calc(100vh-200px)]":"max-h-[300px]"}`,"data-testid":"document-picker-list",children:f?o.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx(Pe,{className:"w-5 h-5 animate-spin mr-2"}),"Loading documents..."]}):m.length===0?o.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:a?"No documents match your search":"No documents available"}):m.map((S,_)=>{const N=_===i,k=S.contentType||"text",j=$te[k]||$te.text,E=Jft[k]||"Text",T=Fte[k]||Fte.text,O=S.title||`Document ${S.id}`;return o.jsxs("button",{"data-index":_,"data-testid":`document-picker-item-${S.id}`,onClick:()=>p(S.id),onMouseEnter:()=>!b&&l(_),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-colors touch-target ${N?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[o.jsx("span",{className:"flex-shrink-0",children:j}),o.jsx("span",{className:"flex-1 truncate font-medium",children:O}),o.jsx("span",{className:`flex-shrink-0 px-2 py-0.5 text-xs font-medium rounded ${T}`,children:E})]},S.id)})})]})})}function c5(e){return[].concat(e)}function p$(e){return e.startsWith(":")}function uve(e){return Q2(e)&&(e==="*"||e.length>1&&":>~.+*".includes(e.slice(0,1))||mve(e))}function dve(e,t){return(Q2(t)||typeof t=="number")&&!hve(e)&&!p$(e)&&!fve(e)}function fve(e){return e.startsWith("@media")}function eht(e){return e==="."}function hve(e){return e==="--"}function Q2(e){return e+""===e}function mve(e){return Q2(e)&&(e.startsWith("&")||p$(e))}function EC(e,t=""){return e.filter(Boolean).join(t)}function pve(e,t){let r=0;if(t.length===0)return r.toString();for(let n=0;n<t.length;n++){const a=t.charCodeAt(n);r=(r<<5)-r+a,r=r&r}return`${e??"cl"}_${r.toString(36)}`}function tht(e,t){return e==="content"?`"${t}"`:t}function rht(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ute(e,t){return`${e}:${t}`}function nht(e){return e?`.${e}`:""}function aht(e,t){return e?`${e}
${t}`:t}var gve=class vve{constructor(t,r,n,a){this.sheet=t,this.property=r,this.value=n,this.selector=a,this.property=r,this.value=n,this.joined=Ute(r,n);const s=this.selector.preconditions.concat(this.selector.postconditions);this.hash=this.selector.hasConditions?this.selector.scopeClassName:pve(this.sheet.name,this.joined),this.key=EC([this.joined,s,this.hash])}toString(){let t=u5(this.selector.preconditions,{right:this.hash});return t=u5(this.selector.postconditions,{left:t}),`${t} {${vve.genRule(this.property,this.value)}}`}static genRule(t,r){const n=rht(t);return Ute(n,tht(t,r))+";"}};function u5(e,{left:t="",right:r=""}={}){const n=e.reduce((a,s)=>p$(s)?a+s:mve(s)?a+s.slice(1):EC([a,s]," "),t);return EC([n,nht(r)]," ")}var sht=class Hk{constructor(t,r=null,{preconditions:n,postconditions:a}={}){this.sheet=t,this.preconditions=[],this.scopeClassName=null,this.scopeName=null,this.postconditions=[],this.preconditions=n?c5(n):[],this.postconditions=a?c5(a):[],this.setScope(r)}setScope(t){return t?(this.scopeClassName||(this.scopeName=t,this.scopeClassName=pve(this.sheet.name,t+this.sheet.count)),this):this}get hasConditions(){return this.preconditions.length>0||this.postconditions.length>0}addScope(t){return new Hk(this.sheet,t,{preconditions:this.preconditions,postconditions:this.postconditions})}addPrecondition(t){return new Hk(this.sheet,this.scopeClassName,{postconditions:this.postconditions,preconditions:this.preconditions.concat(t)})}addPostcondition(t){return new Hk(this.sheet,this.scopeClassName,{preconditions:this.preconditions,postconditions:this.postconditions.concat(t)})}createRule(t,r){return new gve(this.sheet,t,r,this)}},iht=class{constructor(e,t){this.name=e,this.rootNode=t,this.storedStyles={},this.storedClasses={},this.style="",this.count=0,this.id=`flairup-${e}`,this.styleTag=this.createStyleTag()}getStyle(){return this.style}append(e){this.style=aht(this.style,e)}apply(){this.count++,this.styleTag&&(this.styleTag.innerHTML=this.style)}isApplied(){return!!this.styleTag}createStyleTag(){if(typeof document>"u"||this.isApplied()||this.rootNode===null)return this.styleTag;const e=document.createElement("style");return e.type="text/css",e.id=this.id,(this.rootNode??document.head).appendChild(e),e}addRule(e){const t=this.storedClasses[e.key];return Q2(t)?t:(this.storedClasses[e.key]=e.hash,this.storedStyles[e.hash]=[e.property,e.value],this.append(e.toString()),e.hash)}};function g$(e,t){for(const r in e)t(r.trim(),e[r])}function _r(...e){const t=e.reduce((r,n)=>(n instanceof Set?r.push(...n):typeof n=="string"?r.push(n):Array.isArray(n)?r.push(_r(...n)):typeof n=="object"&&Object.entries(n).forEach(([a,s])=>{s&&r.push(a)}),r),[]);return EC(t," ").trim()}function oht(e,t){const r=new iht(e,t);return{create:n,getStyle:r.getStyle.bind(r),isApplied:r.isApplied.bind(r)};function n(a){const s={};return bve(r,a,new sht(r)).forEach(([l,c,u])=>{J2(r,c,u).forEach(d=>{i(l,d)})}),r.apply(),s;function i(l,c){s[l]=s[l]??new Set,s[l].add(c)}}}function bve(e,t,r){const n=[];return g$(t,(a,s)=>{if(uve(a))return bve(e,s,r.addPrecondition(a)).forEach(i=>n.push(i));n.push([a,t[a],r.addScope(a)])}),n}function J2(e,t,r){const n=new Set;return g$(t,(a,s)=>{let i=[];if(uve(a))i=J2(e,s,r.addPostcondition(a));else if(eht(a))i=c5(s);else if(fve(a))i=cht(e,s,a,r);else if(hve(a))i=lht(e,s,r);else if(dve(a,s)){const l=r.createRule(a,s);e.addRule(l),n.add(l.hash)}return yve(i,n)}),n}function yve(e,t){return e.forEach(r=>t.add(r)),t}function lht(e,t,r){const n=new Set,a=[];if(g$(t,(s,i)=>{if(dve(s,i)){a.push(gve.genRule(s,i));return}const l=J2(e,i??{},r);yve(l,n)}),!r.scopeClassName)return n;if(a.length){const s=a.join(" ");e.append(`${u5(r.preconditions,{right:r.scopeClassName})} {${s}}`)}return n.add(r.scopeClassName),n}function cht(e,t,r,n){e.append(r+" {");const a=J2(e,t,n);return e.append("}"),a}function Hte(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function uht(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=fht(e))||t){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pn(){return pn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pn.apply(null,arguments)}function dht(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,d5(e,t)}function xve(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function d5(e,t){return d5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},d5(e,t)}function fht(e,t){if(e){if(typeof e=="string")return Hte(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Hte(e,t):void 0}}var Mr;(function(e){e.hiddenOnSearch="epr-hidden-on-search",e.searchActive="epr-search-active",e.hidden="epr-hidden",e.visible="epr-visible",e.active="epr-active",e.emoji="epr-emoji",e.category="epr-emoji-category",e.label="epr-emoji-category-label",e.categoryContent="epr-emoji-category-content",e.emojiHasVariations="epr-emoji-has-variations",e.scrollBody="epr-body",e.emojiList="epr-emoji-list",e.external="__EmojiPicker__",e.emojiPicker="EmojiPickerReact",e.open="epr-open",e.vertical="epr-vertical",e.horizontal="epr-horizontal",e.variationPicker="epr-emoji-variation-picker",e.darkTheme="epr-dark-theme",e.autoTheme="epr-auto-theme"})(Mr||(Mr={}));function Co(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(n){return"."+n}).join("")}var Dn=oht("epr",null),qk={display:"none",opacity:"0",pointerEvents:"none",visibility:"hidden",overflow:"hidden"},v$=Dn.create({hidden:pn({".":Mr.hidden},qk)}),hht=w.memo(function(){return w.createElement("style",{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:Dn.getStyle()}})}),im=Dn.create({".epr-main":{":has(input:not(:placeholder-shown))":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},hiddenOnSearch:pn({".":Mr.hiddenOnSearch},qk)},":has(input:placeholder-shown)":{visibleOnSearchOnly:qk}},hiddenOnReactions:{transition:"all 0.5s ease-in-out"},".epr-reactions":{hiddenOnReactions:{height:"0px",width:"0px",opacity:"0",pointerEvents:"none",overflow:"hidden"}},".EmojiPickerReact:not(.epr-search-active)":{categoryBtn:{":hover":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"},"&.epr-active":{opacity:"1",backgroundPositionY:"var(--epr-category-navigation-button-size)"}},visibleOnSearchOnly:pn({".":"epr-visible-on-search-only"},qk)}});function zd(e,t){var r,n;return{".epr-dark-theme":(r={},r[e]=t,r),".epr-auto-theme":(n={},n[e]={"@media (prefers-color-scheme: dark)":t},n)}}function wve(e,t){var r,n,a=(r=e.customEmojis)!=null?r:[],s=(n=t.customEmojis)!=null?n:[];return e.open===t.open&&e.emojiVersion===t.emojiVersion&&e.reactionsDefaultOpen===t.reactionsDefaultOpen&&e.searchPlaceHolder===t.searchPlaceHolder&&e.searchPlaceholder===t.searchPlaceholder&&e.searchClearButtonLabel===t.searchClearButtonLabel&&e.defaultSkinTone===t.defaultSkinTone&&e.skinTonesDisabled===t.skinTonesDisabled&&e.autoFocusSearch===t.autoFocusSearch&&e.emojiStyle===t.emojiStyle&&e.theme===t.theme&&e.suggestedEmojisMode===t.suggestedEmojisMode&&e.lazyLoadEmojis===t.lazyLoadEmojis&&e.className===t.className&&e.height===t.height&&e.width===t.width&&e.style===t.style&&e.searchDisabled===t.searchDisabled&&e.skinTonePickerLocation===t.skinTonePickerLocation&&a.length===s.length&&e.emojiData===t.emojiData}var mht=["1f44d","2764-fe0f","1f603","1f622","1f64f","1f44e","1f621"],qg;(function(e){e.RECENT="recent",e.FREQUENT="frequent"})(qg||(qg={}));var Ai;(function(e){e.NATIVE="native",e.APPLE="apple",e.TWITTER="twitter",e.GOOGLE="google",e.FACEBOOK="facebook"})(Ai||(Ai={}));var Ld;(function(e){e.DARK="dark",e.LIGHT="light",e.AUTO="auto"})(Ld||(Ld={}));var Uo;(function(e){e.NEUTRAL="neutral",e.LIGHT="1f3fb",e.MEDIUM_LIGHT="1f3fc",e.MEDIUM="1f3fd",e.MEDIUM_DARK="1f3fe",e.DARK="1f3ff"})(Uo||(Uo={}));var Qt;(function(e){e.SUGGESTED="suggested",e.CUSTOM="custom",e.SMILEYS_PEOPLE="smileys_people",e.ANIMALS_NATURE="animals_nature",e.FOOD_DRINK="food_drink",e.TRAVEL_PLACES="travel_places",e.ACTIVITIES="activities",e.OBJECTS="objects",e.SYMBOLS="symbols",e.FLAGS="flags"})(Qt||(Qt={}));var Wg;(function(e){e.SEARCH="SEARCH",e.PREVIEW="PREVIEW"})(Wg||(Wg={}));var pht="https://cdn.jsdelivr.net/npm/emoji-datasource-apple/img/apple/64/",ght="https://cdn.jsdelivr.net/npm/emoji-datasource-facebook/img/facebook/64/",vht="https://cdn.jsdelivr.net/npm/emoji-datasource-twitter/img/twitter/64/",bht="https://cdn.jsdelivr.net/npm/emoji-datasource-google/img/google/64/";function yht(e){switch(e){case Ai.TWITTER:return vht;case Ai.GOOGLE:return bht;case Ai.FACEBOOK:return ght;case Ai.APPLE:default:return pht}}var MC=[Uo.NEUTRAL,Uo.LIGHT,Uo.MEDIUM_LIGHT,Uo.MEDIUM,Uo.MEDIUM_DARK,Uo.DARK],xht=Object.entries(Uo).reduce(function(e,t){var r=t[0],n=t[1];return e[n]=r,e},{}),b$=MC.reduce(function(e,t){var r;return Object.assign(e,(r={},r[t]=t,r))},{}),cs;(function(e){e.name="n",e.unified="u",e.variations="v",e.added_in="a",e.imgUrl="imgUrl"})(cs||(cs={}));function Sve(e){var t;return(t=e[cs.name])!=null?t:[]}function wht(e){return parseFloat(e[cs.added_in]||"0")}function Sht(e){if(!e)return"";var t=Sve(e);return t[t.length-1]}function kve(e){var t=e.split("-"),r=t.splice(1,1),n=r[0];return b$[n]?t.join("-"):e}function om(e,t){var r,n=e[cs.unified];return!t||!kht(e)?n:(r=_ht(e,t))!=null?r:n}function _ve(e,t){return""+yht(t)+e+".png"}function y$(e){var t;return(t=e[cs.variations])!=null?t:[]}function kht(e){return y$(e).length>0}function _ht(e,t){return t?y$(e).find(function(r){return r.includes(t)}):om(e)}function Nht(e){var t=e.split("-"),r=t[1];return Object.keys(b$).includes(r)?r:null}var ao,Cht=[Qt.SUGGESTED,Qt.CUSTOM,Qt.SMILEYS_PEOPLE,Qt.ANIMALS_NATURE,Qt.FOOD_DRINK,Qt.TRAVEL_PLACES,Qt.ACTIVITIES,Qt.OBJECTS,Qt.SYMBOLS,Qt.FLAGS],jht={name:"Recently Used",category:Qt.SUGGESTED},Nve=(ao={},ao[Qt.SUGGESTED]={category:Qt.SUGGESTED,name:"Frequently Used"},ao[Qt.CUSTOM]={category:Qt.CUSTOM,name:"Custom Emojis"},ao[Qt.SMILEYS_PEOPLE]={category:Qt.SMILEYS_PEOPLE,name:"Smileys & People"},ao[Qt.ANIMALS_NATURE]={category:Qt.ANIMALS_NATURE,name:"Animals & Nature"},ao[Qt.FOOD_DRINK]={category:Qt.FOOD_DRINK,name:"Food & Drink"},ao[Qt.TRAVEL_PLACES]={category:Qt.TRAVEL_PLACES,name:"Travel & Places"},ao[Qt.ACTIVITIES]={category:Qt.ACTIVITIES,name:"Activities"},ao[Qt.OBJECTS]={category:Qt.OBJECTS,name:"Objects"},ao[Qt.SYMBOLS]={category:Qt.SYMBOLS,name:"Symbols"},ao[Qt.FLAGS]={category:Qt.FLAGS,name:"Flags"},ao);function Cve(e){return Cht.map(function(t){return pn({},Nve[t],e&&e[t]&&e[t])})}function Z2(e){return e.category}function jve(e){return e.name}function Eht(e,t,r){var n;e===void 0&&(e=[]),t===void 0&&(t={});var a=(function(){var i=r!=null&&r.categories?Object.fromEntries(Object.entries(r.categories).filter(function(u){var d=u[1];return!!d})):{};if(t.suggestionMode===qg.RECENT){var l,c=r==null||(l=r.categories)==null?void 0:l.suggested_recent;i[Qt.SUGGESTED]=c?{category:Qt.SUGGESTED,name:c.name}:jht}return i})(),s=Cve(a);return(n=e)!=null&&n.length?e.map(function(i){return typeof i=="string"?qte(i,a[i]):pn({},qte(i.category,a[i.category]),i)}):s}function qte(e,t){return t===void 0&&(t={}),Object.assign(Nve[e],t)}var Mht=["2640-fe0f","2642-fe0f","2695-fe0f"],TC="Search",Eve="Clear",Tht="No results found",Mve=" found. Use up and down arrow keys to navigate.",Aht="1 result"+Mve,Dht="%n results"+Mve;function Wte(e){var t,r,n,a,s;e===void 0&&(e={});var i=Tve(),l=(t=e.emojiData)==null||(r=t.categories)==null||(n=r.preview_mood)==null?void 0:n.name,c=pn({},i.previewConfig,l&&!((a=e.previewConfig)!=null&&a.defaultCaption)?{defaultCaption:l}:{},(s=e.previewConfig)!=null?s:{}),u=Object.assign(i,e),d=Eht(e.categories,{suggestionMode:u.suggestedEmojisMode},e.emojiData);u.hiddenEmojis.forEach(function(m){u.unicodeToHide.add(m)});var f=u.searchDisabled?Wg.PREVIEW:u.skinTonePickerLocation;return pn({},u,{categories:d,previewConfig:c,skinTonePickerLocation:f})}function Tve(){return{autoFocusSearch:!0,categories:Cve(),className:"",customEmojis:[],defaultSkinTone:Uo.NEUTRAL,emojiStyle:Ai.APPLE,emojiVersion:null,getEmojiUrl:_ve,height:450,lazyLoadEmojis:!1,previewConfig:pn({},Lht),searchDisabled:!1,searchPlaceHolder:TC,searchPlaceholder:TC,searchClearButtonLabel:Eve,skinTonePickerLocation:Wg.SEARCH,skinTonesDisabled:!1,style:{},suggestedEmojisMode:qg.FREQUENT,theme:Ld.LIGHT,unicodeToHide:new Set(Mht),width:350,reactionsDefaultOpen:!1,reactions:mht,open:!0,allowExpandReactions:!0,hiddenEmojis:[],emojiData:void 0}}var Lht={defaultEmoji:"1f60a",defaultCaption:"What's your mood?",showPreview:!0},Oht=["children"],Ave=w.createContext(Tve());function Iht(e){var t=e.children,r=xve(e,Oht),n=Rht(r);return w.createElement(Ave.Provider,{value:n},t)}function Rht(e){var t,r=w.useState(function(){return Wte(e)}),n=r[0],a=r[1];return w.useEffect(function(){wve(n,e)||a(Wte(e))},[(t=e.customEmojis)==null?void 0:t.length,e.open,e.emojiVersion,e.reactionsDefaultOpen,e.searchPlaceHolder,e.searchPlaceholder,e.searchClearButtonLabel,e.defaultSkinTone,e.skinTonesDisabled,e.autoFocusSearch,e.emojiStyle,e.theme,e.suggestedEmojisMode,e.lazyLoadEmojis,e.className,e.height,e.width,e.searchDisabled,e.skinTonePickerLocation,e.allowExpandReactions,e.emojiData]),n}function Ln(){return w.useContext(Ave)}function Kte(e,t){t===void 0&&(t=0);var r=w.useState(e),n=r[0],a=r[1],s=w.useRef(null);function i(l){return new Promise(function(c){var u;s.current&&clearTimeout(s.current),s.current=(u=window)==null?void 0:u.setTimeout(function(){a(l),c(l)},t)})}return[n,i]}var Pht={smileys_people:{category:"smileys_people",name:"people & body"},animals_nature:{category:"animals_nature",name:"animals & nature"},food_drink:{category:"food_drink",name:"food & drink"},travel_places:{category:"travel_places",name:"travel & places"},activities:{category:"activities",name:"activities"},objects:{category:"objects",name:"objects"},symbols:{category:"symbols",name:"symbols"},flags:{category:"flags",name:"flags"},suggested:{category:"suggested",name:"Frequently Used"},custom:{category:"custom",name:"Custom Emojis"},suggested_recent:{category:"suggested",name:"Recently Used"},preview_mood:{category:"preview_mood",name:"What's your mood?"}},zht={custom:[],smileys_people:[{n:["face","grin","grinning face"],u:"1f600",a:"1"},{n:["face","open","mouth","smile","grinning face with big eyes"],u:"1f603",a:"0.6"},{n:["eye","face","open","mouth","smile","grinning face with smiling eyes"],u:"1f604",a:"0.6"},{n:["eye","face","grin","smile","beaming face with smiling eyes"],u:"1f601",a:"0.6"},{n:["face","laugh","mouth","smile","satisfied","grinning squinting face"],u:"1f606",a:"0.6"},{n:["cold","face","open","smile","sweat","grinning face with sweat"],u:"1f605",a:"0.6"},{n:["face","rofl","floor","laugh","rotfl","rolling","rolling on the floor laughing"],u:"1f923",a:"3"},{n:["joy","face","tear","laugh","face with tears of joy"],u:"1f602",a:"0.6"},{n:["face","smile","slightly smiling face"],u:"1f642",a:"1"},{n:["face","upside down","upside down face"],u:"1f643",a:"1"},{n:["melt","liquid","dissolve","disappear","melting face"],u:"1fae0",a:"14"},{n:["face","wink","winking face"],u:"1f609",a:"0.6"},{n:["eye","face","blush","smile","smiling face with smiling eyes"],u:"1f60a",a:"0.6"},{n:["face","halo","angel","fantasy","innocent","smiling face with halo"],u:"1f607",a:"1"},{n:["adore","crush","hearts","in love","smiling face with hearts"],u:"1f970",a:"11"},{n:["eye","face","love","smile","smiling face with heart eyes"],u:"1f60d",a:"0.6"},{n:["eyes","face","star","grinning","star struck"],u:"1f929",a:"5"},{n:["face","kiss","face blowing a kiss"],u:"1f618",a:"0.6"},{n:["face","kiss","kissing face"],u:"1f617",a:"1"},{n:["eye","face","kiss","closed","kissing face with closed eyes"],u:"1f61a",a:"0.6"},{n:["eye","face","kiss","smile","kissing face with smiling eyes"],u:"1f619",a:"1"},{n:["tear","proud","smiling","touched","grateful","relieved","smiling face with tear"],u:"1f972",a:"13"},{n:["yum","face","smile","delicious","savouring","face savoring food"],u:"1f60b",a:"0.6"},{n:["face","tongue","face with tongue"],u:"1f61b",a:"1"},{n:["eye","face","joke","wink","tongue","winking face with tongue"],u:"1f61c",a:"0.6"},{n:["eye","goofy","large","small","zany face"],u:"1f92a",a:"5"},{n:["eye","face","taste","tongue","horrible","squinting face with tongue"],u:"1f61d",a:"0.6"},{n:["face","money","mouth","money mouth face"],u:"1f911",a:"1"},{n:["hug","face","hugging","open hands","smiling face","smiling face with open hands"],u:"1f917",a:"1"},{n:["whoops","face with hand over mouth"],u:"1f92d",a:"5"},{n:["awe","scared","surprise","amazement","disbelief","embarrass","face with open eyes and hand over mouth"],u:"1fae2",a:"14"},{n:["peep","stare","captivated","face with peeking eye"],u:"1fae3",a:"14"},{n:["quiet","shush","shushing face"],u:"1f92b",a:"5"},{n:["face","thinking","thinking face"],u:"1f914",a:"1"},{n:["ok","yes","sunny","salute","troops","saluting face"],u:"1fae1",a:"14"},{n:["zip","face","mouth","zipper","zipper mouth face"],u:"1f910",a:"1"},{n:["skeptic","distrust","face with raised eyebrow"],u:"1f928",a:"5"},{n:["meh","face","deadpan","neutral","neutral face"],u:"1f610",a:"0.7"},{n:["meh","face","inexpressive","unexpressive","expressionless","expressionless face"],u:"1f611",a:"1"},{n:["face","mouth","quiet","silent","face without mouth"],u:"1f636",a:"1"},{n:["hide","depressed","disappear","introvert","invisible","dotted line face"],u:"1fae5",a:"14"},{n:["absentminded","face in clouds","head in clouds","face in the fog"],u:"1f636-200d-1f32b-fe0f",a:"13.1"},{n:["face","smirk","smirking face"],u:"1f60f",a:"0.6"},{n:["face","unhappy","unamused","unamused face"],u:"1f612",a:"0.6"},{n:["eyes","face","eyeroll","rolling","face with rolling eyes"],u:"1f644",a:"1"},{n:["face","grimace","grimacing face"],u:"1f62c",a:"1"},{n:["gasp","groan","exhale","relief","whisper","whistle","face exhaling"],u:"1f62e-200d-1f4a8",a:"13.1"},{n:["lie","face","pinocchio","lying face"],u:"1f925",a:"3"},{n:["face","shock","shaking","vibrate","earthquake","shaking face"],u:"1fae8",a:"15"},{n:["no","shake","head shaking horizontally"],u:"1f642-200d-2194-fe0f",a:"15.1"},{n:["nod","yes","head shaking vertically"],u:"1f642-200d-2195-fe0f",a:"15.1"},{n:["face","relieved","relieved face"],u:"1f60c",a:"0.6"},{n:["face","pensive","dejected","pensive face"],u:"1f614",a:"0.6"},{n:["face","sleep","good night","sleepy face"],u:"1f62a",a:"0.6"},{n:["face","drooling","drooling face"],u:"1f924",a:"3"},{n:["zzz","face","sleep","good night","sleeping face"],u:"1f634",a:"1"},{n:["cold","face","mask","sick","doctor","face with medical mask"],u:"1f637",a:"0.6"},{n:["ill","face","sick","thermometer","face with thermometer"],u:"1f912",a:"1"},{n:["face","hurt","injury","bandage","face with head bandage"],u:"1f915",a:"1"},{n:["face","vomit","nauseated","nauseated face"],u:"1f922",a:"3"},{n:["puke","sick","vomit","face vomiting"],u:"1f92e",a:"5"},{n:["face","sneeze","gesundheit","sneezing face"],u:"1f927",a:"3"},{n:["hot","hot face","feverish","sweating","red faced","heat stroke"],u:"1f975",a:"11"},{n:["cold","icicles","freezing","cold face","frostbite","blue faced"],u:"1f976",a:"11"},{n:["dizzy","tipsy","woozy face","wavy mouth","intoxicated","uneven eyes"],u:"1f974",a:"11"},{n:["dead","face","knocked out","crossed out eyes","face with crossed out eyes"],u:"1f635",a:"0.6"},{n:["whoa","dizzy","spiral","trouble","hypnotized","face with spiral eyes"],u:"1f635-200d-1f4ab",a:"13.1"},{n:["shocked","mind blown","exploding head"],u:"1f92f",a:"5"},{n:["hat","face","cowboy","cowgirl","cowboy hat face"],u:"1f920",a:"3"},{n:["hat","horn","party","celebration","partying face"],u:"1f973",a:"11"},{n:["face","nose","glasses","disguise","incognito","disguised face"],u:"1f978",a:"13"},{n:["sun","cool","face","bright","sunglasses","smiling face with sunglasses"],u:"1f60e",a:"1"},{n:["face","geek","nerd","nerd face"],u:"1f913",a:"1"},{n:["face","stuffy","monocle","face with monocle"],u:"1f9d0",a:"5"},{n:["meh","face","confused","confused face"],u:"1f615",a:"1"},{n:["meh","unsure","skeptical","disappointed","face with diagonal mouth"],u:"1fae4",a:"14"},{n:["face","worried","worried face"],u:"1f61f",a:"1"},{n:["face","frown","slightly frowning face"],u:"1f641",a:"1"},{n:["face","open","mouth","sympathy","face with open mouth"],u:"1f62e",a:"1"},{n:["face","hushed","stunned","surprised","hushed face"],u:"1f62f",a:"1"},{n:["face","shocked","totally","astonished","astonished face"],u:"1f632",a:"0.6"},{n:["face","dazed","flushed","flushed face"],u:"1f633",a:"0.6"},{n:["mercy","begging","puppy eyes","pleading face"],u:"1f97a",a:"11"},{n:["cry","sad","angry","proud","resist","face holding back tears"],u:"1f979",a:"14"},{n:["face","open","frown","mouth","frowning face with open mouth"],u:"1f626",a:"1"},{n:["face","anguished","anguished face"],u:"1f627",a:"1"},{n:["face","fear","scared","fearful","fearful face"],u:"1f628",a:"0.6"},{n:["blue","cold","face","sweat","rushed","anxious face with sweat"],u:"1f630",a:"0.6"},{n:["face","whew","relieved","disappointed","sad but relieved face"],u:"1f625",a:"0.6"},{n:["cry","sad","face","tear","crying face"],u:"1f622",a:"0.6"},{n:["cry","sad","sob","face","tear","loudly crying face"],u:"1f62d",a:"0.6"},{n:["face","fear","munch","scared","scream","face screaming in fear"],u:"1f631",a:"0.6"},{n:["face","confounded","confounded face"],u:"1f616",a:"0.6"},{n:["face","persevere","persevering face"],u:"1f623",a:"0.6"},{n:["face","disappointed","disappointed face"],u:"1f61e",a:"0.6"},{n:["cold","face","sweat","downcast face with sweat"],u:"1f613",a:"0.6"},{n:["face","tired","weary","weary face"],u:"1f629",a:"0.6"},{n:["face","tired","tired face"],u:"1f62b",a:"0.6"},{n:["yawn","bored","tired","yawning face"],u:"1f971",a:"12"},{n:["won","face","triumph","face with steam from nose"],u:"1f624",a:"0.6"},{n:["mad","red","face","rage","angry","enraged","pouting","enraged face"],u:"1f621",a:"0.6"},{n:["mad","face","anger","angry","angry face"],u:"1f620",a:"0.6"},{n:["swearing","face with symbols on mouth"],u:"1f92c",a:"5"},{n:["face","horns","smile","fantasy","fairy tale","smiling face with horns"],u:"1f608",a:"1"},{n:["imp","face","demon","devil","fantasy","angry face with horns"],u:"1f47f",a:"0.6"},{n:["face","skull","death","monster","fairy tale"],u:"1f480",a:"0.6"},{n:["poo","dung","face","poop","monster","pile of poo"],u:"1f4a9",a:"0.6"},{n:["face","clown","clown face"],u:"1f921",a:"3"},{n:["ogre","face","fantasy","monster","creature","fairy tale"],u:"1f479",a:"0.6"},{n:["face","goblin","fantasy","monster","creature","fairy tale"],u:"1f47a",a:"0.6"},{n:["face","ghost","fantasy","monster","creature","fairy tale"],u:"1f47b",a:"0.6"},{n:["ufo","face","alien","fantasy","creature","extraterrestrial"],u:"1f47d",a:"0.6"},{n:["ufo","face","alien","monster","creature","alien monster","extraterrestrial"],u:"1f47e",a:"0.6"},{n:["face","robot","monster"],u:"1f916",a:"1"},{n:["cat","face","open","mouth","smile","grinning","grinning cat"],u:"1f63a",a:"0.6"},{n:["cat","eye","face","grin","smile","grinning cat with smiling eyes"],u:"1f638",a:"0.6"},{n:["cat","joy","face","tear","cat with tears of joy"],u:"1f639",a:"0.6"},{n:["cat","eye","face","love","heart","smile","smiling cat with heart eyes"],u:"1f63b",a:"0.6"},{n:["cat","wry","face","smile","ironic","cat with wry smile"],u:"1f63c",a:"0.6"},{n:["cat","eye","face","kiss","kissing cat"],u:"1f63d",a:"0.6"},{n:["oh","cat","face","weary","weary cat","surprised"],u:"1f640",a:"0.6"},{n:["cat","cry","sad","face","tear","crying cat"],u:"1f63f",a:"0.6"},{n:["cat","face","pouting","pouting cat"],u:"1f63e",a:"0.6"},{n:["see","evil","face","monkey","forbidden","see no evil monkey"],u:"1f648",a:"0.6"},{n:["evil","face","hear","monkey","forbidden","hear no evil monkey"],u:"1f649",a:"0.6"},{n:["evil","face","speak","monkey","forbidden","speak no evil monkey"],u:"1f64a",a:"0.6"},{n:["love","mail","heart","letter","love letter"],u:"1f48c",a:"0.6"},{n:["arrow","cupid","heart with arrow"],u:"1f498",a:"0.6"},{n:["ribbon","valentine","heart with ribbon"],u:"1f49d",a:"0.6"},{n:["excited","sparkle","sparkling heart"],u:"1f496",a:"0.6"},{n:["pulse","excited","growing","nervous","growing heart"],u:"1f497",a:"0.6"},{n:["beating","heartbeat","pulsating","beating heart"],u:"1f493",a:"0.6"},{n:["revolving","revolving hearts"],u:"1f49e",a:"0.6"},{n:["love","two hearts"],u:"1f495",a:"0.6"},{n:["heart","heart decoration"],u:"1f49f",a:"0.6"},{n:["break","broken","broken heart"],u:"1f494",a:"0.6"},{n:["burn","love","lust","heart","sacred heart","heart on fire"],u:"2764-fe0f-200d-1f525",a:"13.1"},{n:["well","mending","healthier","improving","recovering","recuperating","mending heart"],u:"2764-fe0f-200d-1fa79",a:"13.1"},{n:["cute","like","love","pink","heart","pink heart"],u:"1fa77",a:"15"},{n:["orange","orange heart"],u:"1f9e1",a:"5"},{n:["yellow","yellow heart"],u:"1f49b",a:"0.6"},{n:["green","green heart"],u:"1f49a",a:"0.6"},{n:["blue","blue heart"],u:"1f499",a:"0.6"},{n:["cyan","teal","heart","light blue","light blue heart"],u:"1fa75",a:"15"},{n:["purple","purple heart"],u:"1f49c",a:"0.6"},{n:["brown","heart","brown heart"],u:"1f90e",a:"12"},{n:["evil","black","wicked","black heart"],u:"1f5a4",a:"3"},{n:["gray","heart","slate","silver","grey heart"],u:"1fa76",a:"15"},{n:["heart","white","white heart"],u:"1f90d",a:"12"},{n:["kiss","lips","kiss mark"],u:"1f48b",a:"0.6"},{n:["100","full","score","hundred","hundred points"],u:"1f4af",a:"0.6"},{n:["mad","angry","comic","anger symbol"],u:"1f4a2",a:"0.6"},{n:["boom","comic","collision"],u:"1f4a5",a:"0.6"},{n:["star","dizzy","comic"],u:"1f4ab",a:"0.6"},{n:["comic","sweat","splashing","sweat droplets"],u:"1f4a6",a:"0.6"},{n:["dash","comic","running","dashing away"],u:"1f4a8",a:"0.6"},{n:["comic","bubble","dialog","speech","balloon","speech balloon"],u:"1f4ac",a:"0.6"},{n:["eye","bubble","speech","balloon","witness","eye in speech bubble"],u:"1f441-fe0f-200d-1f5e8-fe0f",a:"2"},{n:["comic","bubble","balloon","thought","thought balloon"],u:"1f4ad",a:"1"},{n:["ZZZ","zzz","comic","sleep","good night"],u:"1f4a4",a:"0.6"},{n:["hand","wave","waving","waving hand"],u:"1f44b",v:["1f44b-1f3fb","1f44b-1f3fc","1f44b-1f3fd","1f44b-1f3fe","1f44b-1f3ff"],a:"0.6"},{n:["raised","backhand","raised back of hand"],u:"1f91a",v:["1f91a-1f3fb","1f91a-1f3fc","1f91a-1f3fd","1f91a-1f3fe","1f91a-1f3ff"],a:"3"},{n:["hand","high 5","high five","raised hand"],u:"270b",v:["270b-1f3fb","270b-1f3fc","270b-1f3fd","270b-1f3fe","270b-1f3ff"],a:"0.6"},{n:["hand","spock","finger","vulcan","vulcan salute"],u:"1f596",v:["1f596-1f3fb","1f596-1f3fc","1f596-1f3fd","1f596-1f3fe","1f596-1f3ff"],a:"1"},{n:["hand","right","rightward","rightwards hand"],u:"1faf1",v:["1faf1-1f3fb","1faf1-1f3fc","1faf1-1f3fd","1faf1-1f3fe","1faf1-1f3ff"],a:"14"},{n:["hand","left","leftward","leftwards hand"],u:"1faf2",v:["1faf2-1f3fb","1faf2-1f3fc","1faf2-1f3fd","1faf2-1f3fe","1faf2-1f3ff"],a:"14"},{n:["drop","shoo","dismiss","palm down hand"],u:"1faf3",v:["1faf3-1f3fb","1faf3-1f3fc","1faf3-1f3fd","1faf3-1f3fe","1faf3-1f3ff"],a:"14"},{n:["come","catch","offer","beckon","palm up hand"],u:"1faf4",v:["1faf4-1f3fb","1faf4-1f3fc","1faf4-1f3fd","1faf4-1f3fe","1faf4-1f3ff"],a:"14"},{n:["push","stop","wait","refuse","leftward","high five","leftwards pushing hand"],u:"1faf7",v:["1faf7-1f3fb","1faf7-1f3fc","1faf7-1f3fd","1faf7-1f3fe","1faf7-1f3ff"],a:"15"},{n:["push","stop","wait","refuse","high five","rightward","rightwards pushing hand"],u:"1faf8",v:["1faf8-1f3fb","1faf8-1f3fc","1faf8-1f3fd","1faf8-1f3fe","1faf8-1f3ff"],a:"15"},{n:["ok","hand","OK hand"],u:"1f44c",v:["1f44c-1f3fb","1f44c-1f3fc","1f44c-1f3fd","1f44c-1f3fe","1f44c-1f3ff"],a:"0.6"},{n:["fingers","pinched","sarcastic","hand gesture","interrogation","pinched fingers"],u:"1f90c",v:["1f90c-1f3fb","1f90c-1f3fc","1f90c-1f3fd","1f90c-1f3fe","1f90c-1f3ff"],a:"13"},{n:["small amount","pinching hand"],u:"1f90f",v:["1f90f-1f3fb","1f90f-1f3fc","1f90f-1f3fd","1f90f-1f3fe","1f90f-1f3ff"],a:"12"},{n:["hand","luck","cross","finger","crossed fingers"],u:"1f91e",v:["1f91e-1f3fb","1f91e-1f3fc","1f91e-1f3fd","1f91e-1f3fe","1f91e-1f3ff"],a:"3"},{n:["love","snap","heart","money","expensive","hand with index finger and thumb crossed"],u:"1faf0",v:["1faf0-1f3fb","1faf0-1f3fc","1faf0-1f3fd","1faf0-1f3fe","1faf0-1f3ff"],a:"14"},{n:["ily","hand","love you gesture"],u:"1f91f",v:["1f91f-1f3fb","1f91f-1f3fc","1f91f-1f3fd","1f91f-1f3fe","1f91f-1f3ff"],a:"5"},{n:["hand","horns","finger","rock on","sign of the horns"],u:"1f918",v:["1f918-1f3fb","1f918-1f3fc","1f918-1f3fd","1f918-1f3fe","1f918-1f3ff"],a:"1"},{n:["call","hand","shaka","hang loose","call me hand"],u:"1f919",v:["1f919-1f3fb","1f919-1f3fc","1f919-1f3fd","1f919-1f3fe","1f919-1f3ff"],a:"3"},{n:["hand","index","point","finger","backhand","backhand index pointing left"],u:"1f448",v:["1f448-1f3fb","1f448-1f3fc","1f448-1f3fd","1f448-1f3fe","1f448-1f3ff"],a:"0.6"},{n:["hand","index","point","finger","backhand","backhand index pointing right"],u:"1f449",v:["1f449-1f3fb","1f449-1f3fc","1f449-1f3fd","1f449-1f3fe","1f449-1f3ff"],a:"0.6"},{n:["up","hand","point","finger","backhand","backhand index pointing up"],u:"1f446",v:["1f446-1f3fb","1f446-1f3fc","1f446-1f3fd","1f446-1f3fe","1f446-1f3ff"],a:"0.6"},{n:["hand","finger","middle finger"],u:"1f595",v:["1f595-1f3fb","1f595-1f3fc","1f595-1f3fd","1f595-1f3fe","1f595-1f3ff"],a:"1"},{n:["down","hand","point","finger","backhand","backhand index pointing down"],u:"1f447",v:["1f447-1f3fb","1f447-1f3fc","1f447-1f3fd","1f447-1f3fe","1f447-1f3ff"],a:"0.6"},{n:["you","point","index pointing at the viewer"],u:"1faf5",v:["1faf5-1f3fb","1faf5-1f3fc","1faf5-1f3fd","1faf5-1f3fe","1faf5-1f3ff"],a:"14"},{n:["+1","up","hand","thumb","thumbs up"],u:"1f44d",v:["1f44d-1f3fb","1f44d-1f3fc","1f44d-1f3fd","1f44d-1f3fe","1f44d-1f3ff"],a:"0.6"},{n:[" 1","down","hand","thumb","thumbs down"],u:"1f44e",v:["1f44e-1f3fb","1f44e-1f3fc","1f44e-1f3fd","1f44e-1f3fe","1f44e-1f3ff"],a:"0.6"},{n:["fist","hand","punch","clenched","raised fist"],u:"270a",v:["270a-1f3fb","270a-1f3fc","270a-1f3fd","270a-1f3fe","270a-1f3ff"],a:"0.6"},{n:["fist","hand","punch","clenched","oncoming fist"],u:"1f44a",v:["1f44a-1f3fb","1f44a-1f3fc","1f44a-1f3fd","1f44a-1f3fe","1f44a-1f3ff"],a:"0.6"},{n:["fist","leftwards","left facing fist"],u:"1f91b",v:["1f91b-1f3fb","1f91b-1f3fc","1f91b-1f3fd","1f91b-1f3fe","1f91b-1f3ff"],a:"3"},{n:["fist","rightwards","right facing fist"],u:"1f91c",v:["1f91c-1f3fb","1f91c-1f3fc","1f91c-1f3fd","1f91c-1f3fe","1f91c-1f3ff"],a:"3"},{n:["clap","hand","clapping hands"],u:"1f44f",v:["1f44f-1f3fb","1f44f-1f3fc","1f44f-1f3fd","1f44f-1f3fe","1f44f-1f3ff"],a:"0.6"},{n:["hand","hooray","raised","gesture","celebration","raising hands"],u:"1f64c",v:["1f64c-1f3fb","1f64c-1f3fc","1f64c-1f3fd","1f64c-1f3fe","1f64c-1f3ff"],a:"0.6"},{n:["love","heart hands"],u:"1faf6",v:["1faf6-1f3fb","1faf6-1f3fc","1faf6-1f3fd","1faf6-1f3fe","1faf6-1f3ff"],a:"14"},{n:["hand","open","open hands"],u:"1f450",v:["1f450-1f3fb","1f450-1f3fc","1f450-1f3fd","1f450-1f3fe","1f450-1f3ff"],a:"0.6"},{n:["prayer","palms up together"],u:"1f932",v:["1f932-1f3fb","1f932-1f3fc","1f932-1f3fd","1f932-1f3fe","1f932-1f3ff"],a:"5"},{n:["hand","shake","meeting","handshake","agreement"],u:"1f91d",v:["1f91d-1f3fb","1f91d-1f3fc","1f91d-1f3fd","1f91d-1f3fe","1f91d-1f3ff","1faf1-1f3fb-200d-1faf2-1f3fc","1faf1-1f3fb-200d-1faf2-1f3fd","1faf1-1f3fb-200d-1faf2-1f3fe","1faf1-1f3fb-200d-1faf2-1f3ff","1faf1-1f3fc-200d-1faf2-1f3fb","1faf1-1f3fc-200d-1faf2-1f3fd","1faf1-1f3fc-200d-1faf2-1f3fe","1faf1-1f3fc-200d-1faf2-1f3ff","1faf1-1f3fd-200d-1faf2-1f3fb","1faf1-1f3fd-200d-1faf2-1f3fc","1faf1-1f3fd-200d-1faf2-1f3fe","1faf1-1f3fd-200d-1faf2-1f3ff","1faf1-1f3fe-200d-1faf2-1f3fb","1faf1-1f3fe-200d-1faf2-1f3fc","1faf1-1f3fe-200d-1faf2-1f3fd","1faf1-1f3fe-200d-1faf2-1f3ff","1faf1-1f3ff-200d-1faf2-1f3fb","1faf1-1f3ff-200d-1faf2-1f3fc","1faf1-1f3ff-200d-1faf2-1f3fd","1faf1-1f3ff-200d-1faf2-1f3fe"],a:"3"},{n:["ask","hand","pray","high 5","please","thanks","high five","folded hands"],u:"1f64f",v:["1f64f-1f3fb","1f64f-1f3fc","1f64f-1f3fd","1f64f-1f3fe","1f64f-1f3ff"],a:"0.6"},{n:["care","nail","polish","manicure","cosmetics","nail polish"],u:"1f485",v:["1f485-1f3fb","1f485-1f3fc","1f485-1f3fd","1f485-1f3fe","1f485-1f3ff"],a:"0.6"},{n:["phone","selfie","camera"],u:"1f933",v:["1f933-1f3fb","1f933-1f3fc","1f933-1f3fd","1f933-1f3fe","1f933-1f3ff"],a:"3"},{n:["flex","comic","biceps","muscle","flexed biceps"],u:"1f4aa",v:["1f4aa-1f3fb","1f4aa-1f3fc","1f4aa-1f3fd","1f4aa-1f3fe","1f4aa-1f3ff"],a:"0.6"},{n:["prosthetic","accessibility","mechanical arm"],u:"1f9be",a:"12"},{n:["prosthetic","accessibility","mechanical leg"],u:"1f9bf",a:"12"},{n:["leg","kick","limb"],u:"1f9b5",v:["1f9b5-1f3fb","1f9b5-1f3fc","1f9b5-1f3fd","1f9b5-1f3fe","1f9b5-1f3ff"],a:"11"},{n:["foot","kick","stomp"],u:"1f9b6",v:["1f9b6-1f3fb","1f9b6-1f3fc","1f9b6-1f3fd","1f9b6-1f3fe","1f9b6-1f3ff"],a:"11"},{n:["ear","body"],u:"1f442",v:["1f442-1f3fb","1f442-1f3fc","1f442-1f3fd","1f442-1f3fe","1f442-1f3ff"],a:"0.6"},{n:["accessibility","hard of hearing","ear with hearing aid"],u:"1f9bb",v:["1f9bb-1f3fb","1f9bb-1f3fc","1f9bb-1f3fd","1f9bb-1f3fe","1f9bb-1f3ff"],a:"12"},{n:["nose","body"],u:"1f443",v:["1f443-1f3fb","1f443-1f3fc","1f443-1f3fd","1f443-1f3fe","1f443-1f3ff"],a:"0.6"},{n:["brain","intelligent"],u:"1f9e0",a:"5"},{n:["heart","organ","pulse","anatomical","cardiology","anatomical heart"],u:"1fac0",a:"13"},{n:["lungs","organ","breath","exhalation","inhalation","respiration"],u:"1fac1",a:"13"},{n:["tooth","dentist"],u:"1f9b7",a:"11"},{n:["bone","skeleton"],u:"1f9b4",a:"11"},{n:["eye","eyes","face"],u:"1f440",a:"0.6"},{n:["body","tongue"],u:"1f445",a:"0.6"},{n:["lips","mouth"],u:"1f444",a:"0.6"},{n:["fear","anxious","nervous","worried","flirting","biting lip","uncomfortable"],u:"1fae6",a:"14"},{n:["baby","young"],u:"1f476",v:["1f476-1f3fb","1f476-1f3fc","1f476-1f3fd","1f476-1f3fe","1f476-1f3ff"],a:"0.6"},{n:["child","young","gender neutral","unspecified gender"],u:"1f9d2",v:["1f9d2-1f3fb","1f9d2-1f3fc","1f9d2-1f3fd","1f9d2-1f3fe","1f9d2-1f3ff"],a:"5"},{n:["boy","young"],u:"1f466",v:["1f466-1f3fb","1f466-1f3fc","1f466-1f3fd","1f466-1f3fe","1f466-1f3ff"],a:"0.6"},{n:["girl","virgo","young","zodiac"],u:"1f467",v:["1f467-1f3fb","1f467-1f3fc","1f467-1f3fd","1f467-1f3fe","1f467-1f3ff"],a:"0.6"},{n:["adult","person","gender neutral","unspecified gender"],u:"1f9d1",v:["1f9d1-1f3fb","1f9d1-1f3fc","1f9d1-1f3fd","1f9d1-1f3fe","1f9d1-1f3ff"],a:"5"},{n:["hair","blond","person: blond hair","blond haired person"],u:"1f471",v:["1f471-1f3fb","1f471-1f3fc","1f471-1f3fd","1f471-1f3fe","1f471-1f3ff"],a:"0.6"},{n:["man","adult"],u:"1f468",v:["1f468-1f3fb","1f468-1f3fc","1f468-1f3fd","1f468-1f3fe","1f468-1f3ff"],a:"0.6"},{n:["beard","person","person: beard"],u:"1f9d4",v:["1f9d4-1f3fb","1f9d4-1f3fc","1f9d4-1f3fd","1f9d4-1f3fe","1f9d4-1f3ff"],a:"5"},{n:["man","beard","man: beard"],u:"1f9d4-200d-2642-fe0f",v:["1f9d4-1f3fb-200d-2642-fe0f","1f9d4-1f3fc-200d-2642-fe0f","1f9d4-1f3fd-200d-2642-fe0f","1f9d4-1f3fe-200d-2642-fe0f","1f9d4-1f3ff-200d-2642-fe0f"],a:"13.1"},{n:["beard","woman","woman: beard"],u:"1f9d4-200d-2640-fe0f",v:["1f9d4-1f3fb-200d-2640-fe0f","1f9d4-1f3fc-200d-2640-fe0f","1f9d4-1f3fd-200d-2640-fe0f","1f9d4-1f3fe-200d-2640-fe0f","1f9d4-1f3ff-200d-2640-fe0f"],a:"13.1"},{n:["man","adult","red hair","man: red hair"],u:"1f468-200d-1f9b0",v:["1f468-1f3fb-200d-1f9b0","1f468-1f3fc-200d-1f9b0","1f468-1f3fd-200d-1f9b0","1f468-1f3fe-200d-1f9b0","1f468-1f3ff-200d-1f9b0"],a:"11"},{n:["man","adult","curly hair","man: curly hair"],u:"1f468-200d-1f9b1",v:["1f468-1f3fb-200d-1f9b1","1f468-1f3fc-200d-1f9b1","1f468-1f3fd-200d-1f9b1","1f468-1f3fe-200d-1f9b1","1f468-1f3ff-200d-1f9b1"],a:"11"},{n:["man","adult","white hair","man: white hair"],u:"1f468-200d-1f9b3",v:["1f468-1f3fb-200d-1f9b3","1f468-1f3fc-200d-1f9b3","1f468-1f3fd-200d-1f9b3","1f468-1f3fe-200d-1f9b3","1f468-1f3ff-200d-1f9b3"],a:"11"},{n:["man","bald","adult","man: bald"],u:"1f468-200d-1f9b2",v:["1f468-1f3fb-200d-1f9b2","1f468-1f3fc-200d-1f9b2","1f468-1f3fd-200d-1f9b2","1f468-1f3fe-200d-1f9b2","1f468-1f3ff-200d-1f9b2"],a:"11"},{n:["woman","adult"],u:"1f469",v:["1f469-1f3fb","1f469-1f3fc","1f469-1f3fd","1f469-1f3fe","1f469-1f3ff"],a:"0.6"},{n:["adult","woman","red hair","woman: red hair"],u:"1f469-200d-1f9b0",v:["1f469-1f3fb-200d-1f9b0","1f469-1f3fc-200d-1f9b0","1f469-1f3fd-200d-1f9b0","1f469-1f3fe-200d-1f9b0","1f469-1f3ff-200d-1f9b0"],a:"11"},{n:["adult","person","red hair","gender neutral","person: red hair","unspecified gender"],u:"1f9d1-200d-1f9b0",v:["1f9d1-1f3fb-200d-1f9b0","1f9d1-1f3fc-200d-1f9b0","1f9d1-1f3fd-200d-1f9b0","1f9d1-1f3fe-200d-1f9b0","1f9d1-1f3ff-200d-1f9b0"],a:"12.1"},{n:["adult","woman","curly hair","woman: curly hair"],u:"1f469-200d-1f9b1",v:["1f469-1f3fb-200d-1f9b1","1f469-1f3fc-200d-1f9b1","1f469-1f3fd-200d-1f9b1","1f469-1f3fe-200d-1f9b1","1f469-1f3ff-200d-1f9b1"],a:"11"},{n:["adult","person","curly hair","gender neutral","person: curly hair","unspecified gender"],u:"1f9d1-200d-1f9b1",v:["1f9d1-1f3fb-200d-1f9b1","1f9d1-1f3fc-200d-1f9b1","1f9d1-1f3fd-200d-1f9b1","1f9d1-1f3fe-200d-1f9b1","1f9d1-1f3ff-200d-1f9b1"],a:"12.1"},{n:["adult","woman","white hair","woman: white hair"],u:"1f469-200d-1f9b3",v:["1f469-1f3fb-200d-1f9b3","1f469-1f3fc-200d-1f9b3","1f469-1f3fd-200d-1f9b3","1f469-1f3fe-200d-1f9b3","1f469-1f3ff-200d-1f9b3"],a:"11"},{n:["adult","person","white hair","gender neutral","person: white hair","unspecified gender"],u:"1f9d1-200d-1f9b3",v:["1f9d1-1f3fb-200d-1f9b3","1f9d1-1f3fc-200d-1f9b3","1f9d1-1f3fd-200d-1f9b3","1f9d1-1f3fe-200d-1f9b3","1f9d1-1f3ff-200d-1f9b3"],a:"12.1"},{n:["bald","adult","woman","woman: bald"],u:"1f469-200d-1f9b2",v:["1f469-1f3fb-200d-1f9b2","1f469-1f3fc-200d-1f9b2","1f469-1f3fd-200d-1f9b2","1f469-1f3fe-200d-1f9b2","1f469-1f3ff-200d-1f9b2"],a:"11"},{n:["bald","adult","person","person: bald","gender neutral","unspecified gender"],u:"1f9d1-200d-1f9b2",v:["1f9d1-1f3fb-200d-1f9b2","1f9d1-1f3fc-200d-1f9b2","1f9d1-1f3fd-200d-1f9b2","1f9d1-1f3fe-200d-1f9b2","1f9d1-1f3ff-200d-1f9b2"],a:"12.1"},{n:["hair","woman","blonde","woman: blond hair","blond haired woman"],u:"1f471-200d-2640-fe0f",v:["1f471-1f3fb-200d-2640-fe0f","1f471-1f3fc-200d-2640-fe0f","1f471-1f3fd-200d-2640-fe0f","1f471-1f3fe-200d-2640-fe0f","1f471-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","hair","blond","man: blond hair","blond haired man"],u:"1f471-200d-2642-fe0f",v:["1f471-1f3fb-200d-2642-fe0f","1f471-1f3fc-200d-2642-fe0f","1f471-1f3fd-200d-2642-fe0f","1f471-1f3fe-200d-2642-fe0f","1f471-1f3ff-200d-2642-fe0f"],a:"4"},{n:["old","adult","older person","gender neutral","unspecified gender"],u:"1f9d3",v:["1f9d3-1f3fb","1f9d3-1f3fc","1f9d3-1f3fd","1f9d3-1f3fe","1f9d3-1f3ff"],a:"5"},{n:["man","old","adult","old man"],u:"1f474",v:["1f474-1f3fb","1f474-1f3fc","1f474-1f3fd","1f474-1f3fe","1f474-1f3ff"],a:"0.6"},{n:["old","adult","woman","old woman"],u:"1f475",v:["1f475-1f3fb","1f475-1f3fc","1f475-1f3fd","1f475-1f3fe","1f475-1f3ff"],a:"0.6"},{n:["frown","gesture","person frowning"],u:"1f64d",v:["1f64d-1f3fb","1f64d-1f3fc","1f64d-1f3fd","1f64d-1f3fe","1f64d-1f3ff"],a:"0.6"},{n:["man","gesture","frowning","man frowning"],u:"1f64d-200d-2642-fe0f",v:["1f64d-1f3fb-200d-2642-fe0f","1f64d-1f3fc-200d-2642-fe0f","1f64d-1f3fd-200d-2642-fe0f","1f64d-1f3fe-200d-2642-fe0f","1f64d-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","gesture","frowning","woman frowning"],u:"1f64d-200d-2640-fe0f",v:["1f64d-1f3fb-200d-2640-fe0f","1f64d-1f3fc-200d-2640-fe0f","1f64d-1f3fd-200d-2640-fe0f","1f64d-1f3fe-200d-2640-fe0f","1f64d-1f3ff-200d-2640-fe0f"],a:"4"},{n:["gesture","pouting","person pouting"],u:"1f64e",v:["1f64e-1f3fb","1f64e-1f3fc","1f64e-1f3fd","1f64e-1f3fe","1f64e-1f3ff"],a:"0.6"},{n:["man","gesture","pouting","man pouting"],u:"1f64e-200d-2642-fe0f",v:["1f64e-1f3fb-200d-2642-fe0f","1f64e-1f3fc-200d-2642-fe0f","1f64e-1f3fd-200d-2642-fe0f","1f64e-1f3fe-200d-2642-fe0f","1f64e-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","gesture","pouting","woman pouting"],u:"1f64e-200d-2640-fe0f",v:["1f64e-1f3fb-200d-2640-fe0f","1f64e-1f3fc-200d-2640-fe0f","1f64e-1f3fd-200d-2640-fe0f","1f64e-1f3fe-200d-2640-fe0f","1f64e-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hand","gesture","forbidden","prohibited","person gesturing NO","person gesturing no"],u:"1f645",v:["1f645-1f3fb","1f645-1f3fc","1f645-1f3fd","1f645-1f3fe","1f645-1f3ff"],a:"0.6"},{n:["man","hand","gesture","forbidden","prohibited","man gesturing NO","man gesturing no"],u:"1f645-200d-2642-fe0f",v:["1f645-1f3fb-200d-2642-fe0f","1f645-1f3fc-200d-2642-fe0f","1f645-1f3fd-200d-2642-fe0f","1f645-1f3fe-200d-2642-fe0f","1f645-1f3ff-200d-2642-fe0f"],a:"4"},{n:["hand","woman","gesture","forbidden","prohibited","woman gesturing NO","woman gesturing no"],u:"1f645-200d-2640-fe0f",v:["1f645-1f3fb-200d-2640-fe0f","1f645-1f3fc-200d-2640-fe0f","1f645-1f3fd-200d-2640-fe0f","1f645-1f3fe-200d-2640-fe0f","1f645-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ok","hand","gesture","person gesturing OK","person gesturing ok"],u:"1f646",v:["1f646-1f3fb","1f646-1f3fc","1f646-1f3fd","1f646-1f3fe","1f646-1f3ff"],a:"0.6"},{n:["ok","man","hand","gesture","man gesturing OK","man gesturing ok"],u:"1f646-200d-2642-fe0f",v:["1f646-1f3fb-200d-2642-fe0f","1f646-1f3fc-200d-2642-fe0f","1f646-1f3fd-200d-2642-fe0f","1f646-1f3fe-200d-2642-fe0f","1f646-1f3ff-200d-2642-fe0f"],a:"4"},{n:["ok","hand","woman","gesture","woman gesturing OK","woman gesturing ok"],u:"1f646-200d-2640-fe0f",v:["1f646-1f3fb-200d-2640-fe0f","1f646-1f3fc-200d-2640-fe0f","1f646-1f3fd-200d-2640-fe0f","1f646-1f3fe-200d-2640-fe0f","1f646-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hand","help","sassy","tipping","information","person tipping hand"],u:"1f481",v:["1f481-1f3fb","1f481-1f3fc","1f481-1f3fd","1f481-1f3fe","1f481-1f3ff"],a:"0.6"},{n:["man","sassy","tipping hand","man tipping hand"],u:"1f481-200d-2642-fe0f",v:["1f481-1f3fb-200d-2642-fe0f","1f481-1f3fc-200d-2642-fe0f","1f481-1f3fd-200d-2642-fe0f","1f481-1f3fe-200d-2642-fe0f","1f481-1f3ff-200d-2642-fe0f"],a:"4"},{n:["sassy","woman","tipping hand","woman tipping hand"],u:"1f481-200d-2640-fe0f",v:["1f481-1f3fb-200d-2640-fe0f","1f481-1f3fc-200d-2640-fe0f","1f481-1f3fd-200d-2640-fe0f","1f481-1f3fe-200d-2640-fe0f","1f481-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hand","happy","raised","gesture","person raising hand"],u:"1f64b",v:["1f64b-1f3fb","1f64b-1f3fc","1f64b-1f3fd","1f64b-1f3fe","1f64b-1f3ff"],a:"0.6"},{n:["man","gesture","raising hand","man raising hand"],u:"1f64b-200d-2642-fe0f",v:["1f64b-1f3fb-200d-2642-fe0f","1f64b-1f3fc-200d-2642-fe0f","1f64b-1f3fd-200d-2642-fe0f","1f64b-1f3fe-200d-2642-fe0f","1f64b-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","gesture","raising hand","woman raising hand"],u:"1f64b-200d-2640-fe0f",v:["1f64b-1f3fb-200d-2640-fe0f","1f64b-1f3fc-200d-2640-fe0f","1f64b-1f3fd-200d-2640-fe0f","1f64b-1f3fe-200d-2640-fe0f","1f64b-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ear","deaf","hear","deaf person","accessibility"],u:"1f9cf",v:["1f9cf-1f3fb","1f9cf-1f3fc","1f9cf-1f3fd","1f9cf-1f3fe","1f9cf-1f3ff"],a:"12"},{n:["man","deaf","deaf man"],u:"1f9cf-200d-2642-fe0f",v:["1f9cf-1f3fb-200d-2642-fe0f","1f9cf-1f3fc-200d-2642-fe0f","1f9cf-1f3fd-200d-2642-fe0f","1f9cf-1f3fe-200d-2642-fe0f","1f9cf-1f3ff-200d-2642-fe0f"],a:"12"},{n:["deaf","woman","deaf woman"],u:"1f9cf-200d-2640-fe0f",v:["1f9cf-1f3fb-200d-2640-fe0f","1f9cf-1f3fc-200d-2640-fe0f","1f9cf-1f3fd-200d-2640-fe0f","1f9cf-1f3fe-200d-2640-fe0f","1f9cf-1f3ff-200d-2640-fe0f"],a:"12"},{n:["bow","sorry","apology","gesture","person bowing"],u:"1f647",v:["1f647-1f3fb","1f647-1f3fc","1f647-1f3fd","1f647-1f3fe","1f647-1f3ff"],a:"0.6"},{n:["man","favor","sorry","bowing","apology","gesture","man bowing"],u:"1f647-200d-2642-fe0f",v:["1f647-1f3fb-200d-2642-fe0f","1f647-1f3fc-200d-2642-fe0f","1f647-1f3fd-200d-2642-fe0f","1f647-1f3fe-200d-2642-fe0f","1f647-1f3ff-200d-2642-fe0f"],a:"4"},{n:["favor","sorry","woman","bowing","apology","gesture","woman bowing"],u:"1f647-200d-2640-fe0f",v:["1f647-1f3fb-200d-2640-fe0f","1f647-1f3fc-200d-2640-fe0f","1f647-1f3fd-200d-2640-fe0f","1f647-1f3fe-200d-2640-fe0f","1f647-1f3ff-200d-2640-fe0f"],a:"4"},{n:["face","palm","disbelief","exasperation","person facepalming"],u:"1f926",v:["1f926-1f3fb","1f926-1f3fc","1f926-1f3fd","1f926-1f3fe","1f926-1f3ff"],a:"3"},{n:["man","facepalm","disbelief","exasperation","man facepalming"],u:"1f926-200d-2642-fe0f",v:["1f926-1f3fb-200d-2642-fe0f","1f926-1f3fc-200d-2642-fe0f","1f926-1f3fd-200d-2642-fe0f","1f926-1f3fe-200d-2642-fe0f","1f926-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","facepalm","disbelief","exasperation","woman facepalming"],u:"1f926-200d-2640-fe0f",v:["1f926-1f3fb-200d-2640-fe0f","1f926-1f3fc-200d-2640-fe0f","1f926-1f3fd-200d-2640-fe0f","1f926-1f3fe-200d-2640-fe0f","1f926-1f3ff-200d-2640-fe0f"],a:"4"},{n:["doubt","shrug","ignorance","indifference","person shrugging"],u:"1f937",v:["1f937-1f3fb","1f937-1f3fc","1f937-1f3fd","1f937-1f3fe","1f937-1f3ff"],a:"3"},{n:["man","doubt","shrug","ignorance","indifference","man shrugging"],u:"1f937-200d-2642-fe0f",v:["1f937-1f3fb-200d-2642-fe0f","1f937-1f3fc-200d-2642-fe0f","1f937-1f3fd-200d-2642-fe0f","1f937-1f3fe-200d-2642-fe0f","1f937-1f3ff-200d-2642-fe0f"],a:"4"},{n:["doubt","shrug","woman","ignorance","indifference","woman shrugging"],u:"1f937-200d-2640-fe0f",v:["1f937-1f3fb-200d-2640-fe0f","1f937-1f3fc-200d-2640-fe0f","1f937-1f3fd-200d-2640-fe0f","1f937-1f3fe-200d-2640-fe0f","1f937-1f3ff-200d-2640-fe0f"],a:"4"},{n:["nurse","doctor","therapist","healthcare","health worker"],u:"1f9d1-200d-2695-fe0f",v:["1f9d1-1f3fb-200d-2695-fe0f","1f9d1-1f3fc-200d-2695-fe0f","1f9d1-1f3fd-200d-2695-fe0f","1f9d1-1f3fe-200d-2695-fe0f","1f9d1-1f3ff-200d-2695-fe0f"],a:"12.1"},{n:["man","nurse","doctor","therapist","healthcare","man health worker"],u:"1f468-200d-2695-fe0f",v:["1f468-1f3fb-200d-2695-fe0f","1f468-1f3fc-200d-2695-fe0f","1f468-1f3fd-200d-2695-fe0f","1f468-1f3fe-200d-2695-fe0f","1f468-1f3ff-200d-2695-fe0f"],a:"4"},{n:["nurse","woman","doctor","therapist","healthcare","woman health worker"],u:"1f469-200d-2695-fe0f",v:["1f469-1f3fb-200d-2695-fe0f","1f469-1f3fc-200d-2695-fe0f","1f469-1f3fd-200d-2695-fe0f","1f469-1f3fe-200d-2695-fe0f","1f469-1f3ff-200d-2695-fe0f"],a:"4"},{n:["student","graduate"],u:"1f9d1-200d-1f393",v:["1f9d1-1f3fb-200d-1f393","1f9d1-1f3fc-200d-1f393","1f9d1-1f3fd-200d-1f393","1f9d1-1f3fe-200d-1f393","1f9d1-1f3ff-200d-1f393"],a:"12.1"},{n:["man","student","graduate","man student"],u:"1f468-200d-1f393",v:["1f468-1f3fb-200d-1f393","1f468-1f3fc-200d-1f393","1f468-1f3fd-200d-1f393","1f468-1f3fe-200d-1f393","1f468-1f3ff-200d-1f393"],a:"4"},{n:["woman","student","graduate","woman student"],u:"1f469-200d-1f393",v:["1f469-1f3fb-200d-1f393","1f469-1f3fc-200d-1f393","1f469-1f3fd-200d-1f393","1f469-1f3fe-200d-1f393","1f469-1f3ff-200d-1f393"],a:"4"},{n:["teacher","lecturer","professor","instructor"],u:"1f9d1-200d-1f3eb",v:["1f9d1-1f3fb-200d-1f3eb","1f9d1-1f3fc-200d-1f3eb","1f9d1-1f3fd-200d-1f3eb","1f9d1-1f3fe-200d-1f3eb","1f9d1-1f3ff-200d-1f3eb"],a:"12.1"},{n:["man","teacher","lecturer","professor","instructor","man teacher"],u:"1f468-200d-1f3eb",v:["1f468-1f3fb-200d-1f3eb","1f468-1f3fc-200d-1f3eb","1f468-1f3fd-200d-1f3eb","1f468-1f3fe-200d-1f3eb","1f468-1f3ff-200d-1f3eb"],a:"4"},{n:["woman","teacher","lecturer","professor","instructor","woman teacher"],u:"1f469-200d-1f3eb",v:["1f469-1f3fb-200d-1f3eb","1f469-1f3fc-200d-1f3eb","1f469-1f3fd-200d-1f3eb","1f469-1f3fe-200d-1f3eb","1f469-1f3ff-200d-1f3eb"],a:"4"},{n:["law","judge","scales","justice"],u:"1f9d1-200d-2696-fe0f",v:["1f9d1-1f3fb-200d-2696-fe0f","1f9d1-1f3fc-200d-2696-fe0f","1f9d1-1f3fd-200d-2696-fe0f","1f9d1-1f3fe-200d-2696-fe0f","1f9d1-1f3ff-200d-2696-fe0f"],a:"12.1"},{n:["law","man","judge","scales","justice","man judge"],u:"1f468-200d-2696-fe0f",v:["1f468-1f3fb-200d-2696-fe0f","1f468-1f3fc-200d-2696-fe0f","1f468-1f3fd-200d-2696-fe0f","1f468-1f3fe-200d-2696-fe0f","1f468-1f3ff-200d-2696-fe0f"],a:"4"},{n:["law","judge","woman","scales","justice","woman judge"],u:"1f469-200d-2696-fe0f",v:["1f469-1f3fb-200d-2696-fe0f","1f469-1f3fc-200d-2696-fe0f","1f469-1f3fd-200d-2696-fe0f","1f469-1f3fe-200d-2696-fe0f","1f469-1f3ff-200d-2696-fe0f"],a:"4"},{n:["farmer","rancher","gardener"],u:"1f9d1-200d-1f33e",v:["1f9d1-1f3fb-200d-1f33e","1f9d1-1f3fc-200d-1f33e","1f9d1-1f3fd-200d-1f33e","1f9d1-1f3fe-200d-1f33e","1f9d1-1f3ff-200d-1f33e"],a:"12.1"},{n:["man","farmer","rancher","gardener","man farmer"],u:"1f468-200d-1f33e",v:["1f468-1f3fb-200d-1f33e","1f468-1f3fc-200d-1f33e","1f468-1f3fd-200d-1f33e","1f468-1f3fe-200d-1f33e","1f468-1f3ff-200d-1f33e"],a:"4"},{n:["woman","farmer","rancher","gardener","woman farmer"],u:"1f469-200d-1f33e",v:["1f469-1f3fb-200d-1f33e","1f469-1f3fc-200d-1f33e","1f469-1f3fd-200d-1f33e","1f469-1f3fe-200d-1f33e","1f469-1f3ff-200d-1f33e"],a:"4"},{n:["cook","chef"],u:"1f9d1-200d-1f373",v:["1f9d1-1f3fb-200d-1f373","1f9d1-1f3fc-200d-1f373","1f9d1-1f3fd-200d-1f373","1f9d1-1f3fe-200d-1f373","1f9d1-1f3ff-200d-1f373"],a:"12.1"},{n:["man","chef","cook","man cook"],u:"1f468-200d-1f373",v:["1f468-1f3fb-200d-1f373","1f468-1f3fc-200d-1f373","1f468-1f3fd-200d-1f373","1f468-1f3fe-200d-1f373","1f468-1f3ff-200d-1f373"],a:"4"},{n:["chef","cook","woman","woman cook"],u:"1f469-200d-1f373",v:["1f469-1f3fb-200d-1f373","1f469-1f3fc-200d-1f373","1f469-1f3fd-200d-1f373","1f469-1f3fe-200d-1f373","1f469-1f3ff-200d-1f373"],a:"4"},{n:["plumber","mechanic","electrician","tradesperson"],u:"1f9d1-200d-1f527",v:["1f9d1-1f3fb-200d-1f527","1f9d1-1f3fc-200d-1f527","1f9d1-1f3fd-200d-1f527","1f9d1-1f3fe-200d-1f527","1f9d1-1f3ff-200d-1f527"],a:"12.1"},{n:["man","plumber","mechanic","electrician","man mechanic","tradesperson"],u:"1f468-200d-1f527",v:["1f468-1f3fb-200d-1f527","1f468-1f3fc-200d-1f527","1f468-1f3fd-200d-1f527","1f468-1f3fe-200d-1f527","1f468-1f3ff-200d-1f527"],a:"4"},{n:["woman","plumber","mechanic","electrician","tradesperson","woman mechanic"],u:"1f469-200d-1f527",v:["1f469-1f3fb-200d-1f527","1f469-1f3fc-200d-1f527","1f469-1f3fd-200d-1f527","1f469-1f3fe-200d-1f527","1f469-1f3ff-200d-1f527"],a:"4"},{n:["worker","factory","assembly","industrial","factory worker"],u:"1f9d1-200d-1f3ed",v:["1f9d1-1f3fb-200d-1f3ed","1f9d1-1f3fc-200d-1f3ed","1f9d1-1f3fd-200d-1f3ed","1f9d1-1f3fe-200d-1f3ed","1f9d1-1f3ff-200d-1f3ed"],a:"12.1"},{n:["man","worker","factory","assembly","industrial","man factory worker"],u:"1f468-200d-1f3ed",v:["1f468-1f3fb-200d-1f3ed","1f468-1f3fc-200d-1f3ed","1f468-1f3fd-200d-1f3ed","1f468-1f3fe-200d-1f3ed","1f468-1f3ff-200d-1f3ed"],a:"4"},{n:["woman","worker","factory","assembly","industrial","woman factory worker"],u:"1f469-200d-1f3ed",v:["1f469-1f3fb-200d-1f3ed","1f469-1f3fc-200d-1f3ed","1f469-1f3fd-200d-1f3ed","1f469-1f3fe-200d-1f3ed","1f469-1f3ff-200d-1f3ed"],a:"4"},{n:["manager","business","architect","white collar","office worker"],u:"1f9d1-200d-1f4bc",v:["1f9d1-1f3fb-200d-1f4bc","1f9d1-1f3fc-200d-1f4bc","1f9d1-1f3fd-200d-1f4bc","1f9d1-1f3fe-200d-1f4bc","1f9d1-1f3ff-200d-1f4bc"],a:"12.1"},{n:["man","manager","business","architect","white collar","man office worker"],u:"1f468-200d-1f4bc",v:["1f468-1f3fb-200d-1f4bc","1f468-1f3fc-200d-1f4bc","1f468-1f3fd-200d-1f4bc","1f468-1f3fe-200d-1f4bc","1f468-1f3ff-200d-1f4bc"],a:"4"},{n:["woman","manager","business","architect","white collar","woman office worker"],u:"1f469-200d-1f4bc",v:["1f469-1f3fb-200d-1f4bc","1f469-1f3fc-200d-1f4bc","1f469-1f3fd-200d-1f4bc","1f469-1f3fe-200d-1f4bc","1f469-1f3ff-200d-1f4bc"],a:"4"},{n:["chemist","engineer","scientist","biologist","physicist"],u:"1f9d1-200d-1f52c",v:["1f9d1-1f3fb-200d-1f52c","1f9d1-1f3fc-200d-1f52c","1f9d1-1f3fd-200d-1f52c","1f9d1-1f3fe-200d-1f52c","1f9d1-1f3ff-200d-1f52c"],a:"12.1"},{n:["man","chemist","engineer","biologist","physicist","scientist","man scientist"],u:"1f468-200d-1f52c",v:["1f468-1f3fb-200d-1f52c","1f468-1f3fc-200d-1f52c","1f468-1f3fd-200d-1f52c","1f468-1f3fe-200d-1f52c","1f468-1f3ff-200d-1f52c"],a:"4"},{n:["woman","chemist","engineer","biologist","physicist","scientist","woman scientist"],u:"1f469-200d-1f52c",v:["1f469-1f3fb-200d-1f52c","1f469-1f3fc-200d-1f52c","1f469-1f3fd-200d-1f52c","1f469-1f3fe-200d-1f52c","1f469-1f3ff-200d-1f52c"],a:"4"},{n:["coder","inventor","software","developer","technologist"],u:"1f9d1-200d-1f4bb",v:["1f9d1-1f3fb-200d-1f4bb","1f9d1-1f3fc-200d-1f4bb","1f9d1-1f3fd-200d-1f4bb","1f9d1-1f3fe-200d-1f4bb","1f9d1-1f3ff-200d-1f4bb"],a:"12.1"},{n:["man","coder","inventor","software","developer","technologist","man technologist"],u:"1f468-200d-1f4bb",v:["1f468-1f3fb-200d-1f4bb","1f468-1f3fc-200d-1f4bb","1f468-1f3fd-200d-1f4bb","1f468-1f3fe-200d-1f4bb","1f468-1f3ff-200d-1f4bb"],a:"4"},{n:["coder","woman","inventor","software","developer","technologist","woman technologist"],u:"1f469-200d-1f4bb",v:["1f469-1f3fb-200d-1f4bb","1f469-1f3fc-200d-1f4bb","1f469-1f3fd-200d-1f4bb","1f469-1f3fe-200d-1f4bb","1f469-1f3ff-200d-1f4bb"],a:"4"},{n:["rock","star","actor","singer","entertainer"],u:"1f9d1-200d-1f3a4",v:["1f9d1-1f3fb-200d-1f3a4","1f9d1-1f3fc-200d-1f3a4","1f9d1-1f3fd-200d-1f3a4","1f9d1-1f3fe-200d-1f3a4","1f9d1-1f3ff-200d-1f3a4"],a:"12.1"},{n:["man","rock","star","actor","singer","man singer","entertainer"],u:"1f468-200d-1f3a4",v:["1f468-1f3fb-200d-1f3a4","1f468-1f3fc-200d-1f3a4","1f468-1f3fd-200d-1f3a4","1f468-1f3fe-200d-1f3a4","1f468-1f3ff-200d-1f3a4"],a:"4"},{n:["rock","star","actor","woman","singer","entertainer","woman singer"],u:"1f469-200d-1f3a4",v:["1f469-1f3fb-200d-1f3a4","1f469-1f3fc-200d-1f3a4","1f469-1f3fd-200d-1f3a4","1f469-1f3fe-200d-1f3a4","1f469-1f3ff-200d-1f3a4"],a:"4"},{n:["artist","palette"],u:"1f9d1-200d-1f3a8",v:["1f9d1-1f3fb-200d-1f3a8","1f9d1-1f3fc-200d-1f3a8","1f9d1-1f3fd-200d-1f3a8","1f9d1-1f3fe-200d-1f3a8","1f9d1-1f3ff-200d-1f3a8"],a:"12.1"},{n:["man","artist","palette","man artist"],u:"1f468-200d-1f3a8",v:["1f468-1f3fb-200d-1f3a8","1f468-1f3fc-200d-1f3a8","1f468-1f3fd-200d-1f3a8","1f468-1f3fe-200d-1f3a8","1f468-1f3ff-200d-1f3a8"],a:"4"},{n:["woman","artist","palette","woman artist"],u:"1f469-200d-1f3a8",v:["1f469-1f3fb-200d-1f3a8","1f469-1f3fc-200d-1f3a8","1f469-1f3fd-200d-1f3a8","1f469-1f3fe-200d-1f3a8","1f469-1f3ff-200d-1f3a8"],a:"4"},{n:["pilot","plane"],u:"1f9d1-200d-2708-fe0f",v:["1f9d1-1f3fb-200d-2708-fe0f","1f9d1-1f3fc-200d-2708-fe0f","1f9d1-1f3fd-200d-2708-fe0f","1f9d1-1f3fe-200d-2708-fe0f","1f9d1-1f3ff-200d-2708-fe0f"],a:"12.1"},{n:["man","pilot","plane","man pilot"],u:"1f468-200d-2708-fe0f",v:["1f468-1f3fb-200d-2708-fe0f","1f468-1f3fc-200d-2708-fe0f","1f468-1f3fd-200d-2708-fe0f","1f468-1f3fe-200d-2708-fe0f","1f468-1f3ff-200d-2708-fe0f"],a:"4"},{n:["pilot","plane","woman","woman pilot"],u:"1f469-200d-2708-fe0f",v:["1f469-1f3fb-200d-2708-fe0f","1f469-1f3fc-200d-2708-fe0f","1f469-1f3fd-200d-2708-fe0f","1f469-1f3fe-200d-2708-fe0f","1f469-1f3ff-200d-2708-fe0f"],a:"4"},{n:["rocket","astronaut"],u:"1f9d1-200d-1f680",v:["1f9d1-1f3fb-200d-1f680","1f9d1-1f3fc-200d-1f680","1f9d1-1f3fd-200d-1f680","1f9d1-1f3fe-200d-1f680","1f9d1-1f3ff-200d-1f680"],a:"12.1"},{n:["man","rocket","astronaut","man astronaut"],u:"1f468-200d-1f680",v:["1f468-1f3fb-200d-1f680","1f468-1f3fc-200d-1f680","1f468-1f3fd-200d-1f680","1f468-1f3fe-200d-1f680","1f468-1f3ff-200d-1f680"],a:"4"},{n:["woman","rocket","astronaut","woman astronaut"],u:"1f469-200d-1f680",v:["1f469-1f3fb-200d-1f680","1f469-1f3fc-200d-1f680","1f469-1f3fd-200d-1f680","1f469-1f3fe-200d-1f680","1f469-1f3ff-200d-1f680"],a:"4"},{n:["fire","firetruck","firefighter"],u:"1f9d1-200d-1f692",v:["1f9d1-1f3fb-200d-1f692","1f9d1-1f3fc-200d-1f692","1f9d1-1f3fd-200d-1f692","1f9d1-1f3fe-200d-1f692","1f9d1-1f3ff-200d-1f692"],a:"12.1"},{n:["man","firetruck","firefighter","man firefighter"],u:"1f468-200d-1f692",v:["1f468-1f3fb-200d-1f692","1f468-1f3fc-200d-1f692","1f468-1f3fd-200d-1f692","1f468-1f3fe-200d-1f692","1f468-1f3ff-200d-1f692"],a:"4"},{n:["woman","firetruck","firefighter","woman firefighter"],u:"1f469-200d-1f692",v:["1f469-1f3fb-200d-1f692","1f469-1f3fc-200d-1f692","1f469-1f3fd-200d-1f692","1f469-1f3fe-200d-1f692","1f469-1f3ff-200d-1f692"],a:"4"},{n:["cop","police","officer","police officer"],u:"1f46e",v:["1f46e-1f3fb","1f46e-1f3fc","1f46e-1f3fd","1f46e-1f3fe","1f46e-1f3ff"],a:"0.6"},{n:["cop","man","police","officer","man police officer"],u:"1f46e-200d-2642-fe0f",v:["1f46e-1f3fb-200d-2642-fe0f","1f46e-1f3fc-200d-2642-fe0f","1f46e-1f3fd-200d-2642-fe0f","1f46e-1f3fe-200d-2642-fe0f","1f46e-1f3ff-200d-2642-fe0f"],a:"4"},{n:["cop","woman","police","officer","woman police officer"],u:"1f46e-200d-2640-fe0f",v:["1f46e-1f3fb-200d-2640-fe0f","1f46e-1f3fc-200d-2640-fe0f","1f46e-1f3fd-200d-2640-fe0f","1f46e-1f3fe-200d-2640-fe0f","1f46e-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","spy","sleuth","detective","man detective"],u:"1f575-fe0f-200d-2642-fe0f",v:["1f575-1f3fb-200d-2642-fe0f","1f575-1f3fc-200d-2642-fe0f","1f575-1f3fd-200d-2642-fe0f","1f575-1f3fe-200d-2642-fe0f","1f575-1f3ff-200d-2642-fe0f"],a:"4"},{n:["spy","woman","sleuth","detective","woman detective"],u:"1f575-fe0f-200d-2640-fe0f",v:["1f575-1f3fb-200d-2640-fe0f","1f575-1f3fc-200d-2640-fe0f","1f575-1f3fd-200d-2640-fe0f","1f575-1f3fe-200d-2640-fe0f","1f575-1f3ff-200d-2640-fe0f"],a:"4"},{n:["guard"],u:"1f482",v:["1f482-1f3fb","1f482-1f3fc","1f482-1f3fd","1f482-1f3fe","1f482-1f3ff"],a:"0.6"},{n:["man","guard","man guard"],u:"1f482-200d-2642-fe0f",v:["1f482-1f3fb-200d-2642-fe0f","1f482-1f3fc-200d-2642-fe0f","1f482-1f3fd-200d-2642-fe0f","1f482-1f3fe-200d-2642-fe0f","1f482-1f3ff-200d-2642-fe0f"],a:"4"},{n:["guard","woman","woman guard"],u:"1f482-200d-2640-fe0f",v:["1f482-1f3fb-200d-2640-fe0f","1f482-1f3fc-200d-2640-fe0f","1f482-1f3fd-200d-2640-fe0f","1f482-1f3fe-200d-2640-fe0f","1f482-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ninja","hidden","fighter","stealth"],u:"1f977",v:["1f977-1f3fb","1f977-1f3fc","1f977-1f3fd","1f977-1f3fe","1f977-1f3ff"],a:"13"},{n:["hat","worker","construction","construction worker"],u:"1f477",v:["1f477-1f3fb","1f477-1f3fc","1f477-1f3fd","1f477-1f3fe","1f477-1f3ff"],a:"0.6"},{n:["man","worker","construction","man construction worker"],u:"1f477-200d-2642-fe0f",v:["1f477-1f3fb-200d-2642-fe0f","1f477-1f3fc-200d-2642-fe0f","1f477-1f3fd-200d-2642-fe0f","1f477-1f3fe-200d-2642-fe0f","1f477-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","worker","construction","woman construction worker"],u:"1f477-200d-2640-fe0f",v:["1f477-1f3fb-200d-2640-fe0f","1f477-1f3fc-200d-2640-fe0f","1f477-1f3fd-200d-2640-fe0f","1f477-1f3fe-200d-2640-fe0f","1f477-1f3ff-200d-2640-fe0f"],a:"4"},{n:["noble","regal","monarch","royalty","person with crown"],u:"1fac5",v:["1fac5-1f3fb","1fac5-1f3fc","1fac5-1f3fd","1fac5-1f3fe","1fac5-1f3ff"],a:"14"},{n:["prince"],u:"1f934",v:["1f934-1f3fb","1f934-1f3fc","1f934-1f3fd","1f934-1f3fe","1f934-1f3ff"],a:"3"},{n:["fantasy","princess","fairy tale"],u:"1f478",v:["1f478-1f3fb","1f478-1f3fc","1f478-1f3fd","1f478-1f3fe","1f478-1f3ff"],a:"0.6"},{n:["turban","person wearing turban"],u:"1f473",v:["1f473-1f3fb","1f473-1f3fc","1f473-1f3fd","1f473-1f3fe","1f473-1f3ff"],a:"0.6"},{n:["man","turban","man wearing turban"],u:"1f473-200d-2642-fe0f",v:["1f473-1f3fb-200d-2642-fe0f","1f473-1f3fc-200d-2642-fe0f","1f473-1f3fd-200d-2642-fe0f","1f473-1f3fe-200d-2642-fe0f","1f473-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","turban","woman wearing turban"],u:"1f473-200d-2640-fe0f",v:["1f473-1f3fb-200d-2640-fe0f","1f473-1f3fc-200d-2640-fe0f","1f473-1f3fd-200d-2640-fe0f","1f473-1f3fe-200d-2640-fe0f","1f473-1f3ff-200d-2640-fe0f"],a:"4"},{n:["cap","hat","person","skullcap","gua pi mao","person with skullcap"],u:"1f472",v:["1f472-1f3fb","1f472-1f3fc","1f472-1f3fd","1f472-1f3fe","1f472-1f3ff"],a:"0.6"},{n:["hijab","tichel","mantilla","headscarf","woman with headscarf"],u:"1f9d5",v:["1f9d5-1f3fb","1f9d5-1f3fc","1f9d5-1f3fd","1f9d5-1f3fe","1f9d5-1f3ff"],a:"5"},{n:["groom","person","tuxedo","person in tuxedo"],u:"1f935",v:["1f935-1f3fb","1f935-1f3fc","1f935-1f3fd","1f935-1f3fe","1f935-1f3ff"],a:"3"},{n:["man","tuxedo","man in tuxedo"],u:"1f935-200d-2642-fe0f",v:["1f935-1f3fb-200d-2642-fe0f","1f935-1f3fc-200d-2642-fe0f","1f935-1f3fd-200d-2642-fe0f","1f935-1f3fe-200d-2642-fe0f","1f935-1f3ff-200d-2642-fe0f"],a:"13"},{n:["woman","tuxedo","woman in tuxedo"],u:"1f935-200d-2640-fe0f",v:["1f935-1f3fb-200d-2640-fe0f","1f935-1f3fc-200d-2640-fe0f","1f935-1f3fd-200d-2640-fe0f","1f935-1f3fe-200d-2640-fe0f","1f935-1f3ff-200d-2640-fe0f"],a:"13"},{n:["veil","bride","person","wedding","person with veil"],u:"1f470",v:["1f470-1f3fb","1f470-1f3fc","1f470-1f3fd","1f470-1f3fe","1f470-1f3ff"],a:"0.6"},{n:["man","veil","man with veil"],u:"1f470-200d-2642-fe0f",v:["1f470-1f3fb-200d-2642-fe0f","1f470-1f3fc-200d-2642-fe0f","1f470-1f3fd-200d-2642-fe0f","1f470-1f3fe-200d-2642-fe0f","1f470-1f3ff-200d-2642-fe0f"],a:"13"},{n:["veil","woman","woman with veil"],u:"1f470-200d-2640-fe0f",v:["1f470-1f3fb-200d-2640-fe0f","1f470-1f3fc-200d-2640-fe0f","1f470-1f3fd-200d-2640-fe0f","1f470-1f3fe-200d-2640-fe0f","1f470-1f3ff-200d-2640-fe0f"],a:"13"},{n:["woman","pregnant","pregnant woman"],u:"1f930",v:["1f930-1f3fb","1f930-1f3fc","1f930-1f3fd","1f930-1f3fe","1f930-1f3ff"],a:"3"},{n:["full","belly","bloated","pregnant","pregnant man"],u:"1fac3",v:["1fac3-1f3fb","1fac3-1f3fc","1fac3-1f3fd","1fac3-1f3fe","1fac3-1f3ff"],a:"14"},{n:["full","belly","bloated","pregnant","pregnant person"],u:"1fac4",v:["1fac4-1f3fb","1fac4-1f3fc","1fac4-1f3fd","1fac4-1f3fe","1fac4-1f3ff"],a:"14"},{n:["baby","breast","nursing","breast feeding"],u:"1f931",v:["1f931-1f3fb","1f931-1f3fc","1f931-1f3fd","1f931-1f3fe","1f931-1f3ff"],a:"5"},{n:["baby","woman","feeding","nursing","woman feeding baby"],u:"1f469-200d-1f37c",v:["1f469-1f3fb-200d-1f37c","1f469-1f3fc-200d-1f37c","1f469-1f3fd-200d-1f37c","1f469-1f3fe-200d-1f37c","1f469-1f3ff-200d-1f37c"],a:"13"},{n:["man","baby","feeding","nursing","man feeding baby"],u:"1f468-200d-1f37c",v:["1f468-1f3fb-200d-1f37c","1f468-1f3fc-200d-1f37c","1f468-1f3fd-200d-1f37c","1f468-1f3fe-200d-1f37c","1f468-1f3ff-200d-1f37c"],a:"13"},{n:["baby","person","feeding","nursing","person feeding baby"],u:"1f9d1-200d-1f37c",v:["1f9d1-1f3fb-200d-1f37c","1f9d1-1f3fc-200d-1f37c","1f9d1-1f3fd-200d-1f37c","1f9d1-1f3fe-200d-1f37c","1f9d1-1f3ff-200d-1f37c"],a:"13"},{n:["baby","face","angel","fantasy","baby angel","fairy tale"],u:"1f47c",v:["1f47c-1f3fb","1f47c-1f3fc","1f47c-1f3fd","1f47c-1f3fe","1f47c-1f3ff"],a:"0.6"},{n:["claus","santa","father","christmas","Santa Claus","celebration"],u:"1f385",v:["1f385-1f3fb","1f385-1f3fc","1f385-1f3fd","1f385-1f3fe","1f385-1f3ff"],a:"0.6"},{n:["mrs.","claus","mother","christmas","Mrs. Claus","celebration"],u:"1f936",v:["1f936-1f3fb","1f936-1f3fc","1f936-1f3fd","1f936-1f3fe","1f936-1f3ff"],a:"3"},{n:["claus","mx claus","christmas"],u:"1f9d1-200d-1f384",v:["1f9d1-1f3fb-200d-1f384","1f9d1-1f3fc-200d-1f384","1f9d1-1f3fd-200d-1f384","1f9d1-1f3fe-200d-1f384","1f9d1-1f3ff-200d-1f384"],a:"13"},{n:["good","hero","heroine","superhero","superpower"],u:"1f9b8",v:["1f9b8-1f3fb","1f9b8-1f3fc","1f9b8-1f3fd","1f9b8-1f3fe","1f9b8-1f3ff"],a:"11"},{n:["man","good","hero","superpower","man superhero"],u:"1f9b8-200d-2642-fe0f",v:["1f9b8-1f3fb-200d-2642-fe0f","1f9b8-1f3fc-200d-2642-fe0f","1f9b8-1f3fd-200d-2642-fe0f","1f9b8-1f3fe-200d-2642-fe0f","1f9b8-1f3ff-200d-2642-fe0f"],a:"11"},{n:["good","hero","woman","heroine","superpower","woman superhero"],u:"1f9b8-200d-2640-fe0f",v:["1f9b8-1f3fb-200d-2640-fe0f","1f9b8-1f3fc-200d-2640-fe0f","1f9b8-1f3fd-200d-2640-fe0f","1f9b8-1f3fe-200d-2640-fe0f","1f9b8-1f3ff-200d-2640-fe0f"],a:"11"},{n:["evil","villain","criminal","superpower","supervillain"],u:"1f9b9",v:["1f9b9-1f3fb","1f9b9-1f3fc","1f9b9-1f3fd","1f9b9-1f3fe","1f9b9-1f3ff"],a:"11"},{n:["man","evil","villain","criminal","superpower","man supervillain"],u:"1f9b9-200d-2642-fe0f",v:["1f9b9-1f3fb-200d-2642-fe0f","1f9b9-1f3fc-200d-2642-fe0f","1f9b9-1f3fd-200d-2642-fe0f","1f9b9-1f3fe-200d-2642-fe0f","1f9b9-1f3ff-200d-2642-fe0f"],a:"11"},{n:["evil","woman","villain","criminal","superpower","woman supervillain"],u:"1f9b9-200d-2640-fe0f",v:["1f9b9-1f3fb-200d-2640-fe0f","1f9b9-1f3fc-200d-2640-fe0f","1f9b9-1f3fd-200d-2640-fe0f","1f9b9-1f3fe-200d-2640-fe0f","1f9b9-1f3ff-200d-2640-fe0f"],a:"11"},{n:["mage","witch","wizard","sorcerer","sorceress"],u:"1f9d9",v:["1f9d9-1f3fb","1f9d9-1f3fc","1f9d9-1f3fd","1f9d9-1f3fe","1f9d9-1f3ff"],a:"5"},{n:["wizard","man mage","sorcerer"],u:"1f9d9-200d-2642-fe0f",v:["1f9d9-1f3fb-200d-2642-fe0f","1f9d9-1f3fc-200d-2642-fe0f","1f9d9-1f3fd-200d-2642-fe0f","1f9d9-1f3fe-200d-2642-fe0f","1f9d9-1f3ff-200d-2642-fe0f"],a:"5"},{n:["witch","sorceress","woman mage"],u:"1f9d9-200d-2640-fe0f",v:["1f9d9-1f3fb-200d-2640-fe0f","1f9d9-1f3fc-200d-2640-fe0f","1f9d9-1f3fd-200d-2640-fe0f","1f9d9-1f3fe-200d-2640-fe0f","1f9d9-1f3ff-200d-2640-fe0f"],a:"5"},{n:["puck","fairy","oberon","titania"],u:"1f9da",v:["1f9da-1f3fb","1f9da-1f3fc","1f9da-1f3fd","1f9da-1f3fe","1f9da-1f3ff"],a:"5"},{n:["puck","oberon","man fairy"],u:"1f9da-200d-2642-fe0f",v:["1f9da-1f3fb-200d-2642-fe0f","1f9da-1f3fc-200d-2642-fe0f","1f9da-1f3fd-200d-2642-fe0f","1f9da-1f3fe-200d-2642-fe0f","1f9da-1f3ff-200d-2642-fe0f"],a:"5"},{n:["titania","woman fairy"],u:"1f9da-200d-2640-fe0f",v:["1f9da-1f3fb-200d-2640-fe0f","1f9da-1f3fc-200d-2640-fe0f","1f9da-1f3fd-200d-2640-fe0f","1f9da-1f3fe-200d-2640-fe0f","1f9da-1f3ff-200d-2640-fe0f"],a:"5"},{n:["undead","vampire","dracula"],u:"1f9db",v:["1f9db-1f3fb","1f9db-1f3fc","1f9db-1f3fd","1f9db-1f3fe","1f9db-1f3ff"],a:"5"},{n:["undead","dracula","man vampire"],u:"1f9db-200d-2642-fe0f",v:["1f9db-1f3fb-200d-2642-fe0f","1f9db-1f3fc-200d-2642-fe0f","1f9db-1f3fd-200d-2642-fe0f","1f9db-1f3fe-200d-2642-fe0f","1f9db-1f3ff-200d-2642-fe0f"],a:"5"},{n:["undead","woman vampire"],u:"1f9db-200d-2640-fe0f",v:["1f9db-1f3fb-200d-2640-fe0f","1f9db-1f3fc-200d-2640-fe0f","1f9db-1f3fd-200d-2640-fe0f","1f9db-1f3fe-200d-2640-fe0f","1f9db-1f3ff-200d-2640-fe0f"],a:"5"},{n:["merman","mermaid","merwoman","merperson"],u:"1f9dc",v:["1f9dc-1f3fb","1f9dc-1f3fc","1f9dc-1f3fd","1f9dc-1f3fe","1f9dc-1f3ff"],a:"5"},{n:["merman","triton"],u:"1f9dc-200d-2642-fe0f",v:["1f9dc-1f3fb-200d-2642-fe0f","1f9dc-1f3fc-200d-2642-fe0f","1f9dc-1f3fd-200d-2642-fe0f","1f9dc-1f3fe-200d-2642-fe0f","1f9dc-1f3ff-200d-2642-fe0f"],a:"5"},{n:["mermaid","merwoman"],u:"1f9dc-200d-2640-fe0f",v:["1f9dc-1f3fb-200d-2640-fe0f","1f9dc-1f3fc-200d-2640-fe0f","1f9dc-1f3fd-200d-2640-fe0f","1f9dc-1f3fe-200d-2640-fe0f","1f9dc-1f3ff-200d-2640-fe0f"],a:"5"},{n:["elf","magical"],u:"1f9dd",v:["1f9dd-1f3fb","1f9dd-1f3fc","1f9dd-1f3fd","1f9dd-1f3fe","1f9dd-1f3ff"],a:"5"},{n:["man elf","magical"],u:"1f9dd-200d-2642-fe0f",v:["1f9dd-1f3fb-200d-2642-fe0f","1f9dd-1f3fc-200d-2642-fe0f","1f9dd-1f3fd-200d-2642-fe0f","1f9dd-1f3fe-200d-2642-fe0f","1f9dd-1f3ff-200d-2642-fe0f"],a:"5"},{n:["magical","woman elf"],u:"1f9dd-200d-2640-fe0f",v:["1f9dd-1f3fb-200d-2640-fe0f","1f9dd-1f3fc-200d-2640-fe0f","1f9dd-1f3fd-200d-2640-fe0f","1f9dd-1f3fe-200d-2640-fe0f","1f9dd-1f3ff-200d-2640-fe0f"],a:"5"},{n:["genie","djinn"],u:"1f9de",a:"5"},{n:["djinn","man genie"],u:"1f9de-200d-2642-fe0f",a:"5"},{n:["djinn","woman genie"],u:"1f9de-200d-2640-fe0f",a:"5"},{n:["zombie","undead","walking dead"],u:"1f9df",a:"5"},{n:["undead","man zombie","walking dead"],u:"1f9df-200d-2642-fe0f",a:"5"},{n:["undead","woman zombie","walking dead"],u:"1f9df-200d-2640-fe0f",a:"5"},{n:["troll","fantasy","monster","fairy tale"],u:"1f9cc",a:"14"},{n:["face","salon","massage","person getting massage"],u:"1f486",v:["1f486-1f3fb","1f486-1f3fc","1f486-1f3fd","1f486-1f3fe","1f486-1f3ff"],a:"0.6"},{n:["man","face","massage","man getting massage"],u:"1f486-200d-2642-fe0f",v:["1f486-1f3fb-200d-2642-fe0f","1f486-1f3fc-200d-2642-fe0f","1f486-1f3fd-200d-2642-fe0f","1f486-1f3fe-200d-2642-fe0f","1f486-1f3ff-200d-2642-fe0f"],a:"4"},{n:["face","woman","massage","woman getting massage"],u:"1f486-200d-2640-fe0f",v:["1f486-1f3fb-200d-2640-fe0f","1f486-1f3fc-200d-2640-fe0f","1f486-1f3fd-200d-2640-fe0f","1f486-1f3fe-200d-2640-fe0f","1f486-1f3ff-200d-2640-fe0f"],a:"4"},{n:["barber","beauty","parlor","haircut","person getting haircut"],u:"1f487",v:["1f487-1f3fb","1f487-1f3fc","1f487-1f3fd","1f487-1f3fe","1f487-1f3ff"],a:"0.6"},{n:["man","haircut","man getting haircut"],u:"1f487-200d-2642-fe0f",v:["1f487-1f3fb-200d-2642-fe0f","1f487-1f3fc-200d-2642-fe0f","1f487-1f3fd-200d-2642-fe0f","1f487-1f3fe-200d-2642-fe0f","1f487-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","haircut","woman getting haircut"],u:"1f487-200d-2640-fe0f",v:["1f487-1f3fb-200d-2640-fe0f","1f487-1f3fc-200d-2640-fe0f","1f487-1f3fd-200d-2640-fe0f","1f487-1f3fe-200d-2640-fe0f","1f487-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hike","walk","walking","person walking"],u:"1f6b6",v:["1f6b6-1f3fb","1f6b6-1f3fc","1f6b6-1f3fd","1f6b6-1f3fe","1f6b6-1f3ff"],a:"0.6"},{n:["man","hike","walk","man walking"],u:"1f6b6-200d-2642-fe0f",v:["1f6b6-1f3fb-200d-2642-fe0f","1f6b6-1f3fc-200d-2642-fe0f","1f6b6-1f3fd-200d-2642-fe0f","1f6b6-1f3fe-200d-2642-fe0f","1f6b6-1f3ff-200d-2642-fe0f"],a:"4"},{n:["hike","walk","woman","woman walking"],u:"1f6b6-200d-2640-fe0f",v:["1f6b6-1f3fb-200d-2640-fe0f","1f6b6-1f3fc-200d-2640-fe0f","1f6b6-1f3fd-200d-2640-fe0f","1f6b6-1f3fe-200d-2640-fe0f","1f6b6-1f3ff-200d-2640-fe0f"],a:"4"},{n:["hike","walk","walking","person walking","person walking facing right"],u:"1f6b6-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-27a1-fe0f","1f6b6-1f3fc-200d-27a1-fe0f","1f6b6-1f3fd-200d-27a1-fe0f","1f6b6-1f3fe-200d-27a1-fe0f","1f6b6-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["hike","walk","woman","woman walking","woman walking facing right"],u:"1f6b6-200d-2640-fe0f-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f6b6-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man","hike","walk","man walking","man walking facing right"],u:"1f6b6-200d-2642-fe0f-200d-27a1-fe0f",v:["1f6b6-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f6b6-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["stand","standing","person standing"],u:"1f9cd",v:["1f9cd-1f3fb","1f9cd-1f3fc","1f9cd-1f3fd","1f9cd-1f3fe","1f9cd-1f3ff"],a:"12"},{n:["man","standing","man standing"],u:"1f9cd-200d-2642-fe0f",v:["1f9cd-1f3fb-200d-2642-fe0f","1f9cd-1f3fc-200d-2642-fe0f","1f9cd-1f3fd-200d-2642-fe0f","1f9cd-1f3fe-200d-2642-fe0f","1f9cd-1f3ff-200d-2642-fe0f"],a:"12"},{n:["woman","standing","woman standing"],u:"1f9cd-200d-2640-fe0f",v:["1f9cd-1f3fb-200d-2640-fe0f","1f9cd-1f3fc-200d-2640-fe0f","1f9cd-1f3fd-200d-2640-fe0f","1f9cd-1f3fe-200d-2640-fe0f","1f9cd-1f3ff-200d-2640-fe0f"],a:"12"},{n:["kneel","kneeling","person kneeling"],u:"1f9ce",v:["1f9ce-1f3fb","1f9ce-1f3fc","1f9ce-1f3fd","1f9ce-1f3fe","1f9ce-1f3ff"],a:"12"},{n:["man","kneeling","man kneeling"],u:"1f9ce-200d-2642-fe0f",v:["1f9ce-1f3fb-200d-2642-fe0f","1f9ce-1f3fc-200d-2642-fe0f","1f9ce-1f3fd-200d-2642-fe0f","1f9ce-1f3fe-200d-2642-fe0f","1f9ce-1f3ff-200d-2642-fe0f"],a:"12"},{n:["woman","kneeling","woman kneeling"],u:"1f9ce-200d-2640-fe0f",v:["1f9ce-1f3fb-200d-2640-fe0f","1f9ce-1f3fc-200d-2640-fe0f","1f9ce-1f3fd-200d-2640-fe0f","1f9ce-1f3fe-200d-2640-fe0f","1f9ce-1f3ff-200d-2640-fe0f"],a:"12"},{n:["kneel","kneeling","person kneeling","person kneeling facing right"],u:"1f9ce-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-27a1-fe0f","1f9ce-1f3fc-200d-27a1-fe0f","1f9ce-1f3fd-200d-27a1-fe0f","1f9ce-1f3fe-200d-27a1-fe0f","1f9ce-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["woman","kneeling","woman kneeling facing right"],u:"1f9ce-200d-2640-fe0f-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f9ce-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man","kneeling","man kneeling facing right"],u:"1f9ce-200d-2642-fe0f-200d-27a1-fe0f",v:["1f9ce-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f9ce-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["blind","accessibility","person with white cane"],u:"1f9d1-200d-1f9af",v:["1f9d1-1f3fb-200d-1f9af","1f9d1-1f3fc-200d-1f9af","1f9d1-1f3fd-200d-1f9af","1f9d1-1f3fe-200d-1f9af","1f9d1-1f3ff-200d-1f9af"],a:"12.1"},{n:["blind","accessibility","person with white cane","person with white cane facing right"],u:"1f9d1-200d-1f9af-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9af-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["man","blind","accessibility","man with white cane"],u:"1f468-200d-1f9af",v:["1f468-1f3fb-200d-1f9af","1f468-1f3fc-200d-1f9af","1f468-1f3fd-200d-1f9af","1f468-1f3fe-200d-1f9af","1f468-1f3ff-200d-1f9af"],a:"12"},{n:["man","blind","accessibility","man with white cane","man with white cane facing right"],u:"1f468-200d-1f9af-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9af-200d-27a1-fe0f","1f468-1f3fc-200d-1f9af-200d-27a1-fe0f","1f468-1f3fd-200d-1f9af-200d-27a1-fe0f","1f468-1f3fe-200d-1f9af-200d-27a1-fe0f","1f468-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["blind","woman","accessibility","woman with white cane"],u:"1f469-200d-1f9af",v:["1f469-1f3fb-200d-1f9af","1f469-1f3fc-200d-1f9af","1f469-1f3fd-200d-1f9af","1f469-1f3fe-200d-1f9af","1f469-1f3ff-200d-1f9af"],a:"12"},{n:["blind","woman","accessibility","woman with white cane","woman with white cane facing right"],u:"1f469-200d-1f9af-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9af-200d-27a1-fe0f","1f469-1f3fc-200d-1f9af-200d-27a1-fe0f","1f469-1f3fd-200d-1f9af-200d-27a1-fe0f","1f469-1f3fe-200d-1f9af-200d-27a1-fe0f","1f469-1f3ff-200d-1f9af-200d-27a1-fe0f"],a:"15.1"},{n:["wheelchair","accessibility","person in motorized wheelchair"],u:"1f9d1-200d-1f9bc",v:["1f9d1-1f3fb-200d-1f9bc","1f9d1-1f3fc-200d-1f9bc","1f9d1-1f3fd-200d-1f9bc","1f9d1-1f3fe-200d-1f9bc","1f9d1-1f3ff-200d-1f9bc"],a:"12.1"},{n:["wheelchair","accessibility","person in motorized wheelchair","person in motorized wheelchair facing right"],u:"1f9d1-200d-1f9bc-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["man","wheelchair","accessibility","man in motorized wheelchair"],u:"1f468-200d-1f9bc",v:["1f468-1f3fb-200d-1f9bc","1f468-1f3fc-200d-1f9bc","1f468-1f3fd-200d-1f9bc","1f468-1f3fe-200d-1f9bc","1f468-1f3ff-200d-1f9bc"],a:"12"},{n:["man","wheelchair","accessibility","man in motorized wheelchair","man in motorized wheelchair facing right"],u:"1f468-200d-1f9bc-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f468-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f468-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["woman","wheelchair","accessibility","woman in motorized wheelchair"],u:"1f469-200d-1f9bc",v:["1f469-1f3fb-200d-1f9bc","1f469-1f3fc-200d-1f9bc","1f469-1f3fd-200d-1f9bc","1f469-1f3fe-200d-1f9bc","1f469-1f3ff-200d-1f9bc"],a:"12"},{n:["woman","wheelchair","accessibility","woman in motorized wheelchair","woman in motorized wheelchair facing right"],u:"1f469-200d-1f9bc-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fc-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fd-200d-1f9bc-200d-27a1-fe0f","1f469-1f3fe-200d-1f9bc-200d-27a1-fe0f","1f469-1f3ff-200d-1f9bc-200d-27a1-fe0f"],a:"15.1"},{n:["wheelchair","accessibility","person in manual wheelchair"],u:"1f9d1-200d-1f9bd",v:["1f9d1-1f3fb-200d-1f9bd","1f9d1-1f3fc-200d-1f9bd","1f9d1-1f3fd-200d-1f9bd","1f9d1-1f3fe-200d-1f9bd","1f9d1-1f3ff-200d-1f9bd"],a:"12.1"},{n:["wheelchair","accessibility","person in manual wheelchair","person in manual wheelchair facing right"],u:"1f9d1-200d-1f9bd-200d-27a1-fe0f",v:["1f9d1-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f9d1-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["man","wheelchair","accessibility","man in manual wheelchair"],u:"1f468-200d-1f9bd",v:["1f468-1f3fb-200d-1f9bd","1f468-1f3fc-200d-1f9bd","1f468-1f3fd-200d-1f9bd","1f468-1f3fe-200d-1f9bd","1f468-1f3ff-200d-1f9bd"],a:"12"},{n:["man","wheelchair","accessibility","man in manual wheelchair","man in manual wheelchair facing right"],u:"1f468-200d-1f9bd-200d-27a1-fe0f",v:["1f468-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f468-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f468-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["woman","wheelchair","accessibility","woman in manual wheelchair"],u:"1f469-200d-1f9bd",v:["1f469-1f3fb-200d-1f9bd","1f469-1f3fc-200d-1f9bd","1f469-1f3fd-200d-1f9bd","1f469-1f3fe-200d-1f9bd","1f469-1f3ff-200d-1f9bd"],a:"12"},{n:["woman","wheelchair","accessibility","woman in manual wheelchair","woman in manual wheelchair facing right"],u:"1f469-200d-1f9bd-200d-27a1-fe0f",v:["1f469-1f3fb-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fc-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fd-200d-1f9bd-200d-27a1-fe0f","1f469-1f3fe-200d-1f9bd-200d-27a1-fe0f","1f469-1f3ff-200d-1f9bd-200d-27a1-fe0f"],a:"15.1"},{n:["running","marathon","person running"],u:"1f3c3",v:["1f3c3-1f3fb","1f3c3-1f3fc","1f3c3-1f3fd","1f3c3-1f3fe","1f3c3-1f3ff"],a:"0.6"},{n:["man","racing","running","marathon","man running"],u:"1f3c3-200d-2642-fe0f",v:["1f3c3-1f3fb-200d-2642-fe0f","1f3c3-1f3fc-200d-2642-fe0f","1f3c3-1f3fd-200d-2642-fe0f","1f3c3-1f3fe-200d-2642-fe0f","1f3c3-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","racing","running","marathon","woman running"],u:"1f3c3-200d-2640-fe0f",v:["1f3c3-1f3fb-200d-2640-fe0f","1f3c3-1f3fc-200d-2640-fe0f","1f3c3-1f3fd-200d-2640-fe0f","1f3c3-1f3fe-200d-2640-fe0f","1f3c3-1f3ff-200d-2640-fe0f"],a:"4"},{n:["running","marathon","person running","person running facing right"],u:"1f3c3-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-27a1-fe0f","1f3c3-1f3fc-200d-27a1-fe0f","1f3c3-1f3fd-200d-27a1-fe0f","1f3c3-1f3fe-200d-27a1-fe0f","1f3c3-1f3ff-200d-27a1-fe0f"],a:"15.1"},{n:["woman","racing","running","marathon","woman running facing right"],u:"1f3c3-200d-2640-fe0f-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fc-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fd-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3fe-200d-2640-fe0f-200d-27a1-fe0f","1f3c3-1f3ff-200d-2640-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["man","racing","running","marathon","man running facing right"],u:"1f3c3-200d-2642-fe0f-200d-27a1-fe0f",v:["1f3c3-1f3fb-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fc-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fd-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3fe-200d-2642-fe0f-200d-27a1-fe0f","1f3c3-1f3ff-200d-2642-fe0f-200d-27a1-fe0f"],a:"15.1"},{n:["dance","woman","dancing","woman dancing"],u:"1f483",v:["1f483-1f3fb","1f483-1f3fc","1f483-1f3fd","1f483-1f3fe","1f483-1f3ff"],a:"0.6"},{n:["man","dance","dancing","man dancing"],u:"1f57a",v:["1f57a-1f3fb","1f57a-1f3fc","1f57a-1f3fd","1f57a-1f3fe","1f57a-1f3ff"],a:"3"},{n:["dancer","partying","bunny ear","people with bunny ears"],u:"1f46f",a:"0.6"},{n:["men","dancer","partying","bunny ear","men with bunny ears"],u:"1f46f-200d-2642-fe0f",a:"4"},{n:["women","dancer","partying","bunny ear","women with bunny ears"],u:"1f46f-200d-2640-fe0f",a:"4"},{n:["sauna","steam room","person in steamy room"],u:"1f9d6",v:["1f9d6-1f3fb","1f9d6-1f3fc","1f9d6-1f3fd","1f9d6-1f3fe","1f9d6-1f3ff"],a:"5"},{n:["sauna","steam room","man in steamy room"],u:"1f9d6-200d-2642-fe0f",v:["1f9d6-1f3fb-200d-2642-fe0f","1f9d6-1f3fc-200d-2642-fe0f","1f9d6-1f3fd-200d-2642-fe0f","1f9d6-1f3fe-200d-2642-fe0f","1f9d6-1f3ff-200d-2642-fe0f"],a:"5"},{n:["sauna","steam room","woman in steamy room"],u:"1f9d6-200d-2640-fe0f",v:["1f9d6-1f3fb-200d-2640-fe0f","1f9d6-1f3fc-200d-2640-fe0f","1f9d6-1f3fd-200d-2640-fe0f","1f9d6-1f3fe-200d-2640-fe0f","1f9d6-1f3ff-200d-2640-fe0f"],a:"5"},{n:["climber","person climbing"],u:"1f9d7",v:["1f9d7-1f3fb","1f9d7-1f3fc","1f9d7-1f3fd","1f9d7-1f3fe","1f9d7-1f3ff"],a:"5"},{n:["climber","man climbing"],u:"1f9d7-200d-2642-fe0f",v:["1f9d7-1f3fb-200d-2642-fe0f","1f9d7-1f3fc-200d-2642-fe0f","1f9d7-1f3fd-200d-2642-fe0f","1f9d7-1f3fe-200d-2642-fe0f","1f9d7-1f3ff-200d-2642-fe0f"],a:"5"},{n:["climber","woman climbing"],u:"1f9d7-200d-2640-fe0f",v:["1f9d7-1f3fb-200d-2640-fe0f","1f9d7-1f3fc-200d-2640-fe0f","1f9d7-1f3fd-200d-2640-fe0f","1f9d7-1f3fe-200d-2640-fe0f","1f9d7-1f3ff-200d-2640-fe0f"],a:"5"},{n:["sword","fencer","fencing","person fencing"],u:"1f93a",a:"3"},{n:["horse","jockey","racing","racehorse","horse racing"],u:"1f3c7",v:["1f3c7-1f3fb","1f3c7-1f3fc","1f3c7-1f3fd","1f3c7-1f3fe","1f3c7-1f3ff"],a:"1"},{n:["ski","snow","snowboard","snowboarder"],u:"1f3c2",v:["1f3c2-1f3fb","1f3c2-1f3fc","1f3c2-1f3fd","1f3c2-1f3fe","1f3c2-1f3ff"],a:"0.6"},{n:["man","golf","man golfing"],u:"1f3cc-fe0f-200d-2642-fe0f",v:["1f3cc-1f3fb-200d-2642-fe0f","1f3cc-1f3fc-200d-2642-fe0f","1f3cc-1f3fd-200d-2642-fe0f","1f3cc-1f3fe-200d-2642-fe0f","1f3cc-1f3ff-200d-2642-fe0f"],a:"4"},{n:["golf","woman","woman golfing"],u:"1f3cc-fe0f-200d-2640-fe0f",v:["1f3cc-1f3fb-200d-2640-fe0f","1f3cc-1f3fc-200d-2640-fe0f","1f3cc-1f3fd-200d-2640-fe0f","1f3cc-1f3fe-200d-2640-fe0f","1f3cc-1f3ff-200d-2640-fe0f"],a:"4"},{n:["surfing","person surfing"],u:"1f3c4",v:["1f3c4-1f3fb","1f3c4-1f3fc","1f3c4-1f3fd","1f3c4-1f3fe","1f3c4-1f3ff"],a:"0.6"},{n:["man","surfing","man surfing"],u:"1f3c4-200d-2642-fe0f",v:["1f3c4-1f3fb-200d-2642-fe0f","1f3c4-1f3fc-200d-2642-fe0f","1f3c4-1f3fd-200d-2642-fe0f","1f3c4-1f3fe-200d-2642-fe0f","1f3c4-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","surfing","woman surfing"],u:"1f3c4-200d-2640-fe0f",v:["1f3c4-1f3fb-200d-2640-fe0f","1f3c4-1f3fc-200d-2640-fe0f","1f3c4-1f3fd-200d-2640-fe0f","1f3c4-1f3fe-200d-2640-fe0f","1f3c4-1f3ff-200d-2640-fe0f"],a:"4"},{n:["boat","rowboat","person rowing boat"],u:"1f6a3",v:["1f6a3-1f3fb","1f6a3-1f3fc","1f6a3-1f3fd","1f6a3-1f3fe","1f6a3-1f3ff"],a:"1"},{n:["man","boat","rowboat","man rowing boat"],u:"1f6a3-200d-2642-fe0f",v:["1f6a3-1f3fb-200d-2642-fe0f","1f6a3-1f3fc-200d-2642-fe0f","1f6a3-1f3fd-200d-2642-fe0f","1f6a3-1f3fe-200d-2642-fe0f","1f6a3-1f3ff-200d-2642-fe0f"],a:"4"},{n:["boat","woman","rowboat","woman rowing boat"],u:"1f6a3-200d-2640-fe0f",v:["1f6a3-1f3fb-200d-2640-fe0f","1f6a3-1f3fc-200d-2640-fe0f","1f6a3-1f3fd-200d-2640-fe0f","1f6a3-1f3fe-200d-2640-fe0f","1f6a3-1f3ff-200d-2640-fe0f"],a:"4"},{n:["swim","person swimming"],u:"1f3ca",v:["1f3ca-1f3fb","1f3ca-1f3fc","1f3ca-1f3fd","1f3ca-1f3fe","1f3ca-1f3ff"],a:"0.6"},{n:["man","swim","man swimming"],u:"1f3ca-200d-2642-fe0f",v:["1f3ca-1f3fb-200d-2642-fe0f","1f3ca-1f3fc-200d-2642-fe0f","1f3ca-1f3fd-200d-2642-fe0f","1f3ca-1f3fe-200d-2642-fe0f","1f3ca-1f3ff-200d-2642-fe0f"],a:"4"},{n:["swim","woman","woman swimming"],u:"1f3ca-200d-2640-fe0f",v:["1f3ca-1f3fb-200d-2640-fe0f","1f3ca-1f3fc-200d-2640-fe0f","1f3ca-1f3fd-200d-2640-fe0f","1f3ca-1f3fe-200d-2640-fe0f","1f3ca-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","ball","man bouncing ball"],u:"26f9-fe0f-200d-2642-fe0f",v:["26f9-1f3fb-200d-2642-fe0f","26f9-1f3fc-200d-2642-fe0f","26f9-1f3fd-200d-2642-fe0f","26f9-1f3fe-200d-2642-fe0f","26f9-1f3ff-200d-2642-fe0f"],a:"4"},{n:["ball","woman","woman bouncing ball"],u:"26f9-fe0f-200d-2640-fe0f",v:["26f9-1f3fb-200d-2640-fe0f","26f9-1f3fc-200d-2640-fe0f","26f9-1f3fd-200d-2640-fe0f","26f9-1f3fe-200d-2640-fe0f","26f9-1f3ff-200d-2640-fe0f"],a:"4"},{n:["man","weight lifter","man lifting weights"],u:"1f3cb-fe0f-200d-2642-fe0f",v:["1f3cb-1f3fb-200d-2642-fe0f","1f3cb-1f3fc-200d-2642-fe0f","1f3cb-1f3fd-200d-2642-fe0f","1f3cb-1f3fe-200d-2642-fe0f","1f3cb-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","weight lifter","woman lifting weights"],u:"1f3cb-fe0f-200d-2640-fe0f",v:["1f3cb-1f3fb-200d-2640-fe0f","1f3cb-1f3fc-200d-2640-fe0f","1f3cb-1f3fd-200d-2640-fe0f","1f3cb-1f3fe-200d-2640-fe0f","1f3cb-1f3ff-200d-2640-fe0f"],a:"4"},{n:["biking","bicycle","cyclist","person biking"],u:"1f6b4",v:["1f6b4-1f3fb","1f6b4-1f3fc","1f6b4-1f3fd","1f6b4-1f3fe","1f6b4-1f3ff"],a:"1"},{n:["man","biking","bicycle","cyclist","man biking"],u:"1f6b4-200d-2642-fe0f",v:["1f6b4-1f3fb-200d-2642-fe0f","1f6b4-1f3fc-200d-2642-fe0f","1f6b4-1f3fd-200d-2642-fe0f","1f6b4-1f3fe-200d-2642-fe0f","1f6b4-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","biking","bicycle","cyclist","woman biking"],u:"1f6b4-200d-2640-fe0f",v:["1f6b4-1f3fb-200d-2640-fe0f","1f6b4-1f3fc-200d-2640-fe0f","1f6b4-1f3fd-200d-2640-fe0f","1f6b4-1f3fe-200d-2640-fe0f","1f6b4-1f3ff-200d-2640-fe0f"],a:"4"},{n:["bike","bicycle","cyclist","mountain","bicyclist","person mountain biking"],u:"1f6b5",v:["1f6b5-1f3fb","1f6b5-1f3fc","1f6b5-1f3fd","1f6b5-1f3fe","1f6b5-1f3ff"],a:"1"},{n:["man","bike","bicycle","cyclist","mountain","man mountain biking"],u:"1f6b5-200d-2642-fe0f",v:["1f6b5-1f3fb-200d-2642-fe0f","1f6b5-1f3fc-200d-2642-fe0f","1f6b5-1f3fd-200d-2642-fe0f","1f6b5-1f3fe-200d-2642-fe0f","1f6b5-1f3ff-200d-2642-fe0f"],a:"4"},{n:["bike","woman","biking","bicycle","cyclist","mountain","woman mountain biking"],u:"1f6b5-200d-2640-fe0f",v:["1f6b5-1f3fb-200d-2640-fe0f","1f6b5-1f3fc-200d-2640-fe0f","1f6b5-1f3fd-200d-2640-fe0f","1f6b5-1f3fe-200d-2640-fe0f","1f6b5-1f3ff-200d-2640-fe0f"],a:"4"},{n:["cartwheel","gymnastics","person cartwheeling"],u:"1f938",v:["1f938-1f3fb","1f938-1f3fc","1f938-1f3fd","1f938-1f3fe","1f938-1f3ff"],a:"3"},{n:["man","cartwheel","gymnastics","man cartwheeling"],u:"1f938-200d-2642-fe0f",v:["1f938-1f3fb-200d-2642-fe0f","1f938-1f3fc-200d-2642-fe0f","1f938-1f3fd-200d-2642-fe0f","1f938-1f3fe-200d-2642-fe0f","1f938-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","cartwheel","gymnastics","woman cartwheeling"],u:"1f938-200d-2640-fe0f",v:["1f938-1f3fb-200d-2640-fe0f","1f938-1f3fc-200d-2640-fe0f","1f938-1f3fd-200d-2640-fe0f","1f938-1f3fe-200d-2640-fe0f","1f938-1f3ff-200d-2640-fe0f"],a:"4"},{n:["wrestle","wrestler","people wrestling"],u:"1f93c",a:"3"},{n:["men","wrestle","men wrestling"],u:"1f93c-200d-2642-fe0f",a:"4"},{n:["women","wrestle","women wrestling"],u:"1f93c-200d-2640-fe0f",a:"4"},{n:["polo","water","person playing water polo"],u:"1f93d",v:["1f93d-1f3fb","1f93d-1f3fc","1f93d-1f3fd","1f93d-1f3fe","1f93d-1f3ff"],a:"3"},{n:["man","water polo","man playing water polo"],u:"1f93d-200d-2642-fe0f",v:["1f93d-1f3fb-200d-2642-fe0f","1f93d-1f3fc-200d-2642-fe0f","1f93d-1f3fd-200d-2642-fe0f","1f93d-1f3fe-200d-2642-fe0f","1f93d-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","water polo","woman playing water polo"],u:"1f93d-200d-2640-fe0f",v:["1f93d-1f3fb-200d-2640-fe0f","1f93d-1f3fc-200d-2640-fe0f","1f93d-1f3fd-200d-2640-fe0f","1f93d-1f3fe-200d-2640-fe0f","1f93d-1f3ff-200d-2640-fe0f"],a:"4"},{n:["ball","handball","person playing handball"],u:"1f93e",v:["1f93e-1f3fb","1f93e-1f3fc","1f93e-1f3fd","1f93e-1f3fe","1f93e-1f3ff"],a:"3"},{n:["man","handball","man playing handball"],u:"1f93e-200d-2642-fe0f",v:["1f93e-1f3fb-200d-2642-fe0f","1f93e-1f3fc-200d-2642-fe0f","1f93e-1f3fd-200d-2642-fe0f","1f93e-1f3fe-200d-2642-fe0f","1f93e-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","handball","woman playing handball"],u:"1f93e-200d-2640-fe0f",v:["1f93e-1f3fb-200d-2640-fe0f","1f93e-1f3fc-200d-2640-fe0f","1f93e-1f3fd-200d-2640-fe0f","1f93e-1f3fe-200d-2640-fe0f","1f93e-1f3ff-200d-2640-fe0f"],a:"4"},{n:["skill","juggle","balance","multitask","person juggling"],u:"1f939",v:["1f939-1f3fb","1f939-1f3fc","1f939-1f3fd","1f939-1f3fe","1f939-1f3ff"],a:"3"},{n:["man","juggling","multitask","man juggling"],u:"1f939-200d-2642-fe0f",v:["1f939-1f3fb-200d-2642-fe0f","1f939-1f3fc-200d-2642-fe0f","1f939-1f3fd-200d-2642-fe0f","1f939-1f3fe-200d-2642-fe0f","1f939-1f3ff-200d-2642-fe0f"],a:"4"},{n:["woman","juggling","multitask","woman juggling"],u:"1f939-200d-2640-fe0f",v:["1f939-1f3fb-200d-2640-fe0f","1f939-1f3fc-200d-2640-fe0f","1f939-1f3fd-200d-2640-fe0f","1f939-1f3fe-200d-2640-fe0f","1f939-1f3ff-200d-2640-fe0f"],a:"4"},{n:["yoga","meditation","person in lotus position"],u:"1f9d8",v:["1f9d8-1f3fb","1f9d8-1f3fc","1f9d8-1f3fd","1f9d8-1f3fe","1f9d8-1f3ff"],a:"5"},{n:["yoga","meditation","man in lotus position"],u:"1f9d8-200d-2642-fe0f",v:["1f9d8-1f3fb-200d-2642-fe0f","1f9d8-1f3fc-200d-2642-fe0f","1f9d8-1f3fd-200d-2642-fe0f","1f9d8-1f3fe-200d-2642-fe0f","1f9d8-1f3ff-200d-2642-fe0f"],a:"5"},{n:["yoga","meditation","woman in lotus position"],u:"1f9d8-200d-2640-fe0f",v:["1f9d8-1f3fb-200d-2640-fe0f","1f9d8-1f3fc-200d-2640-fe0f","1f9d8-1f3fd-200d-2640-fe0f","1f9d8-1f3fe-200d-2640-fe0f","1f9d8-1f3ff-200d-2640-fe0f"],a:"5"},{n:["bath","bathtub","person taking bath"],u:"1f6c0",v:["1f6c0-1f3fb","1f6c0-1f3fc","1f6c0-1f3fd","1f6c0-1f3fe","1f6c0-1f3ff"],a:"0.6"},{n:["hotel","sleep","good night","person in bed"],u:"1f6cc",v:["1f6cc-1f3fb","1f6cc-1f3fc","1f6cc-1f3fd","1f6cc-1f3fe","1f6cc-1f3ff"],a:"1"},{n:["hand","hold","couple","person","holding hands","people holding hands"],u:"1f9d1-200d-1f91d-200d-1f9d1",v:["1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3fe-200d-1f91d-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3fe","1f9d1-1f3ff-200d-1f91d-200d-1f9d1-1f3ff"],a:"12"},{n:["hand","women","couple","holding hands","women holding hands"],u:"1f46d",v:["1f46d-1f3fb","1f46d-1f3fc","1f46d-1f3fd","1f46d-1f3fe","1f46d-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f469-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f469-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f469-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f469-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f469-1f3fe"],a:"1"},{n:["man","hand","hold","woman","couple","holding hands","woman and man holding hands"],u:"1f46b",v:["1f46b-1f3fb","1f46b-1f3fc","1f46b-1f3fd","1f46b-1f3fe","1f46b-1f3ff","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f469-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f469-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f469-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f469-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"0.6"},{n:["man","men","twins","couple","gemini","zodiac","holding hands","men holding hands"],u:"1f46c",v:["1f46c-1f3fb","1f46c-1f3fc","1f46c-1f3fd","1f46c-1f3fe","1f46c-1f3ff","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fb-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fb-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fc-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fc-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fd-200d-1f91d-200d-1f468-1f3fe","1f468-1f3fd-200d-1f91d-200d-1f468-1f3ff","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fb","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fc","1f468-1f3fe-200d-1f91d-200d-1f468-1f3fd","1f468-1f3fe-200d-1f91d-200d-1f468-1f3ff","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fb","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fc","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fd","1f468-1f3ff-200d-1f91d-200d-1f468-1f3fe"],a:"1"},{n:["kiss","couple"],u:"1f48f",v:["1f48f-1f3fb","1f48f-1f3fc","1f48f-1f3fd","1f48f-1f3fe","1f48f-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f9d1-1f3fe"],a:"0.6"},{n:["man","kiss","woman","couple","kiss: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2"},{n:["man","kiss","couple","kiss: man, man"],u:"1f468-200d-2764-fe0f-200d-1f48b-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f468-1f3ff"],a:"2"},{n:["kiss","woman","couple","kiss: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f48b-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f48b-200d-1f469-1f3ff"],a:"2"},{n:["love","couple","couple with heart"],u:"1f491",v:["1f491-1f3fb","1f491-1f3fc","1f491-1f3fd","1f491-1f3fe","1f491-1f3ff","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fb-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fc-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3fe","1f9d1-1f3fd-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3fe-200d-2764-fe0f-200d-1f9d1-1f3ff","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fb","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fc","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fd","1f9d1-1f3ff-200d-2764-fe0f-200d-1f9d1-1f3fe"],a:"0.6"},{n:["man","love","woman","couple","couple with heart","couple with heart: woman, man"],u:"1f469-200d-2764-fe0f-200d-1f468",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2"},{n:["man","love","couple","couple with heart","couple with heart: man, man"],u:"1f468-200d-2764-fe0f-200d-1f468",v:["1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fb-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fc-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fd-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3fe-200d-2764-fe0f-200d-1f468-1f3ff","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fb","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fc","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fd","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3fe","1f468-1f3ff-200d-2764-fe0f-200d-1f468-1f3ff"],a:"2"},{n:["love","woman","couple","couple with heart","couple with heart: woman, woman"],u:"1f469-200d-2764-fe0f-200d-1f469",v:["1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fb-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fc-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fd-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3fe-200d-2764-fe0f-200d-1f469-1f3ff","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fb","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fc","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fd","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3fe","1f469-1f3ff-200d-2764-fe0f-200d-1f469-1f3ff"],a:"2"},{n:["boy","man","woman","family","family: man, woman, boy"],u:"1f468-200d-1f469-200d-1f466",a:"2"},{n:["man","girl","woman","family","family: man, woman, girl"],u:"1f468-200d-1f469-200d-1f467",a:"2"},{n:["boy","man","girl","woman","family","family: man, woman, girl, boy"],u:"1f468-200d-1f469-200d-1f467-200d-1f466",a:"2"},{n:["boy","man","woman","family","family: man, woman, boy, boy"],u:"1f468-200d-1f469-200d-1f466-200d-1f466",a:"2"},{n:["man","girl","woman","family","family: man, woman, girl, girl"],u:"1f468-200d-1f469-200d-1f467-200d-1f467",a:"2"},{n:["boy","man","family","family: man, man, boy"],u:"1f468-200d-1f468-200d-1f466",a:"2"},{n:["man","girl","family","family: man, man, girl"],u:"1f468-200d-1f468-200d-1f467",a:"2"},{n:["boy","man","girl","family","family: man, man, girl, boy"],u:"1f468-200d-1f468-200d-1f467-200d-1f466",a:"2"},{n:["boy","man","family","family: man, man, boy, boy"],u:"1f468-200d-1f468-200d-1f466-200d-1f466",a:"2"},{n:["man","girl","family","family: man, man, girl, girl"],u:"1f468-200d-1f468-200d-1f467-200d-1f467",a:"2"},{n:["boy","woman","family","family: woman, woman, boy"],u:"1f469-200d-1f469-200d-1f466",a:"2"},{n:["girl","woman","family","family: woman, woman, girl"],u:"1f469-200d-1f469-200d-1f467",a:"2"},{n:["boy","girl","woman","family","family: woman, woman, girl, boy"],u:"1f469-200d-1f469-200d-1f467-200d-1f466",a:"2"},{n:["boy","woman","family","family: woman, woman, boy, boy"],u:"1f469-200d-1f469-200d-1f466-200d-1f466",a:"2"},{n:["girl","woman","family","family: woman, woman, girl, girl"],u:"1f469-200d-1f469-200d-1f467-200d-1f467",a:"2"},{n:["boy","man","family","family: man, boy"],u:"1f468-200d-1f466",a:"4"},{n:["boy","man","family","family: man, boy, boy"],u:"1f468-200d-1f466-200d-1f466",a:"4"},{n:["man","girl","family","family: man, girl"],u:"1f468-200d-1f467",a:"4"},{n:["boy","man","girl","family","family: man, girl, boy"],u:"1f468-200d-1f467-200d-1f466",a:"4"},{n:["man","girl","family","family: man, girl, girl"],u:"1f468-200d-1f467-200d-1f467",a:"4"},{n:["boy","woman","family","family: woman, boy"],u:"1f469-200d-1f466",a:"4"},{n:["boy","woman","family","family: woman, boy, boy"],u:"1f469-200d-1f466-200d-1f466",a:"4"},{n:["girl","woman","family","family: woman, girl"],u:"1f469-200d-1f467",a:"4"},{n:["boy","girl","woman","family","family: woman, girl, boy"],u:"1f469-200d-1f467-200d-1f466",a:"4"},{n:["girl","woman","family","family: woman, girl, girl"],u:"1f469-200d-1f467-200d-1f467",a:"4"},{n:["bust","silhouette","bust in silhouette"],u:"1f464",a:"0.6"},{n:["bust","silhouette","busts in silhouette"],u:"1f465",a:"1"},{n:["hug","hello","thanks","goodbye","people hugging"],u:"1fac2",a:"13"},{n:["family"],u:"1f46a",a:"0.6"},{n:["family: adult, adult, child"],u:"1f9d1-200d-1f9d1-200d-1f9d2",a:"15.1"},{n:["family: adult, adult, child, child"],u:"1f9d1-200d-1f9d1-200d-1f9d2-200d-1f9d2",a:"15.1"},{n:["family: adult, child"],u:"1f9d1-200d-1f9d2",a:"15.1"},{n:["family: adult, child, child"],u:"1f9d1-200d-1f9d2-200d-1f9d2",a:"15.1"},{n:["print","clothing","footprint","footprints"],u:"1f463",a:"0.6"}],animals_nature:[{n:["face","monkey","monkey face"],u:"1f435",a:"0.6"},{n:["monkey"],u:"1f412",a:"0.6"},{n:["gorilla"],u:"1f98d",a:"3"},{n:["ape","orangutan"],u:"1f9a7",a:"12"},{n:["dog","pet","face","dog face"],u:"1f436",a:"0.6"},{n:["dog","pet"],u:"1f415",a:"0.7"},{n:["blind","guide","guide dog","accessibility"],u:"1f9ae",a:"12"},{n:["dog","service","assistance","service dog","accessibility"],u:"1f415-200d-1f9ba",a:"12"},{n:["dog","poodle"],u:"1f429",a:"0.6"},{n:["wolf","face"],u:"1f43a",a:"0.6"},{n:["fox","face"],u:"1f98a",a:"3"},{n:["sly","raccoon","curious"],u:"1f99d",a:"11"},{n:["cat","pet","face","cat face"],u:"1f431",a:"0.6"},{n:["cat","pet"],u:"1f408",a:"0.7"},{n:["cat","black","unlucky","black cat"],u:"1f408-200d-2b1b",a:"13"},{n:["leo","lion","face","zodiac"],u:"1f981",a:"1"},{n:["face","tiger","tiger face"],u:"1f42f",a:"0.6"},{n:["tiger"],u:"1f405",a:"1"},{n:["leopard"],u:"1f406",a:"1"},{n:["face","horse","horse face"],u:"1f434",a:"0.6"},{n:["elk","moose","animal","mammal","antlers"],u:"1face",a:"15"},{n:["ass","mule","burro","donkey","animal","mammal","stubborn"],u:"1facf",a:"15"},{n:["horse","racing","racehorse","equestrian"],u:"1f40e",a:"0.6"},{n:["face","unicorn"],u:"1f984",a:"1"},{n:["zebra","stripe"],u:"1f993",a:"5"},{n:["deer"],u:"1f98c",a:"3"},{n:["herd","bison","wisent","buffalo"],u:"1f9ac",a:"13"},{n:["cow","face","cow face"],u:"1f42e",a:"0.6"},{n:["ox","bull","taurus","zodiac"],u:"1f402",a:"1"},{n:["water","buffalo","water buffalo"],u:"1f403",a:"1"},{n:["cow"],u:"1f404",a:"1"},{n:["pig","face","pig face"],u:"1f437",a:"0.6"},{n:["pig","sow"],u:"1f416",a:"1"},{n:["pig","boar"],u:"1f417",a:"0.6"},{n:["pig","face","nose","pig nose"],u:"1f43d",a:"0.6"},{n:["ram","male","aries","sheep","zodiac"],u:"1f40f",a:"1"},{n:["ewe","sheep","female"],u:"1f411",a:"0.6"},{n:["goat","zodiac","capricorn"],u:"1f410",a:"1"},{n:["hump","camel","dromedary"],u:"1f42a",a:"1"},{n:["hump","camel","bactrian","two hump camel"],u:"1f42b",a:"0.6"},{n:["wool","llama","alpaca","vicua","guanaco"],u:"1f999",a:"11"},{n:["spots","giraffe"],u:"1f992",a:"5"},{n:["elephant"],u:"1f418",a:"0.6"},{n:["tusk","large","woolly","mammoth","extinction"],u:"1f9a3",a:"13"},{n:["rhinoceros"],u:"1f98f",a:"3"},{n:["hippo","hippopotamus"],u:"1f99b",a:"11"},{n:["face","mouse","mouse face"],u:"1f42d",a:"0.6"},{n:["mouse"],u:"1f401",a:"1"},{n:["rat"],u:"1f400",a:"1"},{n:["pet","face","hamster"],u:"1f439",a:"0.6"},{n:["pet","face","bunny","rabbit","rabbit face"],u:"1f430",a:"0.6"},{n:["pet","bunny","rabbit"],u:"1f407",a:"1"},{n:["dam","beaver"],u:"1f9ab",a:"13"},{n:["spiny","hedgehog"],u:"1f994",a:"5"},{n:["bat","vampire"],u:"1f987",a:"3"},{n:["bear","face"],u:"1f43b",a:"0.6"},{n:["bear","white","arctic","polar bear"],u:"1f43b-200d-2744-fe0f",a:"13"},{n:["face","koala","marsupial"],u:"1f428",a:"0.6"},{n:["face","panda"],u:"1f43c",a:"0.6"},{n:["lazy","slow","sloth"],u:"1f9a5",a:"12"},{n:["otter","fishing","playful"],u:"1f9a6",a:"12"},{n:["skunk","stink"],u:"1f9a8",a:"12"},{n:["joey","jump","kangaroo","marsupial"],u:"1f998",a:"11"},{n:["badger","pester","honey badger"],u:"1f9a1",a:"11"},{n:["paw","feet","print","paw prints"],u:"1f43e",a:"0.6"},{n:["bird","turkey"],u:"1f983",a:"1"},{n:["bird","chicken"],u:"1f414",a:"0.6"},{n:["bird","rooster"],u:"1f413",a:"1"},{n:["baby","bird","chick","hatching","hatching chick"],u:"1f423",a:"0.6"},{n:["baby","bird","chick","baby chick"],u:"1f424",a:"0.6"},{n:["baby","bird","chick","front facing baby chick"],u:"1f425",a:"0.6"},{n:["bird"],u:"1f426",a:"0.6"},{n:["bird","penguin"],u:"1f427",a:"0.6"},{n:["bird","eagle"],u:"1f985",a:"3"},{n:["duck","bird"],u:"1f986",a:"3"},{n:["swan","bird","cygnet","ugly duckling"],u:"1f9a2",a:"11"},{n:["owl","bird","wise"],u:"1f989",a:"3"},{n:["dodo","large","mauritius","extinction"],u:"1f9a4",a:"13"},{n:["bird","light","flight","feather","plumage"],u:"1fab6",a:"13"},{n:["flamingo","tropical","flamboyant"],u:"1f9a9",a:"12"},{n:["bird","proud","peahen","peacock","ostentatious"],u:"1f99a",a:"11"},{n:["bird","talk","parrot","pirate"],u:"1f99c",a:"11"},{n:["wing","bird","flying","angelic","aviation","mythology"],u:"1fabd",a:"15"},{n:["bird","crow","rook","black","raven","black bird"],u:"1f426-200d-2b1b",a:"15"},{n:["bird","fowl","honk","goose","silly"],u:"1fabf",a:"15"},{n:["phoenix","fantasy","rebirth","firebird","reincarnation"],u:"1f426-200d-1f525",a:"15.1"},{n:["frog","face"],u:"1f438",a:"0.6"},{n:["crocodile"],u:"1f40a",a:"1"},{n:["turtle","terrapin","tortoise"],u:"1f422",a:"0.6"},{n:["lizard","reptile"],u:"1f98e",a:"3"},{n:["snake","bearer","zodiac","serpent","ophiuchus"],u:"1f40d",a:"0.6"},{n:["face","dragon","fairy tale","dragon face"],u:"1f432",a:"0.6"},{n:["dragon","fairy tale"],u:"1f409",a:"1"},{n:["sauropod","diplodocus","brontosaurus","brachiosaurus"],u:"1f995",a:"5"},{n:["T Rex","t rex","tyrannosaurus rex"],u:"1f996",a:"5"},{n:["face","whale","spouting","spouting whale"],u:"1f433",a:"0.6"},{n:["whale"],u:"1f40b",a:"1"},{n:["dolphin","flipper"],u:"1f42c",a:"0.6"},{n:["seal","sea lion"],u:"1f9ad",a:"13"},{n:["fish","pisces","zodiac"],u:"1f41f",a:"0.6"},{n:["fish","tropical","tropical fish"],u:"1f420",a:"0.6"},{n:["fish","blowfish"],u:"1f421",a:"0.6"},{n:["fish","shark"],u:"1f988",a:"3"},{n:["octopus"],u:"1f419",a:"0.6"},{n:["shell","spiral","spiral shell"],u:"1f41a",a:"0.6"},{n:["reef","coral","ocean"],u:"1fab8",a:"14"},{n:["burn","ouch","jelly","marine","stinger","jellyfish","invertebrate"],u:"1fabc",a:"15"},{n:["snail"],u:"1f40c",a:"0.6"},{n:["insect","pretty","butterfly"],u:"1f98b",a:"3"},{n:["bug","insect"],u:"1f41b",a:"0.6"},{n:["ant","insect"],u:"1f41c",a:"0.6"},{n:["bee","insect","honeybee"],u:"1f41d",a:"0.6"},{n:["bug","beetle","insect"],u:"1fab2",a:"13"},{n:["beetle","insect","ladybug","ladybird","lady beetle"],u:"1f41e",a:"0.6"},{n:["cricket","grasshopper"],u:"1f997",a:"5"},{n:["pest","roach","insect","cockroach"],u:"1fab3",a:"13"},{n:["zodiac","scorpio","scorpion"],u:"1f982",a:"1"},{n:["pest","fever","virus","disease","malaria","mosquito"],u:"1f99f",a:"11"},{n:["fly","pest","maggot","disease","rotting"],u:"1fab0",a:"13"},{n:["worm","annelid","parasite","earthworm"],u:"1fab1",a:"13"},{n:["virus","amoeba","microbe","bacteria"],u:"1f9a0",a:"11"},{n:["flower","bouquet"],u:"1f490",a:"0.6"},{n:["cherry","flower","blossom","cherry blossom"],u:"1f338",a:"0.6"},{n:["flower","white flower"],u:"1f4ae",a:"0.6"},{n:["lotus","flower","purity","buddhism","hinduism"],u:"1fab7",a:"14"},{n:["rose","flower"],u:"1f339",a:"0.6"},{n:["flower","wilted","wilted flower"],u:"1f940",a:"3"},{n:["flower","hibiscus"],u:"1f33a",a:"0.6"},{n:["sun","flower","sunflower"],u:"1f33b",a:"0.6"},{n:["flower","blossom"],u:"1f33c",a:"0.6"},{n:["tulip","flower"],u:"1f337",a:"0.6"},{n:["flower","lupine","hyacinth","lavender","bluebonnet","snapdragon"],u:"1fabb",a:"15"},{n:["young","seedling"],u:"1f331",a:"0.6"},{n:["grow","house","plant","boring","useless","nurturing","potted plant"],u:"1fab4",a:"13"},{n:["tree","evergreen tree"],u:"1f332",a:"1"},{n:["tree","shedding","deciduous","deciduous tree"],u:"1f333",a:"1"},{n:["palm","tree","palm tree"],u:"1f334",a:"0.6"},{n:["plant","cactus"],u:"1f335",a:"0.6"},{n:["ear","rice","grain","sheaf of rice"],u:"1f33e",a:"0.6"},{n:["herb","leaf"],u:"1f33f",a:"0.6"},{n:["4","four","leaf","clover","four leaf clover"],u:"1f340",a:"0.6"},{n:["leaf","maple","falling","maple leaf"],u:"1f341",a:"0.6"},{n:["leaf","falling","fallen leaf"],u:"1f342",a:"0.6"},{n:["blow","leaf","wind","flutter","leaf fluttering in wind"],u:"1f343",a:"0.6"},{n:["nesting","empty nest"],u:"1fab9",a:"14"},{n:["nesting","nest with eggs"],u:"1faba",a:"14"},{n:["mushroom","toadstool"],u:"1f344",a:"0.6"}],food_drink:[{n:["fruit","grape","grapes"],u:"1f347",a:"0.6"},{n:["melon","fruit"],u:"1f348",a:"0.6"},{n:["fruit","watermelon"],u:"1f349",a:"0.6"},{n:["fruit","orange","tangerine"],u:"1f34a",a:"0.6"},{n:["lemon","fruit","citrus"],u:"1f34b",a:"1"},{n:["lime","fruit","citrus","tropical"],u:"1f34b-200d-1f7e9",a:"15.1"},{n:["fruit","banana"],u:"1f34c",a:"0.6"},{n:["fruit","pineapple"],u:"1f34d",a:"0.6"},{n:["mango","fruit","tropical"],u:"1f96d",a:"11"},{n:["red","apple","fruit","red apple"],u:"1f34e",a:"0.6"},{n:["apple","fruit","green","green apple"],u:"1f34f",a:"0.6"},{n:["pear","fruit"],u:"1f350",a:"1"},{n:["peach","fruit"],u:"1f351",a:"0.6"},{n:["red","fruit","cherry","berries","cherries"],u:"1f352",a:"0.6"},{n:["berry","fruit","strawberry"],u:"1f353",a:"0.6"},{n:["blue","berry","bilberry","blueberry","blueberries"],u:"1fad0",a:"13"},{n:["food","kiwi","fruit","kiwi fruit"],u:"1f95d",a:"3"},{n:["fruit","tomato","vegetable"],u:"1f345",a:"0.6"},{n:["food","olive"],u:"1fad2",a:"13"},{n:["palm","coconut","pia colada"],u:"1f965",a:"5"},{n:["food","fruit","avocado"],u:"1f951",a:"3"},{n:["eggplant","aubergine","vegetable"],u:"1f346",a:"0.6"},{n:["food","potato","vegetable"],u:"1f954",a:"3"},{n:["food","carrot","vegetable"],u:"1f955",a:"3"},{n:["ear","corn","maze","maize","ear of corn"],u:"1f33d",a:"0.6"},{n:["pepper","capsicum","vegetable","bell pepper"],u:"1fad1",a:"13"},{n:["food","pickle","cucumber","vegetable"],u:"1f952",a:"3"},{n:["kale","cabbage","lettuce","bok choy","leafy green"],u:"1f96c",a:"11"},{n:["broccoli","wild cabbage"],u:"1f966",a:"5"},{n:["garlic","flavoring"],u:"1f9c4",a:"12"},{n:["onion","flavoring"],u:"1f9c5",a:"12"},{n:["nut","food","peanut","peanuts","vegetable"],u:"1f95c",a:"3"},{n:["food","beans","kidney","legume"],u:"1fad8",a:"14"},{n:["plant","chestnut"],u:"1f330",a:"0.6"},{n:["beer","root","spice","ginger root"],u:"1fada",a:"15"},{n:["pea","pod","beans","legume","pea pod","edamame","vegetable"],u:"1fadb",a:"15"},{n:["food","fungus","nature","vegetable","brown mushroom"],u:"1f344-200d-1f7eb",a:"15.1"},{n:["loaf","bread"],u:"1f35e",a:"0.6"},{n:["food","roll","bread","french","croissant","breakfast"],u:"1f950",a:"3"},{n:["food","bread","french","baguette","baguette bread"],u:"1f956",a:"3"},{n:["naan","pita","arepa","lavash","flatbread"],u:"1fad3",a:"13"},{n:["pretzel","twisted"],u:"1f968",a:"5"},{n:["bagel","bakery","schmear","breakfast"],u:"1f96f",a:"11"},{n:["food","crpe","hotcake","pancake","pancakes","breakfast"],u:"1f95e",a:"3"},{n:["iron","waffle","breakfast","indecisive"],u:"1f9c7",a:"12"},{n:["cheese","cheese wedge"],u:"1f9c0",a:"1"},{n:["bone","meat","meat on bone"],u:"1f356",a:"0.6"},{n:["leg","bone","chicken","poultry","drumstick","poultry leg"],u:"1f357",a:"0.6"},{n:["chop","steak","lambchop","porkchop","cut of meat"],u:"1f969",a:"5"},{n:["food","meat","bacon","breakfast"],u:"1f953",a:"3"},{n:["burger","hamburger"],u:"1f354",a:"0.6"},{n:["fries","french","french fries"],u:"1f35f",a:"0.6"},{n:["pizza","slice","cheese"],u:"1f355",a:"0.6"},{n:["hotdog","hot dog","sausage","frankfurter"],u:"1f32d",a:"1"},{n:["bread","sandwich"],u:"1f96a",a:"5"},{n:["taco","mexican"],u:"1f32e",a:"1"},{n:["wrap","burrito","mexican"],u:"1f32f",a:"1"},{n:["tamale","mexican","wrapped"],u:"1fad4",a:"13"},{n:["food","gyro","kebab","falafel","stuffed","flatbread","stuffed flatbread"],u:"1f959",a:"3"},{n:["falafel","chickpea","meatball"],u:"1f9c6",a:"12"},{n:["egg","food","breakfast"],u:"1f95a",a:"3"},{n:["egg","pan","frying","cooking","breakfast"],u:"1f373",a:"0.6"},{n:["pan","food","paella","shallow","casserole","shallow pan of food"],u:"1f958",a:"3"},{n:["pot","stew","pot of food"],u:"1f372",a:"0.6"},{n:["pot","swiss","fondue","cheese","melted","chocolate"],u:"1fad5",a:"13"},{n:["cereal","congee","breakfast","bowl with spoon"],u:"1f963",a:"5"},{n:["food","green","salad","green salad"],u:"1f957",a:"3"},{n:["popcorn"],u:"1f37f",a:"1"},{n:["dairy","butter"],u:"1f9c8",a:"12"},{n:["salt","shaker","condiment"],u:"1f9c2",a:"11"},{n:["can","canned food"],u:"1f96b",a:"5"},{n:["box","bento","bento box"],u:"1f371",a:"0.6"},{n:["rice","cracker","rice cracker"],u:"1f358",a:"0.6"},{n:["ball","rice","japanese","rice ball"],u:"1f359",a:"0.6"},{n:["rice","cooked","cooked rice"],u:"1f35a",a:"0.6"},{n:["rice","curry","curry rice"],u:"1f35b",a:"0.6"},{n:["bowl","ramen","noodle","steaming","steaming bowl"],u:"1f35c",a:"0.6"},{n:["pasta","spaghetti"],u:"1f35d",a:"0.6"},{n:["sweet","potato","roasted","roasted sweet potato"],u:"1f360",a:"0.6"},{n:["oden","kebab","stick","skewer","seafood"],u:"1f362",a:"0.6"},{n:["sushi"],u:"1f363",a:"0.6"},{n:["fried","prawn","shrimp","tempura","fried shrimp"],u:"1f364",a:"0.6"},{n:["cake","fish","swirl","pastry","fish cake with swirl"],u:"1f365",a:"0.6"},{n:["autumn","yubng","festival","moon cake"],u:"1f96e",a:"11"},{n:["dango","stick","sweet","skewer","dessert","japanese"],u:"1f361",a:"0.6"},{n:["gyza","jiaozi","pierogi","dumpling","empanada","potsticker"],u:"1f95f",a:"5"},{n:["prophecy","fortune cookie"],u:"1f960",a:"5"},{n:["takeout box","oyster pail"],u:"1f961",a:"5"},{n:["crab","cancer","zodiac"],u:"1f980",a:"1"},{n:["claws","bisque","lobster","seafood"],u:"1f99e",a:"11"},{n:["food","small","shrimp","shellfish"],u:"1f990",a:"3"},{n:["food","squid","molusc"],u:"1f991",a:"3"},{n:["pearl","oyster","diving"],u:"1f9aa",a:"12"},{n:["ice","soft","cream","sweet","dessert","icecream","soft ice cream"],u:"1f366",a:"0.6"},{n:["ice","sweet","shaved","dessert","shaved ice"],u:"1f367",a:"0.6"},{n:["ice","cream","sweet","dessert","ice cream"],u:"1f368",a:"0.6"},{n:["donut","sweet","dessert","doughnut","breakfast"],u:"1f369",a:"0.6"},{n:["sweet","cookie","dessert"],u:"1f36a",a:"0.6"},{n:["cake","sweet","pastry","dessert","birthday","celebration","birthday cake"],u:"1f382",a:"0.6"},{n:["cake","slice","sweet","pastry","dessert","shortcake"],u:"1f370",a:"0.6"},{n:["sweet","bakery","cupcake"],u:"1f9c1",a:"11"},{n:["pie","pastry","filling"],u:"1f967",a:"5"},{n:["bar","sweet","dessert","chocolate","chocolate bar"],u:"1f36b",a:"0.6"},{n:["candy","sweet","dessert"],u:"1f36c",a:"0.6"},{n:["candy","sweet","dessert","lollipop"],u:"1f36d",a:"0.6"},{n:["sweet","custard","dessert","pudding"],u:"1f36e",a:"0.6"},{n:["pot","honey","sweet","honeypot","honey pot"],u:"1f36f",a:"0.6"},{n:["baby","milk","drink","bottle","baby bottle"],u:"1f37c",a:"1"},{n:["milk","drink","glass","glass of milk"],u:"1f95b",a:"3"},{n:["hot","tea","drink","coffee","beverage","steaming","hot beverage"],u:"2615",a:"0.6"},{n:["pot","tea","drink","teapot"],u:"1fad6",a:"13"},{n:["cup","tea","drink","teacup","beverage","teacup without handle"],u:"1f375",a:"0.6"},{n:["bar","cup","sake","drink","bottle","beverage"],u:"1f376",a:"0.6"},{n:["bar","cork","drink","bottle","popping","bottle with popping cork"],u:"1f37e",a:"1"},{n:["bar","wine","drink","glass","beverage","wine glass"],u:"1f377",a:"0.6"},{n:["bar","drink","glass","cocktail","cocktail glass"],u:"1f378",a:"0.6"},{n:["bar","drink","tropical","tropical drink"],u:"1f379",a:"0.6"},{n:["bar","mug","beer","drink","beer mug"],u:"1f37a",a:"0.6"},{n:["bar","mug","beer","clink","drink","clinking beer mugs"],u:"1f37b",a:"0.6"},{n:["clink","drink","glass","celebrate","clinking glasses"],u:"1f942",a:"3"},{n:["shot","glass","liquor","whisky","tumbler","tumbler glass"],u:"1f943",a:"3"},{n:["drink","empty","glass","spill","pouring liquid"],u:"1fad7",a:"14"},{n:["soda","juice","cup with straw"],u:"1f964",a:"5"},{n:["tea","milk","pearl","bubble","bubble tea"],u:"1f9cb",a:"13"},{n:["box","juice","straw","sweet","beverage","beverage box"],u:"1f9c3",a:"12"},{n:["mate","drink"],u:"1f9c9",a:"12"},{n:["ice","cold","iceberg","ice cube"],u:"1f9ca",a:"12"},{n:["hashi","chopsticks"],u:"1f962",a:"5"},{n:["fork","knife","cooking","cutlery","fork and knife"],u:"1f374",a:"0.6"},{n:["spoon","tableware"],u:"1f944",a:"3"},{n:["tool","hocho","knife","weapon","cooking","kitchen knife"],u:"1f52a",a:"0.6"},{n:["jar","empty","sauce","store","condiment","container"],u:"1fad9",a:"14"},{n:["jug","drink","zodiac","amphora","cooking","aquarius"],u:"1f3fa",a:"1"}],travel_places:[{n:["earth","globe","world","africa","europe","globe showing Europe Africa","globe showing europe africa"],u:"1f30d",a:"0.7"},{n:["earth","globe","world","americas","globe showing Americas","globe showing americas"],u:"1f30e",a:"0.7"},{n:["asia","earth","globe","world","australia","globe showing Asia Australia","globe showing asia australia"],u:"1f30f",a:"0.6"},{n:["earth","globe","world","meridians","globe with meridians"],u:"1f310",a:"1"},{n:["map","japan","map of Japan","map of japan"],u:"1f5fe",a:"0.6"},{n:["compass","magnetic","navigation","orienteering"],u:"1f9ed",a:"11"},{n:["volcano","eruption","mountain"],u:"1f30b",a:"0.6"},{n:["fuji","mountain","mount fuji"],u:"1f5fb",a:"0.6"},{n:["clay","wall","brick","bricks","mortar"],u:"1f9f1",a:"11"},{n:["rock","heavy","solid","stone","boulder"],u:"1faa8",a:"13"},{n:["log","wood","lumber","timber"],u:"1fab5",a:"13"},{n:["hut","yurt","house","roundhouse"],u:"1f6d6",a:"13"},{n:["home","house"],u:"1f3e0",a:"0.6"},{n:["home","house","garden","house with garden"],u:"1f3e1",a:"0.6"},{n:["building","office building"],u:"1f3e2",a:"0.6"},{n:["post","japanese","Japanese post office","japanese post office"],u:"1f3e3",a:"0.6"},{n:["post","european","post office"],u:"1f3e4",a:"1"},{n:["doctor","hospital","medicine"],u:"1f3e5",a:"0.6"},{n:["bank","building"],u:"1f3e6",a:"0.6"},{n:["hotel","building"],u:"1f3e8",a:"0.6"},{n:["love","hotel","love hotel"],u:"1f3e9",a:"0.6"},{n:["store","convenience","convenience store"],u:"1f3ea",a:"0.6"},{n:["school","building"],u:"1f3eb",a:"0.6"},{n:["store","department","department store"],u:"1f3ec",a:"0.6"},{n:["factory","building"],u:"1f3ed",a:"0.6"},{n:["castle","japanese","Japanese castle"],u:"1f3ef",a:"0.6"},{n:["castle","european"],u:"1f3f0",a:"0.6"},{n:["chapel","wedding","romance"],u:"1f492",a:"0.6"},{n:["tokyo","tower","Tokyo tower"],u:"1f5fc",a:"0.6"},{n:["statue","liberty","Statue of Liberty","statue of liberty"],u:"1f5fd",a:"0.6"},{n:["cross","church","religion","christian"],u:"26ea",a:"0.6"},{n:["islam","mosque","muslim","religion"],u:"1f54c",a:"1"},{n:["hindu","temple","hindu temple"],u:"1f6d5",a:"12"},{n:["jew","jewish","temple","religion","synagogue"],u:"1f54d",a:"1"},{n:["kaaba","islam","muslim","religion"],u:"1f54b",a:"1"},{n:["fountain"],u:"26f2",a:"0.6"},{n:["tent","camping"],u:"26fa",a:"0.6"},{n:["fog","foggy"],u:"1f301",a:"0.6"},{n:["star","night","night with stars"],u:"1f303",a:"0.6"},{n:["sun","morning","sunrise","mountain","sunrise over mountains"],u:"1f304",a:"0.6"},{n:["sun","sunrise","morning"],u:"1f305",a:"0.6"},{n:["city","dusk","sunset","evening","landscape","cityscape at dusk"],u:"1f306",a:"0.6"},{n:["sun","dusk","sunset"],u:"1f307",a:"0.6"},{n:["night","bridge","bridge at night"],u:"1f309",a:"0.6"},{n:["horse","carousel","carousel horse"],u:"1f3a0",a:"0.6"},{n:["play","theme park","amusement park","playground slide"],u:"1f6dd",a:"14"},{n:["wheel","ferris","theme park","ferris wheel","amusement park"],u:"1f3a1",a:"0.6"},{n:["roller","coaster","theme park","roller coaster","amusement park"],u:"1f3a2",a:"0.6"},{n:["pole","barber","haircut","barber pole"],u:"1f488",a:"0.6"},{n:["tent","circus","circus tent"],u:"1f3aa",a:"0.6"},{n:["steam","train","engine","railway","locomotive"],u:"1f682",a:"1"},{n:["car","tram","train","railway","electric","trolleybus","railway car"],u:"1f683",a:"0.6"},{n:["speed","train","railway","shinkansen","high speed train"],u:"1f684",a:"0.6"},{n:["speed","train","bullet","railway","shinkansen","bullet train"],u:"1f685",a:"0.6"},{n:["train","railway"],u:"1f686",a:"1"},{n:["metro","subway"],u:"1f687",a:"0.6"},{n:["railway","light rail"],u:"1f688",a:"1"},{n:["train","station","railway"],u:"1f689",a:"0.6"},{n:["tram","trolleybus"],u:"1f68a",a:"1"},{n:["vehicle","monorail"],u:"1f69d",a:"1"},{n:["car","railway","mountain","mountain railway"],u:"1f69e",a:"1"},{n:["car","tram","tram car","trolleybus"],u:"1f68b",a:"1"},{n:["bus","vehicle"],u:"1f68c",a:"0.6"},{n:["bus","oncoming","oncoming bus"],u:"1f68d",a:"0.7"},{n:["bus","tram","trolley","trolleybus"],u:"1f68e",a:"1"},{n:["bus","minibus"],u:"1f690",a:"1"},{n:["vehicle","ambulance"],u:"1f691",a:"0.6"},{n:["fire","truck","engine","fire engine"],u:"1f692",a:"0.6"},{n:["car","patrol","police","police car"],u:"1f693",a:"0.6"},{n:["car","police","oncoming","oncoming police car"],u:"1f694",a:"0.7"},{n:["taxi","vehicle"],u:"1f695",a:"0.6"},{n:["taxi","oncoming","oncoming taxi"],u:"1f696",a:"1"},{n:["car","automobile"],u:"1f697",a:"0.6"},{n:["car","oncoming","automobile","oncoming automobile"],u:"1f698",a:"0.7"},{n:["recreational","sport utility","sport utility vehicle"],u:"1f699",a:"0.6"},{n:["truck","pickup","pick up","pickup truck"],u:"1f6fb",a:"13"},{n:["truck","delivery","delivery truck"],u:"1f69a",a:"0.6"},{n:["semi","lorry","truck","articulated lorry"],u:"1f69b",a:"1"},{n:["tractor","vehicle"],u:"1f69c",a:"1"},{n:["motor","scooter","motor scooter"],u:"1f6f5",a:"3"},{n:["accessibility","manual wheelchair"],u:"1f9bd",a:"12"},{n:["accessibility","motorized wheelchair"],u:"1f9bc",a:"12"},{n:["tuk tuk","auto rickshaw"],u:"1f6fa",a:"12"},{n:["bike","bicycle"],u:"1f6b2",a:"0.6"},{n:["kick","scooter","kick scooter"],u:"1f6f4",a:"3"},{n:["board","skateboard"],u:"1f6f9",a:"11"},{n:["skate","roller","roller skate"],u:"1f6fc",a:"13"},{n:["bus","stop","bus stop"],u:"1f68f",a:"0.6"},{n:["gas","fuel","pump","diesel","station","fuelpump","fuel pump"],u:"26fd",a:"0.6"},{n:["tire","turn","wheel","circle"],u:"1f6de",a:"14"},{n:["car","light","beacon","police","revolving","police car light"],u:"1f6a8",a:"0.6"},{n:["light","signal","traffic","horizontal traffic light"],u:"1f6a5",a:"0.6"},{n:["light","signal","traffic","vertical traffic light"],u:"1f6a6",a:"1"},{n:["sign","stop","stop sign","octagonal"],u:"1f6d1",a:"3"},{n:["barrier","construction"],u:"1f6a7",a:"0.6"},{n:["ship","tool","anchor"],u:"2693",a:"0.6"},{n:["float","rescue","safety","ring buoy","life saver","life preserver"],u:"1f6df",a:"14"},{n:["sea","boat","yacht","resort","sailboat"],u:"26f5",a:"0.6"},{n:["boat","canoe"],u:"1f6f6",a:"3"},{n:["boat","speedboat"],u:"1f6a4",a:"0.6"},{n:["ship","boat","passenger"],u:"1f6a2",a:"0.6"},{n:["airplane","check in","aeroplane","departure","departures","airplane departure"],u:"1f6eb",a:"1"},{n:["landing","airplane","arrivals","arriving","aeroplane","airplane arrival"],u:"1f6ec",a:"1"},{n:["skydive","parasail","parachute","hang glide"],u:"1fa82",a:"12"},{n:["seat","chair"],u:"1f4ba",a:"0.6"},{n:["vehicle","helicopter"],u:"1f681",a:"1"},{n:["railway","suspension","suspension railway"],u:"1f69f",a:"1"},{n:["cable","gondola","mountain","mountain cableway"],u:"1f6a0",a:"1"},{n:["car","cable","aerial","gondola","tramway","aerial tramway"],u:"1f6a1",a:"1"},{n:["space","rocket"],u:"1f680",a:"0.6"},{n:["ufo","flying saucer"],u:"1f6f8",a:"5"},{n:["travel","luggage","packing"],u:"1f9f3",a:"11"},{n:["sand","timer","hourglass done"],u:"231b",a:"0.6"},{n:["sand","timer","hourglass","hourglass not done"],u:"23f3",a:"0.6"},{n:["watch","clock"],u:"231a",a:"0.6"},{n:["alarm","clock","alarm clock"],u:"23f0",a:"0.6"},{n:["00","12","12:00","clock","twelve","oclock","twelve oclock"],u:"1f55b",a:"0.6"},{n:["12","12:30","clock","thirty","twelve","twelve thirty"],u:"1f567",a:"0.7"},{n:["1","00","one","1:00","clock","oclock","one oclock"],u:"1f550",a:"0.6"},{n:["1","one","1:30","clock","thirty","one thirty"],u:"1f55c",a:"0.7"},{n:["2","00","two","2:00","clock","oclock","two oclock"],u:"1f551",a:"0.6"},{n:["2","two","2:30","clock","thirty","two thirty"],u:"1f55d",a:"0.7"},{n:["3","00","3:00","clock","three","oclock","three oclock"],u:"1f552",a:"0.6"},{n:["3","3:30","clock","three","thirty","three thirty"],u:"1f55e",a:"0.7"},{n:["4","00","4:00","four","clock","oclock","four oclock"],u:"1f553",a:"0.6"},{n:["4","4:30","four","clock","thirty","four thirty"],u:"1f55f",a:"0.7"},{n:["5","00","5:00","five","clock","oclock","five oclock"],u:"1f554",a:"0.6"},{n:["5","5:30","five","clock","thirty","five thirty"],u:"1f560",a:"0.7"},{n:["6","00","six","6:00","clock","oclock","six oclock"],u:"1f555",a:"0.6"},{n:["6","six","6:30","clock","thirty","six thirty"],u:"1f561",a:"0.7"},{n:["7","00","7:00","clock","seven","oclock","seven oclock"],u:"1f556",a:"0.6"},{n:["7","7:30","clock","seven","thirty","seven thirty"],u:"1f562",a:"0.7"},{n:["8","00","8:00","clock","eight","oclock","eight oclock"],u:"1f557",a:"0.6"},{n:["8","8:30","clock","eight","thirty","eight thirty"],u:"1f563",a:"0.7"},{n:["9","00","9:00","nine","clock","oclock","nine oclock"],u:"1f558",a:"0.6"},{n:["9","9:30","nine","clock","thirty","nine thirty"],u:"1f564",a:"0.7"},{n:["00","10","ten","10:00","clock","oclock","ten oclock"],u:"1f559",a:"0.6"},{n:["10","ten","10:30","clock","thirty","ten thirty"],u:"1f565",a:"0.7"},{n:["00","11","11:00","clock","eleven","oclock","eleven oclock"],u:"1f55a",a:"0.6"},{n:["11","11:30","clock","eleven","thirty","eleven thirty"],u:"1f566",a:"0.7"},{n:["dark","moon","new moon"],u:"1f311",a:"0.6"},{n:["moon","waxing","crescent","waxing crescent moon"],u:"1f312",a:"1"},{n:["moon","quarter","first quarter moon"],u:"1f313",a:"0.6"},{n:["moon","waxing","gibbous","waxing gibbous moon"],u:"1f314",a:"0.6"},{n:["full","moon","full moon"],u:"1f315",a:"0.6"},{n:["moon","waning","gibbous","waning gibbous moon"],u:"1f316",a:"1"},{n:["moon","quarter","last quarter moon"],u:"1f317",a:"1"},{n:["moon","waning","crescent","waning crescent moon"],u:"1f318",a:"1"},{n:["moon","crescent","crescent moon"],u:"1f319",a:"0.6"},{n:["face","moon","new moon face"],u:"1f31a",a:"1"},{n:["face","moon","quarter","first quarter moon face"],u:"1f31b",a:"0.6"},{n:["face","moon","quarter","last quarter moon face"],u:"1f31c",a:"0.7"},{n:["face","full","moon","bright","full moon face"],u:"1f31d",a:"1"},{n:["sun","face","bright","sun with face"],u:"1f31e",a:"1"},{n:["saturn","saturnine","ringed planet"],u:"1fa90",a:"12"},{n:["star"],u:"2b50",a:"0.6"},{n:["glow","star","shining","sparkle","glittery","glowing star"],u:"1f31f",a:"0.6"},{n:["star","falling","shooting","shooting star"],u:"1f320",a:"0.6"},{n:["space","milky way"],u:"1f30c",a:"0.6"},{n:["sun","cloud","sun behind cloud"],u:"26c5",a:"0.6"},{n:["dizzy","cyclone","twister","typhoon","hurricane"],u:"1f300",a:"0.6"},{n:["rain","rainbow"],u:"1f308",a:"0.6"},{n:["rain","clothing","umbrella","closed umbrella"],u:"1f302",a:"0.6"},{n:["drop","rain","clothing","umbrella","umbrella with rain drops"],u:"2614",a:"0.6"},{n:["zap","danger","voltage","electric","lightning","high voltage"],u:"26a1",a:"0.6"},{n:["cold","snow","snowman","snowman without snow"],u:"26c4",a:"0.6"},{n:["fire","tool","flame"],u:"1f525",a:"0.6"},{n:["cold","drop","comic","sweat","droplet"],u:"1f4a7",a:"0.6"},{n:["wave","ocean","water","water wave"],u:"1f30a",a:"0.6"}],activities:[{n:["jack","lantern","halloween","celebration","jack o lantern"],u:"1f383",a:"0.6"},{n:["tree","christmas","celebration","Christmas tree"],u:"1f384",a:"0.6"},{n:["fireworks","celebration"],u:"1f386",a:"0.6"},{n:["sparkle","sparkler","fireworks","celebration"],u:"1f387",a:"0.6"},{n:["dynamite","explosive","fireworks","firecracker"],u:"1f9e8",a:"11"},{n:["*","star","sparkle","sparkles"],u:"2728",a:"0.6"},{n:["balloon","celebration"],u:"1f388",a:"0.6"},{n:["tada","party","popper","celebration","party popper"],u:"1f389",a:"0.6"},{n:["ball","confetti","celebration","confetti ball"],u:"1f38a",a:"0.6"},{n:["tree","banner","japanese","celebration","tanabata tree"],u:"1f38b",a:"0.6"},{n:["pine","bamboo","japanese","celebration","pine decoration"],u:"1f38d",a:"0.6"},{n:["doll","festival","japanese","celebration","Japanese dolls","japanese dolls"],u:"1f38e",a:"0.6"},{n:["carp","streamer","celebration","carp streamer"],u:"1f38f",a:"0.6"},{n:["bell","wind","chime","wind chime","celebration"],u:"1f390",a:"0.6"},{n:["moon","ceremony","celebration","moon viewing ceremony"],u:"1f391",a:"0.6"},{n:["gift","money","hngbo","lai see","good luck","red envelope"],u:"1f9e7",a:"11"},{n:["ribbon","celebration"],u:"1f380",a:"0.6"},{n:["box","gift","present","wrapped","celebration","wrapped gift"],u:"1f381",a:"0.6"},{n:["ticket","admission"],u:"1f3ab",a:"0.6"},{n:["prize","trophy"],u:"1f3c6",a:"0.6"},{n:["medal","sports medal"],u:"1f3c5",a:"1"},{n:["gold","first","medal","1st place medal"],u:"1f947",a:"3"},{n:["medal","second","silver","2nd place medal"],u:"1f948",a:"3"},{n:["medal","third","bronze","3rd place medal"],u:"1f949",a:"3"},{n:["ball","soccer","football","soccer ball"],u:"26bd",a:"0.6"},{n:["ball","baseball"],u:"26be",a:"0.6"},{n:["ball","glove","softball","underarm"],u:"1f94e",a:"11"},{n:["ball","hoop","basketball"],u:"1f3c0",a:"0.6"},{n:["ball","game","volleyball"],u:"1f3d0",a:"1"},{n:["ball","american","football","american football"],u:"1f3c8",a:"0.6"},{n:["ball","rugby","football","rugby football"],u:"1f3c9",a:"1"},{n:["ball","tennis","racquet"],u:"1f3be",a:"0.6"},{n:["ultimate","flying disc"],u:"1f94f",a:"11"},{n:["ball","game","bowling"],u:"1f3b3",a:"0.6"},{n:["bat","ball","game","cricket game"],u:"1f3cf",a:"1"},{n:["ball","game","field","stick","hockey","field hockey"],u:"1f3d1",a:"1"},{n:["ice","game","puck","stick","hockey","ice hockey"],u:"1f3d2",a:"1"},{n:["ball","goal","stick","lacrosse"],u:"1f94d",a:"11"},{n:["bat","ball","game","paddle","ping pong","table tennis"],u:"1f3d3",a:"1"},{n:["game","birdie","racquet","badminton","shuttlecock"],u:"1f3f8",a:"1"},{n:["glove","boxing","boxing glove"],u:"1f94a",a:"3"},{n:["judo","karate","uniform","taekwondo","martial arts","martial arts uniform"],u:"1f94b",a:"3"},{n:["net","goal","goal net"],u:"1f945",a:"3"},{n:["golf","hole","flag in hole"],u:"26f3",a:"0.6"},{n:["fish","pole","fishing pole"],u:"1f3a3",a:"0.6"},{n:["scuba","diving","snorkeling","diving mask"],u:"1f93f",a:"12"},{n:["sash","shirt","running","athletics","running shirt"],u:"1f3bd",a:"0.6"},{n:["ski","skis","snow"],u:"1f3bf",a:"0.6"},{n:["sled","sledge","sleigh"],u:"1f6f7",a:"5"},{n:["game","rock","curling stone"],u:"1f94c",a:"5"},{n:["hit","dart","game","target","bullseye","direct hit"],u:"1f3af",a:"0.6"},{n:["toy","yo yo","fluctuate"],u:"1fa80",a:"12"},{n:["fly","kite","soar"],u:"1fa81",a:"12"},{n:["gun","tool","water","pistol","weapon","handgun","revolver","water pistol"],u:"1f52b",a:"0.6"},{n:["8","ball","game","eight","billiard","pool 8 ball"],u:"1f3b1",a:"0.6"},{n:["ball","tool","crystal","fantasy","fortune","fairy tale","crystal ball"],u:"1f52e",a:"0.6"},{n:["magic","witch","wizard","magic wand"],u:"1fa84",a:"13"},{n:["game","video game","controller"],u:"1f3ae",a:"0.6"},{n:["game","slot","slot machine"],u:"1f3b0",a:"0.6"},{n:["die","dice","game","game die"],u:"1f3b2",a:"0.6"},{n:["clue","piece","jigsaw","puzzle","puzzle piece","interlocking"],u:"1f9e9",a:"11"},{n:["toy","plush","stuffed","plaything","teddy bear"],u:"1f9f8",a:"11"},{n:["party","piata","celebration"],u:"1fa85",a:"13"},{n:["dance","disco","party","glitter","mirror ball"],u:"1faa9",a:"14"},{n:["doll","russia","nesting","nesting dolls"],u:"1fa86",a:"13"},{n:["card","game","joker","wildcard"],u:"1f0cf",a:"0.6"},{n:["red","game","mahjong","mahjong red dragon"],u:"1f004",a:"0.6"},{n:["card","game","flower","playing","japanese","flower playing cards"],u:"1f3b4",a:"0.6"},{n:["art","mask","theater","theatre","performing","performing arts"],u:"1f3ad",a:"0.6"},{n:["art","museum","palette","painting","artist palette"],u:"1f3a8",a:"0.6"},{n:["spool","thread","needle","sewing","string"],u:"1f9f5",a:"11"},{n:["needle","sewing","sutures","stitches","tailoring","embroidery","sewing needle"],u:"1faa1",a:"13"},{n:["yarn","ball","knit","crochet"],u:"1f9f6",a:"11"},{n:["tie","knot","rope","twine","twist","tangled"],u:"1faa2",a:"13"}],objects:[{n:["eye","glasses","eyewear","clothing","eyeglasses"],u:"1f453",a:"0.6"},{n:["goggles","welding","swimming","eye protection"],u:"1f97d",a:"11"},{n:["doctor","lab coat","scientist","experiment"],u:"1f97c",a:"11"},{n:["vest","safety","emergency","safety vest"],u:"1f9ba",a:"12"},{n:["tie","necktie","clothing"],u:"1f454",a:"0.6"},{n:["shirt","tshirt","t shirt","clothing"],u:"1f455",a:"0.6"},{n:["jeans","pants","clothing","trousers"],u:"1f456",a:"0.6"},{n:["neck","scarf"],u:"1f9e3",a:"5"},{n:["hand","gloves"],u:"1f9e4",a:"5"},{n:["coat","jacket"],u:"1f9e5",a:"5"},{n:["socks","stocking"],u:"1f9e6",a:"5"},{n:["dress","clothing"],u:"1f457",a:"0.6"},{n:["kimono","clothing"],u:"1f458",a:"0.6"},{n:["sari","dress","clothing"],u:"1f97b",a:"12"},{n:["bathing suit","one piece swimsuit"],u:"1fa71",a:"12"},{n:["briefs","swimsuit","one piece","underwear","bathing suit"],u:"1fa72",a:"12"},{n:["pants","shorts","underwear","bathing suit"],u:"1fa73",a:"12"},{n:["swim","bikini","clothing"],u:"1f459",a:"0.6"},{n:["woman","clothing","womans clothes"],u:"1f45a",a:"0.6"},{n:["fan","hot","shy","dance","cooling","flutter","folding hand fan"],u:"1faad",a:"15"},{n:["coin","purse","clothing"],u:"1f45b",a:"0.6"},{n:["bag","purse","handbag","clothing"],u:"1f45c",a:"0.6"},{n:["bag","pouch","clothing","clutch bag"],u:"1f45d",a:"0.6"},{n:["bag","school","satchel","backpack","rucksack"],u:"1f392",a:"0.6"},{n:["zri","thongs","sandals","thong sandal","beach sandals","thong sandals"],u:"1fa74",a:"13"},{n:["man","shoe","clothing","mans shoe"],u:"1f45e",a:"0.6"},{n:["shoe","sneaker","athletic","clothing","running shoe"],u:"1f45f",a:"0.6"},{n:["boot","hiking","camping","hiking boot","backpacking"],u:"1f97e",a:"11"},{n:["slip on","slipper","flat shoe","ballet flat"],u:"1f97f",a:"11"},{n:["heel","shoe","woman","clothing","high heeled shoe"],u:"1f460",a:"0.6"},{n:["shoe","woman","sandal","clothing","womans sandal"],u:"1f461",a:"0.6"},{n:["dance","ballet","ballet shoes"],u:"1fa70",a:"12"},{n:["boot","shoe","woman","clothing","womans boot"],u:"1f462",a:"0.6"},{n:["afro","comb","hair","pick","hair pick"],u:"1faae",a:"15"},{n:["king","crown","queen","clothing"],u:"1f451",a:"0.6"},{n:["hat","woman","clothing","womans hat"],u:"1f452",a:"0.6"},{n:["hat","top","tophat","top hat","clothing"],u:"1f3a9",a:"0.6"},{n:["cap","hat","clothing","graduation","celebration","graduation cap"],u:"1f393",a:"0.6"},{n:["billed cap","baseball cap"],u:"1f9e2",a:"5"},{n:["army","helmet","soldier","warrior","military","military helmet"],u:"1fa96",a:"13"},{n:["beads","prayer","clothing","necklace","religion","prayer beads"],u:"1f4ff",a:"1"},{n:["makeup","lipstick","cosmetics"],u:"1f484",a:"0.6"},{n:["ring","diamond"],u:"1f48d",a:"0.6"},{n:["gem","jewel","diamond","gem stone"],u:"1f48e",a:"0.6"},{n:["mute","quiet","silent","speaker","muted speaker"],u:"1f507",a:"1"},{n:["soft","speaker low volume"],u:"1f508",a:"0.7"},{n:["medium","speaker medium volume"],u:"1f509",a:"1"},{n:["loud","speaker high volume"],u:"1f50a",a:"0.6"},{n:["loud","loudspeaker","public address"],u:"1f4e2",a:"0.6"},{n:["cheering","megaphone"],u:"1f4e3",a:"0.6"},{n:["horn","post","postal","postal horn"],u:"1f4ef",a:"1"},{n:["bell"],u:"1f514",a:"0.6"},{n:["bell","mute","quiet","silent","forbidden","bell with slash"],u:"1f515",a:"1"},{n:["music","score","musical score"],u:"1f3bc",a:"0.6"},{n:["note","music","musical note"],u:"1f3b5",a:"0.6"},{n:["note","music","notes","musical notes"],u:"1f3b6",a:"0.6"},{n:["mic","karaoke","microphone"],u:"1f3a4",a:"0.6"},{n:["earbud","headphone"],u:"1f3a7",a:"0.6"},{n:["radio","video"],u:"1f4fb",a:"0.6"},{n:["sax","music","saxophone","instrument"],u:"1f3b7",a:"0.6"},{n:["accordion","concertina","squeeze box"],u:"1fa97",a:"13"},{n:["music","guitar","instrument"],u:"1f3b8",a:"0.6"},{n:["music","piano","keyboard","instrument","musical keyboard"],u:"1f3b9",a:"0.6"},{n:["music","trumpet","instrument"],u:"1f3ba",a:"0.6"},{n:["music","violin","instrument"],u:"1f3bb",a:"0.6"},{n:["banjo","music","stringed"],u:"1fa95",a:"12"},{n:["drum","music","drumsticks"],u:"1f941",a:"3"},{n:["beat","drum","conga","rhythm","long drum"],u:"1fa98",a:"13"},{n:["music","shake","rattle","maracas","instrument","percussion"],u:"1fa87",a:"15"},{n:["fife","pipe","flute","music","recorder","woodwind"],u:"1fa88",a:"15"},{n:["cell","phone","mobile","telephone","mobile phone"],u:"1f4f1",a:"0.6"},{n:["cell","arrow","phone","mobile","receive","mobile phone with arrow"],u:"1f4f2",a:"0.6"},{n:["phone","receiver","telephone","telephone receiver"],u:"1f4de",a:"0.6"},{n:["pager"],u:"1f4df",a:"0.6"},{n:["fax","fax machine"],u:"1f4e0",a:"0.6"},{n:["battery"],u:"1f50b",a:"0.6"},{n:["electronic","low energy","low battery"],u:"1faab",a:"14"},{n:["plug","electric","electricity","electric plug"],u:"1f50c",a:"0.6"},{n:["pc","laptop","computer","personal"],u:"1f4bb",a:"0.6"},{n:["disk","optical","computer","minidisk","computer disk"],u:"1f4bd",a:"0.6"},{n:["disk","floppy","computer","floppy disk"],u:"1f4be",a:"0.6"},{n:["cd","disk","optical","computer","optical disk"],u:"1f4bf",a:"0.6"},{n:["dvd","disk","blu ray","optical","computer"],u:"1f4c0",a:"0.6"},{n:["abacus","calculation"],u:"1f9ee",a:"11"},{n:["movie","camera","cinema","movie camera"],u:"1f3a5",a:"0.6"},{n:["movie","clapper","clapper board"],u:"1f3ac",a:"0.6"},{n:["tv","video","television"],u:"1f4fa",a:"0.6"},{n:["video","camera"],u:"1f4f7",a:"0.6"},{n:["flash","video","camera","camera with flash"],u:"1f4f8",a:"1"},{n:["video","camera","video camera"],u:"1f4f9",a:"0.6"},{n:["vhs","tape","video","videocassette"],u:"1f4fc",a:"0.6"},{n:["tool","glass","search","magnifying","magnifying glass tilted left"],u:"1f50d",a:"0.6"},{n:["tool","glass","search","magnifying","magnifying glass tilted right"],u:"1f50e",a:"0.6"},{n:["bulb","idea","comic","light","electric","light bulb"],u:"1f4a1",a:"0.6"},{n:["tool","light","torch","electric","flashlight"],u:"1f526",a:"0.6"},{n:["bar","red","light","lantern","red paper lantern"],u:"1f3ee",a:"0.6"},{n:["oil","diya","lamp","diya lamp"],u:"1fa94",a:"12"},{n:["book","cover","notebook","decorated","notebook with decorative cover"],u:"1f4d4",a:"0.6"},{n:["book","closed","closed book"],u:"1f4d5",a:"0.6"},{n:["book","open","open book"],u:"1f4d6",a:"0.6"},{n:["book","green","green book"],u:"1f4d7",a:"0.6"},{n:["blue","book","blue book"],u:"1f4d8",a:"0.6"},{n:["book","orange","orange book"],u:"1f4d9",a:"0.6"},{n:["book","books"],u:"1f4da",a:"0.6"},{n:["notebook"],u:"1f4d3",a:"0.6"},{n:["ledger","notebook"],u:"1f4d2",a:"0.6"},{n:["curl","page","document","page with curl"],u:"1f4c3",a:"0.6"},{n:["paper","scroll"],u:"1f4dc",a:"0.6"},{n:["page","document","page facing up"],u:"1f4c4",a:"0.6"},{n:["news","paper","newspaper"],u:"1f4f0",a:"0.6"},{n:["mark","tabs","marker","bookmark","bookmark tabs"],u:"1f4d1",a:"0.6"},{n:["mark","bookmark"],u:"1f516",a:"0.6"},{n:["bag","money","dollar","moneybag","money bag"],u:"1f4b0",a:"0.6"},{n:["coin","gold","metal","money","silver","treasure"],u:"1fa99",a:"13"},{n:["yen","bill","note","money","banknote","currency","yen banknote"],u:"1f4b4",a:"0.6"},{n:["bill","note","money","dollar","banknote","currency","dollar banknote"],u:"1f4b5",a:"0.6"},{n:["bill","euro","note","money","banknote","currency","euro banknote"],u:"1f4b6",a:"1"},{n:["bill","note","money","pound","banknote","currency","pound banknote"],u:"1f4b7",a:"1"},{n:["fly","bill","money","wings","banknote","money with wings"],u:"1f4b8",a:"0.6"},{n:["card","money","credit","credit card"],u:"1f4b3",a:"0.6"},{n:["proof","receipt","evidence","accounting","bookkeeping"],u:"1f9fe",a:"11"},{n:["yen","chart","graph","money","growth","chart increasing with yen"],u:"1f4b9",a:"0.6"},{n:["mail","email","e mail","letter"],u:"1f4e7",a:"0.6"},{n:["email","e mail","letter","receive","envelope","incoming","incoming envelope"],u:"1f4e8",a:"0.6"},{n:["arrow","email","e mail","envelope","outgoing","envelope with arrow"],u:"1f4e9",a:"0.6"},{n:["box","mail","sent","tray","letter","outbox","outbox tray"],u:"1f4e4",a:"0.6"},{n:["box","mail","tray","inbox","letter","receive","inbox tray"],u:"1f4e5",a:"0.6"},{n:["box","parcel","package"],u:"1f4e6",a:"0.6"},{n:["mail","closed","mailbox","postbox","closed mailbox with raised flag"],u:"1f4eb",a:"0.6"},{n:["mail","closed","lowered","mailbox","postbox","closed mailbox with lowered flag"],u:"1f4ea",a:"0.6"},{n:["mail","open","mailbox","postbox","open mailbox with raised flag"],u:"1f4ec",a:"0.7"},{n:["mail","open","lowered","mailbox","postbox","open mailbox with lowered flag"],u:"1f4ed",a:"0.7"},{n:["mail","postbox","mailbox"],u:"1f4ee",a:"0.6"},{n:["memo","pencil"],u:"1f4dd",a:"0.6"},{n:["briefcase"],u:"1f4bc",a:"0.6"},{n:["file","folder","file folder"],u:"1f4c1",a:"0.6"},{n:["file","open","folder","open file folder"],u:"1f4c2",a:"0.6"},{n:["date","calendar"],u:"1f4c5",a:"0.6"},{n:["calendar","tear off calendar"],u:"1f4c6",a:"0.6"},{n:["card","index","rolodex","card index"],u:"1f4c7",a:"0.6"},{n:["chart","graph","trend","growth","upward","chart increasing"],u:"1f4c8",a:"0.6"},{n:["down","chart","graph","trend","chart decreasing"],u:"1f4c9",a:"0.6"},{n:["bar","chart","graph","bar chart"],u:"1f4ca",a:"0.6"},{n:["clipboard"],u:"1f4cb",a:"0.6"},{n:["pin","pushpin"],u:"1f4cc",a:"0.6"},{n:["pin","pushpin","round pushpin"],u:"1f4cd",a:"0.6"},{n:["paperclip"],u:"1f4ce",a:"0.6"},{n:["ruler","straight edge","straight ruler"],u:"1f4cf",a:"0.6"},{n:["set","ruler","triangle","triangular ruler"],u:"1f4d0",a:"0.6"},{n:["locked","closed"],u:"1f512",a:"0.6"},{n:["lock","open","unlock","unlocked"],u:"1f513",a:"0.6"},{n:["ink","nib","pen","lock","privacy","locked with pen"],u:"1f50f",a:"0.6"},{n:["key","lock","closed","secure","locked with key"],u:"1f510",a:"0.6"},{n:["key","lock","password"],u:"1f511",a:"0.6"},{n:["tool","hammer"],u:"1f528",a:"0.6"},{n:["axe","chop","wood","split","hatchet"],u:"1fa93",a:"12"},{n:["bomb","comic"],u:"1f4a3",a:"0.6"},{n:["rebound","boomerang","repercussion"],u:"1fa83",a:"13"},{n:["bow","arrow","archer","zodiac","sagittarius","bow and arrow"],u:"1f3f9",a:"1"},{n:["saw","tool","lumber","carpenter","carpentry saw"],u:"1fa9a",a:"13"},{n:["tool","wrench","spanner"],u:"1f527",a:"0.6"},{n:["tool","screw","screwdriver"],u:"1fa9b",a:"13"},{n:["nut","bolt","tool","nut and bolt"],u:"1f529",a:"0.6"},{n:["blind","white cane","accessibility"],u:"1f9af",a:"12"},{n:["link"],u:"1f517",a:"0.6"},{n:["break","chain","cuffs","freedom","breaking","broken chain"],u:"26d3-fe0f-200d-1f4a5",a:"15.1"},{n:["hook","catch","crook","curve","ensnare","selling point"],u:"1fa9d",a:"13"},{n:["tool","chest","toolbox","mechanic"],u:"1f9f0",a:"11"},{n:["magnet","magnetic","horseshoe","attraction"],u:"1f9f2",a:"11"},{n:["rung","step","climb","ladder"],u:"1fa9c",a:"13"},{n:["lab","chemist","science","test tube","chemistry","experiment"],u:"1f9ea",a:"11"},{n:["lab","biology","culture","bacteria","biologist","petri dish"],u:"1f9eb",a:"11"},{n:["dna","gene","life","genetics","biologist","evolution"],u:"1f9ec",a:"11"},{n:["tool","science","microscope"],u:"1f52c",a:"1"},{n:["tool","science","telescope"],u:"1f52d",a:"1"},{n:["dish","antenna","satellite","satellite antenna"],u:"1f4e1",a:"0.6"},{n:["shot","sick","needle","syringe","medicine"],u:"1f489",a:"0.6"},{n:["bleed","injury","medicine","menstruation","drop of blood","blood donation"],u:"1fa78",a:"12"},{n:["pill","sick","doctor","medicine"],u:"1f48a",a:"0.6"},{n:["bandage","adhesive bandage"],u:"1fa79",a:"12"},{n:["cane","hurt","stick","crutch","disability","mobility aid"],u:"1fa7c",a:"14"},{n:["heart","doctor","medicine","stethoscope"],u:"1fa7a",a:"12"},{n:["x ray","bones","doctor","medical","skeleton"],u:"1fa7b",a:"14"},{n:["door"],u:"1f6aa",a:"0.6"},{n:["lift","hoist","elevator","accessibility"],u:"1f6d7",a:"13"},{n:["mirror","speculum","reflector","reflection"],u:"1fa9e",a:"13"},{n:["view","frame","window","opening","fresh air","transparent"],u:"1fa9f",a:"13"},{n:["sit","seat","chair"],u:"1fa91",a:"12"},{n:["toilet"],u:"1f6bd",a:"0.6"},{n:["toilet","plunger","plumber","suction","force cup"],u:"1faa0",a:"13"},{n:["water","shower"],u:"1f6bf",a:"1"},{n:["bath","bathtub"],u:"1f6c1",a:"1"},{n:["bait","trap","snare","mousetrap","mouse trap"],u:"1faa4",a:"13"},{n:["razor","sharp","shave"],u:"1fa92",a:"12"},{n:["lotion","shampoo","sunscreen","moisturizer","lotion bottle"],u:"1f9f4",a:"11"},{n:["diaper","punk rock","safety pin"],u:"1f9f7",a:"11"},{n:["broom","witch","cleaning","sweeping"],u:"1f9f9",a:"11"},{n:["basket","picnic","farming","laundry"],u:"1f9fa",a:"11"},{n:["paper towels","toilet paper","roll of paper"],u:"1f9fb",a:"11"},{n:["vat","cask","pail","bucket"],u:"1faa3",a:"13"},{n:["bar","soap","lather","bathing","cleaning","soapdish"],u:"1f9fc",a:"11"},{n:["burp","soap","clean","bubbles","underwater"],u:"1fae7",a:"14"},{n:["brush","clean","teeth","dental","hygiene","bathroom","toothbrush"],u:"1faa5",a:"13"},{n:["sponge","porous","cleaning","absorbing"],u:"1f9fd",a:"11"},{n:["fire","quench","extinguish","fire extinguisher"],u:"1f9ef",a:"11"},{n:["cart","trolley","shopping","shopping cart"],u:"1f6d2",a:"3"},{n:["smoking","cigarette"],u:"1f6ac",a:"0.6"},{n:["grave","cemetery","headstone","graveyard","tombstone"],u:"1faa6",a:"13"},{n:["bead","charm","nazar","evil eye","talisman","nazar amulet"],u:"1f9ff",a:"11"},{n:["hand","mary","hamsa","amulet","fatima","miriam","protection"],u:"1faac",a:"14"},{n:["moai","face","moyai","statue"],u:"1f5ff",a:"0.6"},{n:["sign","picket","placard","protest","demonstration"],u:"1faa7",a:"13"},{n:["id","license","security","credentials","identification card"],u:"1faaa",a:"14"}],symbols:[{n:["atm","bank","teller","ATM sign","atm sign","automated"],u:"1f3e7",a:"0.6"},{n:["litter","litter bin","litter in bin sign"],u:"1f6ae",a:"1"},{n:["water","potable","drinking","potable water"],u:"1f6b0",a:"1"},{n:["access","wheelchair symbol"],u:"267f",a:"0.6"},{n:["wc","man","toilet","bathroom","lavatory","restroom","mens room"],u:"1f6b9",a:"0.6"},{n:["wc","woman","toilet","bathroom","lavatory","restroom","womens room"],u:"1f6ba",a:"0.6"},{n:["wc","toilet","restroom","bathroom","lavatory"],u:"1f6bb",a:"0.6"},{n:["baby","changing","baby symbol"],u:"1f6bc",a:"0.6"},{n:["wc","water","closet","toilet","bathroom","lavatory","restroom","water closet"],u:"1f6be",a:"0.6"},{n:["control","passport","passport control"],u:"1f6c2",a:"1"},{n:["customs"],u:"1f6c3",a:"1"},{n:["claim","baggage","baggage claim"],u:"1f6c4",a:"1"},{n:["locker","baggage","luggage","left luggage"],u:"1f6c5",a:"1"},{n:["child","traffic","crossing","pedestrian","children crossing"],u:"1f6b8",a:"1"},{n:["no","not","entry","traffic","no entry","forbidden","prohibited"],u:"26d4",a:"0.6"},{n:["no","not","entry","forbidden","prohibited"],u:"1f6ab",a:"0.6"},{n:["no","bike","bicycle","forbidden","prohibited","no bicycles"],u:"1f6b3",a:"1"},{n:["no","not","smoking","forbidden","no smoking","prohibited"],u:"1f6ad",a:"0.6"},{n:["no","not","litter","forbidden","prohibited","no littering"],u:"1f6af",a:"1"},{n:["water","non potable","non drinking","non potable water"],u:"1f6b1",a:"1"},{n:["no","not","forbidden","pedestrian","prohibited","no pedestrians"],u:"1f6b7",a:"1"},{n:["no","cell","phone","mobile","forbidden","no mobile phones"],u:"1f4f5",a:"1"},{n:["18","eighteen","underage","prohibited","age restriction","no one under eighteen"],u:"1f51e",a:"0.6"},{n:["arrow","reload","clockwise","clockwise vertical arrows"],u:"1f503",a:"0.6"},{n:["arrow","withershins","anticlockwise","counterclockwise","counterclockwise arrows button"],u:"1f504",a:"1"},{n:["back","arrow","BACK arrow"],u:"1f519",a:"0.6"},{n:["end","arrow","END arrow"],u:"1f51a",a:"0.6"},{n:["on","on!","mark","arrow","ON! arrow"],u:"1f51b",a:"0.6"},{n:["soon","arrow","SOON arrow"],u:"1f51c",a:"0.6"},{n:["up","top","arrow","TOP arrow"],u:"1f51d",a:"0.6"},{n:["worship","religion","place of worship"],u:"1f6d0",a:"1"},{n:["menorah","religion","candelabrum","candlestick"],u:"1f54e",a:"1"},{n:["star","fortune","dotted six pointed star"],u:"1f52f",a:"0.6"},{n:["sikh","khanda","religion"],u:"1faaf",a:"15"},{n:["ram","Aries","aries","zodiac"],u:"2648",a:"0.6"},{n:["ox","bull","Taurus","taurus","zodiac"],u:"2649",a:"0.6"},{n:["twins","Gemini","gemini","zodiac"],u:"264a",a:"0.6"},{n:["crab","Cancer","cancer","zodiac"],u:"264b",a:"0.6"},{n:["Leo","leo","lion","zodiac"],u:"264c",a:"0.6"},{n:["Virgo","virgo","zodiac"],u:"264d",a:"0.6"},{n:["Libra","libra","scales","zodiac","balance","justice"],u:"264e",a:"0.6"},{n:["zodiac","Scorpio","scorpio","scorpion","scorpius"],u:"264f",a:"0.6"},{n:["archer","zodiac","Sagittarius","sagittarius"],u:"2650",a:"0.6"},{n:["goat","zodiac","Capricorn","capricorn"],u:"2651",a:"0.6"},{n:["water","bearer","zodiac","Aquarius","aquarius"],u:"2652",a:"0.6"},{n:["fish","Pisces","pisces","zodiac"],u:"2653",a:"0.6"},{n:["snake","bearer","zodiac","serpent","Ophiuchus","ophiuchus"],u:"26ce",a:"0.6"},{n:["arrow","crossed","shuffle tracks button"],u:"1f500",a:"1"},{n:["arrow","repeat","clockwise","repeat button"],u:"1f501",a:"1"},{n:["once","arrow","clockwise","repeat single button"],u:"1f502",a:"1"},{n:["fast","arrow","double","forward","fast forward button"],u:"23e9",a:"0.6"},{n:["arrow","double","rewind","fast reverse button"],u:"23ea",a:"0.6"},{n:["arrow","button","upwards button"],u:"1f53c",a:"0.6"},{n:["arrow","double","fast up button"],u:"23eb",a:"0.6"},{n:["down","arrow","button","downwards button"],u:"1f53d",a:"0.6"},{n:["down","arrow","double","fast down button"],u:"23ec",a:"0.6"},{n:["film","movie","cinema","camera"],u:"1f3a6",a:"0.6"},{n:["dim","low","dim button","brightness"],u:"1f505",a:"1"},{n:["bright","brightness","bright button"],u:"1f506",a:"1"},{n:["bar","cell","phone","mobile","antenna","antenna bars"],u:"1f4f6",a:"0.6"},{n:["wifi","wi fi","network","wireless","computer","internet"],u:"1f6dc",a:"15"},{n:["cell","mode","phone","mobile","telephone","vibration","vibration mode"],u:"1f4f3",a:"0.6"},{n:["off","cell","phone","mobile","telephone","mobile phone off"],u:"1f4f4",a:"0.6"},{n:["+","plus","math","sign"],u:"2795",a:"0.6"},{n:[" ","","math","sign","minus"],u:"2796",a:"0.6"},{n:["","math","sign","divide","division"],u:"2797",a:"0.6"},{n:["math","equality","heavy equals sign"],u:"1f7f0",a:"14"},{n:["?","mark","question","punctuation","red question mark"],u:"2753",a:"0.6"},{n:["?","mark","outlined","question","punctuation","white question mark"],u:"2754",a:"0.6"},{n:["!","mark","outlined","exclamation","punctuation","white exclamation mark"],u:"2755",a:"0.6"},{n:["!","mark","exclamation","punctuation","red exclamation mark"],u:"2757",a:"0.6"},{n:["bank","money","currency","exchange","currency exchange"],u:"1f4b1",a:"0.6"},{n:["money","dollar","currency","heavy dollar sign"],u:"1f4b2",a:"0.6"},{n:["ship","tool","anchor","emblem","trident","trident emblem"],u:"1f531",a:"0.6"},{n:["name","badge","name badge"],u:"1f4db",a:"0.6"},{n:["leaf","chevron","beginner","japanese","Japanese symbol for beginner","japanese symbol for beginner"],u:"1f530",a:"0.6"},{n:["o","red","large","circle","hollow red circle"],u:"2b55",a:"0.6"},{n:["","mark","check","button","check mark button"],u:"2705",a:"0.6"},{n:["x","","mark","cross","cancel","multiply","cross mark","multiplication"],u:"274c",a:"0.6"},{n:["x","","mark","square","cross mark button"],u:"274e",a:"0.6"},{n:["curl","loop","curly loop"],u:"27b0",a:"0.6"},{n:["curl","loop","double","double curly loop"],u:"27bf",a:"1"},{n:["keycap","keycap: #"],u:"0023-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: *"],u:"002a-fe0f-20e3",a:"2"},{n:["keycap","keycap: 0"],u:"0030-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 1"],u:"0031-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 2"],u:"0032-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 3"],u:"0033-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 4"],u:"0034-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 5"],u:"0035-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 6"],u:"0036-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 7"],u:"0037-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 8"],u:"0038-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 9"],u:"0039-fe0f-20e3",a:"0.6"},{n:["keycap","keycap: 10"],u:"1f51f",a:"0.6"},{n:["abcd","input","latin","letters","uppercase","input latin uppercase"],u:"1f520",a:"0.6"},{n:["abcd","input","latin","letters","lowercase","input latin lowercase"],u:"1f521",a:"0.6"},{n:["1234","input","numbers","input numbers"],u:"1f522",a:"0.6"},{n:["&%","input","input symbols"],u:"1f523",a:"0.6"},{n:["abc","input","latin","letters","alphabet","input latin letters"],u:"1f524",a:"0.6"},{n:["ab","blood type","AB button (blood type)","ab button (blood type)"],u:"1f18e",a:"0.6"},{n:["cl","CL button","cl button"],u:"1f191",a:"0.6"},{n:["cool","COOL button","cool button"],u:"1f192",a:"0.6"},{n:["free","FREE button","free button"],u:"1f193",a:"0.6"},{n:["id","identity","ID button","id button"],u:"1f194",a:"0.6"},{n:["new","NEW button","new button"],u:"1f195",a:"0.6"},{n:["ng","NG button","ng button"],u:"1f196",a:"0.6"},{n:["ok","OK button","ok button"],u:"1f197",a:"0.6"},{n:["sos","help","SOS button","sos button"],u:"1f198",a:"0.6"},{n:["up","up!","mark","UP! button","up! button"],u:"1f199",a:"0.6"},{n:["vs","versus","VS button","vs button"],u:"1f19a",a:"0.6"},{n:["","here","japanese","katakana","Japanese here button","japanese here button"],u:"1f201",a:"0.6"},{n:["","japanese","ideograph","not free of charge","Japanese not free of charge button","japanese not free of charge button"],u:"1f236",a:"0.6"},{n:["","japanese","ideograph","reserved","Japanese reserved button","japanese reserved button"],u:"1f22f",a:"0.6"},{n:["","japanese","ideograph","bargain","Japanese bargain button","japanese bargain button"],u:"1f250",a:"0.6"},{n:["","japanese","ideograph","discount","Japanese discount button","japanese discount button"],u:"1f239",a:"0.6"},{n:["","japanese","ideograph","free of charge","Japanese free of charge button","japanese free of charge button"],u:"1f21a",a:"0.6"},{n:["","japanese","ideograph","prohibited","Japanese prohibited button","japanese prohibited button"],u:"1f232",a:"0.6"},{n:["","japanese","ideograph","acceptable","Japanese acceptable button","japanese acceptable button"],u:"1f251",a:"0.6"},{n:["","japanese","ideograph","application","Japanese application button","japanese application button"],u:"1f238",a:"0.6"},{n:["","japanese","ideograph","passing grade","Japanese passing grade button","japanese passing grade button"],u:"1f234",a:"0.6"},{n:["","japanese","ideograph","vacancy","Japanese vacancy button","japanese vacancy button"],u:"1f233",a:"0.6"},{n:["","japanese","ideograph","open for business","Japanese open for business button","japanese open for business button"],u:"1f23a",a:"0.6"},{n:["","japanese","ideograph","no vacancy","Japanese no vacancy button","japanese no vacancy button"],u:"1f235",a:"0.6"},{n:["red","circle","geometric","red circle"],u:"1f534",a:"0.6"},{n:["circle","orange","orange circle"],u:"1f7e0",a:"12"},{n:["circle","yellow","yellow circle"],u:"1f7e1",a:"12"},{n:["green","circle","green circle"],u:"1f7e2",a:"12"},{n:["blue","circle","geometric","blue circle"],u:"1f535",a:"0.6"},{n:["circle","purple","purple circle"],u:"1f7e3",a:"12"},{n:["brown","circle","brown circle"],u:"1f7e4",a:"12"},{n:["circle","geometric","black circle"],u:"26ab",a:"0.6"},{n:["circle","geometric","white circle"],u:"26aa",a:"0.6"},{n:["red","square","red square"],u:"1f7e5",a:"12"},{n:["orange","square","orange square"],u:"1f7e7",a:"12"},{n:["square","yellow","yellow square"],u:"1f7e8",a:"12"},{n:["green","square","green square"],u:"1f7e9",a:"12"},{n:["blue","square","blue square"],u:"1f7e6",a:"12"},{n:["purple","square","purple square"],u:"1f7ea",a:"12"},{n:["brown","square","brown square"],u:"1f7eb",a:"12"},{n:["square","geometric","black large square"],u:"2b1b",a:"0.6"},{n:["square","geometric","white large square"],u:"2b1c",a:"0.6"},{n:["square","geometric","black medium small square"],u:"25fe",a:"0.6"},{n:["square","geometric","white medium small square"],u:"25fd",a:"0.6"},{n:["orange","diamond","geometric","large orange diamond"],u:"1f536",a:"0.6"},{n:["blue","diamond","geometric","large blue diamond"],u:"1f537",a:"0.6"},{n:["orange","diamond","geometric","small orange diamond"],u:"1f538",a:"0.6"},{n:["blue","diamond","geometric","small blue diamond"],u:"1f539",a:"0.6"},{n:["red","geometric","red triangle pointed up"],u:"1f53a",a:"0.6"},{n:["red","down","geometric","red triangle pointed down"],u:"1f53b",a:"0.6"},{n:["comic","inside","diamond","geometric","diamond with a dot"],u:"1f4a0",a:"0.6"},{n:["radio","button","geometric","radio button"],u:"1f518",a:"0.6"},{n:["button","square","outlined","geometric","white square button"],u:"1f533",a:"0.6"},{n:["button","square","geometric","black square button"],u:"1f532",a:"0.6"}],flags:[{n:["racing","checkered","chequered","chequered flag"],u:"1f3c1",a:"0.6"},{n:["post","triangular flag"],u:"1f6a9",a:"0.6"},{n:["cross","crossed","japanese","celebration","crossed flags"],u:"1f38c",a:"0.6"},{n:["waving","black flag"],u:"1f3f4",a:"1"},{n:["pride","rainbow","rainbow flag"],u:"1f3f3-fe0f-200d-1f308",a:"4"},{n:["flag","pink","white","light blue","transgender","transgender flag"],u:"1f3f3-fe0f-200d-26a7-fe0f",a:"13"},{n:["pirate","plunder","treasure","pirate flag","jolly roger"],u:"1f3f4-200d-2620-fe0f",a:"11"},{n:["AC","flag","flag: Ascension Island","flag: ascension island"],u:"1f1e6-1f1e8",a:"2"},{n:["AD","flag","flag: Andorra","flag: andorra"],u:"1f1e6-1f1e9",a:"2"},{n:["AE","flag","flag: United Arab Emirates","flag: united arab emirates"],u:"1f1e6-1f1ea",a:"2"},{n:["AF","flag","flag: Afghanistan","flag: afghanistan"],u:"1f1e6-1f1eb",a:"2"},{n:["AG","flag","flag: Antigua & Barbuda","flag: antigua & barbuda"],u:"1f1e6-1f1ec",a:"2"},{n:["AI","flag","flag: Anguilla","flag: anguilla"],u:"1f1e6-1f1ee",a:"2"},{n:["AL","flag","flag: Albania","flag: albania"],u:"1f1e6-1f1f1",a:"2"},{n:["AM","flag","flag: Armenia","flag: armenia"],u:"1f1e6-1f1f2",a:"2"},{n:["AO","flag","flag: Angola","flag: angola"],u:"1f1e6-1f1f4",a:"2"},{n:["AQ","flag","flag: Antarctica","flag: antarctica"],u:"1f1e6-1f1f6",a:"2"},{n:["AR","flag","flag: Argentina","flag: argentina"],u:"1f1e6-1f1f7",a:"2"},{n:["AS","flag","flag: American Samoa","flag: american samoa"],u:"1f1e6-1f1f8",a:"2"},{n:["AT","flag","flag: Austria","flag: austria"],u:"1f1e6-1f1f9",a:"2"},{n:["AU","flag","flag: Australia","flag: australia"],u:"1f1e6-1f1fa",a:"2"},{n:["AW","flag","flag: Aruba","flag: aruba"],u:"1f1e6-1f1fc",a:"2"},{n:["AX","flag","flag: land Islands","flag: land islands"],u:"1f1e6-1f1fd",a:"2"},{n:["AZ","flag","flag: Azerbaijan","flag: azerbaijan"],u:"1f1e6-1f1ff",a:"2"},{n:["BA","flag","flag: Bosnia & Herzegovina","flag: bosnia & herzegovina"],u:"1f1e7-1f1e6",a:"2"},{n:["BB","flag","flag: Barbados","flag: barbados"],u:"1f1e7-1f1e7",a:"2"},{n:["BD","flag","flag: Bangladesh","flag: bangladesh"],u:"1f1e7-1f1e9",a:"2"},{n:["BE","flag","flag: Belgium","flag: belgium"],u:"1f1e7-1f1ea",a:"2"},{n:["BF","flag","flag: Burkina Faso","flag: burkina faso"],u:"1f1e7-1f1eb",a:"2"},{n:["BG","flag","flag: Bulgaria","flag: bulgaria"],u:"1f1e7-1f1ec",a:"2"},{n:["BH","flag","flag: Bahrain","flag: bahrain"],u:"1f1e7-1f1ed",a:"2"},{n:["BI","flag","flag: Burundi","flag: burundi"],u:"1f1e7-1f1ee",a:"2"},{n:["BJ","flag","flag: Benin","flag: benin"],u:"1f1e7-1f1ef",a:"2"},{n:["BL","flag","flag: St. Barthlemy","flag: st. barthlemy"],u:"1f1e7-1f1f1",a:"2"},{n:["BM","flag","flag: Bermuda","flag: bermuda"],u:"1f1e7-1f1f2",a:"2"},{n:["BN","flag","flag: Brunei","flag: brunei"],u:"1f1e7-1f1f3",a:"2"},{n:["BO","flag","flag: Bolivia","flag: bolivia"],u:"1f1e7-1f1f4",a:"2"},{n:["BQ","flag","flag: Caribbean Netherlands","flag: caribbean netherlands"],u:"1f1e7-1f1f6",a:"2"},{n:["BR","flag","flag: Brazil","flag: brazil"],u:"1f1e7-1f1f7",a:"2"},{n:["BS","flag","flag: Bahamas","flag: bahamas"],u:"1f1e7-1f1f8",a:"2"},{n:["BT","flag","flag: Bhutan","flag: bhutan"],u:"1f1e7-1f1f9",a:"2"},{n:["BV","flag","flag: Bouvet Island","flag: bouvet island"],u:"1f1e7-1f1fb",a:"2"},{n:["BW","flag","flag: Botswana","flag: botswana"],u:"1f1e7-1f1fc",a:"2"},{n:["BY","flag","flag: Belarus","flag: belarus"],u:"1f1e7-1f1fe",a:"2"},{n:["BZ","flag","flag: Belize","flag: belize"],u:"1f1e7-1f1ff",a:"2"},{n:["CA","flag","flag: Canada","flag: canada"],u:"1f1e8-1f1e6",a:"2"},{n:["CC","flag","flag: Cocos (Keeling) Islands","flag: cocos (keeling) islands"],u:"1f1e8-1f1e8",a:"2"},{n:["CD","flag","flag: Congo   Kinshasa","flag: congo   kinshasa"],u:"1f1e8-1f1e9",a:"2"},{n:["CF","flag","flag: Central African Republic","flag: central african republic"],u:"1f1e8-1f1eb",a:"2"},{n:["CG","flag","flag: Congo   Brazzaville","flag: congo   brazzaville"],u:"1f1e8-1f1ec",a:"2"},{n:["CH","flag","flag: Switzerland","flag: switzerland"],u:"1f1e8-1f1ed",a:"2"},{n:["CI","flag","flag: Cte dIvoire","flag: cte divoire"],u:"1f1e8-1f1ee",a:"2"},{n:["CK","flag","flag: Cook Islands","flag: cook islands"],u:"1f1e8-1f1f0",a:"2"},{n:["CL","flag","flag: Chile","flag: chile"],u:"1f1e8-1f1f1",a:"2"},{n:["CM","flag","flag: Cameroon","flag: cameroon"],u:"1f1e8-1f1f2",a:"2"},{n:["CN","flag","flag: China","flag: china"],u:"1f1e8-1f1f3",a:"0.6"},{n:["CO","flag","flag: Colombia","flag: colombia"],u:"1f1e8-1f1f4",a:"2"},{n:["CP","flag","flag: Clipperton Island","flag: clipperton island"],u:"1f1e8-1f1f5",a:"2"},{n:["CR","flag","flag: Costa Rica","flag: costa rica"],u:"1f1e8-1f1f7",a:"2"},{n:["CU","flag","flag: Cuba","flag: cuba"],u:"1f1e8-1f1fa",a:"2"},{n:["CV","flag","flag: Cape Verde","flag: cape verde"],u:"1f1e8-1f1fb",a:"2"},{n:["CW","flag","flag: Curaao","flag: curaao"],u:"1f1e8-1f1fc",a:"2"},{n:["CX","flag","flag: Christmas Island","flag: christmas island"],u:"1f1e8-1f1fd",a:"2"},{n:["CY","flag","flag: Cyprus","flag: cyprus"],u:"1f1e8-1f1fe",a:"2"},{n:["CZ","flag","flag: Czechia","flag: czechia"],u:"1f1e8-1f1ff",a:"2"},{n:["DE","flag","flag: Germany","flag: germany"],u:"1f1e9-1f1ea",a:"0.6"},{n:["DG","flag","flag: Diego Garcia","flag: diego garcia"],u:"1f1e9-1f1ec",a:"2"},{n:["DJ","flag","flag: Djibouti","flag: djibouti"],u:"1f1e9-1f1ef",a:"2"},{n:["DK","flag","flag: Denmark","flag: denmark"],u:"1f1e9-1f1f0",a:"2"},{n:["DM","flag","flag: Dominica","flag: dominica"],u:"1f1e9-1f1f2",a:"2"},{n:["DO","flag","flag: Dominican Republic","flag: dominican republic"],u:"1f1e9-1f1f4",a:"2"},{n:["DZ","flag","flag: Algeria","flag: algeria"],u:"1f1e9-1f1ff",a:"2"},{n:["EA","flag","flag: Ceuta & Melilla","flag: ceuta & melilla"],u:"1f1ea-1f1e6",a:"2"},{n:["EC","flag","flag: Ecuador","flag: ecuador"],u:"1f1ea-1f1e8",a:"2"},{n:["EE","flag","flag: Estonia","flag: estonia"],u:"1f1ea-1f1ea",a:"2"},{n:["EG","flag","flag: Egypt","flag: egypt"],u:"1f1ea-1f1ec",a:"2"},{n:["EH","flag","flag: Western Sahara","flag: western sahara"],u:"1f1ea-1f1ed",a:"2"},{n:["ER","flag","flag: Eritrea","flag: eritrea"],u:"1f1ea-1f1f7",a:"2"},{n:["ES","flag","flag: Spain","flag: spain"],u:"1f1ea-1f1f8",a:"0.6"},{n:["ET","flag","flag: Ethiopia","flag: ethiopia"],u:"1f1ea-1f1f9",a:"2"},{n:["EU","flag","flag: European Union","flag: european union"],u:"1f1ea-1f1fa",a:"2"},{n:["FI","flag","flag: Finland","flag: finland"],u:"1f1eb-1f1ee",a:"2"},{n:["FJ","flag","flag: Fiji","flag: fiji"],u:"1f1eb-1f1ef",a:"2"},{n:["FK","flag","flag: Falkland Islands","flag: falkland islands"],u:"1f1eb-1f1f0",a:"2"},{n:["FM","flag","flag: Micronesia","flag: micronesia"],u:"1f1eb-1f1f2",a:"2"},{n:["FO","flag","flag: Faroe Islands","flag: faroe islands"],u:"1f1eb-1f1f4",a:"2"},{n:["FR","flag","flag: France","flag: france"],u:"1f1eb-1f1f7",a:"0.6"},{n:["GA","flag","flag: Gabon","flag: gabon"],u:"1f1ec-1f1e6",a:"2"},{n:["GB","flag","flag: United Kingdom","flag: united kingdom"],u:"1f1ec-1f1e7",a:"0.6"},{n:["GD","flag","flag: Grenada","flag: grenada"],u:"1f1ec-1f1e9",a:"2"},{n:["GE","flag","flag: Georgia","flag: georgia"],u:"1f1ec-1f1ea",a:"2"},{n:["GF","flag","flag: French Guiana","flag: french guiana"],u:"1f1ec-1f1eb",a:"2"},{n:["GG","flag","flag: Guernsey","flag: guernsey"],u:"1f1ec-1f1ec",a:"2"},{n:["GH","flag","flag: Ghana","flag: ghana"],u:"1f1ec-1f1ed",a:"2"},{n:["GI","flag","flag: Gibraltar","flag: gibraltar"],u:"1f1ec-1f1ee",a:"2"},{n:["GL","flag","flag: Greenland","flag: greenland"],u:"1f1ec-1f1f1",a:"2"},{n:["GM","flag","flag: Gambia","flag: gambia"],u:"1f1ec-1f1f2",a:"2"},{n:["GN","flag","flag: Guinea","flag: guinea"],u:"1f1ec-1f1f3",a:"2"},{n:["GP","flag","flag: Guadeloupe","flag: guadeloupe"],u:"1f1ec-1f1f5",a:"2"},{n:["GQ","flag","flag: Equatorial Guinea","flag: equatorial guinea"],u:"1f1ec-1f1f6",a:"2"},{n:["GR","flag","flag: Greece","flag: greece"],u:"1f1ec-1f1f7",a:"2"},{n:["GS","flag","flag: South Georgia & South Sandwich Islands","flag: south georgia & south sandwich islands"],u:"1f1ec-1f1f8",a:"2"},{n:["GT","flag","flag: Guatemala","flag: guatemala"],u:"1f1ec-1f1f9",a:"2"},{n:["GU","flag","flag: Guam","flag: guam"],u:"1f1ec-1f1fa",a:"2"},{n:["GW","flag","flag: Guinea Bissau","flag: guinea bissau"],u:"1f1ec-1f1fc",a:"2"},{n:["GY","flag","flag: Guyana","flag: guyana"],u:"1f1ec-1f1fe",a:"2"},{n:["HK","flag","flag: Hong Kong SAR China","flag: hong kong sar china"],u:"1f1ed-1f1f0",a:"2"},{n:["HM","flag","flag: Heard & McDonald Islands","flag: heard & mcdonald islands"],u:"1f1ed-1f1f2",a:"2"},{n:["HN","flag","flag: Honduras","flag: honduras"],u:"1f1ed-1f1f3",a:"2"},{n:["HR","flag","flag: Croatia","flag: croatia"],u:"1f1ed-1f1f7",a:"2"},{n:["HT","flag","flag: Haiti","flag: haiti"],u:"1f1ed-1f1f9",a:"2"},{n:["HU","flag","flag: Hungary","flag: hungary"],u:"1f1ed-1f1fa",a:"2"},{n:["IC","flag","flag: Canary Islands","flag: canary islands"],u:"1f1ee-1f1e8",a:"2"},{n:["ID","flag","flag: Indonesia","flag: indonesia"],u:"1f1ee-1f1e9",a:"2"},{n:["IE","flag","flag: Ireland","flag: ireland"],u:"1f1ee-1f1ea",a:"2"},{n:["IL","flag","flag: Israel","flag: israel"],u:"1f1ee-1f1f1",a:"2"},{n:["IM","flag","flag: Isle of Man","flag: isle of man"],u:"1f1ee-1f1f2",a:"2"},{n:["IN","flag","flag: India","flag: india"],u:"1f1ee-1f1f3",a:"2"},{n:["IO","flag","flag: British Indian Ocean Territory","flag: british indian ocean territory"],u:"1f1ee-1f1f4",a:"2"},{n:["IQ","flag","flag: Iraq","flag: iraq"],u:"1f1ee-1f1f6",a:"2"},{n:["IR","flag","flag: Iran","flag: iran"],u:"1f1ee-1f1f7",a:"2"},{n:["IS","flag","flag: Iceland","flag: iceland"],u:"1f1ee-1f1f8",a:"2"},{n:["IT","flag","flag: Italy","flag: italy"],u:"1f1ee-1f1f9",a:"0.6"},{n:["JE","flag","flag: Jersey","flag: jersey"],u:"1f1ef-1f1ea",a:"2"},{n:["JM","flag","flag: Jamaica","flag: jamaica"],u:"1f1ef-1f1f2",a:"2"},{n:["JO","flag","flag: Jordan","flag: jordan"],u:"1f1ef-1f1f4",a:"2"},{n:["JP","flag","flag: Japan","flag: japan"],u:"1f1ef-1f1f5",a:"0.6"},{n:["KE","flag","flag: Kenya","flag: kenya"],u:"1f1f0-1f1ea",a:"2"},{n:["KG","flag","flag: Kyrgyzstan","flag: kyrgyzstan"],u:"1f1f0-1f1ec",a:"2"},{n:["KH","flag","flag: Cambodia","flag: cambodia"],u:"1f1f0-1f1ed",a:"2"},{n:["KI","flag","flag: Kiribati","flag: kiribati"],u:"1f1f0-1f1ee",a:"2"},{n:["KM","flag","flag: Comoros","flag: comoros"],u:"1f1f0-1f1f2",a:"2"},{n:["KN","flag","flag: St. Kitts & Nevis","flag: st. kitts & nevis"],u:"1f1f0-1f1f3",a:"2"},{n:["KP","flag","flag: North Korea","flag: north korea"],u:"1f1f0-1f1f5",a:"2"},{n:["KR","flag","flag: South Korea","flag: south korea"],u:"1f1f0-1f1f7",a:"0.6"},{n:["KW","flag","flag: Kuwait","flag: kuwait"],u:"1f1f0-1f1fc",a:"2"},{n:["KY","flag","flag: Cayman Islands","flag: cayman islands"],u:"1f1f0-1f1fe",a:"2"},{n:["KZ","flag","flag: Kazakhstan","flag: kazakhstan"],u:"1f1f0-1f1ff",a:"2"},{n:["LA","flag","flag: Laos","flag: laos"],u:"1f1f1-1f1e6",a:"2"},{n:["LB","flag","flag: Lebanon","flag: lebanon"],u:"1f1f1-1f1e7",a:"2"},{n:["LC","flag","flag: St. Lucia","flag: st. lucia"],u:"1f1f1-1f1e8",a:"2"},{n:["LI","flag","flag: Liechtenstein","flag: liechtenstein"],u:"1f1f1-1f1ee",a:"2"},{n:["LK","flag","flag: Sri Lanka","flag: sri lanka"],u:"1f1f1-1f1f0",a:"2"},{n:["LR","flag","flag: Liberia","flag: liberia"],u:"1f1f1-1f1f7",a:"2"},{n:["LS","flag","flag: Lesotho","flag: lesotho"],u:"1f1f1-1f1f8",a:"2"},{n:["LT","flag","flag: Lithuania","flag: lithuania"],u:"1f1f1-1f1f9",a:"2"},{n:["LU","flag","flag: Luxembourg","flag: luxembourg"],u:"1f1f1-1f1fa",a:"2"},{n:["LV","flag","flag: Latvia","flag: latvia"],u:"1f1f1-1f1fb",a:"2"},{n:["LY","flag","flag: Libya","flag: libya"],u:"1f1f1-1f1fe",a:"2"},{n:["MA","flag","flag: Morocco","flag: morocco"],u:"1f1f2-1f1e6",a:"2"},{n:["MC","flag","flag: Monaco","flag: monaco"],u:"1f1f2-1f1e8",a:"2"},{n:["MD","flag","flag: Moldova","flag: moldova"],u:"1f1f2-1f1e9",a:"2"},{n:["ME","flag","flag: Montenegro","flag: montenegro"],u:"1f1f2-1f1ea",a:"2"},{n:["MF","flag","flag: St. Martin","flag: st. martin"],u:"1f1f2-1f1eb",a:"2"},{n:["MG","flag","flag: Madagascar","flag: madagascar"],u:"1f1f2-1f1ec",a:"2"},{n:["MH","flag","flag: Marshall Islands","flag: marshall islands"],u:"1f1f2-1f1ed",a:"2"},{n:["MK","flag","flag: North Macedonia","flag: north macedonia"],u:"1f1f2-1f1f0",a:"2"},{n:["ML","flag","flag: Mali","flag: mali"],u:"1f1f2-1f1f1",a:"2"},{n:["MM","flag","flag: Myanmar (Burma)","flag: myanmar (burma)"],u:"1f1f2-1f1f2",a:"2"},{n:["MN","flag","flag: Mongolia","flag: mongolia"],u:"1f1f2-1f1f3",a:"2"},{n:["MO","flag","flag: Macao SAR China","flag: macao sar china"],u:"1f1f2-1f1f4",a:"2"},{n:["MP","flag","flag: Northern Mariana Islands","flag: northern mariana islands"],u:"1f1f2-1f1f5",a:"2"},{n:["MQ","flag","flag: Martinique","flag: martinique"],u:"1f1f2-1f1f6",a:"2"},{n:["MR","flag","flag: Mauritania","flag: mauritania"],u:"1f1f2-1f1f7",a:"2"},{n:["MS","flag","flag: Montserrat","flag: montserrat"],u:"1f1f2-1f1f8",a:"2"},{n:["MT","flag","flag: Malta","flag: malta"],u:"1f1f2-1f1f9",a:"2"},{n:["MU","flag","flag: Mauritius","flag: mauritius"],u:"1f1f2-1f1fa",a:"2"},{n:["MV","flag","flag: Maldives","flag: maldives"],u:"1f1f2-1f1fb",a:"2"},{n:["MW","flag","flag: Malawi","flag: malawi"],u:"1f1f2-1f1fc",a:"2"},{n:["MX","flag","flag: Mexico","flag: mexico"],u:"1f1f2-1f1fd",a:"2"},{n:["MY","flag","flag: Malaysia","flag: malaysia"],u:"1f1f2-1f1fe",a:"2"},{n:["MZ","flag","flag: Mozambique","flag: mozambique"],u:"1f1f2-1f1ff",a:"2"},{n:["NA","flag","flag: Namibia","flag: namibia"],u:"1f1f3-1f1e6",a:"2"},{n:["NC","flag","flag: New Caledonia","flag: new caledonia"],u:"1f1f3-1f1e8",a:"2"},{n:["NE","flag","flag: Niger","flag: niger"],u:"1f1f3-1f1ea",a:"2"},{n:["NF","flag","flag: Norfolk Island","flag: norfolk island"],u:"1f1f3-1f1eb",a:"2"},{n:["NG","flag","flag: Nigeria","flag: nigeria"],u:"1f1f3-1f1ec",a:"2"},{n:["NI","flag","flag: Nicaragua","flag: nicaragua"],u:"1f1f3-1f1ee",a:"2"},{n:["NL","flag","flag: Netherlands","flag: netherlands"],u:"1f1f3-1f1f1",a:"2"},{n:["NO","flag","flag: Norway","flag: norway"],u:"1f1f3-1f1f4",a:"2"},{n:["NP","flag","flag: Nepal","flag: nepal"],u:"1f1f3-1f1f5",a:"2"},{n:["NR","flag","flag: Nauru","flag: nauru"],u:"1f1f3-1f1f7",a:"2"},{n:["NU","flag","flag: Niue","flag: niue"],u:"1f1f3-1f1fa",a:"2"},{n:["NZ","flag","flag: New Zealand","flag: new zealand"],u:"1f1f3-1f1ff",a:"2"},{n:["OM","flag","flag: Oman","flag: oman"],u:"1f1f4-1f1f2",a:"2"},{n:["PA","flag","flag: Panama","flag: panama"],u:"1f1f5-1f1e6",a:"2"},{n:["PE","flag","flag: Peru","flag: peru"],u:"1f1f5-1f1ea",a:"2"},{n:["PF","flag","flag: French Polynesia","flag: french polynesia"],u:"1f1f5-1f1eb",a:"2"},{n:["PG","flag","flag: Papua New Guinea","flag: papua new guinea"],u:"1f1f5-1f1ec",a:"2"},{n:["PH","flag","flag: Philippines","flag: philippines"],u:"1f1f5-1f1ed",a:"2"},{n:["PK","flag","flag: Pakistan","flag: pakistan"],u:"1f1f5-1f1f0",a:"2"},{n:["PL","flag","flag: Poland","flag: poland"],u:"1f1f5-1f1f1",a:"2"},{n:["PM","flag","flag: St. Pierre & Miquelon","flag: st. pierre & miquelon"],u:"1f1f5-1f1f2",a:"2"},{n:["PN","flag","flag: Pitcairn Islands","flag: pitcairn islands"],u:"1f1f5-1f1f3",a:"2"},{n:["PR","flag","flag: Puerto Rico","flag: puerto rico"],u:"1f1f5-1f1f7",a:"2"},{n:["PS","flag","flag: Palestinian Territories","flag: palestinian territories"],u:"1f1f5-1f1f8",a:"2"},{n:["PT","flag","flag: Portugal","flag: portugal"],u:"1f1f5-1f1f9",a:"2"},{n:["PW","flag","flag: Palau","flag: palau"],u:"1f1f5-1f1fc",a:"2"},{n:["PY","flag","flag: Paraguay","flag: paraguay"],u:"1f1f5-1f1fe",a:"2"},{n:["QA","flag","flag: Qatar","flag: qatar"],u:"1f1f6-1f1e6",a:"2"},{n:["RE","flag","flag: Runion","flag: runion"],u:"1f1f7-1f1ea",a:"2"},{n:["RO","flag","flag: Romania","flag: romania"],u:"1f1f7-1f1f4",a:"2"},{n:["RS","flag","flag: Serbia","flag: serbia"],u:"1f1f7-1f1f8",a:"2"},{n:["RU","flag","flag: Russia","flag: russia"],u:"1f1f7-1f1fa",a:"0.6"},{n:["RW","flag","flag: Rwanda","flag: rwanda"],u:"1f1f7-1f1fc",a:"2"},{n:["SA","flag","flag: Saudi Arabia","flag: saudi arabia"],u:"1f1f8-1f1e6",a:"2"},{n:["SB","flag","flag: Solomon Islands","flag: solomon islands"],u:"1f1f8-1f1e7",a:"2"},{n:["SC","flag","flag: Seychelles","flag: seychelles"],u:"1f1f8-1f1e8",a:"2"},{n:["SD","flag","flag: Sudan","flag: sudan"],u:"1f1f8-1f1e9",a:"2"},{n:["SE","flag","flag: Sweden","flag: sweden"],u:"1f1f8-1f1ea",a:"2"},{n:["SG","flag","flag: Singapore","flag: singapore"],u:"1f1f8-1f1ec",a:"2"},{n:["SH","flag","flag: St. Helena","flag: st. helena"],u:"1f1f8-1f1ed",a:"2"},{n:["SI","flag","flag: Slovenia","flag: slovenia"],u:"1f1f8-1f1ee",a:"2"},{n:["SJ","flag","flag: Svalbard & Jan Mayen","flag: svalbard & jan mayen"],u:"1f1f8-1f1ef",a:"2"},{n:["SK","flag","flag: Slovakia","flag: slovakia"],u:"1f1f8-1f1f0",a:"2"},{n:["SL","flag","flag: Sierra Leone","flag: sierra leone"],u:"1f1f8-1f1f1",a:"2"},{n:["SM","flag","flag: San Marino","flag: san marino"],u:"1f1f8-1f1f2",a:"2"},{n:["SN","flag","flag: Senegal","flag: senegal"],u:"1f1f8-1f1f3",a:"2"},{n:["SO","flag","flag: Somalia","flag: somalia"],u:"1f1f8-1f1f4",a:"2"},{n:["SR","flag","flag: Suriname","flag: suriname"],u:"1f1f8-1f1f7",a:"2"},{n:["SS","flag","flag: South Sudan","flag: south sudan"],u:"1f1f8-1f1f8",a:"2"},{n:["ST","flag","flag: So Tom & Prncipe","flag: so tom & prncipe"],u:"1f1f8-1f1f9",a:"2"},{n:["SV","flag","flag: El Salvador","flag: el salvador"],u:"1f1f8-1f1fb",a:"2"},{n:["SX","flag","flag: Sint Maarten","flag: sint maarten"],u:"1f1f8-1f1fd",a:"2"},{n:["SY","flag","flag: Syria","flag: syria"],u:"1f1f8-1f1fe",a:"2"},{n:["SZ","flag","flag: Eswatini","flag: eswatini"],u:"1f1f8-1f1ff",a:"2"},{n:["TA","flag","flag: Tristan da Cunha","flag: tristan da cunha"],u:"1f1f9-1f1e6",a:"2"},{n:["TC","flag","flag: Turks & Caicos Islands","flag: turks & caicos islands"],u:"1f1f9-1f1e8",a:"2"},{n:["TD","flag","flag: Chad","flag: chad"],u:"1f1f9-1f1e9",a:"2"},{n:["TF","flag","flag: French Southern Territories","flag: french southern territories"],u:"1f1f9-1f1eb",a:"2"},{n:["TG","flag","flag: Togo","flag: togo"],u:"1f1f9-1f1ec",a:"2"},{n:["TH","flag","flag: Thailand","flag: thailand"],u:"1f1f9-1f1ed",a:"2"},{n:["TJ","flag","flag: Tajikistan","flag: tajikistan"],u:"1f1f9-1f1ef",a:"2"},{n:["TK","flag","flag: Tokelau","flag: tokelau"],u:"1f1f9-1f1f0",a:"2"},{n:["TL","flag","flag: Timor Leste","flag: timor leste"],u:"1f1f9-1f1f1",a:"2"},{n:["TM","flag","flag: Turkmenistan","flag: turkmenistan"],u:"1f1f9-1f1f2",a:"2"},{n:["TN","flag","flag: Tunisia","flag: tunisia"],u:"1f1f9-1f1f3",a:"2"},{n:["TO","flag","flag: Tonga","flag: tonga"],u:"1f1f9-1f1f4",a:"2"},{n:["TR","flag","flag: Trkiye","flag: trkiye"],u:"1f1f9-1f1f7",a:"2"},{n:["TT","flag","flag: Trinidad & Tobago","flag: trinidad & tobago"],u:"1f1f9-1f1f9",a:"2"},{n:["TV","flag","flag: Tuvalu","flag: tuvalu"],u:"1f1f9-1f1fb",a:"2"},{n:["TW","flag","flag: Taiwan","flag: taiwan"],u:"1f1f9-1f1fc",a:"2"},{n:["TZ","flag","flag: Tanzania","flag: tanzania"],u:"1f1f9-1f1ff",a:"2"},{n:["UA","flag","flag: Ukraine","flag: ukraine"],u:"1f1fa-1f1e6",a:"2"},{n:["UG","flag","flag: Uganda","flag: uganda"],u:"1f1fa-1f1ec",a:"2"},{n:["UM","flag","flag: U.S. Outlying Islands","flag: u.s. outlying islands"],u:"1f1fa-1f1f2",a:"2"},{n:["UN","flag","flag: United Nations","flag: united nations"],u:"1f1fa-1f1f3",a:"4"},{n:["US","flag","flag: United States","flag: united states"],u:"1f1fa-1f1f8",a:"0.6"},{n:["UY","flag","flag: Uruguay","flag: uruguay"],u:"1f1fa-1f1fe",a:"2"},{n:["UZ","flag","flag: Uzbekistan","flag: uzbekistan"],u:"1f1fa-1f1ff",a:"2"},{n:["VA","flag","flag: Vatican City","flag: vatican city"],u:"1f1fb-1f1e6",a:"2"},{n:["VC","flag","flag: St. Vincent & Grenadines","flag: st. vincent & grenadines"],u:"1f1fb-1f1e8",a:"2"},{n:["VE","flag","flag: Venezuela","flag: venezuela"],u:"1f1fb-1f1ea",a:"2"},{n:["VG","flag","flag: British Virgin Islands","flag: british virgin islands"],u:"1f1fb-1f1ec",a:"2"},{n:["VI","flag","flag: U.S. Virgin Islands","flag: u.s. virgin islands"],u:"1f1fb-1f1ee",a:"2"},{n:["VN","flag","flag: Vietnam","flag: vietnam"],u:"1f1fb-1f1f3",a:"2"},{n:["VU","flag","flag: Vanuatu","flag: vanuatu"],u:"1f1fb-1f1fa",a:"2"},{n:["WF","flag","flag: Wallis & Futuna","flag: wallis & futuna"],u:"1f1fc-1f1eb",a:"2"},{n:["WS","flag","flag: Samoa","flag: samoa"],u:"1f1fc-1f1f8",a:"2"},{n:["XK","flag","flag: Kosovo","flag: kosovo"],u:"1f1fd-1f1f0",a:"2"},{n:["YE","flag","flag: Yemen","flag: yemen"],u:"1f1fe-1f1ea",a:"2"},{n:["YT","flag","flag: Mayotte","flag: mayotte"],u:"1f1fe-1f1f9",a:"2"},{n:["ZA","flag","flag: South Africa","flag: south africa"],u:"1f1ff-1f1e6",a:"2"},{n:["ZM","flag","flag: Zambia","flag: zambia"],u:"1f1ff-1f1f2",a:"2"},{n:["ZW","flag","flag: Zimbabwe","flag: zimbabwe"],u:"1f1ff-1f1fc",a:"2"},{n:["flag","gbeng","flag: England","flag: england"],u:"1f3f4-e0067-e0062-e0065-e006e-e0067-e007f",a:"5"},{n:["flag","gbsct","flag: Scotland","flag: scotland"],u:"1f3f4-e0067-e0062-e0073-e0063-e0074-e007f",a:"5"},{n:["flag","gbwls","flag: Wales","flag: wales"],u:"1f3f4-e0067-e0062-e0077-e006c-e0073-e007f",a:"5"}]},x$={categories:Pht,emojis:zht};function w$(e){var t;return(t=e[cs.name])!=null?t:[]}function Gte(e){if(!e)return"";var t=w$(e);return t[t.length-1]}function Dve(e){var t=e.split("-"),r=t.splice(1,1),n=r[0];return b$[n]?t.join("-"):e}function El(e,t){var r,n=e[cs.unified];return!t||!S0(e)?n:(r=$ht(e,t))!=null?r:n}function Bht(){var e=Hve(),t=j$(),r=t[0],n=ce.useMemo(function(){var a,s=(a=k$(e))!=null?a:[];return s.map(function(i){return S$(i.unified)}).filter(Boolean)},[r,e]);return function(s){var i;return s===Qt.SUGGESTED?n:(i=x$.emojis[s])!=null?i:[]}}function X2(e){var t;return(t=e[cs.variations])!=null?t:[]}function S0(e){return X2(e).length>0}function $ht(e,t){return t?X2(e).find(function(r){return r.includes(t)}):El(e)}function S$(e){if(e){if(Wk[e])return Wk[e];var t=Dve(e);return Wk[t]}}var Fht=Object.values(x$.emojis).flat(),Wk={};Fht.reduce(function(e,t){return e[El(t)]=t,S0(t)&&X2(t).forEach(function(r){e[r]=t}),e},Wk);function Uht(e){var t=e.split("-"),r=t[1];return MC.includes(r)?r:null}var Lve="epr_suggested";function k$(e){try{var t,r,n;if(!((t=window)!=null&&t.localStorage))return[];var a=JSON.parse((r=(n=window)==null?void 0:n.localStorage.getItem(Lve))!=null?r:"[]");return e===qg.FREQUENT?a.sort(function(s,i){return i.count-s.count}):a}catch{return[]}}function Hht(e,t){var r=k$(),n=El(e,t),a=El(e),s=r.find(function(c){var u=c.unified;return u===n}),i;s?i=[s].concat(r.filter(function(c){return c!==s})):(s={unified:n,original:a,count:0},i=[s].concat(r)),s.count++,i.length=Math.min(i.length,14);try{var l;(l=window)==null||l.localStorage.setItem(Lve,JSON.stringify(i))}catch{}}var Ove=ce.createContext({emojiData:{},allEmojis:[],allEmojisByUnified:{},searchIndex:{},emojiByUnified:function(){},activeVariationFromUnified:function(){return null}});function qht(e){var t=e.children,r=Ln(),n=r.customEmojis,a=r.emojiData,s=ce.useMemo(function(){var l=a||x$,c=JSON.parse(JSON.stringify(l));n&&n.length>0&&(c.emojis[Qt.CUSTOM]=n.map(Kht));var u=c.emojis||{},d=Object.values(u).flat(),f={},m={};return d.forEach(function(p){var v=p[cs.unified];if(f[v]=p,p[cs.variations]){var b;(b=p[cs.variations])==null||b.forEach(function(S){f[S]=p})}var y=(p[cs.name]||[]).join("").toLowerCase().split("");y.forEach(function(S){var _;m[S]=(_=m[S])!=null?_:{},m[S][v]=p})}),{emojiData:c,allEmojis:d,allEmojisByUnified:f,searchIndex:m}},[a,n]),i=ce.useCallback(function(l){var c;if(l){var u=(c=s.allEmojisByUnified[l])!=null?c:s.allEmojisByUnified[kve(l)];return u}},[s.allEmojisByUnified]);return ce.createElement(Ove.Provider,{value:pn({},s,{emojiByUnified:i,activeVariationFromUnified:Nht})},t)}function A1(){return ce.useContext(Ove)}function Wht(){var e=A1(),t=e.emojiData,r=e.emojiByUnified,n=Hve(),a=j$(),s=a[0],i=ce.useMemo(function(){var l,c=(l=k$(n))!=null?l:[];return c.map(function(u){return r(u.unified)}).filter(Boolean)},[s,n,r]);return function(c){var u,d;return c===Qt.SUGGESTED?i:(u=(d=t.emojis)==null?void 0:d[c])!=null?u:[]}}function Kht(e){var t;return t={},t[cs.name]=e.names.map(function(r){return r.toLowerCase()}),t[cs.unified]=e.id.toLowerCase(),t[cs.added_in]="0",t[cs.imgUrl]=e.imgUrl,t}function Ght(){var e=hmt();return function(t){return e.has(t)}}function Ive(){var e=w.useRef({}),t=fmt(),r=A1(),n=r.allEmojis;return w.useMemo(function(){var a=parseFloat(""+t);return!t||Number.isNaN(a)?e.current:n.reduce(function(s,i){return Yht(i,a)&&(s[om(i)]=!0),s},e.current)},[t,n])}function Vht(){var e=Ive(),t=Ght();return function(n){var a=kve(om(n));return!!(e[a]||t(a))}}function Yht(e,t){return wht(e)>t}function Qht(e){w.useEffect(function(){e(!0)},[e])}function Jht(e){var t=e.children,r=Ive(),n=rmt(),a=dmt(),s=A1(),i=s.searchIndex,l=w.useRef(i);w.useEffect(function(){l.current=i},[i]);var c=w.useRef(!1),u=w.useRef(!1),d=w.useRef(r),f=Kte(Date.now(),200),m=Kte("",100),p=w.useState(!1),v=w.useState(n),b=w.useState(null),y=w.useState(new Set),S=w.useState(null),_=w.useState(a),N=w.useState(!1),k=N[0],j=N[1],E=w.useState([]),T=w.useState(null);return Qht(j),w.createElement($i.Provider,{value:{activeCategoryState:b,activeSkinTone:v,disallowClickRef:c,disallowMouseRef:u,disallowedEmojisRef:d,emojiVariationPickerState:S,emojisThatFailedToLoadState:y,filterRef:l,isPastInitialLoad:k,searchTerm:m,skinToneFanOpenState:p,suggestedUpdateState:f,reactionsModeState:_,visibleCategoriesState:E,emojiSizeState:T}},t)}var $i=w.createContext({activeCategoryState:[null,function(){}],activeSkinTone:[Uo.NEUTRAL,function(){}],disallowClickRef:{current:!1},disallowMouseRef:{current:!1},disallowedEmojisRef:{current:{}},emojiVariationPickerState:[null,function(){}],emojisThatFailedToLoadState:[new Set,function(){}],filterRef:{current:{}},isPastInitialLoad:!0,searchTerm:["",function(){return new Promise(function(){})}],skinToneFanOpenState:[!1,function(){}],suggestedUpdateState:[Date.now(),function(){}],reactionsModeState:[!1,function(){}],visibleCategoriesState:[[],function(){return[]}],emojiSizeState:[null,function(){}]});function _$(){var e=w.useContext($i),t=e.filterRef;return t}function Zht(){var e=w.useContext($i),t=e.disallowClickRef;return t}function N$(){var e=w.useContext($i),t=e.disallowMouseRef;return t}function lm(){var e=w.useContext($i),t=e.reactionsModeState;return t}function eE(){var e=w.useContext($i),t=e.searchTerm;return t}function tE(){var e=w.useContext($i),t=e.activeSkinTone;return t}function Rve(){var e=w.useContext($i),t=e.emojisThatFailedToLoadState;return t}function k0(){var e=w.useContext($i),t=e.emojiVariationPickerState;return t}function D1(){var e=w.useContext($i),t=e.skinToneFanOpenState;return t}function C$(){var e=w.useContext($i),t=e.visibleCategoriesState;return t}function Pve(){var e=w.useContext($i),t=e.emojiSizeState;return t}function j$(){var e=w.useContext($i),t=e.suggestedUpdateState,r=t[0],n=t[1];return[r,function(){n(Date.now())}]}var zve=ce.createContext({});function Bve(){var e=ce.useContext(zve);return e}function Xht(e){var t=ce.useRef({onEmojiClick:e.onEmojiClick||XS,onReactionClick:e.onReactionClick||e.onEmojiClick,onSkinToneChange:e.onSkinToneChange||XS});return ce.useEffect(function(){t.current.onEmojiClick=e.onEmojiClick||XS,t.current.onReactionClick=e.onReactionClick||e.onEmojiClick},[e.onEmojiClick,e.onReactionClick]),ce.useEffect(function(){t.current.onSkinToneChange=e.onSkinToneChange||XS},[e.onSkinToneChange]),t}function XS(){}var Sx;(function(e){e.REACTIONS="reactions",e.PICKER="picker"})(Sx||(Sx={}));function emt(){var e,t=Ln(),r=t.searchPlaceHolder,n=t.searchPlaceholder;return(e=[r,n].find(function(a){return a!==TC}))!=null?e:TC}function tmt(){var e=Ln(),t=e.searchClearButtonLabel;return t??Eve}function rmt(){var e=Ln(),t=e.defaultSkinTone;return t}function $ve(){var e=Ln(),t=e.allowExpandReactions;return t}function Fve(){var e=Ln(),t=e.skinTonesDisabled;return t}function cm(){var e=Ln(),t=e.emojiStyle;return t}function nmt(){var e=Ln(),t=e.autoFocusSearch;return t}function E$(){var e=Ln(),t=e.categories;return t}function amt(){var e=Ln(),t=e.customEmojis;return t}function smt(){var e=Ln(),t=e.open;return t}function imt(e){var t=Bve(),r=t.current,n=lm(),a=n[1],s=r.onEmojiClick||function(){},i=r.onReactionClick;return e===Sx.REACTIONS&&i?function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return i.apply(void 0,c.concat([{collapseToReactions:function(){a(function(f){return f})}}]))}:function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];s.apply(void 0,c.concat([{collapseToReactions:function(){a(!0)}}]))}}function omt(){var e=Bve(),t=e.current;return t.onSkinToneChange||function(){}}function Uve(){var e=Ln(),t=e.previewConfig;return t}function lmt(){var e=Ln(),t=e.theme;return t}function Hve(){var e=Ln(),t=e.suggestedEmojisMode;return t}function qve(){var e=Ln(),t=e.lazyLoadEmojis;return t}function cmt(){var e=Ln(),t=e.className;return t}function umt(){var e=Ln(),t=e.height,r=e.width,n=e.style;return pn({height:Vte(t),width:Vte(r)},n)}function dmt(){var e=Ln(),t=e.reactionsDefaultOpen;return t}function fmt(){var e=Ln(),t=e.emojiVersion;return t}function Wve(){var e=Ln(),t=e.searchDisabled;return t}function Kve(){var e=Ln(),t=e.skinTonePickerLocation;return t}function hmt(){var e=Ln(),t=e.unicodeToHide;return t}function mmt(){var e=Ln(),t=e.reactions;return t}function um(){var e=Ln(),t=e.getEmojiUrl;return t}function Vte(e){return typeof e=="number"?e+"px":e}function pmt(e){var t=e>0,r=e>1;return t?r?Dht.replace("%n",e.toString()):Aht:Tht}function rE(){var e=eE(),t=e[0];return!!t}function Fi(e){e&&requestAnimationFrame(function(){e.focus()})}function Gve(e){if(e){var t=e.previousElementSibling;Fi(t)}}function Vve(e){if(e){var t=e.nextElementSibling;Fi(t)}}function Yve(e){if(e){var t=e.firstElementChild;Fi(t)}}function kx(){return document.activeElement}function gmt(e){var t=e.children,r=w.useRef(null),n=w.useRef(null),a=w.useRef(null),s=w.useRef(null),i=w.useRef(null),l=w.useRef(null),c=w.useRef(null),u=w.useRef(null),d=w.useRef(null);return w.createElement(Qve.Provider,{value:{AnchoredEmojiRef:n,BodyRef:a,EmojiListRef:s,CategoryNavigationRef:c,PickerMainRef:r,SearchInputRef:i,SkinTonePickerRef:l,VariationPickerRef:u,ReactionsRef:d}},t)}var Qve=w.createContext({AnchoredEmojiRef:w.createRef(),BodyRef:w.createRef(),CategoryNavigationRef:w.createRef(),EmojiListRef:w.createRef(),PickerMainRef:w.createRef(),SearchInputRef:w.createRef(),SkinTonePickerRef:w.createRef(),VariationPickerRef:w.createRef(),ReactionsRef:w.createRef()});function xu(){return w.useContext(Qve)}function Jve(){return xu().EmojiListRef}function _0(){return xu().PickerMainRef}function nE(){return xu().AnchoredEmojiRef}function Zve(){var e=nE();return function(t){t===null&&e.current!==null&&Fi(e.current),e.current=t}}function Ui(){return xu().BodyRef}function vmt(){return xu().ReactionsRef}function Vd(){return xu().SearchInputRef}function M$(){return xu().SkinTonePickerRef}function T$(){return xu().CategoryNavigationRef}function bmt(){return xu().VariationPickerRef}function Xve(e,t){t===void 0&&(t=0);var r=fbe(e);r&&requestAnimationFrame(function(){r.scrollTop=t})}function ymt(e,t){var r=fbe(e);r&&requestAnimationFrame(function(){r.scrollTop=r.scrollTop+t})}function xmt(){var e=Ui();return w.useCallback(function(t){requestAnimationFrame(function(){e.current&&(e.current.scrollTop=t)})},[e])}function aE(e){if(!(!e||!spt(e))&&!e.closest(Co(Mr.variationPicker))){var t=mbe(e),r=hbe(e);ymt(t,-(I$(Yd(e))-r))}}function sE(e){var t=B$(e);Fi(t),aE(t)}function wmt(e){var t=B$(e);Fi(t),t?.click()}function Smt(e){Fi(bbe(e))}function kmt(e){if(e){var t=ybe(e);if(!t)return sE(oE(e));Fi(t),aE(t)}}function _mt(e){if(e){var t=z$(e);if(!t)return Smt(iE(e));Fi(t),aE(t)}}function Nmt(e,t){if(e){var r=jmt(e);if(!r)return t();Fi(r),aE(r)}}function Cmt(e){if(e){var t=Emt(e);return Fi(t)}}function jmt(e){if(!e)return null;var t=xbe(e),r=Yd(t),n=cbe(t,e),a=Kg(r),s=a.indexOf(e),i=s%n;if(s===-1)return null;if(a[s-n])return a[s-n];var l=iE(r);if(!l)return null;var c=Kg(l),u=c.length%n-1;if(i>u)return c.at(-1);for(var d=c.length-1;d>=0;d--)if(d%n===i)return c[d];return c.at(-1)}function Emt(e){var t;if(!e)return null;var r=xbe(e),n=Yd(r),a=cbe(r,e),s=Kg(n),i=s.indexOf(e);if(i===-1)return null;var l=a-i%a-1,c=i+l+1;if(s[c]){for(var u=i+a;u%a>=0;u--)if(s[u])return s[u]}var d=i%a,f=oE(n),m=Kg(f);return m[d]?m[d]:(t=m.at(0))!=null?t:null}function dm(){var e=k0(),t=e[0],r=e[1],n=D1(),a=n[0],s=n[1],i=w.useCallback(function(){t&&r(null),a&&s(!1)},[t,a,r,s]);return i}function ebe(){var e=k0(),t=e[0],r=D1(),n=r[0];return function(){return!!t||n}}function Mmt(){var e=N$();return function(){e.current=!0}}function tbe(){var e=N$();return function(){e.current=!1}}function rbe(){var e=N$();return function(){return e.current}}function Tmt(){var e=Ui(),t=tbe(),r=rbe();w.useEffect(function(){var n=e.current;n?.addEventListener("mousemove",a,{passive:!0});function a(){r()&&t()}return function(){n?.removeEventListener("mousemove",a)}},[e,t,r])}function fm(){var e=Vd();return w.useCallback(function(){Fi(e.current)},[e])}function Amt(){var e=M$();return w.useCallback(function(){e.current&&Yve(e.current)},[e])}function nbe(){var e=T$();return w.useCallback(function(){e.current&&Yve(e.current)},[e])}function Dmt(){var e=_$();return function t(r){if(typeof r=="function")return t(r(e.current));e.current=r}}function abe(){var e=A$(),t=Vd(),r=fm();return function(){t.current&&(t.current.value=""),e(""),r()}}function Lmt(){var e=Vd(),t=A$();return function(n){e.current?(e.current.value=""+e.current.value+n,t(Yte(e.current.value))):t(Yte(n))}}function Omt(){var e=Vd(),t=_$(),r=Dmt(),n=A$(),a=eE(),s=a[0],i=$mt(t.current,s);return{onChange:l,searchTerm:s,SearchInputRef:e,statusSearchResults:i};function l(c){var u=t.current,d=c.toLowerCase();if(u!=null&&u[d]||d.length<=1)return n(d);var f=Bmt(d,u);if(!f)return n(d);r(function(m){var p;return Object.assign(m,(p={},p[d]=Imt(f,d),p))}),n(d)}}function A$(){var e=eE(),t=e[1],r=_0();return function(a){requestAnimationFrame(function(){t(a&&a?.toLowerCase()).then(function(){Xve(r.current,0)})})}}function Imt(e,t){var r={};for(var n in e){var a=e[n];Rmt(a,t)&&(r[n]=a)}return r}function Rmt(e,t){return Sve(e).some(function(r){return r.includes(t)})}function Pmt(){var e=_$(),t=e.current,r=eE(),n=r[0];return function(a){return zmt(a,t,n)}}function zmt(e,t,r){var n;return!t||!r?!1:!((n=t[r])!=null&&n[e])}function Bmt(e,t){if(!t)return null;if(t[e])return t[e];var r=Object.keys(t).sort(function(n,a){return a.length-n.length}).find(function(n){return e.includes(n)});return r?t[r]:null}function Yte(e){return!e||typeof e!="string"?"":e.trim().toLowerCase()}function $mt(e,t){var r;if(!(e!=null&&e[t]))return"";var n=((r=Object.entries(e?.[t]))==null?void 0:r.length)||0;return pmt(n)}function sbe(){var e=Zve(),t=k0(),r=t[1];return function(a){var s=O$(a),i=s[0];i&&(e(a),r(i))}}function D$(){var e=Kve();return e===Wg.SEARCH}function ibe(){var e=Kve();return e===Wg.PREVIEW}var ma;(function(e){e.ArrowDown="ArrowDown",e.ArrowUp="ArrowUp",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.Escape="Escape",e.Enter="Enter",e.Space=" "})(ma||(ma={}));function Fmt(){Umt(),Hmt(),qmt(),Wmt(),Kmt()}function Umt(){var e=_0(),t=abe(),r=xmt(),n=Vd(),a=fm(),s=ebe(),i=Mmt(),l=dm(),c=w.useMemo(function(){return function(d){var f=d.key;switch(i(),f){case ma.Escape:if(d.preventDefault(),s()){l();return}t(),r(0),a();break}}},[r,t,l,a,s,i]);w.useEffect(function(){var u=e.current;if(u)return u.addEventListener("keydown",c),function(){u.removeEventListener("keydown",c)}},[e,n,r,c])}function Hmt(){var e=Amt(),t=_0(),r=Ui(),n=Vd(),a=D1(),s=a[1],i=obe(),l=D$(),c=w.useMemo(function(){return function(d){var f=d.key;switch(f){case ma.ArrowRight:if(!l)return;d.preventDefault(),s(!0),e();break;case ma.ArrowDown:d.preventDefault(),i();break;case ma.Enter:d.preventDefault(),wmt(r.current);break}}},[e,i,s,r,l]);w.useEffect(function(){var u=n.current;if(u)return u.addEventListener("keydown",c),function(){u.removeEventListener("keydown",c)}},[t,n,c])}function qmt(){var e=M$(),t=fm(),r=Vd(),n=obe(),a=D1(),s=a[0],i=a[1],l=ibe(),c=D$(),u=L$(),d=w.useMemo(function(){return(function(m){var p=m.key;if(c)switch(p){case ma.ArrowLeft:if(m.preventDefault(),!s)return t();Qte(t);break;case ma.ArrowRight:if(m.preventDefault(),!s)return t();Jte();break;case ma.ArrowDown:m.preventDefault(),s&&i(!1),n();break;default:u(m);break}if(l)switch(p){case ma.ArrowUp:if(m.preventDefault(),!s)return t();Qte(t);break;case ma.ArrowDown:if(m.preventDefault(),!s)return t();Jte();break;default:u(m);break}})},[s,t,i,n,u,l,c]);w.useEffect(function(){var f=e.current;if(f)return f.addEventListener("keydown",d),function(){f.removeEventListener("keydown",d)}},[e,r,s,d])}function Wmt(){var e=fm(),t=T$(),r=Ui(),n=L$(),a=w.useMemo(function(){return function(i){var l=i.key;switch(l){case ma.ArrowUp:i.preventDefault(),e();break;case ma.ArrowRight:i.preventDefault(),Vve(kx());break;case ma.ArrowLeft:i.preventDefault(),Gve(kx());break;case ma.ArrowDown:i.preventDefault(),sE(r.current);break;default:n(i);break}}},[r,e,n]);w.useEffect(function(){var s=t.current;if(s)return s.addEventListener("keydown",a),function(){s.removeEventListener("keydown",a)}},[t,r,a])}function Kmt(){var e=Ui(),t=Gmt(),r=sbe(),n=ebe(),a=dm(),s=L$(),i=w.useMemo(function(){return(function(c){var u=c.key,d=Jo(kx());switch(u){case ma.ArrowRight:c.preventDefault(),kmt(d);break;case ma.ArrowLeft:c.preventDefault(),_mt(d);break;case ma.ArrowDown:if(c.preventDefault(),n()){a();break}Cmt(d);break;case ma.ArrowUp:if(c.preventDefault(),n()){a();break}Nmt(d,t);break;case ma.Space:c.preventDefault(),r(c.target);break;default:s(c);break}})},[t,s,r,n,a]);w.useEffect(function(){var l=e.current;if(l)return l.addEventListener("keydown",i),function(){l.removeEventListener("keydown",i)}},[e,i])}function obe(){var e=nbe(),t=rE(),r=Ui();return w.useCallback(function(){return t?sE(r.current):e()},[r,e,t])}function Gmt(){var e=fm(),t=nbe(),r=rE();return w.useCallback(function(){return r?e():t()},[e,r,t])}function Qte(e){var t=kx();t&&(rpt(t)||e(),Vve(t))}function Jte(){var e=kx();e&&Gve(e)}function L$(){var e=Lmt(),t=fm(),r=Wve(),n=dm();return function(s){var i=s.key;Vmt(s)||r||i.match(/(^[a-zA-Z0-9]$){1}/)&&(s.preventDefault(),n(),t(),e(i))}}function Vmt(e){var t=e.metaKey,r=e.ctrlKey,n=e.altKey;return t||r||n}function Ymt(e,t,r,n,a,s,i,l){if(e&&t!==Ai.NATIVE){var c=om(e);f5.has(c)||!s||!i||setTimeout(function(){var u=a+s.top,d=r+n,f=u>=d&&u<d+i.emojiSize*2;f&&lbe(l,e,t)})}}function lbe(e,t,r){if(t){var n=om(t);f5.has(n)||(f5.add(n),y$(t).concat(n).forEach(function(a){var s=e(a,r);Qmt(s)}))}}var f5=new Set;function Qmt(e){var t=new Image;t.src=e}function Jmt(){var e=Ui(),t=cm(),r=um();w.useEffect(function(){if(t===Ai.NATIVE)return;var n=e.current;return n?.addEventListener("focusin",a),function(){n?.removeEventListener("focusin",a)};function a(s){var i=Jo(s.target);if(i){var l=O$(i),c=l[0];c&&S0(c)&&lbe(r,c,t)}}},[e,t,r])}var Zmt=["width","height"],h5=40;function Xmt(e){var t=e.children;return w.createElement(Jht,null,w.createElement(ept,null,t))}function ept(e){var t,r=e.children,n=lm(),a=n[0],s=lmt(),i=rE(),l=_0(),c=cmt(),u=umt();Fmt(),Jmt();var d=u||{},f=d.width,m=d.height,p=xve(d,Zmt);return w.createElement("aside",{className:_r(Hv.main,Hv.baseVariables,s===Ld.DARK&&Hv.darkTheme,s===Ld.AUTO&&Hv.autoThemeDark,(t={},t[Mr.searchActive]=i,t),a&&Hv.reactionsMenu,c),ref:l,style:pn({},p,!a&&{height:m,width:f})},r)}var Zte={"--epr-emoji-variation-picker-bg-color":"var(--epr-dark-emoji-variation-picker-bg-color)","--epr-hover-bg-color-reduced-opacity":"var(--epr-dark-hover-bg-color-reduced-opacity)","--epr-highlight-color":"var(--epr-dark-highlight-color)","--epr-text-color":"var(--epr-dark-text-color)","--epr-hover-bg-color":"var(--epr-dark-hover-bg-color)","--epr-focus-bg-color":"var(--epr-dark-focus-bg-color)","--epr-search-input-bg-color":"var(--epr-dark-search-input-bg-color)","--epr-category-label-bg-color":"var(--epr-dark-category-label-bg-color)","--epr-picker-border-color":"var(--epr-dark-picker-border-color)","--epr-bg-color":"var(--epr-dark-bg-color)","--epr-reactions-bg-color":"var(--epr-dark-reactions-bg-color)","--epr-search-input-bg-color-active":"var(--epr-dark-search-input-bg-color-active)","--epr-emoji-variation-indicator-color":"var(--epr-dark-emoji-variation-indicator-color)","--epr-category-icon-active-color":"var(--epr-dark-category-icon-active-color)","--epr-skin-tone-picker-menu-color":"var(--epr-dark-skin-tone-picker-menu-color)","--epr-skin-tone-outer-border-color":"var(--epr-dark-skin-tone-outer-border-color)","--epr-skin-tone-inner-border-color":"var(--epr-dark-skin-tone-inner-border-color)"},Hv=Dn.create({main:{".":["epr-main",Mr.emojiPicker],position:"relative",display:"flex",flexDirection:"column",borderWidth:"1px",borderStyle:"solid",borderRadius:"var(--epr-picker-border-radius)",borderColor:"var(--epr-picker-border-color)",backgroundColor:"var(--epr-bg-color)",overflow:"hidden",transition:"height 0.3s ease-in-out, background-color 0.1s ease-in-out","*":{boxSizing:"border-box",fontFamily:"sans-serif"}},baseVariables:{"--":{"--epr-highlight-color":"#007aeb","--epr-hover-bg-color":"#e5f0fa","--epr-hover-bg-color-reduced-opacity":"#e5f0fa80","--epr-focus-bg-color":"#e0f0ff","--epr-text-color":"#858585","--epr-search-input-bg-color":"#f6f6f6","--epr-picker-border-color":"#e7e7e7","--epr-bg-color":"#fff","--epr-reactions-bg-color":"#ffffff90","--epr-category-icon-active-color":"#6aa8de","--epr-skin-tone-picker-menu-color":"#ffffff95","--epr-skin-tone-outer-border-color":"#555555","--epr-skin-tone-inner-border-color":"var(--epr-bg-color)","--epr-horizontal-padding":"10px","--epr-picker-border-radius":"8px","--epr-header-padding":"15px var(--epr-horizontal-padding)","--epr-active-skin-tone-indicator-border-color":"var(--epr-highlight-color)","--epr-active-skin-hover-color":"var(--epr-hover-bg-color)","--epr-search-input-bg-color-active":"var(--epr-search-input-bg-color)","--epr-search-input-padding":"0 30px","--epr-search-input-border-radius":"8px","--epr-search-input-height":"40px","--epr-search-input-text-color":"var(--epr-text-color)","--epr-search-input-placeholder-color":"var(--epr-text-color)","--epr-search-bar-inner-padding":"var(--epr-horizontal-padding)","--epr-search-border-color":"var(--epr-search-input-bg-color)","--epr-search-border-color-active":"var(--epr-highlight-color)","--epr-category-navigation-button-size":"30px","--epr-emoji-variation-picker-height":"45px","--epr-emoji-variation-picker-bg-color":"var(--epr-bg-color)","--epr-preview-height":"70px","--epr-preview-text-size":"14px","--epr-preview-text-padding":"0 var(--epr-horizontal-padding)","--epr-preview-border-color":"var(--epr-picker-border-color)","--epr-preview-text-color":"var(--epr-text-color)","--epr-category-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-bg-color":"#ffffffe6","--epr-category-label-text-color":"var(--epr-text-color)","--epr-category-label-padding":"0 var(--epr-horizontal-padding)","--epr-category-label-height":h5+"px","--epr-emoji-size":"30px","--epr-emoji-padding":"5px","--epr-emoji-fullsize":"calc(var(--epr-emoji-size) + var(--epr-emoji-padding) * 2)","--epr-emoji-hover-color":"var(--epr-hover-bg-color)","--epr-emoji-variation-indicator-color":"var(--epr-picker-border-color)","--epr-emoji-variation-indicator-color-hover":"var(--epr-text-color)","--epr-header-overlay-z-index":"3","--epr-emoji-variations-indictator-z-index":"1","--epr-category-label-z-index":"2","--epr-skin-variation-picker-z-index":"5","--epr-preview-z-index":"6","--epr-dark":"#000","--epr-dark-emoji-variation-picker-bg-color":"var(--epr-dark)","--epr-dark-highlight-color":"#c0c0c0","--epr-dark-text-color":"var(--epr-highlight-color)","--epr-dark-hover-bg-color":"#363636f6","--epr-dark-hover-bg-color-reduced-opacity":"#36363680","--epr-dark-focus-bg-color":"#474747","--epr-dark-search-input-bg-color":"#333333","--epr-dark-category-label-bg-color":"#222222e6","--epr-dark-picker-border-color":"#151617","--epr-dark-bg-color":"#222222","--epr-dark-reactions-bg-color":"#22222290","--epr-dark-search-input-bg-color-active":"var(--epr-dark)","--epr-dark-emoji-variation-indicator-color":"#444","--epr-dark-category-icon-active-color":"#3271b7","--epr-dark-skin-tone-picker-menu-color":"#22222295","--epr-dark-skin-tone-outer-border-color":"var(--epr-dark-picker-border-color)","--epr-dark-skin-tone-inner-border-color":"#00000000"}},autoThemeDark:{".":Mr.autoTheme,"@media (prefers-color-scheme: dark)":{"--":Zte}},darkTheme:{".":Mr.darkTheme,"--":Zte},reactionsMenu:{".":"epr-reactions",height:"50px",display:"inline-flex",backgroundColor:"var(--epr-reactions-bg-color)",backdropFilter:"blur(8px)","--":{"--epr-picker-border-radius":"50px"}}});function cbe(e,t){if(!e||!t)return 0;var r=e.getBoundingClientRect().width,n=t.getBoundingClientRect().width;return Math.floor(r/n)}function tpt(e,t,r){if(!e||!t.length)return null;var n=e.getBoundingClientRect().top,a=e.getBoundingClientRect().bottom,s=n+ube(e),i=t.find(function(l){var c=l.getBoundingClientRect().top,u=l.getBoundingClientRect().bottom,d=l.clientHeight*r,f=c+d,m=u-d;return f<s?!1:f>=n&&f<=a||m>=n&&m<=a});return i||null}function rpt(e){return!!e.nextElementSibling}function ube(e){if(!e)return h5;var t=e.querySelector(Co(Mr.label));if(t){var r=t.getBoundingClientRect().height;if(r>0)return r}return h5}var _x="button"+Co(Mr.emoji),npt=[_x,Co(Mr.visible),":not("+Co(Mr.hidden)+")"].join("");function Jo(e){var t;return(t=e?.closest(_x))!=null?t:null}function O$(e){var t=pbe(e),r=R$(e);if(!t)return[];var n=S$(r??t);return n?[n,r]:[]}function apt(e){var t;return!!(e?.matches(_x)||!(e==null||(t=e.parentElement)==null)&&t.matches(_x))}function Xte(e){var t;return(t=e?.clientHeight)!=null?t:0}function dbe(e){if(!e)return 0;var t=Jo(e),r=Yd(t),n=I$(r);return ere(t)+ere(r)+n}function I$(e){var t,r;if(!e)return 0;var n=e.querySelector(Co(Mr.categoryContent));return((t=e?.clientHeight)!=null?t:0)-((r=n?.clientHeight)!=null?r:0)}function spt(e){return e?hbe(e)<I$(Yd(e)):!1}function fbe(e){return e?e.matches(Co(Mr.scrollBody))?e:e.querySelector(Co(Mr.scrollBody)):null}function hbe(e){var t,r;return e?dbe(e)-((t=(r=mbe(e))==null?void 0:r.scrollTop)!=null?t:0):0}function mbe(e){var t;return e&&(t=e.closest(Co(Mr.scrollBody)))!=null?t:null}function ipt(e){var t=Jo(e),r=Yd(t);return tre(t)+tre(r)}function ere(e){var t;return(t=e?.offsetTop)!=null?t:0}function tre(e){var t;return(t=e?.offsetLeft)!=null?t:0}function R$(e){var t;return(t=opt(Jo(e),"unified"))!=null?t:null}function pbe(e){var t=R$(e);return t?Dve(t):null}function gbe(e){return e?{unified:R$(e),originalUnified:pbe(e)}:{unified:null,originalUnified:null}}function opt(e,t){var r;return(r=lpt(e)[t])!=null?r:null}function lpt(e){var t;return(t=e?.dataset)!=null?t:{}}function P$(e){return e.classList.contains(Mr.visible)}function vbe(e){return e?e.classList.contains(Mr.hidden):!0}function Kg(e){return e?Array.from(e.querySelectorAll(npt)):[]}function bbe(e){if(!e)return null;var t=Kg(e),r=t.slice(-1),n=r[0];return n?P$(n)?n:z$(n):null}function ybe(e){var t=e.nextElementSibling;return t?P$(t)?t:ybe(t):B$(oE(e))}function z$(e){var t=e.previousElementSibling;return t?P$(t)?t:z$(t):bbe(iE(e))}function B$(e){if(!e)return null;var t=Kg(e);return tpt(e,t,.1)}function iE(e){var t=Yd(e);if(!t)return null;var r=t.previousElementSibling;return r?vbe(r)?iE(r):r:null}function oE(e){var t=Yd(e);if(!t)return null;var r=t.nextElementSibling;return r?vbe(r)?oE(r):r:null}function Yd(e){return e?e.closest(Co(Mr.category)):null}function xbe(e){return e?e.closest(Co(Mr.categoryContent)):null}function wbe(e){return e.split("-").map(function(t){return String.fromCodePoint(parseInt(t,16))}).join("")}function cpt(e){return e.category===Qt.CUSTOM}function Sbe(e){return e.imgUrl!==void 0}function kbe(e,t){var r=w.useRef(),n=sbe(),a=Zht(),s=k0(),i=s[1],l=dm(),c=tE(),u=c[0],d=imt(t),f=j$(),m=f[1],p=um(),v=cm(),b=w.useCallback(function(N){if(!a.current){l();var k=rre(N),j=k[0],E=k[1];if(!(!j||!E)){var T=Uht(E)||u;m(),Hht(j,T),d(upt(j,T,v,p),N)}}},[u,l,a,d,m,p,v]),y=w.useCallback(function(N){var k;r.current&&clearTimeout(r.current);var j=rre(N),E=j[0];!E||!S0(E)||(r.current=(k=window)==null?void 0:k.setTimeout(function(){a.current=!0,r.current=void 0,l(),n(N.target),i(E)},500))},[a,l,n,i]),S=w.useCallback(function(){r.current?(clearTimeout(r.current),r.current=void 0):a.current&&requestAnimationFrame(function(){a.current=!1})},[a]);w.useEffect(function(){if(e.current){var _=e.current;return _.addEventListener("click",b,{passive:!0}),_.addEventListener("mousedown",y,{passive:!0}),_.addEventListener("mouseup",S,{passive:!0}),function(){_?.removeEventListener("click",b),_?.removeEventListener("mousedown",y),_?.removeEventListener("mouseup",S)}}},[e,b,y,S])}function rre(e){var t=e?.target;return apt(t)?O$(t):[]}function upt(e,t,r,n){var a=w$(e);if(Sbe(e)){var s=El(e);return{activeSkinTone:t,emoji:s,getImageUrl:function(){return e.imgUrl},imageUrl:e.imgUrl,isCustom:!0,names:a,unified:s,unifiedWithoutSkinTone:s}}var i=El(e,t);return{activeSkinTone:t,emoji:wbe(i),getImageUrl:function(c){return c===void 0&&(c=r??Ai.APPLE),n(i,c)},imageUrl:n(i,r??Ai.APPLE),isCustom:!1,names:a,unified:i,unifiedWithoutSkinTone:El(e)}}function L1(e){return w.createElement("button",Object.assign({type:"button"},e,{className:_r(dpt.button,e.className)}),e.children)}var dpt=Dn.create({button:{".":"epr-btn",cursor:"pointer",border:"0",background:"none",outline:"none"}});function fpt(e){var t,r=e.emojiNames,n=e.unified,a=e.hidden,s=e.hiddenOnSearch,i=e.showVariations,l=i===void 0?!0:i,c=e.hasVariations,u=e.children,d=e.className,f=e.noBackground,m=f===void 0?!1:f,p=e.style;return w.createElement(L1,{className:_r(ZL.emoji,a&&v$.hidden,s&&im.hiddenOnSearch,(t={},t[Mr.visible]=!a&&!s,t),!!(c&&l)&&ZL.hasVariations,m&&ZL.noBackground,d),"data-unified":n,"aria-label":hpt(r),"data-full-name":r,style:p},u)}function hpt(e){return e[e.length-1]}var ZL=Dn.create({emoji:{".":Mr.emoji,position:"relative",width:"var(--epr-emoji-fullsize)",height:"var(--epr-emoji-fullsize)",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",borderRadius:"8px",overflow:"hidden",transition:"background-color 0.2s",":hover":{backgroundColor:"var(--epr-emoji-hover-color)"},":focus":{backgroundColor:"var(--epr-focus-bg-color)"}},noBackground:{background:"none",":hover":{backgroundColor:"transparent",background:"none"},":focus":{backgroundColor:"transparent",background:"none"}},hasVariations:{".":Mr.emojiHasVariations,":after":{content:"",display:"block",width:"0",height:"0",right:"0px",bottom:"1px",position:"absolute",borderLeft:"4px solid transparent",borderRight:"4px solid transparent",transform:"rotate(135deg)",borderBottom:"4px solid var(--epr-emoji-variation-indicator-color)",zIndex:"var(--epr-emoji-variations-indictator-z-index)"},":hover:after":{borderBottom:"4px solid var(--epr-emoji-variation-indicator-color-hover)"}}}),AC=Dn.create({external:{".":Mr.external,fontSize:"0"},common:{alignSelf:"center",justifySelf:"center",display:"block"}});function nre(e){var t=e.emojiName,r=e.style,n=e.lazyLoad,a=n===void 0?!1:n,s=e.imgUrl,i=e.onError,l=e.className;return w.createElement("img",{src:s,alt:t,className:_r(mpt.emojiImag,AC.external,AC.common,l),loading:a?"lazy":"eager",onError:i,style:r})}var mpt=Dn.create({emojiImag:{".":"epr-emoji-img",maxWidth:"var(--epr-emoji-fullsize)",maxHeight:"var(--epr-emoji-fullsize)",minWidth:"var(--epr-emoji-fullsize)",minHeight:"var(--epr-emoji-fullsize)",padding:"var(--epr-emoji-padding)"}});function ppt(e){var t=e.unified,r=e.style,n=e.className;return w.createElement("span",{className:_r(gpt.nativeEmoji,AC.common,AC.external,n),"data-unified":t,style:r},wbe(t))}var gpt=Dn.create({nativeEmoji:{".":"epr-emoji-native",fontFamily:'"Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "Apple Color Emoji", "Twemoji Mozilla", "Noto Color Emoji", "EmojiOne Color", "Android Emoji"!important',position:"relative",lineHeight:"100%",fontSize:"var(--epr-emoji-size)",textAlign:"center",alignSelf:"center",justifySelf:"center",letterSpacing:"0",padding:"var(--epr-emoji-padding)"}});function m5(e){var t=e.emoji,r=e.unified,n=e.emojiStyle,a=e.size,s=e.lazyLoad,i=e.getEmojiUrl,l=i===void 0?_ve:i,c=e.className,u=Rve(),d=u[1],f=A1(),m=f.emojiByUnified,p={};a&&(p.width=p.height=p.fontSize=a+"px");var v=t||m(r);if(!v)return null;if(Sbe(v))return w.createElement(nre,{style:p,emojiName:r,emojiStyle:Ai.NATIVE,lazyLoad:s,imgUrl:v.imgUrl,onError:b,className:c});return w.createElement(w.Fragment,null,n===Ai.NATIVE?w.createElement(ppt,{unified:r,style:p,className:c}):w.createElement(nre,{style:p,emojiName:Sht(v),emojiStyle:n,lazyLoad:s,imgUrl:l(r,n),onError:b,className:c}));function b(){d(function(y){return new Set(y).add(r)})}}function lE(e){var t=e.emoji,r=e.unified,n=e.hidden,a=e.hiddenOnSearch,s=e.emojiStyle,i=e.showVariations,l=i===void 0?!0:i,c=e.size,u=e.lazyLoad,d=e.getEmojiUrl,f=e.className,m=e.noBackground,p=m===void 0?!1:m,v=e.style,b=S0(t);return w.createElement(fpt,{hasVariations:b,showVariations:l,hidden:n,hiddenOnSearch:a,emojiNames:w$(t),unified:r,noBackground:p,style:v},w.createElement(m5,{unified:r,emoji:t,size:c,emojiStyle:s,lazyLoad:u,getEmojiUrl:d,className:f}))}var vpt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI4LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNS43LDEwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsMTAuOSw2LjEsMTEsNi4zLDExaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjRWNi43YzAtMC4zLTAuMi0wLjUtMC41LTAuNQoJQzkuOCw2LDkuNiw2LjIsOS42LDYuNXYzLjRINi4yQzUuOSw5LjksNS43LDEwLjEsNS43LDEwLjRMNS43LDEwLjR6Ii8+CjxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik01LjcsMzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDMxLDYuMywzMWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuMgoJQzUuOSwyOS45LDUuNywzMC4xLDUuNywzMC40TDUuNywzMC40eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNS43LDUwLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40QzYsNTAuOSw2LjEsNTEsNi4zLDUxaDMuNHYzLjRjMCwwLjEsMC4xLDAuMywwLjIsMC40CgljMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4zLDAsMC41LTAuMiwwLjUtMC41di0zLjRoMy40YzAuMywwLDAuNS0wLjIsMC41LTAuNXMtMC4yLTAuNS0wLjUtMC41aC0zLjR2LTMuNGMwLTAuMy0wLjItMC41LTAuNS0wLjUKCXMtMC41LDAuMi0wLjUsMC41djMuNEg2LjJDNS45LDQ5LjksNS43LDUwLjEsNS43LDUwLjRMNS43LDUwLjR6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik01LjcsNzAuNGMwLDAuMSwwLjEsMC4zLDAuMiwwLjRTNi4xLDcxLDYuMyw3MWgzLjR2My40YzAsMC4xLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMgoJYzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMy40aDMuNGMwLjMsMCwwLjUtMC4yLDAuNS0wLjVzLTAuMi0wLjUtMC41LTAuNWgtMy40di0zLjRjMC0wLjMtMC4yLTAuNS0wLjUtMC41cy0wLjUsMC4yLTAuNSwwLjV2My40SDYuNAoJQzUuOSw2OS45LDUuNyw3MC4xLDUuNyw3MC40TDUuNyw3MC40eiIvPgo8L3N2Zz4=";function bpt(){var e=lm(),t=e[1];return w.createElement(L1,{"aria-label":"Show all Emojis",title:"Show all Emojis",tabIndex:0,className:_r(ypt.plusSign),onClick:function(){return t(!1)}})}var ypt=Dn.create(pn({plusSign:{fontSize:"20px",padding:"17px",color:"var(--epr-text-color)",borderRadius:"50%",textAlign:"center",lineHeight:"100%",width:"20px",height:"20px",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.2s ease-in-out",":after":{content:"",minWidth:"20px",minHeight:"20px",backgroundImage:"url("+vpt+")",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",backgroundPositionY:"0"},":hover":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-20px"}},":focus":{color:"var(--epr-highlight-color)",backgroundColor:"var(--epr-hover-bg-color-reduced-opacity)",":after":{backgroundPositionY:"-40px"}}}},zd("plusSign",{":after":{backgroundPositionY:"-40px"},":hover:after":{backgroundPositionY:"-60px"}})));function xpt(){var e=lm(),t=e[0],r=vmt(),n=mmt();kbe(r,Sx.REACTIONS);var a=cm(),s=$ve(),i=um();return t?w.createElement("ul",{className:_r(are.list,!t&&v$.hidden),ref:r},n.map(function(l){var c=S$(l);return c?w.createElement("li",{key:l},w.createElement(lE,{emoji:c,emojiStyle:a,unified:l,showVariations:!1,className:_r(are.emojiButton),noBackground:!0,getEmojiUrl:i})):null}),s?w.createElement("li",null,w.createElement(bpt,null)):null):null}var are=Dn.create({list:{listStyle:"none",margin:"0",padding:"0 5px",display:"flex",justifyContent:"space-between",alignItems:"center",height:"100%"},emojiButton:{":hover":{transform:"scale(1.2)"},":focus":{transform:"scale(1.2)"},":active":{transform:"scale(1.1)"},transition:"transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.5)"}});function wpt(e){var t=dm(),r=w.useState(0),n=r[0],a=r[1];return w.useEffect(function(){var s=e.current;if(!s)return;s.addEventListener("scroll",i,{passive:!0});function i(){var l;a((l=s?.scrollTop)!=null?l:0),t()}return function(){s?.removeEventListener("scroll",i)}},[e,t]),n}function Spt(e){var t=e.scrollTop,r=e.clientHeight,n=e.topOffset,a=e.style,s=e.dimensions;if(!a||!s)return!1;var i=n+a.top,l=i+s.emojiSize,c=l+s.emojiSize*2>=t&&i<=t+r+s.emojiSize;return!c}function kpt(e,t){return e?{top:Math.floor(t/e.emojisPerRow)*e.emojiSize,left:t%e.emojisPerRow*e.emojiSize}:void 0}var _pt=40;function Npt(e){var t=Jve(),r=lm(),n=r[0],a=_0(),s=w.useRef(),i=C$(),l=i[0],c=Pve(),u=c[0],d=w.useState(),f=d[0],m=d[1],p=w.useCallback(function(){var v=t.current;if(v){var b=v.querySelector(_x),y=b?.clientHeight;y&&(s.current=y);var S=u||y||s.current||_pt,_=v.clientWidth;if(!(_===0||S===0)){var N=Math.max(1,Math.floor(_/S)),k=Math.ceil(e/N),j=k*S;m({categoryHeight:j,emojisPerRow:N,emojiSize:S})}}},[t,e,u]);return w.useEffect(function(){p()},[e,n,p,l.length]),w.useEffect(function(){var v=a.current;if(v){var b=function(S){var _=S,N=_.propertyName;(N==="width"||N==="max-width"||N==="min-width"||N==="height"||N==="max-height"||N==="min-height")&&(typeof queueMicrotask=="function"?queueMicrotask(function(){return p()}):requestAnimationFrame(function(){return p()}))};return v.addEventListener("transitionend",b,{passive:!0}),function(){v.removeEventListener("transitionend",b)}}},[a,p]),f}function Cpt(){var e=Rve(),t=e[0],r=Pmt();return function(n){var a=om(n),s=t.has(a),i=r(a);return{failedToLoad:s,filteredOut:i,hidden:s||i}}}function jpt(e){var t=e.categoryEmojis,r=e.topOffset,n=e.onHeightReady,a=e.scrollTop,s=e.isCategoryVisible,i=Cpt(),l=qve(),c=cm(),u=tE(),d=u[0],f=Vht(),m=um(),p=!Fve(),v=Ui(),b=0,y=t.filter(function(k){var j=f(k),E=i(k),T=E.failedToLoad,O=E.filteredOut,R=E.hidden;return!T&&!O&&!R&&!j}),S=Npt(y.length);w.useEffect(function(){S&&n(S.categoryHeight)},[S,n,y.length]);var _=function(j){var E,T;return S&&v.current&&Spt({scrollTop:a,clientHeight:(E=(T=v.current)==null?void 0:T.clientHeight)!=null?E:0,topOffset:r,style:j,dimensions:S})},N=y.reduce(function(k,j,E){var T=om(j,d),O=kpt(S,E);if(_(O)){var R,H;return b++,Ymt(j,c,a,(R=(H=v.current)==null?void 0:H.clientHeight)!=null?R:0,r,O,S,m),k}return s?(k.push(w.createElement(lE,{showVariations:p,key:T,emoji:j,unified:T,emojiStyle:c,lazyLoad:l,getEmojiUrl:m,style:pn({},O,{position:"absolute"})})),k):(b++,k)},[]);return{virtualizedCounter:b,emojis:N,dimensions:S}}function Ept(e){var t=e.categoryConfig,r=e.children,n=e.hidden,a=e.hiddenOnSearch,s=e.height,i=Z2(t),l=jve(t);return w.createElement("li",{className:_r(XL.category,n&&v$.hidden,a&&im.hiddenOnSearch),"data-name":i,"aria-label":l},w.createElement("h2",{className:_r(XL.label)},l),w.createElement("div",{className:_r(XL.categoryContent),style:{height:s}},r))}var XL=Dn.create({category:{".":Mr.category,minHeight:"calc(var(--epr-emoji-fullsize) + var(--epr-category-label-height))",position:"relative"},categoryContent:{".":Mr.categoryContent,display:"grid",gridGap:"0",gridTemplateColumns:"repeat(auto-fill, var(--epr-emoji-fullsize))",justifyContent:"space-between",margin:"var(--epr-category-padding)",position:"relative"},label:{".":Mr.label,alignItems:"center",backdropFilter:"blur(3px)",backgroundColor:"var(--epr-category-label-bg-color)",color:"var(--epr-category-label-text-color)",display:"flex",fontSize:"16px",fontWeight:"bold",height:"var(--epr-category-label-height)",margin:"0",padding:"var(--epr-category-label-padding)",position:"sticky",textTransform:"capitalize",top:"0",width:"100%",zIndex:"var(--epr-category-label-z-index)"}});function Mpt(){var e=E$(),t=Bht(),r=cm(),n=um(),a=qve(),s=tE(),i=s[0],l=Pve(),c=l[0],u=l[1],d=w.useRef(null);if(w.useLayoutEffect(function(){d.current&&u(d.current.clientHeight)}),c)return null;var f=e[0],m=t(Z2(f))[0],p=m?El(m,i):"";return m?w.createElement("div",{ref:d},w.createElement(lE,{emoji:m,unified:p,emojiStyle:r,getEmojiUrl:n,lazyLoad:a,showVariations:!1,hidden:!1,style:{opacity:0,pointerEvents:"none",position:"absolute",top:0,left:0,zIndex:-1,height:"var(--epr-emoji-fullsize)",width:"var(--epr-emoji-fullsize)"}})):null}function Tpt(e){var t=e.scrollTop,r=E$(),n=w.useState({}),a=n[0],s=n[1],i=Jve(),l=Wht(),c=ube(i.current),u=0;return w.createElement("ul",{className:_r(Dpt.emojiList),ref:i},w.createElement(Mpt,null),r.map(function(d){var f=Z2(d),m=u,p=a[f];return p&&(u+=p+c),w.createElement(w.Suspense,{key:f},w.createElement(Apt,{categoryEmojis:l(f),categoryConfig:d,topOffset:m,onHeightReady:function(b){a[f]!==b&&s(function(y){var S;return pn({},y,(S={},S[f]=b,S))})},scrollTop:t}))}))}function Apt(e){var t=e.categoryEmojis,r=e.categoryConfig,n=e.topOffset,a=e.onHeightReady,s=e.scrollTop,i=C$(),l=i[0],c=jpt({categoryEmojis:t,topOffset:n,onHeightReady:a,scrollTop:s,isCategoryVisible:l.includes(r.category)}),u=c.virtualizedCounter,d=c.emojis,f=c.dimensions;return w.createElement(Ept,{categoryConfig:r,height:f?.categoryHeight,hidden:!d.length&&u===0},d)}var Dpt=Dn.create({emojiList:{".":Mr.emojiList,listStyle:"none",margin:"0",padding:"0"}}),Lpt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI1MHB4IgoJIGhlaWdodD0iMTVweCIgdmlld0JveD0iMCAwIDUwIDE1IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1MCAxNSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxnIGlkPSJMYXllcl8xIj4KPC9nPgo8ZyBpZD0iTGF5ZXJfMiI+Cgk8cGF0aCBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiNFOEU3RTciIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KCTxwYXRoIGZpbGw9IiMwMTAyMDIiIHN0cm9rZT0iIzE1MTYxNyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMjYuODYtMC40M2w5LjgzLDExLjUzYzAuNTksMC42OSwxLjU2LDAuNjksMi4xNCwwbDkuODMtMTEuNTMiLz4KPC9nPgo8L3N2Zz4=",Hp;(function(e){e[e.Up=0]="Up",e[e.Down=1]="Down"})(Hp||(Hp={}));function Opt(){var e=nE(),t=bmt(),r=k0(),n=r[0],a=cm(),s=Rpt(t),i=s.getTop,l=s.getMenuDirection,c=Zve(),u=Ipt(t),d=um(),f=Jo(e.current),m=!!(n&&f&&S0(n)&&f.classList.contains(Mr.emojiHasVariations));w.useEffect(function(){m&&sE(t.current)},[t,m,e]);var p,v;return!m&&e.current?c(null):(p=i(),v=u()),w.createElement("div",{ref:t,className:_r(ek.variationPicker,l()===Hp.Down&&ek.pointingUp,m&&ek.visible),style:{top:p}},m&&n?[El(n)].concat(X2(n)).slice(0,6).map(function(b){return w.createElement(lE,{key:b,emoji:n,unified:b,emojiStyle:a,showVariations:!1,getEmojiUrl:d})}):null,w.createElement("div",{className:_r(ek.pointer),style:v}))}function Ipt(e){var t=nE();return function(){var n={};if(!e.current)return n;if(t.current){var a=Jo(t.current),s=ipt(a);if(!a)return n;n.left=s+a?.clientWidth/2}return n}}function Rpt(e){var t=nE(),r=Ui(),n=Hp.Up;return{getMenuDirection:a,getTop:s};function a(){return n}function s(){n=Hp.Up;var i=0;if(!e.current)return 0;var l=Xte(e.current);if(t.current){var c,u=r.current,d=Jo(t.current),f=Xte(d);i=dbe(d);var m=(c=u?.scrollTop)!=null?c:0;m>i-l&&(n=Hp.Down,i+=f+l)}return i-l}}var ek=Dn.create(pn({variationPicker:{".":Mr.variationPicker,position:"absolute",right:"15px",left:"15px",padding:"5px",boxShadow:"0px 2px 5px rgba(0, 0, 0, 0.2)",borderRadius:"3px",display:"flex",alignItems:"center",justifyContent:"space-around",opacity:"0",visibility:"hidden",pointerEvents:"none",top:"-100%",border:"1px solid var(--epr-picker-border-color)",height:"var(--epr-emoji-variation-picker-height)",zIndex:"var(--epr-skin-variation-picker-z-index)",background:"var(--epr-emoji-variation-picker-bg-color)",transform:"scale(0.9)",transition:"transform 0.1s ease-out, opacity 0.2s ease-out"},visible:{opacity:"1",visibility:"visible",pointerEvents:"all",transform:"scale(1)"},pointingUp:{".":"pointing-up",transformOrigin:"center 0%",transform:"scale(0.9)"},".pointing-up":{pointer:{top:"0",transform:"rotate(180deg) translateY(100%) translateX(18px)"}},pointer:{".":"epr-emoji-pointer",content:"",position:"absolute",width:"25px",height:"15px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"50px 15px",top:"100%",transform:"translateX(-18px)",backgroundImage:"url("+Lpt+")"}},zd("pointer",{backgroundPosition:"-25px 0"})));function Ppt(){var e=Ui(),t=wpt(e);return kbe(e,Sx.PICKER),Tmt(),w.createElement("div",{className:_r(zpt.body,im.hiddenOnReactions),ref:e},w.createElement(Opt,null),w.createElement(Tpt,{scrollTop:t}))}var zpt=Dn.create({body:{".":Mr.scrollBody,flex:"1",overflowY:"scroll",overflowX:"hidden",position:"relative"}});function Bpt(e,t){if(!e||!t)return 0;var r=e.getBoundingClientRect(),n=t.getBoundingClientRect();return n.height-(r.y-n.y)}function $pt(e,t){var r=Ui(),n=rbe(),a=tbe();w.useEffect(function(){if(!e)return;var s=r.current;s?.addEventListener("keydown",c,{passive:!0}),s?.addEventListener("mouseover",u,!0),s?.addEventListener("focus",i,!0),s?.addEventListener("mouseout",l,{passive:!0}),s?.addEventListener("blur",l,!0);function i(d){var f=Jo(d.target);if(!f)return l();var m=gbe(f),p=m.unified,v=m.originalUnified;if(!p||!v)return l();t({unified:p,originalUnified:v})}function l(d){if(d){var f=d.relatedTarget;if(!Jo(f))return t(null)}t(null)}function c(d){d.key==="Escape"&&t(null)}function u(d){if(!n()){var f=Jo(d.target);if(f){var m=Bpt(f,s),p=f.getBoundingClientRect().height;if(m<p)return Fpt(f,t);Fi(f)}}}return function(){s?.removeEventListener("mouseover",u),s?.removeEventListener("mouseout",l),s?.removeEventListener("focus",i,!0),s?.removeEventListener("blur",l,!0),s?.removeEventListener("keydown",c)}},[r,e,t,n,a])}function Fpt(e,t){var r,n=gbe(e),a=n.unified,s=n.originalUnified;!a||!s||((r=document.activeElement)==null||r.blur==null||r.blur(),t({unified:a,originalUnified:s}))}var tk,Nx;(function(e){e.ROW="FlexRow",e.COLUMN="FlexColumn"})(Nx||(Nx={}));function _be(e){var t=e.children,r=e.className,n=e.style,a=n===void 0?{}:n,s=e.direction,i=s===void 0?Nx.ROW:s;return w.createElement("div",{style:pn({},a),className:_r(sre.flex,r,sre[i])},t)}var sre=Dn.create((tk={flex:{display:"flex"}},tk[Nx.ROW]={flexDirection:"row"},tk[Nx.COLUMN]={flexDirection:"column"},tk));function Upt(e){var t=e.className,r=e.style,n=r===void 0?{}:r;return w.createElement("div",{style:pn({flex:1},n),className:_r(t)})}function Hpt(e){var t=e.children,r=e.className,n=e.style;return w.createElement("div",{style:pn({},n,{position:"absolute"}),className:r},t)}function cE(e){var t=e.children,r=e.className,n=e.style;return w.createElement("div",{style:pn({},n,{position:"relative"}),className:r},t)}function qpt(e){var t=e.isOpen,r=e.onClick,n=e.isActive,a=e.skinToneVariation,s=e.style;return w.createElement(L1,{style:s,onClick:r,className:_r("epr-tone-"+a,eO.tone,!t&&eO.closedTone,n&&eO.active),"aria-pressed":n,"aria-label":"Skin tone "+xht[a]})}var eO=Dn.create({closedTone:{opacity:"0",zIndex:"0"},active:{".":"epr-active",zIndex:"1",opacity:"1"},tone:{".":"epr-tone",width:"var(--epr-skin-tone-size)",display:"block",cursor:"pointer",borderRadius:"4px",height:"var(--epr-skin-tone-size)",position:"absolute",right:"0",transition:"transform 0.3s ease-in-out, opacity 0.35s ease-in-out",zIndex:"0",border:"1px solid var(--epr-skin-tone-outer-border-color)",boxShadow:"inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)",":hover":{boxShadow:"0 0 0 3px var(--epr-active-skin-hover-color), inset 0px 0px 0 1px var(--epr-skin-tone-inner-border-color)"},":focus":{boxShadow:"0 0 0 3px var(--epr-focus-bg-color)"},"&.epr-tone-neutral":{backgroundColor:"#ffd225"},"&.epr-tone-1f3fb":{backgroundColor:"#ffdfbd"},"&.epr-tone-1f3fc":{backgroundColor:"#e9c197"},"&.epr-tone-1f3fd":{backgroundColor:"#c88e62"},"&.epr-tone-1f3fe":{backgroundColor:"#a86637"},"&.epr-tone-1f3ff":{backgroundColor:"#60463a"}}}),Nb=28;function Wpt(){return w.createElement(cE,{style:{height:Nb}},w.createElement(Hpt,{style:{bottom:0,right:0}},w.createElement(Nbe,{direction:Cx.VERTICAL})))}function Nbe(e){var t=e.direction,r=t===void 0?Cx.HORIZONTAL:t,n=M$(),a=Fve(),s=D1(),i=s[0],l=s[1],c=tE(),u=c[0],d=c[1],f=omt(),m=dm(),p=fm();if(a)return null;var v=Nb*MC.length+"px",b=i?v:Nb+"px",y=r===Cx.VERTICAL;return w.createElement(cE,{className:_r(qv.skinTones,y&&qv.vertical,i&&qv.open,y&&i&&qv.verticalShadow),style:y?{flexBasis:b,height:b}:{flexBasis:b}},w.createElement("div",{className:_r(qv.select),ref:n},MC.map(function(S,_){var N=S===u;return w.createElement(qpt,{key:S,skinToneVariation:S,isOpen:i,style:{transform:_r(y?"translateY(-"+_*(i?Nb:0)+"px)":"translateX(-"+_*(i?Nb:0)+"px)",i&&N&&"scale(1.3)")},isActive:N,onClick:function(){i?(d(S),f(S),p()):l(!0),m()}})})))}var Cx;(function(e){e.VERTICAL="epr-vertical",e.HORIZONTAL="epr-horizontal"})(Cx||(Cx={}));var qv=Dn.create({skinTones:{".":"epr-skin-tones","--":{"--epr-skin-tone-size":"15px"},display:"flex",alignItems:"center",justifyContent:"flex-end",transition:"all 0.3s ease-in-out",padding:"10px 0"},vertical:{padding:"9px",alignItems:"flex-end",flexDirection:"column",borderRadius:"6px",border:"1px solid var(--epr-bg-color)"},verticalShadow:{boxShadow:"0px 0 7px var(--epr-picker-border-color)"},open:{backdropFilter:"blur(5px)",background:"var(--epr-skin-tone-picker-menu-color)",".epr-active":{border:"1px solid var(--epr-active-skin-tone-indicator-border-color)"}},select:{".":"epr-skin-tone-select",position:"relative",width:"var(--epr-skin-tone-size)",height:"var(--epr-skin-tone-size)"}});function Kpt(){var e=Uve(),t=ibe(),r=lm(),n=r[0];return e.showPreview?w.createElement(_be,{className:_r(ry.preview,im.hiddenOnReactions,n&&ry.hideOnReactions)},w.createElement(Gpt,null),w.createElement(Upt,null),t?w.createElement(Wpt,null):null):null}function Gpt(){var e,t=Uve(),r=w.useState(null),n=r[0],a=r[1],s=cm(),i=k0(),l=i[0],c=um(),u=A1(),d=u.emojiByUnified;$pt(t.showPreview,a);var f=d((e=n?.unified)!=null?e:n?.originalUnified),m=f!=null&&n!=null;return w.createElement(p,null);function p(){var v=l??d(t.defaultEmoji);if(!v)return null;var b=l?Gte(l):t.defaultCaption;return w.createElement(w.Fragment,null,w.createElement("div",null,m?w.createElement(m5,{unified:n?.unified,emoji:f,emojiStyle:s,size:45,getEmojiUrl:c,className:_r(ry.emoji)}):v?w.createElement(m5,{unified:El(v),emoji:v,emojiStyle:s,size:45,getEmojiUrl:c,className:_r(ry.emoji)}):null),w.createElement("div",{className:_r(ry.label)},m?Gte(f):b))}}var ry=Dn.create({preview:{alignItems:"center",borderTop:"1px solid var(--epr-preview-border-color)",height:"var(--epr-preview-height)",padding:"0 var(--epr-horizontal-padding)",position:"relative",zIndex:"var(--epr-preview-z-index)"},label:{color:"var(--epr-preview-text-color)",fontSize:"var(--epr-preview-text-size)",padding:"var(--epr-preview-text-padding)",textTransform:"capitalize"},emoji:{padding:"0"},hideOnReactions:{opacity:"0",transition:"opacity 0.5s ease-in-out"}});function Vpt(e){var t;return(t=e?.getAttribute("data-name"))!=null?t:null}function Ypt(e){var t=e.setActiveCategory,r=e.setVisibleCategories,n=Ui();w.useEffect(function(){var a=new Map,s=new Map,i=n.current,l=new IntersectionObserver(function(c){if(i){for(var u=uht(c),d;!(d=u()).done;){var f=d.value,m=Vpt(f.target);m&&(a.set(m,f.intersectionRatio),s.set(m,f.isIntersecting))}var p=Array.from(a),v=p.filter(function(j){var E=j[0],T=j[1];return T>0||s.get(E)}).map(function(j){var E=j[0];return E});r(v);var b=p[p.length-1];if(b?.[1]==1)return t(b[0]);for(var y=0,S=p;y<S.length;y++){var _=S[y],N=_[0],k=_[1];if(k){t(N);break}}}},{root:i,threshold:[0,1]});return i?.querySelectorAll(Co(Mr.category)).forEach(function(c){l.observe(c)}),function(){l.disconnect()}},[n,t,r])}function Qpt(){var e=Ui(),t=_0();return function(n){var a;if(e.current){var s=(a=e.current)==null?void 0:a.querySelector('[data-name="'+n+'"]');if(s){var i=s.offsetTop||0;Xve(t.current,i)}}}}function Jpt(){var e=amt();return e?e.length===0:!1}var Zpt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMDBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgMjAwIDgwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyMDAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8ZyBpZD0iTGF5ZXJfMTEiPgoJPGc+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTIuOCwyOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjEtMS4yYy0wLjYsMC0xLjIsMC41LTEuMiwxLjJDMTEuNiwyOSwxMi4yLDI5LjUsMTIuOCwyOS41eiBNMTIuOCwyOGMwLjIsMCwwLjQsMC4yLDAuNCwwLjQKCQkJYzAsMC4yLTAuMiwwLjQtMC40LDAuNGMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzEyLjQsMjguMSwxMi42LDI4LDEyLjgsMjh6Ii8+CgkJPHBhdGggZmlsbD0iIzMzNzFCNyIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsMjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNywyNi4yLDEzLjgsMjMsMTAsMjN6IE0xMCwzNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiwzMy40LDEzLjQsMzYuMiwxMCwzNi4yeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsMzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDMxLjUsMTQuNywzMS4zLDE0LjYsMzEuMnogTTEwLDM0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywzMy4yLDExLjYsMzQuMSwxMCwzNC4xeiIvPgoJCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiwyOS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDI5LDYuNiwyOS41LDcuMiwyOS41eiBNNy4yLDI4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDI4LjEsNywyOCw3LjIsMjh6Ii8+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjQuMSwzMy40bDIuMywwYzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjMKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40di0yLjFDNjMuNywzMy42LDYzLjgsMzMuNCw2NC4xLDMzLjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTczLjUsMzMuNWgyLjRjMC4yLDAsMC40LDAuMiwwLjQsMC40djJjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMkM3My4xLDMzLjYsNzMuMywzMy41LDczLjUsMzMuNXoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNNjMuNywyOC40aDEyLjZ2NUg2My43VjI4LjR6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTY1LjUsMjMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN3YtMy4xQzYzLjcsMjQuNSw2NC41LDIzLjYsNjUuNSwyMy42eiIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNjYuMiIgY3k9IjMwLjkiIHJ4PSIwLjkiIHJ5PSIxIi8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSI3My44IiBjeT0iMzAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNOTYuNCwzMGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCwyNi40LDk2LjQsMzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTk2LjMsMjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4xYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xYy0wLjEtMC4xLTAuMS0wLjEtMC4xLTAuMmMwLjUtMC4xLDEuMi0wLjIsMi0wLjFjMS4yLDAsMi41LDAuMywzLjUsMS4xYzEsMC44LDEuNywxLjgsMi4xLDIuOAoJCQkJQzk2LjEsMjcuOSw5Ni4yLDI4LjMsOTYuMywyOC42eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik04NCwzMi4yYzAsMCwwLTAuMSwwLTAuMWMwLjktMC4yLDIuOS0wLjQsNC43LDAuNmMxLjEsMC43LDEuOSwxLjUsMi40LDIuMwoJCQkJYzAuNCwwLjUsMC42LDEsMC43LDEuM2MtMC40LDAuMS0xLDAuMi0xLjcsMC4zYy0xLDAtMi4xLTAuMS0zLjItMC44cy0xLjktMS42LTIuNC0yLjVDODQuMiwzMi44LDg0LjEsMzIuNSw4NCwzMi4yeiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTExNi4zLDI2LjhsLTEuNCwybC0wLjgtMC44bC0wLjYtMC42bDAsMC45bC0wLjEsOC4yaC02LjgKCQkJCWwtMC4xLTguMmwwLTAuOWwtMC42LDAuNmwtMC44LDAuOGwtMS40LTJsMi42LTIuOWMwLjEtMC4xLDAuMi0wLjEsMC4zLTAuMWgxLjNsMC40LDAuN2MwLjcsMS4zLDIuNiwxLjMsMy4zLTAuMWwwLjMtMC42aDEuMgoJCQkJYzAuMSwwLDAuMiwwLDAuMywwLjFsMC4zLTAuM2wtMC4zLDAuM0wxMTYuMywyNi44eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMTAuMSwyNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDI3LjdMMTEwLjEsMjcuN3oiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMTI2LjgsMzQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMzMuMSwxMjYuOCwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNiwzNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDMyLjEsMTM3LjYsMzMuMSwxMzcuNiwzNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMzcuNywyNC40djkuOSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIGQ9Ik0xMjYuOCwyMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDI2LjIsMTI2LjgsMjMuNSwxMjYuOCwyMy41eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSIjMzM3MUI3IiBkPSJNMTcwLjgsMjMuMUwxNzAuOCwyMy4xYy0wLjMsMC0wLjUsMC0wLjgsMGMtMi4xLDAtNCwxLTUuMywyLjVsLTAuMSwwbC0wLjEtMC4xbC0xLTEuMmwtMC4zLDMuNGwzLjQsMC4zCgkJCQlsLTEuMS0xLjNsLTAuMS0wLjFsMC4xLTAuMWMxLjEtMS41LDMtMi4zLDUtMi4xbDAsMGMzLjIsMC4zLDUuNSwzLjEsNS4yLDYuM2MtMC4zLDMtMy4xLDUuMy02LjEsNS4xYy0zLjEtMC4yLTUuNC0yLjktNS4zLTYKCQkJCWwtMS4zLTAuMWMtMC4yLDMuOCwyLjYsNy4xLDYuMyw3LjRjMy45LDAuMyw3LjMtMi42LDcuNi02LjVDMTc3LjIsMjYuOCwxNzQuNCwyMy41LDE3MC44LDIzLjF6Ii8+CgkJCTxwYXRoIGZpbGw9IiMzMzcxQjciIGQ9Ik0xNzAuMywyNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNnMtMC42LDAuMy0wLjYsMC42djMuMmMwLDAuMiwwLjEsMC4zLDAuMiwwLjRjMC4xLDAuMSwwLjMsMC4yLDAuNCwwLjIKCQkJCWgyLjRjMC40LDAsMC42LTAuMywwLjYtMC42YzAtMC40LTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJ2LTAuMkwxNzAuMywyNy40TDE3MC4zLDI3LjR6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTE4Ni4yLDIzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43di03LjdDMTgzLjQsMjQuNiwxODQuNywyMy40LDE4Ni4yLDIzLjR6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxODYiIGN5PSIyOC45IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiMzMzcxQjciIGN4PSIxOTQiIGN5PSIyNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDMzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KCTxwYXRoIGZpbGw9IiMzMzcxQjciIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLXdpZHRoPSIwLjI1IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNTYsMjQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgkJYzAsMC0wLjIsMC4xLTAuOSwwLjJjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMC44LTAuMy0xLjctMC41LTIuNS0wLjVjLTAuMiwwLTAuNCwwLTAuNSwwYy0xLjMsMC0yLjUsMC4zLTMuNiwxCgkJYy0wLjIsMC4xLTAuMiwwLjItMC4yLDAuNHYxMS42YzAsMC4zLDAuMSwwLjUsMC4zLDAuNWMwLjYsMCwwLjUtMC40LDAuNS0wLjZ2LTUuN2MwLjctMC4zLDMuMi0xLjEsNS44LTAuMQoJCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjR2LTUuN0MxNTYuMiwyNC42LDE1Ni4xLDI0LjQsMTU2LDI0LjN6IE0xNTUuNiwzMC4yCgkJYy0wLjEsMC0wLjcsMC4xLTEsMC4xYy0wLjcsMC0yLjQtMC4xLTMuOC0wLjZjLTIuNS0xLTUtMC41LTYuMi0wLjF2LTQuOWMwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMAoJCWMwLjcsMCwxLjUsMC4yLDIuMiwwLjRjMS42LDAuNiwzLjUsMC43LDQuMywwLjdjMC4yLDAsMC44LDAsMS0wLjFWMzAuMnoiLz4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgZD0iTTQ4LjEsMjMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCUM0My42LDI1LjUsNDUuNiwyMy41LDQ4LjEsMjMuNXoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMjguOGMtMC4yLDAuMS0wLjUsMS4yLDAsMS41YzEuNCwxLDguNSwwLjgsMTEuMywwLjYKCQkJYzAuOC0wLjEsMS42LTAuNCwxLjctMS4yYzAtMC4zLTAuMS0wLjYtMC42LTAuOSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMC42TDQzLjMsMzFjLTAuMiwwLjUsMC4yLDEsMC43LDAuOWMwLjMtMC4xLDAuNSwwLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMiwwbDAuMi0wLjFjMC4zLTAuMiwwLjgtMC4yLDEuMSwwLjFsMC4yLDAuMmMwLjMsMC4zLDAuOCwwLjIsMS0wLjJsMC4xLTAuMmMwLjEtMC4yLDAtMC4zLDAuMi0wLjMKCQkJYzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMi4yYy0wLjEsMC4yLTAuMywwLjgsMCwxLjFjMC4zLDAuNCwzLDEuMSw2LjQsMS4xCgkJCWMyLjIsMCw0LjYtMC4zLDYtMC42YzAuNS0wLjEsMC45LTAuNSwwLjgtMC45YzAtMC4yLTAuMi0wLjUtMC40LTAuNyIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwzMy4zYzAsMC41LDAuNiwyLjMsMS4zLDIuN2MxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQljMS4zLTAuMSwyLjUtMC43LDMuMi0xLjhjMC4zLTAuNSwwLjUtMSwwLjUtMS40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUxLjYiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUzIiBjeT0iMjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjMzM3MUI3IiBjeD0iNTMiIGN5PSIyNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjU0LjMiIGN5PSIyNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjUwLjkiIGN5PSIyNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJPC9nPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBkPSJNMjQuMiwzMXYtNy42YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjYsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDMyLjksMjQuMiwzMiwyNC4yLDMxeiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiwzMGw1LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzM3MUI3IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDM0LjFsNS40LTEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzMGwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzNzFCNyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCwzNC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMzMzcxQjciIGQ9Ik0yOS41LDMyLjRMMjksMzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVzMC40LDAsMC41LDAuMmwwLjEsMC4yCgkJCUMyOC4zLDMyLjgsMjkuMSwzMi45LDI5LjUsMzIuNHoiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMzMzcxQjciIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTMyLjQsMzIuMWwtMC4xLDAuMmMtMC40LDEtMS44LDEuMS0yLjMsMC4yIi8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjI3LjYiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJPGVsbGlwc2UgZmlsbD0iIzMzNzFCNyIgY3g9IjMyLjQiIGN5PSIyOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xMi44LDQ5LjVjMC42LDAsMS4xLTAuNSwxLjEtMS4xCgkJCWMwLTAuNi0wLjUtMS4yLTEuMS0xLjJjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMkMxMS42LDQ5LDEyLjIsNDkuNSwxMi44LDQ5LjV6IE0xMi44LDQ4YzAuMiwwLDAuNCwwLjIsMC40LDAuNAoJCQljMCwwLjItMC4yLDAuNC0wLjQsMC40Yy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDMTIuNCw0OC4xLDEyLjYsNDgsMTIuOCw0OHoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik0xNC42LDUxLjJjLTAuMS0wLjEtMC4yLTAuMi0wLjMtMC4ySDUuNwoJCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNyw1MS41LDE0LjcsNTEuMywxNC42LDUxLjJ6IE0xMCw1NC4xCgkJCWMtMS42LDAtMy0wLjktMy43LTIuMmg3LjNDMTMsNTMuMiwxMS42LDU0LjEsMTAsNTQuMXoiLz4KCQk8cGF0aCBmaWxsPSIjQzBDMEJGIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS13aWR0aD0iMC4xIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGQ9Ik03LjIsNDkuNWMwLjYsMCwxLjItMC41LDEuMi0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4yLTEuMmMtMC42LDAtMS4xLDAuNS0xLjEsMS4yQzYuMSw0OSw2LjYsNDkuNSw3LjIsNDkuNXogTTcuMiw0OGMwLjIsMCwwLjQsMC4yLDAuNCwwLjRjMCwwLjItMC4yLDAuNC0wLjQsMC40CgkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40QzYuOCw0OC4xLDcsNDgsNy4yLDQ4eiIvPgoJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEwLDQzYy0zLjgsMC03LDMuMS03LDdjMCwzLjgsMy4xLDcsNyw3CgkJCXM3LTMuMSw3LTdDMTcsNDYuMiwxMy44LDQzLDEwLDQzeiBNMTAsNTYuMmMtMy40LDAtNi4yLTIuOC02LjItNi4yYzAtMy40LDIuOC02LjIsNi4yLTYuMnM2LjIsMi44LDYuMiw2LjIKCQkJQzE2LjIsNTMuNCwxMy40LDU2LjIsMTAsNTYuMnoiLz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02NC4xLDUzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDUzLjYsNjMuOCw1My40LDY0LjEsNTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNzMuNSw1My41aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2MmMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuNAoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRsMC0yQzczLjEsNTMuNiw3My4zLDUzLjUsNzMuNSw1My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik02My43LDQ4LjRoMTIuNnY1SDYzLjdWNDguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNjUuNSw0My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw0NC41LDY0LjUsNDMuNiw2NS41LDQzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI2Ni4yIiBjeT0iNTAuOSIgcng9IjAuOSIgcnk9IjEiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjczLjgiIGN5PSI1MC45IiByeD0iMC45IiByeT0iMSIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik05Ni40LDUwYzAsMy42LTIuOSw2LjUtNi40LDYuNXMtNi40LTIuOS02LjQtNi41czIuOS02LjUsNi40LTYuNVM5Ni40LDQ2LjQsOTYuNCw1MHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNOTYuMyw0OC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw0Ny45LDk2LjIsNDguMyw5Ni4zLDQ4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTg0LDUyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDUyLjgsODQuMSw1Mi41LDg0LDUyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNDYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDQ2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTExMC4xLDQ3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNDcuN0wxMTAuMSw0Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0xMjYuOCw1NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw1My4xLDEyNi44LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy42LDU0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNTIuMSwxMzcuNiw1My4xLDEzNy42LDU0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEzNy43LDQ0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgZD0iTTEyNi44LDQzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNDYuMiwxMjYuOCw0My41LDEyNi44LDQzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiNDMEMwQkYiIGQ9Ik0xNzAuOCw0My4xTDE3MC44LDQzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjUsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw0Ni44LDE3NC40LDQzLjUsMTcwLjgsNDMuMXoiLz4KCQkJPHBhdGggZmlsbD0iI0MwQzBCRiIgZD0iTTE3MC4zLDQ3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZjMC0wLjMtMC4zLTAuNi0wLjYtMC42aC0xLjZoLTAuMnYtMC4yTDE3MC4zLDQ3LjRMMTcwLjMsNDcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNMTg2LjIsNDMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw0NC43LDE4NC43LDQzLjQsMTg2LjIsNDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE4NiIgY3k9IjQ4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iI0MwQzBCRiIgY3g9IjE5NCIgY3k9IjQ2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNTMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iI0MwQzBCRiIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw0NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDQ0LjYsMTU2LjEsNDQuNCwxNTYsNDQuM3ogTTE1NS42LDUwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY1MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBkPSJNNDguMSw0My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNDUuNSw0NS42LDQzLjUsNDguMSw0My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw0OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDEsOC41LDAuOCwxMS4zLDAuNgoJCQljMC44LTAuMSwxLjYtMC40LDEuNy0xLjJjMC0wLjMtMC4xLTAuNi0wLjYtMC45Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUwLjZMNDMuMyw1MWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45YzAuMy0wLjEsMC41LDAsMC43LDAuMwoJCQlsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjIsMC44LDAuMSwxLjIsMGwwLjUtMC4yYzAuNC0wLjIsMC45LTAuMiwxLjMsMGwwLjUsMC4yCgkJCWMwLjQsMC4yLDAuOCwwLjIsMS4yLDBsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC41LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDUzLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTEuNiIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTMiIGN5PSI0NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiNDMEMwQkYiIGN4PSI1MyIgY3k9IjQ3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTQuMyIgY3k9IjQ2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iNTAuOSIgY3k9IjQ1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIGQ9Ik0yNC4yLDUxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNTIuOSwyNC4yLDUyLDI0LjIsNTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDUwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNDMEMwQkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsNTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDUwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjQzBDMEJGIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDU0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTI5LjUsNTIuNEwyOSw1MS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNTIuOCwyOS4xLDUyLjksMjkuNSw1Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0MwQzBCRiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw1Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMjcuNiIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjQzBDMEJGIiBjeD0iMzIuNCIgY3k9IjQ5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KCTxnPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE0LjYsNzEuMmMtMC4xLTAuMS0wLjItMC4yLTAuMy0wLjJINS43CgkJCWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4yYy0wLjEsMC4xLTAuMSwwLjIsMCwwLjRjMC43LDIsMi41LDMuMyw0LjYsMy4zczMuOS0xLjMsNC42LTMuM0MxNC43LDcxLjUsMTQuNyw3MS4zLDE0LjYsNzEuMnogTTEwLDc0LjEKCQkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMyw3My4yLDExLjYsNzQuMSwxMCw3NC4xeiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsNjkuNWMwLjYsMCwxLjEtMC41LDEuMS0xLjEKCQkJYzAtMC42LTAuNS0xLjItMS4xLTEuMmMtMC42LDAtMS4yLDAuNS0xLjIsMS4yQzExLjYsNjksMTIuMiw2OS41LDEyLjgsNjkuNXogTTEyLjgsNjhjMC4yLDAsMC40LDAuMiwwLjQsMC40CgkJCWMwLDAuMi0wLjIsMC40LTAuNCwwLjRjLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDY4LjEsMTIuNiw2OCwxMi44LDY4eiIvPgoJCTxwYXRoIGZpbGw9IiM2QUE5REQiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw2OS41YzAuNiwwLDEuMi0wLjUsMS4yLTEuMQoJCQljMC0wLjYtMC41LTEuMi0xLjItMS4yYy0wLjYsMC0xLjEsMC41LTEuMSwxLjJDNi4xLDY5LDYuNiw2OS41LDcuMiw2OS41eiBNNy4yLDY4YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjRDNi44LDY4LjEsNyw2OCw3LjIsNjh6Ii8+CgkJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsNjNjLTMuOCwwLTcsMy4xLTcsN2MwLDMuOCwzLjEsNyw3LDcKCQkJczctMy4xLDctN0MxNyw2Ni4yLDEzLjgsNjMsMTAsNjN6IE0xMCw3Ni4yYy0zLjQsMC02LjItMi44LTYuMi02LjJjMC0zLjQsMi44LTYuMiw2LjItNi4yczYuMiwyLjgsNi4yLDYuMgoJCQlDMTYuMiw3My40LDEzLjQsNzYuMiwxMCw3Ni4yeiIvPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTY0LjEsNzMuNGwyLjMsMGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi4zCgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNHYtMi4xQzYzLjcsNzMuNiw2My44LDczLjQsNjQuMSw3My40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik03My41LDczLjVoMi40YzAuMiwwLDAuNCwwLjIsMC40LDAuNHYyLjFjMCwwLjItMC4yLDAuNC0wLjQsMC40aC0yLjQKCQkJCWMtMC4yLDAtMC40LTAuMi0wLjQtMC40bDAtMi4xQzczLjEsNzMuNiw3My4zLDczLjUsNzMuNSw3My41eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik02My43LDY4LjRoMTIuNnY1SDYzLjdWNjguNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNjUuNSw2My42aDguOWMxLDAsMS45LDAuOCwxLjksMS45djMuMUg2My43di0zLjFDNjMuNyw2NC41LDY0LjUsNjMuNiw2NS41LDYzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI2Ni4yIiBjeT0iNzAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNzMuOCIgY3k9IjcwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNOTYuNCw3MGMwLDMuNi0yLjksNi41LTYuNCw2LjVzLTYuNC0yLjktNi40LTYuNXMyLjktNi41LDYuNC02LjVTOTYuNCw2Ni40LDk2LjQsNzB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTk2LjMsNjguNmMwLDAsMCwwLjEsMCwwLjFjLTAuOSwwLjEtMi45LDAuMS00LjYtMS4yYy0xLjEtMC44LTItMS43LTIuNi0yLjUKCQkJCWMtMC4zLTAuNC0wLjYtMC44LTAuNy0xLjFjLTAuMS0wLjEtMC4xLTAuMi0wLjEtMC4yYzAuNS0wLjEsMS4yLTAuMiwyLTAuMmMxLjIsMCwyLjUsMC4zLDMuNSwxLjFjMSwwLjgsMS43LDEuOCwyLjEsMi44CgkJCQlDOTYuMSw2Ny45LDk2LjIsNjguMyw5Ni4zLDY4LjZ6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTg0LDcyLjJjMCwwLDAtMC4xLDAtMC4xYzAuOS0wLjIsMi45LTAuNCw0LjcsMC42YzEuMSwwLjcsMS45LDEuNSwyLjQsMi4zCgkJCQljMC40LDAuNSwwLjYsMSwwLjcsMS4zYy0wLjQsMC4xLTEsMC4yLTEuNywwLjNjLTEsMC0yLjEtMC4xLTMuMi0wLjhzLTEuOS0xLjYtMi40LTIuNUM4NC4yLDcyLjgsODQuMSw3Mi40LDg0LDcyLjJ6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNjYuOGwtMS40LDJsLTAuOC0wLjhsLTAuNi0wLjdsMCwwLjlsLTAuMSw4LjJoLTYuOAoJCQkJbC0wLjEtOC4ybDAtMC45bC0wLjYsMC43bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDY2Ljh6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTExMC4xLDY3LjdoMnYwLjljMCwwLjQtMC40LDAuNy0xLDAuN2MtMC42LDAtMS0wLjMtMS0wLjdMMTEwLjEsNjcuN0wxMTAuMSw2Ny43eiIvPgoJCTwvZz4KCTwvZz4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0xMjYuOCw3NC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJzLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMlMxMjYuOCw3My4xLDEyNi44LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy42LDc0LjNjMCwxLjItMSwyLjItMi4yLDIuMmMtMS4yLDAtMi4yLTEtMi4yLTIuMnMxLTIuMiwyLjItMi4yCgkJCQlDMTM2LjYsNzIuMSwxMzcuNiw3My4xLDEzNy42LDc0LjN6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEzNy43LDY0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgZD0iTTEyNi44LDYzLjVoMTAuOHYyLjdoLTEwLjhDMTI2LjgsNjYuMiwxMjYuOCw2My41LDEyNi44LDYzLjV6Ii8+CgkJPC9nPgoJPC9nPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xNzAuOCw2My4xTDE3MC44LDYzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJbC0xLjMtMC4xYy0wLjIsMy44LDIuNiw3LjEsNi4zLDcuNGMzLjksMC4zLDcuMy0yLjYsNy42LTYuNUMxNzcuMiw2Ni44LDE3NC40LDYzLjUsMTcwLjgsNjMuMXoiLz4KCQkJPHBhdGggZmlsbD0iIzZBQTlERCIgZD0iTTE3MC4zLDY3LjRjMC0wLjMtMC4zLTAuNi0wLjYtMC42cy0wLjYsMC4zLTAuNiwwLjZ2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZTMTcyLjQsNzAsMTcyLDcwaC0xLjZoLTAuMnYtMC4yTDE3MC4zLDY3LjRMMTcwLjMsNjcuNHoiLz4KCQk8L2c+Cgk8L2c+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNMTg2LjIsNjMuNGg3LjdjMS41LDAsMi43LDEuMiwyLjcsMi43djcuN2MwLDEuNS0xLjIsMi43LTIuNywyLjdoLTcuNwoJCQkJYy0xLjUsMC0yLjctMS4yLTIuNy0yLjd2LTcuN0MxODMuNCw2NC43LDE4NC43LDYzLjQsMTg2LjIsNjMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE4NiIgY3k9IjY4LjkiIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzZBQTlERCIgY3g9IjE5NCIgY3k9IjY2LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0xODYsNzMuM2wwLjQtMC4zYzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLDAuNAoJCQkJYzAuNSwwLjIsMSwwLjIsMS41LTAuMWwwLjgtMC41YzAuNC0wLjMsMS0wLjMsMS41LTAuMWwxLjgsMC44Ii8+CgkJPC9nPgoJPC9nPgoJPHBhdGggZmlsbD0iIzZBQTlERCIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2Utd2lkdGg9IjAuMjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTE1Niw2NC4zYy0wLjItMC4xLTAuNC0wLjEtMC41LDAKCQljMCwwLTAuMiwwLjEtMC45LDAuMmMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCQljLTAuMiwwLjEtMC4yLDAuMi0wLjIsMC40djExLjZjMCwwLjMsMC4xLDAuNSwwLjMsMC41YzAuNiwwLDAuNS0wLjQsMC41LTAuNnYtNS43YzAuNy0wLjMsMy4yLTEuMSw1LjgtMC4xCgkJYzEuNiwwLjYsMy41LDAuNyw0LjMsMC43YzAuOCwwLDEuMy0wLjMsMS4zLTAuM2MwLjItMC4xLDAuMy0wLjIsMC4zLTAuNHYtNS43QzE1Ni4yLDY0LjYsMTU2LjEsNjQuNCwxNTYsNjQuM3ogTTE1NS42LDcwLjIKCQljLTAuMSwwLTAuNywwLjEtMSwwLjFjLTAuNywwLTIuNC0wLjEtMy44LTAuNmMtMi41LTEtNS0wLjUtNi4yLTAuMXYtNC45YzAuOS0wLjUsMi4yLTAuNywzLjItMC43YzAuMSwwLDAuMywwLDAuNCwwCgkJYzAuNywwLDEuNSwwLjIsMi4yLDAuNGMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVY3MC4yeiIvPgoJPGc+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBkPSJNNDguMSw2My41aDMuN2MyLjUsMCw0LjUsMiw0LjUsNC41YzAsMC41LTAuNCwwLjktMC45LDAuOUg0NC41Yy0wLjUsMC0wLjktMC40LTAuOS0wLjkKCQkJQzQzLjYsNjUuNSw0NS42LDYzLjUsNDguMSw2My41eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw2OC44Yy0wLjIsMC4xLTAuNSwxLjIsMCwxLjVjMS40LDAuOSw4LjUsMC44LDExLjMsMC42CgkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsNzAuNkw0My4zLDcxYy0wLjIsMC41LDAuMiwxLDAuNywwLjljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjMKCQkJbDAuMSwwLjJjMC4zLDAuNSwxLDAuNiwxLjUsMC4ybDAsMGMwLjMtMC4yLDAuNy0wLjMsMS0wLjJsMC44LDAuM2MwLjQsMC4yLDAuOCwwLjEsMS4yLDBsMC41LTAuMmMwLjQtMC4yLDAuOS0wLjIsMS4zLDBsMC41LDAuMgoJCQljMC40LDAuMiwwLjgsMC4yLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjIsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yYzAuMS0wLjIsMC0wLjMsMC4yLTAuMwoJCQljMC41LDAsMS4yLTAuMywxLjEtMC43bC0wLjQtMS4xIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDcyLjJjLTAuMSwwLjItMC4zLDAuOCwwLDEuMWMwLjMsMC40LDMsMS4xLDYuNCwxLjEKCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDczLjNjMCwwLjUsMC42LDIuMywxLjMsMi43YzEuOCwwLjgsNS43LDAuNyw4LjEsMC41CgkJCWMxLjMtMC4xLDIuNS0wLjcsMy4yLTEuOGMwLjMtMC41LDAuNS0xLDAuNS0xLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTEuNiIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTMiIGN5PSI2NSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCTxlbGxpcHNlIGZpbGw9IiM2QUE5REQiIGN4PSI1MyIgY3k9IjY3LjIiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTQuMyIgY3k9IjY2LjUiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iNTAuOSIgY3k9IjY1IiByeD0iMC4zIiByeT0iMC40Ii8+Cgk8L2c+Cgk8Zz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIGQ9Ik0yNC4yLDcxdi03LjZjMC4xLDAuMSwwLjgsMC45LDIuOCwzLjFjMi41LTEuNyw1LjYtMC43LDYuOSwwbDIuNC0zLjF2Ny4xCgkJCWMwLDEuMi0wLjEsMi41LTAuOSwzLjRjLTEsMS4yLTIuNywyLjUtNS4zLDIuNWMtMi45LDAtNC41LTEuNS01LjMtMi45QzI0LjIsNzIuOSwyNC4yLDcyLDI0LjIsNzF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNkFBOUREIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDcwLjFsNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMjEuMiw3NC4xbDUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM2QUE5REQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTM4LjgsNzAuMWwtNS40LDEuMiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzguOCw3NC4xbC01LjQtMS4yIi8+CgkJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiM2QUE5REQiIGQ9Ik0yOS41LDcyLjRMMjksNzEuN2MtMC4yLTAuMywwLTAuNiwwLjMtMC42aDEuNAoJCQljMC4zLDAsMC41LDAuNCwwLjMsMC42bC0wLjcsMWwwLDBjLTAuNywxLjItMi42LDEuMS0zLjEtMC4zbC0wLjEtMC4yYy0wLjEtMC4yLDAtMC40LDAuMi0wLjVjMC4yLTAuMSwwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsNzIuOCwyOS4xLDcyLjksMjkuNSw3Mi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzZBQTlERCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCw3Mi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMjcuNiIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCQk8ZWxsaXBzZSBmaWxsPSIjNkFBOUREIiBjeD0iMzIuNCIgY3k9IjY5LjciIHJ4PSIwLjciIHJ5PSIwLjciLz4KCTwvZz4KPC9nPgo8Zz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTEyLjgsOS41YzAuNiwwLDEuMS0wLjUsMS4xLTEuMgoJCWMwLTAuNi0wLjUtMS4xLTEuMS0xLjFjLTAuNiwwLTEuMiwwLjUtMS4yLDEuMVMxMi4yLDkuNSwxMi44LDkuNXogTTEyLjgsNy45YzAuMiwwLDAuNCwwLjIsMC40LDAuNGMwLDAuMi0wLjIsMC40LTAuNCwwLjQKCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNEMxMi40LDguMSwxMi42LDcuOSwxMi44LDcuOXoiLz4KCTxwYXRoIGZpbGw9IiM4Njg2ODYiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLXdpZHRoPSIwLjEiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTTcuMiw5LjVjMC42LDAsMS4yLTAuNSwxLjItMS4yCgkJYzAtMC42LTAuNS0xLjEtMS4yLTEuMWMtMC42LDAtMS4xLDAuNS0xLjEsMS4xUzYuNiw5LjUsNy4yLDkuNXogTTcuMiw3LjljMC4yLDAsMC40LDAuMiwwLjQsMC40YzAsMC4yLTAuMiwwLjQtMC40LDAuNAoJCUM3LDguNyw2LjgsOC41LDYuOCw4LjNDNi44LDguMSw3LDcuOSw3LjIsNy45eiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTQuNiwxMS4yYy0wLjEtMC4xLTAuMi0wLjItMC4zLTAuMkg1LjcKCQljLTAuMSwwLTAuMiwwLjEtMC4zLDAuMmMtMC4xLDAuMS0wLjEsMC4yLDAsMC40YzAuNywyLDIuNSwzLjMsNC42LDMuM3MzLjktMS4zLDQuNi0zLjNDMTQuNywxMS40LDE0LjcsMTEuMywxNC42LDExLjJ6IE0xMCwxNC4xCgkJYy0xLjYsMC0zLTAuOS0zLjctMi4yaDcuM0MxMywxMy4yLDExLjYsMTQuMSwxMCwxNC4xeiIvPgoJPHBhdGggZmlsbD0iIzg2ODY4NiIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2Utd2lkdGg9IjAuMSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTAsM2MtMy44LDAtNywzLjEtNyw3czMuMSw3LDcsN3M3LTMuMSw3LTcKCQlTMTMuOCwzLDEwLDN6IE0xMCwxNi4yYy0zLjQsMC02LjItMi44LTYuMi02LjJTNi42LDMuOCwxMCwzLjhzNi4yLDIuOCw2LjIsNi4yUzEzLjQsMTYuMiwxMCwxNi4yeiIvPgo8L2c+CjxnIGlkPSJDYXJfMDAwMDAwMTg5MzUzOTUwODU0MTM0MTM3NTAwMDAwMDA4MjUyNzM4Nzc4NDI3NzU3MTVfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NC4xLDEzLjRsMi4zLDBjMC4yLDAsMC40LDAuMiwwLjQsMC40djIuMWMwLDAuMi0wLjIsMC40LTAuNCwwLjRoLTIuMwoJCQkJYy0wLjIsMC0wLjQtMC4yLTAuNC0wLjR2LTIuMUM2My43LDEzLjYsNjMuOCwxMy40LDY0LjEsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNzMuNSwxMy40aDIuNGMwLjIsMCwwLjQsMC4yLDAuNCwwLjR2Mi4xYzAsMC4yLTAuMiwwLjQtMC40LDAuNGgtMi40CgkJCQljLTAuMiwwLTAuNC0wLjItMC40LTAuNGwwLTIuMUM3My4xLDEzLjYsNzMuMywxMy40LDczLjUsMTMuNHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNNjMuNyw4LjRoMTIuNnY1SDYzLjdWOC40eiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik02NS41LDMuNmg4LjljMSwwLDEuOSwwLjgsMS45LDEuOXYzLjFINjMuN1Y1LjVDNjMuNyw0LjQsNjQuNSwzLjYsNjUuNSwzLjZ6Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI2Ni4yIiBjeT0iMTAuOSIgcng9IjAuOSIgcnk9IjAuOSIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNzMuOCIgY3k9IjEwLjkiIHJ4PSIwLjkiIHJ5PSIwLjkiLz4KCQk8L2c+Cgk8L2c+CjwvZz4KPGcgaWQ9IkFjdGl2aXRpZXMiPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjQsMTBjMCwzLjYtMi45LDYuNS02LjQsNi41cy02LjQtMi45LTYuNC02LjVzMi45LTYuNSw2LjQtNi41Uzk2LjQsNi40LDk2LjQsMTB6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTk2LjMsOC42YzAsMCwwLDAuMSwwLDAuMWMtMC45LDAuMS0yLjksMC4xLTQuNi0xLjJjLTEuMS0wLjgtMi0xLjctMi42LTIuNQoJCQkJYy0wLjMtMC40LTAuNi0wLjgtMC43LTEuMWMtMC4xLTAuMS0wLjEtMC4yLTAuMS0wLjJjMC41LTAuMSwxLjItMC4yLDItMC4yYzEuMiwwLDIuNSwwLjMsMy41LDEuMWMxLDAuOCwxLjcsMS44LDIuMSwyLjgKCQkJCUM5Ni4xLDcuOSw5Ni4yLDguMyw5Ni4zLDguNnoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNODQsMTIuMWMwLDAsMC0wLjEsMC0wLjFjMC45LTAuMiwyLjktMC40LDQuNywwLjZjMS4xLDAuNiwxLjksMS41LDIuNCwyLjMKCQkJCWMwLjQsMC41LDAuNiwxLDAuNywxLjNjLTAuNCwwLjEtMSwwLjItMS43LDAuM2MtMSwwLTIuMS0wLjEtMy4yLTAuOGMtMS4xLTAuNi0xLjktMS42LTIuNC0yLjVDODQuMiwxMi44LDg0LjEsMTIuNCw4NCwxMi4xeiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iT2JqZWN0c18wMDAwMDA2NDMxMjM3MTczOTEzMDMxNTI1MDAwMDAxMDIyNTg4OTAzMjIyODYzMjk3NV8iPgoJPGc+CgkJPGc+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTE2LjMsNi44bC0xLjQsMkwxMTQuMSw4bC0wLjYtMC43bDAsMC45bC0wLjEsOC4yaC02LjhsLTAuMS04LjIKCQkJCWwwLTAuOUwxMDUuOSw4bC0wLjgsMC44bC0xLjQtMmwyLjYtMi45YzAuMS0wLjEsMC4yLTAuMSwwLjMtMC4xaDEuM2wwLjQsMC43YzAuNywxLjMsMi42LDEuMywzLjMtMC4xbDAuMy0wLjZoMS4yCgkJCQljMC4xLDAsMC4yLDAsMC4zLDAuMWwwLjMtMC4zbC0wLjMsMC4zTDExNi4zLDYuOHoiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTEwLjEsNy43aDJ2MC45YzAsMC40LTAuNCwwLjctMSwwLjdjLTAuNiwwLTEtMC4zLTEtMC43TDExMC4xLDcuN0wxMTAuMSw3Ljd6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJTeW1ib2xzXzAwMDAwMDk2NzQ2OTA3ODY5OTI5OTIxMTgwMDAwMDA2NDg0ODEyODMwMjgyNTgyNDE2XyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMTQuM2MwLDEuMi0xLDIuMi0yLjIsMi4ycy0yLjItMS0yLjItMi4yczEtMi4yLDIuMi0yLjJTMTI2LjgsMTMuMSwxMjYuOCwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMzcuNiwxNC4zYzAsMS4yLTEsMi4yLTIuMiwyLjJjLTEuMiwwLTIuMi0xLTIuMi0yLjJzMS0yLjIsMi4yLTIuMgoJCQkJQzEzNi42LDEyLjEsMTM3LjYsMTMuMSwxMzcuNiwxNC4zeiIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xMjYuOCw0LjR2OS45Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTEzNy43LDQuNHY5LjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBkPSJNMTI2LjgsMy41aDEwLjh2Mi43aC0xMC44QzEyNi44LDYuMiwxMjYuOCwzLjUsMTI2LjgsMy41eiIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8ZyBpZD0iUmVjZW50cyI+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTE3MC44LDMuMUwxNzAuOCwzLjFjLTAuMywwLTAuNSwwLTAuOCwwYy0yLjEsMC00LDEtNS4zLDIuNWwtMC4xLDBsLTAuMS0wLjFsLTEtMS4ybC0wLjMsMy40bDMuNCwwLjMKCQkJCWwtMS4xLTEuM2wtMC4xLTAuMWwwLjEtMC4xYzEuMS0xLjQsMy0yLjMsNS0yLjFsMCwwYzMuMiwwLjMsNS41LDMuMSw1LjIsNi4zYy0wLjMsMy0zLjEsNS4zLTYuMSw1LjFjLTMuMS0wLjItNS40LTIuOS01LjMtNgoJCQkJTDE2Myw5LjVjLTAuMiwzLjgsMi42LDcuMSw2LjMsNy40YzMuOSwwLjQsNy4zLTIuNiw3LjYtNi41QzE3Ny4yLDYuOCwxNzQuNCwzLjUsMTcwLjgsMy4xeiIvPgoJCQk8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNMTcwLjMsNy40YzAtMC4zLTAuMy0wLjYtMC42LTAuNlMxNjksNy4xLDE2OSw3LjR2My4yYzAsMC4yLDAuMSwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMywwLjIsMC40LDAuMgoJCQkJaDIuNGMwLjQsMCwwLjYtMC4zLDAuNi0wLjZzLTAuMy0wLjYtMC42LTAuNmgtMS42aC0wLjJWOS44TDE3MC4zLDcuNEwxNzAuMyw3LjR6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJDdXN0b21fMDAwMDAxODEwODcyMjk0MzQzMDIzMzY3ODAwMDAwMDUxNTIyNzc5NDU5NDA2NzQ0ODhfIj4KCTxnPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik0xODYuMiwzLjRoNy43YzEuNSwwLDIuNywxLjIsMi43LDIuN3Y3LjdjMCwxLjUtMS4yLDIuNy0yLjcsMi43aC03LjcKCQkJCWMtMS41LDAtMi43LTEuMi0yLjctMi43VjYuMUMxODMuNCw0LjYsMTg0LjcsMy40LDE4Ni4yLDMuNHoiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjE4NiIgY3k9IjguOSIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMTk0IiBjeT0iNi43IiByeD0iMC43IiByeT0iMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMTg2LDEzLjNsMC40LTAuM2MwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMSwwLjQKCQkJCWMwLjUsMC4yLDEsMC4yLDEuNS0wLjFsMC44LTAuNWMwLjQtMC4zLDEtMC4zLDEuNS0wLjFsMS44LDAuOCIvPgoJCTwvZz4KCTwvZz4KPC9nPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS13aWR0aD0iMC4yNSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNMTU2LDQuM2MtMC4yLTAuMS0wLjQtMC4xLTAuNSwwCgljMCwwLTAuMiwwLjEtMC45LDAuMWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0wLjgtMC4zLTEuNy0wLjUtMi41LTAuNWMtMC4yLDAtMC40LDAtMC41LDBjLTEuMywwLTIuNSwwLjMtMy42LDEKCWMtMC4yLDAuMS0wLjIsMC4yLTAuMiwwLjR2MTEuNmMwLDAuMywwLjEsMC41LDAuMywwLjVjMC42LDAsMC41LTAuNCwwLjUtMC42di01LjdjMC43LTAuMywzLjItMS4xLDUuOC0wLjFjMS42LDAuNiwzLjUsMC43LDQuMywwLjcKCWMwLjgsMCwxLjMtMC4zLDEuMy0wLjNjMC4yLTAuMSwwLjMtMC4yLDAuMy0wLjRWNC43QzE1Ni4yLDQuNSwxNTYuMSw0LjQsMTU2LDQuM3ogTTE1NS42LDEwLjJjLTAuMSwwLTAuNywwLjEtMSwwLjEKCWMtMC43LDAtMi40LTAuMS0zLjgtMC42Yy0yLjUtMS01LTAuNS02LjItMC4xVjQuN2MwLjktMC41LDIuMi0wLjcsMy4yLTAuN2MwLjEsMCwwLjMsMCwwLjQsMGMwLjcsMCwxLjUsMC4yLDIuMiwwLjQKCWMxLjYsMC42LDMuNSwwLjcsNC4zLDAuN2MwLjIsMCwwLjgsMCwxLTAuMVYxMC4yeiIvPgo8ZyBpZD0iRm9vZCI+Cgk8ZyBpZD0iTGF5ZXJfMTIiPgoJCTxnPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIGQ9Ik00OC4xLDMuNWgzLjdjMi41LDAsNC41LDIsNC41LDQuNWMwLDAuNS0wLjQsMC45LTAuOSwwLjlINDQuNWMtMC41LDAtMC45LTAuNC0wLjktMC45CgkJCQlDNDMuNiw1LjUsNDUuNiwzLjUsNDguMSwzLjV6Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSw4LjdjLTAuMiwwLjEtMC41LDEuMiwwLDEuNWMxLjQsMC45LDguNSwwLjgsMTEuMywwLjYKCQkJCWMwLjgtMC4xLDEuNi0wLjQsMS43LTEuMmMwLTAuMy0wLjEtMC42LTAuNi0wLjkiLz4KCQkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik00My41LDEwLjZMNDMuMywxMWMtMC4yLDAuNSwwLjIsMSwwLjcsMC45CgkJCQljMC4zLTAuMSwwLjUsMC4xLDAuNywwLjNsMC4xLDAuMmMwLjMsMC41LDEsMC42LDEuNSwwLjJsMCwwYzAuMy0wLjIsMC43LTAuMywxLTAuMmwwLjgsMC4zYzAuNCwwLjEsMC44LDAuMSwxLjIsMGwwLjUtMC4yCgkJCQljMC40LTAuMiwwLjktMC4yLDEuMywwbDAuNSwwLjJjMC40LDAuMiwwLjgsMC4xLDEuMi0wLjFsMC4yLTAuMWMwLjMtMC4yLDAuOC0wLjEsMS4xLDAuMWwwLjIsMC4yYzAuMywwLjMsMC44LDAuMiwxLTAuMmwwLjEtMC4yCgkJCQljMC4xLTAuMiwwLTAuMywwLjItMC40YzAuNSwwLDEuMi0wLjMsMS4xLTAuN2wtMC40LTEuMSIvPgoJCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTQzLjUsMTIuMWMtMC4xLDAuMi0wLjMsMC44LDAsMS4xYzAuMywwLjQsMywxLjEsNi40LDEuMQoJCQkJYzIuMiwwLDQuNi0wLjMsNi0wLjZjMC41LTAuMSwwLjktMC40LDAuOC0wLjljMC0wLjItMC4yLTAuNS0wLjQtMC43Ii8+CgkJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNNDMuNSwxMy4zYzAsMC41LDAuNiwyLjQsMS4zLDIuNmMxLjgsMC44LDUuNywwLjcsOC4xLDAuNQoJCQkJYzEuMy0wLjEsMi41LTAuNywzLjItMS44YzAuMy0wLjUsMC41LTEsMC41LTEuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTEuNiIgY3k9IjYuNSIgcng9IjAuMyIgcnk9IjAuNCIvPgoJCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iNTMiIGN5PSI0LjkiIHJ4PSIwLjMiIHJ5PSIwLjQiLz4KCQkJPGVsbGlwc2UgZmlsbD0iIzg2ODY4NiIgY3g9IjUzIiBjeT0iNy4yIiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1NC4zIiBjeT0iNi41IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSI1MC45IiBjeT0iNC45IiByeD0iMC4zIiByeT0iMC40Ii8+CgkJPC9nPgoJPC9nPgo8L2c+CjxnIGlkPSJBbmltYWxzIj4KCTxnPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgZD0iTTI0LjIsMTFWMy41YzAuMSwwLjEsMC44LDAuOSwyLjgsMy4xYzIuNS0xLjcsNS42LTAuNyw2LjksMGwyLjQtMy4xdjcuMQoJCQljMCwxLjItMC4xLDIuNS0wLjksMy40Yy0xLDEuMi0yLjcsMi41LTUuMywyLjVjLTIuOSwwLTQuNS0xLjUtNS4zLTIuOUMyNC4yLDEyLjksMjQuMiwxMS45LDI0LjIsMTF6Ii8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0yMS4yLDEwbDUuNCwxLjIiLz4KCQk8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiM4Njg2ODYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTTIxLjIsMTQuMWw1LjQtMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDEwbC01LjQsMS4yIi8+CgkJPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjODY4Njg2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIGQ9Ik0zOC44LDE0LjFsLTUuNC0xLjIiLz4KCQk8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTI5LjUsMTIuNEwyOSwxMS43Yy0wLjItMC4zLDAtMC42LDAuMy0wLjZoMS40CgkJCWMwLjMsMCwwLjUsMC40LDAuMywwLjZsLTAuNywxbDAsMGMtMC43LDEuMi0yLjYsMS4xLTMuMS0wLjNsLTAuMS0wLjJjLTAuMS0wLjIsMC0wLjQsMC4yLTAuNXMwLjQsMCwwLjUsMC4ybDAuMSwwLjIKCQkJQzI4LjMsMTIuNywyOS4xLDEyLjksMjkuNSwxMi40eiIvPgoJCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzg2ODY4NiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBkPSJNMzIuNCwxMi4xbC0wLjEsMC4yYy0wLjQsMS0xLjgsMS4xLTIuMywwLjIiLz4KCQk8ZWxsaXBzZSBmaWxsPSIjODY4Njg2IiBjeD0iMjcuNiIgY3k9IjkuNyIgcng9IjAuNyIgcnk9IjAuNyIvPgoJCTxlbGxpcHNlIGZpbGw9IiM4Njg2ODYiIGN4PSIzMi40IiBjeT0iOS43IiByeD0iMC43IiByeT0iMC43Ii8+Cgk8L2c+CjwvZz4KPC9zdmc+";function Xpt(e){var t,r=e.isActiveCategory,n=e.category,a=e.allowNavigation,s=e.categoryConfig,i=e.onClick;return w.createElement(L1,{tabIndex:a?0:-1,className:_r(tgt.catBtn,im.categoryBtn,"epr-icn-"+n,(t={},t[Mr.active]=r,t)),onClick:i,"aria-label":jve(s),"aria-selected":r,role:"tab","aria-controls":"epr-category-nav-id"})}var ire={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 3)"},egt={backgroundPositionY:"calc(var(--epr-category-navigation-button-size) * 2)"},ore={":not(.epr-search-active)":{catBtn:{":hover":ire,"&.epr-active":ire}}},tgt=Dn.create(pn({catBtn:{".":"epr-cat-btn",display:"inline-block",transition:"opacity 0.2s ease-in-out",position:"relative",height:"var(--epr-category-navigation-button-size)",width:"var(--epr-category-navigation-button-size)",backgroundSize:"calc(var(--epr-category-navigation-button-size) * 10)",outline:"none",backgroundPosition:"0 0",backgroundImage:"url("+Zpt+")",":focus:before":{content:"",position:"absolute",top:"-2px",left:"-2px",right:"-2px",bottom:"-2px",border:"2px solid var(--epr-category-icon-active-color)",borderRadius:"50%"},"&.epr-icn-suggested":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -8)"},"&.epr-icn-custom":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -9)"},"&.epr-icn-activities":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -4)"},"&.epr-icn-animals_nature":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -1)"},"&.epr-icn-flags":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -7)"},"&.epr-icn-food_drink":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -2)"},"&.epr-icn-objects":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -5)"},"&.epr-icn-smileys_people":{backgroundPositionX:"0px"},"&.epr-icn-symbols":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -6)"},"&.epr-icn-travel_places":{backgroundPositionX:"calc(var(--epr-category-navigation-button-size) * -3)"}}},zd("catBtn",egt),{".epr-dark-theme":pn({},ore),".epr-auto-theme":pn({},ore)}));function rgt(){var e=w.useState(null),t=e[0],r=e[1],n=C$(),a=n[1],s=Qpt();Ypt({setActiveCategory:r,setVisibleCategories:a});var i=rE(),l=E$(),c=T$(),u=Jpt();return w.createElement("div",{className:_r(ngt.nav),role:"tablist","aria-label":"Category navigation",id:"epr-category-nav-id",ref:c},l.map(function(d){var f=Z2(d),m=f===t;if(cpt(d)&&u)return null;var p=!i&&!m;return w.createElement(Xpt,{key:f,category:f,isActiveCategory:m,allowNavigation:p,categoryConfig:d,onClick:function(){s(f),setTimeout(function(){r(f)},10)}})}))}var ngt=Dn.create({nav:{".":"epr-category-nav",display:"flex",flexDirection:"row",justifyContent:"space-around",padding:"var(--epr-header-padding)"},".epr-search-active":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}},".epr-main:has(input:not(:placeholder-shown))":{nav:{opacity:"0.3",cursor:"default",pointerEvents:"none"}}}),Cbe="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjgwcHgiIHZpZXdCb3g9IjAgMCAyMCA4MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgODAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsPSIjODY4Njg2IiBkPSJNNi45OCwxMy41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsOAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQyTDcuNzQsNy4yN2MtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywxMy4wNSw2Ljc3LDEzLjM5LDYuOTgsMTMuNTlMNi45OCwxMy41OXoiLz4KPHBhdGggZmlsbD0iIzg2ODY4NiIgZD0iTTEwLjE1LDE4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDE0Ljg0LDUuNzQsMTguNDMsMTAuMTUsMTguNDN6CgkgTTEwLjE1LDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0QzMuMjEsNi42LDYuMzMsMy40OSwxMC4xNSwzLjQ5CglMMTAuMTUsMy40OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTYuOTgsMzMuNTljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1czAuMjctMC4wNSwwLjM3LTAuMTVsMi40Mi0yLjQybDIuNDMsMi40MwoJYzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNWMwLjE0LDAsMC4yNy0wLjA1LDAuMzctMC4xNWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWwtMi40My0yLjQzTDEzLjMyLDI4CgljMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwbC0yLjQyLDIuNDJsLTIuNDEtMi40MWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDAKCWMtMC4yMSwwLjIxLTAuMjEsMC41NCwwLDAuNzVsMi40MSwyLjQxbC0yLjQyLDIuNDJDNi43NywzMy4wNSw2Ljc3LDMzLjM5LDYuOTgsMzMuNTlMNi45OCwzMy41OXoiLz4KPHBhdGggZmlsbD0iIzMzNzFCNyIgZD0iTTEwLjE1LDM4LjQzYzQuNDEsMCw4LTMuNTksOC04YzAtNC40MS0zLjU5LTgtOC04Yy00LjQxLDAtOCwzLjU5LTgsOEMyLjE1LDM0Ljg0LDUuNzQsMzguNDMsMTAuMTUsMzguNDN6CgkgTTEwLjE1LDIzLjQ5YzMuODMsMCw2Ljk0LDMuMTEsNi45NCw2Ljk0YzAsMy44My0zLjExLDYuOTQtNi45NCw2Ljk0Yy0zLjgzLDAtNi45NC0zLjExLTYuOTQtNi45NAoJQzMuMjEsMjYuNiw2LjMzLDIzLjQ5LDEwLjE1LDIzLjQ5TDEwLjE1LDIzLjQ5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNNi45OCw1My41OWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVzMC4yNy0wLjA1LDAuMzctMC4xNWwyLjQyLTIuNDJsMi40MywyLjQzCgljMC4xLDAuMSwwLjI0LDAuMTUsMC4zNywwLjE1YzAuMTQsMCwwLjI3LTAuMDUsMC4zNy0wLjE1YzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1bC0yLjQzLTIuNDNMMTMuMzIsNDgKCWMwLjIxLTAuMjEsMC4yMS0wLjU0LDAtMC43NWMtMC4yMS0wLjIxLTAuNTQtMC4yMS0wLjc1LDBsLTIuNDIsMi40MmwtMi40MS0yLjQxYy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMAoJYy0wLjIxLDAuMjEtMC4yMSwwLjU0LDAsMC43NWwyLjQxLDIuNDFsLTIuNDIsMi40MkM2Ljc3LDUzLjA1LDYuNzcsNTMuMzksNi45OCw1My41OUw2Ljk4LDUzLjU5eiIvPgo8cGF0aCBmaWxsPSIjQzBDMEJGIiBkPSJNMTAuMTUsNTguNDNjNC40MSwwLDgtMy41OSw4LThjMC00LjQxLTMuNTktOC04LThjLTQuNDEsMC04LDMuNTktOCw4QzIuMTUsNTQuODQsNS43NCw1OC40MywxMC4xNSw1OC40M3oKCSBNMTAuMTUsNDMuNDljMy44MywwLDYuOTQsMy4xMSw2Ljk0LDYuOTRjMCwzLjgzLTMuMTEsNi45NC02Ljk0LDYuOTRjLTMuODMsMC02Ljk0LTMuMTEtNi45NC02Ljk0CglDMy4yMSw0Ni42LDYuMzMsNDMuNDksMTAuMTUsNDMuNDlMMTAuMTUsNDMuNDl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik02Ljk4LDczLjU5YzAuMSwwLjEsMC4yNCwwLjE1LDAuMzcsMC4xNXMwLjI3LTAuMDUsMC4zNy0wLjE1bDIuNDItMi40MmwyLjQzLDIuNDMKCWMwLjEsMC4xLDAuMjQsMC4xNSwwLjM3LDAuMTVjMC4xNCwwLDAuMjctMC4wNSwwLjM3LTAuMTVjMC4yMS0wLjIxLDAuMjEtMC41NCwwLTAuNzVsLTIuNDMtMi40M0wxMy4zMiw2OAoJYzAuMjEtMC4yMSwwLjIxLTAuNTQsMC0wLjc1Yy0wLjIxLTAuMjEtMC41NC0wLjIxLTAuNzUsMGwtMi40MiwyLjQybC0yLjQxLTIuNDFjLTAuMjEtMC4yMS0wLjU0LTAuMjEtMC43NSwwCgljLTAuMjEsMC4yMS0wLjIxLDAuNTQsMCwwLjc1bDIuNDEsMi40MWwtMi40MiwyLjQyQzYuNzcsNzMuMDUsNi43Nyw3My4zOSw2Ljk4LDczLjU5TDYuOTgsNzMuNTl6Ii8+CjxwYXRoIGZpbGw9IiM2QUE5REQiIGQ9Ik0xMC4xNSw3OC40M2M0LjQxLDAsOC0zLjU5LDgtOGMwLTQuNDEtMy41OS04LTgtOGMtNC40MSwwLTgsMy41OS04LDhDMi4xNSw3NC44NCw1Ljc0LDc4LjQzLDEwLjE1LDc4LjQzegoJIE0xMC4xNSw2My40OWMzLjgzLDAsNi45NCwzLjExLDYuOTQsNi45NGMwLDMuODMtMy4xMSw2Ljk0LTYuOTQsNi45NGMtMy44MywwLTYuOTQtMy4xMS02Ljk0LTYuOTQKCUMzLjIxLDY2LjYsNi4zMyw2My40OSwxMC4xNSw2My40OUwxMC4xNSw2My40OXoiLz4KPC9zdmc+";function agt(){var e=abe(),t=tmt();return w.createElement(L1,{className:_r(lre.btnClearSearch,im.visibleOnSearchOnly),onClick:e,"aria-label":t,title:t},w.createElement("div",{className:_r(lre.icnClearnSearch)}))}var sgt={":hover":{"> .epr-icn-clear-search":{backgroundPositionY:"-60px"}}},lre=Dn.create(pn({btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+Cbe+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},zd("icnClearnSearch",{backgroundPositionY:"-40px"}),zd("btnClearSearch",sgt))),igt="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI2LjMuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjQwcHgiIHZpZXdCb3g9IjAgMCAyMCA0MCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMjAgNDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZD0iTTEyLDguODFjMCwyLjA4LTEuNjgsMy43Ni0zLjc2LDMuNzZjLTIuMDgsMC0zLjc2LTEuNjgtMy43Ni0zLjc2CgljMC0yLjA4LDEuNjgtMy43NiwzLjc2LTMuNzZDMTAuMzIsNS4wNSwxMiw2LjczLDEyLDguODF6IE0xMS4yMywxMi43MmMtMC44MywwLjY0LTEuODcsMS4wMS0yLjk5LDEuMDFjLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTIKCWMwLTIuNzIsMi4yLTQuOTIsNC45Mi00LjkyYzIuNzIsMCw0LjkyLDIuMiw0LjkyLDQuOTJjMCwxLjEzLTAuMzgsMi4xNi0xLjAxLDIuOTlsMy45NCwzLjkzYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyCgljLTAuMjUsMC4yNS0wLjY2LDAuMjUtMC45MiwwTDExLjIzLDEyLjcyeiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI0MwQzBCRiIgZD0iTTEyLDI4LjgxYzAsMi4wOC0xLjY4LDMuNzYtMy43NiwzLjc2Yy0yLjA4LDAtMy43Ni0xLjY4LTMuNzYtMy43NgoJYzAtMi4wOCwxLjY4LTMuNzYsMy43Ni0zLjc2QzEwLjMyLDI1LjA1LDEyLDI2LjczLDEyLDI4LjgxeiBNMTEuMjMsMzIuNzJjLTAuODMsMC42NC0xLjg3LDEuMDEtMi45OSwxLjAxCgljLTIuNzIsMC00LjkyLTIuMi00LjkyLTQuOTJjMC0yLjcyLDIuMi00LjkyLDQuOTItNC45MmMyLjcyLDAsNC45MiwyLjIsNC45Miw0LjkyYzAsMS4xMy0wLjM4LDIuMTYtMS4wMSwyLjk5bDMuOTQsMy45MwoJYzAuMjUsMC4yNSwwLjI1LDAuNjYsMCwwLjkyYy0wLjI1LDAuMjUtMC42NiwwLjI1LTAuOTIsMEwxMS4yMywzMi43MnoiLz4KPC9zdmc+";function ogt(){return w.createElement("div",{className:_r(lgt.icnSearch)})}var lgt=Dn.create(pn({icnSearch:{".":"epr-icn-search",content:"",position:"absolute",top:"50%",left:"var(--epr-search-bar-inner-padding)",transform:"translateY(-50%)",width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"0 0",backgroundSize:"20px",backgroundImage:"url("+igt+")"}},zd("icnSearch",{backgroundPositionY:"-20px"})));function cgt(){var e=Wve(),t=D$();return e?null:w.createElement(_be,{className:_r(Kk.overlay)},w.createElement(ugt,null),t?w.createElement(Nbe,null):null)}function ugt(){var e=dm(),t=Vd(),r=emt(),n=nmt(),a=Omt(),s=a.statusSearchResults,i=a.searchTerm,l=a.onChange,c=t?.current,u=c?.value;return w.createElement(cE,{className:_r(Kk.searchContainer)},w.createElement("input",{autoFocus:n,"aria-label":"Type to search for an emoji",onFocus:e,className:_r(Kk.search),type:"text","aria-controls":"epr-search-id",placeholder:r,onChange:function(f){var m,p;l((m=f==null||(p=f.target)==null?void 0:p.value)!=null?m:u)},ref:t}),i?w.createElement("div",{role:"status",className:_r("epr-status-search-results",Kk.visuallyHidden),"aria-live":"polite",id:"epr-search-id","aria-atomic":"true"},s):null,w.createElement(ogt,null),w.createElement(agt,null))}var Kk=Dn.create(pn({overlay:{padding:"var(--epr-header-padding)",zIndex:"var(--epr-header-overlay-z-index)"},searchContainer:{".":"epr-search-container",flex:"1",display:"block",minWidth:"0"},visuallyHidden:{clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:"1px"},search:{outline:"none",transition:"all 0.2s ease-in-out",color:"var(--epr-search-input-text-color)",borderRadius:"var(--epr-search-input-border-radius)",padding:"var(--epr-search-input-padding)",height:"var(--epr-search-input-height)",backgroundColor:"var(--epr-search-input-bg-color)",border:"1px solid var(--epr-search-border-color)",width:"100%",":focus":{backgroundColor:"var(--epr-search-input-bg-color-active)",border:"1px solid var(--epr-search-border-color-active)"},"::placeholder":{color:"var(--epr-search-input-placeholder-color)"}},btnClearSearch:{".":"epr-btn-clear-search",position:"absolute",right:"var(--epr-search-bar-inner-padding)",height:"30px",width:"30px",display:"flex",alignItems:"center",justifyContent:"center",top:"50%",transform:"translateY(-50%)",padding:"0",borderRadius:"50%",":hover":{background:"var(--epr-hover-bg-color)"},":focus":{background:"var(--epr-hover-bg-color)"}},icnClearnSearch:{".":"epr-icn-clear-search",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:"20px",height:"20px",width:"20px",backgroundImage:"url("+Cbe+")",":hover":{backgroundPositionY:"-20px"},":focus":{backgroundPositionY:"-20px"}}},zd("icnClearnSearch",{backgroundPositionY:"-40px"}),zd("btnClearSearch",{":hover > .epr-icn-clear-search":{backgroundPositionY:"-60px"}})));function dgt(){return w.createElement(cE,{className:_r("epr-header",im.hiddenOnReactions)},w.createElement(cgt,null),w.createElement(rgt,null))}function fgt(e){return w.createElement(gmt,null,w.createElement(hht,null),w.createElement(Iht,Object.assign({},e),w.createElement(qht,null,w.createElement(hgt,null))))}function hgt(){var e=lm(),t=e[0],r=$ve(),n=w.useState(!t),a=n[0],s=n[1],i=smt();return w.useEffect(function(){t&&!r||a||s(!0)},[a,r,t]),i?w.createElement(Xmt,null,w.createElement(xpt,null),w.createElement(mgt,{renderAll:a})):null}function mgt(e){var t=e.renderAll;return t?w.createElement(w.Fragment,null,w.createElement(dgt,null),w.createElement(Ppt,null),w.createElement(Kpt,null)):null}var pgt=w.memo(fgt,wve),ggt=(function(e){dht(t,e);function t(n){var a;return a=e.call(this,n)||this,a.state={hasError:!1},a}t.getDerivedStateFromError=function(){return{hasError:!0}};var r=t.prototype;return r.componentDidCatch=function(a,s){console.error("Emoji Picker React failed to render:",a,s)},r.render=function(){return this.state.hasError?null:this.props.children},t})(w.Component);function vgt(e){var t=Xht({onEmojiClick:e.onEmojiClick,onReactionClick:e.onReactionClick,onSkinToneChange:e.onSkinToneChange});return w.createElement(ggt,null,w.createElement(zve.Provider,{value:t},w.createElement(pgt,Object.assign({},e))))}function bgt({isOpen:e,onClose:t,onSelect:r}){const[n,a]=w.useState([]);w.useEffect(()=>{if(e){const u=localStorage.getItem("stoneforge.recentEmojis");if(u)try{a(JSON.parse(u))}catch{a([])}}},[e]);const s=w.useCallback(u=>{const d=u.emoji;a(f=>{const m=f.filter(v=>v!==d),p=[d,...m].slice(0,20);return localStorage.setItem("stoneforge.recentEmojis",JSON.stringify(p)),p}),r(d),t()},[r,t]);w.useEffect(()=>{const u=d=>{e&&d.key==="Escape"&&(d.preventDefault(),t())};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[e,t]);const i=w.useMemo(()=>typeof document<"u"&&document.documentElement.classList.contains("dark")?Ld.DARK:Ld.LIGHT,[e]),l=jo(),c=l?null:o.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Tip: Type ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-xs font-mono",children:":emoji:"})," in the editor to quickly insert emojis"]});return o.jsx(Ux,{open:e,onClose:t,title:"Insert Emoji",size:"sm","data-testid":"emoji-picker-modal",footer:c,children:o.jsx("div",{className:"p-2",children:o.jsx(vgt,{onEmojiClick:s,theme:i,searchPlaceholder:"Search emojis...",suggestedEmojisMode:qg.RECENT,categories:[{category:Qt.SUGGESTED,name:"Recently Used"},{category:Qt.SMILEYS_PEOPLE,name:"Smileys & People"},{category:Qt.ANIMALS_NATURE,name:"Animals & Nature"},{category:Qt.FOOD_DRINK,name:"Food & Drink"},{category:Qt.TRAVEL_PLACES,name:"Travel & Places"},{category:Qt.ACTIVITIES,name:"Activities"},{category:Qt.OBJECTS,name:"Objects"},{category:Qt.SYMBOLS,name:"Symbols"},{category:Qt.FLAGS,name:"Flags"}],width:l?"100%":350,height:l?"calc(100vh - 150px)":400,previewConfig:{showPreview:!l},lazyLoadEmojis:!0,"data-testid":"emoji-picker-grid"})})})}function ygt({isOpen:e,onClose:t,onSelect:r,selectedIds:n}){const[a,s]=w.useState(""),{data:i,isLoading:l}=YJe(a),c=w.useRef(null);if(w.useEffect(()=>{e&&c.current&&c.current.focus()},[e]),w.useEffect(()=>{if(e){const d=f=>{f.key==="Escape"&&t()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)}},[e,t]),!e)return null;const u=i?.filter(d=>!n.includes(d.id))||[];return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"message-attachment-picker",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[60vh] flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attach Document"}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 rounded","data-testid":"attachment-picker-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:c,type:"text",placeholder:"Search documents...",value:a,onChange:d=>s(d.target.value),className:"w-full pl-9 pr-4 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500","data-testid":"attachment-search"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(Pe,{className:"w-6 h-6 animate-spin text-gray-400"})}):u.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500","data-testid":"attachment-picker-empty",children:i?.length===0?"No documents available":a?"No documents match your search":"All documents are already attached"}):o.jsx("div",{className:"space-y-2",children:u.map(d=>o.jsxs("button",{onClick:()=>r(d),className:"w-full flex items-center gap-3 p-3 text-left bg-gray-50 hover:bg-blue-50 rounded-lg transition-colors","data-testid":`attachment-option-${d.id}`,children:[o.jsx(rn,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 truncate",children:d.title||"Untitled Document"}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:d.id}),o.jsx("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-600 rounded",children:d.contentType})]})]})]},d.id))})})]})]})}function xgt({channelId:e,channel:t,isMobile:r=!1}){const[n,a]=w.useState(""),[s,i]=w.useState([]),[l,c]=w.useState([]),[u,d]=w.useState(!1),[f,m]=w.useState(!1),[p,v]=w.useState(!1),[b,y]=w.useState(!1),[S,_]=w.useState(!1),[N,k]=w.useState(!1),j=Lme(),E=w.useRef(null),T=w.useRef(null),[O,R]=w.useState(!1),{currentUser:H}=rl(),{data:$=[]}=PB();w.useEffect(()=>{E.current?.focus()},[e]);const L=w.useMemo(()=>({onTaskEmbed:()=>y(!0),onDocumentEmbed:()=>_(!0),onEmojiInsert:()=>k(!0)}),[]),A=w.useCallback(te=>{a(le=>le+`#task:${te}`),y(!1),E.current?.focus()},[]),M=w.useCallback(te=>{a(le=>le+`#doc:${te}`),_(!1),E.current?.focus()},[]),P=w.useCallback(te=>{a(le=>le+te),k(!1),E.current?.focus()},[]),I=te=>{i(le=>[...le,te]),d(!1)},B=te=>{i(le=>le.filter(oe=>oe.id!==te))},F=te=>{const le=te.split("/").pop()||"image";c(oe=>[...oe,{url:te,filename:le}]),m(!1)},q=te=>{c(le=>le.filter(oe=>oe.url!==te))},Q=async te=>{if(!["image/jpeg","image/png","image/gif","image/webp"].includes(te.type))return Gr.error(`Invalid file type: ${te.type}`),null;if(te.size>10*1024*1024)return Gr.error("File too large (max 10MB)"),null;v(!0);try{const oe=new FormData;oe.append("file",te);const Z=await fetch("/api/uploads",{method:"POST",body:oe});if(!Z.ok)throw new Error("Upload failed");return(await Z.json()).url}catch{return Gr.error("Failed to upload image"),null}finally{v(!1)}},W=async te=>{const le=await Q(te);le&&(F(le),Gr.success("Image attached"))},G=async te=>{te.preventDefault(),R(!1);const le=te.dataTransfer.files[0];if(le&&le.type.startsWith("image/")){const oe=await Q(le);oe&&(F(oe),Gr.success("Image attached"))}},J=te=>{te.preventDefault(),te.dataTransfer.types.includes("Files")&&R(!0)},X=te=>{te.preventDefault(),R(!1)},V=async()=>{const te=n.trim().length>0,le=l.length>0,oe=s.length>0;if(!te&&!le&&!oe||!t||!H)return;const Z=H.id;try{let ve=n.trim();if(l.length>0){const U=l.map(ge=>`![${ge.filename||"image"}](${ge.url})`).join(`
`);ve=ve?`${ve}

${U}`:U}await j.mutateAsync({channelId:e,sender:Z,content:ve,attachmentIds:s.map(U=>U.id)}),a(""),i([]),c([]),E.current?.clear()}catch(ve){console.error("Failed to send message:",ve)}},se=te=>{te.preventDefault(),V()},de=s.length>0||l.length>0,he=n.trim()||de;return o.jsxs(o.Fragment,{children:[o.jsxs("form",{ref:T,"data-testid":"message-composer",onSubmit:se,onDrop:G,onDragOver:J,onDragLeave:X,className:`border-t border-[var(--color-border)] bg-[var(--color-bg)] relative ${r?"p-2":"p-4"} ${O?"ring-2 ring-blue-500 ring-inset bg-blue-50 dark:bg-blue-900/30":""}`,children:[O&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-blue-50/90 dark:bg-blue-900/80 z-10 pointer-events-none",children:o.jsxs("div",{className:"flex flex-col items-center text-blue-600 dark:text-blue-400",children:[o.jsx(iy,{className:r?"w-6 h-6 mb-1":"w-8 h-8 mb-2"}),o.jsx("span",{className:`font-medium ${r?"text-xs":"text-sm"}`,children:"Drop image here"})]})}),l.length>0&&o.jsx("div",{className:`flex flex-wrap mb-2 ${r?"gap-1.5":"gap-2"}`,"data-testid":"message-image-attachments-preview",children:l.map(te=>o.jsxs("div",{className:"relative group","data-testid":`image-attachment-preview-${te.filename}`,children:[o.jsx("img",{src:te.url,alt:te.filename||"Attached image",className:`object-cover rounded-lg border border-[var(--color-border)] ${r?"w-14 h-14":"w-20 h-20"}`}),o.jsx("button",{type:"button",onClick:()=>q(te.url),className:`absolute -top-1 -right-1 bg-red-500 text-white rounded-full transition-opacity ${r?"p-0.5 opacity-100":"p-1 opacity-0 group-hover:opacity-100"}`,"data-testid":`remove-image-attachment-${te.filename}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},te.url))}),s.length>0&&o.jsx("div",{className:`flex flex-wrap mb-2 ${r?"gap-1.5":"gap-2"}`,"data-testid":"message-attachments-preview",children:s.map(te=>o.jsxs("div",{className:`flex items-center gap-2 bg-gray-100 dark:bg-gray-800 rounded-md ${r?"px-1.5 py-0.5 text-xs":"px-2 py-1 text-sm"}`,"data-testid":`attachment-preview-${te.id}`,children:[o.jsx(rn,{className:`text-gray-400 ${r?"w-3 h-3":"w-4 h-4"}`}),o.jsx("span",{className:`truncate ${r?"max-w-[100px]":"max-w-[150px]"}`,children:te.title||"Untitled"}),o.jsx("button",{type:"button",onClick:()=>B(te.id),className:"p-0.5 text-gray-400 hover:text-red-500","data-testid":`remove-attachment-${te.id}`,children:o.jsx(yt,{className:"w-3 h-3"})})]},te.id))}),o.jsxs("div",{className:`flex items-end ${r?"gap-1":"gap-2"}`,children:[o.jsx("button",{type:"button",onClick:()=>m(!0),disabled:p,className:`text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors self-end disabled:opacity-50 ${r?"p-2 touch-target":"p-2 mb-1"}`,"data-testid":"message-image-attach-button",title:"Attach image",children:p?o.jsx(Pe,{className:"w-5 h-5 animate-spin"}):o.jsx(iy,{className:"w-5 h-5"})}),o.jsx("button",{type:"button",onClick:()=>d(!0),className:`text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors self-end ${r?"p-2 touch-target":"p-2 mb-1"}`,"data-testid":"message-attach-button",title:"Attach document",children:o.jsx(KC,{className:"w-5 h-5"})}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx(whe,{ref:E,content:n,onChange:a,onSubmit:V,onImagePaste:W,channelName:t?.name,disabled:j.isPending,maxHeight:r?120:180,minHeight:r?44:60,embedCallbacks:L,mentionEntities:$})}),o.jsxs("button",{type:"submit","data-testid":"message-send-button",disabled:!he||j.isPending,className:`bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center self-end ${r?"p-2.5 touch-target":"px-4 py-2 gap-2 mb-1"}`,children:[o.jsx(XC,{className:r?"w-5 h-5":"w-4 h-4"}),o.jsx("span",{className:"sr-only",children:"Send"})]})]}),j.isError&&o.jsx("p",{"data-testid":"message-send-error",className:`mt-2 text-red-500 ${r?"text-xs":"text-sm"}`,children:j.error?.message||"Failed to send message. Please try again."})]}),o.jsx(ygt,{isOpen:u,onClose:()=>d(!1),onSelect:I,selectedIds:s.map(te=>te.id)}),o.jsx(oGe,{isOpen:f,onClose:()=>m(!1),onAttach:F}),o.jsx(Qft,{isOpen:b,onClose:()=>y(!1),onSelect:A}),o.jsx(Xft,{isOpen:S,onClose:()=>_(!1),onSelect:M}),o.jsx(bgt,{isOpen:N,onClose:()=>k(!1),onSelect:P})]})}function cre({searchQuery:e,channelId:t,onSelectResult:r,onClose:n}){const{data:a,isLoading:s}=VJe(e,t),i=a?.results||[],[l,c]=w.useState(0),u=w.useRef(null);if(w.useEffect(()=>{c(0)},[i.length]),w.useEffect(()=>{const f=m=>{m.key==="ArrowDown"?(m.preventDefault(),c(p=>Math.min(p+1,i.length-1))):m.key==="ArrowUp"?(m.preventDefault(),c(p=>Math.max(p-1,0))):m.key==="Enter"?(m.preventDefault(),i[l]&&(r(i[l].id),n())):m.key==="Escape"&&(m.preventDefault(),n())};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[i,l,r,n]),w.useEffect(()=>{if(u.current){const f=u.current.children[l];f&&f.scrollIntoView({block:"nearest"})}},[l]),!e.trim())return null;const d=f=>{const m=new Date(f),p=new Date;return m.toDateString()===p.toDateString()?m.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):m.toLocaleDateString([],{month:"short",day:"numeric"})};return o.jsx("div",{"data-testid":"message-search-dropdown",className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-80 overflow-hidden",children:s?o.jsxs("div",{className:"flex items-center justify-center py-6","data-testid":"message-search-loading",children:[o.jsx(Pe,{className:"w-5 h-5 animate-spin text-gray-400"}),o.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Searching..."})]}):i.length===0?o.jsxs("div",{className:"py-6 text-center","data-testid":"message-search-empty",children:[o.jsx(xr,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),o.jsx("p",{className:"text-sm text-gray-500",children:"No messages found"}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Try a different search term"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-3 py-2 text-xs text-gray-500 border-b border-gray-100",children:[i.length," result",i.length!==1?"s":""," found"]}),o.jsx("div",{ref:u,className:"overflow-y-auto max-h-64","data-testid":"message-search-results",children:i.map((f,m)=>o.jsxs("button",{onClick:()=>{r(f.id),n()},className:`w-full text-left px-3 py-2 flex items-start gap-3 transition-colors ${m===l?"bg-blue-50":"hover:bg-gray-50"}`,"data-testid":`message-search-result-${f.id}`,children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:o.jsx("span",{className:"text-blue-600 font-medium text-xs",children:f.sender.slice(-2).toUpperCase()})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-baseline gap-2",children:[o.jsx(Vse,{entityRef:f.sender,className:"font-medium text-sm"}),o.jsx("span",{className:"text-xs text-gray-400",children:d(f.createdAt)})]}),o.jsx("p",{className:"text-sm text-gray-600 truncate mt-0.5",children:oJe(f.snippet,e)})]})]},f.id))}),o.jsxs("div",{className:"px-3 py-2 text-xs text-gray-400 border-t border-gray-100",children:[o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:""})," ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:""})," navigate"," ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:"Enter"})," select"," ",o.jsx("kbd",{className:"px-1 py-0.5 bg-gray-100 rounded text-[10px]",children:"Esc"})," close"]})]})})}function jbe({parentMessage:e,channel:t,onClose:r}){const{data:n=[],isLoading:a}=KJe(e.id);return o.jsxs("div",{"data-testid":"thread-panel",className:"w-80 border-l border-gray-200 flex flex-col bg-white",children:[o.jsxs("div",{"data-testid":"thread-header",className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[o.jsx("h3",{className:"font-medium text-gray-900",children:"Thread"}),o.jsx("button",{"data-testid":"thread-close-button",onClick:r,className:"p-1 text-gray-400 hover:text-gray-600 rounded",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("div",{"data-testid":"thread-parent-message",className:"border-b border-gray-100",children:o.jsx(l5,{message:e,isThreaded:!0})}),o.jsx("div",{"data-testid":"thread-replies",className:"flex-1 overflow-hidden p-2",children:a?o.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:"Loading replies..."}):o.jsx(cve,{items:n,getItemKey:s=>s.id,estimateSize:s=>{const c=n[s]?._content||"";return c.includes("![")&&c.includes("](")?420:80},testId:"virtualized-thread-replies",gap:4,latestMessageId:n[n.length-1]?.id,renderEmpty:()=>o.jsx("div",{"data-testid":"thread-empty",className:"text-center py-4 text-gray-500 text-sm",children:"No replies yet"}),renderItem:s=>o.jsx(l5,{message:s,isThreaded:!0})})}),o.jsx(wgt,{parentMessage:e,channel:t})]})}function wgt({parentMessage:e,channel:t}){const[r,n]=w.useState(""),a=Lme(),s=w.useRef(null),{currentUser:i}=rl(),{data:l=[]}=PB(),c=async()=>{if(!r.trim()||!t||!i)return;const d=i.id;try{await a.mutateAsync({channelId:e.channelId,sender:d,content:r.trim(),threadId:e.id}),n(""),s.current?.clear()}catch(f){console.error("Failed to send reply:",f)}},u=d=>{d.preventDefault(),c()};return o.jsx("form",{"data-testid":"thread-composer",onSubmit:u,className:"p-3 border-t border-gray-200 bg-white",children:o.jsxs("div",{className:"flex gap-2 items-end",children:[o.jsx("div",{className:"flex-1",children:o.jsx(whe,{ref:s,content:r,onChange:n,onSubmit:c,placeholder:"Reply in thread...",disabled:a.isPending,maxHeight:120,minHeight:48,mentionEntities:l})}),o.jsx("button",{type:"submit","data-testid":"thread-send-button",disabled:!r.trim()||a.isPending,className:"px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors self-end mb-1",children:o.jsx(XC,{className:"w-4 h-4"})})]})})}const Sgt="el-0000",kgt=100;function ure({channelId:e,isMobile:t=!1,onBack:r,onChannelDeleted:n}){const{data:a}=qJe(e),{data:s=[],isLoading:i,error:l}=WJe(e),{currentUser:c}=rl(),u=GJe(),[d,f]=w.useState(null),[m,p]=w.useState(!1),[v,b]=w.useState(!1),[y,S]=w.useState(null),[_,N]=w.useState(!1),{searchQuery:k,setSearchQuery:j,isSearchOpen:E,setIsSearchOpen:T,searchInputRef:O,clearSearch:R}=g_e({enableKeyboardShortcut:!0}),H=c?.id||"",$=a&&a.channelType!=="direct"&&(H===Sgt||a.createdBy===H),L=async()=>{if(!(!a||!H))try{await u.mutateAsync({channelId:a.id,actor:H}),N(!1),n?.()}catch{}},A=w.useCallback(W=>{R(),b(!1);const G=document.querySelector(`[data-testid="message-${W}"]`);G&&(G.scrollIntoView({behavior:"smooth",block:"center"}),S(W),setTimeout(()=>{S(null)},2e3))},[R]);w.useEffect(()=>{if(!y)return;const W=()=>{S(null)},G=setTimeout(()=>{document.addEventListener("click",W)},100);return()=>{clearTimeout(G),document.removeEventListener("click",W)}},[y]);const M=s.reduce((W,G)=>(G.threadId&&(W[G.threadId]=(W[G.threadId]||0)+1),W),{}),P=s.filter(W=>!W.threadId),I=w.useMemo(()=>Sft(P,W=>W.createdAt),[P]),B=W=>{f(W)},F=()=>o.jsxs("div",{className:"relative","data-testid":"message-search-container",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:O,type:"text",value:k,onChange:W=>{j(W.target.value),T(W.target.value.length>0)},onFocus:()=>k&&T(!0),onKeyDown:W=>{W.key==="Escape"&&(R(),O.current?.blur())},placeholder:"Search messages...",className:"w-48 pl-8 pr-8 py-1.5 text-sm border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-[var(--color-surface)] text-[var(--color-text)]","data-testid":"message-search-input"}),k&&o.jsx("button",{onClick:()=>{R(),O.current?.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","data-testid":"message-search-clear",children:o.jsx(us,{className:"w-4 h-4"})})]}),E&&o.jsx(cre,{searchQuery:k,channelId:e,onSelectResult:A,onClose:()=>T(!1)})]}),q=W=>$?o.jsx("button",{onClick:()=>N(!0),disabled:u.isPending,className:`rounded-md text-gray-500 dark:text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors disabled:opacity-50 ${W?"p-2 touch-target":"p-1.5 ml-2"}`,"data-testid":"delete-channel-header-button","aria-label":"Delete channel",title:"Delete channel",children:u.isPending?o.jsx(Pe,{className:`animate-spin ${W?"w-5 h-5":"w-4 h-4"}`}):o.jsx(pr,{className:W?"w-5 h-5":"w-4 h-4"})}):null,Q=({isMobile:W})=>a?W?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>b(!v),className:"p-2 rounded-md text-gray-500 dark:text-gray-400 hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"mobile-search-toggle","aria-label":"Search messages",children:o.jsx(xr,{className:"w-5 h-5"})}),q(!0)]}):o.jsxs("div",{className:"flex items-center",children:[F(),q(!1)]}):null;return o.jsxs("div",{"data-testid":"channel-view",className:`flex-1 flex bg-[var(--color-bg)] ${t?"absolute inset-0 z-40":""}`,children:[o.jsxs("div",{className:"flex-1 flex flex-col",children:[a&&o.jsxs("div",{children:[o.jsx(p_e,{channel:a,isMobile:t,onBack:r,onOpenMembers:()=>p(!0),renderIcon:W=>o.jsx(Zse,{channel:W,className:t?"w-4 h-4":"w-5 h-5"}),renderActions:Q}),t&&v&&o.jsxs("div",{className:"px-3 pb-3 relative","data-testid":"mobile-message-search-container",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:O,type:"text",value:k,onChange:W=>{j(W.target.value),T(W.target.value.length>0)},onFocus:()=>k&&T(!0),onKeyDown:W=>{W.key==="Escape"&&(R(),b(!1))},placeholder:"Search...",className:"w-full pl-10 pr-10 py-2.5 text-base border border-[var(--color-border)] rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-[var(--color-surface)] text-[var(--color-text)]","data-testid":"mobile-message-search-input",autoFocus:!0}),k&&o.jsx("button",{onClick:()=>{R(),O.current?.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:o.jsx(us,{className:"w-5 h-5"})})]}),E&&o.jsx(cre,{searchQuery:k,channelId:e,onSelectResult:W=>{A(W),b(!1)},onClose:()=>{T(!1),b(!1)}})]})]}),o.jsx("div",{"data-testid":"messages-container",className:`flex-1 overflow-hidden ${t?"p-2":"p-4"}`,children:i?o.jsx("div",{"data-testid":"messages-loading",className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:"Loading messages..."}):l?o.jsx("div",{"data-testid":"messages-error",className:"flex items-center justify-center h-full text-red-500",children:"Failed to load messages"}):o.jsx(cve,{items:I,getItemKey:W=>W.item.id,estimateSize:W=>{const G=t?80:kgt,J=I[W];let X=G;J?.isFirstInDay&&(X+=48);const V=J?.item?._content||"";return V.includes("![")&&V.includes("](")&&(X+=340),X},scrollRestoreId:`messages-${e}`,testId:"virtualized-messages-list",gap:t?4:8,latestMessageId:P[P.length-1]?.id,renderEmpty:()=>o.jsxs("div",{"data-testid":"messages-empty",className:`flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400 ${t?"px-4":""}`,children:[o.jsx(oi,{className:`mb-3 text-gray-300 dark:text-gray-600 ${t?"w-10 h-10":"w-12 h-12"}`}),o.jsx("p",{className:t?"text-base":"text-sm",children:"No messages yet"}),o.jsx("p",{className:`text-gray-400 dark:text-gray-500 mt-1 ${t?"text-sm":"text-xs"}`,children:"Be the first to send a message!"})]}),renderItem:W=>o.jsxs("div",{children:[W.isFirstInDay&&o.jsx(Kft,{date:W.formattedDate}),o.jsx(l5,{message:W.item,onReply:B,replyCount:M[W.item.id]||0,isHighlighted:y===W.item.id,isMobile:t})]})})}),o.jsx(xgt,{channelId:e,channel:a,isMobile:t})]}),d&&!t&&o.jsx(jbe,{parentMessage:d,channel:a,onClose:()=>f(null)}),d&&t&&o.jsx(_gt,{selectedThread:d,channel:a,onClose:()=>f(null)}),m&&a&&H&&o.jsx(yGe,{channel:a,currentOperator:H,onClose:()=>p(!1),onChannelDeleted:n}),_&&a&&o.jsxs("div",{className:"fixed inset-0 z-[60]",onClick:()=>N(!1),"data-testid":"delete-channel-confirm-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),o.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-sm mx-4",onClick:W=>W.stopPropagation(),children:o.jsxs("div",{className:"bg-[var(--color-surface)] rounded-xl shadow-2xl border border-[var(--color-border)]",children:[o.jsx("div",{className:"px-5 py-4 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900/30",children:o.jsx(Bn,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Channel"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"This action cannot be undone."})]})]})}),o.jsxs("div",{className:"px-5 py-4",children:[o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] mb-3",children:"All messages and data in this channel will be permanently deleted."}),o.jsxs("div",{className:"p-3 bg-[var(--color-surface-elevated)] rounded-md border border-[var(--color-border)]",children:[o.jsxs("p",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:a.name,children:["#",a.name]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono mt-1",children:a.id})]})]}),o.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-border)] bg-[var(--color-bg-secondary)] rounded-b-xl flex items-center justify-end gap-3",children:[o.jsx("button",{onClick:()=>N(!1),disabled:u.isPending,className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface-elevated)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors disabled:opacity-50","data-testid":"delete-channel-cancel",children:"Cancel"}),o.jsxs("button",{onClick:L,disabled:u.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"delete-channel-confirm",children:[u.isPending&&o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Delete"]})]}),u.isError&&o.jsx("div",{className:"px-5 py-3 border-t border-[var(--color-border)]",children:o.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[o.jsx(Rt,{className:"w-4 h-4"}),u.error.message]})})]})})]})]})}function _gt({selectedThread:e,channel:t,onClose:r}){return o.jsxs("div",{className:"fixed inset-0 z-50 bg-[var(--color-bg)] flex flex-col","data-testid":"mobile-thread-panel",children:[o.jsxs("div",{className:"flex items-center gap-2 p-3 border-b border-[var(--color-border)]",children:[o.jsx("button",{onClick:r,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors touch-target","data-testid":"mobile-thread-back","aria-label":"Close thread",children:o.jsx(Ul,{className:"w-5 h-5"})}),o.jsx("span",{className:"font-medium text-[var(--color-text)]",children:"Thread"})]}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(jbe,{parentMessage:e,channel:t,onClose:r})})]})}function Ngt(){const e=Ma(),t=tl({from:"/messages"}),r=jo(),{currentUser:n}=rl(),[a,s]=w.useState(""),[i,l]=w.useState(t.channel??null),[c,u]=w.useState(!1),d=w.useRef(null);w.useEffect(()=>{d.current=n?.id??null},[n]);const f=w.useCallback(T=>{if(T.elementType==="message"&&T.eventType==="created"){const O=T.newValue?.channelId,R=T.newValue?.sender;if(R&&d.current&&R===d.current)return;O&&O===i&&Gr.info("New message received",{description:"The conversation has been updated",duration:3e3})}},[i]);w2({channels:i?[`messages:${i}`,"messages"]:["messages"],onEvent:f});const{data:m,isLoading:p,isError:v}=BJe(),b=w.useMemo(()=>YZe({search:a}),[a]),y=w.useMemo(()=>m?[...b?m.filter(b):m].sort((O,R)=>new Date(R.updatedAt).getTime()-new Date(O.updatedAt).getTime()):[],[m,b]),S=m?.length??0;w.useEffect(()=>{t.channel&&t.channel!==i&&l(t.channel),!t.channel&&i&&l(null)},[t.channel]);const _=T=>{l(T),e({to:"/messages",search:{channel:T,message:void 0}})},N=T=>{s(T)},k=T=>{l(T.id),e({to:"/messages",search:{channel:T.id,message:void 0}})},j=()=>{l(null),e({to:"/messages",search:{channel:void 0,message:void 0}})},E=w.useCallback(()=>{l(null),e({to:"/messages",search:{channel:void 0,message:void 0}}),Gr.success("Channel deleted",{description:"The channel has been permanently deleted",duration:3e3})},[e]);return v?o.jsx("div",{"data-testid":"messages-page-error",className:"flex items-center justify-center h-full",children:o.jsxs("div",{className:"text-center px-4",children:[o.jsx("p",{className:"text-red-500 mb-2",children:"Failed to load channels"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Please try refreshing the page"})]})}):r?o.jsxs("div",{"data-testid":"messages-page",className:"flex flex-col h-full relative",children:[!i&&o.jsxs(o.Fragment,{children:[p?o.jsx("div",{"data-testid":"channels-loading",className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading channels..."})}):o.jsx(Pte,{channels:y,selectedChannelId:i,onSelectChannel:_,onNewChannel:()=>u(!0),totalChannels:S,searchQuery:a,onSearchChange:N,isMobile:!0}),o.jsx("button",{onClick:()=>u(!0),className:"fixed bottom-20 right-4 w-14 h-14 bg-blue-500 hover:bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center transition-colors z-30 touch-target","data-testid":"mobile-create-channel-fab","aria-label":"Create new channel",children:o.jsx(dr,{className:"w-6 h-6"})})]}),i&&o.jsx(ure,{channelId:i,isMobile:!0,onBack:j,onChannelDeleted:E}),o.jsx(mZ,{isOpen:c,onClose:()=>u(!1),onSuccess:k})]}):o.jsxs("div",{"data-testid":"messages-page",className:"flex h-full",children:[p?o.jsx("div",{"data-testid":"channels-loading",className:"w-64 border-r border-[var(--color-border)] flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading channels..."})}):o.jsx(Pte,{channels:y,selectedChannelId:i,onSelectChannel:_,onNewChannel:()=>u(!0),totalChannels:S,searchQuery:a,onSearchChange:N,isMobile:!1}),i?o.jsx(ure,{channelId:i,isMobile:!1,onChannelDeleted:E}):o.jsx(qft,{isMobile:!1}),o.jsx(mZ,{isOpen:c,onClose:()=>u(!1),onSuccess:k})]})}function dre({elementType:e,elementId:t,backRoute:r,backLabel:n,onDismiss:a}){const s=Ma(),i=()=>{a?.(),s({to:r})};return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center","data-testid":"element-not-found",children:[o.jsx("div",{className:"mb-4 p-3 bg-yellow-50 rounded-full",children:o.jsx(Rt,{className:"w-8 h-8 text-yellow-500"})}),o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2","data-testid":"not-found-title",children:[e," Not Found"]}),o.jsxs("p",{className:"text-gray-600 mb-1","data-testid":"not-found-message",children:["The ",e.toLowerCase()," you're looking for doesn't exist or has been deleted."]}),o.jsxs("p",{className:"text-sm text-gray-500 font-mono mb-6","data-testid":"not-found-id",children:["ID: ",t]}),o.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors","data-testid":"not-found-back-button",children:[o.jsx(Fx,{className:"w-4 h-4"}),n]})]})}function Cgt({open:e,onClose:t,children:r,title:n,"data-testid":a="mobile-detail-sheet"}){const s=w.useRef(null),i=w.useRef(null),l=w.useRef(0);w.useEffect(()=>{if(e){const f=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=f}}},[e]),w.useEffect(()=>{if(!e)return;const f=m=>{m.key==="Escape"&&t()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[e,t]),w.useEffect(()=>{if(!e)return;window.history.pushState({mobileSheet:!0},"");const f=m=>{m.state?.mobileSheet===void 0&&t()};return window.addEventListener("popstate",f),()=>{window.removeEventListener("popstate",f),window.history.state?.mobileSheet&&window.history.back()}},[e,t]);const c=f=>{i.current=f.touches[0].clientY,l.current=0},u=f=>{i.current!==null&&(l.current=f.touches[0].clientY-i.current,l.current<0&&(l.current=0),s.current&&l.current>0&&(s.current.style.transform=`translateY(${l.current}px)`))},d=()=>{i.current!==null&&(l.current>100?t():s.current&&(s.current.style.transform="translateY(0)"),i.current=null,l.current=0)};return w.useEffect(()=>{e&&s.current&&s.current.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()},[e]),e?o.jsxs("div",{className:"fixed inset-0 z-50","data-testid":a,role:"dialog","aria-modal":"true","aria-label":n||"Detail view",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-200",onClick:t,"data-testid":`${a}-backdrop`,"aria-hidden":"true"}),o.jsxs("div",{ref:s,className:"absolute inset-x-0 bottom-0 top-0 bg-[var(--color-bg)] shadow-2xl flex flex-col transform transition-transform duration-200 ease-out",style:{transform:e?"translateY(0)":"translateY(100%)"},"data-testid":`${a}-content`,children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 border-b border-[var(--color-border)] bg-[var(--color-surface)] sticky top-0 z-10",onTouchStart:c,onTouchMove:u,onTouchEnd:d,children:[o.jsx("div",{className:"absolute top-1 left-1/2 -translate-x-1/2 w-10 h-1 bg-[var(--color-border)] rounded-full"}),o.jsx("button",{onClick:t,className:"p-2 -ml-2 rounded-md text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors duration-150 touch-target","aria-label":"Close","data-testid":`${a}-close`,children:o.jsx(Ul,{className:"w-5 h-5"})}),n&&o.jsx("h2",{className:"flex-1 text-lg font-semibold text-[var(--color-text)] truncate",children:n})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:r})]})]}):null}function jgt(){return pt({queryKey:["libraries"],queryFn:async()=>{const e=await fetch("/api/libraries");if(!e.ok)throw new Error("Failed to fetch libraries");return e.json()}})}function Egt(){const e=ft();return kt({mutationFn:async t=>{const r=await fetch("/api/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to create document")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["libraries"]}),e.invalidateQueries({queryKey:["stats"]})}})}const Mgt=[{value:"text",label:"Plain Text"},{value:"markdown",label:"Markdown"},{value:"json",label:"JSON"}];function fre({isOpen:e,onClose:t,onSuccess:r,defaultLibraryId:n,isMobile:a=!1}){const[s,i]=w.useState(""),[l,c]=w.useState("markdown"),[u,d]=w.useState(""),[f,m]=w.useState([]),[p,v]=w.useState(n||""),b=w.useRef(null),y=Egt(),{data:S}=jgt(),{currentUser:_}=rl();w.useEffect(()=>{e&&b.current&&b.current.focus()},[e]),w.useEffect(()=>{e||(i(""),c("markdown"),d(""),m([]),v(n||""),y.reset())},[e,n]),w.useEffect(()=>{n&&v(n)},[n]);const N=async j=>{if(j.preventDefault(),!s.trim()||!_)return;const E={title:s.trim(),contentType:l,content:u,createdBy:_.id};f.length>0&&(E.tags=f),p&&(E.libraryId=p);try{const T=await y.mutateAsync(E);r?.(T),t()}catch{}},k=j=>{j.key==="Escape"&&t()};return e?o.jsxs("div",{className:`fixed inset-0 z-50 flex ${a?"items-end":"items-start justify-center overflow-y-auto py-8"}`,"data-testid":"create-document-modal",onKeyDown:k,children:[o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t,"data-testid":"create-document-modal-backdrop"}),o.jsx("div",{className:`relative w-full ${a?"h-full":"max-w-lg mx-4"}`,children:o.jsxs("div",{className:`bg-white dark:bg-[var(--color-bg)] ${a?"h-full flex flex-col rounded-t-xl":"rounded-xl"} shadow-2xl border border-gray-200 dark:border-[var(--color-border)] overflow-hidden`,children:[o.jsxs("div",{className:`flex items-center justify-between ${a?"px-4 py-4":"px-4 py-3"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(rn,{className:"w-5 h-5 text-blue-500"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-[var(--color-text)]",children:"Create Document"})]}),o.jsx("button",{onClick:t,className:`${a?"p-2 touch-target":"p-1"} text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded`,"aria-label":"Close","data-testid":"create-document-modal-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:N,className:`${a?"flex-1 overflow-y-auto":""} p-4`,children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"document-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Title ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:b,id:"document-title",type:"text",value:s,onChange:j=>i(j.target.value),placeholder:"Enter document title...",className:`w-full px-3 ${a?"py-3":"py-2"} border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`,"data-testid":"create-document-title-input",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"document-content-type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Content Type"}),o.jsx("select",{id:"document-content-type",value:l,onChange:j=>c(j.target.value),className:`w-full px-3 ${a?"py-3":"py-2"} border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`,"data-testid":"create-document-content-type-select",children:Mgt.map(j=>o.jsx("option",{value:j.value,children:j.label},j.value))})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"document-library",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Library (optional)"}),o.jsxs("select",{id:"document-library",value:p,onChange:j=>v(j.target.value),className:`w-full px-3 ${a?"py-3":"py-2"} border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`,"data-testid":"create-document-library-select",children:[o.jsx("option",{value:"",children:"No library"}),S?.map(j=>o.jsx("option",{value:j.id,children:j.name},j.id))]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"document-content",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Initial Content"}),o.jsx("textarea",{id:"document-content",value:u,onChange:j=>d(j.target.value),placeholder:l==="json"?`{
  "key": "value"
}`:l==="markdown"?`# Heading

Start writing...`:"Start writing...",className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono text-sm ${a?"min-h-[150px]":""}`,"data-testid":"create-document-content-textarea",rows:a?8:6})]}),o.jsxs("div",{className:`${a?"mb-4":"mb-6"}`,children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tags"}),o.jsx(ij,{tags:f,onChange:m,placeholder:"Type and press comma to add tags","data-testid":"create-document-tags-input"})]}),y.isError&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-md text-sm text-red-700 dark:text-red-300","data-testid":"create-document-error",children:y.error?.message||"Failed to create document"}),o.jsx("div",{className:`${a?"sticky bottom-0 pt-4 pb-safe bg-white dark:bg-[var(--color-bg)] border-t border-gray-200 dark:border-[var(--color-border)] -mx-4 px-4":""} flex items-center ${a?"flex-col gap-3":"justify-end gap-3"}`,children:a?o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"submit",disabled:y.isPending||!s.trim()||!_,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"create-document-submit-button",children:y.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Document"]})}),o.jsx("button",{type:"button",onClick:t,className:"w-full px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors touch-target","data-testid":"create-document-cancel-button",children:"Cancel"})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors","data-testid":"create-document-cancel-button",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:y.isPending||!s.trim()||!_,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"create-document-submit-button",children:y.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Document"]})})]})})]})]})})]}):null}function Tgt(){return pt({queryKey:["libraries"],queryFn:async()=>{const e=await fetch("/api/libraries");if(!e.ok)throw new Error("Failed to fetch libraries");return e.json()}})}function Agt(){const e=ft();return kt({mutationFn:async t=>{const r=await fetch("/api/libraries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to create library")}return r.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["libraries"]}),e.invalidateQueries({queryKey:["stats"]})}})}function hre({isOpen:e,onClose:t,onSuccess:r,defaultParentId:n}){const[a,s]=w.useState(""),[i,l]=w.useState([]),[c,u]=w.useState(n||""),d=w.useRef(null),f=Agt(),{data:m}=Tgt(),{currentUser:p}=rl();w.useEffect(()=>{e&&d.current&&d.current.focus()},[e]),w.useEffect(()=>{e||(s(""),l([]),u(n||""),f.reset())},[e,n]),w.useEffect(()=>{n&&u(n)},[n]);const v=async S=>{if(S.preventDefault(),!a.trim()||!p)return;const _={name:a.trim(),createdBy:p.id};i.length>0&&(_.tags=i),c&&(_.parentId=c);try{const N=await f.mutateAsync(_);r?.(N),t()}catch{}},b=S=>{S.key==="Escape"&&t()},y=o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors touch-target","data-testid":"create-library-cancel-button",children:"Cancel"}),o.jsx("button",{type:"button",onClick:v,disabled:f.isPending||!a.trim()||!p,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed touch-target","data-testid":"create-library-submit-button",children:f.isPending?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):o.jsxs(o.Fragment,{children:[o.jsx(dr,{className:"w-4 h-4"}),"Create"]})})]});return o.jsx(Ux,{open:e,onClose:t,title:"Create Library",icon:o.jsx(K6,{className:"w-5 h-5 text-purple-500"}),size:"md","data-testid":"create-library-modal",footer:y,children:o.jsxs("form",{onSubmit:v,className:"p-4",onKeyDown:b,children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"library-name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{ref:d,id:"library-name",type:"text",value:a,onChange:S=>s(S.target.value),placeholder:"Enter library name...",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent touch-target","data-testid":"create-library-name-input",required:!0,maxLength:100}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"1-100 characters"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{htmlFor:"library-parent",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Parent Library ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsxs("select",{id:"library-parent",value:c,onChange:S=>u(S.target.value),className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-[var(--color-text)] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent touch-target","data-testid":"create-library-parent-select",children:[o.jsx("option",{value:"",children:"No parent (root library)"}),m?.map(S=>o.jsx("option",{value:S.id,children:S.name},S.id))]}),o.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Nest this library under another library"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tags ",o.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs font-normal",children:"(optional)"})]}),o.jsx(ij,{tags:i,onChange:l,placeholder:"Type and press comma to add tags","data-testid":"create-library-tags-input"})]}),f.isError&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-700 dark:text-red-400","data-testid":"create-library-error",children:f.error?.message||"Failed to create library"})]})})}const Dgt=300,Ebe=64,Lgt=36,mre={text:{label:"Plain Text",icon:o.jsx(use,{className:"w-4 h-4"}),color:"bg-gray-100 text-gray-700"},markdown:{label:"Markdown",icon:o.jsx(qp,{className:"w-4 h-4"}),color:"bg-purple-100 text-purple-700"},json:{label:"JSON",icon:o.jsx(Kp,{className:"w-4 h-4"}),color:"bg-blue-100 text-blue-700"}};function Ogt(e){const t=RB(e,Dgt);return pt({queryKey:["documents","search",t],queryFn:async()=>{if(!t.trim())return{results:[],query:""};const r=await fetch(`/api/documents/search?q=${encodeURIComponent(t)}&limit=10`);if(!r.ok)throw new Error("Failed to search documents");return r.json()},enabled:t.trim().length>0,staleTime:3e4})}function Igt(){return pt({queryKey:["libraries"],queryFn:async()=>{const e=await fetch("/api/libraries?limit=10000&hydrate.description=true");if(!e.ok)throw new Error("Failed to fetch libraries");const t=await e.json();return Array.isArray(t)?t:t.items||[]}})}function Mbe(e){return pt({queryKey:["libraries",e],queryFn:async()=>{if(!e)throw new Error("No library selected");const t=await fetch(`/api/libraries/${e}?hydrate.description=true`);if(!t.ok)throw new Error("Failed to fetch library");return t.json()},enabled:!!e})}function Rgt(e){return pt({queryKey:["libraries",e,"documents"],queryFn:async()=>{if(!e)throw new Error("No library selected");const t=await fetch(`/api/libraries/${e}/documents`);if(!t.ok)throw new Error("Failed to fetch documents");return t.json()},enabled:!!e})}function Pgt(e){return pt({queryKey:["documents",e],queryFn:async()=>{if(!e)throw new Error("No document selected");const t=await fetch(`/api/documents/${e}`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch document")}return t.json()},enabled:!!e})}function zgt(){const e=ft();return kt({mutationFn:async({id:t,updates:r})=>{const n=await fetch(`/api/documents/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to update document")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r.id]}),e.invalidateQueries({queryKey:["libraries"]})}})}function Bgt(e){return pt({queryKey:["documents",e,"versions"],queryFn:async()=>{if(!e)throw new Error("No document selected");const t=await fetch(`/api/documents/${e}/versions`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch document versions")}return t.json()},enabled:!!e})}function $gt(e,t){return pt({queryKey:["documents",e,"versions",t],queryFn:async()=>{if(!e||!t)throw new Error("No document or version selected");const r=await fetch(`/api/documents/${e}/versions/${t}`);if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to fetch document version")}return r.json()},enabled:!!e&&!!t})}function Fgt(){const e=ft();return kt({mutationFn:async({id:t,version:r})=>{const n=await fetch(`/api/documents/${t}/restore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({version:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to restore document version")}return n.json()},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r.id]}),e.invalidateQueries({queryKey:["documents",r.id,"versions"]}),e.invalidateQueries({queryKey:["libraries"]})}})}function Ugt(){const e=ft();return kt({mutationFn:async({id:t,createdBy:r,title:n,libraryId:a})=>{const s=await fetch(`/api/documents/${t}/clone`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({createdBy:r,title:n,libraryId:a})});if(!s.ok){const i=await s.json();throw new Error(i.error?.message||"Failed to clone document")}return s.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["libraries"]})}})}function Hgt(e){return pt({queryKey:["documents",e,"links"],queryFn:async()=>{if(!e)throw new Error("No document selected");const t=await fetch(`/api/documents/${e}/links`);if(!t.ok){const r=await t.json();throw new Error(r.error?.message||"Failed to fetch document links")}return t.json()},enabled:!!e})}function qgt(){const e=ft();return kt({mutationFn:async({blockedId:t,targetDocumentId:r})=>{const n=await fetch(`/api/documents/${t}/links`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetDocumentId:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to link document")}return n.json()},onSuccess:(t,{blockedId:r,targetDocumentId:n})=>{e.invalidateQueries({queryKey:["documents",r,"links"]}),e.invalidateQueries({queryKey:["documents",n,"links"]})}})}function Wgt(){const e=ft();return kt({mutationFn:async({blockedId:t,blockerId:r})=>{const n=await fetch(`/api/documents/${t}/links/${r}`,{method:"DELETE"});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to remove document link")}return n.json()},onSuccess:(t,{blockedId:r,blockerId:n})=>{e.invalidateQueries({queryKey:["documents",r,"links"]}),e.invalidateQueries({queryKey:["documents",n,"links"]})}})}function Kgt(){return pt({queryKey:["documents","all"],queryFn:async()=>{const e=await fetch("/api/documents?limit=10000");if(!e.ok){const r=await e.json();throw new Error(r.error?.message||"Failed to fetch documents")}const t=await e.json();return t.items||t}})}function Ggt(){const e=ft();return kt({mutationFn:async({documentId:t,libraryId:r,actor:n})=>{const a=await fetch(`/api/documents/${t}/library`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({libraryId:r,actor:n})});if(!a.ok){const s=await a.json();throw new Error(s.error?.message||"Failed to move document")}return a.json()},onSuccess:(t,{documentId:r})=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r]}),e.invalidateQueries({queryKey:["libraries"]})}})}function Vgt(){const e=ft();return kt({mutationFn:async({documentId:t})=>{const r=await fetch(`/api/documents/${t}/library`,{method:"DELETE"});if(!r.ok){const n=await r.json();throw new Error(n.error?.message||"Failed to remove document from library")}return r.json()},onSuccess:(t,{documentId:r})=>{e.invalidateQueries({queryKey:["documents"]}),e.invalidateQueries({queryKey:["documents",r]}),e.invalidateQueries({queryKey:["libraries"]})}})}function Ygt(){const e=ft();return kt({mutationFn:async({libraryId:t,parentId:r,index:n,actor:a})=>{const s=await fetch(`/api/libraries/${t}/parent`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({parentId:r,index:n,actor:a})});if(!s.ok){const i=await s.json();throw new Error(i.error?.message||"Failed to move library")}return s.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["libraries"]})}})}function Qgt(){const e=ft();return kt({mutationFn:async({libraryId:t,index:r})=>{const n=await fetch(`/api/libraries/${t}/order`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:r})});if(!n.ok){const a=await n.json();throw new Error(a.error?.message||"Failed to reorder library")}return n.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["libraries"]})}})}function Jgt(e){const t=new Map,r=[];for(const a of e)t.set(a.id,{...a,children:[]});for(const a of e){const s=t.get(a.id);a.parentId&&t.has(a.parentId)?t.get(a.parentId).children.push(s):r.push(s)}const n=a=>{a.some(i=>i.metadata?.sortIndex!==void 0)?a.sort((i,l)=>{const c=i.metadata?.sortIndex??1/0,u=l.metadata?.sortIndex??1/0;return c!==u?c-u:i.name.localeCompare(l.name)}):a.sort((i,l)=>i.name.localeCompare(l.name));for(const i of a)n(i.children)};return n(r),r}function p5(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function g5(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:p5(e)}function pre(e,t){if(!t||!e)return e;const r=e.toLowerCase(),n=t.toLowerCase(),a=r.indexOf(n);return a===-1?e:o.jsxs(o.Fragment,{children:[e.slice(0,a),o.jsx("mark",{className:"bg-yellow-200 text-gray-900 rounded-sm px-0.5",children:e.slice(a,a+t.length)}),e.slice(a+t.length)]})}function Zgt({onSelectDocument:e}){const[t,r]=w.useState(""),[n,a]=w.useState(!1),s=w.useRef(null),i=w.useRef(null),{data:l,isLoading:c,isFetching:u}=Ogt(t);w.useEffect(()=>{function y(S){i.current&&!i.current.contains(S.target)&&a(!1)}return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),w.useEffect(()=>{function y(S){S.key==="/"&&!(S.target instanceof HTMLInputElement||S.target instanceof HTMLTextAreaElement)&&(S.preventDefault(),s.current?.focus()),S.key==="Escape"&&document.activeElement===s.current&&(S.preventDefault(),t?r(""):(a(!1),s.current?.blur()))}return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[t]);const d=y=>{r(y.target.value),a(!0)},f=()=>{r(""),a(!1),s.current?.focus()},m=y=>{e(y),r(""),a(!1)},p=n&&t.trim().length>0,v=l?.results||[],b=(c||u)&&t.trim().length>0;return o.jsxs("div",{ref:i,className:"relative","data-testid":"document-search-container",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{ref:s,type:"text",value:t,onChange:d,onFocus:()=>t.trim()&&a(!0),placeholder:"Search docs... (/)",className:"w-full pl-9 pr-8 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","data-testid":"document-search-input","aria-label":"Search documents"}),t&&o.jsx("button",{onClick:f,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600 rounded","data-testid":"document-search-clear","aria-label":"Clear search",children:o.jsx(yt,{className:"w-3 h-3"})})]}),p&&o.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-80 overflow-y-auto","data-testid":"document-search-results",children:[b&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-500",children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Searching..."]}),!b&&v.length===0&&o.jsxs("div",{className:"px-3 py-4 text-sm text-gray-500 text-center","data-testid":"document-search-no-results",children:['No documents found for "',t,'"']}),!b&&v.length>0&&o.jsx("div",{"data-testid":"document-search-results-list",children:v.map(y=>o.jsxs("button",{onClick:()=>m(y.id),className:"w-full text-left px-3 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 focus:bg-gray-50 focus:outline-none","data-testid":`document-search-result-${y.id}`,children:[o.jsxs("div",{className:"font-medium text-gray-900 text-sm truncate",children:[o.jsx(rn,{className:"inline w-4 h-4 text-blue-400 mr-1.5"}),pre(y.title,t)]}),y.snippet&&o.jsx("div",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2","data-testid":`document-search-snippet-${y.id}`,children:pre(y.snippet,t)}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-1",children:[o.jsx("span",{className:`px-1.5 py-0.5 rounded ${y.matchType==="content"?"bg-yellow-100 text-yellow-700":y.matchType==="both"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:y.matchType==="title"?"Title match":y.matchType==="content"?"Content match":"Title & content"}),o.jsx("span",{children:y.contentType})]})]},y.id))})]})]})}function Tbe({document:e,isSelected:t,onClick:r,libraryId:n=null,draggable:a=!0}){const s=new Date(e.updatedAt).toLocaleDateString(),i=e.title||`Document ${e.id}`,l=e.metadata?.icon,c={type:"document",id:e.id,sourceLibraryId:n,name:i},{attributes:u,listeners:d,setNodeRef:f,transform:m,isDragging:p}=Epe({id:`document-drag-${e.id}`,data:c,disabled:!a}),v=m?{transform:$l.Translate.toString(m),zIndex:p?999:void 0}:void 0;return o.jsxs("div",{ref:f,style:v,"data-testid":`document-item-${e.id}`,onClick:()=>r?.(e.id),className:`group flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${p?"opacity-50 border-blue-300 bg-blue-50 shadow-lg":t?"border-blue-300 bg-blue-50":"border-gray-100 hover:border-gray-200 hover:bg-gray-50"}`,children:[a&&o.jsx("div",{...u,...d,className:"flex-shrink-0 cursor-grab active:cursor-grabbing p-1 -ml-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-opacity","data-testid":`document-drag-handle-${e.id}`,onClick:b=>b.stopPropagation(),children:o.jsx(ise,{className:"w-4 h-4 text-gray-400"})}),l?o.jsx("span",{className:"w-8 h-8 flex items-center justify-center text-2xl flex-shrink-0","data-testid":`document-icon-${e.id}`,children:l}):o.jsx(rn,{className:`w-8 h-8 flex-shrink-0 ${t?"text-blue-500":"text-blue-400"}`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{"data-testid":`document-title-${e.id}`,className:`font-medium truncate ${t?"text-blue-900":"text-gray-900"}`,children:i}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-0.5",children:[o.jsx("span",{"data-testid":`document-type-${e.id}`,children:e.contentType}),o.jsx("span",{children:""}),o.jsx("span",{"data-testid":`document-date-${e.id}`,children:s})]})]})]})}function gre({data:e}){return o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-blue-300 max-w-xs",children:[o.jsx(rn,{className:"w-5 h-5 text-blue-500 flex-shrink-0"}),o.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.name})]})}function Xgt(e){if(!e)return!1;const t=e.trim();return t.startsWith("<")&&(t.startsWith("<p>")||t.startsWith("<div>")||t.startsWith("<h1>")||t.startsWith("<h2>")||t.startsWith("<h3>")||t.startsWith("<ul>")||t.startsWith("<ol>")||t.startsWith("<blockquote>"))}function e0t({content:e,contentType:t}){if(!e)return o.jsx("div",{"data-testid":"document-content-empty",className:"text-gray-400 italic",children:"No content"});switch(t){case"json":try{const r=JSON.stringify(JSON.parse(e),null,2);return o.jsx("pre",{"data-testid":"document-content-json",className:"whitespace-pre-wrap font-mono text-sm bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:o.jsx("code",{children:r})})}catch{return o.jsx("pre",{"data-testid":"document-content-json",className:"whitespace-pre-wrap font-mono text-sm bg-gray-900 text-gray-100 rounded-lg p-4 overflow-x-auto",children:o.jsx("code",{children:e})})}case"markdown":case"text":default:{if(Xgt(e))return o.jsx("div",{"data-testid":"document-content-html",className:`prose prose-sm max-w-none text-gray-700
                       prose-headings:mt-4 prose-headings:mb-2 prose-headings:font-semibold
                       prose-h1:text-2xl prose-h2:text-xl prose-h3:text-lg
                       prose-p:my-2 prose-ul:my-2 prose-ol:my-2 prose-li:my-0.5
                       prose-blockquote:border-l-4 prose-blockquote:border-gray-300 prose-blockquote:pl-4 prose-blockquote:italic
                       prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-pre:rounded-lg prose-pre:p-4
                       prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm
                       [&_mark]:bg-yellow-200 [&_mark]:px-0.5`,dangerouslySetInnerHTML:{__html:e}});const r=epe(e);return o.jsx("div",{"data-testid":"document-content-markdown",className:`prose prose-sm max-w-none text-gray-700
                     prose-headings:mt-4 prose-headings:mb-2 prose-headings:font-semibold
                     prose-h1:text-2xl prose-h2:text-xl prose-h3:text-lg
                     prose-p:my-2 prose-ul:my-2 prose-ol:my-2 prose-li:my-0.5
                     prose-blockquote:border-l-4 prose-blockquote:border-gray-300 prose-blockquote:pl-4 prose-blockquote:italic
                     prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-pre:rounded-lg prose-pre:p-4
                     prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm
                     [&_mark]:bg-yellow-200 [&_mark]:px-0.5`,dangerouslySetInnerHTML:{__html:r}})}}}function t0t({documentId:e,currentVersion:t,onPreviewVersion:r,previewingVersion:n,onClose:a}){const{data:s=[],isLoading:i,error:l}=Bgt(e),c=Fgt(),u=async d=>{if(confirm(`Restore to version ${d}? This will create a new version with the restored content.`))try{await c.mutateAsync({id:e,version:d}),r(null)}catch{}};return o.jsxs("div",{"data-testid":"version-history-sidebar",className:"w-72 border-l border-gray-200 bg-gray-50 flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 bg-white",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(eh,{className:"w-4 h-4 text-gray-500"}),o.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:"Version History"})]}),o.jsx("button",{onClick:a,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","aria-label":"Close version history","data-testid":"version-history-close",children:o.jsx(yt,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[i&&o.jsx("div",{"data-testid":"version-history-loading",className:"text-center text-gray-500 text-sm py-4",children:"Loading versions..."}),l&&o.jsx("div",{"data-testid":"version-history-error",className:"text-center text-red-500 text-sm py-4",children:"Failed to load versions"}),!i&&!l&&s.length===0&&o.jsx("div",{"data-testid":"version-history-empty",className:"text-center text-gray-500 text-sm py-4",children:"No version history available"}),!i&&!l&&s.length>0&&o.jsx("div",{"data-testid":"version-history-list",className:"space-y-1",children:s.map(d=>{const f=d.version===t,m=n===d.version;return o.jsxs("div",{"data-testid":`version-item-${d.version}`,className:`p-2 rounded-md ${m?"bg-blue-100 border border-blue-300":f?"bg-green-50 border border-green-200":"bg-white border border-gray-100 hover:border-gray-200"}`,children:[o.jsx("div",{className:"flex items-center justify-between mb-1",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"font-medium text-sm text-gray-900",children:["v",d.version]}),f&&o.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded",children:"Current"}),m&&o.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded",children:"Previewing"})]})}),o.jsx("div",{className:"text-xs text-gray-500 mb-2",children:g5(d.updatedAt)}),o.jsx("div",{className:"flex items-center gap-1",children:!f&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>r(m?null:d.version),"data-testid":`version-preview-${d.version}`,className:`flex items-center gap-1 px-2 py-1 text-xs rounded ${m?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[o.jsx(du,{className:"w-3 h-3"}),m?"Exit Preview":"Preview"]}),o.jsxs("button",{onClick:()=>u(d.version),disabled:c.isPending,"data-testid":`version-restore-${d.version}`,className:"flex items-center gap-1 px-2 py-1 text-xs rounded bg-orange-100 text-orange-700 hover:bg-orange-200 disabled:opacity-50",children:[o.jsx(Ri,{className:"w-3 h-3"}),"Restore"]})]})})]},d.version)})})]}),c.isError&&o.jsx("div",{className:"p-2 m-2 bg-red-50 text-red-700 text-xs rounded",children:c.error?.message||"Failed to restore version"})]})}function r0t({isOpen:e,onClose:t,onSelectDocument:r,currentDocumentId:n,existingLinkIds:a}){const[s,i]=w.useState(""),{data:l=[],isLoading:c}=Kgt(),u=l.filter(d=>{if(d.id===n||a.includes(d.id))return!1;if(s.trim()){const f=s.toLowerCase();return d.title?.toLowerCase().includes(f)||d.id.toLowerCase().includes(f)}return!0});return ce.useEffect(()=>{if(!e)return;const d=f=>{f.key==="Escape"&&t()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[e,t]),e?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"document-link-picker-modal",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:t}),o.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[80vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[o.jsx(Ix,{className:"w-5 h-5 text-blue-500"}),"Link Document"]}),o.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded","aria-label":"Close","data-testid":"document-link-picker-close",children:o.jsx(yt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-4 border-b border-gray-100",children:o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:s,onChange:d=>i(d.target.value),placeholder:"Search documents by title or ID...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0,"data-testid":"document-link-search"})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c?o.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading documents..."}):u.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:s.trim()?"No matching documents found":"No documents available to link"}):o.jsx("div",{className:"space-y-2","data-testid":"document-link-list",children:u.map(d=>o.jsxs("button",{onClick:()=>r(d.id),className:"w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 text-left transition-colors","data-testid":`document-link-option-${d.id}`,children:[o.jsx(rn,{className:"w-5 h-5 text-blue-400 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 truncate",children:d.title||`Document ${d.id}`}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:d.id}),o.jsx("span",{children:""}),o.jsx("span",{children:d.contentType})]})]}),o.jsx(qh,{className:"w-4 h-4 text-gray-400"})]},d.id))})})]})]}):null}function vre({document:e,direction:t,onRemove:r,onNavigate:n,isRemoving:a}){return o.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-gray-300 transition-colors group","data-testid":`linked-document-${e.id}`,children:[o.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center ${t==="outgoing"?"bg-blue-100":"bg-green-100"}`,title:t==="outgoing"?"Links to":"Linked from",children:t==="outgoing"?o.jsx(qh,{className:"w-3 h-3 text-blue-600"}):o.jsx(Fx,{className:"w-3 h-3 text-green-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("button",{onClick:n,className:"font-medium text-gray-900 hover:text-blue-600 truncate block text-left w-full","data-testid":`linked-document-title-${e.id}`,children:e.title||`Document ${e.id}`}),o.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[o.jsx("span",{className:"font-mono",children:e.id}),o.jsx("span",{children:""}),o.jsx("span",{children:e.contentType})]})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:n,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Open document","data-testid":`linked-document-open-${e.id}`,children:o.jsx(wl,{className:"w-4 h-4"})}),t==="outgoing"&&o.jsx("button",{onClick:r,disabled:a,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Remove link","data-testid":`linked-document-remove-${e.id}`,children:o.jsx(ese,{className:"w-4 h-4"})})]})]})}function n0t({documentId:e,onNavigateToDocument:t}){const[r,n]=w.useState(!0),[a,s]=w.useState(!1),{data:i,isLoading:l,isError:c}=Hgt(e),u=qgt(),d=Wgt(),f=i?.outgoing||[],m=i?.incoming||[],p=f.length+m.length,v=S=>{u.mutate({blockedId:e,targetDocumentId:S}),s(!1)},b=S=>{d.mutate({blockedId:e,blockerId:S})},y=f.map(S=>S.id);return o.jsxs("div",{className:"mb-6","data-testid":"linked-documents-section",children:[o.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-medium text-gray-500 uppercase tracking-wide mb-2 hover:text-gray-700 w-full","data-testid":"linked-documents-toggle",children:[r?o.jsx(Yt,{className:"w-3 h-3"}):o.jsx(gn,{className:"w-3 h-3"}),o.jsx(Ix,{className:"w-3 h-3"}),o.jsx("span",{children:"Linked Documents"}),p>0&&o.jsxs("span",{className:"text-gray-400 font-normal",children:["(",p,")"]})]}),r&&o.jsxs("div",{className:"space-y-4",children:[l&&o.jsx("div",{className:"text-sm text-gray-500",children:"Loading links..."}),c&&o.jsx("div",{className:"text-sm text-red-500",children:"Failed to load links"}),!l&&!c&&o.jsxs(o.Fragment,{children:[f.length>0&&o.jsxs("div",{"data-testid":"outgoing-links-section",children:[o.jsxs("div",{className:"text-xs text-gray-500 mb-2 flex items-center gap-1",children:[o.jsx(qh,{className:"w-3 h-3"}),"Links to (",f.length,")"]}),o.jsx("div",{className:"space-y-2",children:f.map(S=>o.jsx(vre,{document:S,direction:"outgoing",onRemove:()=>b(S.id),onNavigate:()=>t(S.id),isRemoving:d.isPending},S.id))})]}),m.length>0&&o.jsxs("div",{"data-testid":"incoming-links-section",children:[o.jsxs("div",{className:"text-xs text-gray-500 mb-2 flex items-center gap-1",children:[o.jsx(Fx,{className:"w-3 h-3"}),"Linked from (",m.length,")"]}),o.jsx("div",{className:"space-y-2",children:m.map(S=>o.jsx(vre,{document:S,direction:"incoming",onRemove:()=>{},onNavigate:()=>t(S.id),isRemoving:!1},S.id))})]}),p===0&&o.jsx("div",{className:"text-sm text-gray-400 italic","data-testid":"no-links-message",children:"No linked documents"}),o.jsxs("button",{onClick:()=>s(!0),disabled:u.isPending,className:"inline-flex items-center gap-1.5 text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50","data-testid":"add-document-link-button",children:[o.jsx(dr,{className:"w-4 h-4"}),"Link Document"]}),u.isError&&o.jsx("div",{className:"text-sm text-red-500 mt-2",children:u.error?.message||"Failed to add link"}),d.isError&&o.jsx("div",{className:"text-sm text-red-500 mt-2",children:d.error?.message||"Failed to remove link"})]})]}),o.jsx(r0t,{isOpen:a,onClose:()=>s(!1),onSelectDocument:v,currentDocumentId:e,existingLinkIds:y})]})}const Abe=w.createContext(null);function Hi(){const e=w.useContext(Abe);if(e===null)throw new Error("No Tree Api Provided");return e}const Dbe=w.createContext(null);function a0t(){const e=w.useContext(Dbe);if(e===null)throw new Error("Provide a NodesContext");return e}const Lbe=w.createContext(null);function s0t(){const e=w.useContext(Lbe);if(e===null)throw new Error("Provide a DnDContext");return e}const Obe=w.createContext(0);function Ibe(){w.useContext(Obe)}function Gk(e,t,r){return Math.max(Math.min(e,r),t)}function Rbe(e){return e&&e.isLeaf}function Pbe(e){return e&&e.isInternal&&!e.isOpen}function zbe(e){var t;return e&&e.isOpen&&!(!((t=e.children)===null||t===void 0)&&t.length)}const Bbe=(e,t)=>{let r=e;for(;r;){if(r.id===t.id)return!0;r=r.parent}return!1},$be=e=>{if(!e.parent)throw Error("Node does not have a parent");return e.parent.children.findIndex(t=>t.id===e.id)};function $$(e,t){if(!e)return null;if(e.id===t)return e;if(e.children)for(let r of e.children){const n=$$(r,t);if(n)return n}return null}function DC(e,t){if(t(e),e.children)for(let r of e.children)DC(r,t)}function Fbe(e){const t=Hbe(e);let r;for(let n=0;n<t.length;++n)if(t[n]===e){r=i0t(t,n);break}r?.focus()}function Ube(e){const t=Hbe(e);let r;for(let n=0;n<t.length;++n)if(t[n]===e){r=o0t(t,n);break}r?.focus()}function i0t(e,t){return t+1<e.length?e[t+1]:e[0]}function o0t(e,t){return t-1>=0?e[t-1]:e[e.length-1]}function Hbe(e){return Array.from(document.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]):not([disabled]), details:not([disabled]), summary:not(:disabled)')).filter(t=>t===e||!e.contains(t))}function Cb(e,t){return typeof t=="boolean"?t:typeof t=="string"?e[t]:t(e)}function qbe(e){return e===null?null:qf(e)}function qf(e){return typeof e=="string"?e:e.id}function Wbe(e,...t){if(e)return e(...t)}function Kbe(e){return new Promise((t,r)=>{let n=0;function a(){n+=1,n===100&&r(),e()?t():setTimeout(a,10)}a()})}function Gbe(e){var t,r;const n=e.focusedNode;return n?n.isOpen?0:n.parent?n.childIndex+1:0:(r=(t=e.root.children)===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0}function Vbe(e){const t=e.focusedNode;return t?t.isOpen?t.id:t.parent&&!t.parent.isRoot?t.parent.id:null:null}const l0t=Object.freeze(Object.defineProperty({__proto__:null,access:Cb,bound:Gk,dfs:$$,focusNextElement:Fbe,focusPrevElement:Ube,getInsertIndex:Gbe,getInsertParentId:Vbe,identify:qf,identifyNull:qbe,indexOf:$be,isClosed:Pbe,isDescendant:Bbe,isItem:Rbe,isOpenWithEmptyChildren:zbe,safeRun:Wbe,waitFor:Kbe,walk:DC},Symbol.toStringTag,{value:"Module"})),c0t={display:"flex",alignItems:"center",zIndex:1},u0t={flex:1,height:"2px",background:"#4B91E2",borderRadius:"1px"},d0t={width:"4px",height:"4px",boxShadow:"0 0 0 3px #4B91E2",borderRadius:"50%"},f0t=ce.memo(function({top:t,left:r,indent:n}){const a={position:"absolute",pointerEvents:"none",top:t-2+"px",left:r+"px",right:n+"px"};return o.jsxs("div",{style:Object.assign(Object.assign({},c0t),a),children:[o.jsx("div",{style:Object.assign({},d0t)}),o.jsx("div",{style:Object.assign({},u0t)})]})});function h0t({node:e,attrs:t,innerRef:r,children:n}){return o.jsx("div",Object.assign({},t,{ref:r,onFocus:a=>a.stopPropagation(),onClick:e.handleClick,children:n}))}function m0t(e){return o.jsxs("div",{ref:e.dragHandle,style:e.style,children:[o.jsx("span",{onClick:t=>{t.stopPropagation(),e.node.toggle()},children:e.node.isLeaf?"":e.node.isOpen?"":""})," ",e.node.isEditing?o.jsx(g0t,Object.assign({},e)):o.jsx(p0t,Object.assign({},e))]})}function p0t(e){return o.jsx(o.Fragment,{children:o.jsx("span",{children:e.node.data.name})})}function g0t({node:e}){const t=w.useRef();return w.useEffect(()=>{var r,n;(r=t.current)===null||r===void 0||r.focus(),(n=t.current)===null||n===void 0||n.select()},[]),o.jsx("input",{ref:t,defaultValue:e.data.name,onBlur:()=>e.reset(),onKeyDown:r=>{var n;r.key==="Escape"&&e.reset(),r.key==="Enter"&&e.submit(((n=t.current)===null||n===void 0?void 0:n.value)||"")}})}function tO(e){return{type:"EDIT",id:e}}function v0t(e={id:null},t){return t.type==="EDIT"?Object.assign(Object.assign({},e),{id:t.id}):e}function up(e){return{type:"FOCUS",id:e}}function b0t(){return{type:"TREE_BLUR"}}function y0t(e={id:null,treeFocused:!1},t){return t.type==="FOCUS"?Object.assign(Object.assign({},e),{id:t.id,treeFocused:!0}):t.type==="TREE_BLUR"?Object.assign(Object.assign({},e),{treeFocused:!1}):e}class LC{constructor(t){this.handleClick=r=>{r.metaKey&&!this.tree.props.disableMultiSelection?this.isSelected?this.deselect():this.selectMulti():r.shiftKey&&!this.tree.props.disableMultiSelection?this.selectContiguous():(this.select(),this.activate())},this.tree=t.tree,this.id=t.id,this.data=t.data,this.level=t.level,this.children=t.children,this.parent=t.parent,this.isDraggable=t.isDraggable,this.rowIndex=t.rowIndex}get isRoot(){return this.id===jx}get isLeaf(){return!Array.isArray(this.children)}get isInternal(){return!this.isLeaf}get isOpen(){return this.isLeaf?!1:this.tree.isOpen(this.id)}get isClosed(){return this.isLeaf?!1:!this.tree.isOpen(this.id)}get isEditable(){return this.tree.isEditable(this.data)}get isEditing(){return this.tree.editingId===this.id}get isSelected(){return this.tree.isSelected(this.id)}get isOnlySelection(){return this.isSelected&&this.tree.hasOneSelection}get isSelectedStart(){var t;return this.isSelected&&!(!((t=this.prev)===null||t===void 0)&&t.isSelected)}get isSelectedEnd(){var t;return this.isSelected&&!(!((t=this.next)===null||t===void 0)&&t.isSelected)}get isFocused(){return this.tree.isFocused(this.id)}get isDragging(){return this.tree.isDragging(this.id)}get willReceiveDrop(){return this.tree.willReceiveDrop(this.id)}get state(){return{isClosed:this.isClosed,isDragging:this.isDragging,isEditing:this.isEditing,isFocused:this.isFocused,isInternal:this.isInternal,isLeaf:this.isLeaf,isOpen:this.isOpen,isSelected:this.isSelected,isSelectedEnd:this.isSelectedEnd,isSelectedStart:this.isSelectedStart,willReceiveDrop:this.willReceiveDrop}}get childIndex(){return this.parent&&this.parent.children?this.parent.children.findIndex(t=>t.id===this.id):-1}get next(){return this.rowIndex===null?null:this.tree.at(this.rowIndex+1)}get prev(){return this.rowIndex===null?null:this.tree.at(this.rowIndex-1)}get nextSibling(){var t,r;const n=this.childIndex;return(r=(t=this.parent)===null||t===void 0?void 0:t.children[n+1])!==null&&r!==void 0?r:null}isAncestorOf(t){if(!t)return!1;let r=t;for(;r;){if(r.id===this.id)return!0;r=r.parent}return!1}select(){this.tree.select(this)}deselect(){this.tree.deselect(this)}selectMulti(){this.tree.selectMulti(this)}selectContiguous(){this.tree.selectContiguous(this)}activate(){this.tree.activate(this)}focus(){this.tree.focus(this)}toggle(){this.tree.toggle(this)}open(){this.tree.open(this)}openParents(){this.tree.openParents(this)}close(){this.tree.close(this)}submit(t){this.tree.submit(this,t)}reset(){this.tree.reset()}clone(){return new LC(Object.assign({},this))}edit(){return this.tree.edit(this)}}const jx="__REACT_ARBORIST_INTERNAL_ROOT__";function bre(e){var t;function r(s,i,l){const c=e.accessId(s),u=new LC({tree:e,data:s,level:i,parent:l,id:c,children:null,isDraggable:e.isDraggable(s),rowIndex:null}),d=e.accessChildren(s);return d&&(u.children=d.map(f=>r(f,i+1,u))),u}const n=new LC({tree:e,id:jx,data:{id:jx},level:-1,parent:null,children:null,isDraggable:!0,rowIndex:null}),a=(t=e.props.data)!==null&&t!==void 0?t:[];return n.children=a.map(s=>r(s,0,n)),n}const v5={open(e,t){return{type:"VISIBILITY_OPEN",id:e,filtered:t}},close(e,t){return{type:"VISIBILITY_CLOSE",id:e,filtered:t}},toggle(e,t){return{type:"VISIBILITY_TOGGLE",id:e,filtered:t}},clear(e){return{type:"VISIBILITY_CLEAR",filtered:e}}};function yre(e={},t){if(t.type==="VISIBILITY_OPEN")return Object.assign(Object.assign({},e),{[t.id]:!0});if(t.type==="VISIBILITY_CLOSE")return Object.assign(Object.assign({},e),{[t.id]:!1});if(t.type==="VISIBILITY_TOGGLE"){const r=e[t.id];return Object.assign(Object.assign({},e),{[t.id]:!r})}else return t.type==="VISIBILITY_CLEAR"?{}:e}function x0t(e={filtered:{},unfiltered:{}},t){return t.type.startsWith("VISIBILITY")?t.filtered?Object.assign(Object.assign({},e),{filtered:yre(e.filtered,t)}):Object.assign(Object.assign({},e),{unfiltered:yre(e.unfiltered,t)}):e}const Gg=e=>{var t;return{nodes:{open:{filtered:{},unfiltered:(t=e?.initialOpenState)!==null&&t!==void 0?t:{}},focus:{id:null,treeFocused:!1},edit:{id:null},drag:{id:null,selectedIds:[],destinationParentId:null,destinationIndex:null},selection:{ids:new Set,anchor:null,mostRecent:null}},dnd:{cursor:{type:"none"},dragId:null,dragIds:[],parentId:null,index:-1}}},Oo={clear:()=>({type:"SELECTION_CLEAR"}),only:e=>({type:"SELECTION_ONLY",id:qf(e)}),add:e=>({type:"SELECTION_ADD",ids:(Array.isArray(e)?e:[e]).map(qf)}),remove:e=>({type:"SELECTION_REMOVE",ids:(Array.isArray(e)?e:[e]).map(qf)}),set:e=>Object.assign({type:"SELECTION_SET"},e),mostRecent:e=>({type:"SELECTION_MOST_RECENT",id:e===null?null:qf(e)}),anchor:e=>({type:"SELECTION_ANCHOR",id:e===null?null:qf(e)})};function w0t(e=Gg().nodes.selection,t){const r=e.ids;switch(t.type){case"SELECTION_CLEAR":return Object.assign(Object.assign({},e),{ids:new Set});case"SELECTION_ONLY":return Object.assign(Object.assign({},e),{ids:new Set([t.id])});case"SELECTION_ADD":return t.ids.length===0?e:(t.ids.forEach(n=>r.add(n)),Object.assign(Object.assign({},e),{ids:new Set(r)}));case"SELECTION_REMOVE":return t.ids.length===0?e:(t.ids.forEach(n=>r.delete(n)),Object.assign(Object.assign({},e),{ids:new Set(r)}));case"SELECTION_SET":return Object.assign(Object.assign({},e),{ids:t.ids,mostRecent:t.mostRecent,anchor:t.anchor});case"SELECTION_MOST_RECENT":return Object.assign(Object.assign({},e),{mostRecent:t.id});case"SELECTION_ANCHOR":return Object.assign(Object.assign({},e),{anchor:t.id});default:return e}}const Vg={cursor(e){return{type:"DND_CURSOR",cursor:e}},dragStart(e,t){return{type:"DND_DRAG_START",id:e,dragIds:t}},dragEnd(){return{type:"DND_DRAG_END"}},hovering(e,t){return{type:"DND_HOVERING",parentId:e,index:t}}};function S0t(e=Gg().dnd,t){switch(t.type){case"DND_CURSOR":return Object.assign(Object.assign({},e),{cursor:t.cursor});case"DND_DRAG_START":return Object.assign(Object.assign({},e),{dragId:t.id,dragIds:t.dragIds});case"DND_DRAG_END":return Gg().dnd;case"DND_HOVERING":return Object.assign(Object.assign({},e),{parentId:t.parentId,index:t.index});default:return e}}const k0t={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},_0t=e=>{if(!e)return{display:"none"};const{x:t,y:r}=e;return{transform:`translate(${t}px, ${r}px)`}},N0t=e=>{if(!e)return{display:"none"};const{x:t,y:r}=e;return{transform:`translate(${t+10}px, ${r+10}px)`}};function Ybe({offset:e,mouse:t,id:r,dragIds:n,isDragging:a}){return o.jsxs(C0t,{isDragging:a,children:[o.jsx(j0t,{offset:e,children:o.jsx(M0t,{id:r,dragIds:n})}),o.jsx(E0t,{mouse:t,count:n.length})]})}const C0t=w.memo(function(t){return t.isDragging?o.jsx("div",{style:k0t,children:t.children}):null});function j0t(e){return o.jsx("div",{className:"row preview",style:_0t(e.offset),children:e.children})}function E0t(e){const{count:t,mouse:r}=e;return t>1?o.jsx("div",{className:"selected-count",style:N0t(r),children:t}):null}const M0t=w.memo(function(t){const r=Hi(),n=r.get(t.id);return n?o.jsx(r.renderNode,{preview:!0,node:n,style:{paddingLeft:n.level*r.indent,opacity:.2,background:"transparent"},tree:r}):null});var xre=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function T0t(e,t){return!!(e===t||xre(e)&&xre(t))}function A0t(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!T0t(e[r],t[r]))return!1;return!0}function rO(e,t){t===void 0&&(t=A0t);var r,n=[],a,s=!1;function i(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return s&&r===this&&t(l,n)||(a=e.apply(this,l),s=!0,r=this,n=l),a}return i}var D0t=typeof performance=="object"&&typeof performance.now=="function",wre=D0t?function(){return performance.now()}:function(){return Date.now()};function Sre(e){cancelAnimationFrame(e.id)}function L0t(e,t){var r=wre();function n(){wre()-r>=t?e.call(null):a.id=requestAnimationFrame(n)}var a={id:requestAnimationFrame(n)};return a}var nO=-1;function kre(e){if(e===void 0&&(e=!1),nO===-1||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),nO=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return nO}var dp=null;function _re(e){if(e===void 0&&(e=!1),dp===null||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),a=n.style;return a.width="100px",a.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?dp="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?dp="negative":dp="positive-ascending"),document.body.removeChild(t),dp}return dp}var O0t=150,I0t=function(t,r){return t};function R0t(e){var t,r=e.getItemOffset,n=e.getEstimatedTotalSize,a=e.getItemSize,s=e.getOffsetForIndexAndAlignment,i=e.getStartIndexForOffset,l=e.getStopIndexForStartIndex,c=e.initInstanceProps,u=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return t=(function(f){wLe(m,f);function m(v){var b;return b=f.call(this,v)||this,b._instanceProps=c(b.props,NV(b)),b._outerRef=void 0,b._resetIsScrollingTimeoutId=null,b.state={instance:NV(b),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof b.props.initialScrollOffset=="number"?b.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},b._callOnItemsRendered=void 0,b._callOnItemsRendered=rO(function(y,S,_,N){return b.props.onItemsRendered({overscanStartIndex:y,overscanStopIndex:S,visibleStartIndex:_,visibleStopIndex:N})}),b._callOnScroll=void 0,b._callOnScroll=rO(function(y,S,_){return b.props.onScroll({scrollDirection:y,scrollOffset:S,scrollUpdateWasRequested:_})}),b._getItemStyle=void 0,b._getItemStyle=function(y){var S=b.props,_=S.direction,N=S.itemSize,k=S.layout,j=b._getItemStyleCache(u&&N,u&&k,u&&_),E;if(j.hasOwnProperty(y))E=j[y];else{var T=r(b.props,y,b._instanceProps),O=a(b.props,y,b._instanceProps),R=_==="horizontal"||k==="horizontal",H=_==="rtl",$=R?T:0;j[y]=E={position:"absolute",left:H?void 0:$,right:H?$:void 0,top:R?0:T,height:R?"100%":O,width:R?O:"100%"}}return E},b._getItemStyleCache=void 0,b._getItemStyleCache=rO(function(y,S,_){return{}}),b._onScrollHorizontal=function(y){var S=y.currentTarget,_=S.clientWidth,N=S.scrollLeft,k=S.scrollWidth;b.setState(function(j){if(j.scrollOffset===N)return null;var E=b.props.direction,T=N;if(E==="rtl")switch(_re()){case"negative":T=-N;break;case"positive-descending":T=k-_-N;break}return T=Math.max(0,Math.min(T,k-_)),{isScrolling:!0,scrollDirection:j.scrollOffset<T?"forward":"backward",scrollOffset:T,scrollUpdateWasRequested:!1}},b._resetIsScrollingDebounced)},b._onScrollVertical=function(y){var S=y.currentTarget,_=S.clientHeight,N=S.scrollHeight,k=S.scrollTop;b.setState(function(j){if(j.scrollOffset===k)return null;var E=Math.max(0,Math.min(k,N-_));return{isScrolling:!0,scrollDirection:j.scrollOffset<E?"forward":"backward",scrollOffset:E,scrollUpdateWasRequested:!1}},b._resetIsScrollingDebounced)},b._outerRefSetter=function(y){var S=b.props.outerRef;b._outerRef=y,typeof S=="function"?S(y):S!=null&&typeof S=="object"&&S.hasOwnProperty("current")&&(S.current=y)},b._resetIsScrollingDebounced=function(){b._resetIsScrollingTimeoutId!==null&&Sre(b._resetIsScrollingTimeoutId),b._resetIsScrollingTimeoutId=L0t(b._resetIsScrolling,O0t)},b._resetIsScrolling=function(){b._resetIsScrollingTimeoutId=null,b.setState({isScrolling:!1},function(){b._getItemStyleCache(-1,null)})},b}m.getDerivedStateFromProps=function(b,y){return P0t(b,y),d(b),null};var p=m.prototype;return p.scrollTo=function(b){b=Math.max(0,b),this.setState(function(y){return y.scrollOffset===b?null:{scrollDirection:y.scrollOffset<b?"forward":"backward",scrollOffset:b,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},p.scrollToItem=function(b,y){y===void 0&&(y="auto");var S=this.props,_=S.itemCount,N=S.layout,k=this.state.scrollOffset;b=Math.max(0,Math.min(b,_-1));var j=0;if(this._outerRef){var E=this._outerRef;N==="vertical"?j=E.scrollWidth>E.clientWidth?kre():0:j=E.scrollHeight>E.clientHeight?kre():0}this.scrollTo(s(this.props,b,y,k,this._instanceProps,j))},p.componentDidMount=function(){var b=this.props,y=b.direction,S=b.initialScrollOffset,_=b.layout;if(typeof S=="number"&&this._outerRef!=null){var N=this._outerRef;y==="horizontal"||_==="horizontal"?N.scrollLeft=S:N.scrollTop=S}this._callPropsCallbacks()},p.componentDidUpdate=function(){var b=this.props,y=b.direction,S=b.layout,_=this.state,N=_.scrollOffset,k=_.scrollUpdateWasRequested;if(k&&this._outerRef!=null){var j=this._outerRef;if(y==="horizontal"||S==="horizontal")if(y==="rtl")switch(_re()){case"negative":j.scrollLeft=-N;break;case"positive-ascending":j.scrollLeft=N;break;default:var E=j.clientWidth,T=j.scrollWidth;j.scrollLeft=T-E-N;break}else j.scrollLeft=N;else j.scrollTop=N}this._callPropsCallbacks()},p.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&Sre(this._resetIsScrollingTimeoutId)},p.render=function(){var b=this.props,y=b.children,S=b.className,_=b.direction,N=b.height,k=b.innerRef,j=b.innerElementType,E=b.innerTagName,T=b.itemCount,O=b.itemData,R=b.itemKey,H=R===void 0?I0t:R,$=b.layout,L=b.outerElementType,A=b.outerTagName,M=b.style,P=b.useIsScrolling,I=b.width,B=this.state.isScrolling,F=_==="horizontal"||$==="horizontal",q=F?this._onScrollHorizontal:this._onScrollVertical,Q=this._getRangeToRender(),W=Q[0],G=Q[1],J=[];if(T>0)for(var X=W;X<=G;X++)J.push(w.createElement(y,{data:O,key:H(X,O),index:X,isScrolling:P?B:void 0,style:this._getItemStyle(X)}));var V=n(this.props,this._instanceProps);return w.createElement(L||A||"div",{className:S,onScroll:q,ref:this._outerRefSetter,style:RI({position:"relative",height:N,width:I,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:_},M)},w.createElement(j||E||"div",{children:J,ref:k,style:{height:F?"100%":V,pointerEvents:B?"none":void 0,width:F?V:"100%"}}))},p._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var b=this.props.itemCount;if(b>0){var y=this._getRangeToRender(),S=y[0],_=y[1],N=y[2],k=y[3];this._callOnItemsRendered(S,_,N,k)}}if(typeof this.props.onScroll=="function"){var j=this.state,E=j.scrollDirection,T=j.scrollOffset,O=j.scrollUpdateWasRequested;this._callOnScroll(E,T,O)}},p._getRangeToRender=function(){var b=this.props,y=b.itemCount,S=b.overscanCount,_=this.state,N=_.isScrolling,k=_.scrollDirection,j=_.scrollOffset;if(y===0)return[0,0,0,0];var E=i(this.props,j,this._instanceProps),T=l(this.props,E,j,this._instanceProps),O=!N||k==="backward"?Math.max(1,S):1,R=!N||k==="forward"?Math.max(1,S):1;return[Math.max(0,E-O),Math.max(0,Math.min(y-1,T+R)),E,T]},m})(w.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var P0t=function(t,r){t.children,t.direction,t.height,t.layout,t.innerTagName,t.outerTagName,t.width,r.instance},z0t=R0t({getItemOffset:function(t,r){var n=t.itemSize;return r*n},getItemSize:function(t,r){var n=t.itemSize;return n},getEstimatedTotalSize:function(t){var r=t.itemCount,n=t.itemSize;return n*r},getOffsetForIndexAndAlignment:function(t,r,n,a,s,i){var l=t.direction,c=t.height,u=t.itemCount,d=t.itemSize,f=t.layout,m=t.width,p=l==="horizontal"||f==="horizontal",v=p?m:c,b=Math.max(0,u*d-v),y=Math.min(b,r*d),S=Math.max(0,r*d-v+d+i);switch(n==="smart"&&(a>=S-v&&a<=y+v?n="auto":n="center"),n){case"start":return y;case"end":return S;case"center":{var _=Math.round(S+(y-S)/2);return _<Math.ceil(v/2)?0:_>b+Math.floor(v/2)?b:_}case"auto":default:return a>=S&&a<=y?a:a<S?S:y}},getStartIndexForOffset:function(t,r){var n=t.itemCount,a=t.itemSize;return Math.max(0,Math.min(n-1,Math.floor(r/a)))},getStopIndexForStartIndex:function(t,r,n){var a=t.direction,s=t.height,i=t.itemCount,l=t.itemSize,c=t.layout,u=t.width,d=a==="horizontal"||c==="horizontal",f=r*l,m=d?u:s,p=Math.ceil((m+n-f)/l);return Math.max(0,Math.min(i-1,r+p-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){t.itemSize}});function B0t(){var e,t;const r=Hi(),a=s0t().cursor;if(!a||a.type!=="line")return null;const s=r.indent,i=r.rowHeight*a.index+((t=(e=r.props.padding)!==null&&e!==void 0?e:r.props.paddingTop)!==null&&t!==void 0?t:0),l=s*a.level,c=r.renderCursor;return o.jsx(c,{top:i,left:l,indent:s})}var $0t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const F0t=w.forwardRef(function(t,r){const{children:n}=t,a=$0t(t,["children"]),s=Hi();return o.jsxs("div",Object.assign({ref:r},a,{onClick:i=>{i.currentTarget===i.target&&s.deselectAll()},children:[o.jsx(U0t,{}),n]}))}),U0t=()=>{const e=Hi();return o.jsx("div",{style:{height:e.visibleNodes.length*e.rowHeight,width:"100%",position:"absolute",left:"0",right:"0"},children:o.jsx(B0t,{})})};var H0t=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const q0t=w.forwardRef(function(t,r){var n,a,s,i,{style:l}=t,c=H0t(t,["style"]);const u=Hi(),d=(a=(n=u.props.padding)!==null&&n!==void 0?n:u.props.paddingTop)!==null&&a!==void 0?a:0,f=(i=(s=u.props.padding)!==null&&s!==void 0?s:u.props.paddingBottom)!==null&&i!==void 0?i:0;return o.jsx("div",Object.assign({ref:r,style:Object.assign(Object.assign({},l),{height:`${parseFloat(l.height)+d+f}px`})},c))});var Qbe=w.createContext({dragDropManager:void 0}),mo;(function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"})(mo||(mo={}));function sr(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(!e){var s;if(t===void 0)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=0;s=new Error(t.replace(/%s/g,function(){return n[i++]})),s.name="Invariant Violation"}throw s.framesToPop=1,s}}var F$="dnd-core/INIT_COORDS",uE="dnd-core/BEGIN_DRAG",U$="dnd-core/PUBLISH_DRAG_SOURCE",dE="dnd-core/HOVER",fE="dnd-core/DROP",hE="dnd-core/END_DRAG";function Nre(e,t){return{type:F$,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}function Vk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vk=function(r){return typeof r}:Vk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Vk(e)}function W0t(e,t,r){return t.split(".").reduce(function(n,a){return n&&n[a]?n[a]:r||null},e)}function K0t(e,t){return e.filter(function(r){return r!==t})}function Jbe(e){return Vk(e)==="object"}function G0t(e,t){var r=new Map,n=function(i){r.set(i,r.has(i)?r.get(i)+1:1)};e.forEach(n),t.forEach(n);var a=[];return r.forEach(function(s,i){s===1&&a.push(i)}),a}function V0t(e,t){return e.filter(function(r){return t.indexOf(r)>-1})}var Y0t={type:F$,payload:{clientOffset:null,sourceClientOffset:null}};function Q0t(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{publishSource:!0},a=n.publishSource,s=a===void 0?!0:a,i=n.clientOffset,l=n.getSourceClientOffset,c=e.getMonitor(),u=e.getRegistry();e.dispatch(Nre(i)),J0t(r,c,u);var d=evt(r,c);if(d===null){e.dispatch(Y0t);return}var f=null;if(i){if(!l)throw new Error("getSourceClientOffset must be defined");Z0t(l),f=l(d)}e.dispatch(Nre(i,f));var m=u.getSource(d),p=m.beginDrag(c,d);if(p!=null){X0t(p),u.pinSource(d);var v=u.getSourceType(d);return{type:uE,payload:{itemType:v,item:p,sourceId:d,clientOffset:i||null,sourceClientOffset:f||null,isSourcePublic:!!s}}}}}function J0t(e,t,r){sr(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(n){sr(r.getSource(n),"Expected sourceIds to be registered.")})}function Z0t(e){sr(typeof e=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function X0t(e){sr(Jbe(e),"Item must be an object.")}function evt(e,t){for(var r=null,n=e.length-1;n>=0;n--)if(t.canDragSource(e[n])){r=e[n];break}return r}function tvt(e){return function(){var r=e.getMonitor();if(r.isDragging())return{type:U$}}}function b5(e,t){return t===null?e===null:Array.isArray(e)?e.some(function(r){return r===t}):e===t}function rvt(e){return function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.clientOffset;nvt(r);var s=r.slice(0),i=e.getMonitor(),l=e.getRegistry();avt(s,i,l);var c=i.getItemType();return svt(s,l,c),ivt(s,i,l),{type:dE,payload:{targetIds:s,clientOffset:a||null}}}}function nvt(e){sr(Array.isArray(e),"Expected targetIds to be an array.")}function avt(e,t,r){sr(t.isDragging(),"Cannot call hover while not dragging."),sr(!t.didDrop(),"Cannot call hover after drop.");for(var n=0;n<e.length;n++){var a=e[n];sr(e.lastIndexOf(a)===n,"Expected targetIds to be unique in the passed array.");var s=r.getTarget(a);sr(s,"Expected targetIds to be registered.")}}function svt(e,t,r){for(var n=e.length-1;n>=0;n--){var a=e[n],s=t.getTargetType(a);b5(s,r)||e.splice(n,1)}}function ivt(e,t,r){e.forEach(function(n){var a=r.getTarget(n);a.hover(t,n)})}function Cre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cre(Object(r),!0).forEach(function(n){ovt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ovt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lvt(e){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.getMonitor(),a=e.getRegistry();cvt(n);var s=fvt(n);s.forEach(function(i,l){var c=uvt(i,l,a,n),u={type:fE,payload:{dropResult:jre(jre({},r),c)}};e.dispatch(u)})}}function cvt(e){sr(e.isDragging(),"Cannot call drop while not dragging."),sr(!e.didDrop(),"Cannot call drop twice during one drag operation.")}function uvt(e,t,r,n){var a=r.getTarget(e),s=a?a.drop(n,e):void 0;return dvt(s),typeof s>"u"&&(s=t===0?{}:n.getDropResult()),s}function dvt(e){sr(typeof e>"u"||Jbe(e),"Drop result must either be an object or undefined.")}function fvt(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}function hvt(e){return function(){var r=e.getMonitor(),n=e.getRegistry();mvt(r);var a=r.getSourceId();if(a!=null){var s=n.getSource(a,!0);s.endDrag(r,a),n.unpinSource()}return{type:hE}}}function mvt(e){sr(e.isDragging(),"Cannot call endDrag while not dragging.")}function pvt(e){return{beginDrag:Q0t(e),publishDragSource:tvt(e),hover:rvt(e),drop:lvt(e),endDrag:hvt(e)}}function gvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vvt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bvt(e,t,r){return t&&vvt(e.prototype,t),e}function Wv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var yvt=(function(){function e(t,r){var n=this;gvt(this,e),Wv(this,"store",void 0),Wv(this,"monitor",void 0),Wv(this,"backend",void 0),Wv(this,"isSetUp",!1),Wv(this,"handleRefCountChange",function(){var a=n.store.getState().refCount>0;n.backend&&(a&&!n.isSetUp?(n.backend.setup(),n.isSetUp=!0):!a&&n.isSetUp&&(n.backend.teardown(),n.isSetUp=!1))}),this.store=t,this.monitor=r,t.subscribe(this.handleRefCountChange)}return bvt(e,[{key:"receiveBackend",value:function(r){this.backend=r}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var r=this,n=this.store.dispatch;function a(i){return function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=i.apply(r,c);typeof d<"u"&&n(d)}}var s=pvt(this);return Object.keys(s).reduce(function(i,l){var c=s[l];return i[l]=a(c),i},{})}},{key:"dispatch",value:function(r){this.store.dispatch(r)}}]),e})();function so(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Ere=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})(),Mre=function(){return Math.random().toString(36).substring(7).split("").join(".")},Tre={INIT:"@@redux/INIT"+Mre(),REPLACE:"@@redux/REPLACE"+Mre()};function xvt(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Zbe(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(so(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(so(1));return r(Zbe)(e,t)}if(typeof e!="function")throw new Error(so(2));var a=e,s=t,i=[],l=i,c=!1;function u(){l===i&&(l=i.slice())}function d(){if(c)throw new Error(so(3));return s}function f(b){if(typeof b!="function")throw new Error(so(4));if(c)throw new Error(so(5));var y=!0;return u(),l.push(b),function(){if(y){if(c)throw new Error(so(6));y=!1,u();var _=l.indexOf(b);l.splice(_,1),i=null}}}function m(b){if(!xvt(b))throw new Error(so(7));if(typeof b.type>"u")throw new Error(so(8));if(c)throw new Error(so(9));try{c=!0,s=a(s,b)}finally{c=!1}for(var y=i=l,S=0;S<y.length;S++){var _=y[S];_()}return b}function p(b){if(typeof b!="function")throw new Error(so(10));a=b,m({type:Tre.REPLACE})}function v(){var b,y=f;return b={subscribe:function(_){if(typeof _!="object"||_===null)throw new Error(so(11));function N(){_.next&&_.next(d())}N();var k=y(N);return{unsubscribe:k}}},b[Ere]=function(){return this},b}return m({type:Tre.INIT}),n={dispatch:m,subscribe:f,getState:d,replaceReducer:p},n[Ere]=v,n}var wvt=function(t,r){return t===r};function Svt(e,t){return!e&&!t?!0:!e||!t?!1:e.x===t.x&&e.y===t.y}function kvt(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wvt;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!r(e[n],t[n]))return!1;return!0}function Are(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Are(Object(r),!0).forEach(function(n){_vt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Are(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _vt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Lre={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function Nvt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lre,t=arguments.length>1?arguments[1]:void 0,r=t.payload;switch(t.type){case F$:case uE:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case dE:return Svt(e.clientOffset,r.clientOffset)?e:Dre(Dre({},e),{},{clientOffset:r.clientOffset});case hE:case fE:return Lre;default:return e}}var H$="dnd-core/ADD_SOURCE",q$="dnd-core/ADD_TARGET",W$="dnd-core/REMOVE_SOURCE",mE="dnd-core/REMOVE_TARGET";function Cvt(e){return{type:H$,payload:{sourceId:e}}}function jvt(e){return{type:q$,payload:{targetId:e}}}function Evt(e){return{type:W$,payload:{sourceId:e}}}function Mvt(e){return{type:mE,payload:{targetId:e}}}function Ore(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function io(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ore(Object(r),!0).forEach(function(n){Tvt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ore(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tvt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Avt={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Dvt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Avt,t=arguments.length>1?arguments[1]:void 0,r=t.payload;switch(t.type){case uE:return io(io({},e),{},{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case U$:return io(io({},e),{},{isSourcePublic:!0});case dE:return io(io({},e),{},{targetIds:r.targetIds});case mE:return e.targetIds.indexOf(r.targetId)===-1?e:io(io({},e),{},{targetIds:K0t(e.targetIds,r.targetId)});case fE:return io(io({},e),{},{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case hE:return io(io({},e),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}function Lvt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H$:case q$:return e+1;case W$:case mE:return e-1;default:return e}}var OC=[],K$=[];OC.__IS_NONE__=!0;K$.__IS_ALL__=!0;function Ovt(e,t){if(e===OC)return!1;if(e===K$||typeof t>"u")return!0;var r=V0t(t,e);return r.length>0}function Ivt(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case dE:break;case H$:case q$:case mE:case W$:return OC;case uE:case U$:case hE:case fE:default:return K$}var t=e.payload,r=t.targetIds,n=r===void 0?[]:r,a=t.prevTargetIds,s=a===void 0?[]:a,i=G0t(n,s),l=i.length>0||!kvt(n,s);if(!l)return OC;var c=s[s.length-1],u=n[n.length-1];return c!==u&&(c&&i.push(c),u&&i.push(u)),i}function Rvt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return e+1}function Ire(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ire(Object(r),!0).forEach(function(n){Pvt(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ire(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pvt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zvt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:Ivt(e.dirtyHandlerIds,{type:t.type,payload:Rre(Rre({},t.payload),{},{prevTargetIds:W0t(e,"dragOperation.targetIds",[])})}),dragOffset:Nvt(e.dragOffset,t),refCount:Lvt(e.refCount,t),dragOperation:Dvt(e.dragOperation,t),stateId:Rvt(e.stateId)}}function Bvt(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Xbe(e,t){return{x:e.x-t.x,y:e.y-t.y}}function $vt(e){var t=e.clientOffset,r=e.initialClientOffset,n=e.initialSourceClientOffset;return!t||!r||!n?null:Xbe(Bvt(t,n),r)}function Fvt(e){var t=e.clientOffset,r=e.initialClientOffset;return!t||!r?null:Xbe(t,r)}function Uvt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hvt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qvt(e,t,r){return t&&Hvt(e.prototype,t),e}function Pre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Wvt=(function(){function e(t,r){Uvt(this,e),Pre(this,"store",void 0),Pre(this,"registry",void 0),this.store=t,this.registry=r}return qvt(e,[{key:"subscribeToStateChange",value:function(r){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{handlerIds:void 0},s=a.handlerIds;sr(typeof r=="function","listener must be a function."),sr(typeof s>"u"||Array.isArray(s),"handlerIds, when specified, must be an array of strings.");var i=this.store.getState().stateId,l=function(){var u=n.store.getState(),d=u.stateId;try{var f=d===i||d===i+1&&!Ovt(u.dirtyHandlerIds,s);f||r()}finally{i=d}};return this.store.subscribe(l)}},{key:"subscribeToOffsetChange",value:function(r){var n=this;sr(typeof r=="function","listener must be a function.");var a=this.store.getState().dragOffset,s=function(){var l=n.store.getState().dragOffset;l!==a&&(a=l,r())};return this.store.subscribe(s)}},{key:"canDragSource",value:function(r){if(!r)return!1;var n=this.registry.getSource(r);return sr(n,"Expected to find a valid source. sourceId=".concat(r)),this.isDragging()?!1:n.canDrag(this,r)}},{key:"canDropOnTarget",value:function(r){if(!r)return!1;var n=this.registry.getTarget(r);if(sr(n,"Expected to find a valid target. targetId=".concat(r)),!this.isDragging()||this.didDrop())return!1;var a=this.registry.getTargetType(r),s=this.getItemType();return b5(a,s)&&n.canDrop(this,r)}},{key:"isDragging",value:function(){return!!this.getItemType()}},{key:"isDraggingSource",value:function(r){if(!r)return!1;var n=this.registry.getSource(r,!0);if(sr(n,"Expected to find a valid source. sourceId=".concat(r)),!this.isDragging()||!this.isSourcePublic())return!1;var a=this.registry.getSourceType(r),s=this.getItemType();return a!==s?!1:n.isDragging(this,r)}},{key:"isOverTarget",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shallow:!1};if(!r)return!1;var a=n.shallow;if(!this.isDragging())return!1;var s=this.registry.getTargetType(r),i=this.getItemType();if(i&&!b5(s,i))return!1;var l=this.getTargetIds();if(!l.length)return!1;var c=l.indexOf(r);return a?c===l.length-1:c>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return!!this.store.getState().dragOperation.isSourcePublic}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return $vt(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return Fvt(this.store.getState().dragOffset)}}]),e})(),Kvt=0;function Gvt(){return Kvt++}function Yk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yk=function(r){return typeof r}:Yk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Yk(e)}function Vvt(e){sr(typeof e.canDrag=="function","Expected canDrag to be a function."),sr(typeof e.beginDrag=="function","Expected beginDrag to be a function."),sr(typeof e.endDrag=="function","Expected endDrag to be a function.")}function Yvt(e){sr(typeof e.canDrop=="function","Expected canDrop to be a function."),sr(typeof e.hover=="function","Expected hover to be a function."),sr(typeof e.drop=="function","Expected beginDrag to be a function.")}function y5(e,t){if(t&&Array.isArray(e)){e.forEach(function(r){return y5(r,!1)});return}sr(typeof e=="string"||Yk(e)==="symbol",t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}const zre=typeof global<"u"?global:self,eye=zre.MutationObserver||zre.WebKitMutationObserver;function tye(e){return function(){const r=setTimeout(a,0),n=setInterval(a,50);function a(){clearTimeout(r),clearInterval(n),e()}}}function Qvt(e){let t=1;const r=new eye(e),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){t=-t,n.data=t}}const Jvt=typeof eye=="function"?Qvt:tye;class Zvt{enqueueTask(t){const{queue:r,requestFlush:n}=this;r.length||(n(),this.flushing=!0),r[r.length]=t}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:t}=this;for(;this.index<t.length;){const r=this.index;if(this.index++,t[r].call(),this.index>this.capacity){for(let n=0,a=t.length-this.index;n<a;n++)t[n]=t[n+this.index];t.length-=this.index,this.index=0}}t.length=0,this.index=0,this.flushing=!1},this.registerPendingError=t=>{this.pendingErrors.push(t),this.requestErrorThrow()},this.requestFlush=Jvt(this.flush),this.requestErrorThrow=tye(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class Xvt{call(){try{this.task&&this.task()}catch(t){this.onError(t)}finally{this.task=null,this.release(this)}}constructor(t,r){this.onError=t,this.release=r,this.task=null}}class ebt{create(t){const r=this.freeTasks,n=r.length?r.pop():new Xvt(this.onError,a=>r[r.length]=a);return n.task=t,n}constructor(t){this.onError=t,this.freeTasks=[]}}const rye=new Zvt,tbt=new ebt(rye.registerPendingError);function rbt(e){rye.enqueueTask(tbt.create(e))}function nbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function abt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sbt(e,t,r){return t&&abt(e.prototype,t),e}function fp(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ibt(e,t){return ubt(e)||cbt(e,t)||lbt(e,t)||obt()}function obt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lbt(e,t){if(e){if(typeof e=="string")return Bre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bre(e,t)}}function Bre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cbt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,s=!1,i,l;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(n.push(i.value),!(t&&n.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function ubt(e){if(Array.isArray(e))return e}function dbt(e){var t=Gvt().toString();switch(e){case mo.SOURCE:return"S".concat(t);case mo.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function $re(e){switch(e[0]){case"S":return mo.SOURCE;case"T":return mo.TARGET;default:sr(!1,"Cannot parse handler ID: ".concat(e))}}function Fre(e,t){var r=e.entries(),n=!1;do{var a=r.next(),s=a.done,i=ibt(a.value,2),l=i[1];if(l===t)return!0;n=!!s}while(!n);return!1}var fbt=(function(){function e(t){nbt(this,e),fp(this,"types",new Map),fp(this,"dragSources",new Map),fp(this,"dropTargets",new Map),fp(this,"pinnedSourceId",null),fp(this,"pinnedSource",null),fp(this,"store",void 0),this.store=t}return sbt(e,[{key:"addSource",value:function(r,n){y5(r),Vvt(n);var a=this.addHandler(mo.SOURCE,r,n);return this.store.dispatch(Cvt(a)),a}},{key:"addTarget",value:function(r,n){y5(r,!0),Yvt(n);var a=this.addHandler(mo.TARGET,r,n);return this.store.dispatch(jvt(a)),a}},{key:"containsHandler",value:function(r){return Fre(this.dragSources,r)||Fre(this.dropTargets,r)}},{key:"getSource",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;sr(this.isSourceId(r),"Expected a valid source ID.");var a=n&&r===this.pinnedSourceId,s=a?this.pinnedSource:this.dragSources.get(r);return s}},{key:"getTarget",value:function(r){return sr(this.isTargetId(r),"Expected a valid target ID."),this.dropTargets.get(r)}},{key:"getSourceType",value:function(r){return sr(this.isSourceId(r),"Expected a valid source ID."),this.types.get(r)}},{key:"getTargetType",value:function(r){return sr(this.isTargetId(r),"Expected a valid target ID."),this.types.get(r)}},{key:"isSourceId",value:function(r){var n=$re(r);return n===mo.SOURCE}},{key:"isTargetId",value:function(r){var n=$re(r);return n===mo.TARGET}},{key:"removeSource",value:function(r){var n=this;sr(this.getSource(r),"Expected an existing source."),this.store.dispatch(Evt(r)),rbt(function(){n.dragSources.delete(r),n.types.delete(r)})}},{key:"removeTarget",value:function(r){sr(this.getTarget(r),"Expected an existing target."),this.store.dispatch(Mvt(r)),this.dropTargets.delete(r),this.types.delete(r)}},{key:"pinSource",value:function(r){var n=this.getSource(r);sr(n,"Expected an existing source."),this.pinnedSourceId=r,this.pinnedSource=n}},{key:"unpinSource",value:function(){sr(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(r,n,a){var s=dbt(r);return this.types.set(s,n),r===mo.SOURCE?this.dragSources.set(s,a):r===mo.TARGET&&this.dropTargets.set(s,a),s}}]),e})();function hbt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=mbt(n),s=new Wvt(a,new fbt(a)),i=new yvt(a,s),l=e(i,t,r);return i.receiveBackend(l),i}function mbt(e){var t=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return Zbe(zvt,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}var pbt=["children"];function gbt(e,t){return xbt(e)||ybt(e,t)||bbt(e,t)||vbt()}function vbt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bbt(e,t){if(e){if(typeof e=="string")return Ure(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ure(e,t)}}function Ure(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ybt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,s=!1,i,l;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(n.push(i.value),!(t&&n.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function xbt(e){if(Array.isArray(e))return e}function wbt(e,t){if(e==null)return{};var r=Sbt(e,t),n,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Sbt(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var Hre=0,Qk=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),kbt=w.memo(function(t){var r=t.children,n=wbt(t,pbt),a=_bt(n),s=gbt(a,2),i=s[0],l=s[1];return w.useEffect(function(){if(l){var c=nye();return++Hre,function(){--Hre===0&&(c[Qk]=null)}}},[]),o.jsx(Qbe.Provider,Object.assign({value:i},{children:r}),void 0)});function _bt(e){if("manager"in e){var t={dragDropManager:e.manager};return[t,!1]}var r=Nbt(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[r,n]}function Nbt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nye(),r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=t;return a[Qk]||(a[Qk]={dragDropManager:hbt(e,t,r,n)}),a[Qk]}function nye(){return typeof global<"u"?global:window}function Cbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jbt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ebt(e,t,r){return t&&jbt(e.prototype,t),e}function qre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var aO=!1,sO=!1,Mbt=(function(){function e(t){Cbt(this,e),qre(this,"internalMonitor",void 0),qre(this,"sourceId",null),this.internalMonitor=t.getMonitor()}return Ebt(e,[{key:"receiveHandlerId",value:function(r){this.sourceId=r}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){sr(!aO,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return aO=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{aO=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;sr(!sO,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return sO=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{sO=!1}}},{key:"subscribeToStateChange",value:function(r,n){return this.internalMonitor.subscribeToStateChange(r,n)}},{key:"isDraggingSource",value:function(r){return this.internalMonitor.isDraggingSource(r)}},{key:"isOverTarget",value:function(r,n){return this.internalMonitor.isOverTarget(r,n)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(r){return this.internalMonitor.subscribeToOffsetChange(r)}},{key:"canDragSource",value:function(r){return this.internalMonitor.canDragSource(r)}},{key:"canDropOnTarget",value:function(r){return this.internalMonitor.canDropOnTarget(r)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e})();function Tbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Abt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dbt(e,t,r){return t&&Abt(e.prototype,t),e}function Wre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var iO=!1,Lbt=(function(){function e(t){Tbt(this,e),Wre(this,"internalMonitor",void 0),Wre(this,"targetId",null),this.internalMonitor=t.getMonitor()}return Dbt(e,[{key:"receiveHandlerId",value:function(r){this.targetId=r}},{key:"getHandlerId",value:function(){return this.targetId}},{key:"subscribeToStateChange",value:function(r,n){return this.internalMonitor.subscribeToStateChange(r,n)}},{key:"canDrop",value:function(){if(!this.targetId)return!1;sr(!iO,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return iO=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{iO=!1}}},{key:"isOver",value:function(r){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,r):!1}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e})();function Obt(e){if(typeof e.type!="string"){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors."+"You can either wrap ".concat(t," into a <div>, or turn it into a ")+"drag source or a drop target itself.")}}function Ibt(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!w.isValidElement(t)){var n=t;return e(n,r),n}var a=t;Obt(a);var s=r?function(i){return e(i,r)}:e;return Rbt(a,s)}}function aye(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{var a=Ibt(n);t[r]=function(){return a}}}),t}function Kre(e,t){typeof e=="function"?e(t):e.current=t}function Rbt(e,t){var r=e.ref;return sr(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?w.cloneElement(e,{ref:function(a){Kre(r,a),Kre(t,a)}}):w.cloneElement(e,{ref:t})}function Jk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jk=function(r){return typeof r}:Jk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Jk(e)}function x5(e){return e!==null&&Jk(e)==="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function w5(e,t,r,n){var a=void 0;if(a!==void 0)return!!a;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;var s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(t),c=0;c<s.length;c++){var u=s[c];if(!l(u))return!1;var d=e[u],f=t[u];if(a=void 0,a===!1||a===void 0&&d!==f)return!1}return!0}function Pbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zbt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bbt(e,t,r){return t&&zbt(e.prototype,t),e}function ps(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $bt=(function(){function e(t){var r=this;Pbt(this,e),ps(this,"hooks",aye({dragSource:function(a,s){r.clearDragSource(),r.dragSourceOptions=s||null,x5(a)?r.dragSourceRef=a:r.dragSourceNode=a,r.reconnectDragSource()},dragPreview:function(a,s){r.clearDragPreview(),r.dragPreviewOptions=s||null,x5(a)?r.dragPreviewRef=a:r.dragPreviewNode=a,r.reconnectDragPreview()}})),ps(this,"handlerId",null),ps(this,"dragSourceRef",null),ps(this,"dragSourceNode",void 0),ps(this,"dragSourceOptionsInternal",null),ps(this,"dragSourceUnsubscribe",void 0),ps(this,"dragPreviewRef",null),ps(this,"dragPreviewNode",void 0),ps(this,"dragPreviewOptionsInternal",null),ps(this,"dragPreviewUnsubscribe",void 0),ps(this,"lastConnectedHandlerId",null),ps(this,"lastConnectedDragSource",null),ps(this,"lastConnectedDragSourceOptions",null),ps(this,"lastConnectedDragPreview",null),ps(this,"lastConnectedDragPreviewOptions",null),ps(this,"backend",void 0),this.backend=t}return Bbt(e,[{key:"receiveHandlerId",value:function(r){this.handlerId!==r&&(this.handlerId=r,this.reconnect())}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(r){this.dragSourceOptionsInternal=r}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(r){this.dragPreviewOptionsInternal=r}},{key:"reconnect",value:function(){this.reconnectDragSource(),this.reconnectDragPreview()}},{key:"reconnectDragSource",value:function(){var r=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();if(n&&this.disconnectDragSource(),!!this.handlerId){if(!r){this.lastConnectedDragSource=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=r,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,r,this.dragSourceOptions))}}},{key:"reconnectDragPreview",value:function(){var r=this.dragPreview,n=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!w5(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!w5(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}}]),e})();function Fbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ubt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hbt(e,t,r){return t&&Ubt(e.prototype,t),e}function dl(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var qbt=(function(){function e(t){var r=this;Fbt(this,e),dl(this,"hooks",aye({dropTarget:function(a,s){r.clearDropTarget(),r.dropTargetOptions=s,x5(a)?r.dropTargetRef=a:r.dropTargetNode=a,r.reconnect()}})),dl(this,"handlerId",null),dl(this,"dropTargetRef",null),dl(this,"dropTargetNode",void 0),dl(this,"dropTargetOptionsInternal",null),dl(this,"unsubscribeDropTarget",void 0),dl(this,"lastConnectedHandlerId",null),dl(this,"lastConnectedDropTarget",null),dl(this,"lastConnectedDropTargetOptions",null),dl(this,"backend",void 0),this.backend=t}return Hbt(e,[{key:"connectTarget",get:function(){return this.dropTarget}},{key:"reconnect",value:function(){var r=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();r&&this.disconnectDropTarget();var n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}},{key:"receiveHandlerId",value:function(r){r!==this.handlerId&&(this.handlerId=r,this.reconnect())}},{key:"dropTargetOptions",get:function(){return this.dropTargetOptionsInternal},set:function(r){this.dropTargetOptionsInternal=r}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didDropTargetChange",value:function(){return this.lastConnectedDropTarget!==this.dropTarget}},{key:"didOptionsChange",value:function(){return!w5(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}},{key:"disconnectDropTarget",value:function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}},{key:"dropTarget",get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}},{key:"clearDropTarget",value:function(){this.dropTargetRef=null,this.dropTargetNode=null}}]),e})();function Wbt(e,t,r){var n=r.getRegistry(),a=n.addTarget(e,t);return[a,function(){return n.removeTarget(a)}]}function Kbt(e,t,r){var n=r.getRegistry(),a=n.addSource(e,t);return[a,function(){return n.removeSource(a)}]}var $h=typeof window<"u"?w.useLayoutEffect:w.useEffect;function Zk(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zk=function(r){return typeof r}:Zk=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Zk(e)}function Gbt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vbt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ybt(e,t,r){return t&&Vbt(e.prototype,t),e}function oO(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Qbt=(function(){function e(t,r,n){Gbt(this,e),oO(this,"spec",void 0),oO(this,"monitor",void 0),oO(this,"connector",void 0),this.spec=t,this.monitor=r,this.connector=n}return Ybt(e,[{key:"beginDrag",value:function(){var r,n=this.spec,a=this.monitor,s=null;return Zk(n.item)==="object"?s=n.item:typeof n.item=="function"?s=n.item(a):s={},(r=s)!==null&&r!==void 0?r:null}},{key:"canDrag",value:function(){var r=this.spec,n=this.monitor;return typeof r.canDrag=="boolean"?r.canDrag:typeof r.canDrag=="function"?r.canDrag(n):!0}},{key:"isDragging",value:function(r,n){var a=this.spec,s=this.monitor,i=a.isDragging;return i?i(s):n===r.getSourceId()}},{key:"endDrag",value:function(){var r=this.spec,n=this.monitor,a=this.connector,s=r.end;s&&s(n.getItem(),n),a.reconnect()}}]),e})();function Jbt(e,t,r){var n=w.useMemo(function(){return new Qbt(e,t,r)},[t,r]);return w.useEffect(function(){n.spec=e},[e]),n}function hm(){var e=w.useContext(Qbe),t=e.dragDropManager;return sr(t!=null,"Expected drag drop context"),t}function Zbt(e){return w.useMemo(function(){var t=e.type;return sr(t!=null,"spec.type must be defined"),t},[e])}function Xbt(e,t){return nyt(e)||ryt(e,t)||tyt(e,t)||eyt()}function eyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tyt(e,t){if(e){if(typeof e=="string")return Gre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gre(e,t)}}function Gre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ryt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,s=!1,i,l;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(n.push(i.value),!(t&&n.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function nyt(e){if(Array.isArray(e))return e}function ayt(e,t,r){var n=hm(),a=Jbt(e,t,r),s=Zbt(e);$h(function(){if(s!=null){var l=Kbt(s,a,n),c=Xbt(l,2),u=c[0],d=c[1];return t.receiveHandlerId(u),r.receiveHandlerId(u),d}},[n,t,r,a,s])}function syt(e){return cyt(e)||lyt(e)||oyt(e)||iyt()}function iyt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oyt(e,t){if(e){if(typeof e=="string")return S5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S5(e,t)}}function lyt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cyt(e){if(Array.isArray(e))return S5(e)}function S5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sye(e,t){var r=syt(t||[]);return t==null&&typeof e!="function"&&r.push(e),w.useMemo(function(){return typeof e=="function"?e():e},r)}function uyt(){var e=hm();return w.useMemo(function(){return new Mbt(e)},[e])}function dyt(e,t){var r=hm(),n=w.useMemo(function(){return new $bt(r.getBackend())},[r]);return $h(function(){return n.dragSourceOptions=e||null,n.reconnect(),function(){return n.disconnectDragSource()}},[n,e]),$h(function(){return n.dragPreviewOptions=t||null,n.reconnect(),function(){return n.disconnectDragPreview()}},[n,t]),n}var lO,Vre;function fyt(){return Vre||(Vre=1,lO=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,s;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(s=Object.keys(t),n=s.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[a]))return!1;for(a=n;a--!==0;){var i=s[a];if(!e(t[i],r[i]))return!1}return!0}return t!==t&&r!==r}),lO}var hyt=fyt();const myt=Ur(hyt);function pyt(e,t){return yyt(e)||byt(e,t)||vyt(e,t)||gyt()}function gyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vyt(e,t){if(e){if(typeof e=="string")return Yre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yre(e,t)}}function Yre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function byt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,s=!1,i,l;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(n.push(i.value),!(t&&n.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function yyt(e){if(Array.isArray(e))return e}function iye(e,t,r){var n=w.useState(function(){return t(e)}),a=pyt(n,2),s=a[0],i=a[1],l=w.useCallback(function(){var c=t(e);myt(s,c)||(i(c),r&&r())},[s,e,r]);return $h(l),[s,l]}function xyt(e,t){return _yt(e)||kyt(e,t)||Syt(e,t)||wyt()}function wyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Syt(e,t){if(e){if(typeof e=="string")return Qre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qre(e,t)}}function Qre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,s=!1,i,l;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(n.push(i.value),!(t&&n.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function _yt(e){if(Array.isArray(e))return e}function Nyt(e,t,r){var n=iye(e,t,r),a=xyt(n,2),s=a[0],i=a[1];return $h(function(){var c=e.getHandlerId();if(c!=null)return e.subscribeToStateChange(i,{handlerIds:[c]})},[e,i]),s}function oye(e,t,r){return Nyt(t,e||function(){return{}},function(){return r.reconnect()})}function Cyt(e){return w.useMemo(function(){return e.hooks.dragSource()},[e])}function jyt(e){return w.useMemo(function(){return e.hooks.dragPreview()},[e])}function Eyt(e,t){var r=sye(e,t);sr(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");var n=uyt(),a=dyt(r.options,r.previewOptions);return ayt(r,n,a),[oye(r.collect,n,a),Cyt(a),jyt(a)]}function Myt(e){var t=e.accept;return w.useMemo(function(){return sr(e.accept!=null,"accept must be defined"),Array.isArray(t)?t:[t]},[t])}function Tyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ayt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dyt(e,t,r){return t&&Ayt(e.prototype,t),e}function Jre(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Lyt=(function(){function e(t,r){Tyt(this,e),Jre(this,"spec",void 0),Jre(this,"monitor",void 0),this.spec=t,this.monitor=r}return Dyt(e,[{key:"canDrop",value:function(){var r=this.spec,n=this.monitor;return r.canDrop?r.canDrop(n.getItem(),n):!0}},{key:"hover",value:function(){var r=this.spec,n=this.monitor;r.hover&&r.hover(n.getItem(),n)}},{key:"drop",value:function(){var r=this.spec,n=this.monitor;if(r.drop)return r.drop(n.getItem(),n)}}]),e})();function Oyt(e,t){var r=w.useMemo(function(){return new Lyt(e,t)},[t]);return w.useEffect(function(){r.spec=e},[e]),r}function Iyt(e,t){return Byt(e)||zyt(e,t)||Pyt(e,t)||Ryt()}function Ryt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pyt(e,t){if(e){if(typeof e=="string")return Zre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zre(e,t)}}function Zre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,s=!1,i,l;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(n.push(i.value),!(t&&n.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function Byt(e){if(Array.isArray(e))return e}function $yt(e,t,r){var n=hm(),a=Oyt(e,t),s=Myt(e);$h(function(){var l=Wbt(s,a,n),c=Iyt(l,2),u=c[0],d=c[1];return t.receiveHandlerId(u),r.receiveHandlerId(u),d},[n,t,a,r,s.map(function(i){return i.toString()}).join("|")])}function Fyt(){var e=hm();return w.useMemo(function(){return new Lbt(e)},[e])}function Uyt(e){var t=hm(),r=w.useMemo(function(){return new qbt(t.getBackend())},[t]);return $h(function(){return r.dropTargetOptions=e||null,r.reconnect(),function(){return r.disconnectDropTarget()}},[e]),r}function Hyt(e){return w.useMemo(function(){return e.hooks.dropTarget()},[e])}function lye(e,t){var r=sye(e,t),n=Fyt(),a=Uyt(r.options);return $yt(r,n,a),[oye(r.collect,n,a),Hyt(a)]}function qyt(e,t){return Vyt(e)||Gyt(e,t)||Kyt(e,t)||Wyt()}function Wyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kyt(e,t){if(e){if(typeof e=="string")return Xre(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xre(e,t)}}function Xre(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gyt(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],a=!0,s=!1,i,l;try{for(r=r.call(e);!(a=(i=r.next()).done)&&(n.push(i.value),!(t&&n.length===t));a=!0);}catch(c){s=!0,l=c}finally{try{!a&&r.return!=null&&r.return()}finally{if(s)throw l}}return n}}function Vyt(e){if(Array.isArray(e))return e}function Yyt(e){var t=hm(),r=t.getMonitor(),n=iye(r,e),a=qyt(n,2),s=a[0],i=a[1];return w.useEffect(function(){return r.subscribeToOffsetChange(i)}),w.useEffect(function(){return r.subscribeToStateChange(i)}),s}function cye(e){var t=null,r=function(){return t==null&&(t=e()),t};return r}function Qyt(e,t){return e.filter(function(r){return r!==t})}function Jyt(e,t){var r=new Set,n=function(i){return r.add(i)};e.forEach(n),t.forEach(n);var a=[];return r.forEach(function(s){return a.push(s)}),a}function Zyt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xyt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ext(e,t,r){return t&&Xyt(e.prototype,t),e}function ene(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var txt=(function(){function e(t){Zyt(this,e),ene(this,"entered",[]),ene(this,"isNodeInDocument",void 0),this.isNodeInDocument=t}return ext(e,[{key:"enter",value:function(r){var n=this,a=this.entered.length,s=function(l){return n.isNodeInDocument(l)&&(!l.contains||l.contains(r))};return this.entered=Jyt(this.entered.filter(s),[r]),a===0&&this.entered.length>0}},{key:"leave",value:function(r){var n=this.entered.length;return this.entered=Qyt(this.entered.filter(this.isNodeInDocument),r),n>0&&this.entered.length===0}},{key:"reset",value:function(){this.entered=[]}}]),e})(),rxt=cye(function(){return/firefox/i.test(navigator.userAgent)}),uye=cye(function(){return!!window.safari});function nxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function axt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sxt(e,t,r){return t&&axt(e.prototype,t),e}function Kv(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tne=(function(){function e(t,r){nxt(this,e),Kv(this,"xs",void 0),Kv(this,"ys",void 0),Kv(this,"c1s",void 0),Kv(this,"c2s",void 0),Kv(this,"c3s",void 0);for(var n=t.length,a=[],s=0;s<n;s++)a.push(s);a.sort(function(O,R){return t[O]<t[R]?-1:1});for(var i=[],l=[],c,u,d=0;d<n-1;d++)c=t[d+1]-t[d],u=r[d+1]-r[d],i.push(c),l.push(u/c);for(var f=[l[0]],m=0;m<i.length-1;m++){var p=l[m],v=l[m+1];if(p*v<=0)f.push(0);else{c=i[m];var b=i[m+1],y=c+b;f.push(3*y/((y+b)/p+(y+c)/v))}}f.push(l[l.length-1]);for(var S=[],_=[],N,k=0;k<f.length-1;k++){N=l[k];var j=f[k],E=1/i[k],T=j+f[k+1]-N-N;S.push((N-j-T)*E),_.push(T*E*E)}this.xs=t,this.ys=r,this.c1s=f,this.c2s=S,this.c3s=_}return sxt(e,[{key:"interpolate",value:function(r){var n=this.xs,a=this.ys,s=this.c1s,i=this.c2s,l=this.c3s,c=n.length-1;if(r===n[c])return a[c];for(var u=0,d=l.length-1,f;u<=d;){f=Math.floor(.5*(u+d));var m=n[f];if(m<r)u=f+1;else if(m>r)d=f-1;else return a[f]}c=Math.max(0,d);var p=r-n[c],v=p*p;return a[c]+s[c]*p+i[c]*v+l[c]*p*v}}]),e})(),ixt=1;function dye(e){var t=e.nodeType===ixt?e:e.parentElement;if(!t)return null;var r=t.getBoundingClientRect(),n=r.top,a=r.left;return{x:a,y:n}}function rk(e){return{x:e.clientX,y:e.clientY}}function oxt(e){var t;return e.nodeName==="IMG"&&(rxt()||!((t=document.documentElement)!==null&&t!==void 0&&t.contains(e)))}function lxt(e,t,r,n){var a=e?t.width:r,s=e?t.height:n;return uye()&&e&&(s/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:s}}function cxt(e,t,r,n,a){var s=oxt(t),i=s?e:t,l=dye(i),c={x:r.x-l.x,y:r.y-l.y},u=e.offsetWidth,d=e.offsetHeight,f=n.anchorX,m=n.anchorY,p=lxt(s,t,u,d),v=p.dragPreviewWidth,b=p.dragPreviewHeight,y=function(){var T=new tne([0,.5,1],[c.y,c.y/d*b,c.y+b-d]),O=T.interpolate(m);return uye()&&s&&(O+=(window.devicePixelRatio-1)*b),O},S=function(){var T=new tne([0,.5,1],[c.x,c.x/u*v,c.x+v-u]);return T.interpolate(f)},_=a.offsetX,N=a.offsetY,k=_===0||_,j=N===0||N;return{x:k?_:S(),y:j?N:y()}}var fye="__NATIVE_FILE__",hye="__NATIVE_URL__",mye="__NATIVE_TEXT__",pye="__NATIVE_HTML__";const rne=Object.freeze(Object.defineProperty({__proto__:null,FILE:fye,HTML:pye,TEXT:mye,URL:hye},Symbol.toStringTag,{value:"Module"}));function cO(e,t,r){var n=t.reduce(function(a,s){return a||e.getData(s)},"");return n??r}var hp;function nk(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var k5=(hp={},nk(hp,fye,{exposeProperties:{files:function(t){return Array.prototype.slice.call(t.files)},items:function(t){return t.items},dataTransfer:function(t){return t}},matchesTypes:["Files"]}),nk(hp,pye,{exposeProperties:{html:function(t,r){return cO(t,r,"")},dataTransfer:function(t){return t}},matchesTypes:["Html","text/html"]}),nk(hp,hye,{exposeProperties:{urls:function(t,r){return cO(t,r,"").split(`
`)},dataTransfer:function(t){return t}},matchesTypes:["Url","text/uri-list"]}),nk(hp,mye,{exposeProperties:{text:function(t,r){return cO(t,r,"")},dataTransfer:function(t){return t}},matchesTypes:["Text","text/plain"]}),hp);function uxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dxt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fxt(e,t,r){return t&&dxt(e.prototype,t),e}function nne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var hxt=(function(){function e(t){uxt(this,e),nne(this,"item",void 0),nne(this,"config",void 0),this.config=t,this.item={},this.initializeExposedProperties()}return fxt(e,[{key:"initializeExposedProperties",value:function(){var r=this;Object.keys(this.config.exposeProperties).forEach(function(n){Object.defineProperty(r.item,n,{configurable:!0,enumerable:!0,get:function(){return console.warn(`Browser doesn't allow reading "`.concat(n,'" until the drop event.')),null}})})}},{key:"loadDataTransfer",value:function(r){var n=this;if(r){var a={};Object.keys(this.config.exposeProperties).forEach(function(s){a[s]={value:n.config.exposeProperties[s](r,n.config.matchesTypes),configurable:!0,enumerable:!0}}),Object.defineProperties(this.item,a)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(r,n){return n===r.getSourceId()}},{key:"endDrag",value:function(){}}]),e})();function mxt(e,t){var r=new hxt(k5[e]);return r.loadDataTransfer(t),r}function uO(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(k5).filter(function(r){var n=k5[r].matchesTypes;return n.some(function(a){return t.indexOf(a)>-1})})[0]||null}function pxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gxt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vxt(e,t,r){return t&&gxt(e.prototype,t),e}function dO(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var bxt=(function(){function e(t,r){pxt(this,e),dO(this,"ownerDocument",null),dO(this,"globalContext",void 0),dO(this,"optionsArgs",void 0),this.globalContext=t,this.optionsArgs=r}return vxt(e,[{key:"window",get:function(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}},{key:"document",get:function(){var r;return(r=this.globalContext)!==null&&r!==void 0&&r.document?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var r;return((r=this.optionsArgs)===null||r===void 0?void 0:r.rootElement)||this.window}}]),e})();function ane(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ane(Object(r),!0).forEach(function(n){yr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ane(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yxt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xxt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wxt(e,t,r){return t&&xxt(e.prototype,t),e}function yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Sxt=(function(){function e(t,r,n){var a=this;yxt(this,e),yr(this,"options",void 0),yr(this,"actions",void 0),yr(this,"monitor",void 0),yr(this,"registry",void 0),yr(this,"enterLeaveCounter",void 0),yr(this,"sourcePreviewNodes",new Map),yr(this,"sourcePreviewNodeOptions",new Map),yr(this,"sourceNodes",new Map),yr(this,"sourceNodeOptions",new Map),yr(this,"dragStartSourceIds",null),yr(this,"dropTargetIds",[]),yr(this,"dragEnterTargetIds",[]),yr(this,"currentNativeSource",null),yr(this,"currentNativeHandle",null),yr(this,"currentDragSourceNode",null),yr(this,"altKeyPressed",!1),yr(this,"mouseMoveTimeoutTimer",null),yr(this,"asyncEndDragFrameId",null),yr(this,"dragOverTargetIds",null),yr(this,"lastClientOffset",null),yr(this,"hoverRafId",null),yr(this,"getSourceClientOffset",function(s){var i=a.sourceNodes.get(s);return i&&dye(i)||null}),yr(this,"endDragNativeItem",function(){a.isDraggingNativeItem()&&(a.actions.endDrag(),a.currentNativeHandle&&a.registry.removeSource(a.currentNativeHandle),a.currentNativeHandle=null,a.currentNativeSource=null)}),yr(this,"isNodeInDocument",function(s){return!!(s&&a.document&&a.document.body&&a.document.body.contains(s))}),yr(this,"endDragIfSourceWasRemovedFromDOM",function(){var s=a.currentDragSourceNode;s==null||a.isNodeInDocument(s)||a.clearCurrentDragSourceNode()&&a.monitor.isDragging()&&a.actions.endDrag()}),yr(this,"handleTopDragStartCapture",function(){a.clearCurrentDragSourceNode(),a.dragStartSourceIds=[]}),yr(this,"handleTopDragStart",function(s){if(!s.defaultPrevented){var i=a.dragStartSourceIds;a.dragStartSourceIds=null;var l=rk(s);a.monitor.isDragging()&&a.actions.endDrag(),a.actions.beginDrag(i||[],{publishSource:!1,getSourceClientOffset:a.getSourceClientOffset,clientOffset:l});var c=s.dataTransfer,u=uO(c);if(a.monitor.isDragging()){if(c&&typeof c.setDragImage=="function"){var d=a.monitor.getSourceId(),f=a.sourceNodes.get(d),m=a.sourcePreviewNodes.get(d)||f;if(m){var p=a.getCurrentSourcePreviewNodeOptions(),v=p.anchorX,b=p.anchorY,y=p.offsetX,S=p.offsetY,_={anchorX:v,anchorY:b},N={offsetX:y,offsetY:S},k=cxt(f,m,l,_,N);c.setDragImage(m,k.x,k.y)}}try{c?.setData("application/json",{})}catch{}a.setCurrentDragSourceNode(s.target);var j=a.getCurrentSourcePreviewNodeOptions(),E=j.captureDraggingState;E?a.actions.publishDragSource():setTimeout(function(){return a.actions.publishDragSource()},0)}else if(u)a.beginDragNativeItem(u);else{if(c&&!c.types&&(s.target&&!s.target.hasAttribute||!s.target.hasAttribute("draggable")))return;s.preventDefault()}}}),yr(this,"handleTopDragEndCapture",function(){a.clearCurrentDragSourceNode()&&a.monitor.isDragging()&&a.actions.endDrag()}),yr(this,"handleTopDragEnterCapture",function(s){a.dragEnterTargetIds=[];var i=a.enterLeaveCounter.enter(s.target);if(!(!i||a.monitor.isDragging())){var l=s.dataTransfer,c=uO(l);c&&a.beginDragNativeItem(c,l)}}),yr(this,"handleTopDragEnter",function(s){var i=a.dragEnterTargetIds;if(a.dragEnterTargetIds=[],!!a.monitor.isDragging()){a.altKeyPressed=s.altKey,i.length>0&&a.actions.hover(i,{clientOffset:rk(s)});var l=i.some(function(c){return a.monitor.canDropOnTarget(c)});l&&(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=a.getCurrentDropEffect()))}}),yr(this,"handleTopDragOverCapture",function(){a.dragOverTargetIds=[]}),yr(this,"handleTopDragOver",function(s){var i=a.dragOverTargetIds;if(a.dragOverTargetIds=[],!a.monitor.isDragging()){s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none");return}a.altKeyPressed=s.altKey,a.lastClientOffset=rk(s),a.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(a.hoverRafId=requestAnimationFrame(function(){a.monitor.isDragging()&&a.actions.hover(i||[],{clientOffset:a.lastClientOffset}),a.hoverRafId=null}));var l=(i||[]).some(function(c){return a.monitor.canDropOnTarget(c)});l?(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=a.getCurrentDropEffect())):a.isDraggingNativeItem()?s.preventDefault():(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none"))}),yr(this,"handleTopDragLeaveCapture",function(s){a.isDraggingNativeItem()&&s.preventDefault();var i=a.enterLeaveCounter.leave(s.target);i&&a.isDraggingNativeItem()&&setTimeout(function(){return a.endDragNativeItem()},0)}),yr(this,"handleTopDropCapture",function(s){if(a.dropTargetIds=[],a.isDraggingNativeItem()){var i;s.preventDefault(),(i=a.currentNativeSource)===null||i===void 0||i.loadDataTransfer(s.dataTransfer)}else uO(s.dataTransfer)&&s.preventDefault();a.enterLeaveCounter.reset()}),yr(this,"handleTopDrop",function(s){var i=a.dropTargetIds;a.dropTargetIds=[],a.actions.hover(i,{clientOffset:rk(s)}),a.actions.drop({dropEffect:a.getCurrentDropEffect()}),a.isDraggingNativeItem()?a.endDragNativeItem():a.monitor.isDragging()&&a.actions.endDrag()}),yr(this,"handleSelectStart",function(s){var i=s.target;typeof i.dragDrop=="function"&&(i.tagName==="INPUT"||i.tagName==="SELECT"||i.tagName==="TEXTAREA"||i.isContentEditable||(s.preventDefault(),i.dragDrop()))}),this.options=new bxt(r,n),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new txt(this.isNodeInDocument)}return wxt(e,[{key:"profile",value:function(){var r,n;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((r=this.dragStartSourceIds)===null||r===void 0?void 0:r.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var r=this.rootElement;if(r!==void 0){if(r.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");r.__isReactDndBackendSetUp=!0,this.addEventListeners(r)}}},{key:"teardown",value:function(){var r=this.rootElement;if(r!==void 0&&(r.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var n;(n=this.window)===null||n===void 0||n.cancelAnimationFrame(this.asyncEndDragFrameId)}}},{key:"connectDragPreview",value:function(r,n,a){var s=this;return this.sourcePreviewNodeOptions.set(r,a),this.sourcePreviewNodes.set(r,n),function(){s.sourcePreviewNodes.delete(r),s.sourcePreviewNodeOptions.delete(r)}}},{key:"connectDragSource",value:function(r,n,a){var s=this;this.sourceNodes.set(r,n),this.sourceNodeOptions.set(r,a);var i=function(u){return s.handleDragStart(u,r)},l=function(u){return s.handleSelectStart(u)};return n.setAttribute("draggable","true"),n.addEventListener("dragstart",i),n.addEventListener("selectstart",l),function(){s.sourceNodes.delete(r),s.sourceNodeOptions.delete(r),n.removeEventListener("dragstart",i),n.removeEventListener("selectstart",l),n.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(r,n){var a=this,s=function(u){return a.handleDragEnter(u,r)},i=function(u){return a.handleDragOver(u,r)},l=function(u){return a.handleDrop(u,r)};return n.addEventListener("dragenter",s),n.addEventListener("dragover",i),n.addEventListener("drop",l),function(){n.removeEventListener("dragenter",s),n.removeEventListener("dragover",i),n.removeEventListener("drop",l)}}},{key:"addEventListeners",value:function(r){r.addEventListener&&(r.addEventListener("dragstart",this.handleTopDragStart),r.addEventListener("dragstart",this.handleTopDragStartCapture,!0),r.addEventListener("dragend",this.handleTopDragEndCapture,!0),r.addEventListener("dragenter",this.handleTopDragEnter),r.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.addEventListener("dragover",this.handleTopDragOver),r.addEventListener("dragover",this.handleTopDragOverCapture,!0),r.addEventListener("drop",this.handleTopDrop),r.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(r){r.removeEventListener&&(r.removeEventListener("dragstart",this.handleTopDragStart),r.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),r.removeEventListener("dragend",this.handleTopDragEndCapture,!0),r.removeEventListener("dragenter",this.handleTopDragEnter),r.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.removeEventListener("dragover",this.handleTopDragOver),r.removeEventListener("dragover",this.handleTopDragOverCapture,!0),r.removeEventListener("drop",this.handleTopDrop),r.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var r=this.monitor.getSourceId(),n=this.sourceNodeOptions.get(r);return sne({dropEffect:this.altKeyPressed?"copy":"move"},n||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var r=this.monitor.getSourceId(),n=this.sourcePreviewNodeOptions.get(r);return sne({anchorX:.5,anchorY:.5,captureDraggingState:!1},n||{})}},{key:"isDraggingNativeItem",value:function(){var r=this.monitor.getItemType();return Object.keys(rne).some(function(n){return rne[n]===r})}},{key:"beginDragNativeItem",value:function(r,n){this.clearCurrentDragSourceNode(),this.currentNativeSource=mxt(r,n),this.currentNativeHandle=this.registry.addSource(r,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(r){var n=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=r;var a=1e3;this.mouseMoveTimeoutTimer=setTimeout(function(){var s;return(s=n.rootElement)===null||s===void 0?void 0:s.addEventListener("mousemove",n.endDragIfSourceWasRemovedFromDOM,!0)},a)}},{key:"clearCurrentDragSourceNode",value:function(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var r;(r=this.window)===null||r===void 0||r.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}},{key:"handleDragStart",value:function(r,n){r.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(n))}},{key:"handleDragEnter",value:function(r,n){this.dragEnterTargetIds.unshift(n)}},{key:"handleDragOver",value:function(r,n){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(n)}},{key:"handleDrop",value:function(r,n){this.dropTargetIds.unshift(n)}}]),e})(),ak;function kxt(){return ak||(ak=new Image,ak.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),ak}var _xt=function(t,r,n){return new Sxt(t,r,n)};function Nxt(e){const t=Hi(),r=t.selectedIds,[n,a,s]=Eyt(()=>({canDrag:()=>e.isDraggable,type:"NODE",item:()=>{const i=t.isSelected(e.id)?Array.from(r):[e.id];return t.dispatch(Vg.dragStart(e.id,i)),{id:e.id,dragIds:i}},end:()=>{t.hideCursor(),t.dispatch(Vg.dragEnd())}}),[r,e]);return w.useEffect(()=>{s(kxt())},[s]),a}function Cxt(e,t){const r=e.getBoundingClientRect(),n=t.x-Math.round(r.x),a=t.y-Math.round(r.y),s=r.height,i=a<s/2,l=!i,c=s/4,u=a>c&&a<s-c;return{x:n,inTopHalf:i,inBottomHalf:l,inMiddle:u,atTop:!u&&i,atBottom:!u&&l}}function jxt(e,t,r,n){return e?e.isInternal?n.atTop?[t,e]:n.inMiddle?[e,e]:[e,r]:n.inTopHalf?[t,e]:[e,r]:[t,null]}function sk(e,t){return{parentId:e||null,index:t}}function mp(e,t){return{type:"line",index:e,level:t}}function Ext(e){return{type:"highlight",id:e}}function fO(e,t){var r;let n=e;for(;n.parent&&n.level>t;)n=n.parent;const a=((r=n.parent)===null||r===void 0?void 0:r.id)||null,s=$be(n)+1;return{parentId:a,index:s}}function gye(e){var t;const r=Cxt(e.element,e.offset),n=e.indent,a=Math.round(Math.max(0,r.x-n)/n),{node:s,nextNode:i,prevNode:l}=e,[c,u]=jxt(s,l,i,r);if(s&&s.isInternal&&r.inMiddle)return{drop:sk(s.id,null),cursor:Ext(s.id)};if(!c)return{drop:sk((t=u?.parent)===null||t===void 0?void 0:t.id,0),cursor:mp(0,0)};if(Rbe(c)){const d=Gk(a,u?.level||0,c.level);return{drop:fO(c,d),cursor:mp(c.rowIndex+1,d)}}if(Pbe(c)){const d=Gk(a,u?.level||0,c.level);return{drop:fO(c,d),cursor:mp(c.rowIndex+1,d)}}if(zbe(c)){const d=Gk(a,0,c.level+1);return d>c.level?{drop:sk(c.id,0),cursor:mp(c.rowIndex+1,d)}:{drop:fO(c,d),cursor:mp(c.rowIndex+1,d)}}return{drop:sk(c?.id,0),cursor:mp(c.rowIndex+1,c.level+1)}}function Mxt(e,t){const r=Hi(),[n,a]=lye(()=>({accept:"NODE",canDrop:()=>r.canDrop(),hover:(s,i)=>{const l=i.getClientOffset();if(!e.current||!l)return;const{cursor:c,drop:u}=gye({element:e.current,offset:l,indent:r.indent,node:t,prevNode:t.prev,nextNode:t.next});u&&r.dispatch(Vg.hovering(u.parentId,u.index)),i.canDrop()?c&&r.showCursor(c):r.hideCursor()},drop:(s,i)=>{if(!i.canDrop())return null;let{parentId:l,index:c,dragIds:u}=r.state.dnd;Wbe(r.props.onMove,{dragIds:u,parentId:l===jx?null:l,index:c===null?0:c,dragNodes:r.dragNodes,parentNode:r.get(l)}),r.open(l)}}),[t,e.current,r.props]);return a}function Txt(e){const t=Hi(),r=t.at(e);if(!r)throw new Error(`Could not find node for index: ${e}`);return w.useMemo(()=>{const n=r.clone();return t.visibleNodes[e]=n,n},[...Object.values(r.state),r])}const Axt=ce.memo(function({index:t,style:r}){Ibe(),a0t();const n=Hi(),a=Txt(t),s=w.useRef(null),i=Nxt(a),l=Mxt(s,a),c=w.useCallback(b=>{s.current=b,l(b)},[l]),u=n.indent*a.level,d=w.useMemo(()=>({paddingLeft:u}),[u]),f=w.useMemo(()=>{var b,y;return Object.assign(Object.assign({},r),{top:parseFloat(r.top)+((y=(b=n.props.padding)!==null&&b!==void 0?b:n.props.paddingTop)!==null&&y!==void 0?y:0)})},[r,n.props.padding,n.props.paddingTop]),m={role:"treeitem","aria-level":a.level+1,"aria-selected":a.isSelected,"aria-expanded":a.isOpen,style:f,tabIndex:-1,className:n.props.rowClassName};w.useEffect(()=>{var b;!a.isEditing&&a.isFocused&&((b=s.current)===null||b===void 0||b.focus({preventScroll:!0}))},[a.isEditing,a.isFocused,s.current]);const p=n.renderNode,v=n.renderRow;return o.jsx(v,{node:a,innerRef:c,attrs:m,children:o.jsx(p,{node:a,tree:n,style:d,dragHandle:i})})});let hO="",ine=null;function vye(){Ibe();const e=Hi();return o.jsx("div",{role:"tree",style:{height:e.height,width:e.width,minHeight:0,minWidth:0},onContextMenu:e.props.onContextMenu,onClick:e.props.onClick,tabIndex:0,onFocus:t=>{t.currentTarget.contains(t.relatedTarget)||e.onFocus()},onBlur:t=>{t.currentTarget.contains(t.relatedTarget)||e.onBlur()},onKeyDown:t=>{var r;if(e.isEditing)return;if(t.key==="Backspace"){if(!e.props.onDelete)return;const a=Array.from(e.selectedIds);if(a.length>1){let s=e.mostRecentNode;for(;s&&s.isSelected;)s=s.nextSibling;s||(s=e.lastNode),e.focus(s,{scroll:!1}),e.delete(Array.from(a))}else{const s=e.focusedNode;if(s){const i=s.nextSibling,l=s.parent;e.focus(i||l,{scroll:!1}),e.delete(s)}}return}if(t.key==="Tab"&&!t.shiftKey){t.preventDefault(),Fbe(t.currentTarget);return}if(t.key==="Tab"&&t.shiftKey){t.preventDefault(),Ube(t.currentTarget);return}if(t.key==="ArrowDown"){t.preventDefault();const a=e.nextNode;if(t.metaKey){e.select(e.focusedNode),e.activate(e.focusedNode);return}else if(!t.shiftKey||e.props.disableMultiSelection){e.focus(a);return}else{if(!a)return;const s=e.focusedNode;s?s.isSelected?e.selectContiguous(a):e.selectMulti(a):e.focus(e.firstNode);return}}if(t.key==="ArrowUp"){t.preventDefault();const a=e.prevNode;if(!t.shiftKey||e.props.disableMultiSelection){e.focus(a);return}else{if(!a)return;const s=e.focusedNode;s?s.isSelected?e.selectContiguous(a):e.selectMulti(a):e.focus(e.lastNode);return}}if(t.key==="ArrowRight"){const a=e.focusedNode;if(!a)return;a.isInternal&&a.isOpen?e.focus(e.nextNode):a.isInternal&&e.open(a.id);return}if(t.key==="ArrowLeft"){const a=e.focusedNode;if(!a||a.isRoot)return;a.isInternal&&a.isOpen?e.close(a.id):!((r=a.parent)===null||r===void 0)&&r.isRoot||e.focus(a.parent);return}if(t.key==="a"&&t.metaKey&&!e.props.disableMultiSelection){t.preventDefault(),e.selectAll();return}if(t.key==="a"&&!t.metaKey&&e.props.onCreate){e.createLeaf();return}if(t.key==="A"&&!t.metaKey){if(!e.props.onCreate)return;e.createInternal();return}if(t.key==="Home"){t.preventDefault(),e.focus(e.firstNode);return}if(t.key==="End"){t.preventDefault(),e.focus(e.lastNode);return}if(t.key==="Enter"){const a=e.focusedNode;if(!a||!a.isEditable||!e.props.onRename)return;setTimeout(()=>{a&&e.edit(a)});return}if(t.key===" "){t.preventDefault();const a=e.focusedNode;if(!a)return;a.isLeaf?(a.select(),a.activate()):a.toggle();return}if(t.key==="*"){const a=e.focusedNode;if(!a)return;e.openSiblings(a);return}if(t.key==="PageUp"){t.preventDefault(),e.pageUp();return}t.key==="PageDown"&&(t.preventDefault(),e.pageDown()),clearTimeout(ine),hO+=t.key,ine=setTimeout(()=>{hO=""},600);const n=e.visibleNodes.find(a=>{const s=a.data.name;return typeof s=="string"?s.toLowerCase().startsWith(hO):!1});n&&e.focus(n.id)},children:o.jsx(z0t,{className:e.props.className,outerRef:e.listEl,itemCount:e.visibleNodes.length,height:e.height,width:e.width,itemSize:e.rowHeight,overscanCount:e.overscanCount,itemKey:t=>{var r;return((r=e.visibleNodes[t])===null||r===void 0?void 0:r.id)||t},outerElementType:F0t,innerElementType:q0t,onScroll:e.props.onScroll,onItemsRendered:e.onItemsRendered.bind(e),ref:e.list,children:Axt})})}function one(e){return e.isFiltered?Lxt(e.root,e.isMatch.bind(e)):Dxt(e.root)}function Dxt(e){const t=[];function r(n){var a;n.level>=0&&t.push(n),n.isOpen&&((a=n.children)===null||a===void 0||a.forEach(r))}return r(e),t.forEach(bye),t}function Lxt(e,t){const r={},n=[];function a(i){if(!i.isRoot&&t(i)){r[i.id]=!0;let c=i.parent;for(;c;)r[c.id]=!0,c=c.parent}if(i.children)for(let c of i.children)a(c)}function s(i){var l;i.level>=0&&r[i.id]&&n.push(i),i.isOpen&&((l=i.children)===null||l===void 0||l.forEach(s))}return a(e),s(e),n.forEach(bye),n}function bye(e,t){e.rowIndex=t}const lne=e=>e.reduce((t,r,n)=>(t[r.id]=n,t),{});var mO=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})};const{safeRun:La,identify:wc,identifyNull:Io}=l0t;class ny{constructor(t,r,n,a){this.store=t,this.props=r,this.list=n,this.listEl=a,this.visibleStartIndex=0,this.visibleStopIndex=0,this.root=bre(this),this.visibleNodes=one(this),this.idToIndex=lne(this.visibleNodes)}update(t){this.props=t,this.root=bre(this),this.visibleNodes=one(this),this.idToIndex=lne(this.visibleNodes)}dispatch(t){return this.store.dispatch(t)}get state(){return this.store.getState()}get openState(){return this.state.nodes.open.unfiltered}get width(){var t;return(t=this.props.width)!==null&&t!==void 0?t:300}get height(){var t;return(t=this.props.height)!==null&&t!==void 0?t:500}get indent(){var t;return(t=this.props.indent)!==null&&t!==void 0?t:24}get rowHeight(){var t;return(t=this.props.rowHeight)!==null&&t!==void 0?t:24}get overscanCount(){var t;return(t=this.props.overscanCount)!==null&&t!==void 0?t:1}get searchTerm(){return(this.props.searchTerm||"").trim()}get matchFn(){var t;const r=(t=this.props.searchMatch)!==null&&t!==void 0?t:((n,a)=>JSON.stringify(Object.values(n.data)).toLocaleLowerCase().includes(a.toLocaleLowerCase()));return n=>r(n,this.searchTerm)}accessChildren(t){var r;const n=this.props.childrenAccessor||"children";return(r=Cb(t,n))!==null&&r!==void 0?r:null}accessId(t){const r=this.props.idAccessor||"id",n=Cb(t,r);if(!n)throw new Error("Data must contain an 'id' property or props.idAccessor must return a string");return n}get firstNode(){var t;return(t=this.visibleNodes[0])!==null&&t!==void 0?t:null}get lastNode(){var t;return(t=this.visibleNodes[this.visibleNodes.length-1])!==null&&t!==void 0?t:null}get focusedNode(){var t;return(t=this.get(this.state.nodes.focus.id))!==null&&t!==void 0?t:null}get mostRecentNode(){var t;return(t=this.get(this.state.nodes.selection.mostRecent))!==null&&t!==void 0?t:null}get nextNode(){const t=this.indexOf(this.focusedNode);return t===null?null:this.at(t+1)}get prevNode(){const t=this.indexOf(this.focusedNode);return t===null?null:this.at(t-1)}get(t){return t&&t in this.idToIndex&&this.visibleNodes[this.idToIndex[t]]||null}at(t){return this.visibleNodes[t]||null}nodesBetween(t,r){var n;if(t===null||r===null)return[];const a=(n=this.indexOf(t))!==null&&n!==void 0?n:0,s=this.indexOf(r);if(s===null)return[];const i=Math.min(a,s),l=Math.max(a,s);return this.visibleNodes.slice(i,l+1)}indexOf(t){const r=qbe(t);return r?this.idToIndex[r]:null}get editingId(){return this.state.nodes.edit.id}createInternal(){return this.create({type:"internal"})}createLeaf(){return this.create({type:"leaf"})}create(){return mO(this,arguments,void 0,function*(t={}){var r,n;const a=t.parentId===void 0?Vbe(this):t.parentId,s=(r=t.index)!==null&&r!==void 0?r:Gbe(this),i=(n=t.type)!==null&&n!==void 0?n:"leaf",l=yield La(this.props.onCreate,{type:i,parentId:a,index:s,parentNode:this.get(a)});l&&(this.focus(l),setTimeout(()=>{this.edit(l).then(()=>{this.select(l),this.activate(l)})}))})}delete(t){return mO(this,void 0,void 0,function*(){if(!t)return;const n=(Array.isArray(t)?t:[t]).map(wc),a=n.map(s=>this.get(s)).filter(s=>!!s);yield La(this.props.onDelete,{nodes:a,ids:n})})}edit(t){const r=wc(t);return this.resolveEdit({cancelled:!0}),this.scrollTo(r),this.dispatch(tO(r)),new Promise(n=>{ny.editPromise=n})}submit(t,r){return mO(this,void 0,void 0,function*(){if(!t)return;const n=wc(t);yield La(this.props.onRename,{id:n,name:r,node:this.get(n)}),this.dispatch(tO(null)),this.resolveEdit({cancelled:!1,value:r}),setTimeout(()=>this.onFocus())})}reset(){this.dispatch(tO(null)),this.resolveEdit({cancelled:!0}),setTimeout(()=>this.onFocus())}activate(t){const r=this.get(Io(t));r&&La(this.props.onActivate,r)}resolveEdit(t){const r=ny.editPromise;r&&r(t),ny.editPromise=null}get selectedIds(){return this.state.nodes.selection.ids}get selectedNodes(){let t=[];for(let r of Array.from(this.selectedIds)){const n=this.get(r);n&&t.push(n)}return t}focus(t,r={}){t&&(this.props.selectionFollowsFocus?this.select(t):(this.dispatch(up(wc(t))),r.scroll!==!1&&this.scrollTo(t),this.focusedNode&&La(this.props.onFocus,this.focusedNode)))}pageUp(){var t,r;const n=this.visibleStartIndex,s=this.visibleStopIndex-n;let i=(r=(t=this.focusedNode)===null||t===void 0?void 0:t.rowIndex)!==null&&r!==void 0?r:0;i>n?i=n:i=Math.max(n-s,0),this.focus(this.at(i))}pageDown(){var t,r;const n=this.visibleStartIndex,a=this.visibleStopIndex,s=a-n;let i=(r=(t=this.focusedNode)===null||t===void 0?void 0:t.rowIndex)!==null&&r!==void 0?r:0;i<a?i=a:i=Math.min(i+s,this.visibleNodes.length-1),this.focus(this.at(i))}select(t,r={}){if(!t)return;const n=r.focus!==!1,a=wc(t);n&&this.dispatch(up(a)),this.dispatch(Oo.only(a)),this.dispatch(Oo.anchor(a)),this.dispatch(Oo.mostRecent(a)),this.scrollTo(a,r.align),this.focusedNode&&n&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes)}deselect(t){if(!t)return;const r=wc(t);this.dispatch(Oo.remove(r)),La(this.props.onSelect,this.selectedNodes)}selectMulti(t){const r=this.get(Io(t));r&&(this.dispatch(up(r.id)),this.dispatch(Oo.add(r.id)),this.dispatch(Oo.anchor(r.id)),this.dispatch(Oo.mostRecent(r.id)),this.scrollTo(r),this.focusedNode&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes))}selectContiguous(t){if(!t)return;const r=wc(t),{anchor:n,mostRecent:a}=this.state.nodes.selection;this.dispatch(up(r)),this.dispatch(Oo.remove(this.nodesBetween(n,a))),this.dispatch(Oo.add(this.nodesBetween(n,Io(r)))),this.dispatch(Oo.mostRecent(r)),this.scrollTo(r),this.focusedNode&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes)}deselectAll(){this.setSelection({ids:[],anchor:null,mostRecent:null}),La(this.props.onSelect,this.selectedNodes)}selectAll(){var t;this.setSelection({ids:Object.keys(this.idToIndex),anchor:this.firstNode,mostRecent:this.lastNode}),this.dispatch(up((t=this.lastNode)===null||t===void 0?void 0:t.id)),this.focusedNode&&La(this.props.onFocus,this.focusedNode),La(this.props.onSelect,this.selectedNodes)}setSelection(t){var r;const n=new Set((r=t.ids)===null||r===void 0?void 0:r.map(wc)),a=Io(t.anchor),s=Io(t.mostRecent);this.dispatch(Oo.set({ids:n,anchor:a,mostRecent:s})),La(this.props.onSelect,this.selectedNodes)}get cursorParentId(){const{cursor:t}=this.state.dnd;switch(t.type){case"highlight":return t.id;default:return null}}get cursorOverFolder(){return this.state.dnd.cursor.type==="highlight"}get dragNodes(){return this.state.dnd.dragIds.map(t=>this.get(t)).filter(t=>!!t)}get dragNode(){return this.get(this.state.nodes.drag.id)}get dragDestinationParent(){return this.get(this.state.nodes.drag.destinationParentId)}get dragDestinationIndex(){return this.state.nodes.drag.destinationIndex}canDrop(){var t;if(this.isFiltered)return!1;const r=(t=this.get(this.state.dnd.parentId))!==null&&t!==void 0?t:this.root,n=this.dragNodes,a=this.props.disableDrop;for(const s of n)if(!s||!r||s.isInternal&&Bbe(r,s))return!1;return typeof a=="function"?!a({parentNode:r,dragNodes:this.dragNodes,index:this.state.dnd.index||0}):typeof a=="string"?!r.data[a]:typeof a=="boolean"?!a:!0}hideCursor(){this.dispatch(Vg.cursor({type:"none"}))}showCursor(t){this.dispatch(Vg.cursor(t))}open(t){const r=Io(t);r&&(this.isOpen(r)||(this.dispatch(v5.open(r,this.isFiltered)),La(this.props.onToggle,r)))}close(t){const r=Io(t);r&&this.isOpen(r)&&(this.dispatch(v5.close(r,this.isFiltered)),La(this.props.onToggle,r))}toggle(t){const r=Io(t);if(r)return this.isOpen(r)?this.close(r):this.open(r)}openParents(t){const r=Io(t);if(!r)return;const n=$$(this.root,r);let a=n?.parent;for(;a;)this.open(a.id),a=a.parent}openSiblings(t){const r=t.parent;if(!r)this.toggle(t.id);else if(r.children){const n=t.isOpen;for(let a of r.children)a.isInternal&&(n?this.close(a.id):this.open(a.id));this.scrollTo(this.focusedNode)}}openAll(){DC(this.root,t=>{t.isInternal&&t.open()})}closeAll(){DC(this.root,t=>{t.isInternal&&t.close()})}scrollTo(t,r="smart"){if(!t)return;const n=wc(t);return this.openParents(n),Kbe(()=>n in this.idToIndex).then(()=>{var a;const s=this.idToIndex[n];s!==void 0&&((a=this.list.current)===null||a===void 0||a.scrollToItem(s,r))}).catch(()=>{})}get isEditing(){return this.state.nodes.edit.id!==null}get isFiltered(){var t;return!!(!((t=this.props.searchTerm)===null||t===void 0)&&t.trim())}get hasFocus(){return this.state.nodes.focus.treeFocused}get hasNoSelection(){return this.state.nodes.selection.ids.size===0}get hasOneSelection(){return this.state.nodes.selection.ids.size===1}get hasMultipleSelections(){return this.state.nodes.selection.ids.size>1}isSelected(t){return t?this.state.nodes.selection.ids.has(t):!1}isOpen(t){var r,n,a;if(!t)return!1;if(t===jx)return!0;const s=(r=this.props.openByDefault)!==null&&r!==void 0?r:!0;return this.isFiltered?(n=this.state.nodes.open.filtered[t])!==null&&n!==void 0?n:!0:(a=this.state.nodes.open.unfiltered[t])!==null&&a!==void 0?a:s}isEditable(t){const r=this.props.disableEdit||(()=>!1);return!Cb(t,r)}isDraggable(t){const r=this.props.disableDrag||(()=>!1);return!Cb(t,r)}isDragging(t){const r=Io(t);return r?this.state.nodes.drag.id===r:!1}isFocused(t){return this.hasFocus&&this.state.nodes.focus.id===t}isMatch(t){return this.matchFn(t)}willReceiveDrop(t){const r=Io(t);if(!r)return!1;const{destinationParentId:n,destinationIndex:a}=this.state.nodes.drag;return r===n&&a===null}onFocus(){const t=this.focusedNode||this.firstNode;t&&this.dispatch(up(t.id))}onBlur(){this.dispatch(b0t())}onItemsRendered(t){this.visibleStartIndex=t.visibleStartIndex,this.visibleStopIndex=t.visibleStopIndex}get renderContainer(){return this.props.renderContainer||vye}get renderRow(){return this.props.renderRow||h0t}get renderNode(){return this.props.children||m0t}get renderDragPreview(){return this.props.renderDragPreview||Ybe}get renderCursor(){return this.props.renderCursor||f0t}}function vs(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Oxt=typeof Symbol=="function"&&Symbol.observable||"@@observable",cne=Oxt,pO=()=>Math.random().toString(36).substring(7).split("").join("."),Ixt={INIT:`@@redux/INIT${pO()}`,REPLACE:`@@redux/REPLACE${pO()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${pO()}`},IC=Ixt;function Rxt(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function yye(e,t,r){if(typeof e!="function")throw new Error(vs(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(vs(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(vs(1));return r(yye)(e,t)}let n=e,a=t,s=new Map,i=s,l=0,c=!1;function u(){i===s&&(i=new Map,s.forEach((y,S)=>{i.set(S,y)}))}function d(){if(c)throw new Error(vs(3));return a}function f(y){if(typeof y!="function")throw new Error(vs(4));if(c)throw new Error(vs(5));let S=!0;u();const _=l++;return i.set(_,y),function(){if(S){if(c)throw new Error(vs(6));S=!1,u(),i.delete(_),s=null}}}function m(y){if(!Rxt(y))throw new Error(vs(7));if(typeof y.type>"u")throw new Error(vs(8));if(typeof y.type!="string")throw new Error(vs(17));if(c)throw new Error(vs(9));try{c=!0,a=n(a,y)}finally{c=!1}return(s=i).forEach(_=>{_()}),y}function p(y){if(typeof y!="function")throw new Error(vs(10));n=y,m({type:IC.REPLACE})}function v(){const y=f;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(vs(11));function _(){const k=S;k.next&&k.next(d())}return _(),{unsubscribe:y(_)}},[cne](){return this}}}return m({type:IC.INIT}),{dispatch:m,subscribe:f,getState:d,replaceReducer:p,[cne]:v}}function Pxt(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:IC.INIT})>"u")throw new Error(vs(12));if(typeof r(void 0,{type:IC.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(vs(13))})}function une(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const i=t[s];typeof e[i]=="function"&&(r[i]=e[i])}const n=Object.keys(r);let a;try{Pxt(r)}catch(s){a=s}return function(i={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],m=r[f],p=i[f],v=m(p,l);if(typeof v>"u")throw l&&l.type,new Error(vs(14));u[f]=v,c=c||v!==p}return c=c||n.length!==Object.keys(i).length,c?u:i}}function zxt(e=Gg().nodes.drag,t){switch(t.type){case"DND_DRAG_START":return Object.assign(Object.assign({},e),{id:t.id,selectedIds:t.dragIds});case"DND_DRAG_END":return Object.assign(Object.assign({},e),{id:null,destinationParentId:null,destinationIndex:null,selectedIds:[]});case"DND_HOVERING":return t.parentId!==e.destinationParentId||t.index!=e.destinationIndex?Object.assign(Object.assign({},e),{destinationParentId:t.parentId,destinationIndex:t.index}):e;default:return e}}const Bxt=une({nodes:une({focus:y0t,edit:v0t,open:x0t,selection:w0t,drag:zxt}),dnd:S0t}),$xt=Gg();function Fxt({treeProps:e,imperativeHandle:t,children:r}){const n=w.useRef(null),a=w.useRef(null),s=w.useRef(yye(Bxt,Gg(e))),i=i9.useSyncExternalStore(s.current.subscribe,s.current.getState,()=>$xt),l=w.useMemo(()=>new ny(s.current,e,n,a),[]),c=w.useRef(0);return w.useMemo(()=>{c.current+=1,l.update(e)},[...Object.values(e),i.nodes.open]),w.useImperativeHandle(t,()=>l),w.useEffect(()=>{l.props.selection?l.select(l.props.selection,{focus:!1}):l.deselectAll()},[l.props.selection]),w.useEffect(()=>{l.props.searchTerm||s.current.dispatch(v5.clear(!0))},[l.props.searchTerm]),o.jsx(Abe.Provider,{value:l,children:o.jsx(Obe.Provider,{value:c.current,children:o.jsx(Dbe.Provider,{value:i.nodes,children:o.jsx(Lbe.Provider,{value:i.dnd,children:o.jsx(kbt,Object.assign({backend:_xt,options:{rootElement:l.props.dndRootElement||void 0}},e.dndManager&&{manager:e.dndManager},{children:r}))})})})})}function Uxt(){const e=Hi(),[,t]=lye(()=>({accept:"NODE",canDrop:(r,n)=>n.isOver({shallow:!0})?e.canDrop():!1,hover:(r,n)=>{if(!n.isOver({shallow:!0}))return;const a=n.getClientOffset();if(!e.listEl.current||!a)return;const{cursor:s,drop:i}=gye({element:e.listEl.current,offset:a,indent:e.indent,node:null,prevNode:e.visibleNodes[e.visibleNodes.length-1],nextNode:null});i&&e.dispatch(Vg.hovering(i.parentId,i.index)),n.canDrop()?s&&e.showCursor(s):e.hideCursor()}}),[e]);t(e.listEl)}function Hxt(e){return Uxt(),e.children}function qxt(){const t=Hi().props.renderContainer||vye;return o.jsx(o.Fragment,{children:o.jsx(t,{})})}function Wxt(){const e=Hi(),{offset:t,mouse:r,item:n,isDragging:a}=Yyt(i=>({offset:i.getSourceClientOffset(),mouse:i.getClientOffset(),item:i.getItem(),isDragging:i.isDragging()})),s=e.props.renderDragPreview||Ybe;return o.jsx(s,{offset:t,mouse:r,id:n?.id||null,dragIds:n?.dragIds||[],isDragging:a})}class Kxt{constructor(t){this.root=Gxt(t)}get data(){var t,r;return(r=(t=this.root.children)===null||t===void 0?void 0:t.map(n=>n.data))!==null&&r!==void 0?r:[]}create(t){const r=t.parentId?this.find(t.parentId):this.root;if(!r)return null;r.addChild(t.data,t.index)}move(t){const r=this.find(t.id),n=t.parentId?this.find(t.parentId):this.root;!r||!n||(n.addChild(r.data,t.index),r.drop())}update(t){const r=this.find(t.id);r&&r.update(t.changes)}drop(t){const r=this.find(t.id);r&&r.drop()}find(t,r=this.root){if(!r)return null;if(r.id===t)return r;if(r.children){for(let n of r.children){const a=this.find(t,n);if(a)return a}return null}return null}}function Gxt(e){const t=new xye({id:"ROOT"},null);return t.children=e.map(r=>G$(r,t)),t}function G$(e,t){const r=new xye(e,t);return e.children&&(r.children=e.children.map(n=>G$(n,r))),r}class xye{constructor(t,r){this.data=t,this.parent=r,this.id=t.id}hasParent(){return!!this.parent}get childIndex(){return this.hasParent()?this.parent.children.indexOf(this):-1}addChild(t,r){var n,a;const s=G$(t,this);this.children=(n=this.children)!==null&&n!==void 0?n:[],this.children.splice(r,0,s),this.data.children=(a=this.data.children)!==null&&a!==void 0?a:[],this.data.children.splice(r,0,t)}removeChild(t){var r,n;(r=this.children)===null||r===void 0||r.splice(t,1),(n=this.data.children)===null||n===void 0||n.splice(t,1)}update(t){if(this.hasParent()){const r=this.childIndex;this.parent.addChild(Object.assign(Object.assign({},this.data),t),r),this.drop()}}drop(){this.hasParent()&&this.parent.removeChild(this.childIndex)}}let Vxt=0;function Yxt(e){const[t,r]=w.useState(e),n=w.useMemo(()=>new Kxt(t),[t]);return[t,{onMove:u=>{for(const d of u.dragIds)n.move({id:d,parentId:u.parentId,index:u.index});r(n.data)},onRename:({name:u,id:d})=>{n.update({id:d,changes:{name:u}}),r(n.data)},onCreate:({parentId:u,index:d,type:f})=>{const m={id:`simple-tree-id-${Vxt++}`,name:""};return f==="internal"&&(m.children=[]),n.create({parentId:u,index:d,data:m}),r(n.data),m},onDelete:u=>{u.ids.forEach(d=>n.drop({id:d})),r(n.data)}}]}function Qxt(e){if(e.initialData&&e.data)throw new Error("React Arborist Tree => Provide either a data or initialData prop, but not both.");if(e.initialData&&(e.onCreate||e.onDelete||e.onMove||e.onRename))throw new Error(`React Arborist Tree => You passed the initialData prop along with a data handler.
Use the data prop if you want to provide your own handlers.`);if(e.initialData){const[t,r]=Yxt(e.initialData);return Object.assign(Object.assign(Object.assign({},e),r),{data:t})}else return e}function Jxt(e,t){const r=Qxt(e);return o.jsxs(Fxt,{treeProps:r,imperativeHandle:t,children:[o.jsx(Hxt,{children:o.jsx(qxt,{})}),o.jsx(Wxt,{})]})}const wye=w.forwardRef(Jxt),Sye=w.createContext({});function kye(e){return e.map(t=>({id:t.id,name:t.name,nodeType:"library",parentId:t.parentId,data:t,children:t.children.length>0?kye(t.children):void 0}))}function Zxt({node:e,style:t,dragHandle:r}){const{onDeleteLibrary:n}=w.useContext(Sye),a=e.isSelected,s=e.isOpen,i=!e.isLeaf,{isOver:l,setNodeRef:c}=O2({id:`library-drop-${e.id}`,data:{type:"library",id:e.id,name:e.data.name}});return o.jsx("div",{ref:c,"data-testid":`library-tree-item-${e.id}`,style:t,className:`relative ${l?"ring-2 ring-blue-400 ring-inset rounded":""}`,children:o.jsxs("div",{ref:r,className:`group flex items-center gap-1 px-2 py-1.5 rounded-md cursor-pointer transition-colors ${a?"bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,onClick:u=>{u.stopPropagation(),e.select(),e.activate()},children:[o.jsx("button",{"data-testid":`library-toggle-${e.id}`,onClick:u=>{u.stopPropagation(),e.toggle()},className:"p-0.5 hover:bg-gray-200 dark:hover:bg-gray-700 rounded","aria-label":i?s?`Collapse ${e.data.name}`:`Expand ${e.data.name}`:"No children","aria-expanded":i?s:void 0,children:i?s?o.jsx(Yt,{className:"w-4 h-4 text-gray-500"}):o.jsx(gn,{className:"w-4 h-4 text-gray-500"}):o.jsx("span",{className:"w-4 h-4","aria-hidden":"true"})}),s&&i?o.jsx(G6,{className:"w-4 h-4 text-yellow-500 flex-shrink-0"}):o.jsx(a0,{className:"w-4 h-4 text-yellow-500 flex-shrink-0"}),o.jsx("span",{"data-testid":`library-name-${e.id}`,className:"text-sm font-medium truncate flex-1",children:e.data.name}),n&&o.jsx("button",{"data-testid":`delete-library-button-${e.id}`,onClick:u=>{u.stopPropagation(),n(e.id)},className:"p-1 opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded transition-all",title:"Delete Library","aria-label":`Delete ${e.data.name}`,children:o.jsx(pr,{className:"w-3.5 h-3.5"})})]})})}function Xxt({libraries:e,selectedLibraryId:t,expandedIds:r,onSelectLibrary:n,onToggleExpand:a,onNewDocument:s,onNewLibrary:i,onSelectDocument:l,onMoveLibrary:c,onReorderLibrary:u,onDeleteLibrary:d,activeDragData:f,isMobile:m=!1,compact:p=!1}){const v=w.useRef(null),b=w.useRef(null),[y,S]=w.useState(400);w.useEffect(()=>{if(!b.current)return;const M=new ResizeObserver(P=>{for(const I of P)S(I.contentRect.height)});return M.observe(b.current),()=>M.disconnect()},[]);const _=w.useMemo(()=>Jgt(e),[e]),N=w.useMemo(()=>kye(_),[_]),k=w.useMemo(()=>{const M={};for(const P of r)M[P]=!0;return M},[r]),j=w.useCallback(M=>{M.length>0&&n(M[0].id)},[n]),E=w.useCallback(M=>{n(M.id)},[n]),T=w.useCallback(M=>{a(M)},[a]),O=w.useCallback(async({dragIds:M,parentId:P,parentNode:I,dragNodes:B,index:F})=>{const q=M[0];if(!q||q===P)return;const Q=B[0];if(Q&&I&&Q.isAncestorOf(I)){console.warn("Cannot move library to its own descendant");return}(B[0]?.data.parentId??null)===P?u&&u(q,F):c&&c(q,P,F)},[c,u]),R=w.useCallback(({parentNode:M,dragNodes:P})=>{for(const I of P)if(I.isAncestorOf(M)||I.id===M.id)return!0;return!1},[]),{isOver:H,setNodeRef:$}=O2({id:"all-documents-drop",data:{type:"all-documents",id:null}}),L=f?.type==="document",A=w.useMemo(()=>({onDeleteLibrary:d}),[d]);return o.jsx(Sye.Provider,{value:A,children:o.jsxs("div",{"data-testid":"library-tree",className:`${m?"w-full":p?"w-48 @3xl/docs:w-64 border-r border-gray-200 dark:border-[var(--color-border)]":"w-64 border-r border-gray-200 dark:border-[var(--color-border)]"} bg-white dark:bg-[var(--color-bg)] flex flex-col h-full`,children:[o.jsxs("div",{className:`${m?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h2",{className:`${m?"text-base":"text-lg"} font-semibold text-gray-900 dark:text-[var(--color-text)] flex items-center gap-2`,children:[o.jsx(Wwe,{className:`${m?"w-4 h-4":"w-5 h-5"} text-blue-500`}),"Libraries"]}),!m&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:i,className:"p-1.5 text-gray-500 hover:text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/30 rounded-md transition-colors",title:"New Library","data-testid":"new-library-button-sidebar",children:o.jsx(K6,{className:"w-4 h-4"})}),o.jsx("button",{onClick:s,className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-md transition-colors",title:"Create Document","data-testid":"new-document-button-sidebar",children:o.jsx(dr,{className:"w-4 h-4"})})]})]}),o.jsx(Zgt,{onSelectDocument:l})]}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsx("div",{className:"p-2 pb-0",children:o.jsxs("button",{ref:$,onClick:()=>n(null),className:`w-full flex items-center gap-2 ${m?"px-3 py-3":"px-3 py-2"} rounded-md text-left text-sm mb-2 transition-all ${t===null?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"} ${m?"touch-target":""} ${H&&L?"ring-2 ring-blue-400":""}`,"data-testid":"all-documents-button",children:[o.jsx(rn,{className:"w-4 h-4"}),"All Documents",H&&L&&o.jsx("span",{className:"ml-auto text-xs text-blue-500",children:"Drop to remove from library"})]})}),e.length===0?o.jsxs("div",{"data-testid":"library-empty-state",className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[o.jsx(a0,{className:"w-12 h-12 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),o.jsx("p",{className:"text-sm",children:"No libraries yet"}),o.jsx("button",{onClick:i,className:"mt-2 text-sm text-purple-600 dark:text-purple-400 hover:underline","data-testid":"new-library-button-empty",children:"Create one"})]}):o.jsx("div",{ref:b,"data-testid":"library-list",className:"flex-1 overflow-hidden px-2",children:o.jsx(wye,{ref:v,data:N,width:"100%",height:y,rowHeight:m?44:Lgt,indent:16,paddingTop:4,paddingBottom:4,initialOpenState:k,selection:t??void 0,onSelect:j,onActivate:E,onToggle:T,onMove:O,disableDrop:R,disableMultiSelection:!0,openByDefault:!1,children:Zxt})})]}),!m&&o.jsxs("div",{"data-testid":"library-count",className:"p-3 border-t border-gray-200 dark:border-[var(--color-border)] text-xs text-gray-500 dark:text-gray-400",children:[e.length," ",e.length===1?"library":"libraries"]})]})})}function e1t({libraryId:e,selectedDocumentId:t,onSelectDocument:r,onSelectLibrary:n,onNewDocument:a,onDeleteLibrary:s,isMobile:i=!1}){const[l,c]=w.useState(""),[u,d]=w.useState(!1),[f,m]=w.useState("updatedAt"),[p,v]=w.useState("desc"),[b,y]=w.useState(Ob),{data:S,isLoading:_}=Mbe(e),{data:N=[],isLoading:k,error:j}=Rgt(e);e1(),w.useEffect(()=>{const P=Mce();m(P.field),v(P.direction)},[]),w.useEffect(()=>{y(Ob),c("")},[e]);const E=P=>{m(P),sN(P,p)},T=P=>{v(P),sN(f,P)},O=()=>{y(Ob)},R=_||k,H=w.useMemo(()=>[...N,...S?._documents||[]].filter((P,I,B)=>I===B.findIndex(F=>F.id===P.id)),[N,S?._documents]),$=w.useMemo(()=>{const P=new Set;return H.forEach(I=>{(I.tags||[]).forEach(B=>P.add(B))}),Array.from(P).sort()},[H]),L=w.useMemo(()=>{const P=Tce(b,l),I=H.filter(P);return Hme(I,{field:f,direction:p})},[H,l,b,f,p]),A=t1(b),M=w.useCallback(P=>o.jsx("div",{className:"px-4",children:o.jsx(Tbe,{document:P,isSelected:t===P.id,onClick:r,libraryId:e,draggable:!0})}),[t,r,e]);return o.jsxs("div",{"data-testid":"library-view",className:"h-full flex flex-col bg-white dark:bg-[var(--color-bg)]",children:[o.jsxs("div",{"data-testid":"library-header",className:`flex-shrink-0 ${i?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:`flex items-center ${i?"gap-2":"gap-3"} min-w-0`,children:[o.jsx(G6,{className:`${i?"w-5 h-5":"w-6 h-6"} text-yellow-500 flex-shrink-0`}),S?o.jsxs(o.Fragment,{children:[o.jsx("h3",{"data-testid":"library-name",className:`font-semibold text-gray-900 dark:text-[var(--color-text)] ${i?"text-base":"text-lg"} truncate`,children:S.name}),o.jsxs("span",{"data-testid":"library-doc-count",className:`text-gray-400 dark:text-gray-500 flex-shrink-0 ${i?"text-xs":"text-sm"}`,children:[L.length," ",L.length===1?"doc":"docs"]})]}):o.jsx("div",{className:"animate-pulse h-6 w-32 bg-gray-200 dark:bg-gray-700 rounded"})]}),!i&&o.jsxs("div",{className:"flex items-center gap-2",children:[s&&o.jsx("button",{onClick:s,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md transition-colors",title:"Delete Library","data-testid":"delete-library-button",children:o.jsx(pr,{className:"w-4 h-4"})}),o.jsxs("button",{onClick:a,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] rounded-md transition-colors","data-testid":"new-document-button-library",children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Document",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:zl("action.createDocument")})]})]})]}),S?.description&&o.jsx("p",{"data-testid":"library-description",className:`mt-2 text-sm text-gray-600 dark:text-gray-400 ${i?"line-clamp-2":""}`,children:S.description}),o.jsxs("div",{className:"mt-3 relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:l,onChange:P=>c(P.target.value),placeholder:"Search documents...",className:`w-full pl-9 pr-4 ${i?"py-3":"py-2"} text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,"data-testid":"library-search-input"})]}),o.jsx("div",{className:"mt-3",children:i?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(iN,{sortField:f,sortDirection:p,onSortFieldChange:E,onSortDirectionChange:T}),o.jsxs("button",{onClick:()=>d(!0),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${nh(b)?"text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/50":"text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800"}`,"data-testid":"mobile-filter-button",children:[o.jsx(ru,{className:"w-4 h-4"}),"Filters",A>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-semibold bg-blue-600 text-white rounded-full",children:A})]})]}):o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(iN,{sortField:f,sortDirection:p,onSortFieldChange:E,onSortDirectionChange:T}),o.jsx("div",{className:"flex-1",children:o.jsx(Ace,{filters:b,onFilterChange:y,onClearFilters:O,availableTags:$})})]})})]}),S?._subLibraries&&S._subLibraries.length>0&&o.jsxs("div",{"data-testid":"sub-libraries",className:`flex-shrink-0 ${i?"p-3":"p-4"} border-b border-gray-100 dark:border-gray-800`,children:[o.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Sub-libraries"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:S._subLibraries.map(P=>o.jsxs("button",{"data-testid":`sub-library-${P.id}`,onClick:()=>n(P.id),className:`flex items-center gap-1.5 ${i?"px-2.5 py-2":"px-3 py-1.5"} bg-yellow-50 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded-md text-sm hover:bg-yellow-100 dark:hover:bg-yellow-900/50 transition-colors cursor-pointer ${i?"touch-target":""}`,children:[o.jsx(a0,{className:"w-4 h-4"}),P.name]},P.id))})]}),o.jsx("div",{"data-testid":"documents-container",className:"flex-1 min-h-0",children:R?o.jsx("div",{"data-testid":"documents-loading",className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:"Loading documents..."}):j?o.jsx("div",{"data-testid":"documents-error",className:"flex items-center justify-center h-full text-red-500 dark:text-red-400",children:"Failed to load documents"}):L.length===0?o.jsxs("div",{"data-testid":"documents-empty",className:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400 px-4",children:[o.jsx(rn,{className:"w-12 h-12 mb-3 text-gray-300 dark:text-gray-600"}),o.jsx("p",{className:"text-sm",children:l||nh(b)?"No documents match your search or filters":"No documents in this library"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:l||nh(b)?"Try adjusting your search or filters":"Add documents to organize your knowledge"})]}):o.jsx(T1,{items:L,getItemKey:P=>P.id,estimateSize:i?72:Ebe,renderItem:M,overscan:5,className:"h-full pt-2",scrollRestoreId:`library-documents-${e}`,testId:"virtualized-documents-list",gap:i?4:8})}),i&&o.jsx(Dce,{open:u,onClose:()=>d(!1),filters:b,onFilterChange:y,onClearFilters:O,availableTags:$})]})}function t1t({selectedDocumentId:e,onSelectDocument:t,onNewDocument:r,isMobile:n=!1}){const[a,s]=w.useState(""),[i,l]=w.useState(!1),[c,u]=w.useState("updatedAt"),[d,f]=w.useState("desc"),[m,p]=w.useState(Ob);e1(),w.useEffect(()=>{const R=Mce();u(R.field),f(R.direction)},[]);const v=R=>{u(R),sN(R,d)},b=R=>{f(R),sN(c,R)},y=()=>{p(Ob)},{data:S,isLoading:_}=IB(),N=w.useMemo(()=>{if(!S)return[];const R=S,H=new Set;return R.forEach($=>{($.tags||[]).forEach(L=>H.add(L))}),Array.from(H).sort()},[S]),k=w.useMemo(()=>{if(!S)return[];const R=S,H=Tce(m,a),$=R.filter(H);return Hme($,{field:c,direction:d})},[S,a,m,c,d]),j=k.length,E=_,T=t1(m),O=w.useCallback(R=>o.jsx("div",{className:`${n?"px-3":"px-4"}`,children:o.jsx(Tbe,{document:R,isSelected:e===R.id,onClick:t,libraryId:null,draggable:!0})}),[e,t,n]);return o.jsxs("div",{"data-testid":"all-documents-view",className:"h-full flex flex-col bg-white dark:bg-[var(--color-bg)]",children:[o.jsxs("div",{"data-testid":"all-documents-header",className:`flex-shrink-0 ${n?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:`flex items-center ${n?"gap-2":"gap-3"} min-w-0`,children:[o.jsx(rn,{className:`${n?"w-5 h-5":"w-6 h-6"} text-blue-400 flex-shrink-0`}),o.jsx("h3",{className:`font-semibold text-gray-900 dark:text-[var(--color-text)] ${n?"text-base":"text-lg"}`,children:"All Documents"}),o.jsxs("span",{className:`text-gray-500 dark:text-gray-400 ${n?"text-xs":"text-sm"}`,"data-testid":"all-documents-count",children:[j," ",j===1?"doc":"docs"]})]}),!n&&o.jsxs("button",{onClick:r,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white bg-[var(--color-primary)] hover:bg-[var(--color-primary-hover)] rounded-md transition-colors","data-testid":"new-document-button-all",children:[o.jsx(dr,{className:"w-4 h-4"}),"Create Document",o.jsx("kbd",{className:"ml-1 text-xs bg-[var(--color-primary-700)]/50 text-white px-1 py-0.5 rounded",children:zl("action.createDocument")})]})]}),o.jsxs("div",{className:"mt-3 relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:a,onChange:R=>s(R.target.value),placeholder:"Search documents...",className:`w-full pl-9 pr-4 ${n?"py-3":"py-2"} text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,"data-testid":"documents-search-input"})]}),o.jsx("div",{className:"mt-3",children:n?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(iN,{sortField:c,sortDirection:d,onSortFieldChange:v,onSortDirectionChange:b}),o.jsxs("button",{onClick:()=>l(!0),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-sm font-medium rounded-md transition-colors ${nh(m)?"text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/50":"text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800"}`,"data-testid":"mobile-filter-button",children:[o.jsx(ru,{className:"w-4 h-4"}),"Filters",T>0&&o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-semibold bg-blue-600 text-white rounded-full",children:T})]})]}):o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(iN,{sortField:c,sortDirection:d,onSortFieldChange:v,onSortDirectionChange:b}),o.jsx("div",{className:"flex-1",children:o.jsx(Ace,{filters:m,onFilterChange:p,onClearFilters:y,availableTags:N})})]})})]}),o.jsx("div",{"data-testid":"all-documents-container",className:"flex-1 min-h-0",children:E?o.jsx("div",{"data-testid":"all-documents-loading",className:"flex items-center justify-center h-full text-gray-500 dark:text-gray-400",children:"Loading documents..."}):k.length===0?o.jsxs("div",{"data-testid":"all-documents-empty",className:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400 px-4",children:[o.jsx(rn,{className:"w-12 h-12 mb-3 text-gray-300 dark:text-gray-600"}),o.jsx("p",{className:"text-sm text-center",children:a||nh(m)?"No documents match your search or filters":"No documents yet"}),o.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 text-center",children:a||nh(m)?"Try adjusting your search or filters":"Create documents to build your knowledge base"})]}):o.jsx(T1,{items:k,getItemKey:R=>R.id,estimateSize:n?72:Ebe,renderItem:O,overscan:5,className:"h-full pt-2",scrollRestoreId:"all-documents-scroll",testId:"virtualized-all-documents-list",gap:n?4:8})}),n&&o.jsx(Dce,{open:i,onClose:()=>l(!1),filters:m,onFilterChange:p,onClearFilters:y,availableTags:N})]})}function gO({documentId:e,onClose:t,isExpanded:r=!1,onToggleExpand:n,isFullscreen:a=!1,onEnterFullscreen:s,onExitFullscreen:i,onDocumentCloned:l,libraryId:c,onNavigateToDocument:u,isMobile:d=!1}){const{data:f,isLoading:m,isError:p,error:v}=Pgt(e),b=zgt(),y=Ugt(),[S,_]=w.useState(!1),[N,k]=w.useState(""),[j,E]=w.useState(""),[T,O]=w.useState(!1),[R,H]=w.useState(null),{data:$}=$gt(R?e:null,R),L=()=>{f&&(k(f.content||""),E(f.title||""),_(!0))},A=()=>{_(!1),k(""),E("")},M=async()=>{if(!f)return;const F={};if(j!==(f.title||"")&&(F.title=j),N!==(f.content||"")&&(F.content=N),Object.keys(F).length>0)try{await b.mutateAsync({id:e,updates:F}),_(!1)}catch{}else _(!1)},P=async()=>{if(f)try{const F=await y.mutateAsync({id:e,createdBy:f.createdBy,libraryId:c||void 0});F?.id&&l&&l({id:F.id})}catch{}};if(m)return o.jsx("div",{"data-testid":"document-detail-loading",className:"h-full flex items-center justify-center bg-white dark:bg-[var(--color-bg)]",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading document..."})});if(p)return o.jsxs("div",{"data-testid":"document-detail-error",className:"h-full flex flex-col items-center justify-center bg-white dark:bg-[var(--color-bg)] px-4",children:[o.jsx("div",{className:"text-red-600 dark:text-red-400 mb-2",children:"Failed to load document"}),o.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:v?.message})]});if(!f)return o.jsx("div",{"data-testid":"document-detail-not-found",className:"h-full flex items-center justify-center bg-white dark:bg-[var(--color-bg)]",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Document not found"})});const I=f.title||`Document ${f.id}`,B=mre[f.contentType]||mre.text;return o.jsxs("div",{"data-testid":"document-detail-panel",className:`h-full flex flex-col bg-white dark:bg-[var(--color-bg)] ${d?"":"border-l border-gray-200 dark:border-[var(--color-border)]"}`,children:[o.jsxs("div",{className:`flex items-start justify-between ${d?"p-3":"p-4"} border-b border-gray-200 dark:border-[var(--color-border)]`,children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxs("span",{"data-testid":"document-detail-type",className:`inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded ${B.color}`,children:[B.icon,B.label]}),f.version!==void 0&&o.jsxs("span",{"data-testid":"document-detail-version",className:"text-xs text-gray-500",children:["v",f.version]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[f.metadata?.icon&&o.jsx("span",{className:"text-2xl","data-testid":"document-detail-icon",children:f.metadata.icon}),S?o.jsx("input",{type:"text",value:j,onChange:F=>E(F.target.value),"data-testid":"document-title-input",className:"text-lg font-semibold text-gray-900 flex-1 border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Document title"}):o.jsx("h2",{"data-testid":"document-detail-title",className:"text-lg font-semibold text-gray-900 truncate",children:I})]}),o.jsx("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 font-mono",children:o.jsx("span",{"data-testid":"document-detail-id",children:f.id})}),o.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-xs text-gray-500",children:[o.jsxs("div",{className:"flex items-center gap-1",title:p5(R!==null&&$?$.createdAt:f.createdAt),children:[o.jsx(Rr,{className:"w-3 h-3"}),o.jsxs("span",{children:["Created ",g5(R!==null&&$?$.createdAt:f.createdAt)]})]}),o.jsxs("div",{className:"flex items-center gap-1",title:p5(R!==null&&$?$.updatedAt:f.updatedAt),children:[o.jsx(Rr,{className:"w-3 h-3"}),o.jsxs("span",{children:["Updated ",g5(R!==null&&$?$.updatedAt:f.updatedAt)]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(tn,{className:"w-3 h-3"}),o.jsx("span",{className:"font-mono",children:f.createdBy})]})]})]}),o.jsxs("div",{className:`flex items-center ${d?"gap-0.5":"gap-1"} ml-2`,children:[S?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:M,disabled:b.isPending,"data-testid":"document-save-button",className:`${d?"p-2 touch-target":"p-1.5"} text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-900/30 rounded disabled:opacity-50`,"aria-label":"Save changes",title:"Save (Cmd+S)",children:o.jsx($x,{className:"w-5 h-5"})}),o.jsx("button",{onClick:A,disabled:b.isPending,"data-testid":"document-cancel-button",className:`${d?"p-2 touch-target":"p-1.5"} text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/30 rounded disabled:opacity-50`,"aria-label":"Cancel editing",children:o.jsx(us,{className:"w-5 h-5"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:L,disabled:R!==null,"data-testid":"document-edit-button",className:`${d?"p-2 touch-target":"p-1.5"} text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded disabled:opacity-50 disabled:cursor-not-allowed`,"aria-label":"Edit document",title:R!==null?"Exit preview to edit":"Edit document",children:o.jsx(OO,{className:"w-5 h-5"})}),!d&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:P,disabled:y.isPending||R!==null,"data-testid":"document-clone-button",className:"p-1.5 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Clone document",title:R!==null?"Exit preview to clone":"Clone document",children:o.jsx(rj,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>O(!T),"data-testid":"document-history-button",className:`p-1.5 rounded ${T?"text-blue-600 bg-blue-50 dark:bg-blue-900/30":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,"aria-label":T?"Hide version history":"Show version history",title:"Version history",children:o.jsx(eh,{className:"w-5 h-5"})})]})]}),!d&&n&&!a&&o.jsx("button",{onClick:n,"data-testid":"document-expand-button",className:`p-1.5 rounded ${r?"text-blue-600 bg-blue-50 dark:bg-blue-900/30":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,"aria-label":r?"Collapse document":"Expand document",title:r?"Show document list":"Hide document list",children:r?o.jsx($6,{className:"w-5 h-5"}):o.jsx(ej,{className:"w-5 h-5"})}),!d&&a?o.jsx("button",{onClick:i,"data-testid":"document-fullscreen-button",className:"p-1.5 rounded text-blue-600 bg-blue-50 dark:bg-blue-900/30","aria-label":"Exit fullscreen",title:"Exit fullscreen (Escape)",children:o.jsx(Kwe,{className:"w-5 h-5"})}):!d&&s&&o.jsx("button",{onClick:s,"data-testid":"document-fullscreen-button",className:"p-1.5 rounded text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800","aria-label":"Enter fullscreen",title:"Focus mode (fullscreen)",children:o.jsx(Gwe,{className:"w-5 h-5"})}),!d&&o.jsx("button",{onClick:a?i:t,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded","aria-label":a?"Exit fullscreen":"Close panel","data-testid":"document-detail-close",children:o.jsx(yt,{className:"w-5 h-5"})})]})]}),b.isError&&o.jsx("div",{"data-testid":"document-update-error",className:`${d?"mx-3":"mx-4"} mt-2 p-2 bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300 text-sm rounded`,children:b.error?.message||"Failed to save document"}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:`flex-1 overflow-y-auto ${d?"p-3":"p-4"}`,children:[R!==null&&$&&o.jsxs("div",{"data-testid":"document-preview-banner",className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(du,{className:"w-4 h-4 text-blue-600"}),o.jsxs("span",{className:"text-sm text-blue-800",children:["Previewing version ",R]})]}),o.jsx("button",{onClick:()=>H(null),"data-testid":"exit-preview-button",className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Exit Preview"})]}),o.jsx("div",{"data-testid":"document-content",className:"mb-6",children:S?o.jsx("textarea",{value:N,onChange:F=>k(F.target.value),"data-testid":"document-content-textarea",className:"w-full min-h-[300px] p-3 border border-gray-300 rounded-lg font-mono text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter document content..."}):o.jsx(e0t,{content:R!==null&&$?$.content||"":f.content||"",contentType:R!==null&&$?$.contentType:f.contentType})}),!R&&o.jsx("div",{className:"mb-6",children:o.jsx(oze,{tags:f.tags||[],onTagsChange:async F=>{try{await b.mutateAsync({id:e,updates:{tags:F}})}catch{}},disabled:b.isPending})}),!R&&u&&o.jsx(n0t,{documentId:e,onNavigateToDocument:u})]}),T&&o.jsx(t0t,{documentId:e,currentVersion:f.version||1,onPreviewVersion:H,previewingVersion:R,onClose:()=>{O(!1),H(null)}})]})]})}function dne({isOpen:e,documentName:t,libraryName:r,isLoading:n=!1,onConfirm:a,onCancel:s}){return o.jsx(Mse,{open:e,onOpenChange:i=>!i&&s(),children:o.jsxs(V6,{children:[o.jsx(nj,{className:"fixed inset-0 bg-black/40 z-50"}),o.jsxs(aj,{"data-testid":"move-to-top-level-dialog",className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 w-full max-w-md p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center",children:o.jsx(Bn,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-500"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx(sj,{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Move to All Documents?"}),o.jsxs(Q6,{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:[o.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:['"',t,'"']})," ","will be removed from"," ",o.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:['"',r,'"']})," ","and moved to the top-level documents list."]})]}),o.jsx(Y6,{asChild:!0,children:o.jsx("button",{className:"flex-shrink-0 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"Close",children:o.jsx(yt,{className:"w-5 h-5"})})})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:s,disabled:n,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors disabled:opacity-50","data-testid":"cancel-move-button",children:"Cancel"}),o.jsx("button",{onClick:a,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50 flex items-center gap-2","data-testid":"confirm-move-button",children:n?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Moving..."]}):"Move to All Documents"})]})]})]})})}function r1t(){const e=Ma(),t=tl({from:"/documents"}),r=jo();e1();const n=ft(),{data:a=[],isLoading:s,error:i}=Igt(),[l,c]=w.useState(t.library??null),[u,d]=w.useState(t.selected??null),[f,m]=w.useState(!1),[p,v]=w.useState(!1),[b,y]=w.useState(!1),[S,_]=w.useState(null),[N,k]=w.useState(null),{data:j}=Mbe(S||""),E=j?._documents?.length||0,T=kt({mutationFn:async({libraryId:Qe,cascade:Vt})=>{const at=await fetch(`/api/libraries/${Qe}?cascade=${Vt}`,{method:"DELETE"});if(!at.ok){const Ne=await at.json();throw new Error(Ne.error?.message||"Failed to delete library")}return at.json()},onSuccess:()=>{n.invalidateQueries({queryKey:["libraries"]}),n.invalidateQueries({queryKey:["documents"]}),y(!1),S===l&&c(null),_(null),k(null),Gr.success("Library deleted successfully")},onError:Qe=>{k(Qe.message),Gr.error(Qe.message||"Failed to delete library")}}),[O,R]=w.useState(!1),[H,$]=w.useState(!1),[L,A]=w.useState(!1),[M,P]=w.useState(new Set),[I,B]=w.useState(null),[F,q]=w.useState(null),Q=Ggt(),W=Vgt(),G=Ygt(),J=Qgt(),X=FB(fx(k1,{activationConstraint:{distance:8}}));w.useEffect(()=>{H||(localStorage.getItem("document.expanded")==="true"&&R(!0),$(!0))},[H]);const V=Qe=>{R(Vt=>{const at=typeof Qe=="function"?Qe(Vt):Qe;return localStorage.setItem("document.expanded",at.toString()),at})};w.useEffect(()=>{const Qe=Vt=>{Vt.key==="Escape"&&L&&A(!1)};return document.addEventListener("keydown",Qe),()=>document.removeEventListener("keydown",Qe)},[L]);const{data:se}=IB(),de=VZe({data:se,selectedId:t.selected,currentPage:1,pageSize:1e3,getId:Qe=>Qe.id,routePath:"/documents",rowTestIdPrefix:"document-item-",autoNavigate:!1,highlightDelay:200});w.useEffect(()=>{t.selected&&t.selected!==u&&d(t.selected),!t.selected&&u&&d(null),t.library&&t.library!==l&&c(t.library),!t.library&&l&&c(null)},[t.selected,t.library]);const he=Qe=>{P(Vt=>{const at=new Set(Vt);return at.has(Qe)?at.delete(Qe):at.add(Qe),at})},te=Qe=>{const Vt=a.find(Fe=>Fe.id===Qe);if(!Vt)return;const at=[];let Ne=Vt;for(;Ne.parentId;){at.push(Ne.parentId);const Fe=a.find(Ke=>Ke.id===Ne.parentId);if(!Fe)break;Ne=Fe}at.length>0&&P(Fe=>{const Ke=new Set(Fe);for(const Tt of at)Ke.add(Tt);return Ke})},le=Qe=>{c(Qe),d(null),V(!1),Qe&&te(Qe)},oe=Qe=>{d(Qe),e({to:"/documents",search:{selected:Qe,library:l??void 0}})},Z=()=>{d(null),e({to:"/documents",search:{selected:void 0,library:l??void 0}})},ve=()=>{m(!0)},U=()=>{m(!1)},ge=()=>{v(!0)},ue=()=>{v(!1)},re=Qe=>{c(Qe.id)},ne=Qe=>{d(Qe.id)},me=()=>{d(null),e({to:"/documents",search:{selected:void 0,library:l??void 0}})},ke=Qe=>{k(null),_(Qe||l),y(!0)},we=()=>{y(!1),_(null),k(null)},pe=async Qe=>{S&&await T.mutateAsync({libraryId:S,cascade:Qe})},Oe=w.useCallback(async(Qe,Vt,at)=>{try{await G.mutateAsync({libraryId:Qe,parentId:Vt,index:at}),Gr.success("Library moved successfully")}catch(Ne){Gr.error(Ne.message||"Failed to move library")}},[G]),Ae=w.useCallback(async(Qe,Vt)=>{try{await J.mutateAsync({libraryId:Qe,index:Vt})}catch(at){Gr.error(at.message||"Failed to reorder library")}},[J]),Re=w.useCallback(Qe=>{const Vt=Qe.active.data.current;Vt&&B(Vt)},[]),Ve=w.useCallback(Qe=>{},[]),gt=w.useCallback(async Qe=>{const{active:Vt,over:at}=Qe;if(B(null),!at)return;const Ne=Vt.data.current;if(!Ne||Ne.type!=="document")return;const Fe=at.data.current;if(!Fe)return;const Ke=Ne.id,Tt=Ne.sourceLibraryId;if(Fe.type==="library"&&Fe.id){const wt=Fe.id;if(Tt===wt)return;try{await Q.mutateAsync({documentId:Ke,libraryId:wt}),Gr.success(`Moved "${Ne.name}" to "${Fe.name}"`)}catch(Zt){Gr.error(Zt.message||"Failed to move document")}}if(Fe.type==="all-documents"){if(!Tt){Gr.info("Document is already at top-level");return}const wt=a.find(Zt=>Zt.id===Tt);q({documentId:Ke,documentName:Ne.name,libraryName:wt?.name||"Unknown Library"})}},[Q,a]),lt=w.useCallback(async()=>{if(F)try{await W.mutateAsync({documentId:F.documentId}),Gr.success(`"${F.documentName}" moved to All Documents`)}catch(Qe){Gr.error(Qe.message||"Failed to move document")}finally{q(null)}},[F,W]),Pt=w.useCallback(()=>{q(null)},[]);if(i)return o.jsx("div",{"data-testid":"documents-page-error",className:"flex items-center justify-center h-full px-4",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-red-500 mb-2",children:"Failed to load libraries"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.message})]})});const fr=(Qe=!1)=>l?o.jsx(e1t,{libraryId:l,selectedDocumentId:u,onSelectDocument:oe,onSelectLibrary:le,onNewDocument:ve,onDeleteLibrary:ke,isMobile:Qe}):o.jsx(t1t,{selectedDocumentId:u,onSelectDocument:oe,onNewDocument:ve,isMobile:Qe});return r?o.jsxs(vC,{sensors:X,onDragStart:Re,onDragOver:Ve,onDragEnd:gt,children:[o.jsxs("div",{"data-testid":"documents-page",className:"flex flex-col h-full relative",children:[!u&&o.jsxs(o.Fragment,{children:[s?o.jsx("div",{"data-testid":"libraries-loading",className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading..."})}):o.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:fr(!0)}),o.jsx("button",{onClick:ve,className:"fixed bottom-20 right-4 w-14 h-14 bg-blue-500 hover:bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center transition-colors z-30 touch-target","data-testid":"mobile-create-document-fab","aria-label":"Create new document",children:o.jsx(dr,{className:"w-6 h-6"})})]}),u&&o.jsx(Cgt,{open:!0,onClose:me,title:"Document","data-testid":"mobile-document-sheet",children:de.notFound?o.jsx(dre,{elementType:"Document",elementId:u,backRoute:"/documents",backLabel:"Back to Documents",onDismiss:me}):o.jsx("div",{className:"h-full",children:o.jsx(gO,{documentId:u,onClose:me,isExpanded:!0,isFullscreen:!1,onDocumentCloned:ne,libraryId:l,onNavigateToDocument:oe,isMobile:!0})})}),o.jsx(fre,{isOpen:f,onClose:U,onSuccess:ne,defaultLibraryId:l||void 0,isMobile:!0}),o.jsx(hre,{isOpen:p,onClose:ue,onSuccess:re,defaultParentId:l||void 0}),o.jsx(dne,{isOpen:!!F,documentName:F?.documentName||"",libraryName:F?.libraryName||"",isLoading:W.isPending,onConfirm:lt,onCancel:Pt}),o.jsx(rQ,{isOpen:b,onClose:we,onConfirm:pe,library:S&&j?{id:S,name:j.name}:null,documentCount:E,isDeleting:T.isPending,error:N,isMobile:!0})]}),o.jsx(bC,{children:I&&o.jsx(gre,{data:I})})]}):o.jsxs(vC,{sensors:X,onDragStart:Re,onDragOver:Ve,onDragEnd:gt,children:[o.jsxs("div",{"data-testid":"documents-page",className:"flex h-full @container/docs",children:[L&&u&&o.jsx("div",{"data-testid":"document-fullscreen-panel",className:"fixed inset-0 z-50 bg-white dark:bg-gray-900 flex flex-col",children:o.jsx(gO,{documentId:u,onClose:()=>A(!1),isExpanded:!0,onToggleExpand:()=>A(!1),isFullscreen:!0,onExitFullscreen:()=>A(!1),onDocumentCloned:ne,libraryId:l,onNavigateToDocument:oe})}),!L&&o.jsx(o.Fragment,{children:s?o.jsx("div",{"data-testid":"libraries-loading",className:"w-48 @3xl/docs:w-64 shrink-0 border-r border-gray-200 dark:border-[var(--color-border)] flex items-center justify-center",children:o.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading libraries..."})}):o.jsx("div",{"data-testid":"library-tree-sidebar",className:"shrink-0",children:o.jsx(Xxt,{libraries:a,selectedLibraryId:l,expandedIds:M,onSelectLibrary:le,onToggleExpand:he,onNewDocument:ve,onNewLibrary:ge,onSelectDocument:oe,onMoveLibrary:Oe,onReorderLibrary:Ae,onDeleteLibrary:ke,activeDragData:I,compact:!0})})}),!L&&o.jsxs("div",{className:"flex-1 min-w-0 flex overflow-hidden",children:[(!u||!O)&&o.jsx("div",{className:`${u?"flex-1 min-w-0 border-r border-gray-200 dark:border-[var(--color-border)]":"flex-1 min-w-0"} h-full overflow-hidden`,children:fr()}),u&&o.jsx("div",{className:"flex-1 min-w-0 flex-shrink-0 overflow-hidden",children:de.notFound?o.jsx(dre,{elementType:"Document",elementId:u,backRoute:"/documents",backLabel:"Back to Documents",onDismiss:Z}):o.jsx(gO,{documentId:u,onClose:Z,isExpanded:O,onToggleExpand:()=>V(!O),isFullscreen:!1,onEnterFullscreen:()=>A(!0),onDocumentCloned:ne,libraryId:l,onNavigateToDocument:oe})})]}),o.jsx(fre,{isOpen:f,onClose:U,onSuccess:ne,defaultLibraryId:l||void 0}),o.jsx(hre,{isOpen:p,onClose:ue,onSuccess:re,defaultParentId:l||void 0}),o.jsx(dne,{isOpen:!!F,documentName:F?.documentName||"",libraryName:F?.libraryName||"",isLoading:W.isPending,onConfirm:lt,onCancel:Pt}),o.jsx(rQ,{isOpen:b,onClose:we,onConfirm:pe,library:S&&j?{id:S,name:j.name}:null,documentCount:E,isDeleting:T.isPending,error:N,isMobile:r})]}),o.jsx(bC,{children:I&&o.jsx(gre,{data:I})})]})}function _ye({task:e,onDeleted:t}){const[r,n]=w.useState(!1),[a,s]=w.useState(!1),[i,l]=w.useState(!1),c=w.useRef(null),u=w.useRef(void 0),d=eZe(),f=tZe(),m=e.metadata?.orchestrator?.mergeStatus;w.useEffect(()=>{const N=k=>{c.current&&!c.current.contains(k.target)&&(n(!1),s(!1))};if(r)return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[r]),w.useEffect(()=>{const N=k=>{k.key==="Escape"&&(n(!1),s(!1),l(!1))};return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},[]),w.useEffect(()=>()=>{u.current&&clearTimeout(u.current)},[]);const p=()=>{clearTimeout(u.current),s(!0)},v=()=>{u.current=setTimeout(()=>s(!1),150)},b=async N=>{try{await d.mutateAsync({taskId:e.id,mergeStatus:N}),n(!1),s(!1)}catch(k){console.error("Failed to update merge status:",k)}},y=async()=>{try{await f.mutateAsync({taskId:e.id,reason:"Deleted via merge request page"}),l(!1),n(!1),t?.()}catch(N){console.error("Failed to delete merge request:",N)}},S=N=>{switch(N){case"pending":return o.jsx(Rr,{className:"w-4 h-4 text-amber-500"});case"testing":return o.jsx(U6,{className:"w-4 h-4 text-blue-500"});case"merging":return o.jsx(Ps,{className:"w-4 h-4 text-blue-600"});case"merged":return o.jsx(Yn,{className:"w-4 h-4 text-green-500"});case"conflict":return o.jsx(Bn,{className:"w-4 h-4 text-red-500"});case"test_failed":return o.jsx(us,{className:"w-4 h-4 text-orange-500"});case"failed":return o.jsx(us,{className:"w-4 h-4 text-red-500"});case"not_applicable":return o.jsx(VC,{className:"w-4 h-4 text-gray-500"});default:return o.jsx(Rr,{className:"w-4 h-4 text-gray-400"})}},_=rZe();return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",ref:c,children:[o.jsx("button",{onClick:N=>{N.stopPropagation(),n(!r)},className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Manage merge request","data-testid":"merge-request-manage-btn",children:o.jsx(n0,{className:"w-4 h-4"})}),r&&o.jsxs("div",{className:"absolute right-0 top-full mt-1 w-48 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg z-50 py-1","data-testid":"merge-request-manage-menu",children:[o.jsxs("div",{className:"relative",onMouseEnter:p,onMouseLeave:v,children:[o.jsxs("button",{className:"w-full flex items-center justify-between gap-2 px-3 py-2 text-sm text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] transition-colors",onClick:N=>{N.stopPropagation(),s(!a)},"data-testid":"change-status-btn",children:[o.jsx("span",{children:"Change Status"}),o.jsx(gn,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"})]}),a&&o.jsx("div",{className:"absolute left-full top-0 ml-1 w-48 bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg shadow-lg py-1","data-testid":"status-submenu",onMouseEnter:p,onMouseLeave:v,children:_.map(N=>o.jsxs("button",{onClick:k=>{k.stopPropagation(),b(N.value)},disabled:m===N.value||d.isPending,className:`w-full flex items-center gap-2 px-3 py-2 text-sm transition-colors ${m===N.value?"bg-[var(--color-primary-muted)] text-[var(--color-primary)]":"text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"} disabled:opacity-50`,"data-testid":`status-option-${N.value}`,children:[d.isPending&&d.variables?.mergeStatus===N.value?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):S(N.value),o.jsx("span",{children:N.label}),m===N.value&&o.jsx(Yn,{className:"w-3.5 h-3.5 ml-auto text-[var(--color-primary)]"})]},N.value))})]}),o.jsx("div",{className:"my-1 border-t border-[var(--color-border)]"}),o.jsxs("button",{onClick:N=>{N.stopPropagation(),l(!0),n(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-[var(--color-danger)] hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors","data-testid":"delete-merge-request-btn",children:[o.jsx(pr,{className:"w-4 h-4"}),o.jsx("span",{children:"Delete"})]})]})]}),i&&o.jsx(n1t,{task:e,isDeleting:f.isPending,onConfirm:y,onCancel:()=>l(!1)})]})}function n1t({task:e,isDeleting:t,onConfirm:r,onCancel:n}){return w.useEffect(()=>{const a=s=>{s.key==="Escape"&&!t&&n()};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[t,n]),o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"delete-merge-request-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!t&&n()}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-[var(--color-danger-muted)] flex items-center justify-center",children:o.jsx(pr,{className:"w-5 h-5 text-[var(--color-danger)]"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Delete Merge Request"}),o.jsxs("p",{className:"mt-2 text-sm text-[var(--color-text-secondary)]",children:["Are you sure you want to delete the merge request for"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',e.title,'"']}),"? This action cannot be undone."]})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{onClick:n,disabled:t,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)] disabled:opacity-50","data-testid":"delete-merge-request-cancel-btn",children:"Cancel"}),o.jsx("button",{onClick:r,disabled:t,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[var(--color-danger)] rounded-md hover:opacity-90 disabled:opacity-50","data-testid":"delete-merge-request-confirm-btn",children:t?o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):o.jsxs(o.Fragment,{children:[o.jsx(pr,{className:"w-4 h-4"}),"Delete"]})})]})]})]})}function a1t({task:e,assigneeName:t,onClick:r,isSelected:n,onDeleted:a}){const s=e.metadata?.orchestrator,i=s?.mergeStatus,l=s?.lastTestResult,c=s?.branch,u=i?Rme(i):null;return o.jsxs("div",{className:`
        relative flex flex-col p-4 border rounded-lg cursor-pointer
        transition-all duration-150 ease-out
        ${n?"bg-[var(--color-primary-muted)] border-[var(--color-primary)]":"bg-[var(--color-surface)] border-[var(--color-border)] hover:bg-[var(--color-surface-hover)] hover:border-[var(--color-border-hover)]"}
      `,onClick:r,"data-testid":`merge-request-card-${e.id}`,children:[u&&o.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 rounded-l-lg ${u.border.replace("border-","bg-")}`}),o.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[i&&o.jsx(Qp,{status:i}),o.jsx("h3",{className:"text-sm font-medium text-[var(--color-text)] truncate",title:e.title,children:e.title})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)] whitespace-nowrap",children:s1t(e.updatedAt)}),o.jsx(_ye,{task:e,onDeleted:a})]})]}),o.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs text-[var(--color-text-secondary)]",children:[c&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(cu,{className:"w-3.5 h-3.5 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"font-mono truncate max-w-[200px]",title:c,children:c}),c!=="main"&&c!=="master"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsx("span",{className:"font-mono",children:"main"})]})]}),s?.mergeRequestUrl&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsxs("a",{href:s.mergeRequestUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-[var(--color-primary)] hover:underline",onClick:d=>d.stopPropagation(),children:[o.jsx(wl,{className:"w-3 h-3"}),o.jsx("span",{children:"View MR"})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--color-text-secondary)]",children:[o.jsx(Vr,{className:"w-3.5 h-3.5 text-purple-500"}),o.jsx("span",{children:t||e.assignee||"Unassigned"})]}),l&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[l.passed?o.jsx(Yn,{className:"w-3.5 h-3.5 text-green-500"}):o.jsx(us,{className:"w-3.5 h-3.5 text-red-500"}),o.jsx("span",{className:l.passed?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:l.totalTests!==void 0?o.jsxs(o.Fragment,{children:[l.passedTests??0,"/",l.totalTests," tests passed"]}):l.passed?"Tests passed":"Tests failed"})]}),!l&&i==="pending"&&o.jsxs("div",{className:"flex items-center gap-1.5 text-[var(--color-text-tertiary)]",children:[o.jsx(Rr,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Awaiting review"})]}),i==="testing"&&o.jsxs("div",{className:"flex items-center gap-1.5 text-blue-600 dark:text-blue-400",children:[o.jsx("div",{className:"w-3.5 h-3.5 border-2 border-current border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Running tests..."})]}),i==="merging"&&o.jsxs("div",{className:"flex items-center gap-1.5 text-blue-600 dark:text-blue-400",children:[o.jsx("div",{className:"w-3.5 h-3.5 border-2 border-current border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"Merging..."})]})]})]})}function s1t(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}function i1t({result:e,compact:t=!1}){const{passed:r,totalTests:n,passedTests:a,failedTests:s,skippedTests:i,durationMs:l,errorMessage:c}=e,u=n!==void 0,d=u&&n>0?Math.round((a??0)/n*100):r?100:0;return t?o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r?o.jsx(Yn,{className:"w-4 h-4 text-green-500"}):o.jsx(us,{className:"w-4 h-4 text-red-500"}),o.jsx("span",{className:r?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:u?`${a??0}/${n} passed`:r?"Passed":"Failed"})]}):o.jsxs("div",{className:"space-y-3","data-testid":"test-results-display",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"flex items-center gap-2",children:r?o.jsxs("div",{className:"flex items-center gap-2 text-green-600 dark:text-green-400",children:[o.jsx(Yn,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:"Tests Passed"})]}):o.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400",children:[o.jsx(us,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:"Tests Failed"})]})}),l!==void 0&&o.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-[var(--color-text-tertiary)]",children:[o.jsx(Rr,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:o1t(l)})]})]}),u&&n>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"h-2 bg-[var(--color-surface-elevated)] rounded-full overflow-hidden",children:o.jsxs("div",{className:"h-full flex",children:[(a??0)>0&&o.jsx("div",{className:"h-full bg-green-500",style:{width:`${(a??0)/n*100}%`}}),(s??0)>0&&o.jsx("div",{className:"h-full bg-red-500",style:{width:`${(s??0)/n*100}%`}}),(i??0)>0&&o.jsx("div",{className:"h-full bg-yellow-500",style:{width:`${(i??0)/n*100}%`}})]})}),o.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-green-600 dark:text-green-400",children:[o.jsx(Yn,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:[a??0," passed"]})]}),(s??0)>0&&o.jsxs("div",{className:"flex items-center gap-1.5 text-red-600 dark:text-red-400",children:[o.jsx(us,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:[s," failed"]})]}),(i??0)>0&&o.jsxs("div",{className:"flex items-center gap-1.5 text-yellow-600 dark:text-yellow-400",children:[o.jsx(Vwe,{className:"w-3.5 h-3.5"}),o.jsxs("span",{children:[i," skipped"]})]}),o.jsxs("div",{className:"text-[var(--color-text-tertiary)] ml-auto",children:[d,"% pass rate"]})]})]}),c&&o.jsx("div",{className:"mt-3 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Bn,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),o.jsx("pre",{className:"text-xs font-mono text-red-700 dark:text-red-300 whitespace-pre-wrap break-words overflow-x-auto",children:c})]})})]})}function o1t(e){if(e<1e3)return`${e}ms`;if(e<6e4)return`${(e/1e3).toFixed(1)}s`;const t=Math.floor(e/6e4),r=Math.floor(e%6e4/1e3);return`${t}m ${r}s`}function l1t({taskId:e,onClose:t,onBack:r,onDeleted:n}){const{data:a,isLoading:s,error:i}=XJe(e),{data:l}=k2(),c=a?.assignee&&l?l.find(v=>v.id===a.assignee)?.name:void 0;if(s)return o.jsx("div",{className:"h-full flex items-center justify-center bg-[var(--color-surface)]",children:o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-primary)]"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading..."})]})});if(i||!a)return o.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-[var(--color-surface)]",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("span",{className:"text-sm text-[var(--color-text-secondary)]",children:i?.message||"Merge request not found"}),o.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 text-sm text-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] rounded-md",children:"Close"})]});const u=a.metadata?.orchestrator,d=u?.mergeStatus,f=u?.lastTestResult,m=u?.branch,p=d?Rme(d):null;return o.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-surface)]","data-testid":"merge-request-detail-panel",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-[var(--color-border)]",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[r&&o.jsx("button",{onClick:r,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Back to list",children:o.jsx(Fx,{className:"w-5 h-5"})}),o.jsx("h2",{className:"text-lg font-semibold text-[var(--color-text)]",children:"Merge Request"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[a&&o.jsx(_ye,{task:a,onDeleted:()=>{n?.(),t()}}),o.jsx("button",{onClick:t,className:"p-1.5 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded transition-colors","aria-label":"Close panel",children:o.jsx(yt,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"flex items-center gap-3 mb-2",children:d&&o.jsx("div",{className:`px-3 py-1.5 rounded-md ${p?.bg} ${p?.text}`,children:o.jsx(Qp,{status:d})})}),o.jsx("h3",{className:"text-xl font-semibold text-[var(--color-text)] mb-1",children:a.title}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)] font-mono",children:a.id})]}),o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsxs("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3 flex items-center gap-2",children:[o.jsx(tu,{className:"w-3.5 h-3.5"}),"Task"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Title"}),o.jsx("p",{className:"text-sm font-medium text-[var(--color-text)] mt-0.5",children:a.title})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Status"}),o.jsx("div",{className:"mt-0.5",children:o.jsx(Vp,{status:a.status})})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Priority"}),o.jsx("div",{className:"mt-0.5",children:o.jsx(Yp,{priority:a.priority})})]})]}),a.description&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Description"}),o.jsx("p",{className:"text-sm text-[var(--color-text)] mt-0.5 whitespace-pre-wrap line-clamp-4",children:a.description})]})]})]}),o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Git Info"}),o.jsxs("div",{className:"space-y-3",children:[m&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(cu,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("code",{className:"font-mono text-[var(--color-text)]",children:m}),o.jsx("span",{className:"text-[var(--color-text-tertiary)]",children:""}),o.jsx("code",{className:"font-mono text-[var(--color-text)]",children:"main"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Vr,{className:"w-4 h-4 text-purple-500"}),o.jsx("span",{className:"text-[var(--color-text)]",children:c||a.assignee||"Unassigned"})]}),u?.mergeRequestUrl&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Ps,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("a",{href:u.mergeRequestUrl,target:"_blank",rel:"noopener noreferrer",className:"text-[var(--color-primary)] hover:underline truncate",children:u.mergeRequestUrl})]}),u?.sessionId&&o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Bi,{className:"w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("span",{className:"text-[var(--color-text-secondary)]",children:"Session:"}),o.jsx("code",{className:"font-mono text-xs text-[var(--color-text-tertiary)]",children:u.sessionId})]})]})]}),f&&o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Test Results"}),o.jsx(i1t,{result:f}),u?.testRunCount&&u.testRunCount>1&&o.jsxs("p",{className:"mt-2 text-xs text-[var(--color-text-tertiary)]",children:["Test run #",u.testRunCount]})]}),u?.mergeFailureReason&&o.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Bn,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-1",children:"Merge Failed"}),o.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:u.mergeFailureReason})]})]})}),o.jsxs("div",{className:"mb-6 p-4 bg-[var(--color-surface-elevated)] rounded-lg border border-[var(--color-border)]",children:[o.jsx("h4",{className:"text-xs font-medium text-[var(--color-text-secondary)] uppercase tracking-wide mb-3",children:"Timeline"}),o.jsxs("div",{className:"space-y-3",children:[u?.completedAt&&o.jsx(ik,{icon:o.jsx(Yn,{className:"w-4 h-4"}),color:"text-green-500",label:"Task completed",time:u.completedAt}),f?.completedAt&&o.jsx(ik,{icon:f.passed?o.jsx(Yn,{className:"w-4 h-4"}):o.jsx(Rt,{className:"w-4 h-4"}),color:f.passed?"text-green-500":"text-red-500",label:f.passed?"Tests passed":"Tests failed",time:f.completedAt}),u?.mergedAt&&o.jsx(ik,{icon:o.jsx(Ps,{className:"w-4 h-4"}),color:"text-purple-500",label:"Merged to main",time:u.mergedAt}),o.jsx(ik,{icon:o.jsx(Rr,{className:"w-4 h-4"}),color:"text-[var(--color-text-tertiary)]",label:"Created",time:a.createdAt})]})]})]})]})}function ik({icon:e,color:t,label:r,time:n}){return o.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[o.jsx("div",{className:t,children:e}),o.jsx("span",{className:"text-[var(--color-text)]",children:r}),o.jsx("span",{className:"text-[var(--color-text-tertiary)] text-xs ml-auto",title:c1t(n),children:u1t(n)})]})}function c1t(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function u1t(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/6e4),s=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<1?"just now":a<60?`${a}m ago`:s<24?`${s}h ago`:i<7?`${i}d ago`:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}const d1t=[{value:"all",label:"All",countKey:"all",icon:Tl},{value:"needs_review",label:"Needs Review",countKey:"needsReview",icon:Rt},{value:"testing",label:"Testing",countKey:"testing",icon:U6},{value:"conflicts",label:"Conflicts",countKey:"conflicts",icon:Bn}];function f1t({currentFilter:e,counts:t,showMerged:r,onFilterChange:n,onShowMergedChange:a}){return o.jsxs("div",{className:"flex items-center justify-between border-b border-[var(--color-border)] overflow-x-auto",children:[o.jsx("nav",{className:"flex gap-1 min-w-max","aria-label":"Merge request filters","data-testid":"merge-request-filters",children:d1t.map(s=>{const i=t[s.countKey],l=e===s.value,c=s.icon;return o.jsx("button",{onClick:()=>n(s.value),className:`pb-3 px-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${l?"text-[var(--color-primary)] border-[var(--color-primary)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)] border-transparent hover:border-[var(--color-border)]"}`,"data-testid":`filter-tab-${s.value}`,children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(c,{className:"w-4 h-4"}),s.label,o.jsx("span",{className:"px-1.5 py-0.5 text-xs rounded-full bg-[var(--color-surface-elevated)]",children:i})]})},s.value)})}),o.jsxs("button",{onClick:()=>a(!r),className:`
          flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-md ml-4 mb-1
          transition-all duration-150 ease-out border
          ${r?"bg-[var(--color-success-muted)] text-[var(--color-success)] border-[var(--color-success)]":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] border-[var(--color-border)] hover:bg-[var(--color-surface-hover)]"}
        `,"data-testid":"toggle-show-merged",children:[r?o.jsx(du,{className:"w-4 h-4"}):o.jsx(ase,{className:"w-4 h-4"}),o.jsxs("span",{children:["Merged (",t.merged,")"]})]})]})}function h1t(){const e=tl({from:"/merge-requests"}),t=Ma(),[r,n]=w.useState(""),a=e.status||"all",s=e.showMerged??!1,i=e.selected,{data:l,isLoading:c,error:u,refetch:d}=ZJe({status:a,showMerged:s}),{counts:f}=Ime(),{data:m}=k2(),p=w.useMemo(()=>{const j=new Map;return m&&m.forEach(E=>j.set(E.id,E.name)),j},[m]),v=w.useMemo(()=>{if(!l)return[];if(!r.trim())return l;const j=r.toLowerCase();return l.filter(E=>{const T=E.title.toLowerCase(),O=E.metadata?.orchestrator?.branch?.toLowerCase()||"",R=p.get(E.assignee||"")?.toLowerCase()||"";return T.includes(j)||O.includes(j)||R.includes(j)})},[l,r,p]),[b,y]=w.useState(0);w.useEffect(()=>{const j=E=>{if(!(E.target instanceof HTMLInputElement||E.target instanceof HTMLTextAreaElement))switch(E.key){case"j":E.preventDefault(),y(T=>Math.min(T+1,v.length-1));break;case"k":E.preventDefault(),y(T=>Math.max(T-1,0));break;case"Enter":E.preventDefault(),v[b]&&N(v[b].id);break;case"Escape":E.preventDefault(),k();break;case"r":!E.metaKey&&!E.ctrlKey&&(E.preventDefault(),d());break}};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[v,b,d]),w.useEffect(()=>{document.querySelector('[data-focused="true"]')?.scrollIntoView({block:"nearest",behavior:"smooth"})},[b]);const S=w.useCallback(j=>{t({to:"/merge-requests",search:{selected:e.selected,status:j==="all"?void 0:j,showMerged:e.showMerged}})},[t,e.selected,e.showMerged]),_=w.useCallback(j=>{t({to:"/merge-requests",search:{selected:e.selected,status:e.status,showMerged:j||void 0}})},[t,e.selected,e.status]),N=w.useCallback(j=>{t({to:"/merge-requests",search:{selected:j,status:e.status,showMerged:e.showMerged}})},[t,e.status,e.showMerged]),k=w.useCallback(()=>{t({to:"/merge-requests",search:{selected:void 0,status:e.status,showMerged:e.showMerged}})},[t,e.status,e.showMerged]);return o.jsxs("div",{className:"space-y-4 animate-fade-in","data-testid":"merge-requests-page",children:[i&&o.jsxs("div",{className:"fixed inset-0 z-40","data-testid":"merge-request-detail-overlay",children:[o.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:k}),o.jsx("div",{className:"absolute right-0 top-0 h-full w-full max-w-lg bg-[var(--color-surface)] shadow-xl border-l border-[var(--color-border)] animate-slide-in-right",children:o.jsx(l1t,{taskId:i,onClose:k,onDeleted:k})})]}),o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Ps,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Merge Requests"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Review and merge completed agent work"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--color-text-tertiary)]"}),o.jsx("input",{type:"text",placeholder:"Search merge requests...",value:r,onChange:j=>n(j.target.value),className:"pl-9 pr-3 py-2 text-sm border border-[var(--color-border)] rounded-md bg-[var(--color-input-bg)] text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)] focus:border-transparent w-48 @md:w-64","data-testid":"merge-requests-search"})]}),o.jsx("button",{onClick:()=>d(),className:"p-2 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","aria-label":"Refresh","data-testid":"merge-requests-refresh",children:o.jsx(jr,{className:"w-4 h-4"})})]})]}),o.jsx(f1t,{currentFilter:a,counts:f,showMerged:s,onFilterChange:S,onShowMergedChange:_}),c?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-primary)] animate-spin mb-4"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Loading merge requests..."})]}):u?o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-danger)] rounded-lg bg-[var(--color-danger-muted)]",children:[o.jsx(Rt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"Failed to load merge requests"}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:u.message}),o.jsxs("button",{onClick:()=>d(),className:"mt-4 flex items-center gap-2 px-4 py-2 text-sm font-medium text-[var(--color-primary)] bg-[var(--color-surface)] rounded-md hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"merge-requests-retry",children:[o.jsx(jr,{className:"w-4 h-4"}),"Retry"]})]}):v.length===0?o.jsx(m1t,{searchQuery:r,currentFilter:a}):o.jsx("div",{className:"space-y-2","data-testid":"merge-requests-list",children:v.map((j,E)=>o.jsx("div",{"data-focused":E===b,className:E===b?"ring-2 ring-[var(--color-primary)] rounded-lg":"",children:o.jsx(a1t,{task:j,assigneeName:j.assignee?p.get(j.assignee):void 0,onClick:()=>N(j.id),isSelected:j.id===i,onDeleted:()=>{j.id===i&&k()}})},j.id))}),o.jsxs("div",{className:"fixed bottom-4 right-4 text-xs text-[var(--color-text-tertiary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-lg px-3 py-2 shadow-sm hidden md:block",children:[o.jsx("span",{className:"font-medium",children:"Shortcuts:"})," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"j"}),"/",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"k"})," navigate"," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"Enter"})," open"," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"Esc"})," close"," ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-[var(--color-surface-elevated)] rounded",children:"r"})," refresh"]})]})}function m1t({searchQuery:e,currentFilter:t}){if(e)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[o.jsx(xr,{className:"w-12 h-12 text-[var(--color-text-tertiary)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)]",children:"No matching merge requests"}),o.jsxs("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:['No merge requests found matching "',e,'". Try a different search term.']})]});const r={all:{title:"No merge requests",description:"When agents complete tasks, their work will appear here for review and merging.",icon:o.jsx(Ps,{className:"w-12 h-12 text-[var(--color-text-tertiary)]"})},needs_review:{title:"No requests need review",description:"All merge requests have been reviewed. Nice work!",icon:o.jsx(Yn,{className:"w-12 h-12 text-green-500"})},testing:{title:"No tests running",description:"No merge requests are currently running tests.",icon:o.jsx(Pe,{className:"w-12 h-12 text-blue-500"})},conflicts:{title:"No conflicts",description:"No merge requests have conflicts. All clear!",icon:o.jsx(Yn,{className:"w-12 h-12 text-green-500"})},merged:{title:"No merged requests",description:"No merge requests have been merged yet.",icon:o.jsx(Ps,{className:"w-12 h-12 text-[var(--color-text-tertiary)]"})}},{title:n,description:a,icon:s}=r[t];return o.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 border border-dashed border-[var(--color-border)] rounded-lg",children:[s,o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mt-4",children:n}),o.jsx("p",{className:"mt-1 text-sm text-[var(--color-text-secondary)] text-center max-w-md",children:a})]})}const p1t=32,g1t=500,V$=w.createContext(null);function Nye(e){const t=e.lastIndexOf(".");return t>0?e.slice(t+1).toLowerCase():""}function v1t(e,t,r){if(t)return r?G6:a0;const n=Nye(e),a=e.toLowerCase();return a.endsWith(".lock")||a.endsWith("-lock.json")||a.endsWith("-lock.yaml")?GC:a==="package.json"||a==="cargo.toml"||a==="go.mod"?ly:["png","jpg","jpeg","gif","svg","webp","ico","bmp"].includes(n)?iy:["mp3","wav","ogg","flac","m4a","aac"].includes(n)?Ywe:["mp4","webm","mkv","avi","mov"].includes(n)?Qwe:["db","sqlite","sqlite3","sql"].includes(n)?dse:["json","jsonc","json5"].includes(n)?fse:IZe(e)?Bi:Bme(e)?Wa:RZe(e)?use:["md","txt","rtf","doc","docx","pdf"].includes(n)?rn:F6}function b1t(e,t){if(t)return"text-amber-500";const r=Nye(e),n=e.toLowerCase();return n.endsWith(".lock")||n.endsWith("-lock.json")||n.endsWith("-lock.yaml")?"text-gray-400":n==="package.json"||n==="cargo.toml"||n==="go.mod"?"text-green-500":["ts","tsx"].includes(r)?"text-blue-500":["js","jsx","mjs","cjs"].includes(r)?"text-yellow-500":["py","pyw","pyi"].includes(r)?"text-blue-400":["rs"].includes(r)?"text-orange-500":["go"].includes(r)?"text-cyan-500":["rb","rake"].includes(r)?"text-red-500":["html","htm"].includes(r)?"text-orange-400":["css","scss","sass","less"].includes(r)?"text-pink-500":["sh","bash","zsh","fish"].includes(r)?"text-green-400":["json","jsonc","json5"].includes(r)?"text-yellow-400":["md","mdx"].includes(r)?"text-purple-400":["yaml","yml","toml"].includes(r)?"text-red-400":["png","jpg","jpeg","gif","svg","webp"].includes(r)?"text-purple-500":Bme(e)?"text-gray-400":"text-[var(--color-text-muted)]"}function y1t({node:e,children:t}){const r=w.useContext(V$);if(!r)return o.jsx(o.Fragment,{children:t});const{clipboard:n,onOpen:a,onCopy:s,onCut:i,onPaste:l,onCopyPath:c,onCopyRelativePath:u,onRename:d,onDelete:f}=r,m=e.nodeType==="folder",p=n!==null;return o.jsxs(Tse,{children:[o.jsx(Ase,{asChild:!0,children:t}),o.jsx(Dse,{children:o.jsxs(Lse,{className:"min-w-[180px] bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-lg py-1 z-50","data-testid":"file-tree-context-menu",children:[o.jsx(_i,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>a(e),"data-testid":"context-menu-open",children:o.jsx("span",{children:"Open"})}),o.jsx(vk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsx(_i,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>s(e),"data-testid":"context-menu-copy",children:o.jsx("span",{children:"Copy"})}),o.jsx(_i,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>i(e),"data-testid":"context-menu-cut",children:o.jsx("span",{children:"Cut"})}),o.jsx(_i,{className:`flex items-center justify-between px-3 py-1.5 text-sm outline-none ${p?"text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer":"text-[var(--color-text-muted)] opacity-50 cursor-not-allowed"}`,disabled:!p,onSelect:()=>{if(p)if(m)l(e);else{const v=e.path.lastIndexOf("/")>0?e.path.slice(0,e.path.lastIndexOf("/")):"";l({...e,path:v,nodeType:"folder"})}},"data-testid":"context-menu-paste",children:o.jsx("span",{children:"Paste"})}),o.jsx(vk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsx(_i,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>c(e),"data-testid":"context-menu-copy-path",children:o.jsx("span",{children:"Copy Path"})}),o.jsx(_i,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>u(e),"data-testid":"context-menu-copy-relative-path",children:o.jsx("span",{children:"Copy Relative Path"})}),o.jsx(vk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsxs(_i,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>d(e),"data-testid":"context-menu-rename",children:[o.jsx("span",{children:"Rename"}),o.jsx("span",{className:"text-[var(--color-text-muted)] text-xs ml-4",children:"F2"})]}),o.jsxs(_i,{className:"flex items-center justify-between px-3 py-1.5 text-sm text-red-400 data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none",onSelect:()=>f(e),"data-testid":"context-menu-delete",children:[o.jsx("span",{children:"Delete"}),o.jsx("span",{className:"text-[var(--color-text-muted)] text-xs ml-4",children:"Del"})]})]})})]})}function x1t({node:e,onSubmit:t,onCancel:r}){const n=w.useRef(null),[a,s]=w.useState(e.name),i=w.useRef(!1);w.useEffect(()=>{const d=setTimeout(()=>{if(n.current){if(n.current.focus(),e.nodeType==="file"){const f=e.name.lastIndexOf(".");f>0?n.current.setSelectionRange(0,f):n.current.select()}else n.current.select();i.current=!0}},50);return()=>clearTimeout(d)},[e.name,e.nodeType]);const l=()=>{const d=a.trim();d&&d!==e.name?t(e.path,d):r()},c=()=>{i.current&&l()},u=d=>{d.key==="Enter"?(d.preventDefault(),l()):d.key==="Escape"&&(d.preventDefault(),r())};return o.jsx("input",{ref:n,type:"text",value:a,onChange:d=>s(d.target.value),onBlur:c,onKeyDown:u,className:"flex-1 bg-[var(--color-bg)] border border-[var(--color-primary)] rounded px-1 py-0 text-sm text-[var(--color-text)] outline-none","data-testid":"inline-rename-input",onClick:d=>d.stopPropagation()})}function w1t(e){const[t,r]=w.useState(!1),n=w.useRef(null),a=e.data.nodeType==="folder",s=!e.isOpen,i=e.willReceiveDrop;return w.useEffect(()=>(a&&s&&i?(r(!0),n.current=setTimeout(()=>{e.open(),r(!1)},g1t)):(n.current&&(clearTimeout(n.current),n.current=null),r(!1)),()=>{n.current&&(clearTimeout(n.current),n.current=null)}),[a,s,i,e]),t}function S1t({node:e,style:t,dragHandle:r}){const n=w.useContext(V$),a=e.data.nodeType==="folder",s=e.isOpen,i=e.isSelected,l=n?.renamingNodeId===e.data.id,c=e.willReceiveDrop,u=e.isDragging,d=w1t(e),f=v1t(e.data.name,a,s),m=b1t(e.data.name,a),p=b=>{b.stopPropagation(),a?e.toggle():(e.select(),e.activate())},v=o.jsx("div",{ref:r,"data-testid":`file-tree-item-${e.id}`,style:t,className:`pr-2 ${u?"opacity-50":""}`,children:o.jsxs("button",{"data-testid":`file-tree-button-${e.id}`,onClick:p,className:`
          w-full flex items-center gap-1.5 px-2 py-1 rounded-md text-sm
          transition-colors duration-150 ease-in-out
          ${c?d?"bg-[var(--color-primary-muted)] ring-1 ring-[var(--color-primary)] text-[var(--color-text)] animate-pulse":"bg-[var(--color-primary-muted)] ring-1 ring-[var(--color-primary)] text-[var(--color-text)]":i?"bg-[var(--color-primary)] text-white":"text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
        `,children:[a?o.jsx("span",{className:"flex-shrink-0 w-4 h-4 flex items-center justify-center",children:s?o.jsx(Yt,{className:"w-3.5 h-3.5"}):o.jsx(gn,{className:"w-3.5 h-3.5"})}):o.jsx("span",{className:"w-4"}),o.jsx(f,{className:`w-4 h-4 flex-shrink-0 ${i?"text-white":m}`}),l&&n?o.jsx(x1t,{node:e.data,onSubmit:n.onRenameSubmit,onCancel:n.onRenameCancel}):o.jsx("span",{className:"truncate flex-1 text-left",children:e.data.name})]})});return n&&!l?o.jsx(y1t,{node:e.data,children:v}):v}function k1t({node:e,isOpen:t,onConfirm:r,onCancel:n}){return o.jsx(bSe,{open:t,onOpenChange:a=>!a&&n(),children:o.jsxs(ySe,{children:[o.jsx(xSe,{className:"fixed inset-0 bg-black/40 z-50"}),o.jsxs(wSe,{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-xl z-50 w-full max-w-md p-6","data-testid":"delete-confirmation-dialog",children:[o.jsxs(SSe,{className:"text-lg font-semibold text-[var(--color-text)]",children:["Are you sure you want to delete ",e?.name,"?"]}),o.jsx(kSe,{className:"mt-2 text-sm text-[var(--color-text-muted)]",children:"This action cannot be undone."}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx(_Se,{asChild:!0,children:o.jsx("button",{className:"px-4 py-2 text-sm font-medium text-[var(--color-text)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] rounded-md transition-colors","data-testid":"delete-cancel-button",children:"Cancel"})}),o.jsx(NSe,{asChild:!0,children:o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors","data-testid":"delete-confirm-button",children:"Delete"})})]})]})]})})}function Cye(e){return{id:e.id,name:e.name,nodeType:e.type==="directory"?"folder":"file",path:e.path,children:e.children?.map(Cye)}}function _1t(e){return{id:e.id,name:e.title||"Untitled",nodeType:"file",path:e.title||"Untitled",document:e}}function vO(e){const t=e.lastIndexOf("/");return t>0?e.slice(0,t):""}const N1t=w.forwardRef(function({workspaceEntries:t=[],documents:r=[],source:n,selectedId:a,onSelectFile:s,onDoubleClickFile:i,onDeleteFile:l,onRenameFile:c,onPasteFile:u,onMoveFile:d,workspaceRoot:f,className:m=""},p){const v=w.useRef(null),b=w.useRef(null),[y,S]=w.useState(400);w.useImperativeHandle(p,()=>({closeAll:()=>b.current?.closeAll()}));const[_,N]=w.useState(null),[k,j]=w.useState(null),[E,T]=w.useState(null);w.useEffect(()=>{if(!v.current)return;const te=new ResizeObserver(le=>{for(const oe of le)S(Math.max(oe.contentRect.height-8,100))});return te.observe(v.current),()=>te.disconnect()},[]);const O=w.useMemo(()=>n==="workspace"?t.map(Cye):r.map(_1t),[n,t,r]),R=w.useCallback(te=>{te.length>0&&te[0].data.nodeType==="file"&&s(te[0].data)},[s]),H=w.useCallback(te=>{te.data.nodeType==="file"&&(i?i(te.data):s(te.data))},[s,i]),$=w.useCallback(te=>{if(te.nodeType==="folder"){const le=b.current;if(le){const oe=le.get(te.id);oe&&oe.toggle()}}else s(te)},[s]),L=w.useCallback(te=>{N({node:te,operation:"copy"})},[]),A=w.useCallback(te=>{N({node:te,operation:"cut"})},[]),M=w.useCallback(async te=>{if(!(!_||!u))try{await u(_.node.path,te.path,_.operation),_.operation==="cut"&&N(null)}catch(le){console.error("Failed to paste file:",le)}},[_,u]),P=w.useCallback(te=>{const le=f?`${f}/${te.path}`:`/${te.path}`;navigator.clipboard.writeText(le)},[f]),I=w.useCallback(te=>{navigator.clipboard.writeText(te.path)},[]),B=w.useCallback(te=>{j(te.id)},[]),F=w.useCallback(async(te,le)=>{if(!c){j(null);return}const oe=vO(te),Z=oe?`${oe}/${le}`:le;try{await c(te,Z)}catch(ve){console.error("Failed to rename file:",ve)}finally{j(null)}},[c]),q=w.useCallback(()=>{j(null)},[]),Q=w.useCallback(te=>{T(te)},[]),W=w.useCallback(async()=>{if(!E||!l){T(null);return}try{await l(E.path)}catch(te){console.error("Failed to delete file:",te)}finally{T(null)}},[E,l]),G=w.useCallback(()=>{T(null)},[]),[J,X]=w.useState(null),V=w.useCallback(async te=>{if(d)for(const le of te.dragNodes){const oe=le.data.path,Z=le.data.name,ve=te.parentNode?`${te.parentNode.data.path}/${Z}`:Z;if(oe!==ve&&!(te.parentNode&&te.parentNode.data.path.startsWith(oe+"/"))&&!(te.parentNode&&te.parentNode.data.path===oe))try{X(null),await d(oe,ve)}catch(U){const ge=U instanceof Error?U.message:"Failed to move file";X(ge),console.error("Failed to move file:",U),setTimeout(()=>X(null),5e3)}}},[d]),se=w.useCallback(te=>{const{parentNode:le,dragNodes:oe}=te,Z=le.isRoot;for(const ve of oe){if(Z){if(vO(ve.data.path)==="")return!0;continue}if(le.data.nodeType==="file"||le.data.path===ve.data.path||le.data.path.startsWith(ve.data.path+"/"))return!0;const U=vO(ve.data.path),ge=le.data.path;if(U===ge)return!0}return!1},[]),de=n==="workspace"&&!!d,he=w.useMemo(()=>({clipboard:_,renamingNodeId:k,onOpen:$,onCopy:L,onCut:A,onPaste:M,onCopyPath:P,onCopyRelativePath:I,onRename:B,onDelete:Q,onRenameSubmit:F,onRenameCancel:q}),[_,k,$,L,A,M,P,I,B,Q,F,q]);return o.jsx(V$.Provider,{value:he,children:o.jsxs("div",{ref:v,"data-testid":"editor-file-tree",className:`flex-1 overflow-hidden p-1 relative ${m}`,children:[O.length===0?o.jsx("div",{className:"text-center py-8 text-[var(--color-text-muted)] text-sm",children:"No files to display"}):o.jsxs(o.Fragment,{children:[o.jsx(wye,{ref:b,data:O,width:"100%",height:y,rowHeight:p1t,indent:16,paddingTop:4,paddingBottom:4,selection:a??void 0,onSelect:R,onActivate:H,disableMultiSelection:!0,openByDefault:!1,onMove:de?V:void 0,disableDrag:!de,disableDrop:de?se:!0,children:S1t}),J&&o.jsx("div",{className:"absolute bottom-2 left-2 right-2 px-3 py-2 text-xs text-red-400 bg-red-900/30 border border-red-800/50 rounded-md","data-testid":"move-error-message",children:J})]}),o.jsx(k1t,{node:E,isOpen:E!==null,onConfirm:W,onCancel:G})]})})});function C1t(e){const t=e.split(".").pop()?.toLowerCase()||"";return new Set(["js","jsx","ts","tsx","mjs","cjs","mts","cts","json","jsonc","json5","py","pyw","pyx","go","rs","java","kt","kts","c","cpp","cc","cxx","h","hpp","hxx","cs","php","rb","swift","r","lua","pl","pm","ex","exs","erl","hrl","clj","cljs","scala","vue","svelte","astro","html","htm","css","scss","sass","less","yaml","yml","toml","xml","svg","sql","graphql","gql","sh","bash","zsh","fish","ps1","dockerfile","makefile","cmake"]).has(t)?Bi:rn}function j1t({lineContent:e,startIndex:t,endIndex:r}){const n=e.slice(0,t),a=e.slice(t,r),s=e.slice(r),i=60;let l=n,c=s;n.length>20&&(l="..."+n.slice(-17)),s.length>30&&(c=s.slice(0,27)+"...");const u=l.length+a.length+c.length;if(u>i){const d=u-i;c.length>d&&(c=c.slice(0,c.length-d-3)+"...")}return o.jsxs("span",{className:"font-mono text-xs leading-relaxed",children:[o.jsx("span",{className:"text-[var(--color-text-muted)]",children:l}),o.jsx("span",{className:"bg-[var(--color-warning)]/30 text-[var(--color-text)] font-semibold px-0.5 rounded",children:a}),o.jsx("span",{className:"text-[var(--color-text-muted)]",children:c})]})}function E1t({result:e,isExpanded:t,onToggleExpand:r,onSelectMatch:n}){const a=C1t(e.name);return o.jsxs("div",{className:"border-b border-[var(--color-border)] last:border-b-0","data-testid":`search-result-${e.path}`,children:[o.jsxs("button",{onClick:r,className:"w-full flex items-center gap-1.5 px-2 py-1.5 hover:bg-[var(--color-surface-hover)] transition-colors text-left","data-testid":`search-result-header-${e.path}`,children:[t?o.jsx(Yt,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)] flex-shrink-0"}):o.jsx(gn,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)] flex-shrink-0"}),o.jsx(a,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)] flex-shrink-0"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text)] truncate flex-1",children:e.name}),o.jsx("span",{className:"text-xs px-1 py-0.5 bg-[var(--color-primary)]/10 text-[var(--color-primary)] rounded flex-shrink-0",children:e.totalMatches})]}),t&&o.jsxs("div",{className:"bg-[var(--color-surface)]/50",children:[e.matches.map((s,i)=>o.jsxs("button",{onClick:()=>n(e,s),className:"w-full flex items-start gap-1.5 px-2 py-1 pl-7 hover:bg-[var(--color-surface-hover)] transition-colors text-left","data-testid":`search-match-${e.path}-${s.line}`,children:[o.jsx("span",{className:"text-xs text-[var(--color-text-muted)] font-mono w-6 text-right flex-shrink-0",children:s.line}),o.jsx(j1t,{lineContent:s.lineContent,startIndex:s.startIndex,endIndex:s.endIndex})]},`${s.line}-${s.column}-${i}`)),e.totalMatches>e.matches.length&&o.jsxs("div",{className:"px-2 py-1 pl-7 text-xs text-[var(--color-text-muted)] italic",children:["+",e.totalMatches-e.matches.length," more..."]})]})]})}function bO({active:e,onClick:t,icon:r,label:n}){return o.jsx("button",{onClick:t,className:`
        flex items-center justify-center w-6 h-6 rounded transition-colors
        ${e?"bg-[var(--color-primary)] text-white":"text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface-hover)]"}
      `,title:n,"data-testid":`search-option-${n.toLowerCase().replace(/\s+/g,"-")}`,children:o.jsx(r,{className:"w-3.5 h-3.5"})})}const M1t=w.forwardRef(function({onSelectResult:t,className:r=""},n){const a=w.useRef(null),[s,i]=w.useState(new Set),{isOpen:l,isLoading:c,error:u}=y1(),{query:d,setQuery:f,isSearching:m,results:p,filesSearched:v,totalFiles:b,totalMatches:y,progress:S,error:_,isComplete:N,searchTime:k,options:j,setOptions:E,clearResults:T}=Qme();w.useImperativeHandle(n,()=>({focus:()=>{a.current?.focus()}}),[]),w.useEffect(()=>{p.length>0&&p.length<=3&&i(new Set(p.map(F=>F.path)))},[p]);const O=w.useCallback((F,q)=>{t(F.path,q.line,q.column)},[t]),R=w.useCallback(F=>{i(q=>{const Q=new Set(q);return Q.has(F)?Q.delete(F):Q.add(F),Q})},[]),H=w.useCallback(()=>{E({caseSensitive:!j.caseSensitive})},[j.caseSensitive,E]),$=w.useCallback(()=>{E({useRegex:!j.useRegex})},[j.useRegex,E]),L=w.useCallback(()=>{E({wholeWord:!j.wholeWord})},[j.wholeWord,E]),A=w.useCallback(()=>{T(),i(new Set),a.current?.focus()},[T]),M=d.trim().length>0,P=m&&b>0,I=p.length>0,B=N&&M&&p.length===0&&!_;return o.jsxs("div",{className:`flex flex-col h-full overflow-hidden ${r}`,"data-testid":"editor-search-panel",children:[o.jsxs("div",{className:"flex-shrink-0 p-2 border-b border-[var(--color-border)] space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("input",{ref:a,type:"text",value:d,onChange:F=>f(F.target.value),placeholder:l?"Search...":"Open workspace...",className:"w-full h-7 pl-7 pr-7 text-xs bg-[var(--color-surface)] border border-[var(--color-border)] rounded focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] text-[var(--color-text)] placeholder:text-[var(--color-text-muted)]",disabled:!l,"data-testid":"editor-search-input"}),M&&o.jsx("button",{onClick:A,className:"absolute right-1.5 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text)]",title:"Clear search","data-testid":"editor-search-clear",children:o.jsx(yt,{className:"w-3.5 h-3.5"})}),m&&o.jsx(Pe,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 animate-spin text-[var(--color-primary)]"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(bO,{active:j.caseSensitive??!1,onClick:H,icon:Jae,label:"Match Case"}),o.jsx(bO,{active:j.wholeWord??!1,onClick:L,icon:Zae,label:"Whole Word"}),o.jsx(bO,{active:j.useRegex??!1,onClick:$,icon:Xae,label:"Use Regex"})]}),P&&o.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-muted)]",children:[o.jsx("div",{className:"flex-1 h-1 bg-[var(--color-surface)] rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-[var(--color-primary)] transition-all duration-200",style:{width:`${S*100}%`}})}),o.jsxs("span",{className:"flex-shrink-0",children:[v,"/",b]})]}),N&&M&&!m&&o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[y," ",y===1?"result":"results"," in ",p.length," ",p.length===1?"file":"files",k!==null&&` (${Math.round(k)}ms)`]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto","data-testid":"editor-search-results",children:[c&&o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(Pe,{className:"w-5 h-5 animate-spin text-[var(--color-text-muted)]"})}),u&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(Rt,{className:"w-6 h-6 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:u})]}),_&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[var(--color-danger)]/10 text-[var(--color-danger)] text-xs",children:[o.jsx(Rt,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{children:_})]}),!c&&!u&&!l&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(Pe,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3 animate-spin"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Loading..."}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Workspace is loading"})]}),l&&!M&&!m&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(xr,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Search Files"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Type to search in all files"})]}),B&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(yt,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"No Results"}),o.jsxs("p",{className:"text-xs text-[var(--color-text-secondary)]",children:['No files contain "',d,'"']})]}),I&&o.jsx("div",{children:p.map(F=>o.jsx(E1t,{result:F,isExpanded:s.has(F.path),onToggleExpand:()=>R(F.path),onSelectMatch:O},F.path))})]})]})}),_5=(e,t)=>t.some(r=>e instanceof r);let fne,hne;function T1t(){return fne||(fne=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function A1t(){return hne||(hne=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N5=new WeakMap,yO=new WeakMap,pE=new WeakMap;function D1t(e){const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{r(mh(e.result)),a()},i=()=>{n(e.error),a()};e.addEventListener("success",s),e.addEventListener("error",i)});return pE.set(t,e),t}function L1t(e){if(N5.has(e))return;const t=new Promise((r,n)=>{const a=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{r(),a()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});N5.set(e,t)}let C5={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return N5.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return mh(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function jye(e){C5=e(C5)}function O1t(e){return A1t().includes(e)?function(...t){return e.apply(j5(this),t),mh(this.request)}:function(...t){return mh(e.apply(j5(this),t))}}function I1t(e){return typeof e=="function"?O1t(e):(e instanceof IDBTransaction&&L1t(e),_5(e,T1t())?new Proxy(e,C5):e)}function mh(e){if(e instanceof IDBRequest)return D1t(e);if(yO.has(e))return yO.get(e);const t=I1t(e);return t!==e&&(yO.set(e,t),pE.set(t,e)),t}const j5=e=>pE.get(e);function R1t(e,t,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const i=indexedDB.open(e,t),l=mh(i);return n&&i.addEventListener("upgradeneeded",c=>{n(mh(i.result),c.oldVersion,c.newVersion,mh(i.transaction),c)}),r&&i.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",u=>a(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const P1t=["get","getKey","getAll","getAllKeys","count"],z1t=["put","add","delete","clear"],xO=new Map;function mne(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(xO.get(t))return xO.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,a=z1t.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||P1t.includes(r)))return;const s=async function(i,...l){const c=this.transaction(i,a?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),a&&c.done]))[0]};return xO.set(t,s),s}jye(e=>({...e,get:(t,r,n)=>mne(t,r)||e.get(t,r,n),has:(t,r)=>!!mne(t,r)||e.has(t,r)}));const B1t=["continue","continuePrimaryKey","advance"],pne={},E5=new WeakMap,Eye=new WeakMap,$1t={get(e,t){if(!B1t.includes(t))return e[t];let r=pne[t];return r||(r=pne[t]=function(...n){E5.set(this,Eye.get(this)[t](...n))}),r}};async function*F1t(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const r=new Proxy(t,$1t);for(Eye.set(r,t),pE.set(r,j5(t));t;)yield r,t=await(E5.get(r)||t.continue()),E5.delete(r)}function gne(e,t){return t===Symbol.asyncIterator&&_5(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&_5(e,[IDBIndex,IDBObjectStore])}jye(e=>({...e,get(t,r,n){return gne(t,r)?F1t:e.get(t,r,n)},has(t,r){return gne(t,r)||e.has(t,r)}}));const U1t="stoneforge-extensions",H1t=1,Bd="installed_extensions",Yg="extension_files";let Sp=null,Gv=null;function q1t(){try{return!(typeof indexedDB>"u")}catch{return!1}}async function W1t(){if(Gv)return Gv;if(!Sp)return Gv=(async()=>{if(!q1t()){console.warn("[ExtensionStorage] IndexedDB is not available. Extensions will not persist across sessions.");return}try{Sp=await R1t(U1t,H1t,{upgrade(e){e.objectStoreNames.contains(Bd)||e.createObjectStore(Bd,{keyPath:"id"}),e.objectStoreNames.contains(Yg)||e.createObjectStore(Yg,{keyPath:"key"}).createIndex("byExtension","extensionId")},blocked(){console.warn("[ExtensionStorage] Database upgrade blocked. Please close other tabs using this application.")},blocking(){Sp?.close(),Sp=null},terminated(){console.warn("[ExtensionStorage] Database connection terminated unexpectedly."),Sp=null,Gv=null}})}catch(e){console.warn("[ExtensionStorage] Failed to initialize IndexedDB. Extensions will not persist across sessions.",e)}})(),Gv}async function gE(){return await W1t(),Sp}function K1t(e,t){return`${e}/${t}`}async function G1t(e,t,r){const n=await gE();if(!n){console.warn("[ExtensionStorage] Cannot save extension - IndexedDB unavailable");return}const a={id:e,manifest:t,installedAt:Date.now(),version:t.version},s=n.transaction([Bd,Yg],"readwrite");try{await s.objectStore(Bd).put(a);const i=s.objectStore(Yg),l=[];for(const[c,u]of r){const d={key:K1t(e,c),extensionId:e,filePath:c,content:u};l.push(i.put(d))}await Promise.all(l),await s.done}catch(i){throw new Error(`Failed to save extension ${e}: ${i instanceof Error?i.message:String(i)}`)}}async function Mye(e){const t=await gE();if(!t){console.warn("[ExtensionStorage] Cannot remove extension - IndexedDB unavailable");return}const r=t.transaction([Bd,Yg],"readwrite");try{await r.objectStore(Bd).delete(e);const n=r.objectStore(Yg),i=(await n.index("byExtension").getAllKeys(e)).map(l=>n.delete(l));await Promise.all(i),await r.done}catch(n){throw new Error(`Failed to remove extension ${e}: ${n instanceof Error?n.message:String(n)}`)}}async function V1t(){const e=await gE();return e?(await e.getAll(Bd)).sort((r,n)=>n.installedAt-r.installedAt):[]}async function vne(e){const t=await gE();return t?await t.get(Bd,e)??null:null}const Od=new Map,Tye=new Set;function Y1t(e){switch(e.split(".").pop()?.toLowerCase()){case"json":return"application/json";case"plist":case"tmLanguage":return"application/xml";case"tmTheme":return"application/xml";case"png":return"image/png";case"svg":return"image/svg+xml";case"jpg":case"jpeg":return"image/jpeg";default:return"application/octet-stream"}}function Q1t(e,t){const r=Y1t(t),n=new ArrayBuffer(e.byteLength);new Uint8Array(n).set(e);const a=new Blob([n],{type:r});return URL.createObjectURL(a)}function J1t(e){return`${e.publisher}.${e.name}`}function bne(e){return e.startsWith("#")?e.slice(1):e}function Z1t(e,t){const r=t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");return`${e}-${r}`}function X1t(e){switch(e){case"vs":return"vs";case"vs-dark":return"vs-dark";case"hc-black":return"hc-black";case"hc-light":return"hc-light";default:return"vs-dark"}}function ewt(e,t){const r=[];if(e.tokenColors)for(const n of e.tokenColors){const a=n.settings;if(!a)continue;const s=n.scope;if(!s){(a.foreground||a.fontStyle)&&r.push({token:"",foreground:a.foreground?bne(a.foreground):void 0,fontStyle:a.fontStyle});continue}const i=Array.isArray(s)?s:[s];for(const l of i)!l||l.trim()===""||r.push({token:l,foreground:a.foreground?bne(a.foreground):void 0,fontStyle:a.fontStyle})}return{base:X1t(t),inherit:!0,rules:r,colors:e.colors||{}}}function twt(e,t,r){const n=[],a=t.contributes?.themes;if(!a||a.length===0)return n;for(const s of a)try{let i=s.path;i.startsWith("./")?i=i.slice(2):i.startsWith("/")&&(i=i.slice(1));const l=r.get(i);if(!l){console.warn(`[ExtensionRegistry] Theme file not found: ${i} for extension ${e}`);continue}const c=new TextDecoder().decode(l),u=JSON.parse(c),d=s.id||Z1t(e,s.label),f=ewt(u,s.uiTheme);Gp.defineTheme(d,f),Tye.add(d),n.push(d),console.log(`[ExtensionRegistry] Registered theme: ${d} (${s.label})`)}catch(i){console.error(`[ExtensionRegistry] Failed to register theme ${s.label} from ${e}:`,i)}return n}function rwt(e,t){const r=J1t(e);if(Od.has(r))return console.warn(`[ExtensionRegistry] Extension ${r} is already registered`),{success:!0,extension:Od.get(r)};try{const n=new Map,a=[];for(const[u,d]of t){const f=Q1t(d,u);n.set(u,f),a.push({dispose:()=>URL.revokeObjectURL(f)})}const s=twt(r,e,t),i=e.contributes?.grammars;i&&Array.isArray(i)&&i.length>0&&console.warn(`[ExtensionRegistry] Extension ${r} contributes ${i.length} grammar(s) - TextMate grammar registration is not yet supported (requires vscode-textmate + vscode-oniguruma)`);const l=e.contributes?.snippets;l&&Array.isArray(l)&&l.length>0&&console.warn(`[ExtensionRegistry] Extension ${r} contributes ${l.length} snippet(s) - snippet registration is not yet supported`);const c={id:r,manifest:e,blobUrls:n,fileDisposables:a,definedThemeIds:s,dispose:async()=>{for(const u of a)u.dispose();for(const u of s)Tye.delete(u)},whenReady:async()=>Promise.resolve()};return Od.set(r,c),console.log(`[ExtensionRegistry] Registered extension: ${r} (${s.length} theme(s))`),{success:!0,extension:c}}catch(n){const a=n instanceof Error?n.message:String(n);return console.error(`[ExtensionRegistry] Failed to register extension ${r}:`,n),{success:!1,error:a}}}async function nwt(e){const t=Od.get(e);if(!t){console.warn(`[ExtensionRegistry] Extension ${e} is not registered`);return}try{await t.dispose(),Od.delete(e),console.log(`[ExtensionRegistry] Unregistered extension: ${e}`)}catch(r){throw console.error(`[ExtensionRegistry] Error unregistering extension ${e}:`,r),Od.delete(e),r}}function awt(){return Array.from(Od.values())}function swt(e){return Od.has(e)}const Aye=[{id:"stoneforge-dark",name:"Stoneforge Dark"},{id:"vs-dark",name:"Dark (VS Code)"},{id:"vs",name:"Light (VS Code)"},{id:"hc-black",name:"High Contrast Dark"},{id:"hc-light",name:"High Contrast Light"}],ok="stoneforge-dark";function iwt(){const e=awt(),t=[];for(const r of e){const n=r.manifest.contributes;if(n?.themes)for(const a of n.themes)t.push({id:a.label,name:a.label,publisher:r.manifest.publisher,extensionName:r.manifest.displayName||r.manifest.name})}return t}function yne(e,t){return Aye.some(n=>n.id===e)?!0:t.some(n=>n.id===e)}function owt({theme:e,onThemeChange:t}){const[r,n]=w.useState([]),a=w.useCallback(()=>{const s=iwt();return n(s),s},[]);return w.useEffect(()=>{const s=a();yne(e,s)||(console.log(`[EditorSettingsPanel] Theme "${e}" is no longer available, falling back to ${ok}`),t(ok));const i=setInterval(()=>{const l=a();yne(e,l)||(console.log(`[EditorSettingsPanel] Theme "${e}" was uninstalled, falling back to ${ok}`),t(ok))},2e3);return()=>clearInterval(i)},[e,t,a]),o.jsx("div",{className:"flex flex-col h-full overflow-y-auto","data-testid":"editor-settings-panel",children:o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(W6,{className:"w-4 h-4 text-[var(--color-text-muted)]"}),o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Appearance"})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"editor-theme",className:"text-sm font-medium text-[var(--color-text)]",children:"Theme"}),o.jsxs("select",{id:"editor-theme",value:e,onChange:s=>t(s.target.value),className:`
              w-full px-3 py-2
              text-sm
              bg-[var(--color-surface)]
              border border-[var(--color-border)]
              rounded-lg
              text-[var(--color-text)]
              focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]/30
            `,"data-testid":"editor-theme-select",children:[o.jsx("optgroup",{label:"Built-in",children:Aye.map(s=>o.jsx("option",{value:s.id,children:s.name},s.id))}),r.length>0&&o.jsx("optgroup",{label:"Installed",children:r.map(s=>o.jsxs("option",{value:s.id,children:[s.name," (",s.extensionName,")"]},`${s.publisher}.${s.id}`))})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-tertiary)]",children:"Choose the color theme for the editor."})]})]})})}class RC extends Error{constructor(t,r,n){super(t),this.code=r,this.status=n,this.name="OpenVSXError"}}const Dye="/api";async function Lye(e,t){let r;try{r=await fetch(`${Dye}${e}`,{...t,headers:{Accept:"application/json",...t?.headers}})}catch(n){throw new RC(`Network error: ${n instanceof Error?n.message:"Failed to connect"}`,"NETWORK_ERROR",0)}if(!r.ok){let n=null;try{n=await r.json()}catch{}const a=n?.error?.code||`HTTP_${r.status}`,s=n?.error?.message||Oye(r.status);throw new RC(s,a,r.status)}return r.json()}function Oye(e){switch(e){case 400:return"Invalid request parameters";case 404:return"Extension not found";case 429:return"Rate limit exceeded. Please try again later.";case 500:return"Server error. Please try again later.";case 502:return"Unable to reach extension registry";case 503:return"Extension registry temporarily unavailable";case 504:return"Request timed out";default:return`Request failed with status ${e}`}}async function lwt(e,t){const r=new URLSearchParams;e&&r.set("query",e),t?.category&&r.set("category",t.category),r.set("size",String(t.size)),t?.offset!==void 0&&r.set("offset",String(t.offset)),t?.sortBy&&r.set("sortBy",t.sortBy),t?.sortOrder&&r.set("sortOrder",t.sortOrder);const n=r.toString(),a=n?`/extensions/search?${n}`:"/extensions/search";return Lye(a)}async function Iye(e,t){return Lye(`/extensions/${encodeURIComponent(e)}/${encodeURIComponent(t)}`)}async function cwt(e,t,r){const n=`/extensions/${encodeURIComponent(e)}/${encodeURIComponent(t)}/${encodeURIComponent(r)}/download`;let a;try{a=await fetch(`${Dye}${n}`)}catch(s){throw new RC(`Network error: ${s instanceof Error?s.message:"Failed to connect"}`,"NETWORK_ERROR",0)}if(!a.ok){let s=null;if(a.headers.get("Content-Type")?.includes("application/json"))try{s=await a.json()}catch{}const l=s?.error?.code||`HTTP_${a.status}`,c=s?.error?.message||Oye(a.status);throw new RC(c,l,a.status)}return a.arrayBuffer()}function lk(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wO={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var xne;function uwt(){return xne||(xne=1,(function(e,t){(function(r){e.exports=r()})(function(){return(function r(n,a,s){function i(u,d){if(!a[u]){if(!n[u]){var f=typeof lk=="function"&&lk;if(!d&&f)return f(u,!0);if(l)return l(u,!0);var m=new Error("Cannot find module '"+u+"'");throw m.code="MODULE_NOT_FOUND",m}var p=a[u]={exports:{}};n[u][0].call(p.exports,function(v){var b=n[u][1][v];return i(b||v)},p,p.exports,r,n,a,s)}return a[u].exports}for(var l=typeof lk=="function"&&lk,c=0;c<s.length;c++)i(s[c]);return i})({1:[function(r,n,a){var s=r("./utils"),i=r("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var u,d,f,m,p,v,b,y=[],S=0,_=c.length,N=_,k=s.getTypeOf(c)!=="string";S<c.length;)N=_-S,f=k?(u=c[S++],d=S<_?c[S++]:0,S<_?c[S++]:0):(u=c.charCodeAt(S++),d=S<_?c.charCodeAt(S++):0,S<_?c.charCodeAt(S++):0),m=u>>2,p=(3&u)<<4|d>>4,v=1<N?(15&d)<<2|f>>6:64,b=2<N?63&f:64,y.push(l.charAt(m)+l.charAt(p)+l.charAt(v)+l.charAt(b));return y.join("")},a.decode=function(c){var u,d,f,m,p,v,b=0,y=0,S="data:";if(c.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var _,N=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===l.charAt(64)&&N--,c.charAt(c.length-2)===l.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=i.uint8array?new Uint8Array(0|N):new Array(0|N);b<c.length;)u=l.indexOf(c.charAt(b++))<<2|(m=l.indexOf(c.charAt(b++)))>>4,d=(15&m)<<4|(p=l.indexOf(c.charAt(b++)))>>2,f=(3&p)<<6|(v=l.indexOf(c.charAt(b++))),_[y++]=u,p!==64&&(_[y++]=d),v!==64&&(_[y++]=f);return _}},{"./support":30,"./utils":32}],2:[function(r,n,a){var s=r("./external"),i=r("./stream/DataWorker"),l=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function u(d,f,m,p,v){this.compressedSize=d,this.uncompressedSize=f,this.crc32=m,this.compression=p,this.compressedContent=v}u.prototype={getContentWorker:function(){var d=new i(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return d.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new i(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,f,m){return d.pipe(new l).pipe(new c("uncompressedSize")).pipe(f.compressWorker(m)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,a){var s=r("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},a.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,a){var s=r("./utils"),i=(function(){for(var l,c=[],u=0;u<256;u++){l=u;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;c[u]=l}return c})();n.exports=function(l,c){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?(function(u,d,f,m){var p=i,v=m+f;u^=-1;for(var b=m;b<v;b++)u=u>>>8^p[255&(u^d[b])];return-1^u})(0|c,l,l.length,0):(function(u,d,f,m){var p=i,v=m+f;u^=-1;for(var b=m;b<v;b++)u=u>>>8^p[255&(u^d.charCodeAt(b))];return-1^u})(0|c,l,l.length,0):0}},{"./utils":32}],5:[function(r,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(r,n,a){var s=null;s=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:s}},{lie:37}],7:[function(r,n,a){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=r("pako"),l=r("./utils"),c=r("./stream/GenericWorker"),u=s?"uint8array":"array";function d(f,m){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=m,this.meta={}}a.magic="\b\0",l.inherits(d,c),d.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(u,f.data),!1)},d.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(m){f.push({data:m,meta:f.meta})}},a.compressWorker=function(f){return new d("Deflate",f)},a.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,a){function s(p,v){var b,y="";for(b=0;b<v;b++)y+=String.fromCharCode(255&p),p>>>=8;return y}function i(p,v,b,y,S,_){var N,k,j=p.file,E=p.compression,T=_!==u.utf8encode,O=l.transformTo("string",_(j.name)),R=l.transformTo("string",u.utf8encode(j.name)),H=j.comment,$=l.transformTo("string",_(H)),L=l.transformTo("string",u.utf8encode(H)),A=R.length!==j.name.length,M=L.length!==H.length,P="",I="",B="",F=j.dir,q=j.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};v&&!b||(Q.crc32=p.crc32,Q.compressedSize=p.compressedSize,Q.uncompressedSize=p.uncompressedSize);var W=0;v&&(W|=8),T||!A&&!M||(W|=2048);var G=0,J=0;F&&(G|=16),S==="UNIX"?(J=798,G|=(function(V,se){var de=V;return V||(de=se?16893:33204),(65535&de)<<16})(j.unixPermissions,F)):(J=20,G|=(function(V){return 63&(V||0)})(j.dosPermissions)),N=q.getUTCHours(),N<<=6,N|=q.getUTCMinutes(),N<<=5,N|=q.getUTCSeconds()/2,k=q.getUTCFullYear()-1980,k<<=4,k|=q.getUTCMonth()+1,k<<=5,k|=q.getUTCDate(),A&&(I=s(1,1)+s(d(O),4)+R,P+="up"+s(I.length,2)+I),M&&(B=s(1,1)+s(d($),4)+L,P+="uc"+s(B.length,2)+B);var X="";return X+=`
\0`,X+=s(W,2),X+=E.magic,X+=s(N,2),X+=s(k,2),X+=s(Q.crc32,4),X+=s(Q.compressedSize,4),X+=s(Q.uncompressedSize,4),X+=s(O.length,2),X+=s(P.length,2),{fileRecord:f.LOCAL_FILE_HEADER+X+O+P,dirRecord:f.CENTRAL_FILE_HEADER+s(J,2)+X+s($.length,2)+"\0\0\0\0"+s(G,4)+s(y,4)+O+P+$}}var l=r("../utils"),c=r("../stream/GenericWorker"),u=r("../utf8"),d=r("../crc32"),f=r("../signature");function m(p,v,b,y){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=b,this.encodeFileName=y,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(m,c),m.prototype.push=function(p){var v=p.meta.percent||0,b=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,c.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:b?(v+100*(b-y-1))/b:100}}))},m.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var v=this.streamFiles&&!p.file.dir;if(v){var b=i(p,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(p){this.accumulate=!1;var v=this.streamFiles&&!p.file.dir,b=i(p,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),v)this.push({data:(function(y){return f.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)})(p),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var p=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var b=this.bytesWritten-p,y=(function(S,_,N,k,j){var E=l.transformTo("string",j(k));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(S,2)+s(S,2)+s(_,4)+s(N,4)+s(E.length,2)+E})(this.dirRecords.length,b,p,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(p){this._sources.push(p);var v=this;return p.on("data",function(b){v.processChunk(b)}),p.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),p.on("error",function(b){v.error(b)}),this},m.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(p){var v=this._sources;if(!c.prototype.error.call(this,p))return!1;for(var b=0;b<v.length;b++)try{v[b].error(p)}catch{}return!0},m.prototype.lock=function(){c.prototype.lock.call(this);for(var p=this._sources,v=0;v<p.length;v++)p[v].lock()},n.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,a){var s=r("../compressions"),i=r("./ZipFileWorker");a.generateWorker=function(l,c,u){var d=new i(c.streamFiles,u,c.platform,c.encodeFileName),f=0;try{l.forEach(function(m,p){f++;var v=(function(_,N){var k=_||N,j=s[k];if(!j)throw new Error(k+" is not a valid compression method !");return j})(p.options.compression,c.compression),b=p.options.compressionOptions||c.compressionOptions||{},y=p.dir,S=p.date;p._compressWorker(v,b).withStreamInfo("file",{name:m,dir:y,date:S,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(d)}),d.entriesCount=f}catch(m){d.error(m)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,a){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new s;for(var l in this)typeof this[l]!="function"&&(i[l]=this[l]);return i}}(s.prototype=r("./object")).loadAsync=r("./load"),s.support=r("./support"),s.defaults=r("./defaults"),s.version="3.10.1",s.loadAsync=function(i,l){return new s().loadAsync(i,l)},s.external=r("./external"),n.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,a){var s=r("./utils"),i=r("./external"),l=r("./utf8"),c=r("./zipEntries"),u=r("./stream/Crc32Probe"),d=r("./nodejsUtils");function f(m){return new i.Promise(function(p,v){var b=m.decompressed.getContentWorker().pipe(new u);b.on("error",function(y){v(y)}).on("end",function(){b.streamInfo.crc32!==m.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}n.exports=function(m,p){var v=this;return p=s.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(m)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",m,!0,p.optimizedBinaryString,p.base64).then(function(b){var y=new c(p);return y.load(b),y}).then(function(b){var y=[i.Promise.resolve(b)],S=b.files;if(p.checkCRC32)for(var _=0;_<S.length;_++)y.push(f(S[_]));return i.Promise.all(y)}).then(function(b){for(var y=b.shift(),S=y.files,_=0;_<S.length;_++){var N=S[_],k=N.fileNameStr,j=s.resolve(N.fileNameStr);v.file(j,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:p.createFolders}),N.dir||(v.file(j).unsafeOriginalName=k)}return y.zipComment.length&&(v.comment=y.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,a){var s=r("../utils"),i=r("../stream/GenericWorker");function l(c,u){i.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(u)}s.inherits(l,i),l.prototype._bindStream=function(c){var u=this;(this._stream=c).pause(),c.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},l.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,a){var s=r("readable-stream").Readable;function i(l,c,u){s.call(this,c),this._helper=l;var d=this;l.on("data",function(f,m){d.push(f)||d._helper.pause(),u&&u(m)}).on("error",function(f){d.emit("error",f)}).on("end",function(){d.push(null)})}r("../utils").inherits(i,s),i.prototype._read=function(){this._helper.resume()},n.exports=i},{"../utils":32,"readable-stream":16}],14:[function(r,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,i);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,i)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var i=new Buffer(s);return i.fill(0),i},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(r,n,a){function s(j,E,T){var O,R=l.getTypeOf(E),H=l.extend(T||{},d);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(j=S(j)),H.createFolders&&(O=y(j))&&_.call(this,O,!0);var $=R==="string"&&H.binary===!1&&H.base64===!1;T&&T.binary!==void 0||(H.binary=!$),(E instanceof f&&E.uncompressedSize===0||H.dir||!E||E.length===0)&&(H.base64=!1,H.binary=!0,E="",H.compression="STORE",R="string");var L=null;L=E instanceof f||E instanceof c?E:v.isNode&&v.isStream(E)?new b(j,E):l.prepareContent(j,E,H.binary,H.optimizedBinaryString,H.base64);var A=new m(j,L,H);this.files[j]=A}var i=r("./utf8"),l=r("./utils"),c=r("./stream/GenericWorker"),u=r("./stream/StreamHelper"),d=r("./defaults"),f=r("./compressedObject"),m=r("./zipObject"),p=r("./generate"),v=r("./nodejsUtils"),b=r("./nodejs/NodejsStreamInputAdapter"),y=function(j){j.slice(-1)==="/"&&(j=j.substring(0,j.length-1));var E=j.lastIndexOf("/");return 0<E?j.substring(0,E):""},S=function(j){return j.slice(-1)!=="/"&&(j+="/"),j},_=function(j,E){return E=E!==void 0?E:d.createFolders,j=S(j),this.files[j]||s.call(this,j,null,{dir:!0,createFolders:E}),this.files[j]};function N(j){return Object.prototype.toString.call(j)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(j){var E,T,O;for(E in this.files)O=this.files[E],(T=E.slice(this.root.length,E.length))&&E.slice(0,this.root.length)===this.root&&j(T,O)},filter:function(j){var E=[];return this.forEach(function(T,O){j(T,O)&&E.push(O)}),E},file:function(j,E,T){if(arguments.length!==1)return j=this.root+j,s.call(this,j,E,T),this;if(N(j)){var O=j;return this.filter(function(H,$){return!$.dir&&O.test(H)})}var R=this.files[this.root+j];return R&&!R.dir?R:null},folder:function(j){if(!j)return this;if(N(j))return this.filter(function(R,H){return H.dir&&j.test(R)});var E=this.root+j,T=_.call(this,E),O=this.clone();return O.root=T.name,O},remove:function(j){j=this.root+j;var E=this.files[j];if(E||(j.slice(-1)!=="/"&&(j+="/"),E=this.files[j]),E&&!E.dir)delete this.files[j];else for(var T=this.filter(function(R,H){return H.name.slice(0,j.length)===j}),O=0;O<T.length;O++)delete this.files[T[O].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(j){var E,T={};try{if((T=l.extend(j||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");l.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var O=T.comment||this.comment||"";E=p.generateWorker(this,T,O)}catch(R){(E=new c("error")).error(R)}return new u(E,T.type||"string",T.mimeType)},generateAsync:function(j,E){return this.generateInternalStream(j).accumulate(E)},generateNodeStream:function(j,E){return(j=j||{}).type||(j.type="nodebuffer"),this.generateInternalStream(j).toNodejsStream(E)}};n.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,a){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,a){var s=r("./DataReader");function i(l){s.call(this,l);for(var c=0;c<this.data.length;c++)l[c]=255&l[c]}r("../utils").inherits(i,s),i.prototype.byteAt=function(l){return this.data[this.zero+l]},i.prototype.lastIndexOfSignature=function(l){for(var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===c&&this.data[m+1]===u&&this.data[m+2]===d&&this.data[m+3]===f)return m-this.zero;return-1},i.prototype.readAndCheckSignature=function(l){var c=l.charCodeAt(0),u=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),m=this.readData(4);return c===m[0]&&u===m[1]&&d===m[2]&&f===m[3]},i.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=i},{"../utils":32,"./DataReader":18}],18:[function(r,n,a){var s=r("../utils");function i(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var c,u=0;for(this.checkOffset(l),c=this.index+l-1;c>=this.index;c--)u=(u<<8)+this.byteAt(c);return this.index+=l,u},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},n.exports=i},{"../utils":32}],19:[function(r,n,a){var s=r("./Uint8ArrayReader");function i(l){s.call(this,l)}r("../utils").inherits(i,s),i.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,a){var s=r("./DataReader");function i(l){s.call(this,l)}r("../utils").inherits(i,s),i.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},i.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},i.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},i.prototype.readData=function(l){this.checkOffset(l);var c=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=i},{"../utils":32,"./DataReader":18}],21:[function(r,n,a){var s=r("./ArrayReader");function i(l){s.call(this,l)}r("../utils").inherits(i,s),i.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,c},n.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,a){var s=r("../utils"),i=r("../support"),l=r("./ArrayReader"),c=r("./StringReader"),u=r("./NodeBufferReader"),d=r("./Uint8ArrayReader");n.exports=function(f){var m=s.getTypeOf(f);return s.checkSupport(m),m!=="string"||i.uint8array?m==="nodebuffer"?new u(f):i.uint8array?new d(s.transformTo("uint8array",f)):new l(s.transformTo("array",f)):new c(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,a){var s=r("./GenericWorker"),i=r("../utils");function l(c){s.call(this,"ConvertWorker to "+c),this.destType=c}i.inherits(l,s),l.prototype.processChunk=function(c){this.push({data:i.transformTo(this.destType,c.data),meta:c.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,a){var s=r("./GenericWorker"),i=r("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(l,s),l.prototype.processChunk=function(c){this.streamInfo.crc32=i(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,a){var s=r("../utils"),i=r("./GenericWorker");function l(c){i.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(l,i),l.prototype.processChunk=function(c){if(c){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+c.data.length}i.prototype.processChunk.call(this,c)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,a){var s=r("../utils"),i=r("./GenericWorker");function l(c){i.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(d){u.dataIsReady=!0,u.data=d,u.max=d&&d.length||0,u.type=s.getTypeOf(d),u.isPaused||u._tickAndRepeat()},function(d){u.error(d)})}s.inherits(l,i),l.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,u);break;case"uint8array":c=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":c=this.data.slice(this.index,u)}return this.index=u,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,a){function s(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,l){return this._listeners[i].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,l){if(this._listeners[i])for(var c=0;c<this._listeners[i].length;c++)this._listeners[i][c].call(this,l)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var l=this;return i.on("data",function(c){l.processChunk(c)}),i.on("end",function(){l.end()}),i.on("error",function(c){l.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,l){return this.extraStreamInfo[i]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},n.exports=s},{}],29:[function(r,n,a){var s=r("../utils"),i=r("./ConvertWorker"),l=r("./GenericWorker"),c=r("../base64"),u=r("../support"),d=r("../external"),f=null;if(u.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(v,b){return new d.Promise(function(y,S){var _=[],N=v._internalType,k=v._outputType,j=v._mimeType;v.on("data",function(E,T){_.push(E),b&&b(T)}).on("error",function(E){_=[],S(E)}).on("end",function(){try{var E=(function(T,O,R){switch(T){case"blob":return s.newBlob(s.transformTo("arraybuffer",O),R);case"base64":return c.encode(O);default:return s.transformTo(T,O)}})(k,(function(T,O){var R,H=0,$=null,L=0;for(R=0;R<O.length;R++)L+=O[R].length;switch(T){case"string":return O.join("");case"array":return Array.prototype.concat.apply([],O);case"uint8array":for($=new Uint8Array(L),R=0;R<O.length;R++)$.set(O[R],H),H+=O[R].length;return $;case"nodebuffer":return Buffer.concat(O);default:throw new Error("concat : unsupported type '"+T+"'")}})(N,_),j);y(E)}catch(T){S(T)}_=[]}).resume()})}function p(v,b,y){var S=b;switch(b){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=b,this._mimeType=y,s.checkSupport(S),this._worker=v.pipe(new i(S)),v.lock()}catch(_){this._worker=new l("error"),this._worker.error(_)}}p.prototype={accumulate:function(v){return m(this,v)},on:function(v,b){var y=this;return v==="data"?this._worker.on(v,function(S){b.call(y,S.data,S.meta)}):this._worker.on(v,function(){s.delay(b,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(v){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},v)}},n.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var s=new ArrayBuffer(0);try{a.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(s),a.blob=i.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!r("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,a){for(var s=r("./utils"),i=r("./support"),l=r("./nodejsUtils"),c=r("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;u[254]=u[254]=1;function f(){c.call(this,"utf-8 decode"),this.leftOver=null}function m(){c.call(this,"utf-8 encode")}a.utf8encode=function(p){return i.nodebuffer?l.newBufferFrom(p,"utf-8"):(function(v){var b,y,S,_,N,k=v.length,j=0;for(_=0;_<k;_++)(64512&(y=v.charCodeAt(_)))==55296&&_+1<k&&(64512&(S=v.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(S-56320),_++),j+=y<128?1:y<2048?2:y<65536?3:4;for(b=i.uint8array?new Uint8Array(j):new Array(j),_=N=0;N<j;_++)(64512&(y=v.charCodeAt(_)))==55296&&_+1<k&&(64512&(S=v.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(S-56320),_++),y<128?b[N++]=y:(y<2048?b[N++]=192|y>>>6:(y<65536?b[N++]=224|y>>>12:(b[N++]=240|y>>>18,b[N++]=128|y>>>12&63),b[N++]=128|y>>>6&63),b[N++]=128|63&y);return b})(p)},a.utf8decode=function(p){return i.nodebuffer?s.transformTo("nodebuffer",p).toString("utf-8"):(function(v){var b,y,S,_,N=v.length,k=new Array(2*N);for(b=y=0;b<N;)if((S=v[b++])<128)k[y++]=S;else if(4<(_=u[S]))k[y++]=65533,b+=_-1;else{for(S&=_===2?31:_===3?15:7;1<_&&b<N;)S=S<<6|63&v[b++],_--;1<_?k[y++]=65533:S<65536?k[y++]=S:(S-=65536,k[y++]=55296|S>>10&1023,k[y++]=56320|1023&S)}return k.length!==y&&(k.subarray?k=k.subarray(0,y):k.length=y),s.applyFromCharCode(k)})(p=s.transformTo(i.uint8array?"uint8array":"array",p))},s.inherits(f,c),f.prototype.processChunk=function(p){var v=s.transformTo(i.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var b=v;(v=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),v.set(b,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var y=(function(_,N){var k;for((N=N||_.length)>_.length&&(N=_.length),k=N-1;0<=k&&(192&_[k])==128;)k--;return k<0||k===0?N:k+u[_[k]]>N?k:N})(v),S=v;y!==v.length&&(i.uint8array?(S=v.subarray(0,y),this.leftOver=v.subarray(y,v.length)):(S=v.slice(0,y),this.leftOver=v.slice(y,v.length))),this.push({data:a.utf8decode(S),meta:p.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=f,s.inherits(m,c),m.prototype.processChunk=function(p){this.push({data:a.utf8encode(p.data),meta:p.meta})},a.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,a){var s=r("./support"),i=r("./base64"),l=r("./nodejsUtils"),c=r("./external");function u(b){return b}function d(b,y){for(var S=0;S<b.length;++S)y[S]=255&b.charCodeAt(S);return y}r("setimmediate"),a.newBlob=function(b,y){a.checkSupport("blob");try{return new Blob([b],{type:y})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(b),S.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(b,y,S){var _=[],N=0,k=b.length;if(k<=S)return String.fromCharCode.apply(null,b);for(;N<k;)y==="array"||y==="nodebuffer"?_.push(String.fromCharCode.apply(null,b.slice(N,Math.min(N+S,k)))):_.push(String.fromCharCode.apply(null,b.subarray(N,Math.min(N+S,k)))),N+=S;return _.join("")},stringifyByChar:function(b){for(var y="",S=0;S<b.length;S++)y+=String.fromCharCode(b[S]);return y},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}})()}};function m(b){var y=65536,S=a.getTypeOf(b),_=!0;if(S==="uint8array"?_=f.applyCanBeUsed.uint8array:S==="nodebuffer"&&(_=f.applyCanBeUsed.nodebuffer),_)for(;1<y;)try{return f.stringifyByChunk(b,S,y)}catch{y=Math.floor(y/2)}return f.stringifyByChar(b)}function p(b,y){for(var S=0;S<b.length;S++)y[S]=b[S];return y}a.applyFromCharCode=m;var v={};v.string={string:u,array:function(b){return d(b,new Array(b.length))},arraybuffer:function(b){return v.string.uint8array(b).buffer},uint8array:function(b){return d(b,new Uint8Array(b.length))},nodebuffer:function(b){return d(b,l.allocBuffer(b.length))}},v.array={string:m,array:u,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return l.newBufferFrom(b)}},v.arraybuffer={string:function(b){return m(new Uint8Array(b))},array:function(b){return p(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:u,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return l.newBufferFrom(new Uint8Array(b))}},v.uint8array={string:m,array:function(b){return p(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:u,nodebuffer:function(b){return l.newBufferFrom(b)}},v.nodebuffer={string:m,array:function(b){return p(b,new Array(b.length))},arraybuffer:function(b){return v.nodebuffer.uint8array(b).buffer},uint8array:function(b){return p(b,new Uint8Array(b.length))},nodebuffer:u},a.transformTo=function(b,y){if(y=y||"",!b)return y;a.checkSupport(b);var S=a.getTypeOf(y);return v[S][b](y)},a.resolve=function(b){for(var y=b.split("/"),S=[],_=0;_<y.length;_++){var N=y[_];N==="."||N===""&&_!==0&&_!==y.length-1||(N===".."?S.pop():S.push(N))}return S.join("/")},a.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(b)?"nodebuffer":s.uint8array&&b instanceof Uint8Array?"uint8array":s.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(b){if(!s[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(b){var y,S,_="";for(S=0;S<(b||"").length;S++)_+="\\x"+((y=b.charCodeAt(S))<16?"0":"")+y.toString(16).toUpperCase();return _},a.delay=function(b,y,S){setImmediate(function(){b.apply(S||null,y||[])})},a.inherits=function(b,y){function S(){}S.prototype=y.prototype,b.prototype=new S},a.extend=function(){var b,y,S={};for(b=0;b<arguments.length;b++)for(y in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],y)&&S[y]===void 0&&(S[y]=arguments[b][y]);return S},a.prepareContent=function(b,y,S,_,N){return c.Promise.resolve(y).then(function(k){return s.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new c.Promise(function(j,E){var T=new FileReader;T.onload=function(O){j(O.target.result)},T.onerror=function(O){E(O.target.error)},T.readAsArrayBuffer(k)}):k}).then(function(k){var j=a.getTypeOf(k);return j?(j==="arraybuffer"?k=a.transformTo("uint8array",k):j==="string"&&(N?k=i.decode(k):S&&_!==!0&&(k=(function(E){return d(E,s.uint8array?new Uint8Array(E.length):new Array(E.length))})(k))),k):c.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,a){var s=r("./reader/readerFor"),i=r("./utils"),l=r("./signature"),c=r("./zipEntry"),u=r("./support");function d(f){this.files=[],this.loadOptions=f}d.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(m)+", expected "+i.pretty(f)+")")}},isSignature:function(f,m){var p=this.reader.index;this.reader.setIndex(f);var v=this.reader.readString(4)===m;return this.reader.setIndex(p),v},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),m=u.uint8array?"uint8array":"array",p=i.transformTo(m,f);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,m,p,v=this.zip64EndOfCentralSize-44;0<v;)f=this.reader.readInt(2),m=this.reader.readInt(4),p=this.reader.readData(m),this.zip64ExtensibleData[f]={id:f,length:m,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,m;for(f=0;f<this.files.length;f++)m=this.files[f],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(f=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var m=f;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var v=m-p;if(0<v)this.isSignature(m,l.CENTRAL_FILE_HEADER)||(this.reader.zero=v);else if(v<0)throw new Error("Corrupted zip: missing "+Math.abs(v)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,a){var s=r("./reader/readerFor"),i=r("./utils"),l=r("./compressedObject"),c=r("./crc32"),u=r("./utf8"),d=r("./compressions"),f=r("./support");function m(p,v){this.options=p,this.loadOptions=v}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var v,b;if(p.skip(22),this.fileNameLength=p.readInt(2),b=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((v=(function(y){for(var S in d)if(Object.prototype.hasOwnProperty.call(d,S)&&d[S].magic===y)return d[S];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,v,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var v=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(v),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=s(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var v,b,y,S=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<S;)v=p.readInt(2),b=p.readInt(2),y=p.readData(b),this.extraFields[v]={id:v,length:b,value:y};p.setIndex(S)},handleUTF8:function(){var p=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var b=i.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var S=i.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var v=s(p.value);return v.readInt(1)!==1||c(this.fileName)!==v.readInt(4)?null:u.utf8decode(v.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var v=s(p.value);return v.readInt(1)!==1||c(this.fileComment)!==v.readInt(4)?null:u.utf8decode(v.readData(p.length-5))}return null}},n.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,a){function s(v,b,y){this.name=v,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=b,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var i=r("./stream/StreamHelper"),l=r("./stream/DataWorker"),c=r("./utf8"),u=r("./compressedObject"),d=r("./stream/GenericWorker");s.prototype={internalStream:function(v){var b=null,y="string";try{if(!v)throw new Error("No output type specified.");var S=(y=v.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),b=this._decompressWorker();var _=!this._dataBinary;_&&!S&&(b=b.pipe(new c.Utf8EncodeWorker)),!_&&S&&(b=b.pipe(new c.Utf8DecodeWorker))}catch(N){(b=new d("error")).error(N)}return new i(b,y,"")},async:function(v,b){return this.internalStream(v).accumulate(b)},nodeStream:function(v,b){return this.internalStream(v||"nodebuffer").toNodejsStream(b)},_compressWorker:function(v,b){if(this._data instanceof u&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new c.Utf8EncodeWorker)),u.createWorkerFrom(y,v,b)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<f.length;p++)s.prototype[f[p]]=m;n.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,a){(function(s){var i,l,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var u=0,d=new c(v),f=s.document.createTextNode("");d.observe(f,{characterData:!0}),i=function(){f.data=u=++u%2}}else if(s.setImmediate||s.MessageChannel===void 0)i="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var b=s.document.createElement("script");b.onreadystatechange=function(){v(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},s.document.documentElement.appendChild(b)}:function(){setTimeout(v,0)};else{var m=new s.MessageChannel;m.port1.onmessage=v,i=function(){m.port2.postMessage(0)}}var p=[];function v(){var b,y;l=!0;for(var S=p.length;S;){for(y=p,p=[],b=-1;++b<S;)y[b]();S=p.length}l=!1}n.exports=function(b){p.push(b)!==1||l||i()}}).call(this,typeof gd<"u"?gd:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,a){var s=r("immediate");function i(){}var l={},c=["REJECTED"],u=["FULFILLED"],d=["PENDING"];function f(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==i&&b(this,S)}function m(S,_,N){this.promise=S,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function p(S,_,N){s(function(){var k;try{k=_(N)}catch(j){return l.reject(S,j)}k===S?l.reject(S,new TypeError("Cannot resolve promise with itself")):l.resolve(S,k)})}function v(S){var _=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof _=="function")return function(){_.apply(S,arguments)}}function b(S,_){var N=!1;function k(T){N||(N=!0,l.reject(S,T))}function j(T){N||(N=!0,l.resolve(S,T))}var E=y(function(){_(j,k)});E.status==="error"&&k(E.value)}function y(S,_){var N={};try{N.value=S(_),N.status="success"}catch(k){N.status="error",N.value=k}return N}(n.exports=f).prototype.finally=function(S){if(typeof S!="function")return this;var _=this.constructor;return this.then(function(N){return _.resolve(S()).then(function(){return N})},function(N){return _.resolve(S()).then(function(){throw N})})},f.prototype.catch=function(S){return this.then(null,S)},f.prototype.then=function(S,_){if(typeof S!="function"&&this.state===u||typeof _!="function"&&this.state===c)return this;var N=new this.constructor(i);return this.state!==d?p(N,this.state===u?S:_,this.outcome):this.queue.push(new m(N,S,_)),N},m.prototype.callFulfilled=function(S){l.resolve(this.promise,S)},m.prototype.otherCallFulfilled=function(S){p(this.promise,this.onFulfilled,S)},m.prototype.callRejected=function(S){l.reject(this.promise,S)},m.prototype.otherCallRejected=function(S){p(this.promise,this.onRejected,S)},l.resolve=function(S,_){var N=y(v,_);if(N.status==="error")return l.reject(S,N.value);var k=N.value;if(k)b(S,k);else{S.state=u,S.outcome=_;for(var j=-1,E=S.queue.length;++j<E;)S.queue[j].callFulfilled(_)}return S},l.reject=function(S,_){S.state=c,S.outcome=_;for(var N=-1,k=S.queue.length;++N<k;)S.queue[N].callRejected(_);return S},f.resolve=function(S){return S instanceof this?S:l.resolve(new this(i),S)},f.reject=function(S){var _=new this(i);return l.reject(_,S)},f.all=function(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=S.length,k=!1;if(!N)return this.resolve([]);for(var j=new Array(N),E=0,T=-1,O=new this(i);++T<N;)R(S[T],T);return O;function R(H,$){_.resolve(H).then(function(L){j[$]=L,++E!==N||k||(k=!0,l.resolve(O,j))},function(L){k||(k=!0,l.reject(O,L))})}},f.race=function(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=S.length,k=!1;if(!N)return this.resolve([]);for(var j=-1,E=new this(i);++j<N;)T=S[j],_.resolve(T).then(function(O){k||(k=!0,l.resolve(E,O))},function(O){k||(k=!0,l.reject(E,O))});var T;return E}},{immediate:36}],38:[function(r,n,a){var s={};(0,r("./lib/utils/common").assign)(s,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,a){var s=r("./zlib/deflate"),i=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/messages"),u=r("./zlib/zstream"),d=Object.prototype.toString,f=0,m=-1,p=0,v=8;function b(S){if(!(this instanceof b))return new b(S);this.options=i.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},S||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var N=s.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(N!==f)throw new Error(c[N]);if(_.header&&s.deflateSetHeader(this.strm,_.header),_.dictionary){var k;if(k=typeof _.dictionary=="string"?l.string2buf(_.dictionary):d.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(N=s.deflateSetDictionary(this.strm,k))!==f)throw new Error(c[N]);this._dict_set=!0}}function y(S,_){var N=new b(_);if(N.push(S,!0),N.err)throw N.msg||c[N.err];return N.result}b.prototype.push=function(S,_){var N,k,j=this.strm,E=this.options.chunkSize;if(this.ended)return!1;k=_===~~_?_:_===!0?4:0,typeof S=="string"?j.input=l.string2buf(S):d.call(S)==="[object ArrayBuffer]"?j.input=new Uint8Array(S):j.input=S,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new i.Buf8(E),j.next_out=0,j.avail_out=E),(N=s.deflate(j,k))!==1&&N!==f)return this.onEnd(N),!(this.ended=!0);j.avail_out!==0&&(j.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(i.shrinkBuf(j.output,j.next_out))):this.onData(i.shrinkBuf(j.output,j.next_out)))}while((0<j.avail_in||j.avail_out===0)&&N!==1);return k===4?(N=s.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===f):k!==2||(this.onEnd(f),!(j.avail_out=0))},b.prototype.onData=function(S){this.chunks.push(S)},b.prototype.onEnd=function(S){S===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},a.Deflate=b,a.deflate=y,a.deflateRaw=function(S,_){return(_=_||{}).raw=!0,y(S,_)},a.gzip=function(S,_){return(_=_||{}).gzip=!0,y(S,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,a){var s=r("./zlib/inflate"),i=r("./utils/common"),l=r("./utils/strings"),c=r("./zlib/constants"),u=r("./zlib/messages"),d=r("./zlib/zstream"),f=r("./zlib/gzheader"),m=Object.prototype.toString;function p(b){if(!(this instanceof p))return new p(b);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},b||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||b&&b.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var S=s.inflateInit2(this.strm,y.windowBits);if(S!==c.Z_OK)throw new Error(u[S]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function v(b,y){var S=new p(y);if(S.push(b,!0),S.err)throw S.msg||u[S.err];return S.result}p.prototype.push=function(b,y){var S,_,N,k,j,E,T=this.strm,O=this.options.chunkSize,R=this.options.dictionary,H=!1;if(this.ended)return!1;_=y===~~y?y:y===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof b=="string"?T.input=l.binstring2buf(b):m.call(b)==="[object ArrayBuffer]"?T.input=new Uint8Array(b):T.input=b,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new i.Buf8(O),T.next_out=0,T.avail_out=O),(S=s.inflate(T,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&R&&(E=typeof R=="string"?l.string2buf(R):m.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,S=s.inflateSetDictionary(this.strm,E)),S===c.Z_BUF_ERROR&&H===!0&&(S=c.Z_OK,H=!1),S!==c.Z_STREAM_END&&S!==c.Z_OK)return this.onEnd(S),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&S!==c.Z_STREAM_END&&(T.avail_in!==0||_!==c.Z_FINISH&&_!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=l.utf8border(T.output,T.next_out),k=T.next_out-N,j=l.buf2string(T.output,N),T.next_out=k,T.avail_out=O-k,k&&i.arraySet(T.output,T.output,N,k,0),this.onData(j)):this.onData(i.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(H=!0)}while((0<T.avail_in||T.avail_out===0)&&S!==c.Z_STREAM_END);return S===c.Z_STREAM_END&&(_=c.Z_FINISH),_===c.Z_FINISH?(S=s.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===c.Z_OK):_!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(T.avail_out=0))},p.prototype.onData=function(b){this.chunks.push(b)},p.prototype.onEnd=function(b){b===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},a.Inflate=p,a.inflate=v,a.inflateRaw=function(b,y){return(y=y||{}).raw=!0,v(b,y)},a.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,a){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(c){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])}}return c},a.shrinkBuf=function(c,u){return c.length===u?c:c.subarray?c.subarray(0,u):(c.length=u,c)};var i={arraySet:function(c,u,d,f,m){if(u.subarray&&c.subarray)c.set(u.subarray(d,d+f),m);else for(var p=0;p<f;p++)c[m+p]=u[d+p]},flattenChunks:function(c){var u,d,f,m,p,v;for(u=f=0,d=c.length;u<d;u++)f+=c[u].length;for(v=new Uint8Array(f),u=m=0,d=c.length;u<d;u++)p=c[u],v.set(p,m),m+=p.length;return v}},l={arraySet:function(c,u,d,f,m){for(var p=0;p<f;p++)c[m+p]=u[d+p]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,i)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,l))},a.setTyped(s)},{}],42:[function(r,n,a){var s=r("./common"),i=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var c=new s.Buf8(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function d(f,m){if(m<65537&&(f.subarray&&l||!f.subarray&&i))return String.fromCharCode.apply(null,s.shrinkBuf(f,m));for(var p="",v=0;v<m;v++)p+=String.fromCharCode(f[v]);return p}c[254]=c[254]=1,a.string2buf=function(f){var m,p,v,b,y,S=f.length,_=0;for(b=0;b<S;b++)(64512&(p=f.charCodeAt(b)))==55296&&b+1<S&&(64512&(v=f.charCodeAt(b+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),b++),_+=p<128?1:p<2048?2:p<65536?3:4;for(m=new s.Buf8(_),b=y=0;y<_;b++)(64512&(p=f.charCodeAt(b)))==55296&&b+1<S&&(64512&(v=f.charCodeAt(b+1)))==56320&&(p=65536+(p-55296<<10)+(v-56320),b++),p<128?m[y++]=p:(p<2048?m[y++]=192|p>>>6:(p<65536?m[y++]=224|p>>>12:(m[y++]=240|p>>>18,m[y++]=128|p>>>12&63),m[y++]=128|p>>>6&63),m[y++]=128|63&p);return m},a.buf2binstring=function(f){return d(f,f.length)},a.binstring2buf=function(f){for(var m=new s.Buf8(f.length),p=0,v=m.length;p<v;p++)m[p]=f.charCodeAt(p);return m},a.buf2string=function(f,m){var p,v,b,y,S=m||f.length,_=new Array(2*S);for(p=v=0;p<S;)if((b=f[p++])<128)_[v++]=b;else if(4<(y=c[b]))_[v++]=65533,p+=y-1;else{for(b&=y===2?31:y===3?15:7;1<y&&p<S;)b=b<<6|63&f[p++],y--;1<y?_[v++]=65533:b<65536?_[v++]=b:(b-=65536,_[v++]=55296|b>>10&1023,_[v++]=56320|1023&b)}return d(_,v)},a.utf8border=function(f,m){var p;for((m=m||f.length)>f.length&&(m=f.length),p=m-1;0<=p&&(192&f[p])==128;)p--;return p<0||p===0?m:p+c[f[p]]>m?p:m}},{"./common":41}],43:[function(r,n,a){n.exports=function(s,i,l,c){for(var u=65535&s|0,d=s>>>16&65535|0,f=0;l!==0;){for(l-=f=2e3<l?2e3:l;d=d+(u=u+i[c++]|0)|0,--f;);u%=65521,d%=65521}return u|d<<16|0}},{}],44:[function(r,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,a){var s=(function(){for(var i,l=[],c=0;c<256;c++){i=c;for(var u=0;u<8;u++)i=1&i?3988292384^i>>>1:i>>>1;l[c]=i}return l})();n.exports=function(i,l,c,u){var d=s,f=u+c;i^=-1;for(var m=u;m<f;m++)i=i>>>8^d[255&(i^l[m])];return-1^i}},{}],46:[function(r,n,a){var s,i=r("../utils/common"),l=r("./trees"),c=r("./adler32"),u=r("./crc32"),d=r("./messages"),f=0,m=4,p=0,v=-2,b=-1,y=4,S=2,_=8,N=9,k=286,j=30,E=19,T=2*k+1,O=15,R=3,H=258,$=H+R+1,L=42,A=113,M=1,P=2,I=3,B=4;function F(U,ge){return U.msg=d[ge],ge}function q(U){return(U<<1)-(4<U?9:0)}function Q(U){for(var ge=U.length;0<=--ge;)U[ge]=0}function W(U){var ge=U.state,ue=ge.pending;ue>U.avail_out&&(ue=U.avail_out),ue!==0&&(i.arraySet(U.output,ge.pending_buf,ge.pending_out,ue,U.next_out),U.next_out+=ue,ge.pending_out+=ue,U.total_out+=ue,U.avail_out-=ue,ge.pending-=ue,ge.pending===0&&(ge.pending_out=0))}function G(U,ge){l._tr_flush_block(U,0<=U.block_start?U.block_start:-1,U.strstart-U.block_start,ge),U.block_start=U.strstart,W(U.strm)}function J(U,ge){U.pending_buf[U.pending++]=ge}function X(U,ge){U.pending_buf[U.pending++]=ge>>>8&255,U.pending_buf[U.pending++]=255&ge}function V(U,ge){var ue,re,ne=U.max_chain_length,me=U.strstart,ke=U.prev_length,we=U.nice_match,pe=U.strstart>U.w_size-$?U.strstart-(U.w_size-$):0,Oe=U.window,Ae=U.w_mask,Re=U.prev,Ve=U.strstart+H,gt=Oe[me+ke-1],lt=Oe[me+ke];U.prev_length>=U.good_match&&(ne>>=2),we>U.lookahead&&(we=U.lookahead);do if(Oe[(ue=ge)+ke]===lt&&Oe[ue+ke-1]===gt&&Oe[ue]===Oe[me]&&Oe[++ue]===Oe[me+1]){me+=2,ue++;do;while(Oe[++me]===Oe[++ue]&&Oe[++me]===Oe[++ue]&&Oe[++me]===Oe[++ue]&&Oe[++me]===Oe[++ue]&&Oe[++me]===Oe[++ue]&&Oe[++me]===Oe[++ue]&&Oe[++me]===Oe[++ue]&&Oe[++me]===Oe[++ue]&&me<Ve);if(re=H-(Ve-me),me=Ve-H,ke<re){if(U.match_start=ge,we<=(ke=re))break;gt=Oe[me+ke-1],lt=Oe[me+ke]}}while((ge=Re[ge&Ae])>pe&&--ne!=0);return ke<=U.lookahead?ke:U.lookahead}function se(U){var ge,ue,re,ne,me,ke,we,pe,Oe,Ae,Re=U.w_size;do{if(ne=U.window_size-U.lookahead-U.strstart,U.strstart>=Re+(Re-$)){for(i.arraySet(U.window,U.window,Re,Re,0),U.match_start-=Re,U.strstart-=Re,U.block_start-=Re,ge=ue=U.hash_size;re=U.head[--ge],U.head[ge]=Re<=re?re-Re:0,--ue;);for(ge=ue=Re;re=U.prev[--ge],U.prev[ge]=Re<=re?re-Re:0,--ue;);ne+=Re}if(U.strm.avail_in===0)break;if(ke=U.strm,we=U.window,pe=U.strstart+U.lookahead,Oe=ne,Ae=void 0,Ae=ke.avail_in,Oe<Ae&&(Ae=Oe),ue=Ae===0?0:(ke.avail_in-=Ae,i.arraySet(we,ke.input,ke.next_in,Ae,pe),ke.state.wrap===1?ke.adler=c(ke.adler,we,Ae,pe):ke.state.wrap===2&&(ke.adler=u(ke.adler,we,Ae,pe)),ke.next_in+=Ae,ke.total_in+=Ae,Ae),U.lookahead+=ue,U.lookahead+U.insert>=R)for(me=U.strstart-U.insert,U.ins_h=U.window[me],U.ins_h=(U.ins_h<<U.hash_shift^U.window[me+1])&U.hash_mask;U.insert&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[me+R-1])&U.hash_mask,U.prev[me&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=me,me++,U.insert--,!(U.lookahead+U.insert<R)););}while(U.lookahead<$&&U.strm.avail_in!==0)}function de(U,ge){for(var ue,re;;){if(U.lookahead<$){if(se(U),U.lookahead<$&&ge===f)return M;if(U.lookahead===0)break}if(ue=0,U.lookahead>=R&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+R-1])&U.hash_mask,ue=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),ue!==0&&U.strstart-ue<=U.w_size-$&&(U.match_length=V(U,ue)),U.match_length>=R)if(re=l._tr_tally(U,U.strstart-U.match_start,U.match_length-R),U.lookahead-=U.match_length,U.match_length<=U.max_lazy_match&&U.lookahead>=R){for(U.match_length--;U.strstart++,U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+R-1])&U.hash_mask,ue=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart,--U.match_length!=0;);U.strstart++}else U.strstart+=U.match_length,U.match_length=0,U.ins_h=U.window[U.strstart],U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+1])&U.hash_mask;else re=l._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++;if(re&&(G(U,!1),U.strm.avail_out===0))return M}return U.insert=U.strstart<R-1?U.strstart:R-1,ge===m?(G(U,!0),U.strm.avail_out===0?I:B):U.last_lit&&(G(U,!1),U.strm.avail_out===0)?M:P}function he(U,ge){for(var ue,re,ne;;){if(U.lookahead<$){if(se(U),U.lookahead<$&&ge===f)return M;if(U.lookahead===0)break}if(ue=0,U.lookahead>=R&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+R-1])&U.hash_mask,ue=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),U.prev_length=U.match_length,U.prev_match=U.match_start,U.match_length=R-1,ue!==0&&U.prev_length<U.max_lazy_match&&U.strstart-ue<=U.w_size-$&&(U.match_length=V(U,ue),U.match_length<=5&&(U.strategy===1||U.match_length===R&&4096<U.strstart-U.match_start)&&(U.match_length=R-1)),U.prev_length>=R&&U.match_length<=U.prev_length){for(ne=U.strstart+U.lookahead-R,re=l._tr_tally(U,U.strstart-1-U.prev_match,U.prev_length-R),U.lookahead-=U.prev_length-1,U.prev_length-=2;++U.strstart<=ne&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+R-1])&U.hash_mask,ue=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),--U.prev_length!=0;);if(U.match_available=0,U.match_length=R-1,U.strstart++,re&&(G(U,!1),U.strm.avail_out===0))return M}else if(U.match_available){if((re=l._tr_tally(U,0,U.window[U.strstart-1]))&&G(U,!1),U.strstart++,U.lookahead--,U.strm.avail_out===0)return M}else U.match_available=1,U.strstart++,U.lookahead--}return U.match_available&&(re=l._tr_tally(U,0,U.window[U.strstart-1]),U.match_available=0),U.insert=U.strstart<R-1?U.strstart:R-1,ge===m?(G(U,!0),U.strm.avail_out===0?I:B):U.last_lit&&(G(U,!1),U.strm.avail_out===0)?M:P}function te(U,ge,ue,re,ne){this.good_length=U,this.max_lazy=ge,this.nice_length=ue,this.max_chain=re,this.func=ne}function le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*T),this.dyn_dtree=new i.Buf16(2*(2*j+1)),this.bl_tree=new i.Buf16(2*(2*E+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(O+1),this.heap=new i.Buf16(2*k+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*k+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function oe(U){var ge;return U&&U.state?(U.total_in=U.total_out=0,U.data_type=S,(ge=U.state).pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?L:A,U.adler=ge.wrap===2?0:1,ge.last_flush=f,l._tr_init(ge),p):F(U,v)}function Z(U){var ge=oe(U);return ge===p&&(function(ue){ue.window_size=2*ue.w_size,Q(ue.head),ue.max_lazy_match=s[ue.level].max_lazy,ue.good_match=s[ue.level].good_length,ue.nice_match=s[ue.level].nice_length,ue.max_chain_length=s[ue.level].max_chain,ue.strstart=0,ue.block_start=0,ue.lookahead=0,ue.insert=0,ue.match_length=ue.prev_length=R-1,ue.match_available=0,ue.ins_h=0})(U.state),ge}function ve(U,ge,ue,re,ne,me){if(!U)return v;var ke=1;if(ge===b&&(ge=6),re<0?(ke=0,re=-re):15<re&&(ke=2,re-=16),ne<1||N<ne||ue!==_||re<8||15<re||ge<0||9<ge||me<0||y<me)return F(U,v);re===8&&(re=9);var we=new le;return(U.state=we).strm=U,we.wrap=ke,we.gzhead=null,we.w_bits=re,we.w_size=1<<we.w_bits,we.w_mask=we.w_size-1,we.hash_bits=ne+7,we.hash_size=1<<we.hash_bits,we.hash_mask=we.hash_size-1,we.hash_shift=~~((we.hash_bits+R-1)/R),we.window=new i.Buf8(2*we.w_size),we.head=new i.Buf16(we.hash_size),we.prev=new i.Buf16(we.w_size),we.lit_bufsize=1<<ne+6,we.pending_buf_size=4*we.lit_bufsize,we.pending_buf=new i.Buf8(we.pending_buf_size),we.d_buf=1*we.lit_bufsize,we.l_buf=3*we.lit_bufsize,we.level=ge,we.strategy=me,we.method=ue,Z(U)}s=[new te(0,0,0,0,function(U,ge){var ue=65535;for(ue>U.pending_buf_size-5&&(ue=U.pending_buf_size-5);;){if(U.lookahead<=1){if(se(U),U.lookahead===0&&ge===f)return M;if(U.lookahead===0)break}U.strstart+=U.lookahead,U.lookahead=0;var re=U.block_start+ue;if((U.strstart===0||U.strstart>=re)&&(U.lookahead=U.strstart-re,U.strstart=re,G(U,!1),U.strm.avail_out===0)||U.strstart-U.block_start>=U.w_size-$&&(G(U,!1),U.strm.avail_out===0))return M}return U.insert=0,ge===m?(G(U,!0),U.strm.avail_out===0?I:B):(U.strstart>U.block_start&&(G(U,!1),U.strm.avail_out),M)}),new te(4,4,8,4,de),new te(4,5,16,8,de),new te(4,6,32,32,de),new te(4,4,16,16,he),new te(8,16,32,32,he),new te(8,16,128,128,he),new te(8,32,128,256,he),new te(32,128,258,1024,he),new te(32,258,258,4096,he)],a.deflateInit=function(U,ge){return ve(U,ge,_,15,8,0)},a.deflateInit2=ve,a.deflateReset=Z,a.deflateResetKeep=oe,a.deflateSetHeader=function(U,ge){return U&&U.state?U.state.wrap!==2?v:(U.state.gzhead=ge,p):v},a.deflate=function(U,ge){var ue,re,ne,me;if(!U||!U.state||5<ge||ge<0)return U?F(U,v):v;if(re=U.state,!U.output||!U.input&&U.avail_in!==0||re.status===666&&ge!==m)return F(U,U.avail_out===0?-5:v);if(re.strm=U,ue=re.last_flush,re.last_flush=ge,re.status===L)if(re.wrap===2)U.adler=0,J(re,31),J(re,139),J(re,8),re.gzhead?(J(re,(re.gzhead.text?1:0)+(re.gzhead.hcrc?2:0)+(re.gzhead.extra?4:0)+(re.gzhead.name?8:0)+(re.gzhead.comment?16:0)),J(re,255&re.gzhead.time),J(re,re.gzhead.time>>8&255),J(re,re.gzhead.time>>16&255),J(re,re.gzhead.time>>24&255),J(re,re.level===9?2:2<=re.strategy||re.level<2?4:0),J(re,255&re.gzhead.os),re.gzhead.extra&&re.gzhead.extra.length&&(J(re,255&re.gzhead.extra.length),J(re,re.gzhead.extra.length>>8&255)),re.gzhead.hcrc&&(U.adler=u(U.adler,re.pending_buf,re.pending,0)),re.gzindex=0,re.status=69):(J(re,0),J(re,0),J(re,0),J(re,0),J(re,0),J(re,re.level===9?2:2<=re.strategy||re.level<2?4:0),J(re,3),re.status=A);else{var ke=_+(re.w_bits-8<<4)<<8;ke|=(2<=re.strategy||re.level<2?0:re.level<6?1:re.level===6?2:3)<<6,re.strstart!==0&&(ke|=32),ke+=31-ke%31,re.status=A,X(re,ke),re.strstart!==0&&(X(re,U.adler>>>16),X(re,65535&U.adler)),U.adler=1}if(re.status===69)if(re.gzhead.extra){for(ne=re.pending;re.gzindex<(65535&re.gzhead.extra.length)&&(re.pending!==re.pending_buf_size||(re.gzhead.hcrc&&re.pending>ne&&(U.adler=u(U.adler,re.pending_buf,re.pending-ne,ne)),W(U),ne=re.pending,re.pending!==re.pending_buf_size));)J(re,255&re.gzhead.extra[re.gzindex]),re.gzindex++;re.gzhead.hcrc&&re.pending>ne&&(U.adler=u(U.adler,re.pending_buf,re.pending-ne,ne)),re.gzindex===re.gzhead.extra.length&&(re.gzindex=0,re.status=73)}else re.status=73;if(re.status===73)if(re.gzhead.name){ne=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ne&&(U.adler=u(U.adler,re.pending_buf,re.pending-ne,ne)),W(U),ne=re.pending,re.pending===re.pending_buf_size)){me=1;break}me=re.gzindex<re.gzhead.name.length?255&re.gzhead.name.charCodeAt(re.gzindex++):0,J(re,me)}while(me!==0);re.gzhead.hcrc&&re.pending>ne&&(U.adler=u(U.adler,re.pending_buf,re.pending-ne,ne)),me===0&&(re.gzindex=0,re.status=91)}else re.status=91;if(re.status===91)if(re.gzhead.comment){ne=re.pending;do{if(re.pending===re.pending_buf_size&&(re.gzhead.hcrc&&re.pending>ne&&(U.adler=u(U.adler,re.pending_buf,re.pending-ne,ne)),W(U),ne=re.pending,re.pending===re.pending_buf_size)){me=1;break}me=re.gzindex<re.gzhead.comment.length?255&re.gzhead.comment.charCodeAt(re.gzindex++):0,J(re,me)}while(me!==0);re.gzhead.hcrc&&re.pending>ne&&(U.adler=u(U.adler,re.pending_buf,re.pending-ne,ne)),me===0&&(re.status=103)}else re.status=103;if(re.status===103&&(re.gzhead.hcrc?(re.pending+2>re.pending_buf_size&&W(U),re.pending+2<=re.pending_buf_size&&(J(re,255&U.adler),J(re,U.adler>>8&255),U.adler=0,re.status=A)):re.status=A),re.pending!==0){if(W(U),U.avail_out===0)return re.last_flush=-1,p}else if(U.avail_in===0&&q(ge)<=q(ue)&&ge!==m)return F(U,-5);if(re.status===666&&U.avail_in!==0)return F(U,-5);if(U.avail_in!==0||re.lookahead!==0||ge!==f&&re.status!==666){var we=re.strategy===2?(function(pe,Oe){for(var Ae;;){if(pe.lookahead===0&&(se(pe),pe.lookahead===0)){if(Oe===f)return M;break}if(pe.match_length=0,Ae=l._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++,Ae&&(G(pe,!1),pe.strm.avail_out===0))return M}return pe.insert=0,Oe===m?(G(pe,!0),pe.strm.avail_out===0?I:B):pe.last_lit&&(G(pe,!1),pe.strm.avail_out===0)?M:P})(re,ge):re.strategy===3?(function(pe,Oe){for(var Ae,Re,Ve,gt,lt=pe.window;;){if(pe.lookahead<=H){if(se(pe),pe.lookahead<=H&&Oe===f)return M;if(pe.lookahead===0)break}if(pe.match_length=0,pe.lookahead>=R&&0<pe.strstart&&(Re=lt[Ve=pe.strstart-1])===lt[++Ve]&&Re===lt[++Ve]&&Re===lt[++Ve]){gt=pe.strstart+H;do;while(Re===lt[++Ve]&&Re===lt[++Ve]&&Re===lt[++Ve]&&Re===lt[++Ve]&&Re===lt[++Ve]&&Re===lt[++Ve]&&Re===lt[++Ve]&&Re===lt[++Ve]&&Ve<gt);pe.match_length=H-(gt-Ve),pe.match_length>pe.lookahead&&(pe.match_length=pe.lookahead)}if(pe.match_length>=R?(Ae=l._tr_tally(pe,1,pe.match_length-R),pe.lookahead-=pe.match_length,pe.strstart+=pe.match_length,pe.match_length=0):(Ae=l._tr_tally(pe,0,pe.window[pe.strstart]),pe.lookahead--,pe.strstart++),Ae&&(G(pe,!1),pe.strm.avail_out===0))return M}return pe.insert=0,Oe===m?(G(pe,!0),pe.strm.avail_out===0?I:B):pe.last_lit&&(G(pe,!1),pe.strm.avail_out===0)?M:P})(re,ge):s[re.level].func(re,ge);if(we!==I&&we!==B||(re.status=666),we===M||we===I)return U.avail_out===0&&(re.last_flush=-1),p;if(we===P&&(ge===1?l._tr_align(re):ge!==5&&(l._tr_stored_block(re,0,0,!1),ge===3&&(Q(re.head),re.lookahead===0&&(re.strstart=0,re.block_start=0,re.insert=0))),W(U),U.avail_out===0))return re.last_flush=-1,p}return ge!==m?p:re.wrap<=0?1:(re.wrap===2?(J(re,255&U.adler),J(re,U.adler>>8&255),J(re,U.adler>>16&255),J(re,U.adler>>24&255),J(re,255&U.total_in),J(re,U.total_in>>8&255),J(re,U.total_in>>16&255),J(re,U.total_in>>24&255)):(X(re,U.adler>>>16),X(re,65535&U.adler)),W(U),0<re.wrap&&(re.wrap=-re.wrap),re.pending!==0?p:1)},a.deflateEnd=function(U){var ge;return U&&U.state?(ge=U.state.status)!==L&&ge!==69&&ge!==73&&ge!==91&&ge!==103&&ge!==A&&ge!==666?F(U,v):(U.state=null,ge===A?F(U,-3):p):v},a.deflateSetDictionary=function(U,ge){var ue,re,ne,me,ke,we,pe,Oe,Ae=ge.length;if(!U||!U.state||(me=(ue=U.state).wrap)===2||me===1&&ue.status!==L||ue.lookahead)return v;for(me===1&&(U.adler=c(U.adler,ge,Ae,0)),ue.wrap=0,Ae>=ue.w_size&&(me===0&&(Q(ue.head),ue.strstart=0,ue.block_start=0,ue.insert=0),Oe=new i.Buf8(ue.w_size),i.arraySet(Oe,ge,Ae-ue.w_size,ue.w_size,0),ge=Oe,Ae=ue.w_size),ke=U.avail_in,we=U.next_in,pe=U.input,U.avail_in=Ae,U.next_in=0,U.input=ge,se(ue);ue.lookahead>=R;){for(re=ue.strstart,ne=ue.lookahead-(R-1);ue.ins_h=(ue.ins_h<<ue.hash_shift^ue.window[re+R-1])&ue.hash_mask,ue.prev[re&ue.w_mask]=ue.head[ue.ins_h],ue.head[ue.ins_h]=re,re++,--ne;);ue.strstart=re,ue.lookahead=R-1,se(ue)}return ue.strstart+=ue.lookahead,ue.block_start=ue.strstart,ue.insert=ue.lookahead,ue.lookahead=0,ue.match_length=ue.prev_length=R-1,ue.match_available=0,U.next_in=we,U.input=pe,U.avail_in=ke,ue.wrap=me,p},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,a){n.exports=function(s,i){var l,c,u,d,f,m,p,v,b,y,S,_,N,k,j,E,T,O,R,H,$,L,A,M,P;l=s.state,c=s.next_in,M=s.input,u=c+(s.avail_in-5),d=s.next_out,P=s.output,f=d-(i-s.avail_out),m=d+(s.avail_out-257),p=l.dmax,v=l.wsize,b=l.whave,y=l.wnext,S=l.window,_=l.hold,N=l.bits,k=l.lencode,j=l.distcode,E=(1<<l.lenbits)-1,T=(1<<l.distbits)-1;e:do{N<15&&(_+=M[c++]<<N,N+=8,_+=M[c++]<<N,N+=8),O=k[_&E];t:for(;;){if(_>>>=R=O>>>24,N-=R,(R=O>>>16&255)===0)P[d++]=65535&O;else{if(!(16&R)){if((64&R)==0){O=k[(65535&O)+(_&(1<<R)-1)];continue t}if(32&R){l.mode=12;break e}s.msg="invalid literal/length code",l.mode=30;break e}H=65535&O,(R&=15)&&(N<R&&(_+=M[c++]<<N,N+=8),H+=_&(1<<R)-1,_>>>=R,N-=R),N<15&&(_+=M[c++]<<N,N+=8,_+=M[c++]<<N,N+=8),O=j[_&T];r:for(;;){if(_>>>=R=O>>>24,N-=R,!(16&(R=O>>>16&255))){if((64&R)==0){O=j[(65535&O)+(_&(1<<R)-1)];continue r}s.msg="invalid distance code",l.mode=30;break e}if($=65535&O,N<(R&=15)&&(_+=M[c++]<<N,(N+=8)<R&&(_+=M[c++]<<N,N+=8)),p<($+=_&(1<<R)-1)){s.msg="invalid distance too far back",l.mode=30;break e}if(_>>>=R,N-=R,(R=d-f)<$){if(b<(R=$-R)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break e}if(A=S,(L=0)===y){if(L+=v-R,R<H){for(H-=R;P[d++]=S[L++],--R;);L=d-$,A=P}}else if(y<R){if(L+=v+y-R,(R-=y)<H){for(H-=R;P[d++]=S[L++],--R;);if(L=0,y<H){for(H-=R=y;P[d++]=S[L++],--R;);L=d-$,A=P}}}else if(L+=y-R,R<H){for(H-=R;P[d++]=S[L++],--R;);L=d-$,A=P}for(;2<H;)P[d++]=A[L++],P[d++]=A[L++],P[d++]=A[L++],H-=3;H&&(P[d++]=A[L++],1<H&&(P[d++]=A[L++]))}else{for(L=d-$;P[d++]=P[L++],P[d++]=P[L++],P[d++]=P[L++],2<(H-=3););H&&(P[d++]=P[L++],1<H&&(P[d++]=P[L++]))}break}}break}}while(c<u&&d<m);c-=H=N>>3,_&=(1<<(N-=H<<3))-1,s.next_in=c,s.next_out=d,s.avail_in=c<u?u-c+5:5-(c-u),s.avail_out=d<m?m-d+257:257-(d-m),l.hold=_,l.bits=N}},{}],49:[function(r,n,a){var s=r("../utils/common"),i=r("./adler32"),l=r("./crc32"),c=r("./inffast"),u=r("./inftrees"),d=1,f=2,m=0,p=-2,v=1,b=852,y=592;function S(L){return(L>>>24&255)+(L>>>8&65280)+((65280&L)<<8)+((255&L)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(L){var A;return L&&L.state?(A=L.state,L.total_in=L.total_out=A.total=0,L.msg="",A.wrap&&(L.adler=1&A.wrap),A.mode=v,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new s.Buf32(b),A.distcode=A.distdyn=new s.Buf32(y),A.sane=1,A.back=-1,m):p}function k(L){var A;return L&&L.state?((A=L.state).wsize=0,A.whave=0,A.wnext=0,N(L)):p}function j(L,A){var M,P;return L&&L.state?(P=L.state,A<0?(M=0,A=-A):(M=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?p:(P.window!==null&&P.wbits!==A&&(P.window=null),P.wrap=M,P.wbits=A,k(L))):p}function E(L,A){var M,P;return L?(P=new _,(L.state=P).window=null,(M=j(L,A))!==m&&(L.state=null),M):p}var T,O,R=!0;function H(L){if(R){var A;for(T=new s.Buf32(512),O=new s.Buf32(32),A=0;A<144;)L.lens[A++]=8;for(;A<256;)L.lens[A++]=9;for(;A<280;)L.lens[A++]=7;for(;A<288;)L.lens[A++]=8;for(u(d,L.lens,0,288,T,0,L.work,{bits:9}),A=0;A<32;)L.lens[A++]=5;u(f,L.lens,0,32,O,0,L.work,{bits:5}),R=!1}L.lencode=T,L.lenbits=9,L.distcode=O,L.distbits=5}function $(L,A,M,P){var I,B=L.state;return B.window===null&&(B.wsize=1<<B.wbits,B.wnext=0,B.whave=0,B.window=new s.Buf8(B.wsize)),P>=B.wsize?(s.arraySet(B.window,A,M-B.wsize,B.wsize,0),B.wnext=0,B.whave=B.wsize):(P<(I=B.wsize-B.wnext)&&(I=P),s.arraySet(B.window,A,M-P,I,B.wnext),(P-=I)?(s.arraySet(B.window,A,M-P,P,0),B.wnext=P,B.whave=B.wsize):(B.wnext+=I,B.wnext===B.wsize&&(B.wnext=0),B.whave<B.wsize&&(B.whave+=I))),0}a.inflateReset=k,a.inflateReset2=j,a.inflateResetKeep=N,a.inflateInit=function(L){return E(L,15)},a.inflateInit2=E,a.inflate=function(L,A){var M,P,I,B,F,q,Q,W,G,J,X,V,se,de,he,te,le,oe,Z,ve,U,ge,ue,re,ne=0,me=new s.Buf8(4),ke=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&L.avail_in!==0)return p;(M=L.state).mode===12&&(M.mode=13),F=L.next_out,I=L.output,Q=L.avail_out,B=L.next_in,P=L.input,q=L.avail_in,W=M.hold,G=M.bits,J=q,X=Q,ge=m;e:for(;;)switch(M.mode){case v:if(M.wrap===0){M.mode=13;break}for(;G<16;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(2&M.wrap&&W===35615){me[M.check=0]=255&W,me[1]=W>>>8&255,M.check=l(M.check,me,2,0),G=W=0,M.mode=2;break}if(M.flags=0,M.head&&(M.head.done=!1),!(1&M.wrap)||(((255&W)<<8)+(W>>8))%31){L.msg="incorrect header check",M.mode=30;break}if((15&W)!=8){L.msg="unknown compression method",M.mode=30;break}if(G-=4,U=8+(15&(W>>>=4)),M.wbits===0)M.wbits=U;else if(U>M.wbits){L.msg="invalid window size",M.mode=30;break}M.dmax=1<<U,L.adler=M.check=1,M.mode=512&W?10:12,G=W=0;break;case 2:for(;G<16;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(M.flags=W,(255&M.flags)!=8){L.msg="unknown compression method",M.mode=30;break}if(57344&M.flags){L.msg="unknown header flags set",M.mode=30;break}M.head&&(M.head.text=W>>8&1),512&M.flags&&(me[0]=255&W,me[1]=W>>>8&255,M.check=l(M.check,me,2,0)),G=W=0,M.mode=3;case 3:for(;G<32;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}M.head&&(M.head.time=W),512&M.flags&&(me[0]=255&W,me[1]=W>>>8&255,me[2]=W>>>16&255,me[3]=W>>>24&255,M.check=l(M.check,me,4,0)),G=W=0,M.mode=4;case 4:for(;G<16;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}M.head&&(M.head.xflags=255&W,M.head.os=W>>8),512&M.flags&&(me[0]=255&W,me[1]=W>>>8&255,M.check=l(M.check,me,2,0)),G=W=0,M.mode=5;case 5:if(1024&M.flags){for(;G<16;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}M.length=W,M.head&&(M.head.extra_len=W),512&M.flags&&(me[0]=255&W,me[1]=W>>>8&255,M.check=l(M.check,me,2,0)),G=W=0}else M.head&&(M.head.extra=null);M.mode=6;case 6:if(1024&M.flags&&(q<(V=M.length)&&(V=q),V&&(M.head&&(U=M.head.extra_len-M.length,M.head.extra||(M.head.extra=new Array(M.head.extra_len)),s.arraySet(M.head.extra,P,B,V,U)),512&M.flags&&(M.check=l(M.check,P,V,B)),q-=V,B+=V,M.length-=V),M.length))break e;M.length=0,M.mode=7;case 7:if(2048&M.flags){if(q===0)break e;for(V=0;U=P[B+V++],M.head&&U&&M.length<65536&&(M.head.name+=String.fromCharCode(U)),U&&V<q;);if(512&M.flags&&(M.check=l(M.check,P,V,B)),q-=V,B+=V,U)break e}else M.head&&(M.head.name=null);M.length=0,M.mode=8;case 8:if(4096&M.flags){if(q===0)break e;for(V=0;U=P[B+V++],M.head&&U&&M.length<65536&&(M.head.comment+=String.fromCharCode(U)),U&&V<q;);if(512&M.flags&&(M.check=l(M.check,P,V,B)),q-=V,B+=V,U)break e}else M.head&&(M.head.comment=null);M.mode=9;case 9:if(512&M.flags){for(;G<16;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(W!==(65535&M.check)){L.msg="header crc mismatch",M.mode=30;break}G=W=0}M.head&&(M.head.hcrc=M.flags>>9&1,M.head.done=!0),L.adler=M.check=0,M.mode=12;break;case 10:for(;G<32;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}L.adler=M.check=S(W),G=W=0,M.mode=11;case 11:if(M.havedict===0)return L.next_out=F,L.avail_out=Q,L.next_in=B,L.avail_in=q,M.hold=W,M.bits=G,2;L.adler=M.check=1,M.mode=12;case 12:if(A===5||A===6)break e;case 13:if(M.last){W>>>=7&G,G-=7&G,M.mode=27;break}for(;G<3;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}switch(M.last=1&W,G-=1,3&(W>>>=1)){case 0:M.mode=14;break;case 1:if(H(M),M.mode=20,A!==6)break;W>>>=2,G-=2;break e;case 2:M.mode=17;break;case 3:L.msg="invalid block type",M.mode=30}W>>>=2,G-=2;break;case 14:for(W>>>=7&G,G-=7&G;G<32;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if((65535&W)!=(W>>>16^65535)){L.msg="invalid stored block lengths",M.mode=30;break}if(M.length=65535&W,G=W=0,M.mode=15,A===6)break e;case 15:M.mode=16;case 16:if(V=M.length){if(q<V&&(V=q),Q<V&&(V=Q),V===0)break e;s.arraySet(I,P,B,V,F),q-=V,B+=V,Q-=V,F+=V,M.length-=V;break}M.mode=12;break;case 17:for(;G<14;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(M.nlen=257+(31&W),W>>>=5,G-=5,M.ndist=1+(31&W),W>>>=5,G-=5,M.ncode=4+(15&W),W>>>=4,G-=4,286<M.nlen||30<M.ndist){L.msg="too many length or distance symbols",M.mode=30;break}M.have=0,M.mode=18;case 18:for(;M.have<M.ncode;){for(;G<3;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}M.lens[ke[M.have++]]=7&W,W>>>=3,G-=3}for(;M.have<19;)M.lens[ke[M.have++]]=0;if(M.lencode=M.lendyn,M.lenbits=7,ue={bits:M.lenbits},ge=u(0,M.lens,0,19,M.lencode,0,M.work,ue),M.lenbits=ue.bits,ge){L.msg="invalid code lengths set",M.mode=30;break}M.have=0,M.mode=19;case 19:for(;M.have<M.nlen+M.ndist;){for(;te=(ne=M.lencode[W&(1<<M.lenbits)-1])>>>16&255,le=65535&ne,!((he=ne>>>24)<=G);){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(le<16)W>>>=he,G-=he,M.lens[M.have++]=le;else{if(le===16){for(re=he+2;G<re;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(W>>>=he,G-=he,M.have===0){L.msg="invalid bit length repeat",M.mode=30;break}U=M.lens[M.have-1],V=3+(3&W),W>>>=2,G-=2}else if(le===17){for(re=he+3;G<re;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}G-=he,U=0,V=3+(7&(W>>>=he)),W>>>=3,G-=3}else{for(re=he+7;G<re;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}G-=he,U=0,V=11+(127&(W>>>=he)),W>>>=7,G-=7}if(M.have+V>M.nlen+M.ndist){L.msg="invalid bit length repeat",M.mode=30;break}for(;V--;)M.lens[M.have++]=U}}if(M.mode===30)break;if(M.lens[256]===0){L.msg="invalid code -- missing end-of-block",M.mode=30;break}if(M.lenbits=9,ue={bits:M.lenbits},ge=u(d,M.lens,0,M.nlen,M.lencode,0,M.work,ue),M.lenbits=ue.bits,ge){L.msg="invalid literal/lengths set",M.mode=30;break}if(M.distbits=6,M.distcode=M.distdyn,ue={bits:M.distbits},ge=u(f,M.lens,M.nlen,M.ndist,M.distcode,0,M.work,ue),M.distbits=ue.bits,ge){L.msg="invalid distances set",M.mode=30;break}if(M.mode=20,A===6)break e;case 20:M.mode=21;case 21:if(6<=q&&258<=Q){L.next_out=F,L.avail_out=Q,L.next_in=B,L.avail_in=q,M.hold=W,M.bits=G,c(L,X),F=L.next_out,I=L.output,Q=L.avail_out,B=L.next_in,P=L.input,q=L.avail_in,W=M.hold,G=M.bits,M.mode===12&&(M.back=-1);break}for(M.back=0;te=(ne=M.lencode[W&(1<<M.lenbits)-1])>>>16&255,le=65535&ne,!((he=ne>>>24)<=G);){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(te&&(240&te)==0){for(oe=he,Z=te,ve=le;te=(ne=M.lencode[ve+((W&(1<<oe+Z)-1)>>oe)])>>>16&255,le=65535&ne,!(oe+(he=ne>>>24)<=G);){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}W>>>=oe,G-=oe,M.back+=oe}if(W>>>=he,G-=he,M.back+=he,M.length=le,te===0){M.mode=26;break}if(32&te){M.back=-1,M.mode=12;break}if(64&te){L.msg="invalid literal/length code",M.mode=30;break}M.extra=15&te,M.mode=22;case 22:if(M.extra){for(re=M.extra;G<re;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}M.length+=W&(1<<M.extra)-1,W>>>=M.extra,G-=M.extra,M.back+=M.extra}M.was=M.length,M.mode=23;case 23:for(;te=(ne=M.distcode[W&(1<<M.distbits)-1])>>>16&255,le=65535&ne,!((he=ne>>>24)<=G);){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if((240&te)==0){for(oe=he,Z=te,ve=le;te=(ne=M.distcode[ve+((W&(1<<oe+Z)-1)>>oe)])>>>16&255,le=65535&ne,!(oe+(he=ne>>>24)<=G);){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}W>>>=oe,G-=oe,M.back+=oe}if(W>>>=he,G-=he,M.back+=he,64&te){L.msg="invalid distance code",M.mode=30;break}M.offset=le,M.extra=15&te,M.mode=24;case 24:if(M.extra){for(re=M.extra;G<re;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}M.offset+=W&(1<<M.extra)-1,W>>>=M.extra,G-=M.extra,M.back+=M.extra}if(M.offset>M.dmax){L.msg="invalid distance too far back",M.mode=30;break}M.mode=25;case 25:if(Q===0)break e;if(V=X-Q,M.offset>V){if((V=M.offset-V)>M.whave&&M.sane){L.msg="invalid distance too far back",M.mode=30;break}se=V>M.wnext?(V-=M.wnext,M.wsize-V):M.wnext-V,V>M.length&&(V=M.length),de=M.window}else de=I,se=F-M.offset,V=M.length;for(Q<V&&(V=Q),Q-=V,M.length-=V;I[F++]=de[se++],--V;);M.length===0&&(M.mode=21);break;case 26:if(Q===0)break e;I[F++]=M.length,Q--,M.mode=21;break;case 27:if(M.wrap){for(;G<32;){if(q===0)break e;q--,W|=P[B++]<<G,G+=8}if(X-=Q,L.total_out+=X,M.total+=X,X&&(L.adler=M.check=M.flags?l(M.check,I,X,F-X):i(M.check,I,X,F-X)),X=Q,(M.flags?W:S(W))!==M.check){L.msg="incorrect data check",M.mode=30;break}G=W=0}M.mode=28;case 28:if(M.wrap&&M.flags){for(;G<32;){if(q===0)break e;q--,W+=P[B++]<<G,G+=8}if(W!==(4294967295&M.total)){L.msg="incorrect length check",M.mode=30;break}G=W=0}M.mode=29;case 29:ge=1;break e;case 30:ge=-3;break e;case 31:return-4;case 32:default:return p}return L.next_out=F,L.avail_out=Q,L.next_in=B,L.avail_in=q,M.hold=W,M.bits=G,(M.wsize||X!==L.avail_out&&M.mode<30&&(M.mode<27||A!==4))&&$(L,L.output,L.next_out,X-L.avail_out)?(M.mode=31,-4):(J-=L.avail_in,X-=L.avail_out,L.total_in+=J,L.total_out+=X,M.total+=X,M.wrap&&X&&(L.adler=M.check=M.flags?l(M.check,I,X,L.next_out-X):i(M.check,I,X,L.next_out-X)),L.data_type=M.bits+(M.last?64:0)+(M.mode===12?128:0)+(M.mode===20||M.mode===15?256:0),(J==0&&X===0||A===4)&&ge===m&&(ge=-5),ge)},a.inflateEnd=function(L){if(!L||!L.state)return p;var A=L.state;return A.window&&(A.window=null),L.state=null,m},a.inflateGetHeader=function(L,A){var M;return L&&L.state?(2&(M=L.state).wrap)==0?p:((M.head=A).done=!1,m):p},a.inflateSetDictionary=function(L,A){var M,P=A.length;return L&&L.state?(M=L.state).wrap!==0&&M.mode!==11?p:M.mode===11&&i(1,A,P,0)!==M.check?-3:$(L,A,P,P)?(M.mode=31,-4):(M.havedict=1,m):p},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,a){var s=r("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(d,f,m,p,v,b,y,S){var _,N,k,j,E,T,O,R,H,$=S.bits,L=0,A=0,M=0,P=0,I=0,B=0,F=0,q=0,Q=0,W=0,G=null,J=0,X=new s.Buf16(16),V=new s.Buf16(16),se=null,de=0;for(L=0;L<=15;L++)X[L]=0;for(A=0;A<p;A++)X[f[m+A]]++;for(I=$,P=15;1<=P&&X[P]===0;P--);if(P<I&&(I=P),P===0)return v[b++]=20971520,v[b++]=20971520,S.bits=1,0;for(M=1;M<P&&X[M]===0;M++);for(I<M&&(I=M),L=q=1;L<=15;L++)if(q<<=1,(q-=X[L])<0)return-1;if(0<q&&(d===0||P!==1))return-1;for(V[1]=0,L=1;L<15;L++)V[L+1]=V[L]+X[L];for(A=0;A<p;A++)f[m+A]!==0&&(y[V[f[m+A]]++]=A);if(T=d===0?(G=se=y,19):d===1?(G=i,J-=257,se=l,de-=257,256):(G=c,se=u,-1),L=M,E=b,F=A=W=0,k=-1,j=(Q=1<<(B=I))-1,d===1&&852<Q||d===2&&592<Q)return 1;for(;;){for(O=L-F,H=y[A]<T?(R=0,y[A]):y[A]>T?(R=se[de+y[A]],G[J+y[A]]):(R=96,0),_=1<<L-F,M=N=1<<B;v[E+(W>>F)+(N-=_)]=O<<24|R<<16|H|0,N!==0;);for(_=1<<L-1;W&_;)_>>=1;if(_!==0?(W&=_-1,W+=_):W=0,A++,--X[L]==0){if(L===P)break;L=f[m+y[A]]}if(I<L&&(W&j)!==k){for(F===0&&(F=I),E+=M,q=1<<(B=L-F);B+F<P&&!((q-=X[B+F])<=0);)B++,q<<=1;if(Q+=1<<B,d===1&&852<Q||d===2&&592<Q)return 1;v[k=W&j]=I<<24|B<<16|E-b|0}}return W!==0&&(v[E+W]=L-F<<24|64<<16|0),S.bits=I,0}},{"../utils/common":41}],51:[function(r,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,a){var s=r("../utils/common"),i=0,l=1;function c(ne){for(var me=ne.length;0<=--me;)ne[me]=0}var u=0,d=29,f=256,m=f+1+d,p=30,v=19,b=2*m+1,y=15,S=16,_=7,N=256,k=16,j=17,E=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$=new Array(2*(m+2));c($);var L=new Array(2*p);c(L);var A=new Array(512);c(A);var M=new Array(256);c(M);var P=new Array(d);c(P);var I,B,F,q=new Array(p);function Q(ne,me,ke,we,pe){this.static_tree=ne,this.extra_bits=me,this.extra_base=ke,this.elems=we,this.max_length=pe,this.has_stree=ne&&ne.length}function W(ne,me){this.dyn_tree=ne,this.max_code=0,this.stat_desc=me}function G(ne){return ne<256?A[ne]:A[256+(ne>>>7)]}function J(ne,me){ne.pending_buf[ne.pending++]=255&me,ne.pending_buf[ne.pending++]=me>>>8&255}function X(ne,me,ke){ne.bi_valid>S-ke?(ne.bi_buf|=me<<ne.bi_valid&65535,J(ne,ne.bi_buf),ne.bi_buf=me>>S-ne.bi_valid,ne.bi_valid+=ke-S):(ne.bi_buf|=me<<ne.bi_valid&65535,ne.bi_valid+=ke)}function V(ne,me,ke){X(ne,ke[2*me],ke[2*me+1])}function se(ne,me){for(var ke=0;ke|=1&ne,ne>>>=1,ke<<=1,0<--me;);return ke>>>1}function de(ne,me,ke){var we,pe,Oe=new Array(y+1),Ae=0;for(we=1;we<=y;we++)Oe[we]=Ae=Ae+ke[we-1]<<1;for(pe=0;pe<=me;pe++){var Re=ne[2*pe+1];Re!==0&&(ne[2*pe]=se(Oe[Re]++,Re))}}function he(ne){var me;for(me=0;me<m;me++)ne.dyn_ltree[2*me]=0;for(me=0;me<p;me++)ne.dyn_dtree[2*me]=0;for(me=0;me<v;me++)ne.bl_tree[2*me]=0;ne.dyn_ltree[2*N]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function te(ne){8<ne.bi_valid?J(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function le(ne,me,ke,we){var pe=2*me,Oe=2*ke;return ne[pe]<ne[Oe]||ne[pe]===ne[Oe]&&we[me]<=we[ke]}function oe(ne,me,ke){for(var we=ne.heap[ke],pe=ke<<1;pe<=ne.heap_len&&(pe<ne.heap_len&&le(me,ne.heap[pe+1],ne.heap[pe],ne.depth)&&pe++,!le(me,we,ne.heap[pe],ne.depth));)ne.heap[ke]=ne.heap[pe],ke=pe,pe<<=1;ne.heap[ke]=we}function Z(ne,me,ke){var we,pe,Oe,Ae,Re=0;if(ne.last_lit!==0)for(;we=ne.pending_buf[ne.d_buf+2*Re]<<8|ne.pending_buf[ne.d_buf+2*Re+1],pe=ne.pending_buf[ne.l_buf+Re],Re++,we===0?V(ne,pe,me):(V(ne,(Oe=M[pe])+f+1,me),(Ae=T[Oe])!==0&&X(ne,pe-=P[Oe],Ae),V(ne,Oe=G(--we),ke),(Ae=O[Oe])!==0&&X(ne,we-=q[Oe],Ae)),Re<ne.last_lit;);V(ne,N,me)}function ve(ne,me){var ke,we,pe,Oe=me.dyn_tree,Ae=me.stat_desc.static_tree,Re=me.stat_desc.has_stree,Ve=me.stat_desc.elems,gt=-1;for(ne.heap_len=0,ne.heap_max=b,ke=0;ke<Ve;ke++)Oe[2*ke]!==0?(ne.heap[++ne.heap_len]=gt=ke,ne.depth[ke]=0):Oe[2*ke+1]=0;for(;ne.heap_len<2;)Oe[2*(pe=ne.heap[++ne.heap_len]=gt<2?++gt:0)]=1,ne.depth[pe]=0,ne.opt_len--,Re&&(ne.static_len-=Ae[2*pe+1]);for(me.max_code=gt,ke=ne.heap_len>>1;1<=ke;ke--)oe(ne,Oe,ke);for(pe=Ve;ke=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],oe(ne,Oe,1),we=ne.heap[1],ne.heap[--ne.heap_max]=ke,ne.heap[--ne.heap_max]=we,Oe[2*pe]=Oe[2*ke]+Oe[2*we],ne.depth[pe]=(ne.depth[ke]>=ne.depth[we]?ne.depth[ke]:ne.depth[we])+1,Oe[2*ke+1]=Oe[2*we+1]=pe,ne.heap[1]=pe++,oe(ne,Oe,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],(function(lt,Pt){var fr,Qe,Vt,at,Ne,Fe,Ke=Pt.dyn_tree,Tt=Pt.max_code,wt=Pt.stat_desc.static_tree,Zt=Pt.stat_desc.has_stree,Xe=Pt.stat_desc.extra_bits,nt=Pt.stat_desc.extra_base,bt=Pt.stat_desc.max_length,Ct=0;for(at=0;at<=y;at++)lt.bl_count[at]=0;for(Ke[2*lt.heap[lt.heap_max]+1]=0,fr=lt.heap_max+1;fr<b;fr++)bt<(at=Ke[2*Ke[2*(Qe=lt.heap[fr])+1]+1]+1)&&(at=bt,Ct++),Ke[2*Qe+1]=at,Tt<Qe||(lt.bl_count[at]++,Ne=0,nt<=Qe&&(Ne=Xe[Qe-nt]),Fe=Ke[2*Qe],lt.opt_len+=Fe*(at+Ne),Zt&&(lt.static_len+=Fe*(wt[2*Qe+1]+Ne)));if(Ct!==0){do{for(at=bt-1;lt.bl_count[at]===0;)at--;lt.bl_count[at]--,lt.bl_count[at+1]+=2,lt.bl_count[bt]--,Ct-=2}while(0<Ct);for(at=bt;at!==0;at--)for(Qe=lt.bl_count[at];Qe!==0;)Tt<(Vt=lt.heap[--fr])||(Ke[2*Vt+1]!==at&&(lt.opt_len+=(at-Ke[2*Vt+1])*Ke[2*Vt],Ke[2*Vt+1]=at),Qe--)}})(ne,me),de(Oe,gt,ne.bl_count)}function U(ne,me,ke){var we,pe,Oe=-1,Ae=me[1],Re=0,Ve=7,gt=4;for(Ae===0&&(Ve=138,gt=3),me[2*(ke+1)+1]=65535,we=0;we<=ke;we++)pe=Ae,Ae=me[2*(we+1)+1],++Re<Ve&&pe===Ae||(Re<gt?ne.bl_tree[2*pe]+=Re:pe!==0?(pe!==Oe&&ne.bl_tree[2*pe]++,ne.bl_tree[2*k]++):Re<=10?ne.bl_tree[2*j]++:ne.bl_tree[2*E]++,Oe=pe,gt=(Re=0)===Ae?(Ve=138,3):pe===Ae?(Ve=6,3):(Ve=7,4))}function ge(ne,me,ke){var we,pe,Oe=-1,Ae=me[1],Re=0,Ve=7,gt=4;for(Ae===0&&(Ve=138,gt=3),we=0;we<=ke;we++)if(pe=Ae,Ae=me[2*(we+1)+1],!(++Re<Ve&&pe===Ae)){if(Re<gt)for(;V(ne,pe,ne.bl_tree),--Re!=0;);else pe!==0?(pe!==Oe&&(V(ne,pe,ne.bl_tree),Re--),V(ne,k,ne.bl_tree),X(ne,Re-3,2)):Re<=10?(V(ne,j,ne.bl_tree),X(ne,Re-3,3)):(V(ne,E,ne.bl_tree),X(ne,Re-11,7));Oe=pe,gt=(Re=0)===Ae?(Ve=138,3):pe===Ae?(Ve=6,3):(Ve=7,4)}}c(q);var ue=!1;function re(ne,me,ke,we){X(ne,(u<<1)+(we?1:0),3),(function(pe,Oe,Ae,Re){te(pe),J(pe,Ae),J(pe,~Ae),s.arraySet(pe.pending_buf,pe.window,Oe,Ae,pe.pending),pe.pending+=Ae})(ne,me,ke)}a._tr_init=function(ne){ue||((function(){var me,ke,we,pe,Oe,Ae=new Array(y+1);for(pe=we=0;pe<d-1;pe++)for(P[pe]=we,me=0;me<1<<T[pe];me++)M[we++]=pe;for(M[we-1]=pe,pe=Oe=0;pe<16;pe++)for(q[pe]=Oe,me=0;me<1<<O[pe];me++)A[Oe++]=pe;for(Oe>>=7;pe<p;pe++)for(q[pe]=Oe<<7,me=0;me<1<<O[pe]-7;me++)A[256+Oe++]=pe;for(ke=0;ke<=y;ke++)Ae[ke]=0;for(me=0;me<=143;)$[2*me+1]=8,me++,Ae[8]++;for(;me<=255;)$[2*me+1]=9,me++,Ae[9]++;for(;me<=279;)$[2*me+1]=7,me++,Ae[7]++;for(;me<=287;)$[2*me+1]=8,me++,Ae[8]++;for(de($,m+1,Ae),me=0;me<p;me++)L[2*me+1]=5,L[2*me]=se(me,5);I=new Q($,T,f+1,m,y),B=new Q(L,O,0,p,y),F=new Q(new Array(0),R,0,v,_)})(),ue=!0),ne.l_desc=new W(ne.dyn_ltree,I),ne.d_desc=new W(ne.dyn_dtree,B),ne.bl_desc=new W(ne.bl_tree,F),ne.bi_buf=0,ne.bi_valid=0,he(ne)},a._tr_stored_block=re,a._tr_flush_block=function(ne,me,ke,we){var pe,Oe,Ae=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=(function(Re){var Ve,gt=4093624447;for(Ve=0;Ve<=31;Ve++,gt>>>=1)if(1&gt&&Re.dyn_ltree[2*Ve]!==0)return i;if(Re.dyn_ltree[18]!==0||Re.dyn_ltree[20]!==0||Re.dyn_ltree[26]!==0)return l;for(Ve=32;Ve<f;Ve++)if(Re.dyn_ltree[2*Ve]!==0)return l;return i})(ne)),ve(ne,ne.l_desc),ve(ne,ne.d_desc),Ae=(function(Re){var Ve;for(U(Re,Re.dyn_ltree,Re.l_desc.max_code),U(Re,Re.dyn_dtree,Re.d_desc.max_code),ve(Re,Re.bl_desc),Ve=v-1;3<=Ve&&Re.bl_tree[2*H[Ve]+1]===0;Ve--);return Re.opt_len+=3*(Ve+1)+5+5+4,Ve})(ne),pe=ne.opt_len+3+7>>>3,(Oe=ne.static_len+3+7>>>3)<=pe&&(pe=Oe)):pe=Oe=ke+5,ke+4<=pe&&me!==-1?re(ne,me,ke,we):ne.strategy===4||Oe===pe?(X(ne,2+(we?1:0),3),Z(ne,$,L)):(X(ne,4+(we?1:0),3),(function(Re,Ve,gt,lt){var Pt;for(X(Re,Ve-257,5),X(Re,gt-1,5),X(Re,lt-4,4),Pt=0;Pt<lt;Pt++)X(Re,Re.bl_tree[2*H[Pt]+1],3);ge(Re,Re.dyn_ltree,Ve-1),ge(Re,Re.dyn_dtree,gt-1)})(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Ae+1),Z(ne,ne.dyn_ltree,ne.dyn_dtree)),he(ne),we&&te(ne)},a._tr_tally=function(ne,me,ke){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=me>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&me,ne.pending_buf[ne.l_buf+ne.last_lit]=255&ke,ne.last_lit++,me===0?ne.dyn_ltree[2*ke]++:(ne.matches++,me--,ne.dyn_ltree[2*(M[ke]+f+1)]++,ne.dyn_dtree[2*G(me)]++),ne.last_lit===ne.lit_bufsize-1},a._tr_align=function(ne){X(ne,2,3),V(ne,N,$),(function(me){me.bi_valid===16?(J(me,me.bi_buf),me.bi_buf=0,me.bi_valid=0):8<=me.bi_valid&&(me.pending_buf[me.pending++]=255&me.bi_buf,me.bi_buf>>=8,me.bi_valid-=8)})(ne)}},{"../utils/common":41}],53:[function(r,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,a){(function(s){(function(i,l){if(!i.setImmediate){var c,u,d,f,m=1,p={},v=!1,b=i.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(i);y=y&&y.setTimeout?y:i,c={}.toString.call(i.process)==="[object process]"?function(k){process.nextTick(function(){_(k)})}:(function(){if(i.postMessage&&!i.importScripts){var k=!0,j=i.onmessage;return i.onmessage=function(){k=!1},i.postMessage("","*"),i.onmessage=j,k}})()?(f="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",N,!1):i.attachEvent("onmessage",N),function(k){i.postMessage(f+k,"*")}):i.MessageChannel?((d=new MessageChannel).port1.onmessage=function(k){_(k.data)},function(k){d.port2.postMessage(k)}):b&&"onreadystatechange"in b.createElement("script")?(u=b.documentElement,function(k){var j=b.createElement("script");j.onreadystatechange=function(){_(k),j.onreadystatechange=null,u.removeChild(j),j=null},u.appendChild(j)}):function(k){setTimeout(_,0,k)},y.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var j=new Array(arguments.length-1),E=0;E<j.length;E++)j[E]=arguments[E+1];var T={callback:k,args:j};return p[m]=T,c(m),m++},y.clearImmediate=S}function S(k){delete p[k]}function _(k){if(v)setTimeout(_,0,k);else{var j=p[k];if(j){v=!0;try{(function(E){var T=E.callback,O=E.args;switch(O.length){case 0:T();break;case 1:T(O[0]);break;case 2:T(O[0],O[1]);break;case 3:T(O[0],O[1],O[2]);break;default:T.apply(l,O)}})(j)}finally{S(k),v=!1}}}}function N(k){k.source===i&&typeof k.data=="string"&&k.data.indexOf(f)===0&&_(+k.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof gd<"u"?gd:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(wO)),wO.exports}var dwt=uwt();const fwt=Ur(dwt),wne=["themes","grammars","languages","snippets","iconThemes","productIconThemes"],Sne="^1.85.0";function kne(e){const r=e.replace(/^[\^~]/,"").match(/^(\d+)\.(\d+)\.(\d+)/);return r?{major:parseInt(r[1],10),minor:parseInt(r[2],10),patch:parseInt(r[3],10)}:null}function hwt(e,t){const r=kne(e),n=kne(t);return!r||!n?!0:!(r.major!==n.major||r.minor>n.minor||r.minor===n.minor&&r.patch>n.patch)}function mwt(e){const t={compatible:!0,reasons:[],warnings:[]};if(e.main&&(t.compatible=!1,t.reasons.push(`Extension has a "main" entry point (${e.main}) which requires code execution`)),e.browser&&(t.compatible=!1,t.reasons.push(`Extension has a "browser" entry point (${e.browser}) which requires code execution`)),e.activationEvents&&e.activationEvents.length>0){const r=e.activationEvents.filter(n=>!n.startsWith("onLanguage:")&&n!=="*"&&n!=="onStartupFinished");r.length>0&&t.warnings.push(`Extension has activation events: ${r.join(", ")}`)}if(e.contributes){const r=Object.keys(e.contributes),n=r.filter(s=>!wne.includes(s)&&e.contributes[s]!==void 0&&e.contributes[s]!==null);n.length>0&&(t.compatible=!1,t.reasons.push(`Extension contributes unsupported types: ${n.join(", ")}`)),r.filter(s=>wne.includes(s)).length===0&&(t.compatible=!1,t.reasons.push("Extension has no supported declarative contributions"))}else t.compatible=!1,t.reasons.push("Extension has no contributions");if(e.engines?.vscode){const r=e.engines.vscode;hwt(r,Sne)||t.warnings.push(`Extension requires VS Code ${r}, but we support ${Sne}`)}return t}function pwt(e){const t=new Set;if(!e.contributes)return t;if(e.contributes.themes)for(const r of e.contributes.themes)r.path&&t.add(r.path);if(e.contributes.grammars)for(const r of e.contributes.grammars)r.path&&t.add(r.path);if(e.contributes.snippets)for(const r of e.contributes.snippets)r.path&&t.add(r.path);if(e.contributes.languages)for(const r of e.contributes.languages)r.configuration&&t.add(r.configuration);if(e.contributes.iconThemes)for(const r of e.contributes.iconThemes)r.path&&t.add(r.path);if(e.contributes.productIconThemes)for(const r of e.contributes.productIconThemes)r.path&&t.add(r.path);return e.icon&&t.add(e.icon),t}async function gwt(e){const t=await fwt.loadAsync(e),n=t.file("extension/package.json");if(!n)throw new Error("Invalid VSIX: package.json not found at extension/package.json");const a=await n.async("string");let s;try{s=JSON.parse(a)}catch(c){throw new Error(`Invalid VSIX: package.json is not valid JSON: ${c instanceof Error?c.message:"Unknown error"}`)}if(!s.name)throw new Error('Invalid VSIX: manifest missing required field "name"');if(!s.publisher)throw new Error('Invalid VSIX: manifest missing required field "publisher"');if(!s.version)throw new Error('Invalid VSIX: manifest missing required field "version"');const i=pwt(s),l=new Map;for(const c of i){const u=c.replace(/^\.\//,""),d=`extension/${u}`,f=t.file(d);if(f){const m=await f.async("uint8array");l.set(u,m)}else{const m=t.file(u);if(m){const p=await m.async("uint8array");l.set(u,p)}}}return{manifest:s,contributedFiles:l}}function vwt(e){return`${e.publisher}.${e.name}`}class bwt extends Error{constructor(t,r){super(t),this.reasons=r,this.name="ExtensionCompatibilityError"}}class td extends Error{constructor(t,r,n){super(t),this.phase=r,this.cause=n,this.name="ExtensionInstallError"}}const ay=new Set,M5=new Set;let Rye=[],Pye=!1;function T5(){for(const e of M5)e()}function _ne(e){return M5.add(e),()=>{M5.delete(e)}}function Nne(){return Rye}async function Y$(){try{Rye=await V1t(),Pye=!0,T5()}catch(e){console.error("[ExtensionManager] Failed to refresh installed extensions cache:",e)}}async function ywt(e,t,r){const n=`${e}.${t}`;if(ay.has(n))throw new td(`Extension ${n} is already being installed`,"download",void 0);ay.add(n),T5();let a=!1,s=null;try{let i;try{i=await cwt(e,t,r)}catch(v){throw new td(`Failed to download extension: ${v instanceof Error?v.message:String(v)}`,"download",v instanceof Error?v:void 0)}let l,c;try{const v=await gwt(i);l=v.manifest,c=v.contributedFiles}catch(v){throw new td(`Failed to parse VSIX: ${v instanceof Error?v.message:String(v)}`,"parse",v instanceof Error?v:void 0)}const u=l;if(s=vwt(l),await vne(s))throw new td(`Extension ${s} is already installed`,"storage",void 0);if(swt(s))throw new td(`Extension ${s} is already registered`,"registration",void 0);const f=mwt(l);if(!f.compatible)throw new bwt(`Extension ${s} is not compatible: ${f.reasons.join("; ")}`,f.reasons);f.warnings.length>0&&console.warn(`[ExtensionManager] Extension ${s} has warnings:`,f.warnings);try{await G1t(s,u,c),a=!0}catch(v){throw new td(`Failed to save extension: ${v instanceof Error?v.message:String(v)}`,"storage",v instanceof Error?v:void 0)}const m=rwt(u,c);if(!m.success)throw new td(`Failed to register extension: ${m.error}`,"registration",void 0);if(m.extension)try{await m.extension.whenReady()}catch(v){console.warn(`[ExtensionManager] Extension ${s} whenReady failed, but registration succeeded:`,v)}console.log(`[ExtensionManager] Successfully installed extension: ${s}`),await Y$();const p=await vne(s);if(!p)throw new td("Extension was saved but could not be retrieved","storage",void 0);return p}catch(i){if(a&&s)try{await Mye(s),console.log(`[ExtensionManager] Cleaned up partial storage for ${s}`)}catch(l){console.error(`[ExtensionManager] Failed to clean up partial storage for ${s}:`,l)}throw i}finally{ay.delete(n),T5()}}async function xwt(e){console.log(`[ExtensionManager] Uninstalling extension: ${e}`);try{await nwt(e)}catch(t){console.error(`[ExtensionManager] Failed to unregister extension ${e}:`,t)}try{await Mye(e)}catch(t){throw console.error(`[ExtensionManager] Failed to remove extension ${e} from storage:`,t),t}console.log(`[ExtensionManager] Successfully uninstalled extension: ${e}`),await Y$()}function zye(){w.useEffect(()=>{Pye||Y$()},[]);const e=w.useSyncExternalStore(_ne,Nne,Nne),[t,r]=w.useState(()=>new Set(ay));w.useEffect(()=>_ne(()=>{r(new Set(ay))}),[]);const n=w.useCallback(async(s,i,l)=>{await ywt(s,i,l)},[]),a=w.useCallback(async s=>{await xwt(s)},[]);return w.useMemo(()=>({installed:e,installing:t,install:n,uninstall:a}),[e,t,n,a])}function wwt(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toLocaleString()}function Cne({extension:e,isInstalled:t,installedInfo:r,isInstalling:n,isUninstalling:a,isIncompatible:s=!1,incompatibilityReasons:i=[],onInstall:l,onUninstall:c,onClick:u}){const[d,f]=w.useState(null),m=e.displayName||e.name,p=e.namespace,v=e.description||"No description available",b=r?.version||e.version,y=e.files.icon,S=`${e.namespace}.${e.name}`,_=n||a,N=w.useCallback(()=>{s||_||(f(null),l(e.namespace,e.name))},[e.namespace,e.name,s,_,l]),k=w.useCallback(()=>{_||(f(null),c(S))},[S,_,c]),j=w.useMemo(()=>s?i.length===0?"This extension requires code execution and cannot be installed.":i.join(`
`):null,[s,i]),E=w.useCallback(()=>{u&&u(e)},[u,e]);return o.jsxs("div",{className:`
        flex gap-3 p-3 border-b border-[var(--color-border)] last:border-b-0
        ${s?"opacity-60":""}
        hover:bg-[var(--color-surface-hover)] transition-colors
      `,"data-testid":`extension-card-${S}`,children:[o.jsxs("button",{type:"button",onClick:E,className:"flex gap-3 flex-1 min-w-0 text-left cursor-pointer",disabled:!u,children:[o.jsxs("div",{className:"flex-shrink-0 w-10 h-10 rounded-md bg-[var(--color-surface)] flex items-center justify-center overflow-hidden",children:[y?o.jsx("img",{src:y,alt:`${m} icon`,className:"w-full h-full object-cover",loading:"lazy",onError:T=>{T.target.style.display="none",T.target.nextElementSibling?.classList.remove("hidden")}}):null,o.jsx(ly,{className:`w-5 h-5 text-[var(--color-text-muted)] ${y?"hidden":""}`})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("span",{className:"text-sm font-medium text-[var(--color-text)] truncate",children:m}),o.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--color-surface)] text-[var(--color-text-muted)] flex-shrink-0",children:["v",b]}),s&&o.jsx(Cn,{content:j||"Incompatible extension",children:o.jsx("span",{className:"flex-shrink-0",children:o.jsx(Bn,{className:"w-3.5 h-3.5 text-[var(--color-warning)]"})})})]}),o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)] mb-1 flex items-center gap-2",children:[o.jsx("span",{children:p}),e.downloadCount!==void 0&&o.jsxs("span",{className:"flex items-center gap-0.5",children:[o.jsx(oy,{className:"w-3 h-3"}),wwt(e.downloadCount)]})]}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)] line-clamp-2",children:v}),d&&o.jsx("p",{className:"text-xs text-[var(--color-danger)] mt-1",children:d})]})]}),o.jsx("div",{className:"flex-shrink-0 flex items-center",children:t?o.jsx(Cn,{content:"Uninstall extension",children:o.jsx("button",{onClick:k,disabled:_,className:`
                flex items-center justify-center w-8 h-8 rounded
                ${_?"bg-[var(--color-surface)] cursor-not-allowed":"bg-[var(--color-danger)]/10 hover:bg-[var(--color-danger)]/20 text-[var(--color-danger)]"}
                transition-colors
              `,"data-testid":`extension-uninstall-${S}`,children:a?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(pr,{className:"w-4 h-4"})})}):o.jsx(Cn,{content:s?j||"Cannot install - incompatible extension":"Install extension",children:o.jsx("button",{onClick:N,disabled:_||s,className:`
                flex items-center justify-center w-8 h-8 rounded
                ${s?"bg-[var(--color-surface)] cursor-not-allowed text-[var(--color-text-muted)]":_?"bg-[var(--color-surface)] cursor-not-allowed":"bg-[var(--color-primary)]/10 hover:bg-[var(--color-primary)]/20 text-[var(--color-primary)]"}
                transition-colors
              `,"data-testid":`extension-install-${S}`,children:n?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(oy,{className:"w-4 h-4"})})})})]})}const Swt=300,kwt={All:void 0,Themes:"Themes",Languages:"Programming Languages",Snippets:"Snippets"};function _wt({className:e="",onExtensionClick:t}){const r=w.useRef(null),n=w.useRef(null),{installed:a,installing:s,install:i,uninstall:l}=zye(),[c,u]=w.useState("All"),[d,f]=w.useState(!0),[m,p]=w.useState({query:"",results:[],isSearching:!1,error:null,totalSize:0}),[v,b]=w.useState(new Set),[y,S]=w.useState(new Map),_=w.useCallback(async(F,q)=>{if(n.current&&window.clearTimeout(n.current),!F.trim()){p(Q=>({...Q,query:"",results:[],isSearching:!1,error:null,totalSize:0}));return}p(Q=>({...Q,query:F,isSearching:!0,error:null})),n.current=window.setTimeout(async()=>{try{const Q=kwt[q],W=await lwt(F,{category:Q,size:50,sortBy:"downloadCount",sortOrder:"desc"});p(G=>({...G,results:W.extensions,isSearching:!1,totalSize:W.totalSize})),N(W.extensions)}catch(Q){p(W=>({...W,results:[],isSearching:!1,error:Q instanceof Error?Q.message:"Search failed"}))}},Swt)},[]),N=w.useCallback(async F=>{const q=Date.now(),Q=F.filter(G=>{const J=`${G.namespace}.${G.name}`,X=y.get(J);return!X||q-X.checkedAt>300*1e3});if(Q.length===0)return;const W=5;for(let G=0;G<Q.length;G+=W){const J=Q.slice(G,G+W),X=await Promise.allSettled(J.map(async se=>{const de=await Iye(se.namespace,se.name);return{ext:se,metadata:de}})),V=new Map(y);for(const se of X)if(se.status==="fulfilled"){const{ext:de,metadata:he}=se.value,te=`${de.namespace}.${de.name}`,le=k(he);V.set(te,{isCompatible:le.isCompatible,reasons:le.reasons,checkedAt:q})}S(V)}},[y]),k=w.useCallback(F=>{const q=[],W=(F.categories||[]).map(se=>se.toLowerCase()),G=["themes","programming languages","snippets","language packs"],J=W.some(se=>G.some(de=>se.includes(de))),X=["debuggers","formatters","linters","testing","notebooks","data science","machine learning","extension packs"];return W.some(se=>X.some(de=>se.includes(de)))&&!J?(q.push("This extension likely requires code execution"),{isCompatible:!1,reasons:q}):{isCompatible:!0,reasons:[]}},[]),j=w.useCallback(F=>{const q=F.target.value;_(q,c)},[c,_]),E=w.useCallback(F=>{u(F),m.query&&_(m.query,F)},[m.query,_]),T=w.useCallback(()=>{p({query:"",results:[],isSearching:!1,error:null,totalSize:0}),r.current?.focus()},[]),O=w.useCallback(async(F,q)=>{try{await i(F,q,"latest")}catch(Q){console.error("[EditorExtensionsPanel] Install failed:",Q)}},[i]),R=w.useCallback(async F=>{b(q=>new Set(q).add(F));try{await l(F)}catch(q){console.error("[EditorExtensionsPanel] Uninstall failed:",q)}finally{b(q=>{const Q=new Set(q);return Q.delete(F),Q})}},[l]),H=w.useCallback((F,q)=>{const Q=`${F}.${q}`;return a.some(W=>W.id===Q||W.id===`${F}.${q}`)},[a]),$=w.useCallback((F,q)=>{const Q=`${F}.${q}`;return y.get(Q)},[y]),L=m.query.trim().length>0,A=L&&m.results.length>0,M=L&&!m.isSearching&&m.results.length===0&&!m.error,P=a.length>0,I=w.useMemo(()=>m.results.filter(F=>!H(F.namespace,F.name)),[m.results,H]),B=w.useMemo(()=>{const F=[];if(m.error&&F.push({type:"error",message:m.error}),P&&(F.push({type:"installed-header"}),d))for(const q of a)F.push({type:"installed-card",ext:q});if(A)for(const q of I){const Q=`${q.namespace}.${q.name}`,W=$(q.namespace,q.name);F.push({type:"search-card",ext:q,extId:Q,compatibility:W})}return M&&F.push({type:"empty-state",variant:"no-results"}),!L&&!P&&!m.isSearching&&F.push({type:"empty-state",variant:"browse"}),!L&&P&&!d&&!m.isSearching&&F.push({type:"empty-state",variant:"find-more"}),F},[m.error,P,d,a,A,I,$,M,L,m.isSearching]);return w.useEffect(()=>()=>{n.current&&window.clearTimeout(n.current)},[]),o.jsxs("div",{className:`flex flex-col h-full overflow-hidden ${e}`,"data-testid":"editor-extensions-panel",children:[o.jsxs("div",{className:"flex-shrink-0 p-2 border-b border-[var(--color-border)] space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(xr,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("input",{ref:r,type:"text",value:m.query,onChange:j,placeholder:"Search extensions...",className:"w-full h-7 pl-7 pr-7 text-xs bg-[var(--color-surface)] border border-[var(--color-border)] rounded focus:outline-none focus:ring-1 focus:ring-[var(--color-primary)] text-[var(--color-text)] placeholder:text-[var(--color-text-muted)]","data-testid":"extensions-search-input"}),L&&!m.isSearching&&o.jsx("button",{onClick:T,className:"absolute right-1.5 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text)]",title:"Clear search","data-testid":"extensions-search-clear",children:o.jsx(yt,{className:"w-3.5 h-3.5"})}),m.isSearching&&o.jsx(Pe,{className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 animate-spin text-[var(--color-primary)]"})]}),o.jsx("div",{className:"flex gap-1",children:["All","Themes","Languages","Snippets"].map(F=>o.jsx("button",{onClick:()=>E(F),className:`
                px-2 py-1 text-xs rounded transition-colors
                ${c===F?"bg-[var(--color-primary)] text-white":"bg-[var(--color-surface)] text-[var(--color-text-secondary)] hover:bg-[var(--color-surface-hover)]"}
              `,"data-testid":`extensions-category-${F.toLowerCase()}`,children:F},F))}),L&&!m.isSearching&&o.jsxs("div",{className:"text-xs text-[var(--color-text-muted)]",children:[m.results.length," of ",m.totalSize," results"]})]}),o.jsx("div",{className:"flex-1 overflow-hidden","data-testid":"extensions-content",children:o.jsx(T1,{items:B,getItemKey:(F,q)=>{switch(F.type){case"installed-header":return"installed-header";case"installed-card":return`installed-${F.ext.id}`;case"search-card":return`search-${F.extId}`;case"empty-state":return`empty-${F.variant}`;case"error":return"error";default:return q}},estimateSize:80,overscan:5,height:"100%",renderItem:F=>{switch(F.type){case"installed-header":return o.jsx("div",{className:"border-b border-[var(--color-border)]",children:o.jsxs("button",{onClick:()=>f(!d),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-[var(--color-surface-hover)] transition-colors","data-testid":"extensions-installed-header",children:[d?o.jsx(Yt,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"}):o.jsx(gn,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Installed"}),o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded bg-[var(--color-primary)]/10 text-[var(--color-primary)]",children:a.length})]})});case"installed-card":return o.jsx("div",{"data-testid":"extensions-installed-list",children:o.jsx(Cne,{extension:{url:"",name:F.ext.manifest.name,namespace:F.ext.manifest.publisher,version:F.ext.version,displayName:F.ext.manifest.displayName,description:F.ext.manifest.description,files:{}},isInstalled:!0,installedInfo:F.ext,isInstalling:!1,isUninstalling:v.has(F.ext.id),onInstall:O,onUninstall:R,onClick:t})});case"search-card":return o.jsx("div",{"data-testid":"extensions-search-results",children:o.jsx(Cne,{extension:F.ext,isInstalled:!1,isInstalling:s.has(F.extId),isUninstalling:!1,isIncompatible:F.compatibility?.isCompatible===!1,incompatibilityReasons:F.compatibility?.reasons,onInstall:O,onUninstall:R,onClick:t})});case"empty-state":return F.variant==="no-results"?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(yt,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"No Results"}),o.jsxs("p",{className:"text-xs text-[var(--color-text-secondary)]",children:['No extensions found for "',m.query,'"']})]}):F.variant==="browse"?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(ly,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Browse Extensions"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Search for themes, languages, and snippets"})]}):F.variant==="find-more"?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(xr,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Find More"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Search for more extensions above"})]}):null;case"error":return o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-[var(--color-danger)]/10 text-[var(--color-danger)] text-xs",children:[o.jsx(Rt,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{children:F.message})]});default:return null}},renderEmpty:()=>o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center px-3",children:[o.jsx(ly,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-3"}),o.jsx("h4",{className:"text-sm font-medium text-[var(--color-text)] mb-1",children:"Browse Extensions"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:"Search for themes, languages, and snippets"})]})})})]})}function Nwt(e){const t=e.split(".").pop()?.toLowerCase()||"",r=e.toLowerCase();return["json","jsonc","json5"].includes(t)?fse:r.endsWith(".config.js")||r.endsWith(".config.ts")||r.startsWith(".")||["yaml","yml","toml","ini"].includes(t)?Wa:["ts","tsx","js","jsx","mjs","cjs","py","rs","go","rb","java","c","cpp","h","hpp"].includes(t)?Bi:["md","txt","rtf","doc","docx"].includes(t)?rn:F6}function Cwt(e){const t=e.split(".").pop()?.toLowerCase()||"";return["ts","tsx"].includes(t)?"text-blue-500":["js","jsx","mjs","cjs"].includes(t)?"text-yellow-500":["json","jsonc"].includes(t)?"text-yellow-400":["py"].includes(t)?"text-blue-400":["md","mdx"].includes(t)?"text-purple-400":["css","scss","sass"].includes(t)?"text-pink-500":["html","htm"].includes(t)?"text-orange-400":"text-[var(--color-text-muted)]"}function jwt({isOpen:e,fileName:t,onSave:r,onDiscard:n,onCancel:a}){return e?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center","data-testid":"save-confirm-dialog",children:[o.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:a}),o.jsxs("div",{className:"relative bg-[var(--color-surface)] rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text)] mb-2",children:"Unsaved Changes"}),o.jsxs("p",{className:"text-sm text-[var(--color-text-secondary)] mb-6",children:["Do you want to save the changes you made to"," ",o.jsxs("span",{className:"font-medium text-[var(--color-text)]",children:['"',t,'"']}),"?"]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-[var(--color-danger)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)]","data-testid":"save-confirm-discard",children:"Close Without Saving"}),o.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-[var(--color-text-secondary)] bg-[var(--color-surface)] border border-[var(--color-border)] rounded-md hover:bg-[var(--color-surface-hover)]","data-testid":"save-confirm-cancel",children:"Cancel"}),o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-[var(--color-primary)] rounded-md hover:bg-[var(--color-primary-hover)]","data-testid":"save-confirm-save",children:"Save & Close"})]})]})]}):null}function Bye({tab:e,isActive:t,onSelect:r,onClose:n,isDragging:a=!1}){const s=e.source==="extension"?hse:Nwt(e.name),i=e.source==="extension"?"text-purple-500":Cwt(e.name);return o.jsxs("div",{onClick:r,className:`
        group flex items-center gap-1.5 px-3 py-1.5 min-w-0 max-w-48 cursor-pointer
        border-r border-r-[var(--color-border)] transition-colors
        ${t?"bg-[var(--color-surface)] border-t-2 border-t-[var(--color-primary)]":"bg-[var(--color-surface-hover)] border-t-2 border-t-[var(--color-border)] hover:bg-[var(--color-surface)]"}
        ${a?"opacity-50":""}
      `,"data-testid":`editor-tab-${e.id}`,children:[e.hasUnsavedChanges?o.jsx("span",{className:"w-2 h-2 rounded-full bg-[var(--color-text-secondary)] flex-shrink-0","data-testid":`editor-tab-dirty-${e.id}`,title:"Unsaved changes"}):o.jsx(s,{className:`w-4 h-4 flex-shrink-0 ${t?i:"text-[var(--color-text-muted)]"}`}),o.jsx("span",{className:`truncate text-sm ${t?"text-[var(--color-text)]":"text-[var(--color-text-secondary)]"}`,title:e.path,children:e.name}),o.jsx("button",{onClick:n,className:`
          ml-1 p-0.5 rounded flex-shrink-0 transition-colors
          ${e.hasUnsavedChanges||t?"opacity-100":"opacity-0 group-hover:opacity-100"}
          hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text)]
        `,title:"Close (Ctrl+W)","data-testid":`editor-tab-close-${e.id}`,children:o.jsx(yt,{className:"w-3.5 h-3.5"})})]})}function Ewt({children:e,onClose:t,onCloseOthers:r,onCloseToRight:n,onCloseSaved:a,onCloseAll:s}){const i="flex items-center px-3 py-1.5 text-sm text-[var(--color-text)] data-[highlighted]:bg-[var(--color-surface-active)] cursor-pointer outline-none";return o.jsxs(Tse,{children:[o.jsx(Ase,{asChild:!0,children:e}),o.jsx(Dse,{children:o.jsxs(Lse,{className:"min-w-[180px] bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-lg py-1 z-50","data-testid":"tab-context-menu",children:[o.jsx(_i,{className:i,onSelect:t,"data-testid":"tab-context-menu-close",children:"Close"}),o.jsx(_i,{className:i,onSelect:r,"data-testid":"tab-context-menu-close-others",children:"Close Others"}),o.jsx(_i,{className:i,onSelect:n,"data-testid":"tab-context-menu-close-to-right",children:"Close to the Right"}),o.jsx(vk,{className:"h-px bg-[var(--color-border)] my-1"}),o.jsx(_i,{className:i,onSelect:a,"data-testid":"tab-context-menu-close-saved",children:"Close Saved"}),o.jsx(_i,{className:i,onSelect:s,"data-testid":"tab-context-menu-close-all",children:"Close All"})]})})]})}function Mwt({onContextClose:e,onContextCloseOthers:t,onContextCloseToRight:r,onContextCloseSaved:n,onContextCloseAll:a,...s}){const{attributes:i,listeners:l,setNodeRef:c,transform:u,transition:d,isDragging:f}=Rpe({id:s.tab.id}),m={transform:$l.Transform.toString(u),transition:d};return o.jsx(Ewt,{tab:s.tab,onClose:e,onCloseOthers:t,onCloseToRight:r,onCloseSaved:n,onCloseAll:a,children:o.jsx("div",{ref:c,style:m,...i,...l,children:o.jsx(Bye,{...s,isDragging:f})})})}function Twt({tabs:e,activeTabId:t,onTabSelect:r,onTabClose:n,onTabsReorder:a,onSaveRequest:s}){const[i,l]=w.useState(null),[c,u]=w.useState({isOpen:!1,tabId:"",fileName:""}),d=w.useRef([]),f=FB(fx(k1,{activationConstraint:{distance:8}}),fx(A2,{coordinateGetter:Ppe})),m=i?e.find(H=>H.id===i):null,p=H=>{l(H.active.id)},v=H=>{const{active:$,over:L}=H;if(l(null),!L||$.id===L.id)return;const A=e.findIndex(B=>B.id===$.id),M=e.findIndex(B=>B.id===L.id);if(A===-1||M===-1)return;const P=[...e],[I]=P.splice(A,1);P.splice(M,0,I),a(P)},b=w.useCallback((H,$)=>{H.stopPropagation(),$.hasUnsavedChanges?u({isOpen:!0,tabId:$.id,fileName:$.name}):n($.id)},[n]),y=w.useCallback(()=>{if(d.current.length===0)return;const H=d.current[0],$=e.find(L=>L.id===H);$?u({isOpen:!0,tabId:$.id,fileName:$.name}):(d.current.shift(),y())},[e]),S=w.useCallback(async()=>{const{tabId:H}=c;if(s)try{await s(H)}catch($){console.error("Failed to save file:",$)}n(H),u({isOpen:!1,tabId:"",fileName:""}),d.current.shift(),setTimeout(()=>y(),0)},[c,s,n,y]),_=w.useCallback(()=>{n(c.tabId),u({isOpen:!1,tabId:"",fileName:""}),d.current.shift(),setTimeout(()=>y(),0)},[c.tabId,n,y]),N=w.useCallback(()=>{u({isOpen:!1,tabId:"",fileName:""}),d.current=[]},[]),k=w.useCallback(H=>{const $=H.map(M=>e.find(P=>P.id===M)).filter(Boolean),L=$.filter(M=>!M.hasUnsavedChanges),A=$.filter(M=>M.hasUnsavedChanges);L.forEach(M=>n(M.id)),A.length>0&&(d.current=A.map(M=>M.id),y())},[e,n,y]),j=w.useCallback(H=>{k([H])},[k]),E=w.useCallback(H=>{const $=e.filter(L=>L.id!==H).map(L=>L.id);k($)},[e,k]),T=w.useCallback(H=>{const $=e.findIndex(A=>A.id===H);if($===-1)return;const L=e.slice($+1).map(A=>A.id);L.length!==0&&k(L)},[e,k]),O=w.useCallback(()=>{const H=e.filter($=>!$.hasUnsavedChanges).map($=>$.id);H.length!==0&&H.forEach($=>n($))},[e,n]),R=w.useCallback(()=>{const H=e.map($=>$.id);k(H)},[e,k]);return e.length===0?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-stretch bg-[var(--color-surface-elevated)] border-b border-[var(--color-border)] overflow-x-auto","data-testid":"editor-tab-bar",children:o.jsxs(vC,{sensors:f,collisionDetection:ttt,onDragStart:p,onDragEnd:v,children:[o.jsx(Ope,{items:e.map(H=>H.id),strategy:mrt,children:e.map(H=>o.jsx(Mwt,{tab:H,isActive:H.id===t,onSelect:()=>r(H.id),onClose:$=>b($,H),onContextClose:()=>j(H.id),onContextCloseOthers:()=>E(H.id),onContextCloseToRight:()=>T(H.id),onContextCloseSaved:O,onContextCloseAll:R},H.id))}),o.jsx(bC,{children:m&&o.jsx(Bye,{tab:m,isActive:m.id===t,onSelect:()=>{},onClose:()=>{}})})]})}),o.jsx(jwt,{isOpen:c.isOpen,fileName:c.fileName,onSave:S,onDiscard:_,onCancel:N})]})}const Awt=["typescript","javascript","typescriptreact","javascriptreact","python","rust","go","css","scss","less","html","json","jsonc"];function PC(e){return Awt.includes(e)}var Sf={},ck={},SO={},Lt={},Xa={},jne;function O1(){if(jne)return Xa;jne=1,Object.defineProperty(Xa,"__esModule",{value:!0}),Xa.stringArray=Xa.array=Xa.func=Xa.error=Xa.number=Xa.string=Xa.boolean=void 0;function e(l){return l===!0||l===!1}Xa.boolean=e;function t(l){return typeof l=="string"||l instanceof String}Xa.string=t;function r(l){return typeof l=="number"||l instanceof Number}Xa.number=r;function n(l){return l instanceof Error}Xa.error=n;function a(l){return typeof l=="function"}Xa.func=a;function s(l){return Array.isArray(l)}Xa.array=s;function i(l){return s(l)&&l.every(c=>t(c))}return Xa.stringArray=i,Xa}var Ene;function $ye(){if(Ene)return Lt;Ene=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.Message=Lt.NotificationType9=Lt.NotificationType8=Lt.NotificationType7=Lt.NotificationType6=Lt.NotificationType5=Lt.NotificationType4=Lt.NotificationType3=Lt.NotificationType2=Lt.NotificationType1=Lt.NotificationType0=Lt.NotificationType=Lt.RequestType9=Lt.RequestType8=Lt.RequestType7=Lt.RequestType6=Lt.RequestType5=Lt.RequestType4=Lt.RequestType3=Lt.RequestType2=Lt.RequestType1=Lt.RequestType=Lt.RequestType0=Lt.AbstractMessageSignature=Lt.ParameterStructures=Lt.ResponseError=Lt.ErrorCodes=void 0;const e=O1();var t;(function(L){L.ParseError=-32700,L.InvalidRequest=-32600,L.MethodNotFound=-32601,L.InvalidParams=-32602,L.InternalError=-32603,L.jsonrpcReservedErrorRangeStart=-32099,L.serverErrorStart=-32099,L.MessageWriteError=-32099,L.MessageReadError=-32098,L.PendingResponseRejected=-32097,L.ConnectionInactive=-32096,L.ServerNotInitialized=-32002,L.UnknownErrorCode=-32001,L.jsonrpcReservedErrorRangeEnd=-32e3,L.serverErrorEnd=-32e3})(t||(Lt.ErrorCodes=t={}));class r extends Error{constructor(A,M,P){super(M),this.code=e.number(A)?A:t.UnknownErrorCode,this.data=P,Object.setPrototypeOf(this,r.prototype)}toJson(){const A={code:this.code,message:this.message};return this.data!==void 0&&(A.data=this.data),A}}Lt.ResponseError=r;class n{constructor(A){this.kind=A}static is(A){return A===n.auto||A===n.byName||A===n.byPosition}toString(){return this.kind}}Lt.ParameterStructures=n,n.auto=new n("auto"),n.byPosition=new n("byPosition"),n.byName=new n("byName");class a{constructor(A,M){this.method=A,this.numberOfParams=M}get parameterStructures(){return n.auto}}Lt.AbstractMessageSignature=a;class s extends a{constructor(A){super(A,0)}}Lt.RequestType0=s;class i extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Lt.RequestType=i;class l extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Lt.RequestType1=l;class c extends a{constructor(A){super(A,2)}}Lt.RequestType2=c;class u extends a{constructor(A){super(A,3)}}Lt.RequestType3=u;class d extends a{constructor(A){super(A,4)}}Lt.RequestType4=d;class f extends a{constructor(A){super(A,5)}}Lt.RequestType5=f;class m extends a{constructor(A){super(A,6)}}Lt.RequestType6=m;class p extends a{constructor(A){super(A,7)}}Lt.RequestType7=p;class v extends a{constructor(A){super(A,8)}}Lt.RequestType8=v;class b extends a{constructor(A){super(A,9)}}Lt.RequestType9=b;class y extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Lt.NotificationType=y;class S extends a{constructor(A){super(A,0)}}Lt.NotificationType0=S;class _ extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Lt.NotificationType1=_;class N extends a{constructor(A){super(A,2)}}Lt.NotificationType2=N;class k extends a{constructor(A){super(A,3)}}Lt.NotificationType3=k;class j extends a{constructor(A){super(A,4)}}Lt.NotificationType4=j;class E extends a{constructor(A){super(A,5)}}Lt.NotificationType5=E;class T extends a{constructor(A){super(A,6)}}Lt.NotificationType6=T;class O extends a{constructor(A){super(A,7)}}Lt.NotificationType7=O;class R extends a{constructor(A){super(A,8)}}Lt.NotificationType8=R;class H extends a{constructor(A){super(A,9)}}Lt.NotificationType9=H;var $;return(function(L){function A(I){const B=I;return B&&e.string(B.method)&&(e.string(B.id)||e.number(B.id))}L.isRequest=A;function M(I){const B=I;return B&&e.string(B.method)&&I.id===void 0}L.isNotification=M;function P(I){const B=I;return B&&(B.result!==void 0||!!B.error)&&(e.string(B.id)||e.number(B.id)||B.id===null)}L.isResponse=P})($||(Lt.Message=$={})),Lt}var Sc={},Mne;function Fye(){if(Mne)return Sc;Mne=1;var e;Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.LRUCache=Sc.LinkedMap=Sc.Touch=void 0;var t;(function(a){a.None=0,a.First=1,a.AsOld=a.First,a.Last=2,a.AsNew=a.Last})(t||(Sc.Touch=t={}));class r{constructor(){this[e]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(s){return this._map.has(s)}get(s,i=t.None){const l=this._map.get(s);if(l)return i!==t.None&&this.touch(l,i),l.value}set(s,i,l=t.None){let c=this._map.get(s);if(c)c.value=i,l!==t.None&&this.touch(c,l);else{switch(c={key:s,value:i,next:void 0,previous:void 0},l){case t.None:this.addItemLast(c);break;case t.First:this.addItemFirst(c);break;case t.Last:this.addItemLast(c);break;default:this.addItemLast(c);break}this._map.set(s,c),this._size++}return this}delete(s){return!!this.remove(s)}remove(s){const i=this._map.get(s);if(i)return this._map.delete(s),this.removeItem(i),this._size--,i.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const s=this._head;return this._map.delete(s.key),this.removeItem(s),this._size--,s.value}forEach(s,i){const l=this._state;let c=this._head;for(;c;){if(i?s.bind(i)(c.value,c.key,this):s(c.value,c.key,this),this._state!==l)throw new Error("LinkedMap got modified during iteration.");c=c.next}}keys(){const s=this._state;let i=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(i){const c={value:i.key,done:!1};return i=i.next,c}else return{value:void 0,done:!0}}};return l}values(){const s=this._state;let i=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(i){const c={value:i.value,done:!1};return i=i.next,c}else return{value:void 0,done:!0}}};return l}entries(){const s=this._state;let i=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(i){const c={value:[i.key,i.value],done:!1};return i=i.next,c}else return{value:void 0,done:!0}}};return l}[(e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(s){if(s>=this.size)return;if(s===0){this.clear();return}let i=this._head,l=this.size;for(;i&&l>s;)this._map.delete(i.key),i=i.next,l--;this._head=i,this._size=l,i&&(i.previous=void 0),this._state++}addItemFirst(s){if(!this._head&&!this._tail)this._tail=s;else if(this._head)s.next=this._head,this._head.previous=s;else throw new Error("Invalid list");this._head=s,this._state++}addItemLast(s){if(!this._head&&!this._tail)this._head=s;else if(this._tail)s.previous=this._tail,this._tail.next=s;else throw new Error("Invalid list");this._tail=s,this._state++}removeItem(s){if(s===this._head&&s===this._tail)this._head=void 0,this._tail=void 0;else if(s===this._head){if(!s.next)throw new Error("Invalid list");s.next.previous=void 0,this._head=s.next}else if(s===this._tail){if(!s.previous)throw new Error("Invalid list");s.previous.next=void 0,this._tail=s.previous}else{const i=s.next,l=s.previous;if(!i||!l)throw new Error("Invalid list");i.previous=l,l.next=i}s.next=void 0,s.previous=void 0,this._state++}touch(s,i){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(i!==t.First&&i!==t.Last)){if(i===t.First){if(s===this._head)return;const l=s.next,c=s.previous;s===this._tail?(c.next=void 0,this._tail=c):(l.previous=c,c.next=l),s.previous=void 0,s.next=this._head,this._head.previous=s,this._head=s,this._state++}else if(i===t.Last){if(s===this._tail)return;const l=s.next,c=s.previous;s===this._head?(l.previous=void 0,this._head=l):(l.previous=c,c.next=l),s.next=void 0,s.previous=this._tail,this._tail.next=s,this._tail=s,this._state++}}}toJSON(){const s=[];return this.forEach((i,l)=>{s.push([l,i])}),s}fromJSON(s){this.clear();for(const[i,l]of s)this.set(i,l)}}Sc.LinkedMap=r;class n extends r{constructor(s,i=1){super(),this._limit=s,this._ratio=Math.min(Math.max(0,i),1)}get limit(){return this._limit}set limit(s){this._limit=s,this.checkTrim()}get ratio(){return this._ratio}set ratio(s){this._ratio=Math.min(Math.max(0,s),1),this.checkTrim()}get(s,i=t.AsNew){return super.get(s,i)}peek(s){return super.get(s,t.None)}set(s,i){return super.set(s,i,t.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return Sc.LRUCache=n,Sc}var Vv={},Tne;function Dwt(){if(Tne)return Vv;Tne=1,Object.defineProperty(Vv,"__esModule",{value:!0}),Vv.Disposable=void 0;var e;return(function(t){function r(n){return{dispose:n}}t.create=r})(e||(Vv.Disposable=e={})),Vv}var kf={},uk={},Ane;function mm(){if(Ane)return uk;Ane=1,Object.defineProperty(uk,"__esModule",{value:!0});let e;function t(){if(e===void 0)throw new Error("No runtime abstraction layer installed");return e}return(function(r){function n(a){if(a===void 0)throw new Error("No runtime abstraction layer provided");e=a}r.install=n})(t||(t={})),uk.default=t,uk}var Dne;function I1(){if(Dne)return kf;Dne=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.Emitter=kf.Event=void 0;const e=mm();var t;(function(a){const s={dispose(){}};a.None=function(){return s}})(t||(kf.Event=t={}));class r{add(s,i=null,l){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(s),this._contexts.push(i),Array.isArray(l)&&l.push({dispose:()=>this.remove(s,i)})}remove(s,i=null){if(!this._callbacks)return;let l=!1;for(let c=0,u=this._callbacks.length;c<u;c++)if(this._callbacks[c]===s)if(this._contexts[c]===i){this._callbacks.splice(c,1),this._contexts.splice(c,1);return}else l=!0;if(l)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...s){if(!this._callbacks)return[];const i=[],l=this._callbacks.slice(0),c=this._contexts.slice(0);for(let u=0,d=l.length;u<d;u++)try{i.push(l[u].apply(c[u],s))}catch(f){(0,e.default)().console.error(f)}return i}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(s){this._options=s}get event(){return this._event||(this._event=(s,i,l)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(s,i);const c={dispose:()=>{this._callbacks&&(this._callbacks.remove(s,i),c.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(l)&&l.push(c),c}),this._event}fire(s){this._callbacks&&this._callbacks.invoke.call(this._callbacks,s)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return kf.Emitter=n,n._noop=function(){},kf}var _f={},Lne;function Q$(){if(Lne)return _f;Lne=1,Object.defineProperty(_f,"__esModule",{value:!0}),_f.CancellationTokenSource=_f.CancellationToken=void 0;const e=mm(),t=O1(),r=I1();var n;(function(l){l.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),l.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None});function c(u){const d=u;return d&&(d===l.None||d===l.Cancelled||t.boolean(d.isCancellationRequested)&&!!d.onCancellationRequested)}l.is=c})(n||(_f.CancellationToken=n={}));const a=Object.freeze(function(l,c){const u=(0,e.default)().timer.setTimeout(l.bind(c),0);return{dispose(){u.dispose()}}});class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class i{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=n.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=n.None}}return _f.CancellationTokenSource=i,_f}var Nf={},One;function Lwt(){if(One)return Nf;One=1,Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.SharedArrayReceiverStrategy=Nf.SharedArraySenderStrategy=void 0;const e=Q$();var t;(function(i){i.Continue=0,i.Cancelled=1})(t||(t={}));class r{constructor(){this.buffers=new Map}enableCancellation(l){if(l.id===null)return;const c=new SharedArrayBuffer(4),u=new Int32Array(c,0,1);u[0]=t.Continue,this.buffers.set(l.id,c),l.$cancellationData=c}async sendCancellation(l,c){const u=this.buffers.get(c);if(u===void 0)return;const d=new Int32Array(u,0,1);Atomics.store(d,0,t.Cancelled)}cleanup(l){this.buffers.delete(l)}dispose(){this.buffers.clear()}}Nf.SharedArraySenderStrategy=r;class n{constructor(l){this.data=new Int32Array(l,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===t.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class a{constructor(l){this.token=new n(l)}cancel(){}dispose(){}}class s{constructor(){this.kind="request"}createCancellationTokenSource(l){const c=l.$cancellationData;return c===void 0?new e.CancellationTokenSource:new a(c)}}return Nf.SharedArrayReceiverStrategy=s,Nf}var kc={},Yv={},Ine;function Uye(){if(Ine)return Yv;Ine=1,Object.defineProperty(Yv,"__esModule",{value:!0}),Yv.Semaphore=void 0;const e=mm();class t{constructor(n=1){if(n<=0)throw new Error("Capacity must be greater than 0");this._capacity=n,this._active=0,this._waiting=[]}lock(n){return new Promise((a,s)=>{this._waiting.push({thunk:n,resolve:a,reject:s}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const n=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const a=n.thunk();a instanceof Promise?a.then(s=>{this._active--,n.resolve(s),this.runNext()},s=>{this._active--,n.reject(s),this.runNext()}):(this._active--,n.resolve(a),this.runNext())}catch(a){this._active--,n.reject(a),this.runNext()}}}return Yv.Semaphore=t,Yv}var Rne;function Owt(){if(Rne)return kc;Rne=1,Object.defineProperty(kc,"__esModule",{value:!0}),kc.ReadableStreamMessageReader=kc.AbstractMessageReader=kc.MessageReader=void 0;const e=mm(),t=O1(),r=I1(),n=Uye();var a;(function(c){function u(d){let f=d;return f&&t.func(f.listen)&&t.func(f.dispose)&&t.func(f.onError)&&t.func(f.onClose)&&t.func(f.onPartialMessage)}c.is=u})(a||(kc.MessageReader=a={}));class s{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(u){this.errorEmitter.fire(this.asError(u))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(u){this.partialMessageEmitter.fire(u)}asError(u){return u instanceof Error?u:new Error(`Reader received error. Reason: ${t.string(u.message)?u.message:"unknown"}`)}}kc.AbstractMessageReader=s;var i;(function(c){function u(d){let f,m;const p=new Map;let v;const b=new Map;if(d===void 0||typeof d=="string")f=d??"utf-8";else{if(f=d.charset??"utf-8",d.contentDecoder!==void 0&&(m=d.contentDecoder,p.set(m.name,m)),d.contentDecoders!==void 0)for(const y of d.contentDecoders)p.set(y.name,y);if(d.contentTypeDecoder!==void 0&&(v=d.contentTypeDecoder,b.set(v.name,v)),d.contentTypeDecoders!==void 0)for(const y of d.contentTypeDecoders)b.set(y.name,y)}return v===void 0&&(v=(0,e.default)().applicationJson.decoder,b.set(v.name,v)),{charset:f,contentDecoder:m,contentDecoders:p,contentTypeDecoder:v,contentTypeDecoders:b}}c.fromOptions=u})(i||(i={}));class l extends s{constructor(u,d){super(),this.readable=u,this.options=i.fromOptions(d),this.buffer=(0,e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new n.Semaphore(1)}set partialMessageTimeout(u){this._partialMessageTimeout=u}get partialMessageTimeout(){return this._partialMessageTimeout}listen(u){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=u;const d=this.readable.onData(f=>{this.onData(f)});return this.readable.onError(f=>this.fireError(f)),this.readable.onClose(()=>this.fireClose()),d}onData(u){try{for(this.buffer.append(u);;){if(this.nextMessageLength===-1){const f=this.buffer.tryReadHeaders(!0);if(!f)return;const m=f.get("content-length");if(!m){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(f))}`));return}const p=parseInt(m);if(isNaN(p)){this.fireError(new Error(`Content-Length value must be a number. Got ${m}`));return}this.nextMessageLength=p}const d=this.buffer.tryReadBody(this.nextMessageLength);if(d===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const f=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(d):d,m=await this.options.contentTypeDecoder.decode(f,this.options);this.callback(m)}).catch(f=>{this.fireError(f)})}}catch(d){this.fireError(d)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,e.default)().timer.setTimeout((u,d)=>{this.partialMessageTimer=void 0,u===this.messageToken&&(this.firePartialMessage({messageToken:u,waitingTime:d}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return kc.ReadableStreamMessageReader=l,kc}var _c={},Pne;function Iwt(){if(Pne)return _c;Pne=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.WriteableStreamMessageWriter=_c.AbstractMessageWriter=_c.MessageWriter=void 0;const e=mm(),t=O1(),r=Uye(),n=I1(),a="Content-Length: ",s=`\r
`;var i;(function(d){function f(m){let p=m;return p&&t.func(p.dispose)&&t.func(p.onClose)&&t.func(p.onError)&&t.func(p.write)}d.is=f})(i||(_c.MessageWriter=i={}));class l{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(f,m,p){this.errorEmitter.fire([this.asError(f),m,p])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(f){return f instanceof Error?f:new Error(`Writer received error. Reason: ${t.string(f.message)?f.message:"unknown"}`)}}_c.AbstractMessageWriter=l;var c;(function(d){function f(m){return m===void 0||typeof m=="string"?{charset:m??"utf-8",contentTypeEncoder:(0,e.default)().applicationJson.encoder}:{charset:m.charset??"utf-8",contentEncoder:m.contentEncoder,contentTypeEncoder:m.contentTypeEncoder??(0,e.default)().applicationJson.encoder}}d.fromOptions=f})(c||(c={}));class u extends l{constructor(f,m){super(),this.writable=f,this.options=c.fromOptions(m),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError(p=>this.fireError(p)),this.writable.onClose(()=>this.fireClose())}async write(f){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(f,this.options).then(p=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(p):p).then(p=>{const v=[];return v.push(a,p.byteLength.toString(),s),v.push(s),this.doWrite(f,v,p)},p=>{throw this.fireError(p),p}))}async doWrite(f,m,p){try{return await this.writable.write(m.join(""),"ascii"),this.writable.write(p)}catch(v){return this.handleError(v,f),Promise.reject(v)}}handleError(f,m){this.errorCount++,this.fireError(f,m,this.errorCount)}end(){this.writable.end()}}return _c.WriteableStreamMessageWriter=u,_c}var Qv={},zne;function Rwt(){if(zne)return Qv;zne=1,Object.defineProperty(Qv,"__esModule",{value:!0}),Qv.AbstractMessageBuffer=void 0;const e=13,t=10,r=`\r
`;class n{constructor(s="utf-8"){this._encoding=s,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(s){const i=typeof s=="string"?this.fromString(s,this._encoding):s;this._chunks.push(i),this._totalLength+=i.byteLength}tryReadHeaders(s=!1){if(this._chunks.length===0)return;let i=0,l=0,c=0,u=0;e:for(;l<this._chunks.length;){const p=this._chunks[l];for(c=0;c<p.length;){switch(p[c]){case e:switch(i){case 0:i=1;break;case 2:i=3;break;default:i=0}break;case t:switch(i){case 1:i=2;break;case 3:i=4,c++;break e;default:i=0}break;default:i=0}c++}u+=p.byteLength,l++}if(i!==4)return;const d=this._read(u+c),f=new Map,m=this.toString(d,"ascii").split(r);if(m.length<2)return f;for(let p=0;p<m.length-2;p++){const v=m[p],b=v.indexOf(":");if(b===-1)throw new Error(`Message header must separate key and value using ':'
${v}`);const y=v.substr(0,b),S=v.substr(b+1).trim();f.set(s?y.toLowerCase():y,S)}return f}tryReadBody(s){if(!(this._totalLength<s))return this._read(s)}get numberOfBytes(){return this._totalLength}_read(s){if(s===0)return this.emptyBuffer();if(s>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===s){const u=this._chunks[0];return this._chunks.shift(),this._totalLength-=s,this.asNative(u)}if(this._chunks[0].byteLength>s){const u=this._chunks[0],d=this.asNative(u,s);return this._chunks[0]=u.slice(s),this._totalLength-=s,d}const i=this.allocNative(s);let l=0,c=0;for(;s>0;){const u=this._chunks[c];if(u.byteLength>s){const d=u.slice(0,s);i.set(d,l),l+=s,this._chunks[c]=u.slice(s),this._totalLength-=s,s-=s}else i.set(u,l),l+=u.byteLength,this._chunks.shift(),this._totalLength-=u.byteLength,s-=u.byteLength}return i}}return Qv.AbstractMessageBuffer=n,Qv}var kO={},Bne;function Pwt(){return Bne||(Bne=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const t=mm(),r=O1(),n=$ye(),a=Fye(),s=I1(),i=Q$();var l;(function(A){A.type=new n.NotificationType("$/cancelRequest")})(l||(l={}));var c;(function(A){function M(P){return typeof P=="string"||typeof P=="number"}A.is=M})(c||(e.ProgressToken=c={}));var u;(function(A){A.type=new n.NotificationType("$/progress")})(u||(u={}));class d{constructor(){}}e.ProgressType=d;var f;(function(A){function M(P){return r.func(P)}A.is=M})(f||(f={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var m;(function(A){A[A.Off=0]="Off",A[A.Messages=1]="Messages",A[A.Compact=2]="Compact",A[A.Verbose=3]="Verbose"})(m||(e.Trace=m={}));var p;(function(A){A.Off="off",A.Messages="messages",A.Compact="compact",A.Verbose="verbose"})(p||(e.TraceValues=p={})),(function(A){function M(I){if(!r.string(I))return A.Off;switch(I=I.toLowerCase(),I){case"off":return A.Off;case"messages":return A.Messages;case"compact":return A.Compact;case"verbose":return A.Verbose;default:return A.Off}}A.fromString=M;function P(I){switch(I){case A.Off:return"off";case A.Messages:return"messages";case A.Compact:return"compact";case A.Verbose:return"verbose";default:return"off"}}A.toString=P})(m||(e.Trace=m={}));var v;(function(A){A.Text="text",A.JSON="json"})(v||(e.TraceFormat=v={})),(function(A){function M(P){return r.string(P)?(P=P.toLowerCase(),P==="json"?A.JSON:A.Text):A.Text}A.fromString=M})(v||(e.TraceFormat=v={}));var b;(function(A){A.type=new n.NotificationType("$/setTrace")})(b||(e.SetTraceNotification=b={}));var y;(function(A){A.type=new n.NotificationType("$/logTrace")})(y||(e.LogTraceNotification=y={}));var S;(function(A){A[A.Closed=1]="Closed",A[A.Disposed=2]="Disposed",A[A.AlreadyListening=3]="AlreadyListening"})(S||(e.ConnectionErrors=S={}));class _ extends Error{constructor(M,P){super(P),this.code=M,Object.setPrototypeOf(this,_.prototype)}}e.ConnectionError=_;var N;(function(A){function M(P){const I=P;return I&&r.func(I.cancelUndispatched)}A.is=M})(N||(e.ConnectionStrategy=N={}));var k;(function(A){function M(P){const I=P;return I&&(I.kind===void 0||I.kind==="id")&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(k||(e.IdCancellationReceiverStrategy=k={}));var j;(function(A){function M(P){const I=P;return I&&I.kind==="request"&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(j||(e.RequestCancellationReceiverStrategy=j={}));var E;(function(A){A.Message=Object.freeze({createCancellationTokenSource(P){return new i.CancellationTokenSource}});function M(P){return k.is(P)||j.is(P)}A.is=M})(E||(e.CancellationReceiverStrategy=E={}));var T;(function(A){A.Message=Object.freeze({sendCancellation(P,I){return P.sendNotification(l.type,{id:I})},cleanup(P){}});function M(P){const I=P;return I&&r.func(I.sendCancellation)&&r.func(I.cleanup)}A.is=M})(T||(e.CancellationSenderStrategy=T={}));var O;(function(A){A.Message=Object.freeze({receiver:E.Message,sender:T.Message});function M(P){const I=P;return I&&E.is(I.receiver)&&T.is(I.sender)}A.is=M})(O||(e.CancellationStrategy=O={}));var R;(function(A){function M(P){const I=P;return I&&r.func(I.handleMessage)}A.is=M})(R||(e.MessageStrategy=R={}));var H;(function(A){function M(P){const I=P;return I&&(O.is(I.cancellationStrategy)||N.is(I.connectionStrategy)||R.is(I.messageStrategy))}A.is=M})(H||(e.ConnectionOptions=H={}));var $;(function(A){A[A.New=1]="New",A[A.Listening=2]="Listening",A[A.Closed=3]="Closed",A[A.Disposed=4]="Disposed"})($||($={}));function L(A,M,P,I){const B=P!==void 0?P:e.NullLogger;let F=0,q=0,Q=0;const W="2.0";let G;const J=new Map;let X;const V=new Map,se=new Map;let de,he=new a.LinkedMap,te=new Map,le=new Set,oe=new Map,Z=m.Off,ve=v.Text,U,ge=$.New;const ue=new s.Emitter,re=new s.Emitter,ne=new s.Emitter,me=new s.Emitter,ke=new s.Emitter,we=I&&I.cancellationStrategy?I.cancellationStrategy:O.Message;function pe(K){if(K===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+K.toString()}function Oe(K){return K===null?"res-unknown-"+(++Q).toString():"res-"+K.toString()}function Ae(){return"not-"+(++q).toString()}function Re(K,ie){n.Message.isRequest(ie)?K.set(pe(ie.id),ie):n.Message.isResponse(ie)?K.set(Oe(ie.id),ie):K.set(Ae(),ie)}function Ve(K){}function gt(){return ge===$.Listening}function lt(){return ge===$.Closed}function Pt(){return ge===$.Disposed}function fr(){(ge===$.New||ge===$.Listening)&&(ge=$.Closed,re.fire(void 0))}function Qe(K){ue.fire([K,void 0,void 0])}function Vt(K){ue.fire(K)}A.onClose(fr),A.onError(Qe),M.onClose(fr),M.onError(Vt);function at(){de||he.size===0||(de=(0,t.default)().timer.setImmediate(()=>{de=void 0,Fe()}))}function Ne(K){n.Message.isRequest(K)?Tt(K):n.Message.isNotification(K)?Zt(K):n.Message.isResponse(K)?wt(K):Xe(K)}function Fe(){if(he.size===0)return;const K=he.shift();try{const ie=I?.messageStrategy;R.is(ie)?ie.handleMessage(K,Ne):Ne(K)}finally{at()}}const Ke=K=>{try{if(n.Message.isNotification(K)&&K.method===l.type.method){const ie=K.params.id,xe=pe(ie),Ce=he.get(xe);if(n.Message.isRequest(Ce)){const ot=I?.connectionStrategy,Dt=ot&&ot.cancelUndispatched?ot.cancelUndispatched(Ce,Ve):void 0;if(Dt&&(Dt.error!==void 0||Dt.result!==void 0)){he.delete(xe),oe.delete(ie),Dt.id=Ce.id,fe(Dt,K.method,Date.now()),M.write(Dt).catch(()=>B.error("Sending response for canceled message failed."));return}}const ht=oe.get(ie);if(ht!==void 0){ht.cancel(),Ue(K);return}else le.add(ie)}Re(he,K)}finally{at()}};function Tt(K){if(Pt())return;function ie(ct,Bt,ut){const qt={jsonrpc:W,id:K.id};ct instanceof n.ResponseError?qt.error=ct.toJson():qt.result=ct===void 0?null:ct,fe(qt,Bt,ut),M.write(qt).catch(()=>B.error("Sending response failed."))}function xe(ct,Bt,ut){const qt={jsonrpc:W,id:K.id,error:ct.toJson()};fe(qt,Bt,ut),M.write(qt).catch(()=>B.error("Sending response failed."))}function Ce(ct,Bt,ut){ct===void 0&&(ct=null);const qt={jsonrpc:W,id:K.id,result:ct};fe(qt,Bt,ut),M.write(qt).catch(()=>B.error("Sending response failed."))}De(K);const ht=J.get(K.method);let ot,Dt;ht&&(ot=ht.type,Dt=ht.handler);const Ut=Date.now();if(Dt||G){const ct=K.id??String(Date.now()),Bt=k.is(we.receiver)?we.receiver.createCancellationTokenSource(ct):we.receiver.createCancellationTokenSource(K);K.id!==null&&le.has(K.id)&&Bt.cancel(),K.id!==null&&oe.set(ct,Bt);try{let ut;if(Dt)if(K.params===void 0){if(ot!==void 0&&ot.numberOfParams!==0){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${K.method} defines ${ot.numberOfParams} params but received none.`),K.method,Ut);return}ut=Dt(Bt.token)}else if(Array.isArray(K.params)){if(ot!==void 0&&ot.parameterStructures===n.ParameterStructures.byName){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${K.method} defines parameters by name but received parameters by position`),K.method,Ut);return}ut=Dt(...K.params,Bt.token)}else{if(ot!==void 0&&ot.parameterStructures===n.ParameterStructures.byPosition){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${K.method} defines parameters by position but received parameters by name`),K.method,Ut);return}ut=Dt(K.params,Bt.token)}else G&&(ut=G(K.method,K.params,Bt.token));const qt=ut;ut?qt.then?qt.then(nr=>{oe.delete(ct),ie(nr,K.method,Ut)},nr=>{oe.delete(ct),nr instanceof n.ResponseError?xe(nr,K.method,Ut):nr&&r.string(nr.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed with message: ${nr.message}`),K.method,Ut):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed unexpectedly without providing any details.`),K.method,Ut)}):(oe.delete(ct),ie(ut,K.method,Ut)):(oe.delete(ct),Ce(ut,K.method,Ut))}catch(ut){oe.delete(ct),ut instanceof n.ResponseError?ie(ut,K.method,Ut):ut&&r.string(ut.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed with message: ${ut.message}`),K.method,Ut):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed unexpectedly without providing any details.`),K.method,Ut)}}else xe(new n.ResponseError(n.ErrorCodes.MethodNotFound,`Unhandled method ${K.method}`),K.method,Ut)}function wt(K){if(!Pt())if(K.id===null)K.error?B.error(`Received response message without id: Error is: 
${JSON.stringify(K.error,void 0,4)}`):B.error("Received response message without id. No further error information provided.");else{const ie=K.id,xe=te.get(ie);if(dt(K,xe),xe!==void 0){te.delete(ie);try{if(K.error){const Ce=K.error;xe.reject(new n.ResponseError(Ce.code,Ce.message,Ce.data))}else if(K.result!==void 0)xe.resolve(K.result);else throw new Error("Should never happen.")}catch(Ce){Ce.message?B.error(`Response handler '${xe.method}' failed with message: ${Ce.message}`):B.error(`Response handler '${xe.method}' failed unexpectedly.`)}}}}function Zt(K){if(Pt())return;let ie,xe;if(K.method===l.type.method){const Ce=K.params.id;le.delete(Ce),Ue(K);return}else{const Ce=V.get(K.method);Ce&&(xe=Ce.handler,ie=Ce.type)}if(xe||X)try{if(Ue(K),xe)if(K.params===void 0)ie!==void 0&&ie.numberOfParams!==0&&ie.parameterStructures!==n.ParameterStructures.byName&&B.error(`Notification ${K.method} defines ${ie.numberOfParams} params but received none.`),xe();else if(Array.isArray(K.params)){const Ce=K.params;K.method===u.type.method&&Ce.length===2&&c.is(Ce[0])?xe({token:Ce[0],value:Ce[1]}):(ie!==void 0&&(ie.parameterStructures===n.ParameterStructures.byName&&B.error(`Notification ${K.method} defines parameters by name but received parameters by position`),ie.numberOfParams!==K.params.length&&B.error(`Notification ${K.method} defines ${ie.numberOfParams} params but received ${Ce.length} arguments`)),xe(...Ce))}else ie!==void 0&&ie.parameterStructures===n.ParameterStructures.byPosition&&B.error(`Notification ${K.method} defines parameters by position but received parameters by name`),xe(K.params);else X&&X(K.method,K.params)}catch(Ce){Ce.message?B.error(`Notification handler '${K.method}' failed with message: ${Ce.message}`):B.error(`Notification handler '${K.method}' failed unexpectedly.`)}else ne.fire(K)}function Xe(K){if(!K){B.error("Received empty message.");return}B.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(K,null,4)}`);const ie=K;if(r.string(ie.id)||r.number(ie.id)){const xe=ie.id,Ce=te.get(xe);Ce&&Ce.reject(new Error("The received response has neither a result nor an error property."))}}function nt(K){if(K!=null)switch(Z){case m.Verbose:return JSON.stringify(K,null,4);case m.Compact:return JSON.stringify(K);default:return}}function bt(K){if(!(Z===m.Off||!U))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&K.params&&(ie=`Params: ${nt(K.params)}

`),U.log(`Sending request '${K.method} - (${K.id})'.`,ie)}else Nt("send-request",K)}function Ct(K){if(!(Z===m.Off||!U))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&(K.params?ie=`Params: ${nt(K.params)}

`:ie=`No parameters provided.

`),U.log(`Sending notification '${K.method}'.`,ie)}else Nt("send-notification",K)}function fe(K,ie,xe){if(!(Z===m.Off||!U))if(ve===v.Text){let Ce;(Z===m.Verbose||Z===m.Compact)&&(K.error&&K.error.data?Ce=`Error data: ${nt(K.error.data)}

`:K.result?Ce=`Result: ${nt(K.result)}

`:K.error===void 0&&(Ce=`No result returned.

`)),U.log(`Sending response '${ie} - (${K.id})'. Processing request took ${Date.now()-xe}ms`,Ce)}else Nt("send-response",K)}function De(K){if(!(Z===m.Off||!U))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&K.params&&(ie=`Params: ${nt(K.params)}

`),U.log(`Received request '${K.method} - (${K.id})'.`,ie)}else Nt("receive-request",K)}function Ue(K){if(!(Z===m.Off||!U||K.method===y.type.method))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&(K.params?ie=`Params: ${nt(K.params)}

`:ie=`No parameters provided.

`),U.log(`Received notification '${K.method}'.`,ie)}else Nt("receive-notification",K)}function dt(K,ie){if(!(Z===m.Off||!U))if(ve===v.Text){let xe;if((Z===m.Verbose||Z===m.Compact)&&(K.error&&K.error.data?xe=`Error data: ${nt(K.error.data)}

`:K.result?xe=`Result: ${nt(K.result)}

`:K.error===void 0&&(xe=`No result returned.

`)),ie){const Ce=K.error?` Request failed: ${K.error.message} (${K.error.code}).`:"";U.log(`Received response '${ie.method} - (${K.id})' in ${Date.now()-ie.timerStart}ms.${Ce}`,xe)}else U.log(`Received response ${K.id} without active response promise.`,xe)}else Nt("receive-response",K)}function Nt(K,ie){if(!U||Z===m.Off)return;const xe={isLSPMessage:!0,type:K,message:ie,timestamp:Date.now()};U.log(xe)}function Mt(){if(lt())throw new _(S.Closed,"Connection is closed.");if(Pt())throw new _(S.Disposed,"Connection is disposed.")}function Je(){if(gt())throw new _(S.AlreadyListening,"Connection is already listening")}function et(){if(!gt())throw new Error("Call listen() first.")}function it(K){return K===void 0?null:K}function tr(K){if(K!==null)return K}function ee(K){return K!=null&&!Array.isArray(K)&&typeof K=="object"}function Le(K,ie){switch(K){case n.ParameterStructures.auto:return ee(ie)?tr(ie):[it(ie)];case n.ParameterStructures.byName:if(!ee(ie))throw new Error("Received parameters by name but param is not an object literal.");return tr(ie);case n.ParameterStructures.byPosition:return[it(ie)];default:throw new Error(`Unknown parameter structure ${K.toString()}`)}}function We(K,ie){let xe;const Ce=K.numberOfParams;switch(Ce){case 0:xe=void 0;break;case 1:xe=Le(K.parameterStructures,ie[0]);break;default:xe=[];for(let ht=0;ht<ie.length&&ht<Ce;ht++)xe.push(it(ie[ht]));if(ie.length<Ce)for(let ht=ie.length;ht<Ce;ht++)xe.push(null);break}return xe}const be={sendNotification:(K,...ie)=>{Mt();let xe,Ce;if(r.string(K)){xe=K;const ot=ie[0];let Dt=0,Ut=n.ParameterStructures.auto;n.ParameterStructures.is(ot)&&(Dt=1,Ut=ot);let ct=ie.length;const Bt=ct-Dt;switch(Bt){case 0:Ce=void 0;break;case 1:Ce=Le(Ut,ie[Dt]);break;default:if(Ut===n.ParameterStructures.byName)throw new Error(`Received ${Bt} parameters for 'by Name' notification parameter structure.`);Ce=ie.slice(Dt,ct).map(ut=>it(ut));break}}else{const ot=ie;xe=K.method,Ce=We(K,ot)}const ht={jsonrpc:W,method:xe,params:Ce};return Ct(ht),M.write(ht).catch(ot=>{throw B.error("Sending notification failed."),ot})},onNotification:(K,ie)=>{Mt();let xe;return r.func(K)?X=K:ie&&(r.string(K)?(xe=K,V.set(K,{type:void 0,handler:ie})):(xe=K.method,V.set(K.method,{type:K,handler:ie}))),{dispose:()=>{xe!==void 0?V.delete(xe):X=void 0}}},onProgress:(K,ie,xe)=>{if(se.has(ie))throw new Error(`Progress handler for token ${ie} already registered`);return se.set(ie,xe),{dispose:()=>{se.delete(ie)}}},sendProgress:(K,ie,xe)=>be.sendNotification(u.type,{token:ie,value:xe}),onUnhandledProgress:me.event,sendRequest:(K,...ie)=>{Mt(),et();let xe,Ce,ht;if(r.string(K)){xe=K;const ct=ie[0],Bt=ie[ie.length-1];let ut=0,qt=n.ParameterStructures.auto;n.ParameterStructures.is(ct)&&(ut=1,qt=ct);let nr=ie.length;i.CancellationToken.is(Bt)&&(nr=nr-1,ht=Bt);const Dr=nr-ut;switch(Dr){case 0:Ce=void 0;break;case 1:Ce=Le(qt,ie[ut]);break;default:if(qt===n.ParameterStructures.byName)throw new Error(`Received ${Dr} parameters for 'by Name' request parameter structure.`);Ce=ie.slice(ut,nr).map(vn=>it(vn));break}}else{const ct=ie;xe=K.method,Ce=We(K,ct);const Bt=K.numberOfParams;ht=i.CancellationToken.is(ct[Bt])?ct[Bt]:void 0}const ot=F++;let Dt;ht&&(Dt=ht.onCancellationRequested(()=>{const ct=we.sender.sendCancellation(be,ot);return ct===void 0?(B.log(`Received no promise from cancellation strategy when cancelling id ${ot}`),Promise.resolve()):ct.catch(()=>{B.log(`Sending cancellation messages for id ${ot} failed`)})}));const Ut={jsonrpc:W,id:ot,method:xe,params:Ce};return bt(Ut),typeof we.sender.enableCancellation=="function"&&we.sender.enableCancellation(Ut),new Promise(async(ct,Bt)=>{const ut=Dr=>{ct(Dr),we.sender.cleanup(ot),Dt?.dispose()},qt=Dr=>{Bt(Dr),we.sender.cleanup(ot),Dt?.dispose()},nr={method:xe,timerStart:Date.now(),resolve:ut,reject:qt};try{te.set(ot,nr),await M.write(Ut)}catch(Dr){throw te.delete(ot),nr.reject(new n.ResponseError(n.ErrorCodes.MessageWriteError,Dr.message?Dr.message:"Unknown reason")),B.error("Sending request failed."),Dr}})},onRequest:(K,ie)=>{Mt();let xe=null;return f.is(K)?(xe=void 0,G=K):r.string(K)?(xe=null,ie!==void 0&&(xe=K,J.set(K,{handler:ie,type:void 0}))):ie!==void 0&&(xe=K.method,J.set(K.method,{type:K,handler:ie})),{dispose:()=>{xe!==null&&(xe!==void 0?J.delete(xe):G=void 0)}}},hasPendingResponse:()=>te.size>0,trace:async(K,ie,xe)=>{let Ce=!1,ht=v.Text;xe!==void 0&&(r.boolean(xe)?Ce=xe:(Ce=xe.sendNotification||!1,ht=xe.traceFormat||v.Text)),Z=K,ve=ht,Z===m.Off?U=void 0:U=ie,Ce&&!lt()&&!Pt()&&await be.sendNotification(b.type,{value:m.toString(K)})},onError:ue.event,onClose:re.event,onUnhandledNotification:ne.event,onDispose:ke.event,end:()=>{M.end()},dispose:()=>{if(Pt())return;ge=$.Disposed,ke.fire(void 0);const K=new n.ResponseError(n.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const ie of te.values())ie.reject(K);te=new Map,oe=new Map,le=new Set,he=new a.LinkedMap,r.func(M.dispose)&&M.dispose(),r.func(A.dispose)&&A.dispose()},listen:()=>{Mt(),Je(),ge=$.Listening,A.listen(Ke)},inspect:()=>{(0,t.default)().console.log("inspect")}};return be.onNotification(y.type,K=>{if(Z===m.Off||!U)return;const ie=Z===m.Verbose||Z===m.Compact;U.log(K.message,ie?K.verbose:void 0)}),be.onNotification(u.type,K=>{const ie=se.get(K.token);ie?ie(K.value):me.fire(K)}),be}e.createMessageConnection=L})(kO)),kO}var $ne;function A5(){return $ne||($ne=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const t=$ye();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return t.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return t.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return t.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return t.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return t.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return t.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return t.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return t.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return t.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return t.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return t.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return t.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return t.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return t.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return t.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return t.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return t.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return t.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return t.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return t.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return t.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return t.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return t.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return t.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return t.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return t.ParameterStructures}});const r=Fye();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return r.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return r.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return r.Touch}});const n=Dwt();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return n.Disposable}});const a=I1();Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return a.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return a.Emitter}});const s=Q$();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return s.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return s.CancellationToken}});const i=Lwt();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return i.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return i.SharedArrayReceiverStrategy}});const l=Owt();Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return l.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return l.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return l.ReadableStreamMessageReader}});const c=Iwt();Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=Rwt();Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const d=Pwt();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return d.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return d.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return d.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return d.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return d.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return d.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return d.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return d.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return d.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return d.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return d.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return d.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return d.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return d.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return d.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return d.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return d.MessageStrategy}});const f=mm();e.RAL=f.default})(SO)),SO}var Fne;function zwt(){if(Fne)return ck;Fne=1,Object.defineProperty(ck,"__esModule",{value:!0});const e=A5();class t extends e.AbstractMessageBuffer{constructor(c="utf-8"){super(c),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return t.emptyBuffer}fromString(c,u){return new TextEncoder().encode(c)}toString(c,u){return u==="ascii"?this.asciiDecoder.decode(c):new TextDecoder(u).decode(c)}asNative(c,u){return u===void 0?c:c.slice(0,u)}allocNative(c){return new Uint8Array(c)}}t.emptyBuffer=new Uint8Array(0);class r{constructor(c){this.socket=c,this._onData=new e.Emitter,this._messageListener=u=>{u.data.arrayBuffer().then(f=>{this._onData.fire(new Uint8Array(f))},()=>{(0,e.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}onData(c){return this._onData.event(c)}}class n{constructor(c){this.socket=c}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}write(c,u){if(typeof c=="string"){if(u!==void 0&&u!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${u}`);this.socket.send(c)}else this.socket.send(c);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,s=Object.freeze({messageBuffer:Object.freeze({create:l=>new t(l)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(l,c)=>{if(c.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${c.charset}`);return Promise.resolve(a.encode(JSON.stringify(l,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(l,c)=>{if(!(l instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(c.charset).decode(l)))}})}),stream:Object.freeze({asReadableStream:l=>new r(l),asWritableStream:l=>new n(l)}),console,timer:Object.freeze({setTimeout(l,c,...u){const d=setTimeout(l,c,...u);return{dispose:()=>clearTimeout(d)}},setImmediate(l,...c){const u=setTimeout(l,0,...c);return{dispose:()=>clearTimeout(u)}},setInterval(l,c,...u){const d=setInterval(l,c,...u);return{dispose:()=>clearInterval(d)}}})});function i(){return s}return(function(l){function c(){e.RAL.install(s)}l.install=c})(i||(i={})),ck.default=i,ck}var Une;function Bwt(){return Une||(Une=1,(function(e){var t=Sf&&Sf.__createBinding||(Object.create?(function(c,u,d,f){f===void 0&&(f=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,f,m)}):(function(c,u,d,f){f===void 0&&(f=d),c[f]=u[d]})),r=Sf&&Sf.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,zwt().default.install();const a=A5();r(A5(),e);class s extends a.AbstractMessageReader{constructor(u){super(),this._onData=new a.Emitter,this._messageListener=d=>{this._onData.fire(d.data)},u.addEventListener("error",d=>this.fireError(d)),u.onmessage=this._messageListener}listen(u){return this._onData.event(u)}}e.BrowserMessageReader=s;class i extends a.AbstractMessageWriter{constructor(u){super(),this.port=u,this.errorCount=0,u.addEventListener("error",d=>this.fireError(d))}write(u){try{return this.port.postMessage(u),Promise.resolve()}catch(d){return this.handleError(d,u),Promise.reject(d)}}handleError(u,d){this.errorCount++,this.fireError(u,d,this.errorCount)}end(){}}e.BrowserMessageWriter=i;function l(c,u,d,f){return d===void 0&&(d=a.NullLogger),a.ConnectionStrategy.is(f)&&(f={connectionStrategy:f}),(0,a.createMessageConnection)(c,u,d,f)}e.createMessageConnection=l})(Sf)),Sf}var J$=Bwt();class $wt extends J$.AbstractMessageReader{constructor(r){super();_t(this,"socket");_t(this,"state","initial");_t(this,"callback");_t(this,"events",[]);this.socket=r,this.socket.onMessage(n=>this.readMessage(n)),this.socket.onError(n=>this.fireError(n)),this.socket.onClose((n,a)=>{if(n!==1e3){const s={name:""+n,message:`Error during socket reconnect: code = ${n}, reason = ${a}`};this.fireError(s)}this.fireClose()})}listen(r){if(this.state==="initial")for(this.state="listening",this.callback=r;this.events.length!==0;){const n=this.events.pop();n.message!==void 0?this.readMessage(n.message):n.error!==void 0?this.fireError(n.error):this.fireClose()}return{dispose:()=>{this.callback===r&&(this.state="initial",this.callback=void 0)}}}dispose(){super.dispose(),this.state="initial",this.callback=void 0,this.events.splice(0,this.events.length)}readMessage(r){if(this.state==="initial")this.events.splice(0,0,{message:r});else if(this.state==="listening")try{const n=JSON.parse(r);this.callback(n)}catch(n){const a={name:"400",message:`Error during message parsing, reason = ${typeof n=="object"?n.message:"unknown"}`};this.fireError(a)}}fireError(r){this.state==="initial"?this.events.splice(0,0,{error:r}):this.state==="listening"&&super.fireError(r)}fireClose(){this.state==="initial"?this.events.splice(0,0,{}):this.state==="listening"&&super.fireClose(),this.state="closed"}}class Fwt extends J$.AbstractMessageWriter{constructor(r){super();_t(this,"errorCount",0);_t(this,"socket");this.socket=r}end(){}async write(r){try{const n=JSON.stringify(r);this.socket.send(n)}catch(n){this.errorCount++,this.fireError(n,r,this.errorCount)}}}function Uwt(e){return{send:t=>e.send(t),onMessage:t=>{e.onmessage=r=>t(r.data)},onError:t=>{e.onerror=r=>{Object.hasOwn(r,"message")&&t(r.message)}},onClose:t=>{e.onclose=r=>t(r.code,r.reason)},dispose:()=>e.close()}}var Cf={},jf={},dk={},_O={},Ot={},es={},Hne;function R1(){if(Hne)return es;Hne=1,Object.defineProperty(es,"__esModule",{value:!0}),es.stringArray=es.array=es.func=es.error=es.number=es.string=es.boolean=void 0;function e(l){return l===!0||l===!1}es.boolean=e;function t(l){return typeof l=="string"||l instanceof String}es.string=t;function r(l){return typeof l=="number"||l instanceof Number}es.number=r;function n(l){return l instanceof Error}es.error=n;function a(l){return typeof l=="function"}es.func=a;function s(l){return Array.isArray(l)}es.array=s;function i(l){return s(l)&&l.every(c=>t(c))}return es.stringArray=i,es}var qne;function Hye(){if(qne)return Ot;qne=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Message=Ot.NotificationType9=Ot.NotificationType8=Ot.NotificationType7=Ot.NotificationType6=Ot.NotificationType5=Ot.NotificationType4=Ot.NotificationType3=Ot.NotificationType2=Ot.NotificationType1=Ot.NotificationType0=Ot.NotificationType=Ot.RequestType9=Ot.RequestType8=Ot.RequestType7=Ot.RequestType6=Ot.RequestType5=Ot.RequestType4=Ot.RequestType3=Ot.RequestType2=Ot.RequestType1=Ot.RequestType=Ot.RequestType0=Ot.AbstractMessageSignature=Ot.ParameterStructures=Ot.ResponseError=Ot.ErrorCodes=void 0;const e=R1();var t;(function(L){L.ParseError=-32700,L.InvalidRequest=-32600,L.MethodNotFound=-32601,L.InvalidParams=-32602,L.InternalError=-32603,L.jsonrpcReservedErrorRangeStart=-32099,L.serverErrorStart=-32099,L.MessageWriteError=-32099,L.MessageReadError=-32098,L.PendingResponseRejected=-32097,L.ConnectionInactive=-32096,L.ServerNotInitialized=-32002,L.UnknownErrorCode=-32001,L.jsonrpcReservedErrorRangeEnd=-32e3,L.serverErrorEnd=-32e3})(t||(Ot.ErrorCodes=t={}));class r extends Error{constructor(A,M,P){super(M),this.code=e.number(A)?A:t.UnknownErrorCode,this.data=P,Object.setPrototypeOf(this,r.prototype)}toJson(){const A={code:this.code,message:this.message};return this.data!==void 0&&(A.data=this.data),A}}Ot.ResponseError=r;class n{constructor(A){this.kind=A}static is(A){return A===n.auto||A===n.byName||A===n.byPosition}toString(){return this.kind}}Ot.ParameterStructures=n,n.auto=new n("auto"),n.byPosition=new n("byPosition"),n.byName=new n("byName");class a{constructor(A,M){this.method=A,this.numberOfParams=M}get parameterStructures(){return n.auto}}Ot.AbstractMessageSignature=a;class s extends a{constructor(A){super(A,0)}}Ot.RequestType0=s;class i extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Ot.RequestType=i;class l extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Ot.RequestType1=l;class c extends a{constructor(A){super(A,2)}}Ot.RequestType2=c;class u extends a{constructor(A){super(A,3)}}Ot.RequestType3=u;class d extends a{constructor(A){super(A,4)}}Ot.RequestType4=d;class f extends a{constructor(A){super(A,5)}}Ot.RequestType5=f;class m extends a{constructor(A){super(A,6)}}Ot.RequestType6=m;class p extends a{constructor(A){super(A,7)}}Ot.RequestType7=p;class v extends a{constructor(A){super(A,8)}}Ot.RequestType8=v;class b extends a{constructor(A){super(A,9)}}Ot.RequestType9=b;class y extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Ot.NotificationType=y;class S extends a{constructor(A){super(A,0)}}Ot.NotificationType0=S;class _ extends a{constructor(A,M=n.auto){super(A,1),this._parameterStructures=M}get parameterStructures(){return this._parameterStructures}}Ot.NotificationType1=_;class N extends a{constructor(A){super(A,2)}}Ot.NotificationType2=N;class k extends a{constructor(A){super(A,3)}}Ot.NotificationType3=k;class j extends a{constructor(A){super(A,4)}}Ot.NotificationType4=j;class E extends a{constructor(A){super(A,5)}}Ot.NotificationType5=E;class T extends a{constructor(A){super(A,6)}}Ot.NotificationType6=T;class O extends a{constructor(A){super(A,7)}}Ot.NotificationType7=O;class R extends a{constructor(A){super(A,8)}}Ot.NotificationType8=R;class H extends a{constructor(A){super(A,9)}}Ot.NotificationType9=H;var $;return(function(L){function A(I){const B=I;return B&&e.string(B.method)&&(e.string(B.id)||e.number(B.id))}L.isRequest=A;function M(I){const B=I;return B&&e.string(B.method)&&I.id===void 0}L.isNotification=M;function P(I){const B=I;return B&&(B.result!==void 0||!!B.error)&&(e.string(B.id)||e.number(B.id)||B.id===null)}L.isResponse=P})($||(Ot.Message=$={})),Ot}var Nc={},Wne;function qye(){if(Wne)return Nc;Wne=1;var e;Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.LRUCache=Nc.LinkedMap=Nc.Touch=void 0;var t;(function(a){a.None=0,a.First=1,a.AsOld=a.First,a.Last=2,a.AsNew=a.Last})(t||(Nc.Touch=t={}));class r{constructor(){this[e]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(s){return this._map.has(s)}get(s,i=t.None){const l=this._map.get(s);if(l)return i!==t.None&&this.touch(l,i),l.value}set(s,i,l=t.None){let c=this._map.get(s);if(c)c.value=i,l!==t.None&&this.touch(c,l);else{switch(c={key:s,value:i,next:void 0,previous:void 0},l){case t.None:this.addItemLast(c);break;case t.First:this.addItemFirst(c);break;case t.Last:this.addItemLast(c);break;default:this.addItemLast(c);break}this._map.set(s,c),this._size++}return this}delete(s){return!!this.remove(s)}remove(s){const i=this._map.get(s);if(i)return this._map.delete(s),this.removeItem(i),this._size--,i.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const s=this._head;return this._map.delete(s.key),this.removeItem(s),this._size--,s.value}forEach(s,i){const l=this._state;let c=this._head;for(;c;){if(i?s.bind(i)(c.value,c.key,this):s(c.value,c.key,this),this._state!==l)throw new Error("LinkedMap got modified during iteration.");c=c.next}}keys(){const s=this._state;let i=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(i){const c={value:i.key,done:!1};return i=i.next,c}else return{value:void 0,done:!0}}};return l}values(){const s=this._state;let i=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(i){const c={value:i.value,done:!1};return i=i.next,c}else return{value:void 0,done:!0}}};return l}entries(){const s=this._state;let i=this._head;const l={[Symbol.iterator]:()=>l,next:()=>{if(this._state!==s)throw new Error("LinkedMap got modified during iteration.");if(i){const c={value:[i.key,i.value],done:!1};return i=i.next,c}else return{value:void 0,done:!0}}};return l}[(e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(s){if(s>=this.size)return;if(s===0){this.clear();return}let i=this._head,l=this.size;for(;i&&l>s;)this._map.delete(i.key),i=i.next,l--;this._head=i,this._size=l,i&&(i.previous=void 0),this._state++}addItemFirst(s){if(!this._head&&!this._tail)this._tail=s;else if(this._head)s.next=this._head,this._head.previous=s;else throw new Error("Invalid list");this._head=s,this._state++}addItemLast(s){if(!this._head&&!this._tail)this._head=s;else if(this._tail)s.previous=this._tail,this._tail.next=s;else throw new Error("Invalid list");this._tail=s,this._state++}removeItem(s){if(s===this._head&&s===this._tail)this._head=void 0,this._tail=void 0;else if(s===this._head){if(!s.next)throw new Error("Invalid list");s.next.previous=void 0,this._head=s.next}else if(s===this._tail){if(!s.previous)throw new Error("Invalid list");s.previous.next=void 0,this._tail=s.previous}else{const i=s.next,l=s.previous;if(!i||!l)throw new Error("Invalid list");i.previous=l,l.next=i}s.next=void 0,s.previous=void 0,this._state++}touch(s,i){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(i!==t.First&&i!==t.Last)){if(i===t.First){if(s===this._head)return;const l=s.next,c=s.previous;s===this._tail?(c.next=void 0,this._tail=c):(l.previous=c,c.next=l),s.previous=void 0,s.next=this._head,this._head.previous=s,this._head=s,this._state++}else if(i===t.Last){if(s===this._tail)return;const l=s.next,c=s.previous;s===this._head?(l.previous=void 0,this._head=l):(l.previous=c,c.next=l),s.next=void 0,s.previous=this._tail,this._tail.next=s,this._tail=s,this._state++}}}toJSON(){const s=[];return this.forEach((i,l)=>{s.push([l,i])}),s}fromJSON(s){this.clear();for(const[i,l]of s)this.set(i,l)}}Nc.LinkedMap=r;class n extends r{constructor(s,i=1){super(),this._limit=s,this._ratio=Math.min(Math.max(0,i),1)}get limit(){return this._limit}set limit(s){this._limit=s,this.checkTrim()}get ratio(){return this._ratio}set ratio(s){this._ratio=Math.min(Math.max(0,s),1),this.checkTrim()}get(s,i=t.AsNew){return super.get(s,i)}peek(s){return super.get(s,t.None)}set(s,i){return super.set(s,i,t.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return Nc.LRUCache=n,Nc}var Jv={},Kne;function Hwt(){if(Kne)return Jv;Kne=1,Object.defineProperty(Jv,"__esModule",{value:!0}),Jv.Disposable=void 0;var e;return(function(t){function r(n){return{dispose:n}}t.create=r})(e||(Jv.Disposable=e={})),Jv}var Ef={},fk={},Gne;function pm(){if(Gne)return fk;Gne=1,Object.defineProperty(fk,"__esModule",{value:!0});let e;function t(){if(e===void 0)throw new Error("No runtime abstraction layer installed");return e}return(function(r){function n(a){if(a===void 0)throw new Error("No runtime abstraction layer provided");e=a}r.install=n})(t||(t={})),fk.default=t,fk}var Vne;function P1(){if(Vne)return Ef;Vne=1,Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.Emitter=Ef.Event=void 0;const e=pm();var t;(function(a){const s={dispose(){}};a.None=function(){return s}})(t||(Ef.Event=t={}));class r{add(s,i=null,l){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(s),this._contexts.push(i),Array.isArray(l)&&l.push({dispose:()=>this.remove(s,i)})}remove(s,i=null){if(!this._callbacks)return;let l=!1;for(let c=0,u=this._callbacks.length;c<u;c++)if(this._callbacks[c]===s)if(this._contexts[c]===i){this._callbacks.splice(c,1),this._contexts.splice(c,1);return}else l=!0;if(l)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...s){if(!this._callbacks)return[];const i=[],l=this._callbacks.slice(0),c=this._contexts.slice(0);for(let u=0,d=l.length;u<d;u++)try{i.push(l[u].apply(c[u],s))}catch(f){(0,e.default)().console.error(f)}return i}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class n{constructor(s){this._options=s}get event(){return this._event||(this._event=(s,i,l)=>{this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(s,i);const c={dispose:()=>{this._callbacks&&(this._callbacks.remove(s,i),c.dispose=n._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(l)&&l.push(c),c}),this._event}fire(s){this._callbacks&&this._callbacks.invoke.call(this._callbacks,s)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return Ef.Emitter=n,n._noop=function(){},Ef}var Mf={},Yne;function Z$(){if(Yne)return Mf;Yne=1,Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.CancellationTokenSource=Mf.CancellationToken=void 0;const e=pm(),t=R1(),r=P1();var n;(function(l){l.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:r.Event.None}),l.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:r.Event.None});function c(u){const d=u;return d&&(d===l.None||d===l.Cancelled||t.boolean(d.isCancellationRequested)&&!!d.onCancellationRequested)}l.is=c})(n||(Mf.CancellationToken=n={}));const a=Object.freeze(function(l,c){const u=(0,e.default)().timer.setTimeout(l.bind(c),0);return{dispose(){u.dispose()}}});class s{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new r.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class i{get token(){return this._token||(this._token=new s),this._token}cancel(){this._token?this._token.cancel():this._token=n.Cancelled}dispose(){this._token?this._token instanceof s&&this._token.dispose():this._token=n.None}}return Mf.CancellationTokenSource=i,Mf}var Tf={},Qne;function qwt(){if(Qne)return Tf;Qne=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.SharedArrayReceiverStrategy=Tf.SharedArraySenderStrategy=void 0;const e=Z$();var t;(function(i){i.Continue=0,i.Cancelled=1})(t||(t={}));class r{constructor(){this.buffers=new Map}enableCancellation(l){if(l.id===null)return;const c=new SharedArrayBuffer(4),u=new Int32Array(c,0,1);u[0]=t.Continue,this.buffers.set(l.id,c),l.$cancellationData=c}async sendCancellation(l,c){const u=this.buffers.get(c);if(u===void 0)return;const d=new Int32Array(u,0,1);Atomics.store(d,0,t.Cancelled)}cleanup(l){this.buffers.delete(l)}dispose(){this.buffers.clear()}}Tf.SharedArraySenderStrategy=r;class n{constructor(l){this.data=new Int32Array(l,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===t.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class a{constructor(l){this.token=new n(l)}cancel(){}dispose(){}}class s{constructor(){this.kind="request"}createCancellationTokenSource(l){const c=l.$cancellationData;return c===void 0?new e.CancellationTokenSource:new a(c)}}return Tf.SharedArrayReceiverStrategy=s,Tf}var Cc={},Zv={},Jne;function Wye(){if(Jne)return Zv;Jne=1,Object.defineProperty(Zv,"__esModule",{value:!0}),Zv.Semaphore=void 0;const e=pm();class t{constructor(n=1){if(n<=0)throw new Error("Capacity must be greater than 0");this._capacity=n,this._active=0,this._waiting=[]}lock(n){return new Promise((a,s)=>{this._waiting.push({thunk:n,resolve:a,reject:s}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const n=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const a=n.thunk();a instanceof Promise?a.then(s=>{this._active--,n.resolve(s),this.runNext()},s=>{this._active--,n.reject(s),this.runNext()}):(this._active--,n.resolve(a),this.runNext())}catch(a){this._active--,n.reject(a),this.runNext()}}}return Zv.Semaphore=t,Zv}var Zne;function Wwt(){if(Zne)return Cc;Zne=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.ReadableStreamMessageReader=Cc.AbstractMessageReader=Cc.MessageReader=void 0;const e=pm(),t=R1(),r=P1(),n=Wye();var a;(function(c){function u(d){let f=d;return f&&t.func(f.listen)&&t.func(f.dispose)&&t.func(f.onError)&&t.func(f.onClose)&&t.func(f.onPartialMessage)}c.is=u})(a||(Cc.MessageReader=a={}));class s{constructor(){this.errorEmitter=new r.Emitter,this.closeEmitter=new r.Emitter,this.partialMessageEmitter=new r.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(u){this.errorEmitter.fire(this.asError(u))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(u){this.partialMessageEmitter.fire(u)}asError(u){return u instanceof Error?u:new Error(`Reader received error. Reason: ${t.string(u.message)?u.message:"unknown"}`)}}Cc.AbstractMessageReader=s;var i;(function(c){function u(d){let f,m;const p=new Map;let v;const b=new Map;if(d===void 0||typeof d=="string")f=d??"utf-8";else{if(f=d.charset??"utf-8",d.contentDecoder!==void 0&&(m=d.contentDecoder,p.set(m.name,m)),d.contentDecoders!==void 0)for(const y of d.contentDecoders)p.set(y.name,y);if(d.contentTypeDecoder!==void 0&&(v=d.contentTypeDecoder,b.set(v.name,v)),d.contentTypeDecoders!==void 0)for(const y of d.contentTypeDecoders)b.set(y.name,y)}return v===void 0&&(v=(0,e.default)().applicationJson.decoder,b.set(v.name,v)),{charset:f,contentDecoder:m,contentDecoders:p,contentTypeDecoder:v,contentTypeDecoders:b}}c.fromOptions=u})(i||(i={}));class l extends s{constructor(u,d){super(),this.readable=u,this.options=i.fromOptions(d),this.buffer=(0,e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new n.Semaphore(1)}set partialMessageTimeout(u){this._partialMessageTimeout=u}get partialMessageTimeout(){return this._partialMessageTimeout}listen(u){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=u;const d=this.readable.onData(f=>{this.onData(f)});return this.readable.onError(f=>this.fireError(f)),this.readable.onClose(()=>this.fireClose()),d}onData(u){try{for(this.buffer.append(u);;){if(this.nextMessageLength===-1){const f=this.buffer.tryReadHeaders(!0);if(!f)return;const m=f.get("content-length");if(!m){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(f))}`));return}const p=parseInt(m);if(isNaN(p)){this.fireError(new Error(`Content-Length value must be a number. Got ${m}`));return}this.nextMessageLength=p}const d=this.buffer.tryReadBody(this.nextMessageLength);if(d===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const f=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(d):d,m=await this.options.contentTypeDecoder.decode(f,this.options);this.callback(m)}).catch(f=>{this.fireError(f)})}}catch(d){this.fireError(d)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,e.default)().timer.setTimeout((u,d)=>{this.partialMessageTimer=void 0,u===this.messageToken&&(this.firePartialMessage({messageToken:u,waitingTime:d}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Cc.ReadableStreamMessageReader=l,Cc}var jc={},Xne;function Kwt(){if(Xne)return jc;Xne=1,Object.defineProperty(jc,"__esModule",{value:!0}),jc.WriteableStreamMessageWriter=jc.AbstractMessageWriter=jc.MessageWriter=void 0;const e=pm(),t=R1(),r=Wye(),n=P1(),a="Content-Length: ",s=`\r
`;var i;(function(d){function f(m){let p=m;return p&&t.func(p.dispose)&&t.func(p.onClose)&&t.func(p.onError)&&t.func(p.write)}d.is=f})(i||(jc.MessageWriter=i={}));class l{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(f,m,p){this.errorEmitter.fire([this.asError(f),m,p])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(f){return f instanceof Error?f:new Error(`Writer received error. Reason: ${t.string(f.message)?f.message:"unknown"}`)}}jc.AbstractMessageWriter=l;var c;(function(d){function f(m){return m===void 0||typeof m=="string"?{charset:m??"utf-8",contentTypeEncoder:(0,e.default)().applicationJson.encoder}:{charset:m.charset??"utf-8",contentEncoder:m.contentEncoder,contentTypeEncoder:m.contentTypeEncoder??(0,e.default)().applicationJson.encoder}}d.fromOptions=f})(c||(c={}));class u extends l{constructor(f,m){super(),this.writable=f,this.options=c.fromOptions(m),this.errorCount=0,this.writeSemaphore=new r.Semaphore(1),this.writable.onError(p=>this.fireError(p)),this.writable.onClose(()=>this.fireClose())}async write(f){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(f,this.options).then(p=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(p):p).then(p=>{const v=[];return v.push(a,p.byteLength.toString(),s),v.push(s),this.doWrite(f,v,p)},p=>{throw this.fireError(p),p}))}async doWrite(f,m,p){try{return await this.writable.write(m.join(""),"ascii"),this.writable.write(p)}catch(v){return this.handleError(v,f),Promise.reject(v)}}handleError(f,m){this.errorCount++,this.fireError(f,m,this.errorCount)}end(){this.writable.end()}}return jc.WriteableStreamMessageWriter=u,jc}var Xv={},eae;function Gwt(){if(eae)return Xv;eae=1,Object.defineProperty(Xv,"__esModule",{value:!0}),Xv.AbstractMessageBuffer=void 0;const e=13,t=10,r=`\r
`;class n{constructor(s="utf-8"){this._encoding=s,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(s){const i=typeof s=="string"?this.fromString(s,this._encoding):s;this._chunks.push(i),this._totalLength+=i.byteLength}tryReadHeaders(s=!1){if(this._chunks.length===0)return;let i=0,l=0,c=0,u=0;e:for(;l<this._chunks.length;){const p=this._chunks[l];for(c=0;c<p.length;){switch(p[c]){case e:switch(i){case 0:i=1;break;case 2:i=3;break;default:i=0}break;case t:switch(i){case 1:i=2;break;case 3:i=4,c++;break e;default:i=0}break;default:i=0}c++}u+=p.byteLength,l++}if(i!==4)return;const d=this._read(u+c),f=new Map,m=this.toString(d,"ascii").split(r);if(m.length<2)return f;for(let p=0;p<m.length-2;p++){const v=m[p],b=v.indexOf(":");if(b===-1)throw new Error(`Message header must separate key and value using ':'
${v}`);const y=v.substr(0,b),S=v.substr(b+1).trim();f.set(s?y.toLowerCase():y,S)}return f}tryReadBody(s){if(!(this._totalLength<s))return this._read(s)}get numberOfBytes(){return this._totalLength}_read(s){if(s===0)return this.emptyBuffer();if(s>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===s){const u=this._chunks[0];return this._chunks.shift(),this._totalLength-=s,this.asNative(u)}if(this._chunks[0].byteLength>s){const u=this._chunks[0],d=this.asNative(u,s);return this._chunks[0]=u.slice(s),this._totalLength-=s,d}const i=this.allocNative(s);let l=0,c=0;for(;s>0;){const u=this._chunks[c];if(u.byteLength>s){const d=u.slice(0,s);i.set(d,l),l+=s,this._chunks[c]=u.slice(s),this._totalLength-=s,s-=s}else i.set(u,l),l+=u.byteLength,this._chunks.shift(),this._totalLength-=u.byteLength,s-=u.byteLength}return i}}return Xv.AbstractMessageBuffer=n,Xv}var NO={},tae;function Vwt(){return tae||(tae=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const t=pm(),r=R1(),n=Hye(),a=qye(),s=P1(),i=Z$();var l;(function(A){A.type=new n.NotificationType("$/cancelRequest")})(l||(l={}));var c;(function(A){function M(P){return typeof P=="string"||typeof P=="number"}A.is=M})(c||(e.ProgressToken=c={}));var u;(function(A){A.type=new n.NotificationType("$/progress")})(u||(u={}));class d{constructor(){}}e.ProgressType=d;var f;(function(A){function M(P){return r.func(P)}A.is=M})(f||(f={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var m;(function(A){A[A.Off=0]="Off",A[A.Messages=1]="Messages",A[A.Compact=2]="Compact",A[A.Verbose=3]="Verbose"})(m||(e.Trace=m={}));var p;(function(A){A.Off="off",A.Messages="messages",A.Compact="compact",A.Verbose="verbose"})(p||(e.TraceValues=p={})),(function(A){function M(I){if(!r.string(I))return A.Off;switch(I=I.toLowerCase(),I){case"off":return A.Off;case"messages":return A.Messages;case"compact":return A.Compact;case"verbose":return A.Verbose;default:return A.Off}}A.fromString=M;function P(I){switch(I){case A.Off:return"off";case A.Messages:return"messages";case A.Compact:return"compact";case A.Verbose:return"verbose";default:return"off"}}A.toString=P})(m||(e.Trace=m={}));var v;(function(A){A.Text="text",A.JSON="json"})(v||(e.TraceFormat=v={})),(function(A){function M(P){return r.string(P)?(P=P.toLowerCase(),P==="json"?A.JSON:A.Text):A.Text}A.fromString=M})(v||(e.TraceFormat=v={}));var b;(function(A){A.type=new n.NotificationType("$/setTrace")})(b||(e.SetTraceNotification=b={}));var y;(function(A){A.type=new n.NotificationType("$/logTrace")})(y||(e.LogTraceNotification=y={}));var S;(function(A){A[A.Closed=1]="Closed",A[A.Disposed=2]="Disposed",A[A.AlreadyListening=3]="AlreadyListening"})(S||(e.ConnectionErrors=S={}));class _ extends Error{constructor(M,P){super(P),this.code=M,Object.setPrototypeOf(this,_.prototype)}}e.ConnectionError=_;var N;(function(A){function M(P){const I=P;return I&&r.func(I.cancelUndispatched)}A.is=M})(N||(e.ConnectionStrategy=N={}));var k;(function(A){function M(P){const I=P;return I&&(I.kind===void 0||I.kind==="id")&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(k||(e.IdCancellationReceiverStrategy=k={}));var j;(function(A){function M(P){const I=P;return I&&I.kind==="request"&&r.func(I.createCancellationTokenSource)&&(I.dispose===void 0||r.func(I.dispose))}A.is=M})(j||(e.RequestCancellationReceiverStrategy=j={}));var E;(function(A){A.Message=Object.freeze({createCancellationTokenSource(P){return new i.CancellationTokenSource}});function M(P){return k.is(P)||j.is(P)}A.is=M})(E||(e.CancellationReceiverStrategy=E={}));var T;(function(A){A.Message=Object.freeze({sendCancellation(P,I){return P.sendNotification(l.type,{id:I})},cleanup(P){}});function M(P){const I=P;return I&&r.func(I.sendCancellation)&&r.func(I.cleanup)}A.is=M})(T||(e.CancellationSenderStrategy=T={}));var O;(function(A){A.Message=Object.freeze({receiver:E.Message,sender:T.Message});function M(P){const I=P;return I&&E.is(I.receiver)&&T.is(I.sender)}A.is=M})(O||(e.CancellationStrategy=O={}));var R;(function(A){function M(P){const I=P;return I&&r.func(I.handleMessage)}A.is=M})(R||(e.MessageStrategy=R={}));var H;(function(A){function M(P){const I=P;return I&&(O.is(I.cancellationStrategy)||N.is(I.connectionStrategy)||R.is(I.messageStrategy))}A.is=M})(H||(e.ConnectionOptions=H={}));var $;(function(A){A[A.New=1]="New",A[A.Listening=2]="Listening",A[A.Closed=3]="Closed",A[A.Disposed=4]="Disposed"})($||($={}));function L(A,M,P,I){const B=P!==void 0?P:e.NullLogger;let F=0,q=0,Q=0;const W="2.0";let G;const J=new Map;let X;const V=new Map,se=new Map;let de,he=new a.LinkedMap,te=new Map,le=new Set,oe=new Map,Z=m.Off,ve=v.Text,U,ge=$.New;const ue=new s.Emitter,re=new s.Emitter,ne=new s.Emitter,me=new s.Emitter,ke=new s.Emitter,we=I&&I.cancellationStrategy?I.cancellationStrategy:O.Message;function pe(K){if(K===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+K.toString()}function Oe(K){return K===null?"res-unknown-"+(++Q).toString():"res-"+K.toString()}function Ae(){return"not-"+(++q).toString()}function Re(K,ie){n.Message.isRequest(ie)?K.set(pe(ie.id),ie):n.Message.isResponse(ie)?K.set(Oe(ie.id),ie):K.set(Ae(),ie)}function Ve(K){}function gt(){return ge===$.Listening}function lt(){return ge===$.Closed}function Pt(){return ge===$.Disposed}function fr(){(ge===$.New||ge===$.Listening)&&(ge=$.Closed,re.fire(void 0))}function Qe(K){ue.fire([K,void 0,void 0])}function Vt(K){ue.fire(K)}A.onClose(fr),A.onError(Qe),M.onClose(fr),M.onError(Vt);function at(){de||he.size===0||(de=(0,t.default)().timer.setImmediate(()=>{de=void 0,Fe()}))}function Ne(K){n.Message.isRequest(K)?Tt(K):n.Message.isNotification(K)?Zt(K):n.Message.isResponse(K)?wt(K):Xe(K)}function Fe(){if(he.size===0)return;const K=he.shift();try{const ie=I?.messageStrategy;R.is(ie)?ie.handleMessage(K,Ne):Ne(K)}finally{at()}}const Ke=K=>{try{if(n.Message.isNotification(K)&&K.method===l.type.method){const ie=K.params.id,xe=pe(ie),Ce=he.get(xe);if(n.Message.isRequest(Ce)){const ot=I?.connectionStrategy,Dt=ot&&ot.cancelUndispatched?ot.cancelUndispatched(Ce,Ve):void 0;if(Dt&&(Dt.error!==void 0||Dt.result!==void 0)){he.delete(xe),oe.delete(ie),Dt.id=Ce.id,fe(Dt,K.method,Date.now()),M.write(Dt).catch(()=>B.error("Sending response for canceled message failed."));return}}const ht=oe.get(ie);if(ht!==void 0){ht.cancel(),Ue(K);return}else le.add(ie)}Re(he,K)}finally{at()}};function Tt(K){if(Pt())return;function ie(ct,Bt,ut){const qt={jsonrpc:W,id:K.id};ct instanceof n.ResponseError?qt.error=ct.toJson():qt.result=ct===void 0?null:ct,fe(qt,Bt,ut),M.write(qt).catch(()=>B.error("Sending response failed."))}function xe(ct,Bt,ut){const qt={jsonrpc:W,id:K.id,error:ct.toJson()};fe(qt,Bt,ut),M.write(qt).catch(()=>B.error("Sending response failed."))}function Ce(ct,Bt,ut){ct===void 0&&(ct=null);const qt={jsonrpc:W,id:K.id,result:ct};fe(qt,Bt,ut),M.write(qt).catch(()=>B.error("Sending response failed."))}De(K);const ht=J.get(K.method);let ot,Dt;ht&&(ot=ht.type,Dt=ht.handler);const Ut=Date.now();if(Dt||G){const ct=K.id??String(Date.now()),Bt=k.is(we.receiver)?we.receiver.createCancellationTokenSource(ct):we.receiver.createCancellationTokenSource(K);K.id!==null&&le.has(K.id)&&Bt.cancel(),K.id!==null&&oe.set(ct,Bt);try{let ut;if(Dt)if(K.params===void 0){if(ot!==void 0&&ot.numberOfParams!==0){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${K.method} defines ${ot.numberOfParams} params but received none.`),K.method,Ut);return}ut=Dt(Bt.token)}else if(Array.isArray(K.params)){if(ot!==void 0&&ot.parameterStructures===n.ParameterStructures.byName){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${K.method} defines parameters by name but received parameters by position`),K.method,Ut);return}ut=Dt(...K.params,Bt.token)}else{if(ot!==void 0&&ot.parameterStructures===n.ParameterStructures.byPosition){xe(new n.ResponseError(n.ErrorCodes.InvalidParams,`Request ${K.method} defines parameters by position but received parameters by name`),K.method,Ut);return}ut=Dt(K.params,Bt.token)}else G&&(ut=G(K.method,K.params,Bt.token));const qt=ut;ut?qt.then?qt.then(nr=>{oe.delete(ct),ie(nr,K.method,Ut)},nr=>{oe.delete(ct),nr instanceof n.ResponseError?xe(nr,K.method,Ut):nr&&r.string(nr.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed with message: ${nr.message}`),K.method,Ut):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed unexpectedly without providing any details.`),K.method,Ut)}):(oe.delete(ct),ie(ut,K.method,Ut)):(oe.delete(ct),Ce(ut,K.method,Ut))}catch(ut){oe.delete(ct),ut instanceof n.ResponseError?ie(ut,K.method,Ut):ut&&r.string(ut.message)?xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed with message: ${ut.message}`),K.method,Ut):xe(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${K.method} failed unexpectedly without providing any details.`),K.method,Ut)}}else xe(new n.ResponseError(n.ErrorCodes.MethodNotFound,`Unhandled method ${K.method}`),K.method,Ut)}function wt(K){if(!Pt())if(K.id===null)K.error?B.error(`Received response message without id: Error is: 
${JSON.stringify(K.error,void 0,4)}`):B.error("Received response message without id. No further error information provided.");else{const ie=K.id,xe=te.get(ie);if(dt(K,xe),xe!==void 0){te.delete(ie);try{if(K.error){const Ce=K.error;xe.reject(new n.ResponseError(Ce.code,Ce.message,Ce.data))}else if(K.result!==void 0)xe.resolve(K.result);else throw new Error("Should never happen.")}catch(Ce){Ce.message?B.error(`Response handler '${xe.method}' failed with message: ${Ce.message}`):B.error(`Response handler '${xe.method}' failed unexpectedly.`)}}}}function Zt(K){if(Pt())return;let ie,xe;if(K.method===l.type.method){const Ce=K.params.id;le.delete(Ce),Ue(K);return}else{const Ce=V.get(K.method);Ce&&(xe=Ce.handler,ie=Ce.type)}if(xe||X)try{if(Ue(K),xe)if(K.params===void 0)ie!==void 0&&ie.numberOfParams!==0&&ie.parameterStructures!==n.ParameterStructures.byName&&B.error(`Notification ${K.method} defines ${ie.numberOfParams} params but received none.`),xe();else if(Array.isArray(K.params)){const Ce=K.params;K.method===u.type.method&&Ce.length===2&&c.is(Ce[0])?xe({token:Ce[0],value:Ce[1]}):(ie!==void 0&&(ie.parameterStructures===n.ParameterStructures.byName&&B.error(`Notification ${K.method} defines parameters by name but received parameters by position`),ie.numberOfParams!==K.params.length&&B.error(`Notification ${K.method} defines ${ie.numberOfParams} params but received ${Ce.length} arguments`)),xe(...Ce))}else ie!==void 0&&ie.parameterStructures===n.ParameterStructures.byPosition&&B.error(`Notification ${K.method} defines parameters by position but received parameters by name`),xe(K.params);else X&&X(K.method,K.params)}catch(Ce){Ce.message?B.error(`Notification handler '${K.method}' failed with message: ${Ce.message}`):B.error(`Notification handler '${K.method}' failed unexpectedly.`)}else ne.fire(K)}function Xe(K){if(!K){B.error("Received empty message.");return}B.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(K,null,4)}`);const ie=K;if(r.string(ie.id)||r.number(ie.id)){const xe=ie.id,Ce=te.get(xe);Ce&&Ce.reject(new Error("The received response has neither a result nor an error property."))}}function nt(K){if(K!=null)switch(Z){case m.Verbose:return JSON.stringify(K,null,4);case m.Compact:return JSON.stringify(K);default:return}}function bt(K){if(!(Z===m.Off||!U))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&K.params&&(ie=`Params: ${nt(K.params)}

`),U.log(`Sending request '${K.method} - (${K.id})'.`,ie)}else Nt("send-request",K)}function Ct(K){if(!(Z===m.Off||!U))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&(K.params?ie=`Params: ${nt(K.params)}

`:ie=`No parameters provided.

`),U.log(`Sending notification '${K.method}'.`,ie)}else Nt("send-notification",K)}function fe(K,ie,xe){if(!(Z===m.Off||!U))if(ve===v.Text){let Ce;(Z===m.Verbose||Z===m.Compact)&&(K.error&&K.error.data?Ce=`Error data: ${nt(K.error.data)}

`:K.result?Ce=`Result: ${nt(K.result)}

`:K.error===void 0&&(Ce=`No result returned.

`)),U.log(`Sending response '${ie} - (${K.id})'. Processing request took ${Date.now()-xe}ms`,Ce)}else Nt("send-response",K)}function De(K){if(!(Z===m.Off||!U))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&K.params&&(ie=`Params: ${nt(K.params)}

`),U.log(`Received request '${K.method} - (${K.id})'.`,ie)}else Nt("receive-request",K)}function Ue(K){if(!(Z===m.Off||!U||K.method===y.type.method))if(ve===v.Text){let ie;(Z===m.Verbose||Z===m.Compact)&&(K.params?ie=`Params: ${nt(K.params)}

`:ie=`No parameters provided.

`),U.log(`Received notification '${K.method}'.`,ie)}else Nt("receive-notification",K)}function dt(K,ie){if(!(Z===m.Off||!U))if(ve===v.Text){let xe;if((Z===m.Verbose||Z===m.Compact)&&(K.error&&K.error.data?xe=`Error data: ${nt(K.error.data)}

`:K.result?xe=`Result: ${nt(K.result)}

`:K.error===void 0&&(xe=`No result returned.

`)),ie){const Ce=K.error?` Request failed: ${K.error.message} (${K.error.code}).`:"";U.log(`Received response '${ie.method} - (${K.id})' in ${Date.now()-ie.timerStart}ms.${Ce}`,xe)}else U.log(`Received response ${K.id} without active response promise.`,xe)}else Nt("receive-response",K)}function Nt(K,ie){if(!U||Z===m.Off)return;const xe={isLSPMessage:!0,type:K,message:ie,timestamp:Date.now()};U.log(xe)}function Mt(){if(lt())throw new _(S.Closed,"Connection is closed.");if(Pt())throw new _(S.Disposed,"Connection is disposed.")}function Je(){if(gt())throw new _(S.AlreadyListening,"Connection is already listening")}function et(){if(!gt())throw new Error("Call listen() first.")}function it(K){return K===void 0?null:K}function tr(K){if(K!==null)return K}function ee(K){return K!=null&&!Array.isArray(K)&&typeof K=="object"}function Le(K,ie){switch(K){case n.ParameterStructures.auto:return ee(ie)?tr(ie):[it(ie)];case n.ParameterStructures.byName:if(!ee(ie))throw new Error("Received parameters by name but param is not an object literal.");return tr(ie);case n.ParameterStructures.byPosition:return[it(ie)];default:throw new Error(`Unknown parameter structure ${K.toString()}`)}}function We(K,ie){let xe;const Ce=K.numberOfParams;switch(Ce){case 0:xe=void 0;break;case 1:xe=Le(K.parameterStructures,ie[0]);break;default:xe=[];for(let ht=0;ht<ie.length&&ht<Ce;ht++)xe.push(it(ie[ht]));if(ie.length<Ce)for(let ht=ie.length;ht<Ce;ht++)xe.push(null);break}return xe}const be={sendNotification:(K,...ie)=>{Mt();let xe,Ce;if(r.string(K)){xe=K;const ot=ie[0];let Dt=0,Ut=n.ParameterStructures.auto;n.ParameterStructures.is(ot)&&(Dt=1,Ut=ot);let ct=ie.length;const Bt=ct-Dt;switch(Bt){case 0:Ce=void 0;break;case 1:Ce=Le(Ut,ie[Dt]);break;default:if(Ut===n.ParameterStructures.byName)throw new Error(`Received ${Bt} parameters for 'by Name' notification parameter structure.`);Ce=ie.slice(Dt,ct).map(ut=>it(ut));break}}else{const ot=ie;xe=K.method,Ce=We(K,ot)}const ht={jsonrpc:W,method:xe,params:Ce};return Ct(ht),M.write(ht).catch(ot=>{throw B.error("Sending notification failed."),ot})},onNotification:(K,ie)=>{Mt();let xe;return r.func(K)?X=K:ie&&(r.string(K)?(xe=K,V.set(K,{type:void 0,handler:ie})):(xe=K.method,V.set(K.method,{type:K,handler:ie}))),{dispose:()=>{xe!==void 0?V.delete(xe):X=void 0}}},onProgress:(K,ie,xe)=>{if(se.has(ie))throw new Error(`Progress handler for token ${ie} already registered`);return se.set(ie,xe),{dispose:()=>{se.delete(ie)}}},sendProgress:(K,ie,xe)=>be.sendNotification(u.type,{token:ie,value:xe}),onUnhandledProgress:me.event,sendRequest:(K,...ie)=>{Mt(),et();let xe,Ce,ht;if(r.string(K)){xe=K;const ct=ie[0],Bt=ie[ie.length-1];let ut=0,qt=n.ParameterStructures.auto;n.ParameterStructures.is(ct)&&(ut=1,qt=ct);let nr=ie.length;i.CancellationToken.is(Bt)&&(nr=nr-1,ht=Bt);const Dr=nr-ut;switch(Dr){case 0:Ce=void 0;break;case 1:Ce=Le(qt,ie[ut]);break;default:if(qt===n.ParameterStructures.byName)throw new Error(`Received ${Dr} parameters for 'by Name' request parameter structure.`);Ce=ie.slice(ut,nr).map(vn=>it(vn));break}}else{const ct=ie;xe=K.method,Ce=We(K,ct);const Bt=K.numberOfParams;ht=i.CancellationToken.is(ct[Bt])?ct[Bt]:void 0}const ot=F++;let Dt;ht&&(Dt=ht.onCancellationRequested(()=>{const ct=we.sender.sendCancellation(be,ot);return ct===void 0?(B.log(`Received no promise from cancellation strategy when cancelling id ${ot}`),Promise.resolve()):ct.catch(()=>{B.log(`Sending cancellation messages for id ${ot} failed`)})}));const Ut={jsonrpc:W,id:ot,method:xe,params:Ce};return bt(Ut),typeof we.sender.enableCancellation=="function"&&we.sender.enableCancellation(Ut),new Promise(async(ct,Bt)=>{const ut=Dr=>{ct(Dr),we.sender.cleanup(ot),Dt?.dispose()},qt=Dr=>{Bt(Dr),we.sender.cleanup(ot),Dt?.dispose()},nr={method:xe,timerStart:Date.now(),resolve:ut,reject:qt};try{await M.write(Ut),te.set(ot,nr)}catch(Dr){throw B.error("Sending request failed."),nr.reject(new n.ResponseError(n.ErrorCodes.MessageWriteError,Dr.message?Dr.message:"Unknown reason")),Dr}})},onRequest:(K,ie)=>{Mt();let xe=null;return f.is(K)?(xe=void 0,G=K):r.string(K)?(xe=null,ie!==void 0&&(xe=K,J.set(K,{handler:ie,type:void 0}))):ie!==void 0&&(xe=K.method,J.set(K.method,{type:K,handler:ie})),{dispose:()=>{xe!==null&&(xe!==void 0?J.delete(xe):G=void 0)}}},hasPendingResponse:()=>te.size>0,trace:async(K,ie,xe)=>{let Ce=!1,ht=v.Text;xe!==void 0&&(r.boolean(xe)?Ce=xe:(Ce=xe.sendNotification||!1,ht=xe.traceFormat||v.Text)),Z=K,ve=ht,Z===m.Off?U=void 0:U=ie,Ce&&!lt()&&!Pt()&&await be.sendNotification(b.type,{value:m.toString(K)})},onError:ue.event,onClose:re.event,onUnhandledNotification:ne.event,onDispose:ke.event,end:()=>{M.end()},dispose:()=>{if(Pt())return;ge=$.Disposed,ke.fire(void 0);const K=new n.ResponseError(n.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const ie of te.values())ie.reject(K);te=new Map,oe=new Map,le=new Set,he=new a.LinkedMap,r.func(M.dispose)&&M.dispose(),r.func(A.dispose)&&A.dispose()},listen:()=>{Mt(),Je(),ge=$.Listening,A.listen(Ke)},inspect:()=>{(0,t.default)().console.log("inspect")}};return be.onNotification(y.type,K=>{if(Z===m.Off||!U)return;const ie=Z===m.Verbose||Z===m.Compact;U.log(K.message,ie?K.verbose:void 0)}),be.onNotification(u.type,K=>{const ie=se.get(K.token);ie?ie(K.value):me.fire(K)}),be}e.createMessageConnection=L})(NO)),NO}var rae;function D5(){return rae||(rae=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const t=Hye();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return t.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return t.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return t.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return t.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return t.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return t.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return t.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return t.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return t.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return t.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return t.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return t.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return t.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return t.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return t.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return t.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return t.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return t.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return t.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return t.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return t.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return t.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return t.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return t.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return t.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return t.ParameterStructures}});const r=qye();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return r.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return r.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return r.Touch}});const n=Hwt();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return n.Disposable}});const a=P1();Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return a.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return a.Emitter}});const s=Z$();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return s.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return s.CancellationToken}});const i=qwt();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return i.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return i.SharedArrayReceiverStrategy}});const l=Wwt();Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return l.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return l.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return l.ReadableStreamMessageReader}});const c=Kwt();Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});const u=Gwt();Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return u.AbstractMessageBuffer}});const d=Vwt();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return d.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return d.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return d.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return d.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return d.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return d.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return d.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return d.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return d.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return d.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return d.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return d.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return d.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return d.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return d.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return d.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return d.MessageStrategy}});const f=pm();e.RAL=f.default})(_O)),_O}var nae;function Ywt(){if(nae)return dk;nae=1,Object.defineProperty(dk,"__esModule",{value:!0});const e=D5();class t extends e.AbstractMessageBuffer{constructor(c="utf-8"){super(c),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return t.emptyBuffer}fromString(c,u){return new TextEncoder().encode(c)}toString(c,u){return u==="ascii"?this.asciiDecoder.decode(c):new TextDecoder(u).decode(c)}asNative(c,u){return u===void 0?c:c.slice(0,u)}allocNative(c){return new Uint8Array(c)}}t.emptyBuffer=new Uint8Array(0);class r{constructor(c){this.socket=c,this._onData=new e.Emitter,this._messageListener=u=>{u.data.arrayBuffer().then(f=>{this._onData.fire(new Uint8Array(f))},()=>{(0,e.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}onData(c){return this._onData.event(c)}}class n{constructor(c){this.socket=c}onClose(c){return this.socket.addEventListener("close",c),e.Disposable.create(()=>this.socket.removeEventListener("close",c))}onError(c){return this.socket.addEventListener("error",c),e.Disposable.create(()=>this.socket.removeEventListener("error",c))}onEnd(c){return this.socket.addEventListener("end",c),e.Disposable.create(()=>this.socket.removeEventListener("end",c))}write(c,u){if(typeof c=="string"){if(u!==void 0&&u!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${u}`);this.socket.send(c)}else this.socket.send(c);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,s=Object.freeze({messageBuffer:Object.freeze({create:l=>new t(l)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(l,c)=>{if(c.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${c.charset}`);return Promise.resolve(a.encode(JSON.stringify(l,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(l,c)=>{if(!(l instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(c.charset).decode(l)))}})}),stream:Object.freeze({asReadableStream:l=>new r(l),asWritableStream:l=>new n(l)}),console,timer:Object.freeze({setTimeout(l,c,...u){const d=setTimeout(l,c,...u);return{dispose:()=>clearTimeout(d)}},setImmediate(l,...c){const u=setTimeout(l,0,...c);return{dispose:()=>clearTimeout(u)}},setInterval(l,c,...u){const d=setInterval(l,c,...u);return{dispose:()=>clearInterval(d)}}})});function i(){return s}return(function(l){function c(){e.RAL.install(s)}l.install=c})(i||(i={})),dk.default=i,dk}var aae;function N0(){return aae||(aae=1,(function(e){var t=jf&&jf.__createBinding||(Object.create?(function(c,u,d,f){f===void 0&&(f=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,f,m)}):(function(c,u,d,f){f===void 0&&(f=d),c[f]=u[d]})),r=jf&&jf.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,Ywt().default.install();const a=D5();r(D5(),e);class s extends a.AbstractMessageReader{constructor(u){super(),this._onData=new a.Emitter,this._messageListener=d=>{this._onData.fire(d.data)},u.addEventListener("error",d=>this.fireError(d)),u.onmessage=this._messageListener}listen(u){return this._onData.event(u)}}e.BrowserMessageReader=s;class i extends a.AbstractMessageWriter{constructor(u){super(),this.port=u,this.errorCount=0,u.addEventListener("error",d=>this.fireError(d))}write(u){try{return this.port.postMessage(u),Promise.resolve()}catch(d){return this.handleError(d,u),Promise.reject(d)}}handleError(u,d){this.errorCount++,this.fireError(u,d,this.errorCount)}end(){}}e.BrowserMessageWriter=i;function l(c,u,d,f){return d===void 0&&(d=a.NullLogger),a.ConnectionStrategy.is(f)&&(f={connectionStrategy:f}),(0,a.createMessageConnection)(c,u,d,f)}e.createMessageConnection=l})(jf)),jf}var CO,sae;function iae(){return sae||(sae=1,CO=N0()),CO}var Af={},L5;(function(e){function t(r){return typeof r=="string"}e.is=t})(L5||(L5={}));var zC;(function(e){function t(r){return typeof r=="string"}e.is=t})(zC||(zC={}));var O5;(function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647;function t(r){return typeof r=="number"&&e.MIN_VALUE<=r&&r<=e.MAX_VALUE}e.is=t})(O5||(O5={}));var Ex;(function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647;function t(r){return typeof r=="number"&&e.MIN_VALUE<=r&&r<=e.MAX_VALUE}e.is=t})(Ex||(Ex={}));var po;(function(e){function t(n,a){return n===Number.MAX_VALUE&&(n=Ex.MAX_VALUE),a===Number.MAX_VALUE&&(a=Ex.MAX_VALUE),{line:n,character:a}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Me.uinteger(a.line)&&Me.uinteger(a.character)}e.is=r})(po||(po={}));var Qn;(function(e){function t(n,a,s,i){if(Me.uinteger(n)&&Me.uinteger(a)&&Me.uinteger(s)&&Me.uinteger(i))return{start:po.create(n,a),end:po.create(s,i)};if(po.is(n)&&po.is(a))return{start:n,end:a};throw new Error(`Range#create called with invalid arguments[${n}, ${a}, ${s}, ${i}]`)}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&po.is(a.start)&&po.is(a.end)}e.is=r})(Qn||(Qn={}));var Mx;(function(e){function t(n,a){return{uri:n,range:a}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Qn.is(a.range)&&(Me.string(a.uri)||Me.undefined(a.uri))}e.is=r})(Mx||(Mx={}));var I5;(function(e){function t(n,a,s,i){return{targetUri:n,targetRange:a,targetSelectionRange:s,originSelectionRange:i}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Qn.is(a.targetRange)&&Me.string(a.targetUri)&&Qn.is(a.targetSelectionRange)&&(Qn.is(a.originSelectionRange)||Me.undefined(a.originSelectionRange))}e.is=r})(I5||(I5={}));var BC;(function(e){function t(n,a,s,i){return{red:n,green:a,blue:s,alpha:i}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.numberRange(a.red,0,1)&&Me.numberRange(a.green,0,1)&&Me.numberRange(a.blue,0,1)&&Me.numberRange(a.alpha,0,1)}e.is=r})(BC||(BC={}));var R5;(function(e){function t(n,a){return{range:n,color:a}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Qn.is(a.range)&&BC.is(a.color)}e.is=r})(R5||(R5={}));var P5;(function(e){function t(n,a,s){return{label:n,textEdit:a,additionalTextEdits:s}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.string(a.label)&&(Me.undefined(a.textEdit)||Ml.is(a))&&(Me.undefined(a.additionalTextEdits)||Me.typedArray(a.additionalTextEdits,Ml.is))}e.is=r})(P5||(P5={}));var z5;(function(e){e.Comment="comment",e.Imports="imports",e.Region="region"})(z5||(z5={}));var B5;(function(e){function t(n,a,s,i,l,c){const u={startLine:n,endLine:a};return Me.defined(s)&&(u.startCharacter=s),Me.defined(i)&&(u.endCharacter=i),Me.defined(l)&&(u.kind=l),Me.defined(c)&&(u.collapsedText=c),u}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.uinteger(a.startLine)&&Me.uinteger(a.startLine)&&(Me.undefined(a.startCharacter)||Me.uinteger(a.startCharacter))&&(Me.undefined(a.endCharacter)||Me.uinteger(a.endCharacter))&&(Me.undefined(a.kind)||Me.string(a.kind))}e.is=r})(B5||(B5={}));var $C;(function(e){function t(n,a){return{location:n,message:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Mx.is(a.location)&&Me.string(a.message)}e.is=r})($C||($C={}));var $5;(function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4})($5||($5={}));var F5;(function(e){e.Unnecessary=1,e.Deprecated=2})(F5||(F5={}));var U5;(function(e){function t(r){const n=r;return Me.objectLiteral(n)&&Me.string(n.href)}e.is=t})(U5||(U5={}));var Tx;(function(e){function t(n,a,s,i,l,c){let u={range:n,message:a};return Me.defined(s)&&(u.severity=s),Me.defined(i)&&(u.code=i),Me.defined(l)&&(u.source=l),Me.defined(c)&&(u.relatedInformation=c),u}e.create=t;function r(n){var a;let s=n;return Me.defined(s)&&Qn.is(s.range)&&Me.string(s.message)&&(Me.number(s.severity)||Me.undefined(s.severity))&&(Me.integer(s.code)||Me.string(s.code)||Me.undefined(s.code))&&(Me.undefined(s.codeDescription)||Me.string((a=s.codeDescription)===null||a===void 0?void 0:a.href))&&(Me.string(s.source)||Me.undefined(s.source))&&(Me.undefined(s.relatedInformation)||Me.typedArray(s.relatedInformation,$C.is))}e.is=r})(Tx||(Tx={}));var Fh;(function(e){function t(n,a,...s){let i={title:n,command:a};return Me.defined(s)&&s.length>0&&(i.arguments=s),i}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.title)&&Me.string(a.command)}e.is=r})(Fh||(Fh={}));var Ml;(function(e){function t(s,i){return{range:s,newText:i}}e.replace=t;function r(s,i){return{range:{start:s,end:s},newText:i}}e.insert=r;function n(s){return{range:s,newText:""}}e.del=n;function a(s){const i=s;return Me.objectLiteral(i)&&Me.string(i.newText)&&Qn.is(i.range)}e.is=a})(Ml||(Ml={}));var ph;(function(e){function t(n,a,s){const i={label:n};return a!==void 0&&(i.needsConfirmation=a),s!==void 0&&(i.description=s),i}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&Me.string(a.label)&&(Me.boolean(a.needsConfirmation)||a.needsConfirmation===void 0)&&(Me.string(a.description)||a.description===void 0)}e.is=r})(ph||(ph={}));var is;(function(e){function t(r){const n=r;return Me.string(n)}e.is=t})(is||(is={}));var Bc;(function(e){function t(s,i,l){return{range:s,newText:i,annotationId:l}}e.replace=t;function r(s,i,l){return{range:{start:s,end:s},newText:i,annotationId:l}}e.insert=r;function n(s,i){return{range:s,newText:"",annotationId:i}}e.del=n;function a(s){const i=s;return Ml.is(i)&&(ph.is(i.annotationId)||is.is(i.annotationId))}e.is=a})(Bc||(Bc={}));var Ax;(function(e){function t(n,a){return{textDocument:n,edits:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Dx.is(a.textDocument)&&Array.isArray(a.edits)}e.is=r})(Ax||(Ax={}));var Qg;(function(e){function t(n,a,s){let i={kind:"create",uri:n};return a!==void 0&&(a.overwrite!==void 0||a.ignoreIfExists!==void 0)&&(i.options=a),s!==void 0&&(i.annotationId=s),i}e.create=t;function r(n){let a=n;return a&&a.kind==="create"&&Me.string(a.uri)&&(a.options===void 0||(a.options.overwrite===void 0||Me.boolean(a.options.overwrite))&&(a.options.ignoreIfExists===void 0||Me.boolean(a.options.ignoreIfExists)))&&(a.annotationId===void 0||is.is(a.annotationId))}e.is=r})(Qg||(Qg={}));var Jg;(function(e){function t(n,a,s,i){let l={kind:"rename",oldUri:n,newUri:a};return s!==void 0&&(s.overwrite!==void 0||s.ignoreIfExists!==void 0)&&(l.options=s),i!==void 0&&(l.annotationId=i),l}e.create=t;function r(n){let a=n;return a&&a.kind==="rename"&&Me.string(a.oldUri)&&Me.string(a.newUri)&&(a.options===void 0||(a.options.overwrite===void 0||Me.boolean(a.options.overwrite))&&(a.options.ignoreIfExists===void 0||Me.boolean(a.options.ignoreIfExists)))&&(a.annotationId===void 0||is.is(a.annotationId))}e.is=r})(Jg||(Jg={}));var Zg;(function(e){function t(n,a,s){let i={kind:"delete",uri:n};return a!==void 0&&(a.recursive!==void 0||a.ignoreIfNotExists!==void 0)&&(i.options=a),s!==void 0&&(i.annotationId=s),i}e.create=t;function r(n){let a=n;return a&&a.kind==="delete"&&Me.string(a.uri)&&(a.options===void 0||(a.options.recursive===void 0||Me.boolean(a.options.recursive))&&(a.options.ignoreIfNotExists===void 0||Me.boolean(a.options.ignoreIfNotExists)))&&(a.annotationId===void 0||is.is(a.annotationId))}e.is=r})(Zg||(Zg={}));var FC;(function(e){function t(r){let n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(a=>Me.string(a.kind)?Qg.is(a)||Jg.is(a)||Zg.is(a):Ax.is(a)))}e.is=t})(FC||(FC={}));class hk{constructor(t,r){this.edits=t,this.changeAnnotations=r}insert(t,r,n){let a,s;if(n===void 0?a=Ml.insert(t,r):is.is(n)?(s=n,a=Bc.insert(t,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),s=this.changeAnnotations.manage(n),a=Bc.insert(t,r,s)),this.edits.push(a),s!==void 0)return s}replace(t,r,n){let a,s;if(n===void 0?a=Ml.replace(t,r):is.is(n)?(s=n,a=Bc.replace(t,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),s=this.changeAnnotations.manage(n),a=Bc.replace(t,r,s)),this.edits.push(a),s!==void 0)return s}delete(t,r){let n,a;if(r===void 0?n=Ml.del(t):is.is(r)?(a=r,n=Bc.del(t,r)):(this.assertChangeAnnotations(this.changeAnnotations),a=this.changeAnnotations.manage(r),n=Bc.del(t,a)),this.edits.push(n),a!==void 0)return a}add(t){this.edits.push(t)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(t){if(t===void 0)throw new Error("Text edit change is not configured to manage change annotations.")}}class oae{constructor(t){this._annotations=t===void 0?Object.create(null):t,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(t,r){let n;if(is.is(t)?n=t:(n=this.nextId(),r=t),this._annotations[n]!==void 0)throw new Error(`Id ${n} is already in use.`);if(r===void 0)throw new Error(`No annotation provided for id ${n}`);return this._annotations[n]=r,this._size++,n}nextId(){return this._counter++,this._counter.toString()}}class Qwt{constructor(t){this._textEditChanges=Object.create(null),t!==void 0?(this._workspaceEdit=t,t.documentChanges?(this._changeAnnotations=new oae(t.changeAnnotations),t.changeAnnotations=this._changeAnnotations.all(),t.documentChanges.forEach(r=>{if(Ax.is(r)){const n=new hk(r.edits,this._changeAnnotations);this._textEditChanges[r.textDocument.uri]=n}})):t.changes&&Object.keys(t.changes).forEach(r=>{const n=new hk(t.changes[r]);this._textEditChanges[r]=n})):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(t){if(Dx.is(t)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");const r={uri:t.uri,version:t.version};let n=this._textEditChanges[r.uri];if(!n){const a=[],s={textDocument:r,edits:a};this._workspaceEdit.documentChanges.push(s),n=new hk(a,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");let r=this._textEditChanges[t];if(!r){let n=[];this._workspaceEdit.changes[t]=n,r=new hk(n),this._textEditChanges[t]=r}return r}}initDocumentChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new oae,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))}createFile(t,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let a;ph.is(r)||is.is(r)?a=r:n=r;let s,i;if(a===void 0?s=Qg.create(t,n):(i=is.is(a)?a:this._changeAnnotations.manage(a),s=Qg.create(t,n,i)),this._workspaceEdit.documentChanges.push(s),i!==void 0)return i}renameFile(t,r,n,a){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let s;ph.is(n)||is.is(n)?s=n:a=n;let i,l;if(s===void 0?i=Jg.create(t,r,a):(l=is.is(s)?s:this._changeAnnotations.manage(s),i=Jg.create(t,r,a,l)),this._workspaceEdit.documentChanges.push(i),l!==void 0)return l}deleteFile(t,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");let a;ph.is(r)||is.is(r)?a=r:n=r;let s,i;if(a===void 0?s=Zg.create(t,n):(i=is.is(a)?a:this._changeAnnotations.manage(a),s=Zg.create(t,n,i)),this._workspaceEdit.documentChanges.push(s),i!==void 0)return i}}var H5;(function(e){function t(n){return{uri:n}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)}e.is=r})(H5||(H5={}));var q5;(function(e){function t(n,a){return{uri:n,version:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)&&Me.integer(a.version)}e.is=r})(q5||(q5={}));var Dx;(function(e){function t(n,a){return{uri:n,version:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)&&(a.version===null||Me.integer(a.version))}e.is=r})(Dx||(Dx={}));var W5;(function(e){function t(n,a,s,i){return{uri:n,languageId:a,version:s,text:i}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.string(a.uri)&&Me.string(a.languageId)&&Me.integer(a.version)&&Me.string(a.text)}e.is=r})(W5||(W5={}));var UC;(function(e){e.PlainText="plaintext",e.Markdown="markdown";function t(r){const n=r;return n===e.PlainText||n===e.Markdown}e.is=t})(UC||(UC={}));var Xg;(function(e){function t(r){const n=r;return Me.objectLiteral(r)&&UC.is(n.kind)&&Me.string(n.value)}e.is=t})(Xg||(Xg={}));var K5;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(K5||(K5={}));var G5;(function(e){e.PlainText=1,e.Snippet=2})(G5||(G5={}));var V5;(function(e){e.Deprecated=1})(V5||(V5={}));var Y5;(function(e){function t(n,a,s){return{newText:n,insert:a,replace:s}}e.create=t;function r(n){const a=n;return a&&Me.string(a.newText)&&Qn.is(a.insert)&&Qn.is(a.replace)}e.is=r})(Y5||(Y5={}));var Q5;(function(e){e.asIs=1,e.adjustIndentation=2})(Q5||(Q5={}));var J5;(function(e){function t(r){const n=r;return n&&(Me.string(n.detail)||n.detail===void 0)&&(Me.string(n.description)||n.description===void 0)}e.is=t})(J5||(J5={}));var Z5;(function(e){function t(r){return{label:r}}e.create=t})(Z5||(Z5={}));var X5;(function(e){function t(r,n){return{items:r||[],isIncomplete:!!n}}e.create=t})(X5||(X5={}));var Lx;(function(e){function t(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}e.fromPlainText=t;function r(n){const a=n;return Me.string(a)||Me.objectLiteral(a)&&Me.string(a.language)&&Me.string(a.value)}e.is=r})(Lx||(Lx={}));var e6;(function(e){function t(r){let n=r;return!!n&&Me.objectLiteral(n)&&(Xg.is(n.contents)||Lx.is(n.contents)||Me.typedArray(n.contents,Lx.is))&&(r.range===void 0||Qn.is(r.range))}e.is=t})(e6||(e6={}));var t6;(function(e){function t(r,n){return n?{label:r,documentation:n}:{label:r}}e.create=t})(t6||(t6={}));var r6;(function(e){function t(r,n,...a){let s={label:r};return Me.defined(n)&&(s.documentation=n),Me.defined(a)?s.parameters=a:s.parameters=[],s}e.create=t})(r6||(r6={}));var n6;(function(e){e.Text=1,e.Read=2,e.Write=3})(n6||(n6={}));var a6;(function(e){function t(r,n){let a={range:r};return Me.number(n)&&(a.kind=n),a}e.create=t})(a6||(a6={}));var s6;(function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26})(s6||(s6={}));var i6;(function(e){e.Deprecated=1})(i6||(i6={}));var o6;(function(e){function t(r,n,a,s,i){let l={name:r,kind:n,location:{uri:s,range:a}};return i&&(l.containerName=i),l}e.create=t})(o6||(o6={}));var l6;(function(e){function t(r,n,a,s){return s!==void 0?{name:r,kind:n,location:{uri:a,range:s}}:{name:r,kind:n,location:{uri:a}}}e.create=t})(l6||(l6={}));var c6;(function(e){function t(n,a,s,i,l,c){let u={name:n,detail:a,kind:s,range:i,selectionRange:l};return c!==void 0&&(u.children=c),u}e.create=t;function r(n){let a=n;return a&&Me.string(a.name)&&Me.number(a.kind)&&Qn.is(a.range)&&Qn.is(a.selectionRange)&&(a.detail===void 0||Me.string(a.detail))&&(a.deprecated===void 0||Me.boolean(a.deprecated))&&(a.children===void 0||Array.isArray(a.children))&&(a.tags===void 0||Array.isArray(a.tags))}e.is=r})(c6||(c6={}));var u6;(function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"})(u6||(u6={}));var Ox;(function(e){e.Invoked=1,e.Automatic=2})(Ox||(Ox={}));var d6;(function(e){function t(n,a,s){let i={diagnostics:n};return a!=null&&(i.only=a),s!=null&&(i.triggerKind=s),i}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.typedArray(a.diagnostics,Tx.is)&&(a.only===void 0||Me.typedArray(a.only,Me.string))&&(a.triggerKind===void 0||a.triggerKind===Ox.Invoked||a.triggerKind===Ox.Automatic)}e.is=r})(d6||(d6={}));var f6;(function(e){function t(n,a,s){let i={title:n},l=!0;return typeof a=="string"?(l=!1,i.kind=a):Fh.is(a)?i.command=a:i.edit=a,l&&s!==void 0&&(i.kind=s),i}e.create=t;function r(n){let a=n;return a&&Me.string(a.title)&&(a.diagnostics===void 0||Me.typedArray(a.diagnostics,Tx.is))&&(a.kind===void 0||Me.string(a.kind))&&(a.edit!==void 0||a.command!==void 0)&&(a.command===void 0||Fh.is(a.command))&&(a.isPreferred===void 0||Me.boolean(a.isPreferred))&&(a.edit===void 0||FC.is(a.edit))}e.is=r})(f6||(f6={}));var h6;(function(e){function t(n,a){let s={range:n};return Me.defined(a)&&(s.data=a),s}e.create=t;function r(n){let a=n;return Me.defined(a)&&Qn.is(a.range)&&(Me.undefined(a.command)||Fh.is(a.command))}e.is=r})(h6||(h6={}));var m6;(function(e){function t(n,a){return{tabSize:n,insertSpaces:a}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Me.uinteger(a.tabSize)&&Me.boolean(a.insertSpaces)}e.is=r})(m6||(m6={}));var p6;(function(e){function t(n,a,s){return{range:n,target:a,data:s}}e.create=t;function r(n){let a=n;return Me.defined(a)&&Qn.is(a.range)&&(Me.undefined(a.target)||Me.string(a.target))}e.is=r})(p6||(p6={}));var g6;(function(e){function t(n,a){return{range:n,parent:a}}e.create=t;function r(n){let a=n;return Me.objectLiteral(a)&&Qn.is(a.range)&&(a.parent===void 0||e.is(a.parent))}e.is=r})(g6||(g6={}));var v6;(function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"})(v6||(v6={}));var b6;(function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"})(b6||(b6={}));var y6;(function(e){function t(r){const n=r;return Me.objectLiteral(n)&&(n.resultId===void 0||typeof n.resultId=="string")&&Array.isArray(n.data)&&(n.data.length===0||typeof n.data[0]=="number")}e.is=t})(y6||(y6={}));var x6;(function(e){function t(n,a){return{range:n,text:a}}e.create=t;function r(n){const a=n;return a!=null&&Qn.is(a.range)&&Me.string(a.text)}e.is=r})(x6||(x6={}));var w6;(function(e){function t(n,a,s){return{range:n,variableName:a,caseSensitiveLookup:s}}e.create=t;function r(n){const a=n;return a!=null&&Qn.is(a.range)&&Me.boolean(a.caseSensitiveLookup)&&(Me.string(a.variableName)||a.variableName===void 0)}e.is=r})(w6||(w6={}));var S6;(function(e){function t(n,a){return{range:n,expression:a}}e.create=t;function r(n){const a=n;return a!=null&&Qn.is(a.range)&&(Me.string(a.expression)||a.expression===void 0)}e.is=r})(S6||(S6={}));var k6;(function(e){function t(n,a){return{frameId:n,stoppedLocation:a}}e.create=t;function r(n){const a=n;return Me.defined(a)&&Qn.is(n.stoppedLocation)}e.is=r})(k6||(k6={}));var HC;(function(e){e.Type=1,e.Parameter=2;function t(r){return r===1||r===2}e.is=t})(HC||(HC={}));var qC;(function(e){function t(n){return{value:n}}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&(a.tooltip===void 0||Me.string(a.tooltip)||Xg.is(a.tooltip))&&(a.location===void 0||Mx.is(a.location))&&(a.command===void 0||Fh.is(a.command))}e.is=r})(qC||(qC={}));var _6;(function(e){function t(n,a,s){const i={position:n,label:a};return s!==void 0&&(i.kind=s),i}e.create=t;function r(n){const a=n;return Me.objectLiteral(a)&&po.is(a.position)&&(Me.string(a.label)||Me.typedArray(a.label,qC.is))&&(a.kind===void 0||HC.is(a.kind))&&a.textEdits===void 0||Me.typedArray(a.textEdits,Ml.is)&&(a.tooltip===void 0||Me.string(a.tooltip)||Xg.is(a.tooltip))&&(a.paddingLeft===void 0||Me.boolean(a.paddingLeft))&&(a.paddingRight===void 0||Me.boolean(a.paddingRight))}e.is=r})(_6||(_6={}));var N6;(function(e){function t(r){return{kind:"snippet",value:r}}e.createSnippet=t})(N6||(N6={}));var C6;(function(e){function t(r,n,a,s){return{insertText:r,filterText:n,range:a,command:s}}e.create=t})(C6||(C6={}));var j6;(function(e){function t(r){return{items:r}}e.create=t})(j6||(j6={}));var E6;(function(e){e.Invoked=0,e.Automatic=1})(E6||(E6={}));var M6;(function(e){function t(r,n){return{range:r,text:n}}e.create=t})(M6||(M6={}));var T6;(function(e){function t(r,n){return{triggerKind:r,selectedCompletionInfo:n}}e.create=t})(T6||(T6={}));var A6;(function(e){function t(r){const n=r;return Me.objectLiteral(n)&&zC.is(n.uri)&&Me.string(n.name)}e.is=t})(A6||(A6={}));const Jwt=[`
`,`\r
`,"\r"];var D6;(function(e){function t(s,i,l,c){return new Zwt(s,i,l,c)}e.create=t;function r(s){let i=s;return!!(Me.defined(i)&&Me.string(i.uri)&&(Me.undefined(i.languageId)||Me.string(i.languageId))&&Me.uinteger(i.lineCount)&&Me.func(i.getText)&&Me.func(i.positionAt)&&Me.func(i.offsetAt))}e.is=r;function n(s,i){let l=s.getText(),c=a(i,(d,f)=>{let m=d.range.start.line-f.range.start.line;return m===0?d.range.start.character-f.range.start.character:m}),u=l.length;for(let d=c.length-1;d>=0;d--){let f=c[d],m=s.offsetAt(f.range.start),p=s.offsetAt(f.range.end);if(p<=u)l=l.substring(0,m)+f.newText+l.substring(p,l.length);else throw new Error("Overlapping edit");u=m}return l}e.applyEdits=n;function a(s,i){if(s.length<=1)return s;const l=s.length/2|0,c=s.slice(0,l),u=s.slice(l);a(c,i),a(u,i);let d=0,f=0,m=0;for(;d<c.length&&f<u.length;)i(c[d],u[f])<=0?s[m++]=c[d++]:s[m++]=u[f++];for(;d<c.length;)s[m++]=c[d++];for(;f<u.length;)s[m++]=u[f++];return s}})(D6||(D6={}));class Zwt{constructor(t,r,n,a){this._uri=t,this._languageId=r,this._version=n,this._content=a,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(t){if(t){let r=this.offsetAt(t.start),n=this.offsetAt(t.end);return this._content.substring(r,n)}return this._content}update(t,r){this._content=t.text,this._version=r,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let t=[],r=this._content,n=!0;for(let a=0;a<r.length;a++){n&&(t.push(a),n=!1);let s=r.charAt(a);n=s==="\r"||s===`
`,s==="\r"&&a+1<r.length&&r.charAt(a+1)===`
`&&a++}n&&r.length>0&&t.push(r.length),this._lineOffsets=t}return this._lineOffsets}positionAt(t){t=Math.max(Math.min(t,this._content.length),0);let r=this.getLineOffsets(),n=0,a=r.length;if(a===0)return po.create(0,t);for(;n<a;){let i=Math.floor((n+a)/2);r[i]>t?a=i:n=i+1}let s=n-1;return po.create(s,t-r[s])}offsetAt(t){let r=this.getLineOffsets();if(t.line>=r.length)return this._content.length;if(t.line<0)return 0;let n=r[t.line],a=t.line+1<r.length?r[t.line+1]:this._content.length;return Math.max(Math.min(n+t.character,a),n)}get lineCount(){return this.getLineOffsets().length}}var Me;(function(e){const t=Object.prototype.toString;function r(p){return typeof p<"u"}e.defined=r;function n(p){return typeof p>"u"}e.undefined=n;function a(p){return p===!0||p===!1}e.boolean=a;function s(p){return t.call(p)==="[object String]"}e.string=s;function i(p){return t.call(p)==="[object Number]"}e.number=i;function l(p,v,b){return t.call(p)==="[object Number]"&&v<=p&&p<=b}e.numberRange=l;function c(p){return t.call(p)==="[object Number]"&&-2147483648<=p&&p<=2147483647}e.integer=c;function u(p){return t.call(p)==="[object Number]"&&0<=p&&p<=2147483647}e.uinteger=u;function d(p){return t.call(p)==="[object Function]"}e.func=d;function f(p){return p!==null&&typeof p=="object"}e.objectLiteral=f;function m(p,v){return Array.isArray(p)&&p.every(v)}e.typedArray=m})(Me||(Me={}));const Xwt=Object.freeze(Object.defineProperty({__proto__:null,get AnnotatedTextEdit(){return Bc},get ChangeAnnotation(){return ph},get ChangeAnnotationIdentifier(){return is},get CodeAction(){return f6},get CodeActionContext(){return d6},get CodeActionKind(){return u6},get CodeActionTriggerKind(){return Ox},get CodeDescription(){return U5},get CodeLens(){return h6},get Color(){return BC},get ColorInformation(){return R5},get ColorPresentation(){return P5},get Command(){return Fh},get CompletionItem(){return Z5},get CompletionItemKind(){return K5},get CompletionItemLabelDetails(){return J5},get CompletionItemTag(){return V5},get CompletionList(){return X5},get CreateFile(){return Qg},get DeleteFile(){return Zg},get Diagnostic(){return Tx},get DiagnosticRelatedInformation(){return $C},get DiagnosticSeverity(){return $5},get DiagnosticTag(){return F5},get DocumentHighlight(){return a6},get DocumentHighlightKind(){return n6},get DocumentLink(){return p6},get DocumentSymbol(){return c6},get DocumentUri(){return L5},EOL:Jwt,get FoldingRange(){return B5},get FoldingRangeKind(){return z5},get FormattingOptions(){return m6},get Hover(){return e6},get InlayHint(){return _6},get InlayHintKind(){return HC},get InlayHintLabelPart(){return qC},get InlineCompletionContext(){return T6},get InlineCompletionItem(){return C6},get InlineCompletionList(){return j6},get InlineCompletionTriggerKind(){return E6},get InlineValueContext(){return k6},get InlineValueEvaluatableExpression(){return S6},get InlineValueText(){return x6},get InlineValueVariableLookup(){return w6},get InsertReplaceEdit(){return Y5},get InsertTextFormat(){return G5},get InsertTextMode(){return Q5},get Location(){return Mx},get LocationLink(){return I5},get MarkedString(){return Lx},get MarkupContent(){return Xg},get MarkupKind(){return UC},get OptionalVersionedTextDocumentIdentifier(){return Dx},get ParameterInformation(){return t6},get Position(){return po},get Range(){return Qn},get RenameFile(){return Jg},get SelectedCompletionInfo(){return M6},get SelectionRange(){return g6},get SemanticTokenModifiers(){return b6},get SemanticTokenTypes(){return v6},get SemanticTokens(){return y6},get SignatureInformation(){return r6},get StringValue(){return N6},get SymbolInformation(){return o6},get SymbolKind(){return s6},get SymbolTag(){return i6},get TextDocument(){return D6},get TextDocumentEdit(){return Ax},get TextDocumentIdentifier(){return H5},get TextDocumentItem(){return W5},get TextEdit(){return Ml},get URI(){return zC},get VersionedTextDocumentIdentifier(){return q5},WorkspaceChange:Qwt,get WorkspaceEdit(){return FC},get WorkspaceFolder(){return A6},get WorkspaceSymbol(){return l6},get integer(){return O5},get uinteger(){return Ex}},Symbol.toStringTag,{value:"Module"})),X$=swe(Xwt);var Es={},lae;function $n(){if(lae)return Es;lae=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.ProtocolNotificationType=Es.ProtocolNotificationType0=Es.ProtocolRequestType=Es.ProtocolRequestType0=Es.RegistrationType=Es.MessageDirection=void 0;const e=N0();var t;(function(l){l.clientToServer="clientToServer",l.serverToClient="serverToClient",l.both="both"})(t||(Es.MessageDirection=t={}));class r{constructor(c){this.method=c}}Es.RegistrationType=r;class n extends e.RequestType0{constructor(c){super(c)}}Es.ProtocolRequestType0=n;class a extends e.RequestType{constructor(c){super(c,e.ParameterStructures.byName)}}Es.ProtocolRequestType=a;class s extends e.NotificationType0{constructor(c){super(c)}}Es.ProtocolNotificationType0=s;class i extends e.NotificationType{constructor(c){super(c,e.ParameterStructures.byName)}}return Es.ProtocolNotificationType=i,Es}var jO={},ra={},cae;function e8(){if(cae)return ra;cae=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.objectLiteral=ra.typedArray=ra.stringArray=ra.array=ra.func=ra.error=ra.number=ra.string=ra.boolean=void 0;function e(u){return u===!0||u===!1}ra.boolean=e;function t(u){return typeof u=="string"||u instanceof String}ra.string=t;function r(u){return typeof u=="number"||u instanceof Number}ra.number=r;function n(u){return u instanceof Error}ra.error=n;function a(u){return typeof u=="function"}ra.func=a;function s(u){return Array.isArray(u)}ra.array=s;function i(u){return s(u)&&u.every(d=>t(d))}ra.stringArray=i;function l(u,d){return Array.isArray(u)&&u.every(d)}ra.typedArray=l;function c(u){return u!==null&&typeof u=="object"}return ra.objectLiteral=c,ra}var eb={},uae;function eSt(){if(uae)return eb;uae=1,Object.defineProperty(eb,"__esModule",{value:!0}),eb.ImplementationRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/implementation",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(eb.ImplementationRequest=t={})),eb}var tb={},dae;function tSt(){if(dae)return tb;dae=1,Object.defineProperty(tb,"__esModule",{value:!0}),tb.TypeDefinitionRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/typeDefinition",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(tb.TypeDefinitionRequest=t={})),tb}var Df={},fae;function rSt(){if(fae)return Df;fae=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.DidChangeWorkspaceFoldersNotification=Df.WorkspaceFoldersRequest=void 0;const e=$n();var t;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=e.MessageDirection.serverToClient,n.type=new e.ProtocolRequestType0(n.method)})(t||(Df.WorkspaceFoldersRequest=t={}));var r;return(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolNotificationType(n.method)})(r||(Df.DidChangeWorkspaceFoldersNotification=r={})),Df}var rb={},hae;function nSt(){if(hae)return rb;hae=1,Object.defineProperty(rb,"__esModule",{value:!0}),rb.ConfigurationRequest=void 0;const e=$n();var t;return(function(r){r.method="workspace/configuration",r.messageDirection=e.MessageDirection.serverToClient,r.type=new e.ProtocolRequestType(r.method)})(t||(rb.ConfigurationRequest=t={})),rb}var Lf={},mae;function aSt(){if(mae)return Lf;mae=1,Object.defineProperty(Lf,"__esModule",{value:!0}),Lf.ColorPresentationRequest=Lf.DocumentColorRequest=void 0;const e=$n();var t;(function(n){n.method="textDocument/documentColor",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(t||(Lf.DocumentColorRequest=t={}));var r;return(function(n){n.method="textDocument/colorPresentation",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(r||(Lf.ColorPresentationRequest=r={})),Lf}var Of={},pae;function sSt(){if(pae)return Of;pae=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.FoldingRangeRefreshRequest=Of.FoldingRangeRequest=void 0;const e=$n();var t;(function(n){n.method="textDocument/foldingRange",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(t||(Of.FoldingRangeRequest=t={}));var r;return(function(n){n.method="workspace/foldingRange/refresh",n.messageDirection=e.MessageDirection.serverToClient,n.type=new e.ProtocolRequestType0(n.method)})(r||(Of.FoldingRangeRefreshRequest=r={})),Of}var nb={},gae;function iSt(){if(gae)return nb;gae=1,Object.defineProperty(nb,"__esModule",{value:!0}),nb.DeclarationRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/declaration",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(nb.DeclarationRequest=t={})),nb}var ab={},vae;function oSt(){if(vae)return ab;vae=1,Object.defineProperty(ab,"__esModule",{value:!0}),ab.SelectionRangeRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/selectionRange",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(ab.SelectionRangeRequest=t={})),ab}var Ec={},bae;function lSt(){if(bae)return Ec;bae=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.WorkDoneProgressCancelNotification=Ec.WorkDoneProgressCreateRequest=Ec.WorkDoneProgress=void 0;const e=N0(),t=$n();var r;(function(s){s.type=new e.ProgressType;function i(l){return l===s.type}s.is=i})(r||(Ec.WorkDoneProgress=r={}));var n;(function(s){s.method="window/workDoneProgress/create",s.messageDirection=t.MessageDirection.serverToClient,s.type=new t.ProtocolRequestType(s.method)})(n||(Ec.WorkDoneProgressCreateRequest=n={}));var a;return(function(s){s.method="window/workDoneProgress/cancel",s.messageDirection=t.MessageDirection.clientToServer,s.type=new t.ProtocolNotificationType(s.method)})(a||(Ec.WorkDoneProgressCancelNotification=a={})),Ec}var Mc={},yae;function cSt(){if(yae)return Mc;yae=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.CallHierarchyOutgoingCallsRequest=Mc.CallHierarchyIncomingCallsRequest=Mc.CallHierarchyPrepareRequest=void 0;const e=$n();var t;(function(a){a.method="textDocument/prepareCallHierarchy",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(t||(Mc.CallHierarchyPrepareRequest=t={}));var r;(function(a){a.method="callHierarchy/incomingCalls",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(r||(Mc.CallHierarchyIncomingCallsRequest=r={}));var n;return(function(a){a.method="callHierarchy/outgoingCalls",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(n||(Mc.CallHierarchyOutgoingCallsRequest=n={})),Mc}var Ms={},xae;function uSt(){if(xae)return Ms;xae=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.SemanticTokensRefreshRequest=Ms.SemanticTokensRangeRequest=Ms.SemanticTokensDeltaRequest=Ms.SemanticTokensRequest=Ms.SemanticTokensRegistrationType=Ms.TokenFormat=void 0;const e=$n();var t;(function(l){l.Relative="relative"})(t||(Ms.TokenFormat=t={}));var r;(function(l){l.method="textDocument/semanticTokens",l.type=new e.RegistrationType(l.method)})(r||(Ms.SemanticTokensRegistrationType=r={}));var n;(function(l){l.method="textDocument/semanticTokens/full",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method),l.registrationMethod=r.method})(n||(Ms.SemanticTokensRequest=n={}));var a;(function(l){l.method="textDocument/semanticTokens/full/delta",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method),l.registrationMethod=r.method})(a||(Ms.SemanticTokensDeltaRequest=a={}));var s;(function(l){l.method="textDocument/semanticTokens/range",l.messageDirection=e.MessageDirection.clientToServer,l.type=new e.ProtocolRequestType(l.method),l.registrationMethod=r.method})(s||(Ms.SemanticTokensRangeRequest=s={}));var i;return(function(l){l.method="workspace/semanticTokens/refresh",l.messageDirection=e.MessageDirection.serverToClient,l.type=new e.ProtocolRequestType0(l.method)})(i||(Ms.SemanticTokensRefreshRequest=i={})),Ms}var sb={},wae;function dSt(){if(wae)return sb;wae=1,Object.defineProperty(sb,"__esModule",{value:!0}),sb.ShowDocumentRequest=void 0;const e=$n();var t;return(function(r){r.method="window/showDocument",r.messageDirection=e.MessageDirection.serverToClient,r.type=new e.ProtocolRequestType(r.method)})(t||(sb.ShowDocumentRequest=t={})),sb}var ib={},Sae;function fSt(){if(Sae)return ib;Sae=1,Object.defineProperty(ib,"__esModule",{value:!0}),ib.LinkedEditingRangeRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/linkedEditingRange",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(ib.LinkedEditingRangeRequest=t={})),ib}var ts={},kae;function hSt(){if(kae)return ts;kae=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.WillDeleteFilesRequest=ts.DidDeleteFilesNotification=ts.DidRenameFilesNotification=ts.WillRenameFilesRequest=ts.DidCreateFilesNotification=ts.WillCreateFilesRequest=ts.FileOperationPatternKind=void 0;const e=$n();var t;(function(c){c.file="file",c.folder="folder"})(t||(ts.FileOperationPatternKind=t={}));var r;(function(c){c.method="workspace/willCreateFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolRequestType(c.method)})(r||(ts.WillCreateFilesRequest=r={}));var n;(function(c){c.method="workspace/didCreateFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolNotificationType(c.method)})(n||(ts.DidCreateFilesNotification=n={}));var a;(function(c){c.method="workspace/willRenameFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolRequestType(c.method)})(a||(ts.WillRenameFilesRequest=a={}));var s;(function(c){c.method="workspace/didRenameFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolNotificationType(c.method)})(s||(ts.DidRenameFilesNotification=s={}));var i;(function(c){c.method="workspace/didDeleteFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolNotificationType(c.method)})(i||(ts.DidDeleteFilesNotification=i={}));var l;return(function(c){c.method="workspace/willDeleteFiles",c.messageDirection=e.MessageDirection.clientToServer,c.type=new e.ProtocolRequestType(c.method)})(l||(ts.WillDeleteFilesRequest=l={})),ts}var Tc={},_ae;function mSt(){if(_ae)return Tc;_ae=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.MonikerRequest=Tc.MonikerKind=Tc.UniquenessLevel=void 0;const e=$n();var t;(function(a){a.document="document",a.project="project",a.group="group",a.scheme="scheme",a.global="global"})(t||(Tc.UniquenessLevel=t={}));var r;(function(a){a.$import="import",a.$export="export",a.local="local"})(r||(Tc.MonikerKind=r={}));var n;return(function(a){a.method="textDocument/moniker",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(n||(Tc.MonikerRequest=n={})),Tc}var Ac={},Nae;function pSt(){if(Nae)return Ac;Nae=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.TypeHierarchySubtypesRequest=Ac.TypeHierarchySupertypesRequest=Ac.TypeHierarchyPrepareRequest=void 0;const e=$n();var t;(function(a){a.method="textDocument/prepareTypeHierarchy",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(t||(Ac.TypeHierarchyPrepareRequest=t={}));var r;(function(a){a.method="typeHierarchy/supertypes",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(r||(Ac.TypeHierarchySupertypesRequest=r={}));var n;return(function(a){a.method="typeHierarchy/subtypes",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(n||(Ac.TypeHierarchySubtypesRequest=n={})),Ac}var If={},Cae;function gSt(){if(Cae)return If;Cae=1,Object.defineProperty(If,"__esModule",{value:!0}),If.InlineValueRefreshRequest=If.InlineValueRequest=void 0;const e=$n();var t;(function(n){n.method="textDocument/inlineValue",n.messageDirection=e.MessageDirection.clientToServer,n.type=new e.ProtocolRequestType(n.method)})(t||(If.InlineValueRequest=t={}));var r;return(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=e.MessageDirection.serverToClient,n.type=new e.ProtocolRequestType0(n.method)})(r||(If.InlineValueRefreshRequest=r={})),If}var Dc={},jae;function vSt(){if(jae)return Dc;jae=1,Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.InlayHintRefreshRequest=Dc.InlayHintResolveRequest=Dc.InlayHintRequest=void 0;const e=$n();var t;(function(a){a.method="textDocument/inlayHint",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(t||(Dc.InlayHintRequest=t={}));var r;(function(a){a.method="inlayHint/resolve",a.messageDirection=e.MessageDirection.clientToServer,a.type=new e.ProtocolRequestType(a.method)})(r||(Dc.InlayHintResolveRequest=r={}));var n;return(function(a){a.method="workspace/inlayHint/refresh",a.messageDirection=e.MessageDirection.serverToClient,a.type=new e.ProtocolRequestType0(a.method)})(n||(Dc.InlayHintRefreshRequest=n={})),Dc}var bi={},Eae;function bSt(){if(Eae)return bi;Eae=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.DiagnosticRefreshRequest=bi.WorkspaceDiagnosticRequest=bi.DocumentDiagnosticRequest=bi.DocumentDiagnosticReportKind=bi.DiagnosticServerCancellationData=void 0;const e=N0(),t=e8(),r=$n();var n;(function(c){function u(d){const f=d;return f&&t.boolean(f.retriggerRequest)}c.is=u})(n||(bi.DiagnosticServerCancellationData=n={}));var a;(function(c){c.Full="full",c.Unchanged="unchanged"})(a||(bi.DocumentDiagnosticReportKind=a={}));var s;(function(c){c.method="textDocument/diagnostic",c.messageDirection=r.MessageDirection.clientToServer,c.type=new r.ProtocolRequestType(c.method),c.partialResult=new e.ProgressType})(s||(bi.DocumentDiagnosticRequest=s={}));var i;(function(c){c.method="workspace/diagnostic",c.messageDirection=r.MessageDirection.clientToServer,c.type=new r.ProtocolRequestType(c.method),c.partialResult=new e.ProgressType})(i||(bi.WorkspaceDiagnosticRequest=i={}));var l;return(function(c){c.method="workspace/diagnostic/refresh",c.messageDirection=r.MessageDirection.serverToClient,c.type=new r.ProtocolRequestType0(c.method)})(l||(bi.DiagnosticRefreshRequest=l={})),bi}var Pn={},Mae;function ySt(){if(Mae)return Pn;Mae=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.DidCloseNotebookDocumentNotification=Pn.DidSaveNotebookDocumentNotification=Pn.DidChangeNotebookDocumentNotification=Pn.NotebookCellArrayChange=Pn.DidOpenNotebookDocumentNotification=Pn.NotebookDocumentSyncRegistrationType=Pn.NotebookDocument=Pn.NotebookCell=Pn.ExecutionSummary=Pn.NotebookCellKind=void 0;const e=X$,t=e8(),r=$n();var n;(function(p){p.Markup=1,p.Code=2;function v(b){return b===1||b===2}p.is=v})(n||(Pn.NotebookCellKind=n={}));var a;(function(p){function v(S,_){const N={executionOrder:S};return(_===!0||_===!1)&&(N.success=_),N}p.create=v;function b(S){const _=S;return t.objectLiteral(_)&&e.uinteger.is(_.executionOrder)&&(_.success===void 0||t.boolean(_.success))}p.is=b;function y(S,_){return S===_?!0:S==null||_===null||_===void 0?!1:S.executionOrder===_.executionOrder&&S.success===_.success}p.equals=y})(a||(Pn.ExecutionSummary=a={}));var s;(function(p){function v(_,N){return{kind:_,document:N}}p.create=v;function b(_){const N=_;return t.objectLiteral(N)&&n.is(N.kind)&&e.DocumentUri.is(N.document)&&(N.metadata===void 0||t.objectLiteral(N.metadata))}p.is=b;function y(_,N){const k=new Set;return _.document!==N.document&&k.add("document"),_.kind!==N.kind&&k.add("kind"),_.executionSummary!==N.executionSummary&&k.add("executionSummary"),(_.metadata!==void 0||N.metadata!==void 0)&&!S(_.metadata,N.metadata)&&k.add("metadata"),(_.executionSummary!==void 0||N.executionSummary!==void 0)&&!a.equals(_.executionSummary,N.executionSummary)&&k.add("executionSummary"),k}p.diff=y;function S(_,N){if(_===N)return!0;if(_==null||N===null||N===void 0||typeof _!=typeof N||typeof _!="object")return!1;const k=Array.isArray(_),j=Array.isArray(N);if(k!==j)return!1;if(k&&j){if(_.length!==N.length)return!1;for(let E=0;E<_.length;E++)if(!S(_[E],N[E]))return!1}if(t.objectLiteral(_)&&t.objectLiteral(N)){const E=Object.keys(_),T=Object.keys(N);if(E.length!==T.length||(E.sort(),T.sort(),!S(E,T)))return!1;for(let O=0;O<E.length;O++){const R=E[O];if(!S(_[R],N[R]))return!1}}return!0}})(s||(Pn.NotebookCell=s={}));var i;(function(p){function v(y,S,_,N){return{uri:y,notebookType:S,version:_,cells:N}}p.create=v;function b(y){const S=y;return t.objectLiteral(S)&&t.string(S.uri)&&e.integer.is(S.version)&&t.typedArray(S.cells,s.is)}p.is=b})(i||(Pn.NotebookDocument=i={}));var l;(function(p){p.method="notebookDocument/sync",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.RegistrationType(p.method)})(l||(Pn.NotebookDocumentSyncRegistrationType=l={}));var c;(function(p){p.method="notebookDocument/didOpen",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(c||(Pn.DidOpenNotebookDocumentNotification=c={}));var u;(function(p){function v(y){const S=y;return t.objectLiteral(S)&&e.uinteger.is(S.start)&&e.uinteger.is(S.deleteCount)&&(S.cells===void 0||t.typedArray(S.cells,s.is))}p.is=v;function b(y,S,_){const N={start:y,deleteCount:S};return _!==void 0&&(N.cells=_),N}p.create=b})(u||(Pn.NotebookCellArrayChange=u={}));var d;(function(p){p.method="notebookDocument/didChange",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(d||(Pn.DidChangeNotebookDocumentNotification=d={}));var f;(function(p){p.method="notebookDocument/didSave",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(f||(Pn.DidSaveNotebookDocumentNotification=f={}));var m;return(function(p){p.method="notebookDocument/didClose",p.messageDirection=r.MessageDirection.clientToServer,p.type=new r.ProtocolNotificationType(p.method),p.registrationMethod=l.method})(m||(Pn.DidCloseNotebookDocumentNotification=m={})),Pn}var ob={},Tae;function xSt(){if(Tae)return ob;Tae=1,Object.defineProperty(ob,"__esModule",{value:!0}),ob.InlineCompletionRequest=void 0;const e=$n();var t;return(function(r){r.method="textDocument/inlineCompletion",r.messageDirection=e.MessageDirection.clientToServer,r.type=new e.ProtocolRequestType(r.method)})(t||(ob.InlineCompletionRequest=t={})),ob}var Aae;function wSt(){return Aae||(Aae=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkspaceSymbolRequest=e.CodeActionResolveRequest=e.CodeActionRequest=e.DocumentSymbolRequest=e.DocumentHighlightRequest=e.ReferencesRequest=e.DefinitionRequest=e.SignatureHelpRequest=e.SignatureHelpTriggerKind=e.HoverRequest=e.CompletionResolveRequest=e.CompletionRequest=e.CompletionTriggerKind=e.PublishDiagnosticsNotification=e.WatchKind=e.RelativePattern=e.FileChangeType=e.DidChangeWatchedFilesNotification=e.WillSaveTextDocumentWaitUntilRequest=e.WillSaveTextDocumentNotification=e.TextDocumentSaveReason=e.DidSaveTextDocumentNotification=e.DidCloseTextDocumentNotification=e.DidChangeTextDocumentNotification=e.TextDocumentContentChangeEvent=e.DidOpenTextDocumentNotification=e.TextDocumentSyncKind=e.TelemetryEventNotification=e.LogMessageNotification=e.ShowMessageRequest=e.ShowMessageNotification=e.MessageType=e.DidChangeConfigurationNotification=e.ExitNotification=e.ShutdownRequest=e.InitializedNotification=e.InitializeErrorCodes=e.InitializeRequest=e.WorkDoneProgressOptions=e.TextDocumentRegistrationOptions=e.StaticRegistrationOptions=e.PositionEncodingKind=e.FailureHandlingKind=e.ResourceOperationKind=e.UnregistrationRequest=e.RegistrationRequest=e.DocumentSelector=e.NotebookCellTextDocumentFilter=e.NotebookDocumentFilter=e.TextDocumentFilter=void 0,e.MonikerRequest=e.MonikerKind=e.UniquenessLevel=e.WillDeleteFilesRequest=e.DidDeleteFilesNotification=e.WillRenameFilesRequest=e.DidRenameFilesNotification=e.WillCreateFilesRequest=e.DidCreateFilesNotification=e.FileOperationPatternKind=e.LinkedEditingRangeRequest=e.ShowDocumentRequest=e.SemanticTokensRegistrationType=e.SemanticTokensRefreshRequest=e.SemanticTokensRangeRequest=e.SemanticTokensDeltaRequest=e.SemanticTokensRequest=e.TokenFormat=e.CallHierarchyPrepareRequest=e.CallHierarchyOutgoingCallsRequest=e.CallHierarchyIncomingCallsRequest=e.WorkDoneProgressCancelNotification=e.WorkDoneProgressCreateRequest=e.WorkDoneProgress=e.SelectionRangeRequest=e.DeclarationRequest=e.FoldingRangeRefreshRequest=e.FoldingRangeRequest=e.ColorPresentationRequest=e.DocumentColorRequest=e.ConfigurationRequest=e.DidChangeWorkspaceFoldersNotification=e.WorkspaceFoldersRequest=e.TypeDefinitionRequest=e.ImplementationRequest=e.ApplyWorkspaceEditRequest=e.ExecuteCommandRequest=e.PrepareRenameRequest=e.RenameRequest=e.PrepareSupportDefaultBehavior=e.DocumentOnTypeFormattingRequest=e.DocumentRangesFormattingRequest=e.DocumentRangeFormattingRequest=e.DocumentFormattingRequest=e.DocumentLinkResolveRequest=e.DocumentLinkRequest=e.CodeLensRefreshRequest=e.CodeLensResolveRequest=e.CodeLensRequest=e.WorkspaceSymbolResolveRequest=void 0,e.InlineCompletionRequest=e.DidCloseNotebookDocumentNotification=e.DidSaveNotebookDocumentNotification=e.DidChangeNotebookDocumentNotification=e.NotebookCellArrayChange=e.DidOpenNotebookDocumentNotification=e.NotebookDocumentSyncRegistrationType=e.NotebookDocument=e.NotebookCell=e.ExecutionSummary=e.NotebookCellKind=e.DiagnosticRefreshRequest=e.WorkspaceDiagnosticRequest=e.DocumentDiagnosticRequest=e.DocumentDiagnosticReportKind=e.DiagnosticServerCancellationData=e.InlayHintRefreshRequest=e.InlayHintResolveRequest=e.InlayHintRequest=e.InlineValueRefreshRequest=e.InlineValueRequest=e.TypeHierarchySupertypesRequest=e.TypeHierarchySubtypesRequest=e.TypeHierarchyPrepareRequest=void 0;const t=$n(),r=X$,n=e8(),a=eSt();Object.defineProperty(e,"ImplementationRequest",{enumerable:!0,get:function(){return a.ImplementationRequest}});const s=tSt();Object.defineProperty(e,"TypeDefinitionRequest",{enumerable:!0,get:function(){return s.TypeDefinitionRequest}});const i=rSt();Object.defineProperty(e,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return i.WorkspaceFoldersRequest}}),Object.defineProperty(e,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return i.DidChangeWorkspaceFoldersNotification}});const l=nSt();Object.defineProperty(e,"ConfigurationRequest",{enumerable:!0,get:function(){return l.ConfigurationRequest}});const c=aSt();Object.defineProperty(e,"DocumentColorRequest",{enumerable:!0,get:function(){return c.DocumentColorRequest}}),Object.defineProperty(e,"ColorPresentationRequest",{enumerable:!0,get:function(){return c.ColorPresentationRequest}});const u=sSt();Object.defineProperty(e,"FoldingRangeRequest",{enumerable:!0,get:function(){return u.FoldingRangeRequest}}),Object.defineProperty(e,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return u.FoldingRangeRefreshRequest}});const d=iSt();Object.defineProperty(e,"DeclarationRequest",{enumerable:!0,get:function(){return d.DeclarationRequest}});const f=oSt();Object.defineProperty(e,"SelectionRangeRequest",{enumerable:!0,get:function(){return f.SelectionRangeRequest}});const m=lSt();Object.defineProperty(e,"WorkDoneProgress",{enumerable:!0,get:function(){return m.WorkDoneProgress}}),Object.defineProperty(e,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return m.WorkDoneProgressCreateRequest}}),Object.defineProperty(e,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return m.WorkDoneProgressCancelNotification}});const p=cSt();Object.defineProperty(e,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(e,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return p.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(e,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return p.CallHierarchyPrepareRequest}});const v=uSt();Object.defineProperty(e,"TokenFormat",{enumerable:!0,get:function(){return v.TokenFormat}}),Object.defineProperty(e,"SemanticTokensRequest",{enumerable:!0,get:function(){return v.SemanticTokensRequest}}),Object.defineProperty(e,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return v.SemanticTokensDeltaRequest}}),Object.defineProperty(e,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return v.SemanticTokensRangeRequest}}),Object.defineProperty(e,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return v.SemanticTokensRefreshRequest}}),Object.defineProperty(e,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return v.SemanticTokensRegistrationType}});const b=dSt();Object.defineProperty(e,"ShowDocumentRequest",{enumerable:!0,get:function(){return b.ShowDocumentRequest}});const y=fSt();Object.defineProperty(e,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return y.LinkedEditingRangeRequest}});const S=hSt();Object.defineProperty(e,"FileOperationPatternKind",{enumerable:!0,get:function(){return S.FileOperationPatternKind}}),Object.defineProperty(e,"DidCreateFilesNotification",{enumerable:!0,get:function(){return S.DidCreateFilesNotification}}),Object.defineProperty(e,"WillCreateFilesRequest",{enumerable:!0,get:function(){return S.WillCreateFilesRequest}}),Object.defineProperty(e,"DidRenameFilesNotification",{enumerable:!0,get:function(){return S.DidRenameFilesNotification}}),Object.defineProperty(e,"WillRenameFilesRequest",{enumerable:!0,get:function(){return S.WillRenameFilesRequest}}),Object.defineProperty(e,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return S.DidDeleteFilesNotification}}),Object.defineProperty(e,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return S.WillDeleteFilesRequest}});const _=mSt();Object.defineProperty(e,"UniquenessLevel",{enumerable:!0,get:function(){return _.UniquenessLevel}}),Object.defineProperty(e,"MonikerKind",{enumerable:!0,get:function(){return _.MonikerKind}}),Object.defineProperty(e,"MonikerRequest",{enumerable:!0,get:function(){return _.MonikerRequest}});const N=pSt();Object.defineProperty(e,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return N.TypeHierarchyPrepareRequest}}),Object.defineProperty(e,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return N.TypeHierarchySubtypesRequest}}),Object.defineProperty(e,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return N.TypeHierarchySupertypesRequest}});const k=gSt();Object.defineProperty(e,"InlineValueRequest",{enumerable:!0,get:function(){return k.InlineValueRequest}}),Object.defineProperty(e,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return k.InlineValueRefreshRequest}});const j=vSt();Object.defineProperty(e,"InlayHintRequest",{enumerable:!0,get:function(){return j.InlayHintRequest}}),Object.defineProperty(e,"InlayHintResolveRequest",{enumerable:!0,get:function(){return j.InlayHintResolveRequest}}),Object.defineProperty(e,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return j.InlayHintRefreshRequest}});const E=bSt();Object.defineProperty(e,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return E.DiagnosticServerCancellationData}}),Object.defineProperty(e,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return E.DocumentDiagnosticReportKind}}),Object.defineProperty(e,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return E.DocumentDiagnosticRequest}}),Object.defineProperty(e,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return E.WorkspaceDiagnosticRequest}}),Object.defineProperty(e,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return E.DiagnosticRefreshRequest}});const T=ySt();Object.defineProperty(e,"NotebookCellKind",{enumerable:!0,get:function(){return T.NotebookCellKind}}),Object.defineProperty(e,"ExecutionSummary",{enumerable:!0,get:function(){return T.ExecutionSummary}}),Object.defineProperty(e,"NotebookCell",{enumerable:!0,get:function(){return T.NotebookCell}}),Object.defineProperty(e,"NotebookDocument",{enumerable:!0,get:function(){return T.NotebookDocument}}),Object.defineProperty(e,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return T.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(e,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidOpenNotebookDocumentNotification}}),Object.defineProperty(e,"NotebookCellArrayChange",{enumerable:!0,get:function(){return T.NotebookCellArrayChange}}),Object.defineProperty(e,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidChangeNotebookDocumentNotification}}),Object.defineProperty(e,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidSaveNotebookDocumentNotification}}),Object.defineProperty(e,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return T.DidCloseNotebookDocumentNotification}});const O=xSt();Object.defineProperty(e,"InlineCompletionRequest",{enumerable:!0,get:function(){return O.InlineCompletionRequest}});var R;(function(ee){function Le(We){const be=We;return n.string(be)||n.string(be.language)||n.string(be.scheme)||n.string(be.pattern)}ee.is=Le})(R||(e.TextDocumentFilter=R={}));var H;(function(ee){function Le(We){const be=We;return n.objectLiteral(be)&&(n.string(be.notebookType)||n.string(be.scheme)||n.string(be.pattern))}ee.is=Le})(H||(e.NotebookDocumentFilter=H={}));var $;(function(ee){function Le(We){const be=We;return n.objectLiteral(be)&&(n.string(be.notebook)||H.is(be.notebook))&&(be.language===void 0||n.string(be.language))}ee.is=Le})($||(e.NotebookCellTextDocumentFilter=$={}));var L;(function(ee){function Le(We){if(!Array.isArray(We))return!1;for(let be of We)if(!n.string(be)&&!R.is(be)&&!$.is(be))return!1;return!0}ee.is=Le})(L||(e.DocumentSelector=L={}));var A;(function(ee){ee.method="client/registerCapability",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolRequestType(ee.method)})(A||(e.RegistrationRequest=A={}));var M;(function(ee){ee.method="client/unregisterCapability",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolRequestType(ee.method)})(M||(e.UnregistrationRequest=M={}));var P;(function(ee){ee.Create="create",ee.Rename="rename",ee.Delete="delete"})(P||(e.ResourceOperationKind=P={}));var I;(function(ee){ee.Abort="abort",ee.Transactional="transactional",ee.TextOnlyTransactional="textOnlyTransactional",ee.Undo="undo"})(I||(e.FailureHandlingKind=I={}));var B;(function(ee){ee.UTF8="utf-8",ee.UTF16="utf-16",ee.UTF32="utf-32"})(B||(e.PositionEncodingKind=B={}));var F;(function(ee){function Le(We){const be=We;return be&&n.string(be.id)&&be.id.length>0}ee.hasId=Le})(F||(e.StaticRegistrationOptions=F={}));var q;(function(ee){function Le(We){const be=We;return be&&(be.documentSelector===null||L.is(be.documentSelector))}ee.is=Le})(q||(e.TextDocumentRegistrationOptions=q={}));var Q;(function(ee){function Le(be){const K=be;return n.objectLiteral(K)&&(K.workDoneProgress===void 0||n.boolean(K.workDoneProgress))}ee.is=Le;function We(be){const K=be;return K&&n.boolean(K.workDoneProgress)}ee.hasWorkDoneProgress=We})(Q||(e.WorkDoneProgressOptions=Q={}));var W;(function(ee){ee.method="initialize",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(W||(e.InitializeRequest=W={}));var G;(function(ee){ee.unknownProtocolVersion=1})(G||(e.InitializeErrorCodes=G={}));var J;(function(ee){ee.method="initialized",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(J||(e.InitializedNotification=J={}));var X;(function(ee){ee.method="shutdown",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType0(ee.method)})(X||(e.ShutdownRequest=X={}));var V;(function(ee){ee.method="exit",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType0(ee.method)})(V||(e.ExitNotification=V={}));var se;(function(ee){ee.method="workspace/didChangeConfiguration",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(se||(e.DidChangeConfigurationNotification=se={}));var de;(function(ee){ee.Error=1,ee.Warning=2,ee.Info=3,ee.Log=4,ee.Debug=5})(de||(e.MessageType=de={}));var he;(function(ee){ee.method="window/showMessage",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolNotificationType(ee.method)})(he||(e.ShowMessageNotification=he={}));var te;(function(ee){ee.method="window/showMessageRequest",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolRequestType(ee.method)})(te||(e.ShowMessageRequest=te={}));var le;(function(ee){ee.method="window/logMessage",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolNotificationType(ee.method)})(le||(e.LogMessageNotification=le={}));var oe;(function(ee){ee.method="telemetry/event",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolNotificationType(ee.method)})(oe||(e.TelemetryEventNotification=oe={}));var Z;(function(ee){ee.None=0,ee.Full=1,ee.Incremental=2})(Z||(e.TextDocumentSyncKind=Z={}));var ve;(function(ee){ee.method="textDocument/didOpen",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(ve||(e.DidOpenTextDocumentNotification=ve={}));var U;(function(ee){function Le(be){let K=be;return K!=null&&typeof K.text=="string"&&K.range!==void 0&&(K.rangeLength===void 0||typeof K.rangeLength=="number")}ee.isIncremental=Le;function We(be){let K=be;return K!=null&&typeof K.text=="string"&&K.range===void 0&&K.rangeLength===void 0}ee.isFull=We})(U||(e.TextDocumentContentChangeEvent=U={}));var ge;(function(ee){ee.method="textDocument/didChange",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(ge||(e.DidChangeTextDocumentNotification=ge={}));var ue;(function(ee){ee.method="textDocument/didClose",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(ue||(e.DidCloseTextDocumentNotification=ue={}));var re;(function(ee){ee.method="textDocument/didSave",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(re||(e.DidSaveTextDocumentNotification=re={}));var ne;(function(ee){ee.Manual=1,ee.AfterDelay=2,ee.FocusOut=3})(ne||(e.TextDocumentSaveReason=ne={}));var me;(function(ee){ee.method="textDocument/willSave",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(me||(e.WillSaveTextDocumentNotification=me={}));var ke;(function(ee){ee.method="textDocument/willSaveWaitUntil",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(ke||(e.WillSaveTextDocumentWaitUntilRequest=ke={}));var we;(function(ee){ee.method="workspace/didChangeWatchedFiles",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolNotificationType(ee.method)})(we||(e.DidChangeWatchedFilesNotification=we={}));var pe;(function(ee){ee.Created=1,ee.Changed=2,ee.Deleted=3})(pe||(e.FileChangeType=pe={}));var Oe;(function(ee){function Le(We){const be=We;return n.objectLiteral(be)&&(r.URI.is(be.baseUri)||r.WorkspaceFolder.is(be.baseUri))&&n.string(be.pattern)}ee.is=Le})(Oe||(e.RelativePattern=Oe={}));var Ae;(function(ee){ee.Create=1,ee.Change=2,ee.Delete=4})(Ae||(e.WatchKind=Ae={}));var Re;(function(ee){ee.method="textDocument/publishDiagnostics",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolNotificationType(ee.method)})(Re||(e.PublishDiagnosticsNotification=Re={}));var Ve;(function(ee){ee.Invoked=1,ee.TriggerCharacter=2,ee.TriggerForIncompleteCompletions=3})(Ve||(e.CompletionTriggerKind=Ve={}));var gt;(function(ee){ee.method="textDocument/completion",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(gt||(e.CompletionRequest=gt={}));var lt;(function(ee){ee.method="completionItem/resolve",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(lt||(e.CompletionResolveRequest=lt={}));var Pt;(function(ee){ee.method="textDocument/hover",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Pt||(e.HoverRequest=Pt={}));var fr;(function(ee){ee.Invoked=1,ee.TriggerCharacter=2,ee.ContentChange=3})(fr||(e.SignatureHelpTriggerKind=fr={}));var Qe;(function(ee){ee.method="textDocument/signatureHelp",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Qe||(e.SignatureHelpRequest=Qe={}));var Vt;(function(ee){ee.method="textDocument/definition",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Vt||(e.DefinitionRequest=Vt={}));var at;(function(ee){ee.method="textDocument/references",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(at||(e.ReferencesRequest=at={}));var Ne;(function(ee){ee.method="textDocument/documentHighlight",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Ne||(e.DocumentHighlightRequest=Ne={}));var Fe;(function(ee){ee.method="textDocument/documentSymbol",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Fe||(e.DocumentSymbolRequest=Fe={}));var Ke;(function(ee){ee.method="textDocument/codeAction",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Ke||(e.CodeActionRequest=Ke={}));var Tt;(function(ee){ee.method="codeAction/resolve",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Tt||(e.CodeActionResolveRequest=Tt={}));var wt;(function(ee){ee.method="workspace/symbol",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(wt||(e.WorkspaceSymbolRequest=wt={}));var Zt;(function(ee){ee.method="workspaceSymbol/resolve",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Zt||(e.WorkspaceSymbolResolveRequest=Zt={}));var Xe;(function(ee){ee.method="textDocument/codeLens",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Xe||(e.CodeLensRequest=Xe={}));var nt;(function(ee){ee.method="codeLens/resolve",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(nt||(e.CodeLensResolveRequest=nt={}));var bt;(function(ee){ee.method="workspace/codeLens/refresh",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolRequestType0(ee.method)})(bt||(e.CodeLensRefreshRequest=bt={}));var Ct;(function(ee){ee.method="textDocument/documentLink",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Ct||(e.DocumentLinkRequest=Ct={}));var fe;(function(ee){ee.method="documentLink/resolve",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(fe||(e.DocumentLinkResolveRequest=fe={}));var De;(function(ee){ee.method="textDocument/formatting",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(De||(e.DocumentFormattingRequest=De={}));var Ue;(function(ee){ee.method="textDocument/rangeFormatting",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Ue||(e.DocumentRangeFormattingRequest=Ue={}));var dt;(function(ee){ee.method="textDocument/rangesFormatting",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(dt||(e.DocumentRangesFormattingRequest=dt={}));var Nt;(function(ee){ee.method="textDocument/onTypeFormatting",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Nt||(e.DocumentOnTypeFormattingRequest=Nt={}));var Mt;(function(ee){ee.Identifier=1})(Mt||(e.PrepareSupportDefaultBehavior=Mt={}));var Je;(function(ee){ee.method="textDocument/rename",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(Je||(e.RenameRequest=Je={}));var et;(function(ee){ee.method="textDocument/prepareRename",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(et||(e.PrepareRenameRequest=et={}));var it;(function(ee){ee.method="workspace/executeCommand",ee.messageDirection=t.MessageDirection.clientToServer,ee.type=new t.ProtocolRequestType(ee.method)})(it||(e.ExecuteCommandRequest=it={}));var tr;(function(ee){ee.method="workspace/applyEdit",ee.messageDirection=t.MessageDirection.serverToClient,ee.type=new t.ProtocolRequestType("workspace/applyEdit")})(tr||(e.ApplyWorkspaceEditRequest=tr={}))})(jO)),jO}var lb={},Dae;function SSt(){if(Dae)return lb;Dae=1,Object.defineProperty(lb,"__esModule",{value:!0}),lb.createProtocolConnection=void 0;const e=N0();function t(r,n,a,s){return e.ConnectionStrategy.is(s)&&(s={connectionStrategy:s}),(0,e.createMessageConnection)(r,n,a,s)}return lb.createProtocolConnection=t,lb}var Lae;function kSt(){return Lae||(Lae=1,(function(e){var t=Af&&Af.__createBinding||(Object.create?(function(s,i,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(i,l);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[l]}}),Object.defineProperty(s,c,u)}):(function(s,i,l,c){c===void 0&&(c=l),s[c]=i[l]})),r=Af&&Af.__exportStar||function(s,i){for(var l in s)l!=="default"&&!Object.prototype.hasOwnProperty.call(i,l)&&t(i,s,l)};Object.defineProperty(e,"__esModule",{value:!0}),e.LSPErrorCodes=e.createProtocolConnection=void 0,r(N0(),e),r(X$,e),r($n(),e),r(wSt(),e);var n=SSt();Object.defineProperty(e,"createProtocolConnection",{enumerable:!0,get:function(){return n.createProtocolConnection}});var a;(function(s){s.lspReservedErrorRangeStart=-32899,s.RequestFailed=-32803,s.ServerCancelled=-32802,s.ContentModified=-32801,s.RequestCancelled=-32800,s.lspReservedErrorRangeEnd=-32800})(a||(e.LSPErrorCodes=a={}))})(Af)),Af}var Oae;function _St(){return Oae||(Oae=1,(function(e){var t=Cf&&Cf.__createBinding||(Object.create?(function(s,i,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(i,l);(!u||("get"in u?!i.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return i[l]}}),Object.defineProperty(s,c,u)}):(function(s,i,l,c){c===void 0&&(c=l),s[c]=i[l]})),r=Cf&&Cf.__exportStar||function(s,i){for(var l in s)l!=="default"&&!Object.prototype.hasOwnProperty.call(i,l)&&t(i,s,l)};Object.defineProperty(e,"__esModule",{value:!0}),e.createProtocolConnection=void 0;const n=iae();r(iae(),e),r(kSt(),e);function a(s,i,l,c){return(0,n.createMessageConnection)(s,i,l,c)}e.createProtocolConnection=a})(Cf)),Cf}var Tr=_St();class NSt{constructor(t){_t(this,"connection",null);_t(this,"socket",null);_t(this,"disposables",[]);_t(this,"documentVersion",0);_t(this,"language");_t(this,"workspaceRoot");_t(this,"monacoInstance",null);_t(this,"_isConnected",!1);_t(this,"documentToModelUri",new Map);this.language=t.language,this.workspaceRoot=t.workspaceRoot||"/"}get isConnected(){return this._isConnected}async start(t,r){this.socket=t,this.monacoInstance=r;const n=Uwt(t),a=new $wt(n),s=new Fwt(n);this.connection=J$.createMessageConnection(a,s),this.setupNotificationHandlers(),this.connection.listen(),await this.connection.sendRequest("initialize",{processId:null,capabilities:{textDocument:{completion:{completionItem:{snippetSupport:!0,documentationFormat:[Tr.MarkupKind.Markdown,Tr.MarkupKind.PlainText]}},hover:{contentFormat:[Tr.MarkupKind.Markdown,Tr.MarkupKind.PlainText]},publishDiagnostics:{relatedInformation:!0},definition:{},synchronization:{didSave:!0,dynamicRegistration:!1}},workspace:{workspaceFolders:!0}},rootUri:`file://${this.workspaceRoot}`,workspaceFolders:[{uri:`file://${this.workspaceRoot}`,name:this.workspaceRoot.split("/").pop()||"workspace"}]}),this.connection.sendNotification("initialized",{}),this.registerProviders(),this._isConnected=!0}setupNotificationHandlers(){this.connection&&this.connection.onNotification("textDocument/publishDiagnostics",t=>{if(!this.monacoInstance)return;const r=this.documentToModelUri.get(t.uri),n=this.monacoInstance.editor.getModels(),a=n.find(s=>{const i=s.uri.toString();return r&&i===r?!0:i===t.uri||`file://${i}`===t.uri||i===t.uri.replace("file://","")});if(a){const s=t.diagnostics.map(i=>jSt(i));this.monacoInstance.editor.setModelMarkers(a,"lsp",s),console.log(`[lsp-client] Set ${s.length} diagnostics for ${t.uri}`)}else t.diagnostics.length>0&&console.warn(`[lsp-client] No model found for diagnostics URI: ${t.uri}`,`Mapped model URI: ${r||"none"}`,`Available models: ${n.map(s=>s.uri.toString()).join(", ")}`)})}registerProviders(){if(!this.monacoInstance||!this.connection)return;const t=this.connection,r=this.language;this.disposables.push(this.monacoInstance.languages.registerCompletionItemProvider(r,{triggerCharacters:[".","/",'"',"'","`","<","@"],provideCompletionItems:async(n,a)=>{try{const s=await t.sendRequest("textDocument/completion",{textDocument:{uri:n.uri.toString()},position:{line:a.lineNumber-1,character:a.column-1}});if(!s)return{suggestions:[]};const i=Array.isArray(s)?s:s.items,l=n.getWordUntilPosition(a),c={startLineNumber:a.lineNumber,startColumn:l.startColumn,endLineNumber:a.lineNumber,endColumn:l.endColumn};return{suggestions:i.map(u=>MSt(u,c,this.monacoInstance))}}catch{return{suggestions:[]}}}})),this.disposables.push(this.monacoInstance.languages.registerHoverProvider(r,{provideHover:async(n,a)=>{try{const s=await t.sendRequest("textDocument/hover",{textDocument:{uri:n.uri.toString()},position:{line:a.lineNumber-1,character:a.column-1}});if(!s)return null;const i=c=>typeof c=="string"?{value:c}:c&&typeof c=="object"&&"value"in c?{value:String(c.value)}:{value:String(c)};return{contents:Array.isArray(s.contents)?s.contents.map(i):[i(s.contents)],range:s.range?{startLineNumber:s.range.start.line+1,startColumn:s.range.start.character+1,endLineNumber:s.range.end.line+1,endColumn:s.range.end.character+1}:void 0}}catch{return null}}})),this.disposables.push(this.monacoInstance.languages.registerDefinitionProvider(r,{provideDefinition:async(n,a)=>{try{const s=await t.sendRequest("textDocument/definition",{textDocument:{uri:n.uri.toString()},position:{line:a.lineNumber-1,character:a.column-1}});return s?(Array.isArray(s)?s:[s]).map(l=>({uri:this.monacoInstance.Uri.parse("uri"in l?l.uri:""),range:{startLineNumber:("range"in l?l.range.start.line:0)+1,startColumn:("range"in l?l.range.start.character:0)+1,endLineNumber:("range"in l?l.range.end.line:0)+1,endColumn:("range"in l?l.range.end.character:0)+1}})):null}catch{return null}}}))}resolveDocumentUri(t){return t.startsWith("/")?`file://${t}`:`file://${this.workspaceRoot}/${t}`}sendDidOpen(t,r,n,a){this.connection&&(this.documentVersion=1,a&&a!==t&&this.documentToModelUri.set(t,a),this.connection.sendNotification("textDocument/didOpen",{textDocument:{uri:t,languageId:r,version:this.documentVersion,text:n}}))}sendDidChange(t,r){this.connection&&(this.documentVersion++,this.connection.sendNotification("textDocument/didChange",{textDocument:{uri:t,version:this.documentVersion},contentChanges:[{text:r}]}))}sendDidClose(t){this.connection&&(this.documentToModelUri.delete(t),this.connection.sendNotification("textDocument/didClose",{textDocument:{uri:t}}))}async stop(){this._isConnected=!1;for(const t of this.disposables)t.dispose();this.disposables=[],this.connection&&(this.connection.dispose(),this.connection=null),this.socket&&this.socket.readyState===WebSocket.OPEN&&(this.socket.close(),this.socket=null)}}function CSt(e){switch(e){case Tr.DiagnosticSeverity.Error:return 8;case Tr.DiagnosticSeverity.Warning:return 4;case Tr.DiagnosticSeverity.Information:return 2;case Tr.DiagnosticSeverity.Hint:return 1;default:return 2}}function jSt(e){return{severity:CSt(e.severity),message:e.message,startLineNumber:e.range.start.line+1,startColumn:e.range.start.character+1,endLineNumber:e.range.end.line+1,endColumn:e.range.end.character+1,source:e.source,code:typeof e.code=="number"?String(e.code):e.code}}function ESt(e,t){const r=t.languages.CompletionItemKind;switch(e){case Tr.CompletionItemKind.Text:return r.Text;case Tr.CompletionItemKind.Method:return r.Method;case Tr.CompletionItemKind.Function:return r.Function;case Tr.CompletionItemKind.Constructor:return r.Constructor;case Tr.CompletionItemKind.Field:return r.Field;case Tr.CompletionItemKind.Variable:return r.Variable;case Tr.CompletionItemKind.Class:return r.Class;case Tr.CompletionItemKind.Interface:return r.Interface;case Tr.CompletionItemKind.Module:return r.Module;case Tr.CompletionItemKind.Property:return r.Property;case Tr.CompletionItemKind.Unit:return r.Unit;case Tr.CompletionItemKind.Value:return r.Value;case Tr.CompletionItemKind.Enum:return r.Enum;case Tr.CompletionItemKind.Keyword:return r.Keyword;case Tr.CompletionItemKind.Snippet:return r.Snippet;case Tr.CompletionItemKind.Color:return r.Color;case Tr.CompletionItemKind.File:return r.File;case Tr.CompletionItemKind.Reference:return r.Reference;case Tr.CompletionItemKind.Folder:return r.Folder;case Tr.CompletionItemKind.EnumMember:return r.EnumMember;case Tr.CompletionItemKind.Constant:return r.Constant;case Tr.CompletionItemKind.Struct:return r.Struct;case Tr.CompletionItemKind.Event:return r.Event;case Tr.CompletionItemKind.Operator:return r.Operator;case Tr.CompletionItemKind.TypeParameter:return r.TypeParameter;default:return r.Text}}function MSt(e,t,r){const n=e.documentation?typeof e.documentation=="string"?e.documentation:{value:e.documentation.value}:void 0;return{label:e.label,kind:ESt(e.kind,r),detail:e.detail,documentation:n,insertText:e.insertText||e.label,range:t,sortText:e.sortText,filterText:e.filterText}}let EO=null,pp=null;const kd=new Map,L6=new Set;function TSt(e){return L6.add(e),()=>{L6.delete(e)}}function Iae(e,t){L6.forEach(r=>{try{r(e,t)}catch(n){console.error("[lsp-client] Error in connection state callback:",n)}})}async function t8(e=!1){return EO&&!e?EO:(pp&&!e||(pp=fetch("/api/lsp/status").then(t=>{if(!t.ok)throw new Error(`Failed to fetch LSP status: ${t.statusText}`);return t.json()}).then(t=>(EO=t,pp=null,t)).catch(t=>{throw pp=null,t})),pp)}async function Rae(e){try{return(await t8()).servers.find(n=>n.languages.includes(e))?.available??!1}catch{return!1}}function ASt(e){const t=window.location.protocol==="https:"?"wss:":"ws:",r=window.location.host;return`${t}//${r}/ws/lsp?language=${encodeURIComponent(e)}`}async function DSt(e,t,r){if(kd.has(e)){const i=kd.get(e);if(i.socket.readyState===WebSocket.OPEN&&i.client.isConnected)return console.log(`[lsp-client] Already connected to ${e} server`),i.client;await Kye(e)}if(!t)return console.log(`[lsp-client] Monaco instance required for ${e} LSP connection`),null;const n=await t8();if(!n.servers.find(i=>i.languages.includes(e))?.available)return console.log(`[lsp-client] No LSP server available for ${e}`),null;const s=n.workspaceRoot;return console.log(`[lsp-client] Connecting to ${e} language server...`),new Promise((i,l)=>{const c=ASt(e),u=new WebSocket(c);u.onopen=async()=>{console.log(`[lsp-client] WebSocket connected for ${e}`);try{const d=new NSt({language:e,workspaceRoot:s});await d.start(u,t),kd.set(e,{client:d,socket:u,language:e}),Iae(e,"connected"),console.log(`[lsp-client] Language client started for ${e}`),i(d)}catch(d){console.error("[lsp-client] Error creating language client:",d),u.close(),l(d)}},u.onerror=d=>{console.error(`[lsp-client] WebSocket error for ${e}:`,d),l(new Error(`WebSocket connection failed for ${e}`))},u.onclose=d=>{console.log(`[lsp-client] WebSocket closed for ${e}: code=${d.code}, reason=${d.reason}`),kd.delete(e),Iae(e,"disconnected")}})}async function Kye(e){const t=kd.get(e);if(t){console.log(`[lsp-client] Disconnecting from ${e} server...`);try{await t.client.stop()}catch(r){console.warn(`[lsp-client] Error stopping client for ${e}:`,r)}kd.delete(e)}}function Pae(e){const t=kd.get(e);return t&&t.socket.readyState===WebSocket.OPEN&&t.client.isConnected?"connected":"disconnected"}function MO(e){return kd.get(e)?.client??null}function LSt({monaco:e,language:t,documentUri:r,autoConnect:n=!0}){const[a,s]=w.useState("idle"),[i,l]=w.useState(!1),[c,u]=w.useState(null),[d,f]=w.useState(null),m=w.useRef(!0),p=w.useCallback(async()=>{try{const y=await t8(!0);m.current&&f(y)}catch(y){console.error("[useLsp] Error fetching status:",y)}},[]);w.useEffect(()=>{if(!PC(t)){l(!1),s("unavailable");return}let y=!1;return Rae(t).then(S=>{y||!m.current||(l(S),S||s("unavailable"))}),()=>{y=!0}},[t]);const v=w.useCallback(async()=>{if(!e){u("Monaco instance not available"),s("error");return}if(!PC(t)){s("unavailable");return}if(!await Rae(t)){s("unavailable");return}s("connecting"),u(null);try{const S=await DSt(t,e,r);m.current&&s(S?"connected":"unavailable")}catch(S){m.current&&(u(S instanceof Error?S.message:"Connection failed"),s("error"))}},[e,t,r]),b=w.useCallback(async()=>{await Kye(t),m.current&&(s("idle"),u(null))},[t]);return w.useEffect(()=>{if(!(!n||!e||!i||a!=="idle")){if(Pae(t)==="connected"){s("connected");return}v()}},[n,e,i,a,t,v]),w.useEffect(()=>{p()},[p]),w.useEffect(()=>(m.current=!0,()=>{m.current=!1}),[]),w.useEffect(()=>TSt((S,_)=>{S!==t||!m.current||(_==="connected"&&a!=="connected"&&a!=="connecting"?s("connected"):_==="disconnected"&&a==="connected"&&(s("idle"),console.log(`[useLsp] LSP disconnected for ${t}, reverting to idle state`)))}),[t,a]),w.useEffect(()=>{const y=Pae(t);y==="connected"&&a!=="connected"&&a!=="connecting"?s("connected"):y==="disconnected"&&a==="connected"&&s("idle")},[t,a]),{state:a,available:i,error:c,connect:v,disconnect:b,status:d,refreshStatus:p}}let mk=null,O6=!1;const OSt={base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6A9955",fontStyle:"italic"},{token:"keyword",foreground:"C586C0"},{token:"keyword.control",foreground:"C586C0"},{token:"keyword.operator",foreground:"C586C0"},{token:"string",foreground:"CE9178"},{token:"string.escape",foreground:"D7BA7D"},{token:"number",foreground:"B5CEA8"},{token:"regexp",foreground:"D16969"},{token:"type",foreground:"4EC9B0"},{token:"type.identifier",foreground:"4EC9B0"},{token:"class",foreground:"4EC9B0"},{token:"interface",foreground:"4EC9B0",fontStyle:"italic"},{token:"enum",foreground:"4EC9B0"},{token:"typeParameter",foreground:"4EC9B0",fontStyle:"italic"},{token:"function",foreground:"DCDCAA"},{token:"function.declaration",foreground:"DCDCAA"},{token:"method",foreground:"DCDCAA"},{token:"variable",foreground:"9CDCFE"},{token:"variable.readonly",foreground:"4FC1FF"},{token:"variable.constant",foreground:"4FC1FF"},{token:"parameter",foreground:"9CDCFE",fontStyle:"italic"},{token:"property",foreground:"9CDCFE"},{token:"namespace",foreground:"4EC9B0"},{token:"decorator",foreground:"DCDCAA"},{token:"tag",foreground:"569CD6"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"tag.tsx",foreground:"4EC9B0"},{token:"tag.jsx",foreground:"4EC9B0"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"markup.heading",foreground:"569CD6",fontStyle:"bold"},{token:"markup.bold",fontStyle:"bold"},{token:"markup.italic",fontStyle:"italic"},{token:"markup.inline.raw",foreground:"CE9178"},{token:"variable.shell",foreground:"9CDCFE"}],colors:{"editor.background":"#1a1a2e","editor.foreground":"#d4d4d4","editor.lineHighlightBackground":"#2a2a4e","editor.selectionBackground":"#264f78","editorCursor.foreground":"#aeafad","editorWhitespace.foreground":"#3b3b5b","editorLineNumber.foreground":"#5a5a8a","editorLineNumber.activeForeground":"#c6c6c6","editor.inactiveSelectionBackground":"#3a3d41","editorIndentGuide.background1":"#404060","editorIndentGuide.activeBackground1":"#707090"}};async function ISt(){return mk||(mk=(async()=>{if(O6)return;Gp.defineTheme("stoneforge-dark",OSt);const e={noSemanticValidation:!0,noSyntaxValidation:!1};wi.typescript.typescriptDefaults.setDiagnosticsOptions(e),wi.typescript.javascriptDefaults.setDiagnosticsOptions(e),wi.typescript.typescriptDefaults.setCompilerOptions({...wi.typescript.typescriptDefaults.getCompilerOptions(),jsx:wi.typescript.JsxEmit.ReactJSX,noUnusedLocals:!1,noUnusedParameters:!1,allowNonTsExtensions:!0,target:wi.typescript.ScriptTarget.ES2020,module:wi.typescript.ModuleKind.ESNext,moduleResolution:wi.typescript.ModuleResolutionKind.NodeJs}),wi.typescript.javascriptDefaults.setCompilerOptions({...wi.typescript.javascriptDefaults.getCompilerOptions(),jsx:wi.typescript.JsxEmit.ReactJSX,noUnusedLocals:!1,noUnusedParameters:!1,allowNonTsExtensions:!0}),typeof window<"u"&&(window.monaco=RO),O6=!0,console.log("[monaco-init] Monaco initialized with TS worker configuration")})(),mk)}function RSt(){return O6}const PSt=["typescript","javascript","typescriptreact","javascriptreact"],zSt={completionItems:!0,hovers:!0,diagnostics:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,codeActions:!0,signatureHelp:!0,selectionRanges:!0,foldingRanges:!0},BSt={completionItems:!1,hovers:!1,diagnostics:!1,definitions:!1,references:!1,documentHighlights:!1,rename:!1,codeActions:!1,signatureHelp:!1,selectionRanges:!0,foldingRanges:!0},$St={automaticLayout:!0,minimap:{enabled:!0,scale:1,showSlider:"mouseover",renderCharacters:!1},fontSize:14,fontFamily:"'Fira Code', 'JetBrains Mono', 'Cascadia Code', Menlo, Monaco, 'Courier New', monospace",fontLigatures:!0,lineNumbers:"on",scrollBeyondLastLine:!1,wordWrap:"on",padding:{top:16,bottom:16},renderWhitespace:"selection",bracketPairColorization:{enabled:!0},guides:{bracketPairs:!0,indentation:!0,highlightActiveIndentation:!0},smoothScrolling:!0,cursorBlinking:"smooth",cursorSmoothCaretAnimation:"on",folding:!0,foldingStrategy:"indentation",showFoldingControls:"mouseover",hover:{enabled:!0,delay:300},occurrencesHighlight:"singleFile",selectionHighlight:!0,suggest:{showMethods:!0,showFunctions:!0,showConstructors:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0}};function zae(e,t,r){const n=e?`file:///${e.replace(/^\//,"")}`:`inmemory://model/${Date.now()}`,a=CSe.parse(n);let s=Gp.getModel(a);return s||(s=Gp.createModel(t,r,a)),s}function FSt({value:e,language:t,readOnly:r=!1,onChange:n,onMount:a,onReady:s,theme:i="stoneforge-dark",className:l="",filePath:c,onLspStateChange:u}){const[d]=w.useState(()=>RSt()?null:(console.error("[LspMonacoEditor] Monaco not initialized! FileEditorPage should call initializeMonaco() first."),"Editor not initialized. Please refresh the page.")),f=w.useRef(null),m=w.useRef(null),p=w.useRef(!1),v=w.useRef(e),b=w.useRef(c),y=w.useRef(c);y.current=c;const S=w.useRef(t),_=w.useRef(null),N=w.useRef([]),k=w.useRef(!1),{state:j}=LSt({monaco:d?void 0:RO,language:t,documentUri:c?`file://${c}`:void 0,autoConnect:PC(t)&&!r});return w.useEffect(()=>{if(d||!f.current||m.current)return;const E=zae(c,e,t),T=Gp.create(f.current,{...$St,model:E,theme:i,readOnly:r,quickSuggestions:!r,suggestOnTriggerCharacters:!r,parameterHints:{enabled:!r}});m.current=T,p.current=!1,v.current=e;const O=T.onDidChangeModelContent(()=>{if(!k.current){const L=T.getModel()?.getAlternativeVersionId();n?.(L)}p.current&&(_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{const L=MO(t);if(L){const A=T.getModel();if(A){const M=y.current,P=M?L.resolveDocumentUri(M):A.uri.toString();L.sendDidChange(P,A.getValue())}}},200))}),R=T.onDidFocusEditorWidget(()=>{zp().setEnabled(!1)}),H=T.onDidBlurEditorWidget(()=>{zp().setEnabled(!0)});N.current=[O,R,H],a&&a(T,RO);const $=E.getAlternativeVersionId();return s&&s($),()=>{_.current&&clearTimeout(_.current);for(const L of N.current)L.dispose();N.current=[],zp().setEnabled(!0),m.current&&(m.current.dispose(),m.current=null)}},[d]),w.useEffect(()=>{if(d||!m.current||c===b.current&&t===S.current)return;const E=m.current,T=MO(t);b.current&&p.current&&T&&T.sendDidClose(T.resolveDocumentUri(b.current)),p.current=!1;const O=zae(c,e,t);k.current=!0,E.setModel(O),O.getValue()!==e&&O.setValue(e),k.current=!1,b.current=c,S.current=t,v.current=e,s&&s(O.getAlternativeVersionId())},[c,t,e,d,s]),w.useEffect(()=>{if(d||!PSt.includes(t))return;const E=j==="connected",T=E?BSt:zSt;try{t==="typescript"||t==="typescriptreact"?wi.typescript.typescriptDefaults.setModeConfiguration(T):(t==="javascript"||t==="javascriptreact")&&wi.typescript.javascriptDefaults.setModeConfiguration(T),console.log(`[LspMonacoEditor] ${E?"Disabled":"Enabled"} built-in TS intellisense for ${t}`)}catch(O){console.warn("[LspMonacoEditor] Failed to set mode configuration:",O)}},[d,t,j]),w.useEffect(()=>{if(j!=="connected"||!m.current)return;const E=MO(t);if(!E||(b.current!==c&&(b.current&&p.current&&E.sendDidClose(E.resolveDocumentUri(b.current)),p.current=!1,b.current=c),p.current))return;const T=m.current.getModel();if(!T)return;const O=c?E.resolveDocumentUri(c):T.uri.toString(),R=T.uri.toString();E.sendDidOpen(O,t,T.getValue(),R),p.current=!0,console.log(`[LspMonacoEditor] Sent didOpen for ${O} (model: ${R})`)},[j,t,c]),w.useEffect(()=>{u&&u(j)},[j,u]),w.useEffect(()=>{if(e===v.current||(v.current=e,!m.current))return;const E=m.current.getModel();E&&E.getValue()!==e&&(k.current=!0,E.setValue(e),k.current=!1)},[e]),w.useEffect(()=>{m.current&&m.current.updateOptions({readOnly:r,quickSuggestions:!r,suggestOnTriggerCharacters:!r,parameterHints:{enabled:!r}})},[r]),w.useEffect(()=>{d||Gp.setTheme(i)},[i,d]),d?o.jsx("div",{className:`flex items-center justify-center h-full bg-[var(--color-surface)] ${l}`,children:o.jsxs("div",{className:"text-center p-4",children:[o.jsx("p",{className:"text-[var(--color-danger)] mb-2",children:"Failed to load editor"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:d})]})}):o.jsx("div",{className:`relative h-full ${l}`,"data-testid":"lsp-monaco-editor",children:o.jsx("div",{ref:f,style:{width:"100%",height:"100%"}})})}const USt=w.memo(FSt);function HSt(e){return e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString()}function qSt(e){const t=new Date(e),n=new Date().getTime()-t.getTime(),a=Math.floor(n/(1e3*60*60*24));return a<1?"Today":a===1?"Yesterday":a<7?`${a} days ago`:a<30?`${Math.floor(a/7)} weeks ago`:a<365?`${Math.floor(a/30)} months ago`:`${Math.floor(a/365)} years ago`}function WSt(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function KSt({rating:e}){const t=Math.floor(e),r=e-t>=.5,n=5-t-(r?1:0);return o.jsxs("div",{className:"flex items-center gap-0.5",children:[Array.from({length:t}).map((a,s)=>o.jsx(bT,{className:"w-3.5 h-3.5 fill-yellow-400 text-yellow-400"},`full-${s}`)),r&&o.jsx(bT,{className:"w-3.5 h-3.5 text-yellow-400",style:{clipPath:"inset(0 50% 0 0)"}},"half"),Array.from({length:n}).map((a,s)=>o.jsx(bT,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"},`empty-${s}`)),o.jsxs("span",{className:"ml-1 text-xs text-[var(--color-text-secondary)]",children:["(",e.toFixed(1),")"]})]})}function Bae({content:e,isLoading:t,error:r,emptyMessage:n}){if(t)return o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(Pe,{className:"w-6 h-6 animate-spin text-[var(--color-text-muted)]"})});if(r)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:r})]});if(!e)return o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[o.jsx(rn,{className:"w-8 h-8 text-[var(--color-text-muted)] mb-2"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:n})]});const a=Ar.parse(e);return o.jsx("div",{className:"extension-readme-content prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:a}})}function GSt({extensionId:e,className:t=""}){const[r,n]=w.useState("details"),[a,s]=e.split("."),{installed:i,installing:l,install:c,uninstall:u}=zye(),d=i.some($=>$.id===e),f=l.has(e),[m,p]=w.useState(!1),{data:v,isLoading:b,error:y}=pt({queryKey:["extension",a,s],queryFn:()=>Iye(a,s),staleTime:300*1e3,enabled:!!a&&!!s}),{data:S,isLoading:_,error:N}=pt({queryKey:["extension",a,s,"readme"],queryFn:async()=>{if(!v?.files?.readme)return"";const $=await fetch(v.files.readme);if(!$.ok)throw new Error("Failed to load README");return $.text()},staleTime:300*1e3,enabled:!!v?.files?.readme}),{data:k,isLoading:j,error:E}=pt({queryKey:["extension",a,s,"changelog"],queryFn:async()=>{if(!v?.files?.changelog)return"";const $=await fetch(v.files.changelog);if(!$.ok)throw new Error("Failed to load changelog");return $.text()},staleTime:300*1e3,enabled:!!v?.files?.changelog&&r==="changelog"}),T=w.useCallback(async()=>{if(!(f||!a||!s))try{await c(a,s,"latest")}catch($){console.error("[ExtensionDetailPage] Install failed:",$)}},[a,s,f,c]),O=w.useCallback(async()=>{if(!m){p(!0);try{await u(e)}catch($){console.error("[ExtensionDetailPage] Uninstall failed:",$)}finally{p(!1)}}},[e,m,u]);if(b)return o.jsx("div",{className:`flex items-center justify-center h-full ${t}`,children:o.jsx(Pe,{className:"w-8 h-8 animate-spin text-[var(--color-text-muted)]"})});if(y||!v)return o.jsxs("div",{className:`flex flex-col items-center justify-center h-full text-center p-6 ${t}`,children:[o.jsx(Rt,{className:"w-12 h-12 text-[var(--color-danger)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Failed to Load Extension"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:y instanceof Error?y.message:"Could not load extension details."})]});const R=v.displayName||v.name,H=v.files?.icon;return o.jsxs("div",{className:`flex flex-col h-full overflow-hidden bg-[var(--color-bg)] ${t}`,children:[o.jsx("div",{className:"flex-shrink-0 p-6 border-b border-[var(--color-border)]",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsxs("div",{className:"flex-shrink-0 w-20 h-20 rounded-lg bg-[var(--color-surface)] flex items-center justify-center overflow-hidden",children:[H?o.jsx("img",{src:H,alt:`${R} icon`,className:"w-full h-full object-cover",loading:"lazy",onError:$=>{$.target.style.display="none",$.target.nextElementSibling?.classList.remove("hidden")}}):null,o.jsx(ly,{className:`w-10 h-10 text-[var(--color-text-muted)] ${H?"hidden":""}`})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h1",{className:"text-2xl font-bold text-[var(--color-text)] mb-1 truncate",children:R}),o.jsxs("div",{className:"flex items-center gap-4 text-sm text-[var(--color-text-secondary)] mb-2",children:[o.jsx("span",{children:v.namespace}),v.downloadCount!==void 0&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(oy,{className:"w-3.5 h-3.5"}),HSt(v.downloadCount)]}),v.averageRating!==void 0&&v.averageRating>0&&o.jsx(KSt,{rating:v.averageRating})]}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] line-clamp-2",children:v.description||"No description available"})]}),o.jsx("div",{className:"flex-shrink-0",children:d?o.jsxs("button",{onClick:O,disabled:m,className:`
                  flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors
                  ${m?"bg-[var(--color-surface)] text-[var(--color-text-muted)] cursor-not-allowed":"bg-[var(--color-danger)] text-white hover:bg-[var(--color-danger)]/90"}
                `,children:[m?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(pr,{className:"w-4 h-4"}),o.jsx("span",{children:m?"Uninstalling...":"Uninstall"})]}):o.jsxs("button",{onClick:T,disabled:f,className:`
                  flex items-center gap-2 px-4 py-2 rounded-md font-medium transition-colors
                  ${f?"bg-[var(--color-surface)] text-[var(--color-text-muted)] cursor-not-allowed":"bg-[var(--color-primary)] text-white hover:bg-[var(--color-primary-hover)]"}
                `,children:[f?o.jsx(Pe,{className:"w-4 h-4 animate-spin"}):o.jsx(oy,{className:"w-4 h-4"}),o.jsx("span",{children:f?"Installing...":"Install"})]})})]})}),o.jsx("hr",{className:"border-[var(--color-border)]"}),o.jsxs("div",{className:"flex-shrink-0 flex items-center border-b border-[var(--color-border)] px-6",children:[o.jsxs("button",{onClick:()=>n("details"),className:`
            px-4 py-3 text-sm font-medium transition-colors relative
            ${r==="details"?"text-[var(--color-text)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
          `,children:["Details",r==="details"&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[var(--color-primary)]"})]}),o.jsxs("button",{onClick:()=>n("changelog"),className:`
            px-4 py-3 text-sm font-medium transition-colors relative
            ${r==="changelog"?"text-[var(--color-text)]":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
          `,children:["Changelog",r==="changelog"&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[var(--color-primary)]"})]})]}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsxs("div",{className:"flex-1 overflow-y-auto p-6 min-w-0",style:{width:"70%"},children:[r==="details"&&o.jsx(Bae,{content:S||"",isLoading:_,error:N instanceof Error?N.message:null,emptyMessage:"No details available"}),r==="changelog"&&o.jsx(Bae,{content:k||"",isLoading:j,error:E instanceof Error?E.message:null,emptyMessage:"No changelog available"})]}),o.jsxs("div",{className:"flex-shrink-0 w-72 overflow-y-auto p-6 border-l border-[var(--color-border)] bg-[var(--color-surface)]",style:{position:"sticky",top:0},children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Installation"}),o.jsxs("dl",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Identifier"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)] font-mono",children:e})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Version"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)]",children:v.version})]}),v.timestamp&&o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Last Updated"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)]",children:qSt(v.timestamp)})]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Marketplace"}),o.jsx("dl",{className:"space-y-2",children:v.timestamp&&o.jsxs("div",{children:[o.jsx("dt",{className:"text-xs text-[var(--color-text-muted)]",children:"Last Released"}),o.jsx("dd",{className:"text-sm text-[var(--color-text)]",children:WSt(v.timestamp)})]})})]}),v.categories&&v.categories.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Categories"}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:v.categories.map($=>o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs bg-[var(--color-surface-hover)] text-[var(--color-text-secondary)]",children:$},$))})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-muted)] mb-3",children:"Resources"}),o.jsxs("ul",{className:"space-y-2",children:[v.repository&&o.jsx("li",{children:o.jsxs("a",{href:v.repository,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-[var(--color-primary)] hover:underline",children:[o.jsx(a0,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Repository"}),o.jsx(wl,{className:"w-3 h-3 ml-auto"})]})}),v.files?.license&&o.jsx("li",{children:o.jsxs("a",{href:v.files.license,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-[var(--color-primary)] hover:underline",children:[o.jsx(Jwe,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"License"}),o.jsx(wl,{className:"w-3 h-3 ml-auto"})]})}),v.url&&o.jsx("li",{children:o.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-[var(--color-primary)] hover:underline",children:[o.jsx(tse,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Marketplace"}),o.jsx(wl,{className:"w-3 h-3 ml-auto"})]})})]})]})]})]}),o.jsx("style",{children:`
        .extension-readme-content {
          color: var(--color-text);
        }

        .extension-readme-content h1,
        .extension-readme-content h2,
        .extension-readme-content h3,
        .extension-readme-content h4,
        .extension-readme-content h5,
        .extension-readme-content h6 {
          color: var(--color-text);
          font-weight: 600;
          margin-top: 1.5em;
          margin-bottom: 0.5em;
        }

        .extension-readme-content h1 {
          font-size: 1.5rem;
          border-bottom: 1px solid var(--color-border);
          padding-bottom: 0.3em;
        }

        .extension-readme-content h2 {
          font-size: 1.25rem;
          border-bottom: 1px solid var(--color-border);
          padding-bottom: 0.3em;
        }

        .extension-readme-content h3 {
          font-size: 1.1rem;
        }

        .extension-readme-content p {
          margin-bottom: 1em;
          line-height: 1.6;
        }

        .extension-readme-content a {
          color: var(--color-primary);
          text-decoration: none;
        }

        .extension-readme-content a:hover {
          text-decoration: underline;
        }

        .extension-readme-content code {
          background-color: var(--color-surface-hover);
          border-radius: 0.25rem;
          padding: 0.125rem 0.375rem;
          font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
          font-size: 0.875em;
        }

        .extension-readme-content pre {
          background-color: var(--color-surface);
          border-radius: 0.375rem;
          padding: 0.75rem 1rem;
          overflow-x: auto;
          margin: 1em 0;
        }

        .extension-readme-content pre code {
          background-color: transparent;
          padding: 0;
          font-size: 0.875rem;
        }

        .extension-readme-content ul,
        .extension-readme-content ol {
          margin: 1em 0;
          padding-left: 2em;
        }

        .extension-readme-content li {
          margin-bottom: 0.25em;
        }

        .extension-readme-content blockquote {
          border-left: 4px solid var(--color-border);
          margin: 1em 0;
          padding-left: 1em;
          color: var(--color-text-secondary);
        }

        .extension-readme-content img {
          max-width: 100%;
          height: auto;
          border-radius: 0.375rem;
        }

        .extension-readme-content table {
          width: 100%;
          border-collapse: collapse;
          margin: 1em 0;
        }

        .extension-readme-content th,
        .extension-readme-content td {
          border: 1px solid var(--color-border);
          padding: 0.5em 1em;
          text-align: left;
        }

        .extension-readme-content th {
          background-color: var(--color-surface);
          font-weight: 600;
        }

        .extension-readme-content hr {
          border: none;
          border-top: 1px solid var(--color-border);
          margin: 2em 0;
        }
      `})]})}function VSt(e){return pt({queryKey:["document",e,"content"],queryFn:async()=>{if(!e)return null;const t=await fetch(`/api/documents/${e}`);if(!t.ok)throw new Error("Failed to fetch document");return await t.json()},enabled:!!e,staleTime:3e4})}function YSt(e){return e?OZe(e.contentType,e.title):"plaintext"}function QSt(){return o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6","data-testid":"editor-no-file-selected",children:[o.jsx(Bi,{className:"w-12 h-12 text-[var(--color-text-muted)] mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Select a File"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)] max-w-xs",children:"Choose a file from the sidebar to view its content in the editor."})]})}function JSt({source:e,onSourceChange:t,isWorkspaceOpen:r,workspaceName:n}){return o.jsxs("div",{className:"flex items-center gap-1 p-1 bg-[var(--color-surface-hover)] rounded-lg",children:[o.jsxs("button",{onClick:()=>t("workspace"),className:`
          flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded transition-colors
          ${e==="workspace"?"bg-[var(--color-surface)] text-[var(--color-text)] shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
        `,title:r?`Workspace: ${n}`:"No workspace open",children:[o.jsx(tSe,{className:"w-3 h-3"}),"Local"]}),o.jsxs("button",{onClick:()=>t("documents"),className:`
          flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded transition-colors
          ${e==="documents"?"bg-[var(--color-surface)] text-[var(--color-text)] shadow-sm":"text-[var(--color-text-secondary)] hover:text-[var(--color-text)]"}
        `,children:[o.jsx(dse,{className:"w-3 h-3"}),"Docs"]})]})}function ZSt({activePanel:e,onPanelChange:t}){const r=[{id:"files",icon:eSe,label:"Explorer"},{id:"search",icon:xr,label:"Search"},{id:"extensions",icon:hse,label:"Extensions"}],n=[{id:"settings",icon:Wa,label:"Settings"}],a=s=>{const i=s.icon,l=e===s.id;return o.jsx("button",{onClick:()=>t(s.id),className:`
          w-10 h-10 flex items-center justify-center rounded-md transition-colors
          ${l?"bg-[var(--color-surface)] text-[var(--color-text)] shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)]"}
        `,title:s.label,"data-testid":`activity-bar-${s.id}`,"aria-pressed":l,children:o.jsx(i,{className:"w-5 h-5"})},s.id)};return o.jsxs("div",{className:"w-12 flex-shrink-0 bg-[var(--color-surface-hover)] border-r border-[var(--color-border)] flex flex-col justify-between items-center py-2","data-testid":"editor-activity-bar",children:[o.jsx("div",{className:"flex flex-col items-center gap-1",children:r.map(a)}),o.jsx("div",{className:"flex flex-col items-center gap-1",children:n.map(a)})]})}function XSt(){const[e,t]=w.useState(!1),[r,n]=w.useState(null),[a,s]=w.useState([]),[i,l]=w.useState(null),c=w.useRef(null);c.current=i;const u=w.useRef([]);u.current=a;const d=w.useRef(new Set),[f,m]=w.useState(null),[p,v]=w.useState("workspace"),[b,y]=w.useState(!1),[S,_]=w.useState(null),[N,k]=w.useState("files"),[j,E]=w.useState(()=>localStorage.getItem("editor.theme")||"stoneforge-dark"),T=w.useRef(null),O=w.useRef(null),R=w.useRef(null),[H,$]=w.useState("idle"),L=w.useRef(null),[A,M]=w.useState(null),[P,I]=w.useState(""),[B,F]=w.useState(null),[q,Q]=w.useState(!1),W=w.useRef(null);w.useEffect(()=>{let ee=!0;return ISt().then(()=>{ee&&t(!0)}).catch(Le=>{ee&&(console.error("[FileEditorPage] Failed to initialize Monaco:",Le),n(Le instanceof Error?Le.message:"Failed to initialize editor"))}),()=>{ee=!1}},[]),w.useEffect(()=>()=>{R.current&&clearTimeout(R.current)},[]);const{isOpen:G,workspaceName:J,workspaceRoot:X,entries:V,isLoading:se,error:de,deleteFile:he,renameFile:te,readFileByPath:le,writeFile:oe,refreshTree:Z,createFolder:ve}=y1(),[U,ge]=w.useState(!1),[ue,re]=w.useState(null),{data:ne=[],isLoading:me,isError:ke}=IB(),{data:we,isLoading:pe,isError:Oe}=VSt(p==="documents"?f:null),Ae=w.useMemo(()=>a.find(ee=>ee.id===i)||null,[a,i]),Re=w.useCallback(()=>{const ee=c.current;if(!ee||!T.current)return;const Le=T.current.getModel();if(!Le)return;const We=Le.getValue();s(be=>{const K=be.find(ie=>ie.id===ee);return!K||K.content===We?be:be.map(ie=>ie.id===ee?{...ie,content:We}:ie)})},[]);w.useEffect(()=>{if(p==="documents"&&we&&f){Re();const ee={id:f,name:we.title||"Untitled",path:we.title||"Untitled",content:we.content||"",savedContent:we.content||"",language:YSt(we),source:"documents",isPreview:!1,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0};s(Le=>{const We=Le.findIndex(ie=>ie.id===f);if(We!==-1){const ie=[...Le];return ie[We]={...ie[We],...ee,isPreview:ie[We].isPreview},ie}const be=c.current,K=Le.findIndex(ie=>ie.id===be);if(K!==-1&&!Le[K].isDirty){const ie=[...Le];return ie[K]=ee,ie}return[...Le,ee]}),l(f)}},[p,we,f,Re]);const Ve=w.useCallback(async(ee,Le=!1)=>{if(ee.nodeType==="folder")return;if(m(ee.id),_(null),ee.id!==c.current&&Re(),u.current.find(be=>be.id===ee.id)){l(ee.id),Le&&s(be=>be.map(K=>K.id===ee.id?{...K,isPreview:!1}:K));return}if(!d.current.has(ee.id)&&p==="workspace"){d.current.add(ee.id),y(!0);try{const be=await le(ee.path);if(!be)throw new Error("File not found");const K={id:ee.id,name:be.name,path:be.path,content:be.content,savedContent:be.content,language:be.language||"plaintext",source:"workspace",isPreview:!Le,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0};s(ie=>{const xe=ie.findIndex(ot=>ot.id===ee.id);if(xe!==-1){if(Le){const ot=[...ie];return ot[xe]={...ot[xe],isPreview:!1},ot}return ie}if(Le)return[...ie,K];const Ce=c.current,ht=ie.findIndex(ot=>ot.id===Ce);if(ht!==-1&&!ie[ht].isDirty){const ot=[...ie];return ot[ht]=K,ot}return[...ie,K]}),l(ee.id)}catch(be){_(be instanceof Error?be.message:"Failed to read file")}finally{d.current.delete(ee.id),y(!1)}}},[p,le,Re]),gt=w.useCallback(async ee=>{await Ve(ee,!0)},[Ve]),lt=w.useCallback(async ee=>{try{await he(ee),s(Le=>{const We=Le.filter(be=>be.path!==ee&&!be.path.startsWith(ee+"/"));return c.current&&(!We.find(K=>K.id===c.current)&&We.length>0?(l(We[0].id),m(We[0].id)):We.length===0&&(l(null),m(null))),We})}catch(Le){throw console.error("Failed to delete file:",Le),Le}},[he]),Pt=w.useCallback(async(ee,Le)=>{try{await te(ee,Le),s(We=>We.map(be=>{if(be.path===ee){const K=Le.split("/").pop()||be.name;return{...be,id:Le,path:Le,name:K}}if(be.path.startsWith(ee+"/")){const K=Le+be.path.slice(ee.length);return{...be,id:K,path:K}}return be})),c.current===ee&&(l(Le),m(Le))}catch(We){throw console.error("Failed to rename file:",We),We}},[te]),fr=w.useCallback(async(ee,Le,We)=>{try{const be=ee.split("/").pop()||"file";if(We==="copy"){const K=be.lastIndexOf("."),ie=K>0?be.slice(0,K):be,xe=K>0?be.slice(K):"";let Ce=Le?`${Le}/${be}`:be,ht=0;for(;await le(Ce);){ht++;const Ut=`${ie} (${ht})${xe}`;if(Ce=Le?`${Le}/${Ut}`:Ut,ht>99)break}const ot=await le(ee);if(ot){const Dt=Ce.split("/").pop()||be;await oe({id:Ce,name:Dt,type:"file",path:Ce},ot.content)}}else{const K=Le?`${Le}/${be}`:be;await te(ee,K),s(ie=>ie.map(xe=>xe.path===ee?{...xe,id:K,path:K}:xe))}await Z()}catch(be){throw console.error("Failed to paste file:",be),be}},[le,oe,te,Z]),Qe=w.useCallback(async(ee,Le,We)=>{Re();const be=a.find(K=>K.path===ee);if(be){l(be.id),setTimeout(()=>{T.current&&(T.current.revealLineInCenter(Le),T.current.setPosition({lineNumber:Le,column:We}),T.current.focus())},50);return}m(ee),_(null),y(!0);try{const K=await le(ee);if(!K)throw new Error("File not found");const ie={id:ee,name:K.name,path:K.path,content:K.content,savedContent:K.content,language:K.language||"plaintext",source:"workspace",isPreview:!0,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0};s(xe=>{const Ce=xe.findIndex(ht=>ht.isPreview&&!ht.isDirty);if(Ce!==-1){const ht=[...xe];return ht[Ce]=ie,ht}return[...xe,ie]}),l(ee),setTimeout(()=>{T.current&&(T.current.revealLineInCenter(Le),T.current.setPosition({lineNumber:Le,column:We}),T.current.focus())},100)}catch(K){_(K instanceof Error?K.message:"Failed to read file")}finally{y(!1)}},[a,le,Re]),Vt=w.useCallback(ee=>{ee!==i&&Re(),l(ee),a.find(We=>We.id===ee)&&m(ee)},[a,i,Re]),at=w.useCallback(ee=>{s(Le=>{const We=Le.findIndex(K=>K.id===ee);if(We===-1)return Le;const be=Le.filter(K=>K.id!==ee);if(i===ee&&be.length>0){const K=Math.max(0,We-1);l(be[K]?.id||null),m(be[K]?.id||null)}else be.length===0&&(l(null),m(null));return be})},[i]),Ne=w.useCallback(ee=>{s(ee)},[]),Fe=w.useCallback(ee=>{i&&(s(Le=>{const We=Le.find(K=>K.id===i);return We?ee!==void 0&&ee===We.savedVersionId?(R.current&&(clearTimeout(R.current),R.current=null),!We.isDirty||We.isPreview||We.hasUnsavedChanges!==!1?Le.map(ie=>ie.id===i?{...ie,isDirty:!0,isPreview:!1,hasUnsavedChanges:!1}:ie):Le):!We.isDirty||We.isPreview||!We.hasUnsavedChanges?Le.map(K=>K.id===i?{...K,isDirty:!0,isPreview:!1,hasUnsavedChanges:!0}:K):Le:Le}),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{R.current=null;const Le=c.current;if(!Le||!T.current)return;const We=T.current.getModel();if(!We)return;const be=We.getValue();s(K=>{const ie=K.find(Ce=>Ce.id===Le);if(!ie)return K;const xe=be!==ie.savedContent;return ie.hasUnsavedChanges===xe?K:K.map(Ce=>Ce.id===Le?{...Ce,hasUnsavedChanges:xe}:Ce)})},300))},[i]),Ke=w.useCallback(async ee=>{const Le=ee||i;if(!Le)return;const We=a.find(K=>K.id===Le);if(!We||!We.hasUnsavedChanges)return;if(We.source!=="workspace"){re({type:"error",text:"Document saving is not yet supported"}),setTimeout(()=>re(null),3e3);return}ge(!0),re(null);const be=Le===i&&T.current?T.current.getValue():We.content;try{const K={id:We.path,name:We.name,type:"file",path:We.path};await oe(K,be);const ie=Le===i&&T.current?T.current.getModel()?.getAlternativeVersionId()??0:We.savedVersionId;s(xe=>xe.map(Ce=>Ce.id===Le?{...Ce,content:be,savedContent:be,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:ie}:Ce)),re({type:"success",text:"File saved successfully"}),setTimeout(()=>re(null),2e3)}catch(K){const ie=K instanceof Error?K.message:"Failed to save file";re({type:"error",text:ie}),setTimeout(()=>re(null),5e3)}finally{ge(!1)}},[i,a,oe]),Tt=w.useCallback(ee=>{v(ee),m(null),_(null)},[]),wt=w.useCallback(ee=>{k(ee),ee==="search"&&setTimeout(()=>{O.current?.focus()},50)},[]),Zt=w.useCallback(ee=>{E(ee),localStorage.setItem("editor.theme",ee)},[]),Xe=w.useCallback(ee=>{const Le=`ext:${ee.namespace}.${ee.name}`,We=ee.displayName||ee.name;if(u.current.find(ie=>ie.id===Le)){l(Le);return}Re();const K={id:Le,name:We,path:`Extension: ${We}`,content:"",savedContent:"",language:"plaintext",source:"extension",isPreview:!1,isDirty:!1,hasUnsavedChanges:!1,savedVersionId:0,extensionId:`${ee.namespace}.${ee.name}`};s(ie=>{const xe=ie.findIndex(Ce=>Ce.source==="extension");if(xe!==-1){const Ce=[...ie];return Ce[xe]=K,Ce}return[...ie,K]}),l(Le)},[Re]);w.useEffect(()=>{const ee=Le=>{if((Le.metaKey||Le.ctrlKey)&&Le.key.toLowerCase()==="s"&&!Le.shiftKey){Le.preventDefault(),Ke();return}if((Le.metaKey||Le.ctrlKey)&&Le.shiftKey&&Le.key.toLowerCase()==="f"){Le.preventDefault(),k("search"),setTimeout(()=>{O.current?.focus()},50);return}if((Le.metaKey||Le.ctrlKey)&&Le.key.toLowerCase()==="w"){Le.preventDefault(),i&&at(i);return}};return document.addEventListener("keydown",ee),()=>document.removeEventListener("keydown",ee)},[i,at,Ke]);const nt=w.useCallback(ee=>{M({type:ee}),I(""),F(null),setTimeout(()=>W.current?.focus(),50)},[]),bt=w.useCallback(()=>{M(null),I(""),F(null),Q(!1)},[]),Ct=w.useCallback(async()=>{if(!A||q)return;const ee=P.trim();if(!ee){F("Please enter a name");return}if(ee.startsWith("/")||ee.endsWith("/")||ee.includes("//")){F("Invalid path format");return}Q(!0),F(null);try{if(A.type==="file"){const Le=ee.split("/"),We=Le[Le.length-1];await oe({id:ee,name:We,type:"file",path:ee},""),await Z(),Ve({id:ee,name:We,nodeType:"file",path:ee})}else await ve(ee),await Z();bt()}catch(Le){Q(!1),F(Le instanceof Error?Le.message:"Failed to create")}},[A,P,q,oe,ve,Z,Ve,bt]),fe=w.useCallback(()=>{L.current?.closeAll()},[]),De=p==="workspace"?se:me,Ue=p==="documents"?pe:b,dt=p==="workspace"?!!de:ke,Nt=p==="documents"?Oe:!!S,Mt=p==="workspace"?V.length===0:ne.length===0,Je=w.useMemo(()=>Ae?Ae.path:p==="workspace"&&G?`Workspace: ${J}`:p==="documents"?"Document library":"Open a workspace or select a document",[Ae,p,G,J]),et=w.useCallback(ee=>{T.current=ee},[]),it=w.useCallback(ee=>{const Le=c.current;Le&&s(We=>We.map(be=>be.id===Le&&be.savedVersionId===0?{...be,savedVersionId:ee}:be))},[]),tr=Ae?b1(Ae.name):null;return o.jsxs("div",{className:"h-full flex flex-col space-y-6 animate-fade-in","data-testid":"file-editor-page",children:[o.jsx("div",{className:"flex items-center justify-between","data-testid":"editor-header",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary-muted)]",children:o.jsx(Bi,{className:"w-5 h-5 text-[var(--color-primary)]"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--color-text)]",children:"Editor"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:Je})]})]})}),o.jsxs("div",{className:"flex-1 flex overflow-hidden rounded-lg border border-[var(--color-border)] bg-[var(--color-surface)]","data-testid":"editor-main-content",children:[o.jsx(ZSt,{activePanel:N,onPanelChange:wt}),o.jsxs("div",{className:"w-64 flex-shrink-0 border-r border-[var(--color-border)] flex flex-col overflow-hidden","data-testid":"editor-sidebar",children:[N==="files"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)] space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Explorer"}),o.jsx(JSt,{source:p,onSourceChange:Tt,isWorkspaceOpen:G,workspaceName:J})]}),p==="workspace"&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:Z,disabled:se,className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors disabled:opacity-50",title:"Refresh",children:o.jsx(jr,{className:`w-3 h-3 ${se?"animate-spin":""}`})}),o.jsx("button",{onClick:()=>nt("file"),className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors",title:"New File",children:o.jsx(Hae,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>nt("folder"),className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors",title:"New Folder",children:o.jsx(K6,{className:"w-3 h-3"})}),o.jsx("button",{onClick:fe,className:"flex items-center gap-1 px-2 py-1 text-xs text-[var(--color-text-secondary)] hover:text-[var(--color-text)] hover:bg-[var(--color-surface)] rounded transition-colors",title:"Collapse All",children:o.jsx(Zwe,{className:"w-3 h-3"})}),o.jsx("span",{className:"flex-1 text-xs text-[var(--color-text-muted)] truncate ml-1",children:J||"Workspace"})]})]}),o.jsx("div",{className:"flex-1 flex flex-col overflow-hidden","data-testid":"editor-file-tree-container",children:De?o.jsx("div",{className:"flex items-center justify-center py-8","data-testid":"editor-loading-tree",children:o.jsx(Pe,{className:"w-5 h-5 animate-spin text-[var(--color-text-muted)]"})}):dt?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center","data-testid":"editor-error-tree",children:[o.jsx(Rt,{className:"w-5 h-5 text-[var(--color-danger)] mb-2"}),o.jsx("p",{className:"text-xs text-[var(--color-text-secondary)]",children:p==="workspace"?de:"Failed to load documents"})]}):Mt?o.jsx("div",{className:"text-center py-8","data-testid":"editor-empty-tree",children:o.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:p==="workspace"?"No files found":"No documents available"})}):o.jsx(N1t,{ref:L,workspaceEntries:V,documents:ne,source:p,selectedId:f,onSelectFile:Ve,onDoubleClickFile:gt,onDeleteFile:p==="workspace"?lt:void 0,onRenameFile:p==="workspace"?Pt:void 0,onPasteFile:p==="workspace"?fr:void 0,onMoveFile:p==="workspace"?Pt:void 0,workspaceRoot:X})})]}),N==="search"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Search"})}),o.jsx(M1t,{ref:O,onSelectResult:Qe})]}),N==="extensions"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Extensions"})}),o.jsx(_wt,{onExtensionClick:Xe})]}),N==="settings"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"px-3 py-2 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:o.jsx("h2",{className:"text-xs font-semibold uppercase tracking-wide text-[var(--color-text-secondary)]",children:"Settings"})}),o.jsx(owt,{theme:j,onThemeChange:Zt})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden","data-testid":"editor-panel",children:[o.jsx(Twt,{tabs:a,activeTabId:i,onTabSelect:Vt,onTabClose:at,onTabsReorder:Ne,onSaveRequest:Ke}),r?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6","data-testid":"editor-monaco-error",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Editor Failed to Load"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:r})]}):e?a.length===0?o.jsx(QSt,{}):Ue?o.jsx("div",{className:"flex items-center justify-center h-full","data-testid":"editor-loading-content",children:o.jsx(Pe,{className:"w-8 h-8 animate-spin text-[var(--color-text-muted)]"})}):Nt||S?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-6","data-testid":"editor-error-content",children:[o.jsx(Rt,{className:"w-8 h-8 text-[var(--color-danger)] mb-3"}),o.jsx("h3",{className:"text-lg font-medium text-[var(--color-text)] mb-2",children:"Failed to Load"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:S||"Could not load the file content."})]}):Ae?Ae.source==="extension"?o.jsx(GSt,{extensionId:Ae.extensionId,className:"flex-1 overflow-auto"}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-[var(--color-border)] bg-[var(--color-surface-hover)]",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Xwe,{className:"w-3.5 h-3.5 text-[var(--color-text-muted)]"}),o.jsx("span",{className:"text-xs font-medium text-[var(--color-text-secondary)]",children:tr?.displayName||"Plain Text"})]}),PC(Ae.language)&&o.jsxs("div",{className:`flex items-center gap-1.5 text-xs ${H==="connected"?"text-green-500":H==="connecting"?"text-yellow-500":H==="error"?"text-red-500":"text-[var(--color-text-muted)]"}`,title:H==="connected"?"LSP connected - Autocompletion, hover info, and diagnostics active":H==="connecting"?"Connecting to language server...":H==="error"?"LSP connection failed":H==="unavailable"?"Language server not available":"LSP idle",children:[o.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${H==="connected"?"bg-green-500":H==="connecting"?"bg-yellow-500 animate-pulse":H==="error"?"bg-red-500":"bg-[var(--color-text-muted)]"}`}),o.jsx("span",{children:"LSP"})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[ue&&o.jsxs("div",{className:`flex items-center gap-1.5 text-xs ${ue.type==="success"?"text-green-500":"text-[var(--color-danger)]"}`,"data-testid":"save-message",children:[ue.type==="success"?o.jsx(zs,{className:"w-3.5 h-3.5"}):o.jsx(Rt,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:ue.text})]}),Ae.source==="workspace"&&o.jsxs("button",{onClick:()=>Ke(),disabled:!Ae.hasUnsavedChanges||U,className:`
                          flex items-center gap-1.5 px-2 py-1 text-xs font-medium rounded transition-colors
                          ${Ae.hasUnsavedChanges?"text-[var(--color-primary)] hover:bg-[var(--color-surface)] cursor-pointer":"text-[var(--color-text-muted)] cursor-not-allowed"}
                          disabled:opacity-50
                        `,title:Ae.hasUnsavedChanges?"Save (Cmd+S)":"No unsaved changes","data-testid":"save-button",children:[U?o.jsx(Pe,{className:"w-3.5 h-3.5 animate-spin"}):o.jsx($x,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:"Save"})]}),Ae.source==="documents"&&o.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Read Only"})]})]}),o.jsx(USt,{value:Ae.content,language:Ae.language,theme:j,readOnly:Ae.source==="documents",onChange:Fe,onMount:et,onReady:it,onLspStateChange:$,filePath:Ae.source==="workspace"?Ae.path:void 0,className:"flex-1"})]}):null:o.jsxs("div",{className:"flex flex-col items-center justify-center h-full","data-testid":"editor-monaco-loading",children:[o.jsx(Pe,{className:"w-8 h-8 animate-spin text-[var(--color-text-muted)] mb-3"}),o.jsx("p",{className:"text-sm text-[var(--color-text-secondary)]",children:"Initializing editor..."})]})]})]}),A&&o.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",onClick:q?void 0:bt,children:o.jsxs("div",{className:"bg-[var(--color-bg-elevated)] border border-[var(--color-border)] rounded-lg shadow-xl w-full max-w-sm p-4",onClick:ee=>ee.stopPropagation(),"data-testid":"create-popup-dialog",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text)] mb-3",children:A.type==="file"?"New File":"New Folder"}),o.jsx("label",{className:"block text-xs text-[var(--color-text-secondary)] mb-1",children:A.type==="file"?"Enter file name:":"Enter folder name:"}),o.jsx("input",{ref:W,type:"text",value:P,onChange:ee=>{I(ee.target.value),F(null)},onKeyDown:ee=>{ee.key==="Enter"?(ee.preventDefault(),Ct()):ee.key==="Escape"&&(ee.preventDefault(),q||bt())},placeholder:A.type==="file"?"e.g. src/utils/helpers.ts":"e.g. src/components/ui",className:"w-full bg-[var(--color-bg)] border border-[var(--color-border)] rounded px-3 py-1.5 text-sm text-[var(--color-text)] outline-none focus:border-[var(--color-primary)] transition-colors disabled:opacity-50",disabled:q,"data-testid":"create-popup-input"}),B&&o.jsx("p",{className:"text-xs text-[var(--color-danger)] mt-1","data-testid":"create-popup-error",children:B}),o.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[o.jsx("button",{onClick:bt,className:"px-3 py-1.5 text-xs font-medium text-[var(--color-text)] bg-[var(--color-surface)] hover:bg-[var(--color-surface-hover)] rounded transition-colors disabled:opacity-50",disabled:q,"data-testid":"create-popup-cancel",children:"Cancel"}),o.jsxs("button",{onClick:Ct,className:"px-3 py-1.5 text-xs font-medium text-white bg-[var(--color-primary)] hover:opacity-90 rounded transition-colors disabled:opacity-50 flex items-center gap-1.5",disabled:q,"data-testid":"create-popup-submit",children:[q&&o.jsx(Pe,{className:"w-3 h-3 animate-spin"}),q?"Creating":"Create"]})]})]})})]})}function ekt(){const{location:e}=WC();return e.pathname.startsWith("/popout")?o.jsx(Fae,{}):o.jsx(EXe,{})}const _s=iwe({component:ekt}),tkt=ws({getParentRoute:()=>_s,path:"/",beforeLoad:()=>{throw lwe({to:"/activity"})}}),rkt=ws({getParentRoute:()=>_s,path:"/activity",component:QXe}),nkt=ws({getParentRoute:()=>_s,path:"/tasks",component:$rt,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,page:typeof e.page=="number"?e.page:typeof e.page=="string"&&parseInt(e.page,10)||1,limit:typeof e.limit=="number"?e.limit:typeof e.limit=="string"&&parseInt(e.limit,10)||25,status:typeof e.status=="string"?e.status:void 0,assignee:typeof e.assignee=="string"?e.assignee:void 0,showClosed:e.showClosed===!0||e.showClosed==="true"?!0:void 0,action:typeof e.action=="string"?e.action:void 0,backlog:e.backlog===!0||e.backlog==="true"?!0:void 0})}),akt=ws({getParentRoute:()=>_s,path:"/plans",component:qrt,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,status:typeof e.status=="string"?e.status:void 0})}),skt=ws({getParentRoute:()=>_s,path:"/agents",component:Gut,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,tab:typeof e.tab=="string"?e.tab:"agents",role:typeof e.role=="string"?e.role:void 0})}),ikt=ws({getParentRoute:()=>_s,path:"/workspaces",component:Xdt,validateSearch:e=>({layout:typeof e.layout=="string"?e.layout:"single",agent:typeof e.agent=="string"?e.agent:void 0,resumeSessionId:typeof e.resumeSessionId=="string"?e.resumeSessionId:void 0,resumePrompt:typeof e.resumePrompt=="string"?e.resumePrompt:void 0})}),okt=ws({getParentRoute:()=>_s,path:"/workflows",component:eft,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,tab:typeof e.tab=="string"?e.tab:"templates",action:typeof e.action=="string"?e.action:void 0})}),lkt=ws({getParentRoute:()=>_s,path:"/metrics",component:lft,validateSearch:e=>({range:typeof e.range=="string"?e.range:"7d"})}),ckt=ws({getParentRoute:()=>_s,path:"/settings",component:cft,validateSearch:e=>({tab:typeof e.tab=="string"?e.tab:"preferences"})}),ukt=ws({getParentRoute:()=>_s,path:"/inbox",component:zft,validateSearch:e=>({message:typeof e.message=="string"?e.message:void 0})}),dkt=ws({getParentRoute:()=>_s,path:"/messages",component:Ngt,validateSearch:e=>({channel:typeof e.channel=="string"?e.channel:void 0,message:typeof e.message=="string"?e.message:void 0})}),fkt=ws({getParentRoute:()=>_s,path:"/documents",component:r1t,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,library:typeof e.library=="string"?e.library:void 0})}),hkt=ws({getParentRoute:()=>_s,path:"/merge-requests",component:h1t,validateSearch:e=>({selected:typeof e.selected=="string"?e.selected:void 0,status:typeof e.status=="string"?e.status:void 0,showMerged:e.showMerged===!0||e.showMerged==="true"?!0:void 0})}),mkt=ws({getParentRoute:()=>_s,path:"/editor",component:XSt}),Gye=ws({getParentRoute:()=>_s,path:"/popout"}),pkt=ws({getParentRoute:()=>Gye,path:"/terminal",component:gft,validateSearch:e=>({agent:typeof e.agent=="string"?e.agent:void 0,type:typeof e.type=="string"?e.type:"terminal",name:typeof e.name=="string"?e.name:void 0,role:typeof e.role=="string"?e.role:void 0,mode:typeof e.mode=="string"?e.mode:void 0})}),gkt=_s.addChildren([tkt,rkt,nkt,akt,skt,ikt,okt,lkt,ckt,ukt,dkt,fkt,hkt,mkt,Gye.addChildren([pkt])]),vkt=owe({routeTree:gkt});function bkt({totalElements:e,showProgress:t}){return o.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50","data-testid":"data-preloader-loading",children:o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[o.jsx("div",{className:"absolute inset-0 border-4 border-gray-200 rounded-full"}),o.jsx("div",{className:"absolute inset-0 border-4 border-blue-500 rounded-full animate-spin",style:{borderTopColor:"transparent",borderRightColor:"transparent"}})]}),o.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Stoneforge"}),t&&o.jsx("p",{className:"text-sm text-gray-500",children:e>0?`Loaded ${e.toLocaleString()} elements`:"Fetching data..."})]})})}function ykt({error:e,onRetry:t}){return o.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50","data-testid":"data-preloader-error",children:o.jsxs("div",{className:"text-center max-w-md p-6",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-100 flex items-center justify-center",children:o.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"Failed to Load Data"}),o.jsx("p",{className:"text-sm text-gray-500 mb-4",children:e?.message||"An error occurred while loading the application data."}),o.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Retry"})]})})}function xkt({children:e}){const t=UJe();return w2({channels:["*"],onEvent:r=>{t(r)},autoInvalidate:!0}),o.jsx(o.Fragment,{children:e})}function wkt({children:e,showProgress:t=!0,errorFallback:r}){const{isLoading:n,isError:a,error:s,totalElements:i,refetch:l}=PJe();return n?o.jsx(bkt,{totalElements:i,showProgress:t}):a?r?o.jsx(o.Fragment,{children:r}):o.jsx(ykt,{error:s,onRetry:()=>l()}):o.jsx(xkt,{children:e})}function Skt(){const e=localStorage.getItem("settings.theme"),t=e==="light"||e==="dark"||e==="system"?e:"system",r=window.matchMedia("(prefers-color-scheme: dark)").matches,n=document.documentElement;n.classList.remove("dark","theme-dark","theme-light"),(t==="system"?r?"dark":"light":t)==="dark"?n.classList.add("dark","theme-dark"):n.classList.add("theme-light")}Skt();const kkt=new cwe({defaultOptions:{queries:{staleTime:1e3*60,refetchOnWindowFocus:!0}}});ASe.createRoot(document.getElementById("root")).render(o.jsx(w.StrictMode,{children:o.jsx(uwe,{client:kkt,children:o.jsx(AZe,{children:o.jsx($Ze,{children:o.jsxs(lke,{children:[o.jsx(wkt,{children:o.jsx(dwe,{router:vkt})}),o.jsx(rSe,{position:"bottom-right",duration:5e3,richColors:!0,closeButton:!0})]})})})})}));
